/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/browser-client-factory.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/browser-client-factory.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createInstance": () => (/* binding */ createInstance),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/debug.js");
/* harmony import */ var _browser_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./browser-client */ "./node_modules/@amplitude/analytics-browser/lib/esm/browser-client.js");


var createInstance = function () {
    var client = new _browser_client__WEBPACK_IMPORTED_MODULE_0__.AmplitudeBrowser();
    return {
        init: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.init.bind(client), 'init', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config'])),
        add: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.add.bind(client), 'add', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.plugins'])),
        remove: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.remove.bind(client), 'remove', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.plugins'])),
        track: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.track.bind(client), 'track', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        logEvent: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.logEvent.bind(client), 'logEvent', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        identify: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.identify.bind(client), 'identify', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        groupIdentify: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.groupIdentify.bind(client), 'groupIdentify', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        setGroup: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.setGroup.bind(client), 'setGroup', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        revenue: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.revenue.bind(client), 'revenue', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        flush: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.flush.bind(client), 'flush', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config.apiKey', 'timeline.queue.length'])),
        getUserId: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.getUserId.bind(client), 'getUserId', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config', 'config.userId'])),
        setUserId: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.setUserId.bind(client), 'setUserId', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config', 'config.userId'])),
        getDeviceId: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.getDeviceId.bind(client), 'getDeviceId', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config', 'config.deviceId'])),
        setDeviceId: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.setDeviceId.bind(client), 'setDeviceId', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config', 'config.deviceId'])),
        reset: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.reset.bind(client), 'reset', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config', 'config.userId', 'config.deviceId'])),
        getSessionId: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.getSessionId.bind(client), 'getSessionId', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config'])),
        setSessionId: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.setSessionId.bind(client), 'setSessionId', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config'])),
        extendSession: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.extendSession.bind(client), 'extendSession', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config'])),
        setOptOut: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.setOptOut.bind(client), 'setOptOut', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config'])),
        setTransport: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.debugWrapper)(client.setTransport.bind(client), 'setTransport', (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientLogConfig)(client), (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.getClientStates)(client, ['config'])),
    };
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (createInstance());
//# sourceMappingURL=browser-client-factory.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/browser-client.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/browser-client.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AmplitudeBrowser": () => (/* binding */ AmplitudeBrowser)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/return-wrapper.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/plugins/destination.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/identify.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/revenue.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/core-client.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/analytics-connector.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/plugins/identity.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/default-tracking.js");
/* harmony import */ var _utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/snippet-helper */ "./node_modules/@amplitude/analytics-browser/lib/esm/utils/snippet-helper.js");
/* harmony import */ var _plugins_context__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./plugins/context */ "./node_modules/@amplitude/analytics-browser/lib/esm/plugins/context.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config */ "./node_modules/@amplitude/analytics-browser/lib/esm/config.js");
/* harmony import */ var _amplitude_plugin_web_attribution_browser__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @amplitude/plugin-web-attribution-browser */ "./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/web-attribution.js");
/* harmony import */ var _amplitude_plugin_page_view_tracking_browser__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @amplitude/plugin-page-view-tracking-browser */ "./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/page-view-tracking.js");
/* harmony import */ var _plugins_form_interaction_tracking__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./plugins/form-interaction-tracking */ "./node_modules/@amplitude/analytics-browser/lib/esm/plugins/form-interaction-tracking.js");
/* harmony import */ var _plugins_file_download_tracking__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./plugins/file-download-tracking */ "./node_modules/@amplitude/analytics-browser/lib/esm/plugins/file-download-tracking.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./constants */ "./node_modules/@amplitude/analytics-browser/lib/esm/constants.js");
/* harmony import */ var _det_notification__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./det-notification */ "./node_modules/@amplitude/analytics-browser/lib/esm/det-notification.js");












var AmplitudeBrowser = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(AmplitudeBrowser, _super);
    function AmplitudeBrowser() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AmplitudeBrowser.prototype.init = function (apiKey, userIdOrOptions, maybeOptions) {
        if (apiKey === void 0) { apiKey = ''; }
        var userId;
        var options;
        if (arguments.length > 2) {
            userId = userIdOrOptions;
            options = maybeOptions;
        }
        else {
            if (typeof userIdOrOptions === 'string') {
                userId = userIdOrOptions;
                options = undefined;
            }
            else {
                userId = userIdOrOptions === null || userIdOrOptions === void 0 ? void 0 : userIdOrOptions.userId;
                options = userIdOrOptions;
            }
        }
        return (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.returnWrapper)(this._init((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, options), { userId: userId, apiKey: apiKey })));
    };
    AmplitudeBrowser.prototype._init = function (options) {
        var _a, _b;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var browserOptions, connector, attributionTrackingOptions, webAttribution;
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Step 1: Block concurrent initialization
                        if (this.initializing) {
                            return [2 /*return*/];
                        }
                        this.initializing = true;
                        return [4 /*yield*/, (0,_config__WEBPACK_IMPORTED_MODULE_2__.useBrowserConfig)(options.apiKey, options, this)];
                    case 1:
                        browserOptions = _c.sent();
                        return [4 /*yield*/, _super.prototype._init.call(this, browserOptions)];
                    case 2:
                        _c.sent();
                        // Step 3: Set session ID
                        // Priority 1: `options.sessionId`
                        // Priority 2: last known sessionId from user identity storage
                        // Default: `Date.now()`
                        // Session ID is handled differently than device ID and user ID due to session events
                        this.setSessionId((_b = (_a = options.sessionId) !== null && _a !== void 0 ? _a : this.config.sessionId) !== null && _b !== void 0 ? _b : Date.now());
                        connector = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_3__.getAnalyticsConnector)(options.instanceName);
                        connector.identityStore.setIdentity({
                            userId: this.config.userId,
                            deviceId: this.config.deviceId,
                        });
                        // Step 4: Install plugins
                        // Do not track any events before this
                        return [4 /*yield*/, this.add(new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_4__.Destination()).promise];
                    case 3:
                        // Step 4: Install plugins
                        // Do not track any events before this
                        _c.sent();
                        return [4 /*yield*/, this.add(new _plugins_context__WEBPACK_IMPORTED_MODULE_5__.Context()).promise];
                    case 4:
                        _c.sent();
                        return [4 /*yield*/, this.add(new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_6__.IdentityEventSender()).promise];
                    case 5:
                        _c.sent();
                        // Notify if DET is enabled
                        (0,_det_notification__WEBPACK_IMPORTED_MODULE_7__.detNotify)(this.config);
                        if (!(0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__.isFileDownloadTrackingEnabled)(this.config.defaultTracking)) return [3 /*break*/, 7];
                        return [4 /*yield*/, this.add((0,_plugins_file_download_tracking__WEBPACK_IMPORTED_MODULE_9__.fileDownloadTracking)()).promise];
                    case 6:
                        _c.sent();
                        _c.label = 7;
                    case 7:
                        if (!(0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__.isFormInteractionTrackingEnabled)(this.config.defaultTracking)) return [3 /*break*/, 9];
                        return [4 /*yield*/, this.add((0,_plugins_form_interaction_tracking__WEBPACK_IMPORTED_MODULE_10__.formInteractionTracking)()).promise];
                    case 8:
                        _c.sent();
                        _c.label = 9;
                    case 9:
                        if (!(0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__.isAttributionTrackingEnabled)(this.config.defaultTracking)) return [3 /*break*/, 11];
                        attributionTrackingOptions = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__.getAttributionTrackingConfig)(this.config);
                        webAttribution = (0,_amplitude_plugin_web_attribution_browser__WEBPACK_IMPORTED_MODULE_11__.webAttributionPlugin)(attributionTrackingOptions);
                        return [4 /*yield*/, this.add(webAttribution).promise];
                    case 10:
                        _c.sent();
                        _c.label = 11;
                    case 11: 
                    // Add page view plugin
                    return [4 /*yield*/, this.add((0,_amplitude_plugin_page_view_tracking_browser__WEBPACK_IMPORTED_MODULE_12__.pageViewTrackingPlugin)((0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__.getPageViewTrackingConfig)(this.config))).promise];
                    case 12:
                        // Add page view plugin
                        _c.sent();
                        this.initializing = false;
                        // Step 6: Run queued dispatch functions
                        return [4 /*yield*/, this.runQueuedFunctions('dispatchQ')];
                    case 13:
                        // Step 6: Run queued dispatch functions
                        _c.sent();
                        // Step 7: Add the event receiver after running remaining queued functions.
                        connector.eventBridge.setEventReceiver(function (event) {
                            void _this.track(event.eventType, event.eventProperties);
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    AmplitudeBrowser.prototype.getUserId = function () {
        var _a;
        return (_a = this.config) === null || _a === void 0 ? void 0 : _a.userId;
    };
    AmplitudeBrowser.prototype.setUserId = function (userId) {
        if (!this.config) {
            this.q.push(this.setUserId.bind(this, userId));
            return;
        }
        if (userId !== this.config.userId || userId === undefined) {
            this.config.userId = userId;
            (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_3__.setConnectorUserId)(userId, this.config.instanceName);
        }
    };
    AmplitudeBrowser.prototype.getDeviceId = function () {
        var _a;
        return (_a = this.config) === null || _a === void 0 ? void 0 : _a.deviceId;
    };
    AmplitudeBrowser.prototype.setDeviceId = function (deviceId) {
        if (!this.config) {
            this.q.push(this.setDeviceId.bind(this, deviceId));
            return;
        }
        this.config.deviceId = deviceId;
        (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_3__.setConnectorDeviceId)(deviceId, this.config.instanceName);
    };
    AmplitudeBrowser.prototype.reset = function () {
        this.setDeviceId((0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_13__.UUID)());
        this.setUserId(undefined);
    };
    AmplitudeBrowser.prototype.getSessionId = function () {
        var _a;
        return (_a = this.config) === null || _a === void 0 ? void 0 : _a.sessionId;
    };
    AmplitudeBrowser.prototype.setSessionId = function (sessionId) {
        var _a;
        if (!this.config) {
            this.q.push(this.setSessionId.bind(this, sessionId));
            return;
        }
        // Prevents starting a new session with the same session ID
        if (sessionId === this.config.sessionId) {
            return;
        }
        var previousSessionId = this.getSessionId();
        var lastEventTime = this.config.lastEventTime;
        var lastEventId = (_a = this.config.lastEventId) !== null && _a !== void 0 ? _a : -1;
        this.config.sessionId = sessionId;
        this.config.lastEventTime = undefined;
        if ((0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_8__.isSessionTrackingEnabled)(this.config.defaultTracking)) {
            if (previousSessionId && lastEventTime) {
                this.track(_constants__WEBPACK_IMPORTED_MODULE_14__.DEFAULT_SESSION_END_EVENT, undefined, {
                    device_id: this.previousSessionDeviceId,
                    event_id: ++lastEventId,
                    session_id: previousSessionId,
                    time: lastEventTime + 1,
                    user_id: this.previousSessionUserId,
                });
            }
            this.config.lastEventTime = this.config.sessionId;
            this.track(_constants__WEBPACK_IMPORTED_MODULE_14__.DEFAULT_SESSION_START_EVENT, undefined, {
                event_id: ++lastEventId,
                session_id: this.config.sessionId,
                time: this.config.lastEventTime,
            });
        }
        this.previousSessionDeviceId = this.config.deviceId;
        this.previousSessionUserId = this.config.userId;
    };
    AmplitudeBrowser.prototype.extendSession = function () {
        if (!this.config) {
            this.q.push(this.extendSession.bind(this));
            return;
        }
        this.config.lastEventTime = Date.now();
    };
    AmplitudeBrowser.prototype.setTransport = function (transport) {
        if (!this.config) {
            this.q.push(this.setTransport.bind(this, transport));
            return;
        }
        this.config.transportProvider = (0,_config__WEBPACK_IMPORTED_MODULE_2__.createTransport)(transport);
    };
    AmplitudeBrowser.prototype.identify = function (identify, eventOptions) {
        if ((0,_utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__.isInstanceProxy)(identify)) {
            var queue = identify._q;
            identify._q = [];
            identify = (0,_utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__.convertProxyObjectToRealObject)(new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_16__.Identify(), queue);
        }
        if (eventOptions === null || eventOptions === void 0 ? void 0 : eventOptions.user_id) {
            this.setUserId(eventOptions.user_id);
        }
        if (eventOptions === null || eventOptions === void 0 ? void 0 : eventOptions.device_id) {
            this.setDeviceId(eventOptions.device_id);
        }
        return _super.prototype.identify.call(this, identify, eventOptions);
    };
    AmplitudeBrowser.prototype.groupIdentify = function (groupType, groupName, identify, eventOptions) {
        if ((0,_utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__.isInstanceProxy)(identify)) {
            var queue = identify._q;
            identify._q = [];
            identify = (0,_utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__.convertProxyObjectToRealObject)(new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_16__.Identify(), queue);
        }
        return _super.prototype.groupIdentify.call(this, groupType, groupName, identify, eventOptions);
    };
    AmplitudeBrowser.prototype.revenue = function (revenue, eventOptions) {
        if ((0,_utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__.isInstanceProxy)(revenue)) {
            var queue = revenue._q;
            revenue._q = [];
            revenue = (0,_utils_snippet_helper__WEBPACK_IMPORTED_MODULE_15__.convertProxyObjectToRealObject)(new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_17__.Revenue(), queue);
        }
        return _super.prototype.revenue.call(this, revenue, eventOptions);
    };
    AmplitudeBrowser.prototype.process = function (event) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var currentTime, lastEventTime, timeSinceLastEvent;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                currentTime = Date.now();
                lastEventTime = this.config.lastEventTime || Date.now();
                timeSinceLastEvent = currentTime - lastEventTime;
                if (event.event_type !== _constants__WEBPACK_IMPORTED_MODULE_14__.DEFAULT_SESSION_START_EVENT &&
                    event.event_type !== _constants__WEBPACK_IMPORTED_MODULE_14__.DEFAULT_SESSION_END_EVENT &&
                    (!event.session_id || event.session_id === this.getSessionId()) &&
                    timeSinceLastEvent > this.config.sessionTimeout) {
                    this.setSessionId(currentTime);
                }
                return [2 /*return*/, _super.prototype.process.call(this, event)];
            });
        });
    };
    return AmplitudeBrowser;
}(_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_18__.AmplitudeCore));

//# sourceMappingURL=browser-client.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/config.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/config.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BrowserConfig": () => (/* binding */ BrowserConfig),
/* harmony export */   "createCookieStorage": () => (/* binding */ createCookieStorage),
/* harmony export */   "createTransport": () => (/* binding */ createTransport),
/* harmony export */   "getTopLevelDomain": () => (/* binding */ getTopLevelDomain),
/* harmony export */   "useBrowserConfig": () => (/* binding */ useBrowserConfig)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/storage/memory.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/logger.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/config.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/cookie-name.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/query-params.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/storage/cookie.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/transports/fetch.js");
/* harmony import */ var _storage_local_storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./storage/local-storage */ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/local-storage.js");
/* harmony import */ var _storage_session_storage__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./storage/session-storage */ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/session-storage.js");
/* harmony import */ var _transports_xhr__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./transports/xhr */ "./node_modules/@amplitude/analytics-browser/lib/esm/transports/xhr.js");
/* harmony import */ var _transports_send_beacon__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./transports/send-beacon */ "./node_modules/@amplitude/analytics-browser/lib/esm/transports/send-beacon.js");
/* harmony import */ var _cookie_migration__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./cookie-migration */ "./node_modules/@amplitude/analytics-browser/lib/esm/cookie-migration/index.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants */ "./node_modules/@amplitude/analytics-browser/lib/esm/constants.js");










// Exported for testing purposes only. Do not expose to public interface.
var BrowserConfig = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(BrowserConfig, _super);
    function BrowserConfig(apiKey, appVersion, cookieStorage, cookieOptions, defaultTracking, deviceId, flushIntervalMillis, flushMaxRetries, flushQueueSize, identityStorage, ingestionMetadata, instanceName, lastEventId, lastEventTime, loggerProvider, logLevel, minIdLength, optOut, partnerId, plan, serverUrl, serverZone, sessionId, sessionTimeout, storageProvider, trackingOptions, transport, useBatch, userId) {
        if (cookieStorage === void 0) { cookieStorage = new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.MemoryStorage(); }
        if (cookieOptions === void 0) { cookieOptions = {
            domain: '',
            expiration: 365,
            sameSite: 'Lax',
            secure: false,
            upgrade: true,
        }; }
        if (defaultTracking === void 0) { defaultTracking = true; }
        if (flushIntervalMillis === void 0) { flushIntervalMillis = 1000; }
        if (flushMaxRetries === void 0) { flushMaxRetries = 5; }
        if (flushQueueSize === void 0) { flushQueueSize = 30; }
        if (identityStorage === void 0) { identityStorage = _constants__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_IDENTITY_STORAGE; }
        if (loggerProvider === void 0) { loggerProvider = new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__.Logger(); }
        if (logLevel === void 0) { logLevel = _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__.LogLevel.Warn; }
        if (optOut === void 0) { optOut = false; }
        if (serverUrl === void 0) { serverUrl = ''; }
        if (serverZone === void 0) { serverZone = _constants__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_SERVER_ZONE; }
        if (sessionTimeout === void 0) { sessionTimeout = 30 * 60 * 1000; }
        if (storageProvider === void 0) { storageProvider = new _storage_local_storage__WEBPACK_IMPORTED_MODULE_5__.LocalStorage({ loggerProvider: loggerProvider }); }
        if (trackingOptions === void 0) { trackingOptions = {
            ipAddress: true,
            language: true,
            platform: true,
        }; }
        if (transport === void 0) { transport = 'fetch'; }
        if (useBatch === void 0) { useBatch = false; }
        var _this = _super.call(this, { apiKey: apiKey, storageProvider: storageProvider, transportProvider: createTransport(transport) }) || this;
        _this.apiKey = apiKey;
        _this.appVersion = appVersion;
        _this.cookieOptions = cookieOptions;
        _this.defaultTracking = defaultTracking;
        _this.flushIntervalMillis = flushIntervalMillis;
        _this.flushMaxRetries = flushMaxRetries;
        _this.flushQueueSize = flushQueueSize;
        _this.identityStorage = identityStorage;
        _this.ingestionMetadata = ingestionMetadata;
        _this.instanceName = instanceName;
        _this.loggerProvider = loggerProvider;
        _this.logLevel = logLevel;
        _this.minIdLength = minIdLength;
        _this.partnerId = partnerId;
        _this.plan = plan;
        _this.serverUrl = serverUrl;
        _this.serverZone = serverZone;
        _this.sessionTimeout = sessionTimeout;
        _this.storageProvider = storageProvider;
        _this.trackingOptions = trackingOptions;
        _this.transport = transport;
        _this.useBatch = useBatch;
        _this._optOut = false;
        _this._cookieStorage = cookieStorage;
        _this.deviceId = deviceId;
        _this.lastEventId = lastEventId;
        _this.lastEventTime = lastEventTime;
        _this.optOut = optOut;
        _this.sessionId = sessionId;
        _this.userId = userId;
        _this.loggerProvider.enable(_this.logLevel);
        return _this;
    }
    Object.defineProperty(BrowserConfig.prototype, "cookieStorage", {
        get: function () {
            return this._cookieStorage;
        },
        set: function (cookieStorage) {
            if (this._cookieStorage !== cookieStorage) {
                this._cookieStorage = cookieStorage;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BrowserConfig.prototype, "deviceId", {
        get: function () {
            return this._deviceId;
        },
        set: function (deviceId) {
            if (this._deviceId !== deviceId) {
                this._deviceId = deviceId;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BrowserConfig.prototype, "userId", {
        get: function () {
            return this._userId;
        },
        set: function (userId) {
            if (this._userId !== userId) {
                this._userId = userId;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BrowserConfig.prototype, "sessionId", {
        get: function () {
            return this._sessionId;
        },
        set: function (sessionId) {
            if (this._sessionId !== sessionId) {
                this._sessionId = sessionId;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BrowserConfig.prototype, "optOut", {
        get: function () {
            return this._optOut;
        },
        set: function (optOut) {
            if (this._optOut !== optOut) {
                this._optOut = optOut;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BrowserConfig.prototype, "lastEventTime", {
        get: function () {
            return this._lastEventTime;
        },
        set: function (lastEventTime) {
            if (this._lastEventTime !== lastEventTime) {
                this._lastEventTime = lastEventTime;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(BrowserConfig.prototype, "lastEventId", {
        get: function () {
            return this._lastEventId;
        },
        set: function (lastEventId) {
            if (this._lastEventId !== lastEventId) {
                this._lastEventId = lastEventId;
                this.updateStorage();
            }
        },
        enumerable: false,
        configurable: true
    });
    BrowserConfig.prototype.updateStorage = function () {
        var cache = {
            deviceId: this._deviceId,
            userId: this._userId,
            sessionId: this._sessionId,
            optOut: this._optOut,
            lastEventTime: this._lastEventTime,
            lastEventId: this._lastEventId,
        };
        void this.cookieStorage.set((0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_6__.getCookieName)(this.apiKey), cache);
    };
    return BrowserConfig;
}(_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_7__.Config));

var useBrowserConfig = function (apiKey, options, amplitudeInstance) {
    if (options === void 0) { options = {}; }
    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
        var identityStorage, cookieOptions, _a, _b, _c, cookieStorage, legacyCookies, previousCookies, queryParams, deviceId, lastEventId, lastEventTime, optOut, sessionId, userId, trackingOptions;
        var _d;
        var _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_3) {
            switch (_3.label) {
                case 0:
                    identityStorage = options.identityStorage || _constants__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_IDENTITY_STORAGE;
                    _a = [(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, options.cookieOptions)];
                    _d = {};
                    if (!(identityStorage !== _constants__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_IDENTITY_STORAGE)) return [3 /*break*/, 1];
                    _b = '';
                    return [3 /*break*/, 5];
                case 1:
                    if (!((_f = (_e = options.cookieOptions) === null || _e === void 0 ? void 0 : _e.domain) !== null && _f !== void 0)) return [3 /*break*/, 2];
                    _c = _f;
                    return [3 /*break*/, 4];
                case 2: return [4 /*yield*/, getTopLevelDomain()];
                case 3:
                    _c = (_3.sent());
                    _3.label = 4;
                case 4:
                    _b = _c;
                    _3.label = 5;
                case 5:
                    cookieOptions = tslib__WEBPACK_IMPORTED_MODULE_0__.__assign.apply(void 0, _a.concat([(_d.domain = _b, _d.expiration = 365, _d.sameSite = 'Lax', _d.secure = false, _d.upgrade = true, _d)]));
                    cookieStorage = createCookieStorage(options.identityStorage, cookieOptions);
                    return [4 /*yield*/, (0,_cookie_migration__WEBPACK_IMPORTED_MODULE_8__.parseLegacyCookies)(apiKey, cookieStorage, (_h = (_g = options.cookieOptions) === null || _g === void 0 ? void 0 : _g.upgrade) !== null && _h !== void 0 ? _h : true)];
                case 6:
                    legacyCookies = _3.sent();
                    return [4 /*yield*/, cookieStorage.get((0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_6__.getCookieName)(apiKey))];
                case 7:
                    previousCookies = _3.sent();
                    queryParams = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_9__.getQueryParams)();
                    deviceId = (_m = (_l = (_k = (_j = options.deviceId) !== null && _j !== void 0 ? _j : queryParams.deviceId) !== null && _k !== void 0 ? _k : previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.deviceId) !== null && _l !== void 0 ? _l : legacyCookies.deviceId) !== null && _m !== void 0 ? _m : (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_10__.UUID)();
                    lastEventId = (_o = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.lastEventId) !== null && _o !== void 0 ? _o : legacyCookies.lastEventId;
                    lastEventTime = (_p = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.lastEventTime) !== null && _p !== void 0 ? _p : legacyCookies.lastEventTime;
                    optOut = (_r = (_q = options.optOut) !== null && _q !== void 0 ? _q : previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.optOut) !== null && _r !== void 0 ? _r : legacyCookies.optOut;
                    sessionId = (_s = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.sessionId) !== null && _s !== void 0 ? _s : legacyCookies.sessionId;
                    userId = (_u = (_t = options.userId) !== null && _t !== void 0 ? _t : previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.userId) !== null && _u !== void 0 ? _u : legacyCookies.userId;
                    amplitudeInstance.previousSessionDeviceId = (_v = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.deviceId) !== null && _v !== void 0 ? _v : legacyCookies.deviceId;
                    amplitudeInstance.previousSessionUserId = (_w = previousCookies === null || previousCookies === void 0 ? void 0 : previousCookies.userId) !== null && _w !== void 0 ? _w : legacyCookies.userId;
                    trackingOptions = {
                        ipAddress: (_y = (_x = options.trackingOptions) === null || _x === void 0 ? void 0 : _x.ipAddress) !== null && _y !== void 0 ? _y : true,
                        language: (_0 = (_z = options.trackingOptions) === null || _z === void 0 ? void 0 : _z.language) !== null && _0 !== void 0 ? _0 : true,
                        platform: (_2 = (_1 = options.trackingOptions) === null || _1 === void 0 ? void 0 : _1.platform) !== null && _2 !== void 0 ? _2 : true,
                    };
                    return [2 /*return*/, new BrowserConfig(apiKey, options.appVersion, cookieStorage, cookieOptions, options.defaultTracking, deviceId, options.flushIntervalMillis, options.flushMaxRetries, options.flushQueueSize, identityStorage, options.ingestionMetadata, options.instanceName, lastEventId, lastEventTime, options.loggerProvider, options.logLevel, options.minIdLength, optOut, options.partnerId, options.plan, options.serverUrl, options.serverZone, sessionId, options.sessionTimeout, options.storageProvider, trackingOptions, options.transport, options.useBatch, userId)];
            }
        });
    });
};
var createCookieStorage = function (identityStorage, cookieOptions) {
    if (identityStorage === void 0) { identityStorage = _constants__WEBPACK_IMPORTED_MODULE_2__.DEFAULT_IDENTITY_STORAGE; }
    if (cookieOptions === void 0) { cookieOptions = {}; }
    switch (identityStorage) {
        case 'localStorage':
            return new _storage_local_storage__WEBPACK_IMPORTED_MODULE_5__.LocalStorage();
        case 'sessionStorage':
            return new _storage_session_storage__WEBPACK_IMPORTED_MODULE_11__.SessionStorage();
        case 'none':
            return new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.MemoryStorage();
        case 'cookie':
        default:
            return new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_12__.CookieStorage((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, cookieOptions), { expirationDays: cookieOptions.expiration }));
    }
};
var createTransport = function (transport) {
    if (transport === 'xhr') {
        return new _transports_xhr__WEBPACK_IMPORTED_MODULE_13__.XHRTransport();
    }
    if (transport === 'beacon') {
        return new _transports_send_beacon__WEBPACK_IMPORTED_MODULE_14__.SendBeaconTransport();
    }
    return new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_15__.FetchTransport();
};
var getTopLevelDomain = function (url) { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
    var host, parts, levels, storageKey, i, i, domain, options, storage, value;
    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
        switch (_a.label) {
            case 0: return [4 /*yield*/, new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_12__.CookieStorage().isEnabled()];
            case 1:
                if (!(_a.sent()) || (!url && typeof location === 'undefined')) {
                    return [2 /*return*/, ''];
                }
                host = url !== null && url !== void 0 ? url : location.hostname;
                parts = host.split('.');
                levels = [];
                storageKey = 'AMP_TLDTEST';
                for (i = parts.length - 2; i >= 0; --i) {
                    levels.push(parts.slice(i).join('.'));
                }
                i = 0;
                _a.label = 2;
            case 2:
                if (!(i < levels.length)) return [3 /*break*/, 7];
                domain = levels[i];
                options = { domain: '.' + domain };
                storage = new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_12__.CookieStorage(options);
                return [4 /*yield*/, storage.set(storageKey, 1)];
            case 3:
                _a.sent();
                return [4 /*yield*/, storage.get(storageKey)];
            case 4:
                value = _a.sent();
                if (!value) return [3 /*break*/, 6];
                return [4 /*yield*/, storage.remove(storageKey)];
            case 5:
                _a.sent();
                return [2 /*return*/, '.' + domain];
            case 6:
                i++;
                return [3 /*break*/, 2];
            case 7: return [2 /*return*/, ''];
        }
    });
}); };
//# sourceMappingURL=config.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/constants.js":
/*!************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/constants.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DEFAULT_EVENT_PREFIX": () => (/* binding */ DEFAULT_EVENT_PREFIX),
/* harmony export */   "DEFAULT_FILE_DOWNLOAD_EVENT": () => (/* binding */ DEFAULT_FILE_DOWNLOAD_EVENT),
/* harmony export */   "DEFAULT_FORM_START_EVENT": () => (/* binding */ DEFAULT_FORM_START_EVENT),
/* harmony export */   "DEFAULT_FORM_SUBMIT_EVENT": () => (/* binding */ DEFAULT_FORM_SUBMIT_EVENT),
/* harmony export */   "DEFAULT_IDENTITY_STORAGE": () => (/* binding */ DEFAULT_IDENTITY_STORAGE),
/* harmony export */   "DEFAULT_PAGE_VIEW_EVENT": () => (/* binding */ DEFAULT_PAGE_VIEW_EVENT),
/* harmony export */   "DEFAULT_SERVER_ZONE": () => (/* binding */ DEFAULT_SERVER_ZONE),
/* harmony export */   "DEFAULT_SESSION_END_EVENT": () => (/* binding */ DEFAULT_SESSION_END_EVENT),
/* harmony export */   "DEFAULT_SESSION_START_EVENT": () => (/* binding */ DEFAULT_SESSION_START_EVENT),
/* harmony export */   "FILE_EXTENSION": () => (/* binding */ FILE_EXTENSION),
/* harmony export */   "FILE_NAME": () => (/* binding */ FILE_NAME),
/* harmony export */   "FORM_DESTINATION": () => (/* binding */ FORM_DESTINATION),
/* harmony export */   "FORM_ID": () => (/* binding */ FORM_ID),
/* harmony export */   "FORM_NAME": () => (/* binding */ FORM_NAME),
/* harmony export */   "LINK_ID": () => (/* binding */ LINK_ID),
/* harmony export */   "LINK_TEXT": () => (/* binding */ LINK_TEXT),
/* harmony export */   "LINK_URL": () => (/* binding */ LINK_URL)
/* harmony export */ });
var DEFAULT_EVENT_PREFIX = '[Amplitude]';
var DEFAULT_PAGE_VIEW_EVENT = "".concat(DEFAULT_EVENT_PREFIX, " Page Viewed");
var DEFAULT_FORM_START_EVENT = "".concat(DEFAULT_EVENT_PREFIX, " Form Started");
var DEFAULT_FORM_SUBMIT_EVENT = "".concat(DEFAULT_EVENT_PREFIX, " Form Submitted");
var DEFAULT_FILE_DOWNLOAD_EVENT = "".concat(DEFAULT_EVENT_PREFIX, " File Downloaded");
var DEFAULT_SESSION_START_EVENT = 'session_start';
var DEFAULT_SESSION_END_EVENT = 'session_end';
var FILE_EXTENSION = "".concat(DEFAULT_EVENT_PREFIX, " File Extension");
var FILE_NAME = "".concat(DEFAULT_EVENT_PREFIX, " File Name");
var LINK_ID = "".concat(DEFAULT_EVENT_PREFIX, " Link ID");
var LINK_TEXT = "".concat(DEFAULT_EVENT_PREFIX, " Link Text");
var LINK_URL = "".concat(DEFAULT_EVENT_PREFIX, " Link URL");
var FORM_ID = "".concat(DEFAULT_EVENT_PREFIX, " Form ID");
var FORM_NAME = "".concat(DEFAULT_EVENT_PREFIX, " Form Name");
var FORM_DESTINATION = "".concat(DEFAULT_EVENT_PREFIX, " Form Destination");
var DEFAULT_IDENTITY_STORAGE = 'cookie';
var DEFAULT_SERVER_ZONE = 'US';
//# sourceMappingURL=constants.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/cookie-migration/index.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/cookie-migration/index.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "decode": () => (/* binding */ decode),
/* harmony export */   "parseLegacyCookies": () => (/* binding */ parseLegacyCookies),
/* harmony export */   "parseTime": () => (/* binding */ parseTime)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/cookie-name.js");


var parseLegacyCookies = function (apiKey, cookieStorage, deleteLegacyCookies) {
    if (deleteLegacyCookies === void 0) { deleteLegacyCookies = true; }
    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
        var cookieName, cookies, _a, deviceId, userId, optOut, sessionId, lastEventTime, lastEventId;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
            switch (_b.label) {
                case 0:
                    cookieName = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__.getOldCookieName)(apiKey);
                    return [4 /*yield*/, cookieStorage.getRaw(cookieName)];
                case 1:
                    cookies = _b.sent();
                    if (!cookies) {
                        return [2 /*return*/, {
                                optOut: false,
                            }];
                    }
                    if (!deleteLegacyCookies) return [3 /*break*/, 3];
                    return [4 /*yield*/, cookieStorage.remove(cookieName)];
                case 2:
                    _b.sent();
                    _b.label = 3;
                case 3:
                    _a = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(cookies.split('.'), 6), deviceId = _a[0], userId = _a[1], optOut = _a[2], sessionId = _a[3], lastEventTime = _a[4], lastEventId = _a[5];
                    return [2 /*return*/, {
                            deviceId: deviceId,
                            userId: decode(userId),
                            sessionId: parseTime(sessionId),
                            lastEventId: parseTime(lastEventId),
                            lastEventTime: parseTime(lastEventTime),
                            optOut: Boolean(optOut),
                        }];
            }
        });
    });
};
var parseTime = function (num) {
    var integer = parseInt(num, 32);
    if (isNaN(integer)) {
        return undefined;
    }
    return integer;
};
var decode = function (value) {
    if (!atob || !escape || !value) {
        return undefined;
    }
    try {
        return decodeURIComponent(escape(atob(value)));
    }
    catch (_a) {
        return undefined;
    }
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/det-notification.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/det-notification.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "detNotify": () => (/* binding */ detNotify),
/* harmony export */   "resetNotify": () => (/* binding */ resetNotify)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/default-tracking.js");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js");


var notified = false;
var detNotify = function (config) {
    if (notified) {
        return;
    }
    var enabledTracking = [
        (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__.isPageViewTrackingEnabled)(config.defaultTracking) ? 'Page Views' : '',
        (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__.isSessionTrackingEnabled)(config.defaultTracking) ? 'Sessions' : '',
        (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__.isFileDownloadTrackingEnabled)(config.defaultTracking) ? 'File Downloads' : '',
        (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__.isFormInteractionTrackingEnabled)(config.defaultTracking) ? 'Form Interactions' : '',
    ].filter(Boolean);
    var enabledTrackingString = enabledTracking.join(', ');
    if (enabledTracking.length) {
        var message = "Your Amplitude instance is configured to track ".concat(enabledTrackingString, ". Visit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.");
        config.loggerProvider.log(message);
        /* istanbul ignore if */
        if (config.logLevel < _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.LogLevel.Verbose) {
            console.log(message);
        }
    }
    notified = true;
};
/**
 * @private
 * This function is meant for testing purposes only
 */
var resetNotify = function () {
    notified = false;
};
//# sourceMappingURL=det-notification.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/index.js":
/*!********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/index.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Identify": () => (/* reexport safe */ _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__.Identify),
/* harmony export */   "Revenue": () => (/* reexport safe */ _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_2__.Revenue),
/* harmony export */   "Types": () => (/* reexport module object */ _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__),
/* harmony export */   "add": () => (/* binding */ add),
/* harmony export */   "createInstance": () => (/* reexport safe */ _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__.createInstance),
/* harmony export */   "extendSession": () => (/* binding */ extendSession),
/* harmony export */   "flush": () => (/* binding */ flush),
/* harmony export */   "getDeviceId": () => (/* binding */ getDeviceId),
/* harmony export */   "getSessionId": () => (/* binding */ getSessionId),
/* harmony export */   "getUserId": () => (/* binding */ getUserId),
/* harmony export */   "groupIdentify": () => (/* binding */ groupIdentify),
/* harmony export */   "identify": () => (/* binding */ identify),
/* harmony export */   "init": () => (/* binding */ init),
/* harmony export */   "logEvent": () => (/* binding */ logEvent),
/* harmony export */   "remove": () => (/* binding */ remove),
/* harmony export */   "reset": () => (/* binding */ reset),
/* harmony export */   "revenue": () => (/* binding */ revenue),
/* harmony export */   "runQueuedFunctions": () => (/* reexport safe */ _utils_snippet_helper__WEBPACK_IMPORTED_MODULE_1__.runQueuedFunctions),
/* harmony export */   "setDeviceId": () => (/* binding */ setDeviceId),
/* harmony export */   "setGroup": () => (/* binding */ setGroup),
/* harmony export */   "setOptOut": () => (/* binding */ setOptOut),
/* harmony export */   "setSessionId": () => (/* binding */ setSessionId),
/* harmony export */   "setTransport": () => (/* binding */ setTransport),
/* harmony export */   "setUserId": () => (/* binding */ setUserId),
/* harmony export */   "track": () => (/* binding */ track)
/* harmony export */ });
/* harmony import */ var _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./browser-client-factory */ "./node_modules/@amplitude/analytics-browser/lib/esm/browser-client-factory.js");
/* harmony import */ var _utils_snippet_helper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/snippet-helper */ "./node_modules/@amplitude/analytics-browser/lib/esm/utils/snippet-helper.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/revenue.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/identify.js");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/index.js");
/* eslint-disable @typescript-eslint/unbound-method */


var add = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].add, extendSession = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].extendSession, flush = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].flush, getDeviceId = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].getDeviceId, getSessionId = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].getSessionId, getUserId = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].getUserId, groupIdentify = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].groupIdentify, identify = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].identify, init = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].init, logEvent = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].logEvent, remove = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].remove, reset = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].reset, revenue = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].revenue, setDeviceId = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].setDeviceId, setGroup = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].setGroup, setOptOut = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].setOptOut, setSessionId = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].setSessionId, setTransport = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].setTransport, setUserId = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].setUserId, track = _browser_client_factory__WEBPACK_IMPORTED_MODULE_0__["default"].track;




//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/plugins/context.js":
/*!******************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/plugins/context.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Context": () => (/* binding */ Context)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/language.js");
/* harmony import */ var _version__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../version */ "./node_modules/@amplitude/analytics-browser/lib/esm/version.js");




var BROWSER_PLATFORM = 'Web';
var IP_ADDRESS = '$remote';
var Context = /** @class */ (function () {
    function Context() {
        this.name = '@amplitude/plugin-context-browser';
        this.type = 'before';
        this.library = "amplitude-ts/".concat(_version__WEBPACK_IMPORTED_MODULE_0__.VERSION);
        /* istanbul ignore else */
        if (typeof navigator !== 'undefined') {
            this.userAgent = navigator.userAgent;
        }
    }
    Context.prototype.setup = function (config) {
        this.config = config;
        return Promise.resolve(undefined);
    };
    Context.prototype.execute = function (context) {
        var _a, _b;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            var time, lastEventId, nextEventId, event;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_c) {
                time = new Date().getTime();
                lastEventId = (_a = this.config.lastEventId) !== null && _a !== void 0 ? _a : -1;
                nextEventId = (_b = context.event_id) !== null && _b !== void 0 ? _b : lastEventId + 1;
                this.config.lastEventId = nextEventId;
                if (!context.time) {
                    this.config.lastEventTime = time;
                }
                event = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({ user_id: this.config.userId, device_id: this.config.deviceId, session_id: this.config.sessionId, time: time }, (this.config.appVersion && { app_version: this.config.appVersion })), (this.config.trackingOptions.platform && { platform: BROWSER_PLATFORM })), (this.config.trackingOptions.language && { language: (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_2__.getLanguage)() })), (this.config.trackingOptions.ipAddress && { ip: IP_ADDRESS })), { insert_id: (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__.UUID)(), partner_id: this.config.partnerId, plan: this.config.plan }), (this.config.ingestionMetadata && {
                    ingestion_metadata: {
                        source_name: this.config.ingestionMetadata.sourceName,
                        source_version: this.config.ingestionMetadata.sourceVersion,
                    },
                })), context), { event_id: nextEventId, library: this.library, user_agent: this.userAgent });
                return [2 /*return*/, event];
            });
        });
    };
    return Context;
}());

//# sourceMappingURL=context.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/plugins/file-download-tracking.js":
/*!*********************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/plugins/file-download-tracking.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "fileDownloadTracking": () => (/* binding */ fileDownloadTracking)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./node_modules/@amplitude/analytics-browser/lib/esm/constants.js");


var fileDownloadTracking = function () {
    var observer;
    var eventListeners = [];
    var addEventListener = function (element, type, handler) {
        element.addEventListener(type, handler);
        eventListeners.push({
            element: element,
            type: type,
            handler: handler,
        });
    };
    var removeClickListeners = function () {
        eventListeners.forEach(function (_a) {
            var element = _a.element, type = _a.type, handler = _a.handler;
            /* istanbul ignore next */
            element === null || element === void 0 ? void 0 : element.removeEventListener(type, handler);
        });
        eventListeners = [];
    };
    var name = '@amplitude/plugin-file-download-tracking-browser';
    var type = 'enrichment';
    var setup = function (config, amplitude) { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
        var addFileDownloadListener, ext, links;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
            /* istanbul ignore if */
            if (!amplitude) {
                // TODO: Add required minimum version of @amplitude/analytics-browser
                config.loggerProvider.warn('File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.');
                return [2 /*return*/];
            }
            /* istanbul ignore if */
            if (typeof document === 'undefined') {
                return [2 /*return*/];
            }
            addFileDownloadListener = function (a) {
                var url;
                try {
                    // eslint-disable-next-line no-restricted-globals
                    url = new URL(a.href, window.location.href);
                }
                catch (_a) {
                    /* istanbul ignore next */
                    return;
                }
                var result = ext.exec(url.href);
                var fileExtension = result === null || result === void 0 ? void 0 : result[1];
                if (fileExtension) {
                    addEventListener(a, 'click', function () {
                        var _a;
                        if (fileExtension) {
                            amplitude.track(_constants__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_FILE_DOWNLOAD_EVENT, (_a = {},
                                _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FILE_EXTENSION] = fileExtension,
                                _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FILE_NAME] = url.pathname,
                                _a[_constants__WEBPACK_IMPORTED_MODULE_1__.LINK_ID] = a.id,
                                _a[_constants__WEBPACK_IMPORTED_MODULE_1__.LINK_TEXT] = a.text,
                                _a[_constants__WEBPACK_IMPORTED_MODULE_1__.LINK_URL] = a.href,
                                _a));
                        }
                    });
                }
            };
            ext = /\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)$/;
            links = Array.from(document.getElementsByTagName('a'));
            links.forEach(addFileDownloadListener);
            // Adds listener to anchor tags added after initial load
            /* istanbul ignore else */
            if (typeof MutationObserver !== 'undefined') {
                observer = new MutationObserver(function (mutations) {
                    mutations.forEach(function (mutation) {
                        mutation.addedNodes.forEach(function (node) {
                            if (node.nodeName === 'A') {
                                addFileDownloadListener(node);
                            }
                            if ('querySelectorAll' in node && typeof node.querySelectorAll === 'function') {
                                Array.from(node.querySelectorAll('a')).map(addFileDownloadListener);
                            }
                        });
                    });
                });
                observer.observe(document.body, {
                    subtree: true,
                    childList: true,
                });
            }
            return [2 /*return*/];
        });
    }); };
    var execute = function (event) { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
        return [2 /*return*/, event];
    }); }); };
    var teardown = function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
            observer === null || observer === void 0 ? void 0 : observer.disconnect();
            removeClickListeners();
            return [2 /*return*/];
        });
    }); };
    return {
        name: name,
        type: type,
        setup: setup,
        execute: execute,
        teardown: teardown,
    };
};
//# sourceMappingURL=file-download-tracking.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/plugins/form-interaction-tracking.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/plugins/form-interaction-tracking.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "formInteractionTracking": () => (/* binding */ formInteractionTracking)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./node_modules/@amplitude/analytics-browser/lib/esm/constants.js");


var formInteractionTracking = function () {
    var observer;
    var eventListeners = [];
    var addEventListener = function (element, type, handler) {
        element.addEventListener(type, handler);
        eventListeners.push({
            element: element,
            type: type,
            handler: handler,
        });
    };
    var removeClickListeners = function () {
        eventListeners.forEach(function (_a) {
            var element = _a.element, type = _a.type, handler = _a.handler;
            /* istanbul ignore next */
            element === null || element === void 0 ? void 0 : element.removeEventListener(type, handler);
        });
        eventListeners = [];
    };
    var name = '@amplitude/plugin-form-interaction-tracking-browser';
    var type = 'enrichment';
    var setup = function (config, amplitude) { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
        var addFormInteractionListener, forms;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
            /* istanbul ignore if */
            if (!amplitude) {
                // TODO: Add required minimum version of @amplitude/analytics-browser
                config.loggerProvider.warn('Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.');
                return [2 /*return*/];
            }
            /* istanbul ignore if */
            if (typeof document === 'undefined') {
                return [2 /*return*/];
            }
            addFormInteractionListener = function (form) {
                var hasFormChanged = false;
                addEventListener(form, 'change', function () {
                    var _a;
                    if (!hasFormChanged) {
                        amplitude.track(_constants__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_FORM_START_EVENT, (_a = {},
                            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_ID] = form.id,
                            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_NAME] = form.name,
                            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_DESTINATION] = form.action,
                            _a));
                    }
                    hasFormChanged = true;
                });
                addEventListener(form, 'submit', function () {
                    var _a, _b;
                    if (!hasFormChanged) {
                        amplitude.track(_constants__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_FORM_START_EVENT, (_a = {},
                            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_ID] = form.id,
                            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_NAME] = form.name,
                            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_DESTINATION] = form.action,
                            _a));
                    }
                    amplitude.track(_constants__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_FORM_SUBMIT_EVENT, (_b = {},
                        _b[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_ID] = form.id,
                        _b[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_NAME] = form.name,
                        _b[_constants__WEBPACK_IMPORTED_MODULE_1__.FORM_DESTINATION] = form.action,
                        _b));
                    hasFormChanged = false;
                });
            };
            forms = Array.from(document.getElementsByTagName('form'));
            forms.forEach(addFormInteractionListener);
            // Adds listener to anchor tags added after initial load
            /* istanbul ignore else */
            if (typeof MutationObserver !== 'undefined') {
                observer = new MutationObserver(function (mutations) {
                    mutations.forEach(function (mutation) {
                        mutation.addedNodes.forEach(function (node) {
                            if (node.nodeName === 'FORM') {
                                addFormInteractionListener(node);
                            }
                            if ('querySelectorAll' in node && typeof node.querySelectorAll === 'function') {
                                Array.from(node.querySelectorAll('form')).map(addFormInteractionListener);
                            }
                        });
                    });
                });
                observer.observe(document.body, {
                    subtree: true,
                    childList: true,
                });
            }
            return [2 /*return*/];
        });
    }); };
    var execute = function (event) { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
        return [2 /*return*/, event];
    }); }); };
    var teardown = function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(void 0, void 0, void 0, function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
            observer === null || observer === void 0 ? void 0 : observer.disconnect();
            removeClickListeners();
            return [2 /*return*/];
        });
    }); };
    return {
        name: name,
        type: type,
        setup: setup,
        execute: execute,
        teardown: teardown,
    };
};
//# sourceMappingURL=form-interaction-tracking.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/browser-storage.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/storage/browser-storage.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BrowserStorage": () => (/* binding */ BrowserStorage)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");

var BrowserStorage = /** @class */ (function () {
    function BrowserStorage(storage) {
        this.storage = storage;
    }
    BrowserStorage.prototype.isEnabled = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var random, testStorage, testKey, value, _a;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        /* istanbul ignore if */
                        if (!this.storage) {
                            return [2 /*return*/, false];
                        }
                        random = String(Date.now());
                        testStorage = new BrowserStorage(this.storage);
                        testKey = 'AMP_TEST';
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 4, 5, 7]);
                        return [4 /*yield*/, testStorage.set(testKey, random)];
                    case 2:
                        _b.sent();
                        return [4 /*yield*/, testStorage.get(testKey)];
                    case 3:
                        value = _b.sent();
                        return [2 /*return*/, value === random];
                    case 4:
                        _a = _b.sent();
                        /* istanbul ignore next */
                        return [2 /*return*/, false];
                    case 5: return [4 /*yield*/, testStorage.remove(testKey)];
                    case 6:
                        _b.sent();
                        return [7 /*endfinally*/];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    BrowserStorage.prototype.get = function (key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var value, _a;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _b.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.getRaw(key)];
                    case 1:
                        value = _b.sent();
                        if (!value) {
                            return [2 /*return*/, undefined];
                        }
                        // eslint-disable-next-line @typescript-eslint/no-unsafe-return
                        return [2 /*return*/, JSON.parse(value)];
                    case 2:
                        _a = _b.sent();
                        console.error("[Amplitude] Error: Could not get value from storage");
                        return [2 /*return*/, undefined];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    BrowserStorage.prototype.getRaw = function (key) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                return [2 /*return*/, ((_a = this.storage) === null || _a === void 0 ? void 0 : _a.getItem(key)) || undefined];
            });
        });
    };
    BrowserStorage.prototype.set = function (key, value) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                try {
                    (_a = this.storage) === null || _a === void 0 ? void 0 : _a.setItem(key, JSON.stringify(value));
                }
                catch (_c) {
                    //
                }
                return [2 /*return*/];
            });
        });
    };
    BrowserStorage.prototype.remove = function (key) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                try {
                    (_a = this.storage) === null || _a === void 0 ? void 0 : _a.removeItem(key);
                }
                catch (_c) {
                    //
                }
                return [2 /*return*/];
            });
        });
    };
    BrowserStorage.prototype.reset = function () {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                try {
                    (_a = this.storage) === null || _a === void 0 ? void 0 : _a.clear();
                }
                catch (_c) {
                    //
                }
                return [2 /*return*/];
            });
        });
    };
    return BrowserStorage;
}());

//# sourceMappingURL=browser-storage.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/local-storage.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/storage/local-storage.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LocalStorage": () => (/* binding */ LocalStorage)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js");
/* harmony import */ var _browser_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./browser-storage */ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/browser-storage.js");



var MAX_ARRAY_LENGTH = 1000;
var LocalStorage = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(LocalStorage, _super);
    function LocalStorage(config) {
        var _this = this;
        var _a;
        _this = _super.call(this, (_a = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__.getGlobalScope)()) === null || _a === void 0 ? void 0 : _a.localStorage) || this;
        _this.loggerProvider = config === null || config === void 0 ? void 0 : config.loggerProvider;
        return _this;
    }
    LocalStorage.prototype.set = function (key, value) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var droppedEventsCount;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!(Array.isArray(value) && value.length > MAX_ARRAY_LENGTH)) return [3 /*break*/, 2];
                        droppedEventsCount = value.length - MAX_ARRAY_LENGTH;
                        return [4 /*yield*/, _super.prototype.set.call(this, key, value.slice(0, MAX_ARRAY_LENGTH))];
                    case 1:
                        _b.sent();
                        (_a = this.loggerProvider) === null || _a === void 0 ? void 0 : _a.error("Failed to save ".concat(droppedEventsCount, " events because the queue length exceeded ").concat(MAX_ARRAY_LENGTH, "."));
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, _super.prototype.set.call(this, key, value)];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    return LocalStorage;
}(_browser_storage__WEBPACK_IMPORTED_MODULE_2__.BrowserStorage));

//# sourceMappingURL=local-storage.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/session-storage.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/storage/session-storage.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SessionStorage": () => (/* binding */ SessionStorage)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js");
/* harmony import */ var _browser_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./browser-storage */ "./node_modules/@amplitude/analytics-browser/lib/esm/storage/browser-storage.js");



var SessionStorage = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(SessionStorage, _super);
    function SessionStorage() {
        var _a;
        return _super.call(this, (_a = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__.getGlobalScope)()) === null || _a === void 0 ? void 0 : _a.sessionStorage) || this;
    }
    return SessionStorage;
}(_browser_storage__WEBPACK_IMPORTED_MODULE_2__.BrowserStorage));

//# sourceMappingURL=session-storage.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/transports/send-beacon.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/transports/send-beacon.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SendBeaconTransport": () => (/* binding */ SendBeaconTransport)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/transports/base.js");



var SendBeaconTransport = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(SendBeaconTransport, _super);
    function SendBeaconTransport() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SendBeaconTransport.prototype.send = function (serverUrl, payload) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                return [2 /*return*/, new Promise(function (resolve, reject) {
                        var globalScope = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_1__.getGlobalScope)();
                        /* istanbul ignore if */
                        if (!(globalScope === null || globalScope === void 0 ? void 0 : globalScope.navigator.sendBeacon)) {
                            throw new Error('SendBeaconTransport is not supported');
                        }
                        try {
                            var data = JSON.stringify(payload);
                            var success = globalScope.navigator.sendBeacon(serverUrl, JSON.stringify(payload));
                            if (success) {
                                return resolve(_this.buildResponse({
                                    code: 200,
                                    events_ingested: payload.events.length,
                                    payload_size_bytes: data.length,
                                    server_upload_time: Date.now(),
                                }));
                            }
                            return resolve(_this.buildResponse({ code: 500 }));
                        }
                        catch (e) {
                            reject(e);
                        }
                    })];
            });
        });
    };
    return SendBeaconTransport;
}(_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_2__.BaseTransport));

//# sourceMappingURL=send-beacon.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/transports/xhr.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/transports/xhr.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "XHRTransport": () => (/* binding */ XHRTransport)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/transports/base.js");


var XHRTransport = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(XHRTransport, _super);
    function XHRTransport() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.state = {
            done: 4,
        };
        return _this;
    }
    XHRTransport.prototype.send = function (serverUrl, payload) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                return [2 /*return*/, new Promise(function (resolve, reject) {
                        /* istanbul ignore if */
                        if (typeof XMLHttpRequest === 'undefined') {
                            reject(new Error('XHRTransport is not supported.'));
                        }
                        var xhr = new XMLHttpRequest();
                        xhr.open('POST', serverUrl, true);
                        xhr.onreadystatechange = function () {
                            if (xhr.readyState === _this.state.done) {
                                try {
                                    var responsePayload = xhr.responseText;
                                    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
                                    var parsedResponsePayload = JSON.parse(responsePayload);
                                    var result = _this.buildResponse(parsedResponsePayload);
                                    resolve(result);
                                }
                                catch (e) {
                                    reject(e);
                                }
                            }
                        };
                        xhr.setRequestHeader('Content-Type', 'application/json');
                        xhr.setRequestHeader('Accept', '*/*');
                        xhr.send(JSON.stringify(payload));
                    })];
            });
        });
    };
    return XHRTransport;
}(_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.BaseTransport));

//# sourceMappingURL=xhr.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/utils/snippet-helper.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/utils/snippet-helper.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "convertProxyObjectToRealObject": () => (/* binding */ convertProxyObjectToRealObject),
/* harmony export */   "isInstanceProxy": () => (/* binding */ isInstanceProxy),
/* harmony export */   "runQueuedFunctions": () => (/* binding */ runQueuedFunctions)
/* harmony export */ });
/**
 * Applies the proxied functions on the proxied amplitude snippet to an instance of the real object.
 * @ignore
 */
var runQueuedFunctions = function (instance, queue) {
    convertProxyObjectToRealObject(instance, queue);
};
/**
 * Applies the proxied functions on the proxied object to an instance of the real object.
 * Used to convert proxied Identify and Revenue objects.
 */
var convertProxyObjectToRealObject = function (instance, queue) {
    for (var i = 0; i < queue.length; i++) {
        var _a = queue[i], name_1 = _a.name, args = _a.args, resolve = _a.resolve;
        var fn = instance && instance[name_1];
        if (typeof fn === 'function') {
            var result = fn.apply(instance, args);
            if (typeof resolve === 'function') {
                resolve(result === null || result === void 0 ? void 0 : result.promise);
            }
        }
    }
    return instance;
};
/**
 * Check if the param is snippet proxy
 */
var isInstanceProxy = function (instance) {
    var instanceProxy = instance;
    return instanceProxy && instanceProxy._q !== undefined;
};
//# sourceMappingURL=snippet-helper.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-browser/lib/esm/version.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-browser/lib/esm/version.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VERSION": () => (/* binding */ VERSION)
/* harmony export */ });
var VERSION = '2.2.0';
//# sourceMappingURL=version.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/analytics-connector.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/analytics-connector.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getAnalyticsConnector": () => (/* binding */ getAnalyticsConnector),
/* harmony export */   "setConnectorDeviceId": () => (/* binding */ setConnectorDeviceId),
/* harmony export */   "setConnectorUserId": () => (/* binding */ setConnectorUserId)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_connector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-connector */ "./node_modules/@amplitude/analytics-connector/dist/analytics-connector.esm.js");

var getAnalyticsConnector = function (instanceName) {
    if (instanceName === void 0) { instanceName = '$default_instance'; }
    return _amplitude_analytics_connector__WEBPACK_IMPORTED_MODULE_0__.AnalyticsConnector.getInstance(instanceName);
};
var setConnectorUserId = function (userId, instanceName) {
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    // @ts-ignore
    getAnalyticsConnector(instanceName).identityStore.editIdentity().setUserId(userId).commit();
};
var setConnectorDeviceId = function (deviceId, instanceName) {
    getAnalyticsConnector(instanceName).identityStore.editIdentity().setDeviceId(deviceId).commit();
};
//# sourceMappingURL=analytics-connector.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/campaign-parser.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/campaign-parser.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CampaignParser": () => (/* binding */ CampaignParser)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _query_params__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../query-params */ "./node_modules/@amplitude/analytics-client-common/lib/esm/query-params.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./constants */ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/constants.js");



var CampaignParser = /** @class */ (function () {
    function CampaignParser() {
    }
    CampaignParser.prototype.parse = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                return [2 /*return*/, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, _constants__WEBPACK_IMPORTED_MODULE_1__.BASE_CAMPAIGN), this.getUtmParam()), this.getReferrer()), this.getClickIds())];
            });
        });
    };
    CampaignParser.prototype.getUtmParam = function () {
        var params = (0,_query_params__WEBPACK_IMPORTED_MODULE_2__.getQueryParams)();
        var utmCampaign = params[_constants__WEBPACK_IMPORTED_MODULE_1__.UTM_CAMPAIGN];
        var utmContent = params[_constants__WEBPACK_IMPORTED_MODULE_1__.UTM_CONTENT];
        var utmId = params[_constants__WEBPACK_IMPORTED_MODULE_1__.UTM_ID];
        var utmMedium = params[_constants__WEBPACK_IMPORTED_MODULE_1__.UTM_MEDIUM];
        var utmSource = params[_constants__WEBPACK_IMPORTED_MODULE_1__.UTM_SOURCE];
        var utmTerm = params[_constants__WEBPACK_IMPORTED_MODULE_1__.UTM_TERM];
        return {
            utm_campaign: utmCampaign,
            utm_content: utmContent,
            utm_id: utmId,
            utm_medium: utmMedium,
            utm_source: utmSource,
            utm_term: utmTerm,
        };
    };
    CampaignParser.prototype.getReferrer = function () {
        var _a, _b;
        var data = {
            referrer: undefined,
            referring_domain: undefined,
        };
        try {
            data.referrer = document.referrer || undefined;
            data.referring_domain = (_b = (_a = data.referrer) === null || _a === void 0 ? void 0 : _a.split('/')[2]) !== null && _b !== void 0 ? _b : undefined;
        }
        catch (_c) {
            // nothing to track
        }
        return data;
    };
    CampaignParser.prototype.getClickIds = function () {
        var _a;
        var params = (0,_query_params__WEBPACK_IMPORTED_MODULE_2__.getQueryParams)();
        return _a = {},
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.DCLID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.DCLID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.FBCLID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.FBCLID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.GBRAID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.GBRAID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.GCLID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.GCLID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.KO_CLICK_ID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.KO_CLICK_ID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.LI_FAT_ID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.LI_FAT_ID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.MSCLKID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.MSCLKID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.RDT_CID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.RDT_CID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.TTCLID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.TTCLID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.TWCLID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.TWCLID],
            _a[_constants__WEBPACK_IMPORTED_MODULE_1__.WBRAID] = params[_constants__WEBPACK_IMPORTED_MODULE_1__.WBRAID],
            _a;
    };
    return CampaignParser;
}());

//# sourceMappingURL=campaign-parser.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/constants.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/constants.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BASE_CAMPAIGN": () => (/* binding */ BASE_CAMPAIGN),
/* harmony export */   "DCLID": () => (/* binding */ DCLID),
/* harmony export */   "EMPTY_VALUE": () => (/* binding */ EMPTY_VALUE),
/* harmony export */   "FBCLID": () => (/* binding */ FBCLID),
/* harmony export */   "GBRAID": () => (/* binding */ GBRAID),
/* harmony export */   "GCLID": () => (/* binding */ GCLID),
/* harmony export */   "KO_CLICK_ID": () => (/* binding */ KO_CLICK_ID),
/* harmony export */   "LI_FAT_ID": () => (/* binding */ LI_FAT_ID),
/* harmony export */   "MKTG": () => (/* binding */ MKTG),
/* harmony export */   "MSCLKID": () => (/* binding */ MSCLKID),
/* harmony export */   "RDT_CID": () => (/* binding */ RDT_CID),
/* harmony export */   "TTCLID": () => (/* binding */ TTCLID),
/* harmony export */   "TWCLID": () => (/* binding */ TWCLID),
/* harmony export */   "UTM_CAMPAIGN": () => (/* binding */ UTM_CAMPAIGN),
/* harmony export */   "UTM_CONTENT": () => (/* binding */ UTM_CONTENT),
/* harmony export */   "UTM_ID": () => (/* binding */ UTM_ID),
/* harmony export */   "UTM_MEDIUM": () => (/* binding */ UTM_MEDIUM),
/* harmony export */   "UTM_SOURCE": () => (/* binding */ UTM_SOURCE),
/* harmony export */   "UTM_TERM": () => (/* binding */ UTM_TERM),
/* harmony export */   "WBRAID": () => (/* binding */ WBRAID)
/* harmony export */ });
var UTM_CAMPAIGN = 'utm_campaign';
var UTM_CONTENT = 'utm_content';
var UTM_ID = 'utm_id';
var UTM_MEDIUM = 'utm_medium';
var UTM_SOURCE = 'utm_source';
var UTM_TERM = 'utm_term';
var DCLID = 'dclid';
var FBCLID = 'fbclid';
var GBRAID = 'gbraid';
var GCLID = 'gclid';
var KO_CLICK_ID = 'ko_click_id';
var LI_FAT_ID = 'li_fat_id';
var MSCLKID = 'msclkid';
var RDT_CID = 'rtd_cid';
var TTCLID = 'ttclid';
var TWCLID = 'twclid';
var WBRAID = 'wbraid';
var EMPTY_VALUE = 'EMPTY';
var BASE_CAMPAIGN = {
    utm_campaign: undefined,
    utm_content: undefined,
    utm_id: undefined,
    utm_medium: undefined,
    utm_source: undefined,
    utm_term: undefined,
    referrer: undefined,
    referring_domain: undefined,
    dclid: undefined,
    gbraid: undefined,
    gclid: undefined,
    fbclid: undefined,
    ko_click_id: undefined,
    li_fat_id: undefined,
    msclkid: undefined,
    rtd_cid: undefined,
    ttclid: undefined,
    twclid: undefined,
    wbraid: undefined,
};
var MKTG = 'MKTG';
//# sourceMappingURL=constants.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/cookie-name.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/cookie-name.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getCookieName": () => (/* binding */ getCookieName),
/* harmony export */   "getOldCookieName": () => (/* binding */ getOldCookieName)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/constants.js");

var getCookieName = function (apiKey, postKey, limit) {
    if (postKey === void 0) { postKey = ''; }
    if (limit === void 0) { limit = 10; }
    return [_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_0__.AMPLITUDE_PREFIX, postKey, apiKey.substring(0, limit)].filter(Boolean).join('_');
};
var getOldCookieName = function (apiKey) {
    return "".concat(_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_0__.AMPLITUDE_PREFIX.toLowerCase(), "_").concat(apiKey.substring(0, 6));
};
//# sourceMappingURL=cookie-name.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/default-tracking.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/default-tracking.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getAttributionTrackingConfig": () => (/* binding */ getAttributionTrackingConfig),
/* harmony export */   "getPageViewTrackingConfig": () => (/* binding */ getPageViewTrackingConfig),
/* harmony export */   "isAttributionTrackingEnabled": () => (/* binding */ isAttributionTrackingEnabled),
/* harmony export */   "isFileDownloadTrackingEnabled": () => (/* binding */ isFileDownloadTrackingEnabled),
/* harmony export */   "isFormInteractionTrackingEnabled": () => (/* binding */ isFormInteractionTrackingEnabled),
/* harmony export */   "isPageViewTrackingEnabled": () => (/* binding */ isPageViewTrackingEnabled),
/* harmony export */   "isSessionTrackingEnabled": () => (/* binding */ isSessionTrackingEnabled)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");

/**
 * Returns false if defaultTracking === false or if defaultTracking[event],
 * otherwise returns true
 */
var isTrackingEnabled = function (defaultTracking, event) {
    if (typeof defaultTracking === 'boolean') {
        return defaultTracking;
    }
    if ((defaultTracking === null || defaultTracking === void 0 ? void 0 : defaultTracking[event]) === false) {
        return false;
    }
    return true;
};
var isAttributionTrackingEnabled = function (defaultTracking) {
    return isTrackingEnabled(defaultTracking, 'attribution');
};
var isFileDownloadTrackingEnabled = function (defaultTracking) {
    return isTrackingEnabled(defaultTracking, 'fileDownloads');
};
var isFormInteractionTrackingEnabled = function (defaultTracking) {
    return isTrackingEnabled(defaultTracking, 'formInteractions');
};
var isPageViewTrackingEnabled = function (defaultTracking) {
    return isTrackingEnabled(defaultTracking, 'pageViews');
};
var isSessionTrackingEnabled = function (defaultTracking) {
    return isTrackingEnabled(defaultTracking, 'sessions');
};
var getPageViewTrackingConfig = function (config) {
    var trackOn = function () { return false; };
    var trackHistoryChanges = undefined;
    var eventType;
    var isDefaultPageViewTrackingEnabled = isPageViewTrackingEnabled(config.defaultTracking);
    if (isDefaultPageViewTrackingEnabled) {
        trackOn = undefined;
        eventType = undefined;
        if (config.defaultTracking &&
            typeof config.defaultTracking === 'object' &&
            config.defaultTracking.pageViews &&
            typeof config.defaultTracking.pageViews === 'object') {
            if ('trackOn' in config.defaultTracking.pageViews) {
                trackOn = config.defaultTracking.pageViews.trackOn;
            }
            if ('trackHistoryChanges' in config.defaultTracking.pageViews) {
                trackHistoryChanges = config.defaultTracking.pageViews.trackHistoryChanges;
            }
            if ('eventType' in config.defaultTracking.pageViews && config.defaultTracking.pageViews.eventType) {
                eventType = config.defaultTracking.pageViews.eventType;
            }
        }
    }
    return {
        trackOn: trackOn,
        trackHistoryChanges: trackHistoryChanges,
        eventType: eventType,
    };
};
var getAttributionTrackingConfig = function (config) {
    if (isAttributionTrackingEnabled(config.defaultTracking) &&
        config.defaultTracking &&
        typeof config.defaultTracking === 'object' &&
        config.defaultTracking.attribution &&
        typeof config.defaultTracking.attribution === 'object') {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, config.defaultTracking.attribution);
    }
    return {};
};
//# sourceMappingURL=default-tracking.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getGlobalScope": () => (/* binding */ getGlobalScope)
/* harmony export */ });
/* eslint-disable no-restricted-globals */
/* Only file allowed to access to globalThis, window, self */
var getGlobalScope = function () {
    if (typeof globalThis !== 'undefined') {
        return globalThis;
    }
    if (typeof window !== 'undefined') {
        return window;
    }
    if (typeof self !== 'undefined') {
        return self;
    }
    if (typeof __webpack_require__.g !== 'undefined') {
        return __webpack_require__.g;
    }
    return undefined;
};
//# sourceMappingURL=global-scope.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/language.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/language.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getLanguage": () => (/* binding */ getLanguage)
/* harmony export */ });
var getLanguage = function () {
    var _a, _b, _c, _d;
    if (typeof navigator === 'undefined')
        return '';
    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
    var userLanguage = navigator.userLanguage;
    return (_d = (_c = (_b = (_a = navigator.languages) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : navigator.language) !== null && _c !== void 0 ? _c : userLanguage) !== null && _d !== void 0 ? _d : '';
};
//# sourceMappingURL=language.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/plugins/identity.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/plugins/identity.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IdentityEventSender": () => (/* binding */ IdentityEventSender)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _analytics_connector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../analytics-connector */ "./node_modules/@amplitude/analytics-client-common/lib/esm/analytics-connector.js");


var IdentityEventSender = /** @class */ (function () {
    function IdentityEventSender() {
        this.name = 'identity';
        this.type = 'before';
        this.identityStore = (0,_analytics_connector__WEBPACK_IMPORTED_MODULE_0__.getAnalyticsConnector)().identityStore;
    }
    IdentityEventSender.prototype.execute = function (context) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            var userProperties;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                userProperties = context.user_properties;
                if (userProperties) {
                    this.identityStore.editIdentity().updateUserProperties(userProperties).commit();
                }
                return [2 /*return*/, context];
            });
        });
    };
    IdentityEventSender.prototype.setup = function (config) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                if (config.instanceName) {
                    this.identityStore = (0,_analytics_connector__WEBPACK_IMPORTED_MODULE_0__.getAnalyticsConnector)(config.instanceName).identityStore;
                }
                return [2 /*return*/];
            });
        });
    };
    return IdentityEventSender;
}());

//# sourceMappingURL=identity.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/query-params.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/query-params.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getQueryParams": () => (/* binding */ getQueryParams),
/* harmony export */   "tryDecodeURIComponent": () => (/* binding */ tryDecodeURIComponent)
/* harmony export */ });
/* harmony import */ var _global_scope__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./global-scope */ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js");

var getQueryParams = function () {
    var _a;
    var globalScope = (0,_global_scope__WEBPACK_IMPORTED_MODULE_0__.getGlobalScope)();
    /* istanbul ignore if */
    if (!((_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.location) === null || _a === void 0 ? void 0 : _a.search)) {
        return {};
    }
    var pairs = globalScope.location.search.substring(1).split('&').filter(Boolean);
    var params = pairs.reduce(function (acc, curr) {
        var query = curr.split('=', 2);
        var key = tryDecodeURIComponent(query[0]);
        var value = tryDecodeURIComponent(query[1]);
        if (!value) {
            return acc;
        }
        acc[key] = value;
        return acc;
    }, {});
    return params;
};
var tryDecodeURIComponent = function (value) {
    if (value === void 0) { value = ''; }
    try {
        return decodeURIComponent(value);
    }
    catch (_a) {
        return '';
    }
};
//# sourceMappingURL=query-params.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/storage/cookie.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/storage/cookie.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CookieStorage": () => (/* binding */ CookieStorage)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _global_scope__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../global-scope */ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js");


var CookieStorage = /** @class */ (function () {
    function CookieStorage(options) {
        this.options = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, options);
    }
    CookieStorage.prototype.isEnabled = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var testStrorage, testKey, value, _a;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        /* istanbul ignore if */
                        if (!(0,_global_scope__WEBPACK_IMPORTED_MODULE_1__.getGlobalScope)()) {
                            return [2 /*return*/, false];
                        }
                        CookieStorage.testValue = String(Date.now());
                        testStrorage = new CookieStorage(this.options);
                        testKey = 'AMP_TEST';
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 4, 5, 7]);
                        return [4 /*yield*/, testStrorage.set(testKey, CookieStorage.testValue)];
                    case 2:
                        _b.sent();
                        return [4 /*yield*/, testStrorage.get(testKey)];
                    case 3:
                        value = _b.sent();
                        return [2 /*return*/, value === CookieStorage.testValue];
                    case 4:
                        _a = _b.sent();
                        /* istanbul ignore next */
                        return [2 /*return*/, false];
                    case 5: return [4 /*yield*/, testStrorage.remove(testKey)];
                    case 6:
                        _b.sent();
                        return [7 /*endfinally*/];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    CookieStorage.prototype.get = function (key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var value;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.getRaw(key)];
                    case 1:
                        value = _a.sent();
                        if (!value) {
                            return [2 /*return*/, undefined];
                        }
                        try {
                            try {
                                value = decodeURIComponent(atob(value));
                            }
                            catch (_b) {
                                // value not encoded
                            }
                            // eslint-disable-next-line @typescript-eslint/no-unsafe-return
                            return [2 /*return*/, JSON.parse(value)];
                        }
                        catch (_c) {
                            /* istanbul ignore next */
                            return [2 /*return*/, undefined];
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    CookieStorage.prototype.getRaw = function (key) {
        var _a, _b;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var globalScope, cookie, match;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_c) {
                globalScope = (0,_global_scope__WEBPACK_IMPORTED_MODULE_1__.getGlobalScope)();
                cookie = (_b = (_a = globalScope === null || globalScope === void 0 ? void 0 : globalScope.document) === null || _a === void 0 ? void 0 : _a.cookie.split('; ')) !== null && _b !== void 0 ? _b : [];
                match = cookie.find(function (c) { return c.indexOf(key + '=') === 0; });
                if (!match) {
                    return [2 /*return*/, undefined];
                }
                return [2 /*return*/, match.substring(key.length + 1)];
            });
        });
    };
    CookieStorage.prototype.set = function (key, value) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var expirationDays, expires, expireDate, date, str, globalScope;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                try {
                    expirationDays = (_a = this.options.expirationDays) !== null && _a !== void 0 ? _a : 0;
                    expires = value !== null ? expirationDays : -1;
                    expireDate = undefined;
                    if (expires) {
                        date = new Date();
                        date.setTime(date.getTime() + expires * 24 * 60 * 60 * 1000);
                        expireDate = date;
                    }
                    str = "".concat(key, "=").concat(btoa(encodeURIComponent(JSON.stringify(value))));
                    if (expireDate) {
                        str += "; expires=".concat(expireDate.toUTCString());
                    }
                    str += '; path=/';
                    if (this.options.domain) {
                        str += "; domain=".concat(this.options.domain);
                    }
                    if (this.options.secure) {
                        str += '; Secure';
                    }
                    if (this.options.sameSite) {
                        str += "; SameSite=".concat(this.options.sameSite);
                    }
                    globalScope = (0,_global_scope__WEBPACK_IMPORTED_MODULE_1__.getGlobalScope)();
                    if (globalScope) {
                        globalScope.document.cookie = str;
                    }
                }
                catch (_c) {
                    //
                }
                return [2 /*return*/];
            });
        });
    };
    CookieStorage.prototype.remove = function (key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.set(key, null)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    CookieStorage.prototype.reset = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                return [2 /*return*/];
            });
        });
    };
    return CookieStorage;
}());

//# sourceMappingURL=cookie.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-client-common/lib/esm/transports/fetch.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-client-common/lib/esm/transports/fetch.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FetchTransport": () => (/* binding */ FetchTransport)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/transports/base.js");


var FetchTransport = /** @class */ (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(FetchTransport, _super);
    function FetchTransport() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    FetchTransport.prototype.send = function (serverUrl, payload) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var options, response, responsePayload;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        /* istanbul ignore if */
                        if (typeof fetch === 'undefined') {
                            throw new Error('FetchTransport is not supported');
                        }
                        options = {
                            headers: {
                                'Content-Type': 'application/json',
                                Accept: '*/*',
                            },
                            body: JSON.stringify(payload),
                            method: 'POST',
                        };
                        return [4 /*yield*/, fetch(serverUrl, options)];
                    case 1:
                        response = _a.sent();
                        return [4 /*yield*/, response.json()];
                    case 2:
                        responsePayload = _a.sent();
                        return [2 /*return*/, this.buildResponse(responsePayload)];
                }
            });
        });
    };
    return FetchTransport;
}(_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_1__.BaseTransport));

//# sourceMappingURL=fetch.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-connector/dist/analytics-connector.esm.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-connector/dist/analytics-connector.esm.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AnalyticsConnector": () => (/* binding */ AnalyticsConnector)
/* harmony export */ });
var ApplicationContextProviderImpl = /** @class */ (function () {
    function ApplicationContextProviderImpl() {
    }
    ApplicationContextProviderImpl.prototype.getApplicationContext = function () {
        return {
            versionName: this.versionName,
            language: getLanguage(),
            platform: 'Web',
            os: undefined,
            deviceModel: undefined,
        };
    };
    return ApplicationContextProviderImpl;
}());
var getLanguage = function () {
    return ((typeof navigator !== 'undefined' &&
        ((navigator.languages && navigator.languages[0]) ||
            navigator.language)) ||
        '');
};

var EventBridgeImpl = /** @class */ (function () {
    function EventBridgeImpl() {
        this.queue = [];
    }
    EventBridgeImpl.prototype.logEvent = function (event) {
        if (!this.receiver) {
            if (this.queue.length < 512) {
                this.queue.push(event);
            }
        }
        else {
            this.receiver(event);
        }
    };
    EventBridgeImpl.prototype.setEventReceiver = function (receiver) {
        this.receiver = receiver;
        if (this.queue.length > 0) {
            this.queue.forEach(function (event) {
                receiver(event);
            });
            this.queue = [];
        }
    };
    return EventBridgeImpl;
}());

/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var __assign = function () {
  __assign = Object.assign || function __assign(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};

// eslint-disable-next-line @typescript-eslint/no-explicit-any
var isEqual = function (obj1, obj2) {
    var primitive = ['string', 'number', 'boolean', 'undefined'];
    var typeA = typeof obj1;
    var typeB = typeof obj2;
    if (typeA !== typeB) {
        return false;
    }
    for (var _i = 0, primitive_1 = primitive; _i < primitive_1.length; _i++) {
        var p = primitive_1[_i];
        if (p === typeA) {
            return obj1 === obj2;
        }
    }
    // check null
    if (obj1 == null && obj2 == null) {
        return true;
    }
    else if (obj1 == null || obj2 == null) {
        return false;
    }
    // if got here - objects
    if (obj1.length !== obj2.length) {
        return false;
    }
    //check if arrays
    var isArrayA = Array.isArray(obj1);
    var isArrayB = Array.isArray(obj2);
    if (isArrayA !== isArrayB) {
        return false;
    }
    if (isArrayA && isArrayB) {
        //arrays
        for (var i = 0; i < obj1.length; i++) {
            if (!isEqual(obj1[i], obj2[i])) {
                return false;
            }
        }
    }
    else {
        //objects
        var sorted1 = Object.keys(obj1).sort();
        var sorted2 = Object.keys(obj2).sort();
        if (!isEqual(sorted1, sorted2)) {
            return false;
        }
        //compare object values
        var result_1 = true;
        Object.keys(obj1).forEach(function (key) {
            if (!isEqual(obj1[key], obj2[key])) {
                result_1 = false;
            }
        });
        return result_1;
    }
    return true;
};

var ID_OP_SET = '$set';
var ID_OP_UNSET = '$unset';
var ID_OP_CLEAR_ALL = '$clearAll';
// Polyfill for Object.entries
if (!Object.entries) {
    Object.entries = function (obj) {
        var ownProps = Object.keys(obj);
        var i = ownProps.length;
        var resArray = new Array(i);
        while (i--) {
            resArray[i] = [ownProps[i], obj[ownProps[i]]];
        }
        return resArray;
    };
}
var IdentityStoreImpl = /** @class */ (function () {
    function IdentityStoreImpl() {
        this.identity = { userProperties: {} };
        this.listeners = new Set();
    }
    IdentityStoreImpl.prototype.editIdentity = function () {
        // eslint-disable-next-line @typescript-eslint/no-this-alias
        var self = this;
        var actingUserProperties = __assign({}, this.identity.userProperties);
        var actingIdentity = __assign(__assign({}, this.identity), { userProperties: actingUserProperties });
        return {
            setUserId: function (userId) {
                actingIdentity.userId = userId;
                return this;
            },
            setDeviceId: function (deviceId) {
                actingIdentity.deviceId = deviceId;
                return this;
            },
            setUserProperties: function (userProperties) {
                actingIdentity.userProperties = userProperties;
                return this;
            },
            updateUserProperties: function (actions) {
                var actingProperties = actingIdentity.userProperties || {};
                for (var _i = 0, _a = Object.entries(actions); _i < _a.length; _i++) {
                    var _b = _a[_i], action = _b[0], properties = _b[1];
                    switch (action) {
                        case ID_OP_SET:
                            for (var _c = 0, _d = Object.entries(properties); _c < _d.length; _c++) {
                                var _e = _d[_c], key = _e[0], value = _e[1];
                                actingProperties[key] = value;
                            }
                            break;
                        case ID_OP_UNSET:
                            for (var _f = 0, _g = Object.keys(properties); _f < _g.length; _f++) {
                                var key = _g[_f];
                                delete actingProperties[key];
                            }
                            break;
                        case ID_OP_CLEAR_ALL:
                            actingProperties = {};
                            break;
                    }
                }
                actingIdentity.userProperties = actingProperties;
                return this;
            },
            commit: function () {
                self.setIdentity(actingIdentity);
                return this;
            },
        };
    };
    IdentityStoreImpl.prototype.getIdentity = function () {
        return __assign({}, this.identity);
    };
    IdentityStoreImpl.prototype.setIdentity = function (identity) {
        var originalIdentity = __assign({}, this.identity);
        this.identity = __assign({}, identity);
        if (!isEqual(originalIdentity, this.identity)) {
            this.listeners.forEach(function (listener) {
                listener(identity);
            });
        }
    };
    IdentityStoreImpl.prototype.addIdentityListener = function (listener) {
        this.listeners.add(listener);
    };
    IdentityStoreImpl.prototype.removeIdentityListener = function (listener) {
        this.listeners.delete(listener);
    };
    return IdentityStoreImpl;
}());

var safeGlobal = typeof globalThis !== 'undefined'
    ? globalThis
    : typeof __webpack_require__.g !== 'undefined'
        ? __webpack_require__.g
        : self;

var AnalyticsConnector = /** @class */ (function () {
    function AnalyticsConnector() {
        this.identityStore = new IdentityStoreImpl();
        this.eventBridge = new EventBridgeImpl();
        this.applicationContextProvider = new ApplicationContextProviderImpl();
    }
    AnalyticsConnector.getInstance = function (instanceName) {
        if (!safeGlobal['analyticsConnectorInstances']) {
            safeGlobal['analyticsConnectorInstances'] = {};
        }
        if (!safeGlobal['analyticsConnectorInstances'][instanceName]) {
            safeGlobal['analyticsConnectorInstances'][instanceName] =
                new AnalyticsConnector();
        }
        return safeGlobal['analyticsConnectorInstances'][instanceName];
    };
    return AnalyticsConnector;
}());




/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/config.js":
/*!******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/config.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Config": () => (/* binding */ Config),
/* harmony export */   "createServerConfig": () => (/* binding */ createServerConfig),
/* harmony export */   "getDefaultConfig": () => (/* binding */ getDefaultConfig),
/* harmony export */   "getServerUrl": () => (/* binding */ getServerUrl)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants */ "./node_modules/@amplitude/analytics-core/lib/esm/constants.js");
/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./logger */ "./node_modules/@amplitude/analytics-core/lib/esm/logger.js");



var getDefaultConfig = function () { return ({
    flushMaxRetries: 12,
    flushQueueSize: 200,
    flushIntervalMillis: 10000,
    instanceName: '$default_instance',
    logLevel: _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.Warn,
    loggerProvider: new _logger__WEBPACK_IMPORTED_MODULE_1__.Logger(),
    optOut: false,
    serverUrl: _constants__WEBPACK_IMPORTED_MODULE_2__.AMPLITUDE_SERVER_URL,
    serverZone: 'US',
    useBatch: false,
}); };
var Config = /** @class */ (function () {
    function Config(options) {
        var _a, _b, _c, _d;
        this._optOut = false;
        var defaultConfig = getDefaultConfig();
        this.apiKey = options.apiKey;
        this.flushIntervalMillis = (_a = options.flushIntervalMillis) !== null && _a !== void 0 ? _a : defaultConfig.flushIntervalMillis;
        this.flushMaxRetries = options.flushMaxRetries || defaultConfig.flushMaxRetries;
        this.flushQueueSize = options.flushQueueSize || defaultConfig.flushQueueSize;
        this.instanceName = options.instanceName || defaultConfig.instanceName;
        this.loggerProvider = options.loggerProvider || defaultConfig.loggerProvider;
        this.logLevel = (_b = options.logLevel) !== null && _b !== void 0 ? _b : defaultConfig.logLevel;
        this.minIdLength = options.minIdLength;
        this.plan = options.plan;
        this.ingestionMetadata = options.ingestionMetadata;
        this.optOut = (_c = options.optOut) !== null && _c !== void 0 ? _c : defaultConfig.optOut;
        this.serverUrl = options.serverUrl;
        this.serverZone = options.serverZone || defaultConfig.serverZone;
        this.storageProvider = options.storageProvider;
        this.transportProvider = options.transportProvider;
        this.useBatch = (_d = options.useBatch) !== null && _d !== void 0 ? _d : defaultConfig.useBatch;
        this.loggerProvider.enable(this.logLevel);
        var serverConfig = createServerConfig(options.serverUrl, options.serverZone, options.useBatch);
        this.serverZone = serverConfig.serverZone;
        this.serverUrl = serverConfig.serverUrl;
    }
    Object.defineProperty(Config.prototype, "optOut", {
        get: function () {
            return this._optOut;
        },
        set: function (optOut) {
            this._optOut = optOut;
        },
        enumerable: false,
        configurable: true
    });
    return Config;
}());

var getServerUrl = function (serverZone, useBatch) {
    if (serverZone === 'EU') {
        return useBatch ? _constants__WEBPACK_IMPORTED_MODULE_2__.EU_AMPLITUDE_BATCH_SERVER_URL : _constants__WEBPACK_IMPORTED_MODULE_2__.EU_AMPLITUDE_SERVER_URL;
    }
    return useBatch ? _constants__WEBPACK_IMPORTED_MODULE_2__.AMPLITUDE_BATCH_SERVER_URL : _constants__WEBPACK_IMPORTED_MODULE_2__.AMPLITUDE_SERVER_URL;
};
var createServerConfig = function (serverUrl, serverZone, useBatch) {
    if (serverUrl === void 0) { serverUrl = ''; }
    if (serverZone === void 0) { serverZone = getDefaultConfig().serverZone; }
    if (useBatch === void 0) { useBatch = getDefaultConfig().useBatch; }
    if (serverUrl) {
        return { serverUrl: serverUrl, serverZone: undefined };
    }
    var _serverZone = ['US', 'EU'].includes(serverZone) ? serverZone : getDefaultConfig().serverZone;
    return {
        serverZone: _serverZone,
        serverUrl: getServerUrl(_serverZone, useBatch),
    };
};
//# sourceMappingURL=config.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/constants.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/constants.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AMPLITUDE_BATCH_SERVER_URL": () => (/* binding */ AMPLITUDE_BATCH_SERVER_URL),
/* harmony export */   "AMPLITUDE_PREFIX": () => (/* binding */ AMPLITUDE_PREFIX),
/* harmony export */   "AMPLITUDE_SERVER_URL": () => (/* binding */ AMPLITUDE_SERVER_URL),
/* harmony export */   "EU_AMPLITUDE_BATCH_SERVER_URL": () => (/* binding */ EU_AMPLITUDE_BATCH_SERVER_URL),
/* harmony export */   "EU_AMPLITUDE_SERVER_URL": () => (/* binding */ EU_AMPLITUDE_SERVER_URL),
/* harmony export */   "STORAGE_PREFIX": () => (/* binding */ STORAGE_PREFIX),
/* harmony export */   "UNSET_VALUE": () => (/* binding */ UNSET_VALUE)
/* harmony export */ });
var UNSET_VALUE = '-';
var AMPLITUDE_PREFIX = 'AMP';
var STORAGE_PREFIX = "".concat(AMPLITUDE_PREFIX, "_unsent");
var AMPLITUDE_SERVER_URL = 'https://api2.amplitude.com/2/httpapi';
var EU_AMPLITUDE_SERVER_URL = 'https://api.eu.amplitude.com/2/httpapi';
var AMPLITUDE_BATCH_SERVER_URL = 'https://api2.amplitude.com/batch';
var EU_AMPLITUDE_BATCH_SERVER_URL = 'https://api.eu.amplitude.com/batch';
//# sourceMappingURL=constants.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/core-client.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/core-client.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AmplitudeCore": () => (/* binding */ AmplitudeCore)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _utils_event_builder__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/event-builder */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/event-builder.js");
/* harmony import */ var _timeline__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./timeline */ "./node_modules/@amplitude/analytics-core/lib/esm/timeline.js");
/* harmony import */ var _utils_result_builder__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils/result-builder */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/result-builder.js");
/* harmony import */ var _messages__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./messages */ "./node_modules/@amplitude/analytics-core/lib/esm/messages.js");
/* harmony import */ var _utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/return-wrapper */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/return-wrapper.js");






var AmplitudeCore = /** @class */ (function () {
    function AmplitudeCore(name) {
        if (name === void 0) { name = '$default'; }
        this.initializing = false;
        this.q = [];
        this.dispatchQ = [];
        this.logEvent = this.track.bind(this);
        this.timeline = new _timeline__WEBPACK_IMPORTED_MODULE_0__.Timeline(this);
        this.name = name;
    }
    AmplitudeCore.prototype._init = function (config) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.config = config;
                        this.timeline.reset(this);
                        return [4 /*yield*/, this.runQueuedFunctions('q')];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    AmplitudeCore.prototype.runQueuedFunctions = function (queueName) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            var queuedFunctions, queuedFunctions_1, queuedFunctions_1_1, queuedFunction, e_1_1;
            var e_1, _a;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        queuedFunctions = this[queueName];
                        this[queueName] = [];
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 6, 7, 8]);
                        queuedFunctions_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__values)(queuedFunctions), queuedFunctions_1_1 = queuedFunctions_1.next();
                        _b.label = 2;
                    case 2:
                        if (!!queuedFunctions_1_1.done) return [3 /*break*/, 5];
                        queuedFunction = queuedFunctions_1_1.value;
                        return [4 /*yield*/, queuedFunction()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4:
                        queuedFunctions_1_1 = queuedFunctions_1.next();
                        return [3 /*break*/, 2];
                    case 5: return [3 /*break*/, 8];
                    case 6:
                        e_1_1 = _b.sent();
                        e_1 = { error: e_1_1 };
                        return [3 /*break*/, 8];
                    case 7:
                        try {
                            if (queuedFunctions_1_1 && !queuedFunctions_1_1.done && (_a = queuedFunctions_1.return)) _a.call(queuedFunctions_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                        return [7 /*endfinally*/];
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    AmplitudeCore.prototype.track = function (eventInput, eventProperties, eventOptions) {
        var event = (0,_utils_event_builder__WEBPACK_IMPORTED_MODULE_2__.createTrackEvent)(eventInput, eventProperties, eventOptions);
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.dispatch(event));
    };
    AmplitudeCore.prototype.identify = function (identify, eventOptions) {
        var event = (0,_utils_event_builder__WEBPACK_IMPORTED_MODULE_2__.createIdentifyEvent)(identify, eventOptions);
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.dispatch(event));
    };
    AmplitudeCore.prototype.groupIdentify = function (groupType, groupName, identify, eventOptions) {
        var event = (0,_utils_event_builder__WEBPACK_IMPORTED_MODULE_2__.createGroupIdentifyEvent)(groupType, groupName, identify, eventOptions);
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.dispatch(event));
    };
    AmplitudeCore.prototype.setGroup = function (groupType, groupName, eventOptions) {
        var event = (0,_utils_event_builder__WEBPACK_IMPORTED_MODULE_2__.createGroupEvent)(groupType, groupName, eventOptions);
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.dispatch(event));
    };
    AmplitudeCore.prototype.revenue = function (revenue, eventOptions) {
        var event = (0,_utils_event_builder__WEBPACK_IMPORTED_MODULE_2__.createRevenueEvent)(revenue, eventOptions);
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.dispatch(event));
    };
    AmplitudeCore.prototype.add = function (plugin) {
        if (!this.config) {
            this.q.push(this.add.bind(this, plugin));
            return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)();
        }
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.timeline.register(plugin, this.config));
    };
    AmplitudeCore.prototype.remove = function (pluginName) {
        if (!this.config) {
            this.q.push(this.remove.bind(this, pluginName));
            return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)();
        }
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.timeline.deregister(pluginName));
    };
    AmplitudeCore.prototype.dispatchWithCallback = function (event, callback) {
        if (!this.config) {
            return callback((0,_utils_result_builder__WEBPACK_IMPORTED_MODULE_4__.buildResult)(event, 0, _messages__WEBPACK_IMPORTED_MODULE_5__.CLIENT_NOT_INITIALIZED));
        }
        void this.process(event).then(callback);
    };
    AmplitudeCore.prototype.dispatch = function (event) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                if (!this.config) {
                    return [2 /*return*/, new Promise(function (resolve) {
                            _this.dispatchQ.push(_this.dispatchWithCallback.bind(_this, event, resolve));
                        })];
                }
                return [2 /*return*/, this.process(event)];
            });
        });
    };
    AmplitudeCore.prototype.process = function (event) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(this, void 0, void 0, function () {
            var result, e_2, message, result;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        // skip event processing if opt out
                        if (this.config.optOut) {
                            return [2 /*return*/, (0,_utils_result_builder__WEBPACK_IMPORTED_MODULE_4__.buildResult)(event, 0, _messages__WEBPACK_IMPORTED_MODULE_5__.OPT_OUT_MESSAGE)];
                        }
                        return [4 /*yield*/, this.timeline.push(event)];
                    case 1:
                        result = _a.sent();
                        result.code === 200
                            ? this.config.loggerProvider.log(result.message)
                            : this.config.loggerProvider.error(result.message);
                        return [2 /*return*/, result];
                    case 2:
                        e_2 = _a.sent();
                        message = String(e_2);
                        this.config.loggerProvider.error(message);
                        result = (0,_utils_result_builder__WEBPACK_IMPORTED_MODULE_4__.buildResult)(event, 0, message);
                        return [2 /*return*/, result];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    AmplitudeCore.prototype.setOptOut = function (optOut) {
        if (!this.config) {
            this.q.push(this.setOptOut.bind(this, Boolean(optOut)));
            return;
        }
        this.config.optOut = Boolean(optOut);
    };
    AmplitudeCore.prototype.flush = function () {
        return (0,_utils_return_wrapper__WEBPACK_IMPORTED_MODULE_3__.returnWrapper)(this.timeline.flush());
    };
    return AmplitudeCore;
}());

//# sourceMappingURL=core-client.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/identify.js":
/*!********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/identify.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Identify": () => (/* binding */ Identify)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/event.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./constants */ "./node_modules/@amplitude/analytics-core/lib/esm/constants.js");
/* harmony import */ var _utils_valid_properties__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils/valid-properties */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/valid-properties.js");




var Identify = /** @class */ (function () {
    function Identify() {
        this._propertySet = new Set();
        this._properties = {};
    }
    Identify.prototype.getUserProperties = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, this._properties);
    };
    Identify.prototype.set = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.SET, property, value);
        return this;
    };
    Identify.prototype.setOnce = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.SET_ONCE, property, value);
        return this;
    };
    Identify.prototype.append = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.APPEND, property, value);
        return this;
    };
    Identify.prototype.prepend = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.PREPEND, property, value);
        return this;
    };
    Identify.prototype.postInsert = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.POSTINSERT, property, value);
        return this;
    };
    Identify.prototype.preInsert = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.PREINSERT, property, value);
        return this;
    };
    Identify.prototype.remove = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.REMOVE, property, value);
        return this;
    };
    Identify.prototype.add = function (property, value) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.ADD, property, value);
        return this;
    };
    Identify.prototype.unset = function (property) {
        this._safeSet(_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.UNSET, property, _constants__WEBPACK_IMPORTED_MODULE_2__.UNSET_VALUE);
        return this;
    };
    Identify.prototype.clearAll = function () {
        // When clear all happens, all properties are unset. Reset the entire object.
        this._properties = {};
        this._properties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.CLEAR_ALL] = _constants__WEBPACK_IMPORTED_MODULE_2__.UNSET_VALUE;
        return this;
    };
    // Returns whether or not this set actually worked.
    Identify.prototype._safeSet = function (operation, property, value) {
        if (this._validate(operation, property, value)) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
            var userPropertyMap = this._properties[operation];
            if (userPropertyMap === undefined) {
                userPropertyMap = {};
                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
                this._properties[operation] = userPropertyMap;
            }
            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
            userPropertyMap[property] = value;
            this._propertySet.add(property);
            return true;
        }
        return false;
    };
    Identify.prototype._validate = function (operation, property, value) {
        if (this._properties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.CLEAR_ALL] !== undefined) {
            // clear all already set. Skipping operation;
            return false;
        }
        if (this._propertySet.has(property)) {
            // Property already used. Skipping operation
            return false;
        }
        if (operation === _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.ADD) {
            return typeof value === 'number';
        }
        if (operation !== _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.UNSET && operation !== _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.IdentifyOperation.REMOVE) {
            return (0,_utils_valid_properties__WEBPACK_IMPORTED_MODULE_3__.isValidProperties)(property, value);
        }
        return true;
    };
    return Identify;
}());

//# sourceMappingURL=identify.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/logger.js":
/*!******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/logger.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Logger": () => (/* binding */ Logger)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js");

var PREFIX = 'Amplitude Logger ';
var Logger = /** @class */ (function () {
    function Logger() {
        this.logLevel = _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.None;
    }
    Logger.prototype.disable = function () {
        this.logLevel = _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.None;
    };
    Logger.prototype.enable = function (logLevel) {
        if (logLevel === void 0) { logLevel = _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.Warn; }
        this.logLevel = logLevel;
    };
    Logger.prototype.log = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (this.logLevel < _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.Verbose) {
            return;
        }
        console.log("".concat(PREFIX, "[Log]: ").concat(args.join(' ')));
    };
    Logger.prototype.warn = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (this.logLevel < _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.Warn) {
            return;
        }
        console.warn("".concat(PREFIX, "[Warn]: ").concat(args.join(' ')));
    };
    Logger.prototype.error = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (this.logLevel < _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.Error) {
            return;
        }
        console.error("".concat(PREFIX, "[Error]: ").concat(args.join(' ')));
    };
    Logger.prototype.debug = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (this.logLevel < _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.LogLevel.Debug) {
            return;
        }
        // console.debug output is hidden by default in chrome
        console.log("".concat(PREFIX, "[Debug]: ").concat(args.join(' ')));
    };
    return Logger;
}());

//# sourceMappingURL=logger.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/messages.js":
/*!********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/messages.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CLIENT_NOT_INITIALIZED": () => (/* binding */ CLIENT_NOT_INITIALIZED),
/* harmony export */   "INVALID_API_KEY": () => (/* binding */ INVALID_API_KEY),
/* harmony export */   "MAX_RETRIES_EXCEEDED_MESSAGE": () => (/* binding */ MAX_RETRIES_EXCEEDED_MESSAGE),
/* harmony export */   "MISSING_API_KEY_MESSAGE": () => (/* binding */ MISSING_API_KEY_MESSAGE),
/* harmony export */   "OPT_OUT_MESSAGE": () => (/* binding */ OPT_OUT_MESSAGE),
/* harmony export */   "SUCCESS_MESSAGE": () => (/* binding */ SUCCESS_MESSAGE),
/* harmony export */   "UNEXPECTED_ERROR_MESSAGE": () => (/* binding */ UNEXPECTED_ERROR_MESSAGE)
/* harmony export */ });
var SUCCESS_MESSAGE = 'Event tracked successfully';
var UNEXPECTED_ERROR_MESSAGE = 'Unexpected error occurred';
var MAX_RETRIES_EXCEEDED_MESSAGE = 'Event rejected due to exceeded retry count';
var OPT_OUT_MESSAGE = 'Event skipped due to optOut config';
var MISSING_API_KEY_MESSAGE = 'Event rejected due to missing API key';
var INVALID_API_KEY = 'Invalid API key';
var CLIENT_NOT_INITIALIZED = 'Client not initialized';
//# sourceMappingURL=messages.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/plugins/destination.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/plugins/destination.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Destination": () => (/* binding */ Destination),
/* harmony export */   "getResponseBodyString": () => (/* binding */ getResponseBodyString)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/status.js");
/* harmony import */ var _messages__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../messages */ "./node_modules/@amplitude/analytics-core/lib/esm/messages.js");
/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../constants */ "./node_modules/@amplitude/analytics-core/lib/esm/constants.js");
/* harmony import */ var _utils_chunk__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/chunk */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/chunk.js");
/* harmony import */ var _utils_result_builder__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/result-builder */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/result-builder.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../config */ "./node_modules/@amplitude/analytics-core/lib/esm/config.js");







function getErrorMessage(error) {
    if (error instanceof Error)
        return error.message;
    return String(error);
}
function getResponseBodyString(res) {
    var responseBodyString = '';
    try {
        if ('body' in res) {
            responseBodyString = JSON.stringify(res.body, null, 2);
        }
    }
    catch (_a) {
        // to avoid crash, but don't care about the error, add comment to avoid empty block lint error
    }
    return responseBodyString;
}
var Destination = /** @class */ (function () {
    function Destination() {
        this.name = 'amplitude';
        this.type = 'destination';
        this.retryTimeout = 1000;
        this.throttleTimeout = 30000;
        this.storageKey = '';
        this.scheduled = null;
        this.queue = [];
    }
    Destination.prototype.setup = function (config) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var unsent;
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        this.config = config;
                        this.storageKey = "".concat(_constants__WEBPACK_IMPORTED_MODULE_1__.STORAGE_PREFIX, "_").concat(this.config.apiKey.substring(0, 10));
                        return [4 /*yield*/, ((_a = this.config.storageProvider) === null || _a === void 0 ? void 0 : _a.get(this.storageKey))];
                    case 1:
                        unsent = _b.sent();
                        this.saveEvents(); // sets storage to '[]'
                        if (unsent && unsent.length > 0) {
                            void Promise.all(unsent.map(function (event) { return _this.execute(event); })).catch();
                        }
                        return [2 /*return*/, Promise.resolve(undefined)];
                }
            });
        });
    };
    Destination.prototype.execute = function (event) {
        var _this = this;
        return new Promise(function (resolve) {
            var context = {
                event: event,
                attempts: 0,
                callback: function (result) { return resolve(result); },
                timeout: 0,
            };
            void _this.addToQueue(context);
        });
    };
    Destination.prototype.addToQueue = function () {
        var _this = this;
        var list = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            list[_i] = arguments[_i];
        }
        var tryable = list.filter(function (context) {
            if (context.attempts < _this.config.flushMaxRetries) {
                context.attempts += 1;
                return true;
            }
            void _this.fulfillRequest([context], 500, _messages__WEBPACK_IMPORTED_MODULE_2__.MAX_RETRIES_EXCEEDED_MESSAGE);
            return false;
        });
        tryable.forEach(function (context) {
            _this.queue = _this.queue.concat(context);
            if (context.timeout === 0) {
                _this.schedule(_this.config.flushIntervalMillis);
                return;
            }
            setTimeout(function () {
                context.timeout = 0;
                _this.schedule(0);
            }, context.timeout);
        });
        this.saveEvents();
    };
    Destination.prototype.schedule = function (timeout) {
        var _this = this;
        if (this.scheduled)
            return;
        this.scheduled = setTimeout(function () {
            void _this.flush(true).then(function () {
                if (_this.queue.length > 0) {
                    _this.schedule(timeout);
                }
            });
        }, timeout);
    };
    Destination.prototype.flush = function (useRetry) {
        if (useRetry === void 0) { useRetry = false; }
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var list, later, batches;
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        list = [];
                        later = [];
                        this.queue.forEach(function (context) { return (context.timeout === 0 ? list.push(context) : later.push(context)); });
                        this.queue = later;
                        if (this.scheduled) {
                            clearTimeout(this.scheduled);
                            this.scheduled = null;
                        }
                        batches = (0,_utils_chunk__WEBPACK_IMPORTED_MODULE_3__.chunk)(list, this.config.flushQueueSize);
                        return [4 /*yield*/, Promise.all(batches.map(function (batch) { return _this.send(batch, useRetry); }))];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    Destination.prototype.send = function (list, useRetry) {
        if (useRetry === void 0) { useRetry = true; }
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var payload, serverUrl, res, e_1, errorMessage;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.config.apiKey) {
                            return [2 /*return*/, this.fulfillRequest(list, 400, _messages__WEBPACK_IMPORTED_MODULE_2__.MISSING_API_KEY_MESSAGE)];
                        }
                        payload = {
                            api_key: this.config.apiKey,
                            events: list.map(function (context) {
                                // eslint-disable-next-line @typescript-eslint/no-unused-vars
                                var _a = context.event, extra = _a.extra, eventWithoutExtra = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__rest)(_a, ["extra"]);
                                return eventWithoutExtra;
                            }),
                            options: {
                                min_id_length: this.config.minIdLength,
                            },
                        };
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        serverUrl = (0,_config__WEBPACK_IMPORTED_MODULE_4__.createServerConfig)(this.config.serverUrl, this.config.serverZone, this.config.useBatch).serverUrl;
                        return [4 /*yield*/, this.config.transportProvider.send(serverUrl, payload)];
                    case 2:
                        res = _a.sent();
                        if (res === null) {
                            this.fulfillRequest(list, 0, _messages__WEBPACK_IMPORTED_MODULE_2__.UNEXPECTED_ERROR_MESSAGE);
                            return [2 /*return*/];
                        }
                        if (!useRetry) {
                            if ('body' in res) {
                                this.fulfillRequest(list, res.statusCode, "".concat(res.status, ": ").concat(getResponseBodyString(res)));
                            }
                            else {
                                this.fulfillRequest(list, res.statusCode, res.status);
                            }
                            return [2 /*return*/];
                        }
                        this.handleResponse(res, list);
                        return [3 /*break*/, 4];
                    case 3:
                        e_1 = _a.sent();
                        errorMessage = getErrorMessage(e_1);
                        this.config.loggerProvider.error(errorMessage);
                        this.fulfillRequest(list, 0, errorMessage);
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    Destination.prototype.handleResponse = function (res, list) {
        var status = res.status;
        switch (status) {
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_5__.Status.Success: {
                this.handleSuccessResponse(res, list);
                break;
            }
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_5__.Status.Invalid: {
                this.handleInvalidResponse(res, list);
                break;
            }
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_5__.Status.PayloadTooLarge: {
                this.handlePayloadTooLargeResponse(res, list);
                break;
            }
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_5__.Status.RateLimit: {
                this.handleRateLimitResponse(res, list);
                break;
            }
            default: {
                // log intermediate event status before retry
                this.config.loggerProvider.warn("{code: 0, error: \"Status '".concat(status, "' provided for ").concat(list.length, " events\"}"));
                this.handleOtherResponse(list);
                break;
            }
        }
    };
    Destination.prototype.handleSuccessResponse = function (res, list) {
        this.fulfillRequest(list, res.statusCode, _messages__WEBPACK_IMPORTED_MODULE_2__.SUCCESS_MESSAGE);
    };
    Destination.prototype.handleInvalidResponse = function (res, list) {
        var _this = this;
        if (res.body.missingField || res.body.error.startsWith(_messages__WEBPACK_IMPORTED_MODULE_2__.INVALID_API_KEY)) {
            this.fulfillRequest(list, res.statusCode, res.body.error);
            return;
        }
        var dropIndex = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(Object.values(res.body.eventsWithInvalidFields)), false), (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(Object.values(res.body.eventsWithMissingFields)), false), (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(Object.values(res.body.eventsWithInvalidIdLengths)), false), (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(res.body.silencedEvents), false).flat();
        var dropIndexSet = new Set(dropIndex);
        var retry = list.filter(function (context, index) {
            if (dropIndexSet.has(index)) {
                _this.fulfillRequest([context], res.statusCode, res.body.error);
                return;
            }
            return true;
        });
        if (retry.length > 0) {
            // log intermediate event status before retry
            this.config.loggerProvider.warn(getResponseBodyString(res));
        }
        this.addToQueue.apply(this, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(retry), false));
    };
    Destination.prototype.handlePayloadTooLargeResponse = function (res, list) {
        if (list.length === 1) {
            this.fulfillRequest(list, res.statusCode, res.body.error);
            return;
        }
        // log intermediate event status before retry
        this.config.loggerProvider.warn(getResponseBodyString(res));
        this.config.flushQueueSize /= 2;
        this.addToQueue.apply(this, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(list), false));
    };
    Destination.prototype.handleRateLimitResponse = function (res, list) {
        var _this = this;
        var dropUserIds = Object.keys(res.body.exceededDailyQuotaUsers);
        var dropDeviceIds = Object.keys(res.body.exceededDailyQuotaDevices);
        var throttledIndex = res.body.throttledEvents;
        var dropUserIdsSet = new Set(dropUserIds);
        var dropDeviceIdsSet = new Set(dropDeviceIds);
        var throttledIndexSet = new Set(throttledIndex);
        var retry = list.filter(function (context, index) {
            if ((context.event.user_id && dropUserIdsSet.has(context.event.user_id)) ||
                (context.event.device_id && dropDeviceIdsSet.has(context.event.device_id))) {
                _this.fulfillRequest([context], res.statusCode, res.body.error);
                return;
            }
            if (throttledIndexSet.has(index)) {
                context.timeout = _this.throttleTimeout;
            }
            return true;
        });
        if (retry.length > 0) {
            // log intermediate event status before retry
            this.config.loggerProvider.warn(getResponseBodyString(res));
        }
        this.addToQueue.apply(this, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(retry), false));
    };
    Destination.prototype.handleOtherResponse = function (list) {
        var _this = this;
        this.addToQueue.apply(this, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(list.map(function (context) {
            context.timeout = context.attempts * _this.retryTimeout;
            return context;
        })), false));
    };
    Destination.prototype.fulfillRequest = function (list, code, message) {
        this.saveEvents();
        list.forEach(function (context) { return context.callback((0,_utils_result_builder__WEBPACK_IMPORTED_MODULE_6__.buildResult)(context.event, code, message)); });
    };
    /**
     * Saves events to storage
     * This is called on
     * 1) new events are added to queue; or
     * 2) response comes back for a request
     */
    Destination.prototype.saveEvents = function () {
        if (!this.config.storageProvider) {
            return;
        }
        var events = Array.from(this.queue.map(function (context) { return context.event; }));
        void this.config.storageProvider.set(this.storageKey, events);
    };
    return Destination;
}());

//# sourceMappingURL=destination.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/revenue.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/revenue.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Revenue": () => (/* binding */ Revenue)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/event.js");
/* harmony import */ var _utils_valid_properties__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/valid-properties */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/valid-properties.js");



var Revenue = /** @class */ (function () {
    function Revenue() {
        this.productId = '';
        this.quantity = 1;
        this.price = 0.0;
    }
    Revenue.prototype.setProductId = function (productId) {
        this.productId = productId;
        return this;
    };
    Revenue.prototype.setQuantity = function (quantity) {
        if (quantity > 0) {
            this.quantity = quantity;
        }
        return this;
    };
    Revenue.prototype.setPrice = function (price) {
        this.price = price;
        return this;
    };
    Revenue.prototype.setRevenueType = function (revenueType) {
        this.revenueType = revenueType;
        return this;
    };
    Revenue.prototype.setRevenue = function (revenue) {
        this.revenue = revenue;
        return this;
    };
    Revenue.prototype.setEventProperties = function (properties) {
        if ((0,_utils_valid_properties__WEBPACK_IMPORTED_MODULE_0__.isValidObject)(properties)) {
            this.properties = properties;
        }
        return this;
    };
    Revenue.prototype.getEventProperties = function () {
        var eventProperties = this.properties ? (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, this.properties) : {};
        eventProperties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_2__.RevenueProperty.REVENUE_PRODUCT_ID] = this.productId;
        eventProperties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_2__.RevenueProperty.REVENUE_QUANTITY] = this.quantity;
        eventProperties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_2__.RevenueProperty.REVENUE_PRICE] = this.price;
        eventProperties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_2__.RevenueProperty.REVENUE_TYPE] = this.revenueType;
        eventProperties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_2__.RevenueProperty.REVENUE] = this.revenue;
        return eventProperties;
    };
    return Revenue;
}());

//# sourceMappingURL=revenue.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/storage/memory.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/storage/memory.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MemoryStorage": () => (/* binding */ MemoryStorage)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");

var MemoryStorage = /** @class */ (function () {
    function MemoryStorage() {
        this.memoryStorage = new Map();
    }
    MemoryStorage.prototype.isEnabled = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                return [2 /*return*/, true];
            });
        });
    };
    MemoryStorage.prototype.get = function (key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                return [2 /*return*/, this.memoryStorage.get(key)];
            });
        });
    };
    MemoryStorage.prototype.getRaw = function (key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var value;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.get(key)];
                    case 1:
                        value = _a.sent();
                        return [2 /*return*/, value ? JSON.stringify(value) : undefined];
                }
            });
        });
    };
    MemoryStorage.prototype.set = function (key, value) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                this.memoryStorage.set(key, value);
                return [2 /*return*/];
            });
        });
    };
    MemoryStorage.prototype.remove = function (key) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                this.memoryStorage.delete(key);
                return [2 /*return*/];
            });
        });
    };
    MemoryStorage.prototype.reset = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                this.memoryStorage.clear();
                return [2 /*return*/];
            });
        });
    };
    return MemoryStorage;
}());

//# sourceMappingURL=memory.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/timeline.js":
/*!********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/timeline.js ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Timeline": () => (/* binding */ Timeline)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _utils_result_builder__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/result-builder */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/result-builder.js");
/* harmony import */ var _utils_uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/uuid */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js");



var Timeline = /** @class */ (function () {
    function Timeline(client) {
        this.client = client;
        this.queue = [];
        // Flag to guarantee one schedule apply is running
        this.applying = false;
        // Flag indicates whether timeline is ready to process event
        // Events collected before timeline is ready will stay in the queue to be processed later
        this.plugins = [];
    }
    Timeline.prototype.register = function (plugin, config) {
        var _a, _b, _c;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_d) {
                switch (_d.label) {
                    case 0:
                        plugin.name = (_a = plugin.name) !== null && _a !== void 0 ? _a : (0,_utils_uuid__WEBPACK_IMPORTED_MODULE_1__.UUID)();
                        plugin.type = (_b = plugin.type) !== null && _b !== void 0 ? _b : 'enrichment';
                        return [4 /*yield*/, ((_c = plugin.setup) === null || _c === void 0 ? void 0 : _c.call(plugin, config, this.client))];
                    case 1:
                        _d.sent();
                        this.plugins.push(plugin);
                        return [2 /*return*/];
                }
            });
        });
    };
    Timeline.prototype.deregister = function (pluginName) {
        var _a;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var index, plugin;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        index = this.plugins.findIndex(function (plugin) { return plugin.name === pluginName; });
                        plugin = this.plugins[index];
                        this.plugins.splice(index, 1);
                        return [4 /*yield*/, ((_a = plugin.teardown) === null || _a === void 0 ? void 0 : _a.call(plugin))];
                    case 1:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    Timeline.prototype.reset = function (client) {
        this.applying = false;
        var plugins = this.plugins;
        plugins.map(function (plugin) { var _a; return (_a = plugin.teardown) === null || _a === void 0 ? void 0 : _a.call(plugin); });
        this.plugins = [];
        this.client = client;
    };
    Timeline.prototype.push = function (event) {
        var _this = this;
        return new Promise(function (resolve) {
            _this.queue.push([event, resolve]);
            _this.scheduleApply(0);
        });
    };
    Timeline.prototype.scheduleApply = function (timeout) {
        var _this = this;
        if (this.applying)
            return;
        this.applying = true;
        setTimeout(function () {
            void _this.apply(_this.queue.shift()).then(function () {
                _this.applying = false;
                if (_this.queue.length > 0) {
                    _this.scheduleApply(0);
                }
            });
        }, timeout);
    };
    Timeline.prototype.apply = function (item) {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var _a, event, _b, resolve, before, before_1, before_1_1, plugin, e, e_1_1, enrichment, enrichment_1, enrichment_1_1, plugin, e, e_2_1, destination, executeDestinations;
            var e_1, _c, e_2, _d;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (!item) {
                            return [2 /*return*/];
                        }
                        _a = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(item, 1), event = _a[0];
                        _b = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(item, 2), resolve = _b[1];
                        before = this.plugins.filter(function (plugin) { return plugin.type === 'before'; });
                        _e.label = 1;
                    case 1:
                        _e.trys.push([1, 6, 7, 8]);
                        before_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(before), before_1_1 = before_1.next();
                        _e.label = 2;
                    case 2:
                        if (!!before_1_1.done) return [3 /*break*/, 5];
                        plugin = before_1_1.value;
                        /* istanbul ignore if */
                        if (!plugin.execute) {
                            // do nothing
                            return [3 /*break*/, 4];
                        }
                        return [4 /*yield*/, plugin.execute((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, event))];
                    case 3:
                        e = _e.sent();
                        if (e === null) {
                            resolve({ event: event, code: 0, message: '' });
                            return [2 /*return*/];
                        }
                        else {
                            event = e;
                        }
                        _e.label = 4;
                    case 4:
                        before_1_1 = before_1.next();
                        return [3 /*break*/, 2];
                    case 5: return [3 /*break*/, 8];
                    case 6:
                        e_1_1 = _e.sent();
                        e_1 = { error: e_1_1 };
                        return [3 /*break*/, 8];
                    case 7:
                        try {
                            if (before_1_1 && !before_1_1.done && (_c = before_1.return)) _c.call(before_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                        return [7 /*endfinally*/];
                    case 8:
                        enrichment = this.plugins.filter(function (plugin) { return plugin.type === 'enrichment' || plugin.type === undefined; });
                        _e.label = 9;
                    case 9:
                        _e.trys.push([9, 14, 15, 16]);
                        enrichment_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(enrichment), enrichment_1_1 = enrichment_1.next();
                        _e.label = 10;
                    case 10:
                        if (!!enrichment_1_1.done) return [3 /*break*/, 13];
                        plugin = enrichment_1_1.value;
                        /* istanbul ignore if */
                        if (!plugin.execute) {
                            // do nothing
                            return [3 /*break*/, 12];
                        }
                        return [4 /*yield*/, plugin.execute((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, event))];
                    case 11:
                        e = _e.sent();
                        if (e === null) {
                            resolve({ event: event, code: 0, message: '' });
                            return [2 /*return*/];
                        }
                        else {
                            event = e;
                        }
                        _e.label = 12;
                    case 12:
                        enrichment_1_1 = enrichment_1.next();
                        return [3 /*break*/, 10];
                    case 13: return [3 /*break*/, 16];
                    case 14:
                        e_2_1 = _e.sent();
                        e_2 = { error: e_2_1 };
                        return [3 /*break*/, 16];
                    case 15:
                        try {
                            if (enrichment_1_1 && !enrichment_1_1.done && (_d = enrichment_1.return)) _d.call(enrichment_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                        return [7 /*endfinally*/];
                    case 16:
                        destination = this.plugins.filter(function (plugin) { return plugin.type === 'destination'; });
                        executeDestinations = destination.map(function (plugin) {
                            var eventClone = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, event);
                            return plugin.execute(eventClone).catch(function (e) { return (0,_utils_result_builder__WEBPACK_IMPORTED_MODULE_2__.buildResult)(eventClone, 0, String(e)); });
                        });
                        void Promise.all(executeDestinations).then(function (_a) {
                            var _b = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(_a, 1), result = _b[0];
                            resolve(result);
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    Timeline.prototype.flush = function () {
        return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
            var queue, destination, executeDestinations;
            var _this = this;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        queue = this.queue;
                        this.queue = [];
                        return [4 /*yield*/, Promise.all(queue.map(function (item) { return _this.apply(item); }))];
                    case 1:
                        _a.sent();
                        destination = this.plugins.filter(function (plugin) { return plugin.type === 'destination'; });
                        executeDestinations = destination.map(function (plugin) {
                            return plugin.flush && plugin.flush();
                        });
                        return [4 /*yield*/, Promise.all(executeDestinations)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return Timeline;
}());

//# sourceMappingURL=timeline.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/transports/base.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/transports/base.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseTransport": () => (/* binding */ BaseTransport)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/status.js");
/* eslint-disable @typescript-eslint/no-unsafe-argument */
/* eslint-disable @typescript-eslint/no-unsafe-assignment */
/* eslint-disable @typescript-eslint/no-unsafe-call */

var BaseTransport = /** @class */ (function () {
    function BaseTransport() {
    }
    BaseTransport.prototype.send = function (_serverUrl, _payload) {
        return Promise.resolve(null);
    };
    BaseTransport.prototype.buildResponse = function (responseJSON) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x;
        if (typeof responseJSON !== 'object') {
            return null;
        }
        var statusCode = responseJSON.code || 0;
        var status = this.buildStatus(statusCode);
        switch (status) {
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Success:
                return {
                    status: status,
                    statusCode: statusCode,
                    body: {
                        eventsIngested: (_a = responseJSON.events_ingested) !== null && _a !== void 0 ? _a : 0,
                        payloadSizeBytes: (_b = responseJSON.payload_size_bytes) !== null && _b !== void 0 ? _b : 0,
                        serverUploadTime: (_c = responseJSON.server_upload_time) !== null && _c !== void 0 ? _c : 0,
                    },
                };
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Invalid:
                return {
                    status: status,
                    statusCode: statusCode,
                    body: {
                        error: (_d = responseJSON.error) !== null && _d !== void 0 ? _d : '',
                        missingField: (_e = responseJSON.missing_field) !== null && _e !== void 0 ? _e : '',
                        eventsWithInvalidFields: (_f = responseJSON.events_with_invalid_fields) !== null && _f !== void 0 ? _f : {},
                        eventsWithMissingFields: (_g = responseJSON.events_with_missing_fields) !== null && _g !== void 0 ? _g : {},
                        eventsWithInvalidIdLengths: (_h = responseJSON.events_with_invalid_id_lengths) !== null && _h !== void 0 ? _h : {},
                        epsThreshold: (_j = responseJSON.eps_threshold) !== null && _j !== void 0 ? _j : 0,
                        exceededDailyQuotaDevices: (_k = responseJSON.exceeded_daily_quota_devices) !== null && _k !== void 0 ? _k : {},
                        silencedDevices: (_l = responseJSON.silenced_devices) !== null && _l !== void 0 ? _l : [],
                        silencedEvents: (_m = responseJSON.silenced_events) !== null && _m !== void 0 ? _m : [],
                        throttledDevices: (_o = responseJSON.throttled_devices) !== null && _o !== void 0 ? _o : {},
                        throttledEvents: (_p = responseJSON.throttled_events) !== null && _p !== void 0 ? _p : [],
                    },
                };
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.PayloadTooLarge:
                return {
                    status: status,
                    statusCode: statusCode,
                    body: {
                        error: (_q = responseJSON.error) !== null && _q !== void 0 ? _q : '',
                    },
                };
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.RateLimit:
                return {
                    status: status,
                    statusCode: statusCode,
                    body: {
                        error: (_r = responseJSON.error) !== null && _r !== void 0 ? _r : '',
                        epsThreshold: (_s = responseJSON.eps_threshold) !== null && _s !== void 0 ? _s : 0,
                        throttledDevices: (_t = responseJSON.throttled_devices) !== null && _t !== void 0 ? _t : {},
                        throttledUsers: (_u = responseJSON.throttled_users) !== null && _u !== void 0 ? _u : {},
                        exceededDailyQuotaDevices: (_v = responseJSON.exceeded_daily_quota_devices) !== null && _v !== void 0 ? _v : {},
                        exceededDailyQuotaUsers: (_w = responseJSON.exceeded_daily_quota_users) !== null && _w !== void 0 ? _w : {},
                        throttledEvents: (_x = responseJSON.throttled_events) !== null && _x !== void 0 ? _x : [],
                    },
                };
            case _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Timeout:
            default:
                return {
                    status: status,
                    statusCode: statusCode,
                };
        }
    };
    BaseTransport.prototype.buildStatus = function (code) {
        if (code >= 200 && code < 300) {
            return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Success;
        }
        if (code === 429) {
            return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.RateLimit;
        }
        if (code === 413) {
            return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.PayloadTooLarge;
        }
        if (code === 408) {
            return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Timeout;
        }
        if (code >= 400 && code < 500) {
            return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Invalid;
        }
        if (code >= 500) {
            return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Failed;
        }
        return _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Unknown;
    };
    return BaseTransport;
}());

//# sourceMappingURL=base.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/chunk.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/chunk.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "chunk": () => (/* binding */ chunk)
/* harmony export */ });
// Creates an array of elements split into groups the length of size.
// If array can't be split evenly, the final chunk will be the remaining elements.
// Works similary as https://lodash.com/docs/4.17.15#chunk
var chunk = function (arr, size) {
    var chunkSize = Math.max(size, 1);
    return arr.reduce(function (chunks, element, index) {
        var chunkIndex = Math.floor(index / chunkSize);
        if (!chunks[chunkIndex]) {
            chunks[chunkIndex] = [];
        }
        chunks[chunkIndex].push(element);
        return chunks;
    }, []);
};
//# sourceMappingURL=chunk.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/debug.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/debug.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "debugWrapper": () => (/* binding */ debugWrapper),
/* harmony export */   "getClientLogConfig": () => (/* binding */ getClientLogConfig),
/* harmony export */   "getClientStates": () => (/* binding */ getClientStates),
/* harmony export */   "getStacktrace": () => (/* binding */ getStacktrace),
/* harmony export */   "getValueByStringPath": () => (/* binding */ getValueByStringPath)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js");

/* eslint-disable @typescript-eslint/no-unsafe-assignment */
/* eslint-disable @typescript-eslint/no-unsafe-member-access */
/* eslint-disable @typescript-eslint/no-unsafe-call */
/* eslint-disable @typescript-eslint/no-non-null-assertion */

var getStacktrace = function (ignoreDepth) {
    if (ignoreDepth === void 0) { ignoreDepth = 0; }
    var trace = new Error().stack || '';
    return trace
        .split('\n')
        .slice(2 + ignoreDepth)
        .map(function (text) { return text.trim(); });
};
// This hook makes sure we always get the latest logger and logLevel.
var getClientLogConfig = function (client) { return function () {
    var _a = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, client.config), logger = _a.loggerProvider, logLevel = _a.logLevel;
    return {
        logger: logger,
        logLevel: logLevel,
    };
}; };
// This is a convenient function to get the attribute from object with string path, similar to lodash '#get'.
var getValueByStringPath = function (obj, path) {
    var e_1, _a;
    path = path.replace(/\[(\w+)\]/g, '.$1'); // convert indexes to properties
    path = path.replace(/^\./, ''); // strip a leading dot
    try {
        for (var _b = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(path.split('.')), _c = _b.next(); !_c.done; _c = _b.next()) {
            var attr = _c.value;
            if (attr in obj) {
                obj = obj[attr];
            }
            else {
                return;
            }
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return obj;
};
var getClientStates = function (client, paths) { return function () {
    var e_2, _a;
    var res = {};
    try {
        for (var paths_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(paths), paths_1_1 = paths_1.next(); !paths_1_1.done; paths_1_1 = paths_1.next()) {
            var path = paths_1_1.value;
            res[path] = getValueByStringPath(client, path);
        }
    }
    catch (e_2_1) { e_2 = { error: e_2_1 }; }
    finally {
        try {
            if (paths_1_1 && !paths_1_1.done && (_a = paths_1.return)) _a.call(paths_1);
        }
        finally { if (e_2) throw e_2.error; }
    }
    return res;
}; };
var debugWrapper = function (fn, fnName, getLogConfig, getStates, fnContext) {
    if (fnContext === void 0) { fnContext = null; }
    return function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var _a = getLogConfig(), logger = _a.logger, logLevel = _a.logLevel;
        // return early if possible to reduce overhead
        if ((logLevel && logLevel < _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.LogLevel.Debug) || !logLevel || !logger) {
            return fn.apply(fnContext, args);
        }
        var debugContext = {
            type: 'invoke public method',
            name: fnName,
            args: args,
            stacktrace: getStacktrace(1),
            time: {
                start: new Date().toISOString(),
            },
            states: {},
        };
        if (getStates && debugContext.states) {
            debugContext.states.before = getStates();
        }
        var result = fn.apply(fnContext, args);
        if (result && result.promise) {
            // if result is a promise, add the callback
            result.promise.then(function () {
                if (getStates && debugContext.states) {
                    debugContext.states.after = getStates();
                }
                if (debugContext.time) {
                    debugContext.time.end = new Date().toISOString();
                }
                logger.debug(JSON.stringify(debugContext, null, 2));
            });
        }
        else {
            if (getStates && debugContext.states) {
                debugContext.states.after = getStates();
            }
            if (debugContext.time) {
                debugContext.time.end = new Date().toISOString();
            }
            logger.debug(JSON.stringify(debugContext, null, 2));
        }
        return result;
    };
};
//# sourceMappingURL=debug.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/event-builder.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/event-builder.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createGroupEvent": () => (/* binding */ createGroupEvent),
/* harmony export */   "createGroupIdentifyEvent": () => (/* binding */ createGroupIdentifyEvent),
/* harmony export */   "createIdentifyEvent": () => (/* binding */ createIdentifyEvent),
/* harmony export */   "createRevenueEvent": () => (/* binding */ createRevenueEvent),
/* harmony export */   "createTrackEvent": () => (/* binding */ createTrackEvent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/event.js");
/* harmony import */ var _identify__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../identify */ "./node_modules/@amplitude/analytics-core/lib/esm/identify.js");



var createTrackEvent = function (eventInput, eventProperties, eventOptions) {
    var baseEvent = typeof eventInput === 'string' ? { event_type: eventInput } : eventInput;
    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, baseEvent), eventOptions), (eventProperties && { event_properties: eventProperties }));
};
var createIdentifyEvent = function (identify, eventOptions) {
    var identifyEvent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, eventOptions), { event_type: _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.SpecialEventType.IDENTIFY, user_properties: identify.getUserProperties() });
    return identifyEvent;
};
var createGroupIdentifyEvent = function (groupType, groupName, identify, eventOptions) {
    var _a;
    var groupIdentify = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, eventOptions), { event_type: _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.SpecialEventType.GROUP_IDENTIFY, group_properties: identify.getUserProperties(), groups: (_a = {},
            _a[groupType] = groupName,
            _a) });
    return groupIdentify;
};
var createGroupEvent = function (groupType, groupName, eventOptions) {
    var _a;
    var identify = new _identify__WEBPACK_IMPORTED_MODULE_2__.Identify();
    identify.set(groupType, groupName);
    var groupEvent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, eventOptions), { event_type: _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.SpecialEventType.IDENTIFY, user_properties: identify.getUserProperties(), groups: (_a = {},
            _a[groupType] = groupName,
            _a) });
    return groupEvent;
};
var createRevenueEvent = function (revenue, eventOptions) {
    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, eventOptions), { event_type: _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_1__.SpecialEventType.REVENUE, event_properties: revenue.getEventProperties() });
};
//# sourceMappingURL=event-builder.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/result-builder.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/result-builder.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "buildResult": () => (/* binding */ buildResult)
/* harmony export */ });
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/status.js");

var buildResult = function (event, code, message) {
    if (code === void 0) { code = 0; }
    if (message === void 0) { message = _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_0__.Status.Unknown; }
    return { event: event, code: code, message: message };
};
//# sourceMappingURL=result-builder.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/return-wrapper.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/return-wrapper.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "returnWrapper": () => (/* binding */ returnWrapper)
/* harmony export */ });
var returnWrapper = function (awaitable) { return ({
    promise: awaitable || Promise.resolve(),
}); };
//# sourceMappingURL=return-wrapper.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/uuid.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UUID": () => (/* binding */ UUID)
/* harmony export */ });
/**
 * Source: [jed's gist]{@link https://gist.github.com/982883}.
 * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,
 * where each x is replaced with a random hexadecimal digit from 0 to f, and
 * y is replaced with a random hexadecimal digit from 8 to b.
 * Used to generate UUIDs for deviceIds.
 * @private
 */
var UUID = function (a) {
    return a // if the placeholder was passed, return
        ? // a random number from 0 to 15
            (a ^ // unless b is 8,
                ((Math.random() * // in which case
                    16) >> // a random number from
                    (a / 4))) // 8 to 11
                .toString(16) // in hexadecimal
        : // or otherwise a concatenated string:
            (String(1e7) + // 10000000 +
                String(-1e3) + // -1000 +
                String(-4e3) + // -4000 +
                String(-8e3) + // -80000000 +
                String(-1e11)) // -100000000000,
                .replace(
            // replacing
            /[018]/g, // zeroes, ones, and eights with
            UUID);
};
//# sourceMappingURL=uuid.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-core/lib/esm/utils/valid-properties.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-core/lib/esm/utils/valid-properties.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isValidObject": () => (/* binding */ isValidObject),
/* harmony export */   "isValidProperties": () => (/* binding */ isValidProperties)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");

var MAX_PROPERTY_KEYS = 1000;
var isValidObject = function (properties) {
    if (Object.keys(properties).length > MAX_PROPERTY_KEYS) {
        return false;
    }
    for (var key in properties) {
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        var value = properties[key];
        if (!isValidProperties(key, value))
            return false;
    }
    return true;
};
var isValidProperties = function (property, value) {
    var e_1, _a;
    if (typeof property !== 'string')
        return false;
    if (Array.isArray(value)) {
        var isValid = true;
        try {
            for (var value_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(value), value_1_1 = value_1.next(); !value_1_1.done; value_1_1 = value_1.next()) {
                var valueElement = value_1_1.value;
                if (Array.isArray(valueElement)) {
                    return false;
                }
                else if (typeof valueElement === 'object') {
                    isValid = isValid && isValidObject(valueElement);
                }
                else if (!['number', 'string'].includes(typeof valueElement)) {
                    return false;
                }
                if (!isValid) {
                    return false;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (value_1_1 && !value_1_1.done && (_a = value_1.return)) _a.call(value_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    else if (value === null || value === undefined) {
        return false;
    }
    else if (typeof value === 'object') {
        // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
        return isValidObject(value);
    }
    else if (!['number', 'string', 'boolean'].includes(typeof value)) {
        return false;
    }
    return true;
};
//# sourceMappingURL=valid-properties.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-types/lib/esm/event.js":
/*!******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-types/lib/esm/event.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IdentifyOperation": () => (/* binding */ IdentifyOperation),
/* harmony export */   "RevenueProperty": () => (/* binding */ RevenueProperty),
/* harmony export */   "SpecialEventType": () => (/* binding */ SpecialEventType)
/* harmony export */ });
var IdentifyOperation;
(function (IdentifyOperation) {
    // Base Operations to set values
    IdentifyOperation["SET"] = "$set";
    IdentifyOperation["SET_ONCE"] = "$setOnce";
    // Operations around modifying existing values
    IdentifyOperation["ADD"] = "$add";
    IdentifyOperation["APPEND"] = "$append";
    IdentifyOperation["PREPEND"] = "$prepend";
    IdentifyOperation["REMOVE"] = "$remove";
    // Operations around appending values *if* they aren't present
    IdentifyOperation["PREINSERT"] = "$preInsert";
    IdentifyOperation["POSTINSERT"] = "$postInsert";
    // Operations around removing properties/values
    IdentifyOperation["UNSET"] = "$unset";
    IdentifyOperation["CLEAR_ALL"] = "$clearAll";
})(IdentifyOperation || (IdentifyOperation = {}));
var RevenueProperty;
(function (RevenueProperty) {
    RevenueProperty["REVENUE_PRODUCT_ID"] = "$productId";
    RevenueProperty["REVENUE_QUANTITY"] = "$quantity";
    RevenueProperty["REVENUE_PRICE"] = "$price";
    RevenueProperty["REVENUE_TYPE"] = "$revenueType";
    RevenueProperty["REVENUE"] = "$revenue";
})(RevenueProperty || (RevenueProperty = {}));
/**
 * Strings that have special meaning when used as an event's type
 * and have different specifications.
 */
var SpecialEventType;
(function (SpecialEventType) {
    SpecialEventType["IDENTIFY"] = "$identify";
    SpecialEventType["GROUP_IDENTIFY"] = "$groupidentify";
    SpecialEventType["REVENUE"] = "revenue_amount";
})(SpecialEventType || (SpecialEventType = {}));
//# sourceMappingURL=event.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-types/lib/esm/index.js":
/*!******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-types/lib/esm/index.js ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IdentifyOperation": () => (/* reexport safe */ _event__WEBPACK_IMPORTED_MODULE_0__.IdentifyOperation),
/* harmony export */   "LogLevel": () => (/* reexport safe */ _logger__WEBPACK_IMPORTED_MODULE_1__.LogLevel),
/* harmony export */   "RevenueProperty": () => (/* reexport safe */ _event__WEBPACK_IMPORTED_MODULE_0__.RevenueProperty),
/* harmony export */   "ServerZone": () => (/* reexport safe */ _server_zone__WEBPACK_IMPORTED_MODULE_2__.ServerZone),
/* harmony export */   "SpecialEventType": () => (/* reexport safe */ _event__WEBPACK_IMPORTED_MODULE_0__.SpecialEventType),
/* harmony export */   "Status": () => (/* reexport safe */ _status__WEBPACK_IMPORTED_MODULE_3__.Status)
/* harmony export */ });
/* harmony import */ var _event__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./event */ "./node_modules/@amplitude/analytics-types/lib/esm/event.js");
/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./logger */ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js");
/* harmony import */ var _server_zone__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./server-zone */ "./node_modules/@amplitude/analytics-types/lib/esm/server-zone.js");
/* harmony import */ var _status__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./status */ "./node_modules/@amplitude/analytics-types/lib/esm/status.js");




//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-types/lib/esm/logger.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-types/lib/esm/logger.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LogLevel": () => (/* binding */ LogLevel)
/* harmony export */ });
var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["None"] = 0] = "None";
    LogLevel[LogLevel["Error"] = 1] = "Error";
    LogLevel[LogLevel["Warn"] = 2] = "Warn";
    LogLevel[LogLevel["Verbose"] = 3] = "Verbose";
    LogLevel[LogLevel["Debug"] = 4] = "Debug";
})(LogLevel || (LogLevel = {}));
//# sourceMappingURL=logger.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-types/lib/esm/server-zone.js":
/*!************************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-types/lib/esm/server-zone.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServerZone": () => (/* binding */ ServerZone)
/* harmony export */ });
/**
 * @deprecated use ServerZoneType instead
 */
var ServerZone;
(function (ServerZone) {
    ServerZone["US"] = "US";
    ServerZone["EU"] = "EU";
})(ServerZone || (ServerZone = {}));
//# sourceMappingURL=server-zone.js.map

/***/ }),

/***/ "./node_modules/@amplitude/analytics-types/lib/esm/status.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@amplitude/analytics-types/lib/esm/status.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Status": () => (/* binding */ Status)
/* harmony export */ });
/** The status of an event. */
var Status;
(function (Status) {
    /** The status could not be determined. */
    Status["Unknown"] = "unknown";
    /** The event was skipped due to configuration or callbacks. */
    Status["Skipped"] = "skipped";
    /** The event was sent successfully. */
    Status["Success"] = "success";
    /** A user or device in the payload is currently rate limited and should try again later. */
    Status["RateLimit"] = "rate_limit";
    /** The sent payload was too large to be processed. */
    Status["PayloadTooLarge"] = "payload_too_large";
    /** The event could not be processed. */
    Status["Invalid"] = "invalid";
    /** A server-side error ocurred during submission. */
    Status["Failed"] = "failed";
    /** a server or client side error occuring when a request takes too long and is cancelled */
    Status["Timeout"] = "Timeout";
    /** NodeJS runtime environment error.. E.g. disconnected from network */
    Status["SystemError"] = "SystemError";
})(Status || (Status = {}));
//# sourceMappingURL=status.js.map

/***/ }),

/***/ "./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/page-view-tracking.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/page-view-tracking.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "pageViewTrackingPlugin": () => (/* binding */ pageViewTrackingPlugin),
/* harmony export */   "shouldTrackHistoryPageView": () => (/* binding */ shouldTrackHistoryPageView)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/global-scope.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/campaign-parser.js");
/* harmony import */ var _amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @amplitude/analytics-types */ "./node_modules/@amplitude/analytics-types/lib/esm/event.js");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/constants.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/utils.js");





var pageViewTrackingPlugin = function (options) {
    if (options === void 0) { options = {}; }
    var amplitude;
    var globalScope = (0,_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_0__.getGlobalScope)();
    var loggerProvider = undefined;
    var pushState;
    var createPageViewEvent = function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(void 0, void 0, void 0, function () {
        var _a;
        var _b;
        var _c;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_d) {
            switch (_d.label) {
                case 0:
                    _b = {
                        event_type: (_c = options.eventType) !== null && _c !== void 0 ? _c : '[Amplitude] Page Viewed'
                    };
                    _a = [{}];
                    return [4 /*yield*/, getCampaignParams()];
                case 1: return [2 /*return*/, (_b.event_properties = tslib__WEBPACK_IMPORTED_MODULE_1__.__assign.apply(void 0, [tslib__WEBPACK_IMPORTED_MODULE_1__.__assign.apply(void 0, _a.concat([(_d.sent())])), { '[Amplitude] Page Domain': 
                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.hostname) || '', '[Amplitude] Page Location': 
                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.href) || '', '[Amplitude] Page Path': 
                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.pathname) || '', '[Amplitude] Page Title': /* istanbul ignore next */ (typeof document !== 'undefined' && document.title) || '', '[Amplitude] Page URL': 
                            /* istanbul ignore next */ (typeof location !== 'undefined' && location.href.split('?')[0]) || '' }]),
                        _b)];
            }
        });
    }); };
    var shouldTrackOnPageLoad = function () {
        return typeof options.trackOn === 'undefined' || (typeof options.trackOn === 'function' && options.trackOn());
    };
    /* istanbul ignore next */
    var previousURL = typeof location !== 'undefined' ? location.href : null;
    var trackHistoryPageView = function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(void 0, void 0, void 0, function () {
        var newURL, shouldTrackPageView, _a, _b, _c;
        return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_d) {
            switch (_d.label) {
                case 0:
                    newURL = location.href;
                    shouldTrackPageView = shouldTrackHistoryPageView(options.trackHistoryChanges, newURL, previousURL || '') && shouldTrackOnPageLoad();
                    // Note: Update `previousURL` in the same clock tick as `shouldTrackHistoryPageView()`
                    // This was previously done after `amplitude?.track(await createPageViewEvent());` and
                    // causes a concurrency issue where app triggers `pushState` twice with the same URL target
                    // but `previousURL` is only updated after the second `pushState` producing two page viewed events
                    previousURL = newURL;
                    if (!shouldTrackPageView) return [3 /*break*/, 4];
                    /* istanbul ignore next */
                    loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.log('Tracking page view event');
                    if (!(amplitude === null || amplitude === void 0)) return [3 /*break*/, 1];
                    _a = void 0;
                    return [3 /*break*/, 3];
                case 1:
                    _c = (_b = amplitude).track;
                    return [4 /*yield*/, createPageViewEvent()];
                case 2:
                    _a = _c.apply(_b, [_d.sent()]);
                    _d.label = 3;
                case 3:
                    _a;
                    _d.label = 4;
                case 4: return [2 /*return*/];
            }
        });
    }); };
    /* istanbul ignore next */
    var trackHistoryPageViewWrapper = function () {
        void trackHistoryPageView();
    };
    var plugin = {
        name: '@amplitude/plugin-page-view-tracking-browser',
        type: 'enrichment',
        setup: function (config, client) { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(void 0, void 0, void 0, function () {
            var _a, _b;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_c) {
                switch (_c.label) {
                    case 0:
                        amplitude = client;
                        loggerProvider = config.loggerProvider;
                        loggerProvider.log('Installing @amplitude/plugin-page-view-tracking-browser');
                        if (globalScope) {
                            globalScope.addEventListener('popstate', trackHistoryPageViewWrapper);
                            // Save reference to original push state, to be used in teardown
                            // eslint-disable-next-line @typescript-eslint/unbound-method
                            pushState = globalScope.history.pushState;
                            /* istanbul ignore next */
                            // There is no global browser listener for changes to history, so we have
                            // to modify pushState directly.
                            // https://stackoverflow.com/a/64927639
                            // eslint-disable-next-line @typescript-eslint/unbound-method
                            globalScope.history.pushState = new Proxy(globalScope.history.pushState, {
                                apply: function (target, thisArg, _a) {
                                    var _b = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__read)(_a, 3), state = _b[0], unused = _b[1], url = _b[2];
                                    target.apply(thisArg, [state, unused, url]);
                                    void trackHistoryPageView();
                                },
                            });
                        }
                        if (!shouldTrackOnPageLoad()) return [3 /*break*/, 2];
                        loggerProvider.log('Tracking page view event');
                        _b = (_a = amplitude).track;
                        return [4 /*yield*/, createPageViewEvent()];
                    case 1:
                        _b.apply(_a, [_c.sent()]);
                        _c.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        }); },
        execute: function (event) { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(void 0, void 0, void 0, function () {
            var pageViewEvent;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(options.trackOn === 'attribution' && isCampaignEvent(event))) return [3 /*break*/, 2];
                        /* istanbul ignore next */ // loggerProvider should be defined by the time execute is invoked
                        loggerProvider === null || loggerProvider === void 0 ? void 0 : loggerProvider.log('Enriching campaign event to page view event with campaign parameters');
                        return [4 /*yield*/, createPageViewEvent()];
                    case 1:
                        pageViewEvent = _a.sent();
                        event.event_type = pageViewEvent.event_type;
                        event.event_properties = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, event.event_properties), pageViewEvent.event_properties);
                        _a.label = 2;
                    case 2: return [2 /*return*/, event];
                }
            });
        }); },
        teardown: function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(void 0, void 0, void 0, function () {
            return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_a) {
                if (globalScope) {
                    globalScope.removeEventListener('popstate', trackHistoryPageViewWrapper);
                    if (pushState) {
                        globalScope.history.pushState = pushState;
                    }
                }
                return [2 /*return*/];
            });
        }); },
    };
    return plugin;
};
var getCampaignParams = function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__awaiter)(void 0, void 0, void 0, function () { var _a; return (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__generator)(this, function (_b) {
    switch (_b.label) {
        case 0:
            _a = _utils__WEBPACK_IMPORTED_MODULE_2__.omitUndefined;
            return [4 /*yield*/, new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_3__.CampaignParser().parse()];
        case 1: return [2 /*return*/, _a.apply(void 0, [_b.sent()])];
    }
}); }); };
var isCampaignEvent = function (event) {
    if (event.event_type === '$identify' && event.user_properties) {
        var properties = event.user_properties;
        var $set = properties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__.IdentifyOperation.SET] || {};
        var $unset = properties[_amplitude_analytics_types__WEBPACK_IMPORTED_MODULE_4__.IdentifyOperation.UNSET] || {};
        var userProperties_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__read)(Object.keys($set)), false), (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__read)(Object.keys($unset)), false);
        return Object.keys(_amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_5__.BASE_CAMPAIGN).every(function (value) { return userProperties_1.includes(value); });
    }
    return false;
};
var shouldTrackHistoryPageView = function (trackingOption, newURL, oldURL) {
    switch (trackingOption) {
        case 'pathOnly':
            return newURL.split('?')[0] !== oldURL.split('?')[0];
        default:
            return newURL !== oldURL;
    }
};
//# sourceMappingURL=page-view-tracking.js.map

/***/ }),

/***/ "./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/utils.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@amplitude/plugin-page-view-tracking-browser/lib/esm/utils.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "omitUndefined": () => (/* binding */ omitUndefined)
/* harmony export */ });
var omitUndefined = function (input) {
    var obj = {};
    for (var key in input) {
        var val = input[key];
        if (val) {
            obj[key] = val;
        }
    }
    return obj;
};
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/helpers.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/helpers.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createCampaignEvent": () => (/* binding */ createCampaignEvent),
/* harmony export */   "getDefaultExcludedReferrers": () => (/* binding */ getDefaultExcludedReferrers),
/* harmony export */   "getStorageKey": () => (/* binding */ getStorageKey),
/* harmony export */   "isExcludedReferrer": () => (/* binding */ isExcludedReferrer),
/* harmony export */   "isNewCampaign": () => (/* binding */ isNewCampaign)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/constants.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/constants.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/identify.js");
/* harmony import */ var _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @amplitude/analytics-core */ "./node_modules/@amplitude/analytics-core/lib/esm/utils/event-builder.js");



var getStorageKey = function (apiKey, postKey, limit) {
    if (postKey === void 0) { postKey = ''; }
    if (limit === void 0) { limit = 10; }
    return [_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_0__.AMPLITUDE_PREFIX, postKey, apiKey.substring(0, limit)].filter(Boolean).join('_');
};
var domainWithoutSubdomain = function (domain) {
    var parts = domain.split('.');
    if (parts.length <= 2) {
        return domain;
    }
    return parts.slice(parts.length - 2, parts.length).join('.');
};
var isNewCampaign = function (current, previous, options) {
    var referrer = current.referrer, referring_domain = current.referring_domain, currentCampaign = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__rest)(current, ["referrer", "referring_domain"]);
    var _a = previous || {}, _previous_referrer = _a.referrer, prevReferringDomain = _a.referring_domain, previousCampaign = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__rest)(_a, ["referrer", "referring_domain"]);
    if (isExcludedReferrer(options.excludeReferrers, current.referring_domain)) {
        return false;
    }
    var hasNewCampaign = JSON.stringify(currentCampaign) !== JSON.stringify(previousCampaign);
    var hasNewDomain = domainWithoutSubdomain(referring_domain || '') !== domainWithoutSubdomain(prevReferringDomain || '');
    return !previous || hasNewCampaign || hasNewDomain;
};
var isExcludedReferrer = function (excludeReferrers, referringDomain) {
    if (excludeReferrers === void 0) { excludeReferrers = []; }
    if (referringDomain === void 0) { referringDomain = ''; }
    return excludeReferrers.some(function (value) {
        return value instanceof RegExp ? value.test(referringDomain) : value === referringDomain;
    });
};
var createCampaignEvent = function (campaign, options) {
    var campaignParameters = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_1__.__assign)({}, _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_2__.BASE_CAMPAIGN), campaign);
    var identifyEvent = Object.entries(campaignParameters).reduce(function (identify, _a) {
        var _b;
        var _c = (0,tslib__WEBPACK_IMPORTED_MODULE_1__.__read)(_a, 2), key = _c[0], value = _c[1];
        identify.setOnce("initial_".concat(key), (_b = value !== null && value !== void 0 ? value : options.initialEmptyValue) !== null && _b !== void 0 ? _b : 'EMPTY');
        if (value) {
            return identify.set(key, value);
        }
        return identify.unset(key);
    }, new _amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_3__.Identify());
    return (0,_amplitude_analytics_core__WEBPACK_IMPORTED_MODULE_4__.createIdentifyEvent)(identifyEvent);
};
var getDefaultExcludedReferrers = function (cookieDomain) {
    var domain = cookieDomain;
    if (domain) {
        if (domain.startsWith('.')) {
            domain = domain.substring(1);
        }
        return [new RegExp("".concat(domain.replace('.', '\\.'), "$"))];
    }
    return [];
};
//# sourceMappingURL=helpers.js.map

/***/ }),

/***/ "./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/web-attribution.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/web-attribution.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "webAttributionPlugin": () => (/* binding */ webAttributionPlugin)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @amplitude/analytics-client-common */ "./node_modules/@amplitude/analytics-client-common/lib/esm/attribution/campaign-parser.js");
/* harmony import */ var _helpers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./helpers */ "./node_modules/@amplitude/plugin-web-attribution-browser/lib/esm/helpers.js");



var webAttributionPlugin = function (options) {
    var _this = this;
    if (options === void 0) { options = {}; }
    var plugin = {
        name: '@amplitude/plugin-web-attribution-browser',
        type: 'before',
        setup: function (config, amplitude) {
            var _a;
            return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(this, void 0, void 0, function () {
                var pluginConfig, storage, storageKey, _b, currentCampaign, previousCampaign, campaignEvent;
                return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_c) {
                    switch (_c.label) {
                        case 0:
                            pluginConfig = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({ initialEmptyValue: 'EMPTY', resetSessionOnNewCampaign: false, excludeReferrers: (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getDefaultExcludedReferrers)((_a = config.cookieOptions) === null || _a === void 0 ? void 0 : _a.domain) }, options);
                            config.loggerProvider.log('Installing @amplitude/plugin-web-attribution-browser.');
                            storage = config.cookieStorage;
                            storageKey = (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.getStorageKey)(config.apiKey, 'MKTG');
                            return [4 /*yield*/, Promise.all([
                                    new _amplitude_analytics_client_common__WEBPACK_IMPORTED_MODULE_2__.CampaignParser().parse(),
                                    storage.get(storageKey),
                                ])];
                        case 1:
                            _b = tslib__WEBPACK_IMPORTED_MODULE_0__.__read.apply(void 0, [_c.sent(), 2]), currentCampaign = _b[0], previousCampaign = _b[1];
                            if ((0,_helpers__WEBPACK_IMPORTED_MODULE_1__.isNewCampaign)(currentCampaign, previousCampaign, pluginConfig)) {
                                if (pluginConfig.resetSessionOnNewCampaign) {
                                    amplitude.setSessionId(Date.now());
                                    config.loggerProvider.log('Created a new session for new campaign.');
                                }
                                config.loggerProvider.log('Tracking attribution.');
                                campaignEvent = (0,_helpers__WEBPACK_IMPORTED_MODULE_1__.createCampaignEvent)(currentCampaign, pluginConfig);
                                amplitude.track(campaignEvent);
                                void storage.set(storageKey, currentCampaign);
                            }
                            return [2 /*return*/];
                    }
                });
            });
        },
        execute: function (event) { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__awaiter)(_this, void 0, void 0, function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__generator)(this, function (_a) {
            return [2 /*return*/, event];
        }); }); },
    };
    return plugin;
};
//# sourceMappingURL=web-attribution.js.map

/***/ }),

/***/ "./node_modules/bent/src/browser.js":
/*!******************************************!*\
  !*** ./node_modules/bent/src/browser.js ***!
  \******************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";

/* global fetch, btoa, Headers */
const core = __webpack_require__(/*! ./core */ "./node_modules/bent/src/core.js")

class StatusError extends Error {
  constructor (res, ...params) {
    super(...params)

    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, StatusError)
    }

    this.name = 'StatusError'
    this.message = res.statusMessage
    this.statusCode = res.status
    this.res = res
    this.json = res.json.bind(res)
    this.text = res.text.bind(res)
    this.arrayBuffer = res.arrayBuffer.bind(res)
    let buffer
    const get = () => {
      if (!buffer) buffer = this.arrayBuffer()
      return buffer
    }
    Object.defineProperty(this, 'responseBody', { get })
    // match Node.js headers object
    this.headers = {}
    for (const [key, value] of res.headers.entries()) {
      this.headers[key.toLowerCase()] = value
    }
  }
}

const mkrequest = (statusCodes, method, encoding, headers, baseurl) => async (_url, body, _headers = {}) => {
  _url = baseurl + (_url || '')
  let parsed = new URL(_url)

  if (!headers) headers = {}
  if (parsed.username) {
    headers.Authorization = 'Basic ' + btoa(parsed.username + ':' + parsed.password)
    parsed = new URL(parsed.protocol + '//' + parsed.host + parsed.pathname + parsed.search)
  }
  if (parsed.protocol !== 'https:' && parsed.protocol !== 'http:') {
    throw new Error(`Unknown protocol, ${parsed.protocol}`)
  }

  if (body) {
    if (body instanceof ArrayBuffer ||
      ArrayBuffer.isView(body) ||
      typeof body === 'string'
    ) {
      // noop
    } else if (typeof body === 'object') {
      body = JSON.stringify(body)
      headers['Content-Type'] = 'application/json'
    } else {
      throw new Error('Unknown body type.')
    }
  }

  _headers = new Headers({ ...(headers || {}), ..._headers })

  const resp = await fetch(parsed, { method, headers: _headers, body })
  resp.statusCode = resp.status

  if (!statusCodes.has(resp.status)) {
    throw new StatusError(resp)
  }

  if (encoding === 'json') return resp.json()
  else if (encoding === 'buffer') return resp.arrayBuffer()
  else if (encoding === 'string') return resp.text()
  else return resp
}

module.exports = core(mkrequest)


/***/ }),

/***/ "./node_modules/bent/src/core.js":
/*!***************************************!*\
  !*** ./node_modules/bent/src/core.js ***!
  \***************************************/
/***/ ((module) => {

"use strict";

const encodings = new Set(['json', 'buffer', 'string'])

module.exports = mkrequest => (...args) => {
  const statusCodes = new Set()
  let method
  let encoding
  let headers
  let baseurl = ''

  args.forEach(arg => {
    if (typeof arg === 'string') {
      if (arg.toUpperCase() === arg) {
        if (method) {
          const msg = `Can't set method to ${arg}, already set to ${method}.`
          throw new Error(msg)
        } else {
          method = arg
        }
      } else if (arg.startsWith('http:') || arg.startsWith('https:')) {
        baseurl = arg
      } else {
        if (encodings.has(arg)) {
          encoding = arg
        } else {
          throw new Error(`Unknown encoding, ${arg}`)
        }
      }
    } else if (typeof arg === 'number') {
      statusCodes.add(arg)
    } else if (typeof arg === 'object') {
      if (Array.isArray(arg) || arg instanceof Set) {
        arg.forEach(code => statusCodes.add(code))
      } else {
        if (headers) {
          throw new Error('Cannot set headers twice.')
        }
        headers = arg
      }
    } else {
      throw new Error(`Unknown type: ${typeof arg}`)
    }
  })

  if (!method) method = 'GET'
  if (statusCodes.size === 0) {
    statusCodes.add(200)
  }

  return mkrequest(statusCodes, method, encoding, headers, baseurl)
}


/***/ }),

/***/ "./node_modules/content-type/index.js":
/*!********************************************!*\
  !*** ./node_modules/content-type/index.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";
/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */



/**
 * RegExp to match *( ";" parameter ) in RFC 7231 sec 3.1.1.1
 *
 * parameter     = token "=" ( token / quoted-string )
 * token         = 1*tchar
 * tchar         = "!" / "#" / "$" / "%" / "&" / "'" / "*"
 *               / "+" / "-" / "." / "^" / "_" / "`" / "|" / "~"
 *               / DIGIT / ALPHA
 *               ; any VCHAR, except delimiters
 * quoted-string = DQUOTE *( qdtext / quoted-pair ) DQUOTE
 * qdtext        = HTAB / SP / %x21 / %x23-5B / %x5D-7E / obs-text
 * obs-text      = %x80-FF
 * quoted-pair   = "\" ( HTAB / SP / VCHAR / obs-text )
 */
var PARAM_REGEXP = /; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g // eslint-disable-line no-control-regex
var TEXT_REGEXP = /^[\u000b\u0020-\u007e\u0080-\u00ff]+$/ // eslint-disable-line no-control-regex
var TOKEN_REGEXP = /^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/

/**
 * RegExp to match quoted-pair in RFC 7230 sec 3.2.6
 *
 * quoted-pair = "\" ( HTAB / SP / VCHAR / obs-text )
 * obs-text    = %x80-FF
 */
var QESC_REGEXP = /\\([\u000b\u0020-\u00ff])/g // eslint-disable-line no-control-regex

/**
 * RegExp to match chars that must be quoted-pair in RFC 7230 sec 3.2.6
 */
var QUOTE_REGEXP = /([\\"])/g

/**
 * RegExp to match type in RFC 7231 sec 3.1.1.1
 *
 * media-type = type "/" subtype
 * type       = token
 * subtype    = token
 */
var TYPE_REGEXP = /^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/

/**
 * Module exports.
 * @public
 */

exports.format = format
exports.parse = parse

/**
 * Format object to media type.
 *
 * @param {object} obj
 * @return {string}
 * @public
 */

function format (obj) {
  if (!obj || typeof obj !== 'object') {
    throw new TypeError('argument obj is required')
  }

  var parameters = obj.parameters
  var type = obj.type

  if (!type || !TYPE_REGEXP.test(type)) {
    throw new TypeError('invalid type')
  }

  var string = type

  // append parameters
  if (parameters && typeof parameters === 'object') {
    var param
    var params = Object.keys(parameters).sort()

    for (var i = 0; i < params.length; i++) {
      param = params[i]

      if (!TOKEN_REGEXP.test(param)) {
        throw new TypeError('invalid parameter name')
      }

      string += '; ' + param + '=' + qstring(parameters[param])
    }
  }

  return string
}

/**
 * Parse media type to object.
 *
 * @param {string|object} string
 * @return {Object}
 * @public
 */

function parse (string) {
  if (!string) {
    throw new TypeError('argument string is required')
  }

  // support req/res-like objects as argument
  var header = typeof string === 'object'
    ? getcontenttype(string)
    : string

  if (typeof header !== 'string') {
    throw new TypeError('argument string is required to be a string')
  }

  var index = header.indexOf(';')
  var type = index !== -1
    ? header.slice(0, index).trim()
    : header.trim()

  if (!TYPE_REGEXP.test(type)) {
    throw new TypeError('invalid media type')
  }

  var obj = new ContentType(type.toLowerCase())

  // parse parameters
  if (index !== -1) {
    var key
    var match
    var value

    PARAM_REGEXP.lastIndex = index

    while ((match = PARAM_REGEXP.exec(header))) {
      if (match.index !== index) {
        throw new TypeError('invalid parameter format')
      }

      index += match[0].length
      key = match[1].toLowerCase()
      value = match[2]

      if (value.charCodeAt(0) === 0x22 /* " */) {
        // remove quotes
        value = value.slice(1, -1)

        // remove escapes
        if (value.indexOf('\\') !== -1) {
          value = value.replace(QESC_REGEXP, '$1')
        }
      }

      obj.parameters[key] = value
    }

    if (index !== header.length) {
      throw new TypeError('invalid parameter format')
    }
  }

  return obj
}

/**
 * Get content-type from req/res objects.
 *
 * @param {object}
 * @return {Object}
 * @private
 */

function getcontenttype (obj) {
  var header

  if (typeof obj.getHeader === 'function') {
    // res-like
    header = obj.getHeader('content-type')
  } else if (typeof obj.headers === 'object') {
    // req-like
    header = obj.headers && obj.headers['content-type']
  }

  if (typeof header !== 'string') {
    throw new TypeError('content-type header is missing from object')
  }

  return header
}

/**
 * Quote a string if necessary.
 *
 * @param {string} val
 * @return {string}
 * @private
 */

function qstring (val) {
  var str = String(val)

  // no need to quote tokens
  if (TOKEN_REGEXP.test(str)) {
    return str
  }

  if (str.length > 0 && !TEXT_REGEXP.test(str)) {
    throw new TypeError('invalid parameter value')
  }

  return '"' + str.replace(QUOTE_REGEXP, '\\$1') + '"'
}

/**
 * Class to represent a content type.
 * @private
 */
function ContentType (type) {
  this.parameters = Object.create(null)
  this.type = type
}


/***/ }),

/***/ "./node_modules/eventsource-parser/dist/index.js":
/*!*******************************************************!*\
  !*** ./node_modules/eventsource-parser/dist/index.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
function createParser(onParse) {
  let isFirstChunk;
  let buffer;
  let startingPosition;
  let startingFieldLength;
  let eventId;
  let eventName;
  let data;
  reset();
  return {
    feed,
    reset
  };
  function reset() {
    isFirstChunk = true;
    buffer = "";
    startingPosition = 0;
    startingFieldLength = -1;
    eventId = void 0;
    eventName = void 0;
    data = "";
  }
  function feed(chunk) {
    buffer = buffer ? buffer + chunk : chunk;
    if (isFirstChunk && hasBom(buffer)) {
      buffer = buffer.slice(BOM.length);
    }
    isFirstChunk = false;
    const length = buffer.length;
    let position = 0;
    let discardTrailingNewline = false;
    while (position < length) {
      if (discardTrailingNewline) {
        if (buffer[position] === "\n") {
          ++position;
        }
        discardTrailingNewline = false;
      }
      let lineLength = -1;
      let fieldLength = startingFieldLength;
      let character;
      for (let index = startingPosition; lineLength < 0 && index < length; ++index) {
        character = buffer[index];
        if (character === ":" && fieldLength < 0) {
          fieldLength = index - position;
        } else if (character === "\r") {
          discardTrailingNewline = true;
          lineLength = index - position;
        } else if (character === "\n") {
          lineLength = index - position;
        }
      }
      if (lineLength < 0) {
        startingPosition = length - position;
        startingFieldLength = fieldLength;
        break;
      } else {
        startingPosition = 0;
        startingFieldLength = -1;
      }
      parseEventStreamLine(buffer, position, fieldLength, lineLength);
      position += lineLength + 1;
    }
    if (position === length) {
      buffer = "";
    } else if (position > 0) {
      buffer = buffer.slice(position);
    }
  }
  function parseEventStreamLine(lineBuffer, index, fieldLength, lineLength) {
    if (lineLength === 0) {
      if (data.length > 0) {
        onParse({
          type: "event",
          id: eventId,
          event: eventName || void 0,
          data: data.slice(0, -1)
          // remove trailing newline
        });

        data = "";
        eventId = void 0;
      }
      eventName = void 0;
      return;
    }
    const noValue = fieldLength < 0;
    const field = lineBuffer.slice(index, index + (noValue ? lineLength : fieldLength));
    let step = 0;
    if (noValue) {
      step = lineLength;
    } else if (lineBuffer[index + fieldLength + 1] === " ") {
      step = fieldLength + 2;
    } else {
      step = fieldLength + 1;
    }
    const position = index + step;
    const valueLength = lineLength - step;
    const value = lineBuffer.slice(position, position + valueLength).toString();
    if (field === "data") {
      data += value ? "".concat(value, "\n") : "\n";
    } else if (field === "event") {
      eventName = value;
    } else if (field === "id" && !value.includes("\0")) {
      eventId = value;
    } else if (field === "retry") {
      const retry = parseInt(value, 10);
      if (!Number.isNaN(retry)) {
        onParse({
          type: "reconnect-interval",
          value: retry
        });
      }
    }
  }
}
const BOM = [239, 187, 191];
function hasBom(buffer) {
  return BOM.every((charCode, index) => buffer.charCodeAt(index) === charCode);
}
exports.createParser = createParser;
//# sourceMappingURL=index.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/microsoft.cognitiveservices.speech.sdk.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/microsoft.cognitiveservices.speech.sdk.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityReceivedEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ActivityReceivedEventArgs),
/* harmony export */   "AudioConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioConfig),
/* harmony export */   "AudioFormatTag": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioFormatTag),
/* harmony export */   "AudioInputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioInputStream),
/* harmony export */   "AudioOutputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioOutputStream),
/* harmony export */   "AudioStreamFormat": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamFormat),
/* harmony export */   "AutoDetectSourceLanguageConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AutoDetectSourceLanguageConfig),
/* harmony export */   "AutoDetectSourceLanguageResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.AutoDetectSourceLanguageResult),
/* harmony export */   "BaseAudioPlayer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.BaseAudioPlayer),
/* harmony export */   "BotFrameworkConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.BotFrameworkConfig),
/* harmony export */   "CancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationDetails),
/* harmony export */   "CancellationDetailsBase": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationDetailsBase),
/* harmony export */   "CancellationErrorCode": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode),
/* harmony export */   "CancellationReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason),
/* harmony export */   "Connection": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Connection),
/* harmony export */   "ConnectionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionEventArgs),
/* harmony export */   "ConnectionMessage": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionMessage),
/* harmony export */   "ConnectionMessageEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionMessageEventArgs),
/* harmony export */   "Conversation": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Conversation),
/* harmony export */   "ConversationExpirationEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationExpirationEventArgs),
/* harmony export */   "ConversationParticipantsChangedEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationParticipantsChangedEventArgs),
/* harmony export */   "ConversationTranscriber": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranscriber),
/* harmony export */   "ConversationTranscriptionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranscriptionCanceledEventArgs),
/* harmony export */   "ConversationTranscriptionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranscriptionEventArgs),
/* harmony export */   "ConversationTranslationCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationCanceledEventArgs),
/* harmony export */   "ConversationTranslationEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationEventArgs),
/* harmony export */   "ConversationTranslationResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationResult),
/* harmony export */   "ConversationTranslator": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslator),
/* harmony export */   "CustomCommandsConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CustomCommandsConfig),
/* harmony export */   "Diagnostics": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Diagnostics),
/* harmony export */   "DialogServiceConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.DialogServiceConfig),
/* harmony export */   "DialogServiceConnector": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.DialogServiceConnector),
/* harmony export */   "IntentRecognitionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognitionCanceledEventArgs),
/* harmony export */   "IntentRecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognitionEventArgs),
/* harmony export */   "IntentRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognitionResult),
/* harmony export */   "IntentRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentRecognizer),
/* harmony export */   "KeywordRecognitionModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.KeywordRecognitionModel),
/* harmony export */   "LanguageIdMode": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.LanguageIdMode),
/* harmony export */   "LanguageUnderstandingModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.LanguageUnderstandingModel),
/* harmony export */   "LogLevel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.LogLevel),
/* harmony export */   "NoMatchDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.NoMatchDetails),
/* harmony export */   "NoMatchReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.NoMatchReason),
/* harmony export */   "OutputFormat": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.OutputFormat),
/* harmony export */   "Participant": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Participant),
/* harmony export */   "ParticipantChangedReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ParticipantChangedReason),
/* harmony export */   "PhraseListGrammar": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PhraseListGrammar),
/* harmony export */   "ProfanityOption": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ProfanityOption),
/* harmony export */   "PronunciationAssessmentConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentConfig),
/* harmony export */   "PronunciationAssessmentGradingSystem": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentGradingSystem),
/* harmony export */   "PronunciationAssessmentGranularity": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentGranularity),
/* harmony export */   "PronunciationAssessmentResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PronunciationAssessmentResult),
/* harmony export */   "PropertyCollection": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection),
/* harmony export */   "PropertyId": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId),
/* harmony export */   "PullAudioInputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PullAudioInputStream),
/* harmony export */   "PullAudioInputStreamCallback": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PullAudioInputStreamCallback),
/* harmony export */   "PullAudioOutputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PullAudioOutputStream),
/* harmony export */   "PushAudioInputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PushAudioInputStream),
/* harmony export */   "PushAudioOutputStream": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PushAudioOutputStream),
/* harmony export */   "PushAudioOutputStreamCallback": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PushAudioOutputStreamCallback),
/* harmony export */   "RecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionEventArgs),
/* harmony export */   "RecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionResult),
/* harmony export */   "Recognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Recognizer),
/* harmony export */   "ResultReason": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ResultReason),
/* harmony export */   "ServiceEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ServiceEventArgs),
/* harmony export */   "ServicePropertyChannel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.ServicePropertyChannel),
/* harmony export */   "SessionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SessionEventArgs),
/* harmony export */   "SourceLanguageConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SourceLanguageConfig),
/* harmony export */   "SpeakerAudioDestination": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerAudioDestination),
/* harmony export */   "SpeakerIdentificationModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerIdentificationModel),
/* harmony export */   "SpeakerRecognitionCancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionCancellationDetails),
/* harmony export */   "SpeakerRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionResult),
/* harmony export */   "SpeakerRecognitionResultType": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionResultType),
/* harmony export */   "SpeakerRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognizer),
/* harmony export */   "SpeakerVerificationModel": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerVerificationModel),
/* harmony export */   "SpeechConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechConfig),
/* harmony export */   "SpeechConfigImpl": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechConfigImpl),
/* harmony export */   "SpeechRecognitionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionCanceledEventArgs),
/* harmony export */   "SpeechRecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionEventArgs),
/* harmony export */   "SpeechRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionResult),
/* harmony export */   "SpeechRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognizer),
/* harmony export */   "SpeechSynthesisBookmarkEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisBookmarkEventArgs),
/* harmony export */   "SpeechSynthesisBoundaryType": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisBoundaryType),
/* harmony export */   "SpeechSynthesisEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisEventArgs),
/* harmony export */   "SpeechSynthesisOutputFormat": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisOutputFormat),
/* harmony export */   "SpeechSynthesisResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisResult),
/* harmony export */   "SpeechSynthesisVisemeEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisVisemeEventArgs),
/* harmony export */   "SpeechSynthesisWordBoundaryEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisWordBoundaryEventArgs),
/* harmony export */   "SpeechSynthesizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesizer),
/* harmony export */   "SpeechTranslationConfig": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechTranslationConfig),
/* harmony export */   "SpeechTranslationConfigImpl": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechTranslationConfigImpl),
/* harmony export */   "SynthesisResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisResult),
/* harmony export */   "SynthesisVoicesResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisVoicesResult),
/* harmony export */   "TranslationRecognitionCanceledEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognitionCanceledEventArgs),
/* harmony export */   "TranslationRecognitionEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognitionEventArgs),
/* harmony export */   "TranslationRecognitionResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognitionResult),
/* harmony export */   "TranslationRecognizer": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationRecognizer),
/* harmony export */   "TranslationSynthesisEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationSynthesisEventArgs),
/* harmony export */   "TranslationSynthesisResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationSynthesisResult),
/* harmony export */   "Translations": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.Translations),
/* harmony export */   "TurnStatusReceivedEventArgs": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.TurnStatusReceivedEventArgs),
/* harmony export */   "User": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.User),
/* harmony export */   "VoiceInfo": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceInfo),
/* harmony export */   "VoiceProfile": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfile),
/* harmony export */   "VoiceProfileCancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileCancellationDetails),
/* harmony export */   "VoiceProfileClient": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileClient),
/* harmony export */   "VoiceProfileEnrollmentCancellationDetails": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileEnrollmentCancellationDetails),
/* harmony export */   "VoiceProfileEnrollmentResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileEnrollmentResult),
/* harmony export */   "VoiceProfilePhraseResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfilePhraseResult),
/* harmony export */   "VoiceProfileResult": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileResult),
/* harmony export */   "VoiceProfileType": () => (/* reexport safe */ _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.VoiceProfileType)
/* harmony export */ });
/* harmony import */ var _src_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./src/common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js");
/* harmony import */ var _src_common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./src/common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _src_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./src/sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Exports.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


// Common.Storage.SetLocalStorage(new Common.Browser.LocalStorage());
// Common.Storage.SetSessionStorage(new Common.Browser.SessionStorage());
_src_common_Exports__WEBPACK_IMPORTED_MODULE_0__.Events.instance.attachConsoleListener(new _src_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.ConsoleLoggingListener());
// Speech SDK API


//# sourceMappingURL=microsoft.cognitiveservices.speech.sdk.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConsoleLoggingListener": () => (/* binding */ ConsoleLoggingListener)
/* harmony export */ });
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ "?0825");
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/LogLevel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* eslint-disable @typescript-eslint/no-unsafe-assignment */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class ConsoleLoggingListener {
    constructor(logLevelFilter = _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.None) {
        this.privLogPath = undefined;
        this.privEnableConsoleOutput = true;
        this.privLogLevelFilter = logLevelFilter;
    }
    set logPath(path) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(fs__WEBPACK_IMPORTED_MODULE_0__.openSync, "\nFile System access not available");
        this.privLogPath = path;
    }
    set enableConsoleOutput(enableOutput) {
        this.privEnableConsoleOutput = enableOutput;
    }
    onEvent(event) {
        if (event.eventType >= this.privLogLevelFilter) {
            const log = this.toString(event);
            if (!!this.privLogPath) {
                fs__WEBPACK_IMPORTED_MODULE_0__.writeFileSync(this.privLogPath, log + "\n", { flag: "a+" });
            }
            if (this.privEnableConsoleOutput) {
                switch (event.eventType) {
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Debug:
                        // eslint-disable-next-line no-console
                        console.debug(log);
                        break;
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Info:
                        // eslint-disable-next-line no-console
                        console.info(log);
                        break;
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Warning:
                        // eslint-disable-next-line no-console
                        console.warn(log);
                        break;
                    case _sdk_LogLevel__WEBPACK_IMPORTED_MODULE_1__.EventType.Error:
                        // eslint-disable-next-line no-console
                        console.error(log);
                        break;
                    default:
                        // eslint-disable-next-line no-console
                        console.log(log);
                        break;
                }
            }
        }
    }
    toString(event) {
        const logFragments = [
            `${event.eventTime}`,
            `${event.name}`,
        ];
        const e = event;
        for (const prop in e) {
            if (prop && event.hasOwnProperty(prop) &&
                prop !== "eventTime" && prop !== "eventType" &&
                prop !== "eventId" && prop !== "name" &&
                prop !== "constructor") {
                // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
                const value = e[prop];
                let valueToLog = "<NULL>";
                if (value !== undefined && value !== null) {
                    if (typeof (value) === "number" || typeof (value) === "string") {
                        valueToLog = value.toString();
                    }
                    else {
                        valueToLog = JSON.stringify(value);
                    }
                }
                logFragments.push(`${prop}: ${valueToLog}`);
            }
        }
        return logFragments.join(" | ");
    }
}

//# sourceMappingURL=ConsoleLoggingListener.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/FileAudioSource.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/FileAudioSource.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FileAudioSource": () => (/* binding */ FileAudioSource)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Audio/AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class FileAudioSource {
    constructor(file, filename, audioSourceId) {
        this.privStreams = {};
        this.privHeaderEnd = 44;
        this.privId = audioSourceId ? audioSourceId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privSource = file;
        if (typeof window !== "undefined" && typeof Blob !== "undefined" && this.privSource instanceof Blob) {
            this.privFilename = file.name;
        }
        else {
            this.privFilename = filename || "unknown.wav";
        }
        // Read the header.
        this.privAudioFormatPromise = this.readHeader();
    }
    get format() {
        return this.privAudioFormatPromise;
    }
    turnOn() {
        if (this.privFilename.lastIndexOf(".wav") !== this.privFilename.length - 4) {
            const errorMsg = this.privFilename + " is not supported. Only WAVE files are allowed at the moment.";
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceErrorEvent(errorMsg, ""));
            return Promise.reject(errorMsg);
        }
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceInitializingEvent(this.privId)); // no stream id
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceReadyEvent(this.privId));
        return;
    }
    id() {
        return this.privId;
    }
    attach(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
            const stream = yield this.upload(audioNodeId);
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return Promise.resolve({
                detach: () => __awaiter(this, void 0, void 0, function* () {
                    stream.readEnded();
                    delete this.privStreams[audioNodeId];
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    yield this.turnOff();
                }),
                id: () => audioNodeId,
                read: () => stream.read(),
            });
        });
    }
    detach(audioNodeId) {
        if (audioNodeId && this.privStreams[audioNodeId]) {
            this.privStreams[audioNodeId].close();
            delete this.privStreams[audioNodeId];
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
        }
    }
    turnOff() {
        for (const streamId in this.privStreams) {
            if (streamId) {
                const stream = this.privStreams[streamId];
                if (stream && !stream.isClosed) {
                    stream.close();
                }
            }
        }
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioSourceOffEvent(this.privId)); // no stream now
        return Promise.resolve();
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return this.privAudioFormatPromise.then((result) => (Promise.resolve({
            bitspersample: result.bitsPerSample,
            channelcount: result.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: "File",
            samplerate: result.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.type.File,
        })));
    }
    readHeader() {
        // Read the wave header.
        const maxHeaderSize = 4296;
        const header = this.privSource.slice(0, maxHeaderSize);
        const headerResult = new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Deferred();
        const processHeader = (header) => {
            const view = new DataView(header);
            const getWord = (index) => String.fromCharCode(view.getUint8(index), view.getUint8(index + 1), view.getUint8(index + 2), view.getUint8(index + 3));
            // RIFF 4 bytes.
            if ("RIFF" !== getWord(0)) {
                headerResult.reject("Invalid WAV header in file, RIFF was not found");
                return;
            }
            // length, 4 bytes
            // RIFF Type & fmt 8 bytes
            if ("WAVE" !== getWord(8) || "fmt " !== getWord(12)) {
                headerResult.reject("Invalid WAV header in file, WAVEfmt was not found");
                return;
            }
            const formatSize = view.getInt32(16, true);
            const channelCount = view.getUint16(22, true);
            const sampleRate = view.getUint32(24, true);
            const bitsPerSample = view.getUint16(34, true);
            // Confirm if header is 44 bytes long.
            let pos = 36 + Math.max(formatSize - 16, 0);
            for (; getWord(pos) !== "data"; pos += 2) {
                if (pos > maxHeaderSize - 8) {
                    headerResult.reject("Invalid WAV header in file, data block was not found");
                    return;
                }
            }
            this.privHeaderEnd = pos + 8;
            headerResult.resolve(_sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_5__.AudioStreamFormat.getWaveFormatPCM(sampleRate, bitsPerSample, channelCount));
        };
        if (typeof window !== "undefined" && typeof Blob !== "undefined" && header instanceof Blob) {
            const reader = new FileReader();
            reader.onload = (event) => {
                const header = event.target.result;
                processHeader(header);
            };
            reader.readAsArrayBuffer(header);
        }
        else {
            const h = header;
            processHeader(h.buffer.slice(h.byteOffset, h.byteOffset + h.byteLength));
        }
        return headerResult.promise;
    }
    upload(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            const onerror = (error) => {
                const errorMsg = `Error occurred while processing '${this.privFilename}'. ${error}`;
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.AudioStreamNodeErrorEvent(this.privId, audioNodeId, errorMsg));
                throw new Error(errorMsg);
            };
            try {
                yield this.turnOn();
                const format = yield this.privAudioFormatPromise;
                const stream = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.ChunkedArrayBufferStream(format.avgBytesPerSec / 10, audioNodeId);
                this.privStreams[audioNodeId] = stream;
                const chunk = this.privSource.slice(this.privHeaderEnd);
                const processFile = (buff) => {
                    if (stream.isClosed) {
                        return; // output stream was closed (somebody called TurnOff). We're done here.
                    }
                    stream.writeStreamChunk({
                        buffer: buff,
                        isEnd: false,
                        timeReceived: Date.now(),
                    });
                    stream.close();
                };
                if (typeof window !== "undefined" && typeof Blob !== "undefined" && chunk instanceof Blob) {
                    const reader = new FileReader();
                    reader.onerror = (ev) => onerror(ev.toString());
                    reader.onload = (event) => {
                        const fileBuffer = event.target.result;
                        processFile(fileBuffer);
                    };
                    reader.readAsArrayBuffer(chunk);
                }
                else {
                    const c = chunk;
                    processFile(c.buffer.slice(c.byteOffset, c.byteOffset + c.byteLength));
                }
                return stream;
            }
            catch (e) {
                onerror(e);
            }
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_7__.Events.instance.onEvent(event);
    }
}

//# sourceMappingURL=FileAudioSource.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/MicAudioSource.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/MicAudioSource.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioWorkletSourceURLPropertyName": () => (/* binding */ AudioWorkletSourceURLPropertyName),
/* harmony export */   "MicAudioSource": () => (/* binding */ MicAudioSource)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Audio/AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



const AudioWorkletSourceURLPropertyName = "MICROPHONE-WorkletSourceUrl";
class MicAudioSource {
    constructor(privRecorder, deviceId, audioSourceId, mediaStream) {
        this.privRecorder = privRecorder;
        this.deviceId = deviceId;
        this.privStreams = {};
        this.privOutputChunkSize = MicAudioSource.AUDIOFORMAT.avgBytesPerSec / 10;
        this.privId = audioSourceId ? audioSourceId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privMediaStream = mediaStream || null;
        this.privIsClosing = false;
    }
    get format() {
        return Promise.resolve(MicAudioSource.AUDIOFORMAT);
    }
    turnOn() {
        if (this.privInitializeDeferral) {
            return this.privInitializeDeferral.promise;
        }
        this.privInitializeDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
        try {
            this.createAudioContext();
        }
        catch (error) {
            if (error instanceof Error) {
                const typedError = error;
                this.privInitializeDeferral.reject(typedError.name + ": " + typedError.message);
            }
            else {
                this.privInitializeDeferral.reject(error);
            }
            return this.privInitializeDeferral.promise;
        }
        const nav = window.navigator;
        let getUserMedia = (
        // eslint-disable-next-line
        nav.getUserMedia ||
            nav.webkitGetUserMedia ||
            nav.mozGetUserMedia ||
            nav.msGetUserMedia);
        if (!!nav.mediaDevices) {
            getUserMedia = (constraints, successCallback, errorCallback) => {
                nav.mediaDevices
                    .getUserMedia(constraints)
                    .then(successCallback)
                    .catch(errorCallback);
            };
        }
        if (!getUserMedia) {
            const errorMsg = "Browser does not support getUserMedia.";
            this.privInitializeDeferral.reject(errorMsg);
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceErrorEvent(errorMsg, "")); // mic initialized error - no streamid at this point
        }
        else {
            const next = () => {
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceInitializingEvent(this.privId)); // no stream id
                if (this.privMediaStream && this.privMediaStream.active) {
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceReadyEvent(this.privId));
                    this.privInitializeDeferral.resolve();
                }
                else {
                    getUserMedia({ audio: this.deviceId ? { deviceId: this.deviceId } : true, video: false }, (mediaStream) => {
                        this.privMediaStream = mediaStream;
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceReadyEvent(this.privId));
                        this.privInitializeDeferral.resolve();
                    }, (error) => {
                        const errorMsg = `Error occurred during microphone initialization: ${error}`;
                        this.privInitializeDeferral.reject(errorMsg);
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceErrorEvent(this.privId, errorMsg));
                    });
                }
            };
            if (this.privContext.state === "suspended") {
                // NOTE: On iOS, the Web Audio API requires sounds to be triggered from an explicit user action.
                // https://github.com/WebAudio/web-audio-api/issues/790
                this.privContext.resume()
                    .then(next)
                    .catch((reason) => {
                    this.privInitializeDeferral.reject(`Failed to initialize audio context: ${reason}`);
                });
            }
            else {
                next();
            }
        }
        return this.privInitializeDeferral.promise;
    }
    id() {
        return this.privId;
    }
    attach(audioNodeId) {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
        return this.listen(audioNodeId).then((stream) => {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return {
                detach: () => __awaiter(this, void 0, void 0, function* () {
                    stream.readEnded();
                    delete this.privStreams[audioNodeId];
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    return this.turnOff();
                }),
                id: () => audioNodeId,
                read: () => stream.read(),
            };
        });
    }
    detach(audioNodeId) {
        if (audioNodeId && this.privStreams[audioNodeId]) {
            this.privStreams[audioNodeId].close();
            delete this.privStreams[audioNodeId];
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
        }
    }
    turnOff() {
        return __awaiter(this, void 0, void 0, function* () {
            for (const streamId in this.privStreams) {
                if (streamId) {
                    const stream = this.privStreams[streamId];
                    if (stream) {
                        stream.close();
                    }
                }
            }
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioSourceOffEvent(this.privId)); // no stream now
            if (this.privInitializeDeferral) {
                // Correctly handle when browser forces mic off before turnOn() completes
                // eslint-disable-next-line @typescript-eslint/await-thenable
                yield this.privInitializeDeferral;
                this.privInitializeDeferral = null;
            }
            yield this.destroyAudioContext();
            return;
        });
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return this.getMicrophoneLabel().then((label) => ({
            bitspersample: MicAudioSource.AUDIOFORMAT.bitsPerSample,
            channelcount: MicAudioSource.AUDIOFORMAT.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: label,
            samplerate: MicAudioSource.AUDIOFORMAT.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.type.Microphones,
        }));
    }
    setProperty(name, value) {
        if (name === AudioWorkletSourceURLPropertyName) {
            this.privRecorder.setWorkletUrl(value);
        }
        else {
            throw new Error("Property '" + name + "' is not supported on Microphone.");
        }
    }
    getMicrophoneLabel() {
        const defaultMicrophoneName = "microphone";
        // If we did this already, return the value.
        if (this.privMicrophoneLabel !== undefined) {
            return Promise.resolve(this.privMicrophoneLabel);
        }
        // If the stream isn't currently running, we can't query devices because security.
        if (this.privMediaStream === undefined || !this.privMediaStream.active) {
            return Promise.resolve(defaultMicrophoneName);
        }
        // Setup a default
        this.privMicrophoneLabel = defaultMicrophoneName;
        // Get the id of the device running the audio track.
        const microphoneDeviceId = this.privMediaStream.getTracks()[0].getSettings().deviceId;
        // If the browser doesn't support getting the device ID, set a default and return.
        if (undefined === microphoneDeviceId) {
            return Promise.resolve(this.privMicrophoneLabel);
        }
        const deferred = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
        // Enumerate the media devices.
        navigator.mediaDevices.enumerateDevices().then((devices) => {
            for (const device of devices) {
                if (device.deviceId === microphoneDeviceId) {
                    // Found the device
                    this.privMicrophoneLabel = device.label;
                    break;
                }
            }
            deferred.resolve(this.privMicrophoneLabel);
        }, () => deferred.resolve(this.privMicrophoneLabel));
        return deferred.promise;
    }
    listen(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.turnOn();
            const stream = new _common_Exports__WEBPACK_IMPORTED_MODULE_5__.ChunkedArrayBufferStream(this.privOutputChunkSize, audioNodeId);
            this.privStreams[audioNodeId] = stream;
            try {
                this.privRecorder.record(this.privContext, this.privMediaStream, stream);
            }
            catch (error) {
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioStreamNodeErrorEvent(this.privId, audioNodeId, error));
                throw error;
            }
            const result = stream;
            return result;
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Events.instance.onEvent(event);
    }
    createAudioContext() {
        if (!!this.privContext) {
            return;
        }
        this.privContext = _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_7__.AudioStreamFormatImpl.getAudioContext(MicAudioSource.AUDIOFORMAT.samplesPerSec);
    }
    destroyAudioContext() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privContext) {
                return;
            }
            this.privRecorder.releaseMediaResources(this.privContext);
            // This pattern brought to you by a bug in the TypeScript compiler where it
            // confuses the ("close" in this.privContext) with this.privContext always being null as the alternate.
            // https://github.com/Microsoft/TypeScript/issues/11498
            let hasClose = false;
            if ("close" in this.privContext) {
                hasClose = true;
            }
            if (hasClose) {
                if (!this.privIsClosing) {
                    // The audio context close may take enough time that the close is called twice
                    this.privIsClosing = true;
                    yield this.privContext.close();
                    this.privContext = null;
                    this.privIsClosing = false;
                }
            }
            else if (null !== this.privContext && this.privContext.state === "running") {
                // Suspend actually takes a callback, but analogous to the
                // resume method, it'll be only fired if suspend is called
                // in a direct response to a user action. The later is not always
                // the case, as TurnOff is also called, when we receive an
                // end-of-speech message from the service. So, doing a best effort
                // fire-and-forget here.
                yield this.privContext.suspend();
            }
        });
    }
}
MicAudioSource.AUDIOFORMAT = _sdk_Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_7__.AudioStreamFormat.getDefaultInputFormat();

//# sourceMappingURL=MicAudioSource.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/PCMRecorder.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/PCMRecorder.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PcmRecorder": () => (/* binding */ PcmRecorder)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RiffPcmEncoder.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class PcmRecorder {
    constructor(stopInputOnRelease) {
        this.privStopInputOnRelease = stopInputOnRelease;
    }
    record(context, mediaStream, outputStream) {
        const desiredSampleRate = 16000;
        const waveStreamEncoder = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.RiffPcmEncoder(context.sampleRate, desiredSampleRate);
        const micInput = context.createMediaStreamSource(mediaStream);
        const attachScriptProcessor = () => {
            // eslint-disable-next-line @typescript-eslint/explicit-function-return-type
            const scriptNode = (() => {
                let bufferSize = 0;
                try {
                    return context.createScriptProcessor(bufferSize, 1, 1);
                }
                catch (error) {
                    // Webkit (<= version 31) requires a valid bufferSize.
                    bufferSize = 2048;
                    let audioSampleRate = context.sampleRate;
                    while (bufferSize < 16384 && audioSampleRate >= (2 * desiredSampleRate)) {
                        bufferSize <<= 1;
                        audioSampleRate >>= 1;
                    }
                    return context.createScriptProcessor(bufferSize, 1, 1);
                }
            })();
            scriptNode.onaudioprocess = (event) => {
                const inputFrame = event.inputBuffer.getChannelData(0);
                if (outputStream && !outputStream.isClosed) {
                    const waveFrame = waveStreamEncoder.encode(inputFrame);
                    if (!!waveFrame) {
                        outputStream.writeStreamChunk({
                            buffer: waveFrame,
                            isEnd: false,
                            timeReceived: Date.now(),
                        });
                    }
                }
            };
            micInput.connect(scriptNode);
            scriptNode.connect(context.destination);
            this.privMediaResources = {
                scriptProcessorNode: scriptNode,
                source: micInput,
                stream: mediaStream,
            };
        };
        // https://webaudio.github.io/web-audio-api/#audioworklet
        // Using AudioWorklet to improve audio quality and avoid audio glitches due to blocking the UI thread
        if (!!context.audioWorklet) {
            if (!this.privSpeechProcessorScript) {
                const workletScript = `class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`;
                const blob = new Blob([workletScript], { type: "application/javascript; charset=utf-8" });
                this.privSpeechProcessorScript = URL.createObjectURL(blob);
            }
            context.audioWorklet
                .addModule(this.privSpeechProcessorScript)
                .then(() => {
                const workletNode = new AudioWorkletNode(context, "speech-processor");
                workletNode.port.onmessage = (ev) => {
                    const inputFrame = ev.data;
                    if (outputStream && !outputStream.isClosed) {
                        const waveFrame = waveStreamEncoder.encode(inputFrame);
                        if (!!waveFrame) {
                            outputStream.writeStreamChunk({
                                buffer: waveFrame,
                                isEnd: false,
                                timeReceived: Date.now(),
                            });
                        }
                    }
                };
                micInput.connect(workletNode);
                workletNode.connect(context.destination);
                this.privMediaResources = {
                    scriptProcessorNode: workletNode,
                    source: micInput,
                    stream: mediaStream,
                };
            })
                .catch(() => {
                attachScriptProcessor();
            });
        }
        else {
            try {
                attachScriptProcessor();
            }
            catch (err) {
                throw new Error(`Unable to start audio worklet node for PCMRecorder: ${err}`);
            }
        }
    }
    releaseMediaResources(context) {
        if (this.privMediaResources) {
            if (this.privMediaResources.scriptProcessorNode) {
                this.privMediaResources.scriptProcessorNode.disconnect(context.destination);
                this.privMediaResources.scriptProcessorNode = null;
            }
            if (this.privMediaResources.source) {
                this.privMediaResources.source.disconnect();
                if (this.privStopInputOnRelease) {
                    this.privMediaResources.stream.getTracks().forEach((track) => track.stop());
                }
                this.privMediaResources.source = null;
            }
        }
    }
    setWorkletUrl(url) {
        this.privSpeechProcessorScript = url;
    }
}

//# sourceMappingURL=PCMRecorder.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ProxyInfo": () => (/* binding */ ProxyInfo)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ProxyInfo {
    constructor(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.privProxyHostName = proxyHostName;
        this.privProxyPort = proxyPort;
        this.privProxyUserName = proxyUserName;
        this.privProxyPassword = proxyPassword;
    }
    static fromParameters(parameters) {
        return new ProxyInfo(parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyHostName), parseInt(parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyPort), 10), parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyUserName), parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_ProxyPassword));
    }
    static fromRecognizerConfig(config) {
        return this.fromParameters(config.parameters);
    }
    get HostName() {
        return this.privProxyHostName;
    }
    get Port() {
        return this.privProxyPort;
    }
    get UserName() {
        return this.privProxyUserName;
    }
    get Password() {
        return this.privProxyPassword;
    }
}

//# sourceMappingURL=ProxyInfo.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ReplayableAudioNode": () => (/* binding */ ReplayableAudioNode)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class ReplayableAudioNode {
    constructor(audioSource, bytesPerSecond) {
        this.privBuffers = [];
        this.privReplayOffset = 0;
        this.privLastShrinkOffset = 0;
        this.privBufferStartOffset = 0;
        this.privBufferSerial = 0;
        this.privBufferedBytes = 0;
        this.privReplay = false;
        this.privLastChunkAcquiredTime = 0;
        this.privAudioNode = audioSource;
        this.privBytesPerSecond = bytesPerSecond;
    }
    id() {
        return this.privAudioNode.id();
    }
    // Reads and returns the next chunk of audio buffer.
    // If replay of existing buffers are needed, read() will first seek and replay
    // existing content, and upoin completion it will read new content from the underlying
    // audio node, saving that content into the replayable buffers.
    read() {
        // if there is a replay request to honor.
        if (!!this.privReplay && this.privBuffers.length !== 0) {
            // Find the start point in the buffers.
            // Offsets are in 100ns increments.
            // So how many bytes do we need to seek to get the right offset?
            const offsetToSeek = this.privReplayOffset - this.privBufferStartOffset;
            let bytesToSeek = Math.round(offsetToSeek * this.privBytesPerSecond * 1e-7);
            if (0 !== (bytesToSeek % 2)) {
                bytesToSeek++;
            }
            let i = 0;
            while (i < this.privBuffers.length && bytesToSeek >= this.privBuffers[i].chunk.buffer.byteLength) {
                bytesToSeek -= this.privBuffers[i++].chunk.buffer.byteLength;
            }
            if (i < this.privBuffers.length) {
                const retVal = this.privBuffers[i].chunk.buffer.slice(bytesToSeek);
                this.privReplayOffset += (retVal.byteLength / this.privBytesPerSecond) * 1e+7;
                // If we've reached the end of the buffers, stop replaying.
                if (i === this.privBuffers.length - 1) {
                    this.privReplay = false;
                }
                return Promise.resolve({
                    buffer: retVal,
                    isEnd: false,
                    timeReceived: this.privBuffers[i].chunk.timeReceived,
                });
            }
        }
        return this.privAudioNode.read()
            .then((result) => {
            if (result && result.buffer) {
                this.privBuffers.push(new BufferEntry(result, this.privBufferSerial++, this.privBufferedBytes));
                this.privBufferedBytes += result.buffer.byteLength;
            }
            return result;
        });
    }
    detach() {
        this.privBuffers = undefined;
        return this.privAudioNode.detach();
    }
    replay() {
        if (this.privBuffers && 0 !== this.privBuffers.length) {
            this.privReplay = true;
            this.privReplayOffset = this.privLastShrinkOffset;
        }
    }
    // Shrinks the existing audio buffers to start at the new offset, or at the
    // beginning of the buffer closest to the requested offset.
    // A replay request will start from the last shrink point.
    shrinkBuffers(offset) {
        if (this.privBuffers === undefined || this.privBuffers.length === 0) {
            return;
        }
        this.privLastShrinkOffset = offset;
        // Find the start point in the buffers.
        // Offsets are in 100ns increments.
        // So how many bytes do we need to seek to get the right offset?
        const offsetToSeek = offset - this.privBufferStartOffset;
        let bytesToSeek = Math.round(offsetToSeek * this.privBytesPerSecond * 1e-7);
        let i = 0;
        while (i < this.privBuffers.length && bytesToSeek >= this.privBuffers[i].chunk.buffer.byteLength) {
            bytesToSeek -= this.privBuffers[i++].chunk.buffer.byteLength;
        }
        this.privBufferStartOffset = Math.round(offset - ((bytesToSeek / this.privBytesPerSecond) * 1e+7));
        this.privBuffers = this.privBuffers.slice(i);
    }
    // Finds the time a buffer of audio was first seen by offset.
    findTimeAtOffset(offset) {
        if (offset < this.privBufferStartOffset || this.privBuffers === undefined) {
            return 0;
        }
        for (const value of this.privBuffers) {
            const startOffset = (value.byteOffset / this.privBytesPerSecond) * 1e7;
            const endOffset = startOffset + ((value.chunk.buffer.byteLength / this.privBytesPerSecond) * 1e7);
            if (offset >= startOffset && offset <= endOffset) {
                return value.chunk.timeReceived;
            }
        }
        return 0;
    }
}
// Primary use of this class is to help debugging problems with the replay
// code. If the memory cost of alloc / dealloc gets too much, drop it and just use
// the ArrayBuffer directly.
class BufferEntry {
    constructor(chunk, serial, byteOffset) {
        this.chunk = chunk;
        this.serial = serial;
        this.byteOffset = byteOffset;
    }
}

//# sourceMappingURL=ReplayableAudioNode.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RestConfigBase": () => (/* binding */ RestConfigBase)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class RestConfigBase {
    static get requestOptions() {
        return RestConfigBase.privDefaultRequestOptions;
    }
    static get configParams() {
        return RestConfigBase.privDefaultParams;
    }
    static get restErrors() {
        return RestConfigBase.privRestErrors;
    }
}
RestConfigBase.privDefaultRequestOptions = {
    headers: {
        Accept: "application/json",
    },
    ignoreCache: false,
    timeout: 10000,
};
RestConfigBase.privRestErrors = {
    authInvalidSubscriptionKey: "You must specify either an authentication token to use, or a Cognitive Speech subscription key.",
    authInvalidSubscriptionRegion: "You must specify the Cognitive Speech region to use.",
    invalidArgs: "Required input not found: {arg}.",
    invalidCreateJoinConversationResponse: "Creating/Joining conversation failed with HTTP {status}.",
    invalidParticipantRequest: "The requested participant was not found.",
    permissionDeniedConnect: "Required credentials not found.",
    permissionDeniedConversation: "Invalid operation: only the host can {command} the conversation.",
    permissionDeniedParticipant: "Invalid operation: only the host can {command} a participant.",
    permissionDeniedSend: "Invalid operation: the conversation is not in a connected state.",
    permissionDeniedStart: "Invalid operation: there is already an active conversation.",
};
RestConfigBase.privDefaultParams = {
    apiVersion: "api-version",
    authorization: "Authorization",
    clientAppId: "X-ClientAppId",
    contentTypeKey: "Content-Type",
    correlationId: "X-CorrelationId",
    languageCode: "language",
    nickname: "nickname",
    profanity: "profanity",
    requestId: "X-RequestId",
    roomId: "roomid",
    sessionToken: "token",
    subscriptionKey: "Ocp-Apim-Subscription-Key",
    subscriptionRegion: "Ocp-Apim-Subscription-Region",
    token: "X-CapitoToken",
};

//# sourceMappingURL=RestConfigBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RestMessageAdapter": () => (/* binding */ RestMessageAdapter),
/* harmony export */   "RestRequestType": () => (/* binding */ RestRequestType)
/* harmony export */ });
/* harmony import */ var bent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bent */ "./node_modules/bent/src/browser.js");
/* harmony import */ var bent__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bent__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


var RestRequestType;
(function (RestRequestType) {
    RestRequestType["Get"] = "GET";
    RestRequestType["Post"] = "POST";
    RestRequestType["Delete"] = "DELETE";
    RestRequestType["File"] = "file";
})(RestRequestType || (RestRequestType = {}));
// accept rest operations via request method and return abstracted objects from server response
class RestMessageAdapter {
    constructor(configParams) {
        if (!configParams) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ArgumentNullError("configParams");
        }
        this.privHeaders = configParams.headers;
        this.privIgnoreCache = configParams.ignoreCache;
    }
    static extractHeaderValue(headerKey, headers) {
        let headerValue = "";
        try {
            const arr = headers.trim().split(/[\r\n]+/);
            const headerMap = {};
            arr.forEach((line) => {
                const parts = line.split(": ");
                const header = parts.shift().toLowerCase();
                const value = parts.join(": ");
                headerMap[header] = value;
            });
            headerValue = headerMap[headerKey.toLowerCase()];
        }
        catch (e) {
            // ignore the error
        }
        return headerValue;
    }
    set options(configParams) {
        this.privHeaders = configParams.headers;
        this.privIgnoreCache = configParams.ignoreCache;
    }
    setHeaders(key, value) {
        this.privHeaders[key] = value;
    }
    request(method, uri, queryParams = {}, body = null) {
        const responseReceivedDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
        const requestCommand = method === RestRequestType.File ? "POST" : method;
        const handleRestResponse = (data, j = {}) => {
            const d = data;
            return {
                data: JSON.stringify(j),
                headers: JSON.stringify(data.headers),
                json: j,
                ok: data.statusCode >= 200 && data.statusCode < 300,
                status: data.statusCode,
                statusText: j.error ? j.error.message : d.statusText ? d.statusText : d.statusMessage
            };
        };
        const send = (postData) => {
            const sendRequest = bent__WEBPACK_IMPORTED_MODULE_0___default()(uri, requestCommand, this.privHeaders, 200, 201, 202, 204, 400, 401, 402, 403, 404);
            const params = this.queryParams(queryParams) === "" ? "" : `?${this.queryParams(queryParams)}`;
            sendRequest(params, postData).then((data) => __awaiter(this, void 0, void 0, function* () {
                if (method === RestRequestType.Delete || data.statusCode === 204) {
                    // No JSON from Delete and reset (204) operations
                    responseReceivedDeferral.resolve(handleRestResponse(data));
                }
                else {
                    try {
                        const j = yield data.json();
                        responseReceivedDeferral.resolve(handleRestResponse(data, j));
                    }
                    catch (_a) {
                        responseReceivedDeferral.resolve(handleRestResponse(data));
                    }
                }
            })).catch((error) => {
                responseReceivedDeferral.reject(error);
            });
        };
        if (this.privIgnoreCache) {
            this.privHeaders["Cache-Control"] = "no-cache";
        }
        if (method === RestRequestType.Post && body) {
            this.privHeaders["content-type"] = "application/json";
            this.privHeaders["Content-Type"] = "application/json";
        }
        send(body);
        return responseReceivedDeferral.promise;
    }
    queryParams(params = {}) {
        return Object.keys(params)
            .map((k) => encodeURIComponent(k) + "=" + encodeURIComponent(params[k]))
            .join("&");
    }
}

//# sourceMappingURL=RestMessageAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebsocketConnection": () => (/* binding */ WebsocketConnection)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _WebsocketMessageAdapter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WebsocketMessageAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketMessageAdapter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class WebsocketConnection {
    constructor(uri, queryParameters, headers, messageFormatter, proxyInfo, enableCompression = false, connectionId) {
        this.privIsDisposed = false;
        if (!uri) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("uri");
        }
        if (!messageFormatter) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("messageFormatter");
        }
        this.privMessageFormatter = messageFormatter;
        let queryParams = "";
        let i = 0;
        if (queryParameters) {
            for (const paramName in queryParameters) {
                if (paramName) {
                    queryParams += ((i === 0) && (uri.indexOf("?") === -1)) ? "?" : "&";
                    const key = encodeURIComponent(paramName);
                    queryParams += key;
                    let val = queryParameters[paramName];
                    if (val) {
                        val = encodeURIComponent(val);
                        queryParams += `=${val}`;
                    }
                    i++;
                }
            }
        }
        if (headers) {
            for (const headerName in headers) {
                if (headerName) {
                    queryParams += ((i === 0) && (uri.indexOf("?") === -1)) ? "?" : "&";
                    const val = encodeURIComponent(headers[headerName]);
                    queryParams += `${headerName}=${val}`;
                    i++;
                }
            }
        }
        this.privUri = uri + queryParams;
        this.privId = connectionId ? connectionId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        this.privConnectionMessageAdapter = new _WebsocketMessageAdapter__WEBPACK_IMPORTED_MODULE_2__.WebsocketMessageAdapter(this.privUri, this.id, this.privMessageFormatter, proxyInfo, headers, enableCompression);
    }
    dispose() {
        return __awaiter(this, void 0, void 0, function* () {
            this.privIsDisposed = true;
            if (this.privConnectionMessageAdapter) {
                yield this.privConnectionMessageAdapter.close();
            }
        });
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    get id() {
        return this.privId;
    }
    get uri() {
        return this.privUri;
    }
    state() {
        return this.privConnectionMessageAdapter.state;
    }
    open() {
        return this.privConnectionMessageAdapter.open();
    }
    send(message) {
        return this.privConnectionMessageAdapter.send(message);
    }
    read() {
        return this.privConnectionMessageAdapter.read();
    }
    get events() {
        return this.privConnectionMessageAdapter.events;
    }
}

//# sourceMappingURL=WebsocketConnection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketMessageAdapter.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketMessageAdapter.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebsocketMessageAdapter": () => (/* binding */ WebsocketMessageAdapter)
/* harmony export */ });
/* harmony import */ var net__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! net */ "?a1bf");
/* harmony import */ var net__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(net__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var tls__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tls */ "?14d6");
/* harmony import */ var tls__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(tls__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var agent_base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! agent-base */ "?6483");
/* harmony import */ var agent_base__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(agent_base__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var https_proxy_agent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! https-proxy-agent */ "?72ad");
/* harmony import */ var https_proxy_agent__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(https_proxy_agent__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ws */ "?e42a");
/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ws__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionOpenResponse.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







class WebsocketMessageAdapter {
    constructor(uri, connectionId, messageFormatter, proxyInfo, headers, enableCompression) {
        if (!uri) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_5__.ArgumentNullError("uri");
        }
        if (!messageFormatter) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_5__.ArgumentNullError("messageFormatter");
        }
        this.proxyInfo = proxyInfo;
        this.privConnectionEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.EventSource();
        this.privConnectionId = connectionId;
        this.privMessageFormatter = messageFormatter;
        this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.None;
        this.privUri = uri;
        this.privHeaders = headers;
        this.privEnableCompression = enableCompression;
        // Add the connection ID to the headers
        this.privHeaders[_common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_8__.HeaderNames.ConnectionId] = this.privConnectionId;
        this.privLastErrorReceived = "";
    }
    get state() {
        return this.privConnectionState;
    }
    open() {
        if (this.privConnectionState === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected) {
            return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);
        }
        if (this.privConnectionEstablishDeferral) {
            return this.privConnectionEstablishDeferral.promise;
        }
        this.privConnectionEstablishDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        this.privCertificateValidatedDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connecting;
        try {
            if (typeof WebSocket !== "undefined" && !WebsocketMessageAdapter.forceNpmWebSocket) {
                // Browser handles cert checks.
                this.privCertificateValidatedDeferral.resolve();
                this.privWebsocketClient = new WebSocket(this.privUri);
            }
            else {
                const options = { headers: this.privHeaders, perMessageDeflate: this.privEnableCompression };
                // The ocsp library will handle validation for us and fail the connection if needed.
                this.privCertificateValidatedDeferral.resolve();
                options.agent = this.getAgent();
                // Workaround for https://github.com/microsoft/cognitive-services-speech-sdk-js/issues/465
                // Which is root caused by https://github.com/TooTallNate/node-agent-base/issues/61
                const uri = new URL(this.privUri);
                let protocol = uri.protocol;
                if ((protocol === null || protocol === void 0 ? void 0 : protocol.toLocaleLowerCase()) === "wss:") {
                    protocol = "https:";
                }
                else if ((protocol === null || protocol === void 0 ? void 0 : protocol.toLocaleLowerCase()) === "ws:") {
                    protocol = "http:";
                }
                // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
                options.agent.protocol = protocol;
                this.privWebsocketClient = new (ws__WEBPACK_IMPORTED_MODULE_4___default())(this.privUri, options);
            }
            this.privWebsocketClient.binaryType = "arraybuffer";
            this.privReceivingMessageQueue = new _common_Exports__WEBPACK_IMPORTED_MODULE_10__.Queue();
            this.privDisconnectDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
            this.privSendMessageQueue = new _common_Exports__WEBPACK_IMPORTED_MODULE_10__.Queue();
            this.processSendQueue().catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_12__.BackgroundEvent(reason));
            });
        }
        catch (error) {
            this.privConnectionEstablishDeferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_13__.ConnectionOpenResponse(500, error));
            return this.privConnectionEstablishDeferral.promise;
        }
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionStartEvent(this.privConnectionId, this.privUri));
        this.privWebsocketClient.onopen = () => {
            this.privCertificateValidatedDeferral.promise.then(() => {
                this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected;
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionEstablishedEvent(this.privConnectionId));
                this.privConnectionEstablishDeferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_13__.ConnectionOpenResponse(200, ""));
            }, (error) => {
                this.privConnectionEstablishDeferral.reject(error);
            });
        };
        this.privWebsocketClient.onerror = (e) => {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionErrorEvent(this.privConnectionId, e.message, e.type));
            this.privLastErrorReceived = e.message;
        };
        this.privWebsocketClient.onclose = (e) => {
            if (this.privConnectionState === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connecting) {
                this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected;
                // this.onEvent(new ConnectionEstablishErrorEvent(this.connectionId, e.code, e.reason));
                this.privConnectionEstablishDeferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_13__.ConnectionOpenResponse(e.code, e.reason + " " + this.privLastErrorReceived));
            }
            else {
                this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected;
                this.privWebsocketClient = null;
                this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionClosedEvent(this.privConnectionId, e.code, e.reason));
            }
            this.onClose(e.code, e.reason).catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_12__.BackgroundEvent(reason));
            });
        };
        this.privWebsocketClient.onmessage = (e) => {
            const networkReceivedTime = new Date().toISOString();
            if (this.privConnectionState === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected) {
                const deferred = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
                // let id = ++this.idCounter;
                this.privReceivingMessageQueue.enqueueFromPromise(deferred.promise);
                if (e.data instanceof ArrayBuffer) {
                    const rawMessage = new _common_Exports__WEBPACK_IMPORTED_MODULE_15__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_16__.MessageType.Binary, e.data);
                    this.privMessageFormatter
                        .toConnectionMessage(rawMessage)
                        .then((connectionMessage) => {
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionMessageReceivedEvent(this.privConnectionId, networkReceivedTime, connectionMessage));
                        deferred.resolve(connectionMessage);
                    }, (error) => {
                        // TODO: Events for these ?
                        deferred.reject(`Invalid binary message format. Error: ${error}`);
                    });
                }
                else {
                    const rawMessage = new _common_Exports__WEBPACK_IMPORTED_MODULE_15__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_16__.MessageType.Text, e.data);
                    this.privMessageFormatter
                        .toConnectionMessage(rawMessage)
                        .then((connectionMessage) => {
                        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionMessageReceivedEvent(this.privConnectionId, networkReceivedTime, connectionMessage));
                        deferred.resolve(connectionMessage);
                    }, (error) => {
                        // TODO: Events for these ?
                        deferred.reject(`Invalid text message format. Error: ${error}`);
                    });
                }
            }
        };
        return this.privConnectionEstablishDeferral.promise;
    }
    send(message) {
        if (this.privConnectionState !== _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected) {
            return Promise.reject(`Cannot send on connection that is in ${_common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState[this.privConnectionState]} state`);
        }
        const messageSendStatusDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        const messageSendDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_9__.Deferred();
        this.privSendMessageQueue.enqueueFromPromise(messageSendDeferral.promise);
        this.privMessageFormatter
            .fromConnectionMessage(message)
            .then((rawMessage) => {
            messageSendDeferral.resolve({
                Message: message,
                RawWebsocketMessage: rawMessage,
                sendStatusDeferral: messageSendStatusDeferral,
            });
        }, (error) => {
            messageSendDeferral.reject(`Error formatting the message. ${error}`);
        });
        return messageSendStatusDeferral.promise;
    }
    read() {
        if (this.privConnectionState !== _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Connected) {
            return Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`);
        }
        return this.privReceivingMessageQueue.dequeue();
    }
    close(reason) {
        if (this.privWebsocketClient) {
            if (this.privConnectionState !== _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected) {
                this.privWebsocketClient.close(1000, reason ? reason : "Normal closure by client");
            }
        }
        else {
            return Promise.resolve();
        }
        return this.privDisconnectDeferral.promise;
    }
    get events() {
        return this.privConnectionEvents;
    }
    sendRawMessage(sendItem) {
        try {
            // indicates we are draining the queue and it came with no message;
            if (!sendItem) {
                return Promise.resolve();
            }
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_14__.ConnectionMessageSentEvent(this.privConnectionId, new Date().toISOString(), sendItem.Message));
            // add a check for the ws readystate in order to stop the red console error 'WebSocket is already in CLOSING or CLOSED state' appearing
            if (this.isWebsocketOpen) {
                // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
                this.privWebsocketClient.send(sendItem.RawWebsocketMessage.payload);
            }
            else {
                return Promise.reject("websocket send error: Websocket not ready " + this.privConnectionId + " " + sendItem.Message.id + " " + new Error().stack);
            }
            return Promise.resolve();
        }
        catch (e) {
            return Promise.reject(`websocket send error: ${e}`);
        }
    }
    onClose(code, reason) {
        return __awaiter(this, void 0, void 0, function* () {
            const closeReason = `Connection closed. ${code}: ${reason}`;
            this.privConnectionState = _common_Exports__WEBPACK_IMPORTED_MODULE_7__.ConnectionState.Disconnected;
            this.privDisconnectDeferral.resolve();
            yield this.privReceivingMessageQueue.drainAndDispose(() => {
                // TODO: Events for these ?
                // Logger.instance.onEvent(new LoggingEvent(LogType.Warning, null, `Failed to process received message. Reason: ${closeReason}, Message: ${JSON.stringify(pendingReceiveItem)}`));
            }, closeReason);
            yield this.privSendMessageQueue.drainAndDispose((pendingSendItem) => {
                pendingSendItem.sendStatusDeferral.reject(closeReason);
            }, closeReason);
        });
    }
    processSendQueue() {
        return __awaiter(this, void 0, void 0, function* () {
            while (true) {
                const itemToSend = this.privSendMessageQueue.dequeue();
                const sendItem = yield itemToSend;
                // indicates we are draining the queue and it came with no message;
                if (!sendItem) {
                    return;
                }
                try {
                    yield this.sendRawMessage(sendItem);
                    sendItem.sendStatusDeferral.resolve();
                }
                catch (sendError) {
                    sendItem.sendStatusDeferral.reject(sendError);
                }
            }
        });
    }
    onEvent(event) {
        this.privConnectionEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Events.instance.onEvent(event);
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    getAgent() {
        // eslint-disable-next-line @typescript-eslint/unbound-method
        const agent = new (agent_base__WEBPACK_IMPORTED_MODULE_2___default().Agent)(this.createConnection);
        if (this.proxyInfo !== undefined &&
            this.proxyInfo.HostName !== undefined &&
            this.proxyInfo.Port > 0) {
            agent.proxyInfo = this.proxyInfo;
        }
        return agent;
    }
    static GetProxyAgent(proxyInfo) {
        const httpProxyOptions = {
            host: proxyInfo.HostName,
            port: proxyInfo.Port,
        };
        if (!!proxyInfo.UserName) {
            httpProxyOptions.headers = {
                "Proxy-Authentication": "Basic " + new Buffer(`${proxyInfo.UserName}:${(proxyInfo.Password === undefined) ? "" : proxyInfo.Password}`).toString("base64"),
            };
        }
        else {
            httpProxyOptions.headers = {};
        }
        httpProxyOptions.headers.requestOCSP = "true";
        const httpProxyAgent = new (https_proxy_agent__WEBPACK_IMPORTED_MODULE_3___default())(httpProxyOptions);
        return httpProxyAgent;
    }
    createConnection(request, options) {
        let socketPromise;
        options = Object.assign(Object.assign({}, options), {
            requestOCSP: true,
            servername: options.host
        });
        if (!!this.proxyInfo) {
            const httpProxyAgent = WebsocketMessageAdapter.GetProxyAgent(this.proxyInfo);
            const baseAgent = httpProxyAgent;
            socketPromise = new Promise((resolve, reject) => {
                baseAgent.callback(request, options, (error, socket) => {
                    if (!!error) {
                        reject(error);
                    }
                    else {
                        resolve(socket);
                    }
                });
            });
        }
        else {
            if (!!options.secureEndpoint) {
                socketPromise = Promise.resolve(tls__WEBPACK_IMPORTED_MODULE_1__.connect(options));
            }
            else {
                socketPromise = Promise.resolve(net__WEBPACK_IMPORTED_MODULE_0__.connect(options));
            }
        }
        return socketPromise;
    }
    get isWebsocketOpen() {
        return this.privWebsocketClient && this.privWebsocketClient.readyState === this.privWebsocketClient.OPEN;
    }
}
WebsocketMessageAdapter.forceNpmWebSocket = false;

//# sourceMappingURL=WebsocketMessageAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AddedLmIntent": () => (/* binding */ AddedLmIntent)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * @class AddedLmIntent
 */
// eslint-disable-next-line max-classes-per-file
class AddedLmIntent {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param modelImpl - The model.
     * @param intentName - The intent name.
     */
    constructor(modelImpl, intentName) {
        this.modelImpl = modelImpl;
        this.intentName = intentName;
    }
}

//# sourceMappingURL=AddedLmIntent.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AgentConfig": () => (/* binding */ AgentConfig)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Represents the JSON used in the agent.config message sent to the speech service.
 */
class AgentConfig {
    toJsonString() {
        return JSON.stringify(this.iPrivConfig);
    }
    get() {
        return this.iPrivConfig;
    }
    /**
     * Setter for the agent.config object.
     * @param value a JSON serializable object.
     */
    set(value) {
        this.iPrivConfig = value;
    }
}

//# sourceMappingURL=AgentConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CognitiveSubscriptionKeyAuthentication": () => (/* binding */ CognitiveSubscriptionKeyAuthentication)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _IAuthentication__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * @class
 */
class CognitiveSubscriptionKeyAuthentication {
    /**
     * Creates and initializes an instance of the CognitiveSubscriptionKeyAuthentication class.
     * @constructor
     * @param {string} subscriptionKey - The subscription key
     */
    constructor(subscriptionKey) {
        if (!subscriptionKey) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("subscriptionKey");
        }
        this.privAuthInfo = new _IAuthentication__WEBPACK_IMPORTED_MODULE_1__.AuthInfo(_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.AuthKey, subscriptionKey);
    }
    /**
     * Fetches the subscription key.
     * @member
     * @function
     * @public
     * @param {string} authFetchEventId - The id to fetch.
     */
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    fetch(authFetchEventId) {
        return Promise.resolve(this.privAuthInfo);
    }
    /**
     * Fetches the subscription key.
     * @member
     * @function
     * @public
     * @param {string} authFetchEventId - The id to fetch.
     */
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    fetchOnExpiry(authFetchEventId) {
        return Promise.resolve(this.privAuthInfo);
    }
}

//# sourceMappingURL=CognitiveSubscriptionKeyAuthentication.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CognitiveTokenAuthentication": () => (/* binding */ CognitiveTokenAuthentication)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _IAuthentication__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./IAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class CognitiveTokenAuthentication {
    constructor(fetchCallback, fetchOnExpiryCallback) {
        if (!fetchCallback) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("fetchCallback");
        }
        if (!fetchOnExpiryCallback) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("fetchOnExpiryCallback");
        }
        this.privFetchCallback = fetchCallback;
        this.privFetchOnExpiryCallback = fetchOnExpiryCallback;
    }
    fetch(authFetchEventId) {
        return this.privFetchCallback(authFetchEventId).then((token) => new _IAuthentication__WEBPACK_IMPORTED_MODULE_1__.AuthInfo(_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Authorization, token === undefined ? undefined : CognitiveTokenAuthentication.privTokenPrefix + token));
    }
    fetchOnExpiry(authFetchEventId) {
        return this.privFetchOnExpiryCallback(authFetchEventId).then((token) => new _IAuthentication__WEBPACK_IMPORTED_MODULE_1__.AuthInfo(_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Authorization, token === undefined ? undefined : CognitiveTokenAuthentication.privTokenPrefix + token));
    }
}
CognitiveTokenAuthentication.privTokenPrefix = "bearer ";

//# sourceMappingURL=CognitiveTokenAuthentication.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionFactoryBase": () => (/* binding */ ConnectionFactoryBase)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class ConnectionFactoryBase {
    static getHostSuffix(region) {
        if (!!region) {
            if (region.toLowerCase().startsWith("china")) {
                return ".azure.cn";
            }
            if (region.toLowerCase().startsWith("usgov")) {
                return ".azure.us";
            }
        }
        return ".microsoft.com";
    }
    setCommonUrlParams(config, queryParams, endpoint) {
        const propertyIdToParameterMap = new Map([
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.Speech_SegmentationSilenceTimeoutMs, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.SegmentationSilenceTimeoutMs],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EnableAudioLogging, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EnableAudioLogging],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EndSilenceTimeoutMs],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.InitialSilenceTimeoutMs],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_PostProcessingOption, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.Postprocessing],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_ProfanityOption, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.Profanity],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EnableWordLevelTimestamps],
            [_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_StablePartialResultThreshold, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.StableIntermediateThreshold],
        ]);
        propertyIdToParameterMap.forEach((parameterName, propertyId) => {
            this.setUrlParameter(propertyId, parameterName, config, queryParams, endpoint);
        });
        const serviceProperties = JSON.parse(config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.ServicePropertiesPropertyName, "{}"));
        Object.keys(serviceProperties).forEach((value) => {
            queryParams[value] = serviceProperties[value];
        });
    }
    setUrlParameter(propId, parameterName, config, queryParams, endpoint) {
        const value = config.parameters.getProperty(propId, undefined);
        // FIXME: The .search() check will incorrectly match parameter name anywhere in the string
        //        including e.g. the path portion, or even as a substring of other query parameters
        if (value && (!endpoint || endpoint.search(parameterName) === -1)) {
            queryParams[parameterName] = value.toLocaleLowerCase();
        }
    }
}

//# sourceMappingURL=ConnectionFactoryBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationServiceRecognizer": () => (/* binding */ ConversationServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


class ConversationServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.handleSpeechPhraseMessage = (textBody) => __awaiter(this, void 0, void 0, function* () { return this.handleSpeechPhrase(textBody); });
        this.handleSpeechHypothesisMessage = (textBody) => this.handleSpeechHypothesis(textBody);
    }
    processTypeSpecificMessages(connectionMessage) {
        void connectionMessage;
        return;
    }
    handleRecognizedCallback(result, offset, sessionId) {
        void result;
        void offset;
        void sessionId;
        return;
    }
    handleRecognizingCallback(result, duration, sessionId) {
        void result;
        void duration;
        void sessionId;
        return;
    }
    processSpeechMessages(connectionMessage) {
        return __awaiter(this, void 0, void 0, function* () {
            let processed = false;
            switch (connectionMessage.path.toLowerCase()) {
                case "speech.hypothesis":
                case "speech.fragment":
                    if (!!this.handleSpeechHypothesisMessage) {
                        this.handleSpeechHypothesisMessage(connectionMessage.textBody);
                    }
                    processed = true;
                    break;
                case "speech.phrase":
                    if (!!this.handleSpeechPhraseMessage) {
                        yield this.handleSpeechPhraseMessage(connectionMessage.textBody);
                    }
                    processed = true;
                    break;
                default:
                    break;
            }
            return processed;
        });
    }
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        // Implementing to allow inheritance
        void sessionId;
        void requestId;
        void cancellationReason;
        void errorCode;
        void error;
    }
    handleSpeechPhrase(textBody) {
        return __awaiter(this, void 0, void 0, function* () {
            const simple = _Exports__WEBPACK_IMPORTED_MODULE_1__.SimpleSpeechPhrase.fromJSON(textBody);
            const resultReason = _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateRecognitionResult(simple.RecognitionStatus);
            let result;
            const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, textBody);
            const simpleOffset = simple.Offset + this.privRequestSession.currentTurnAudioOffset;
            let offset = simpleOffset;
            this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + simple.Offset + simple.Duration);
            if (_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled === resultReason) {
                const cancelReason = _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateCancelResult(simple.RecognitionStatus);
                const cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateCancelErrorCode(simple.RecognitionStatus);
                yield this.cancelRecognitionLocal(cancelReason, cancellationErrorCode, _Exports__WEBPACK_IMPORTED_MODULE_2__.EnumTranslation.implTranslateErrorDetails(cancellationErrorCode));
            }
            else {
                if (!(this.privRequestSession.isSpeechEnded && resultReason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.NoMatch && simple.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_6__.RecognitionStatus.InitialSilenceTimeout)) {
                    if (this.privRecognizerConfig.parameters.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_7__.OutputFormatPropertyName) === _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Simple]) {
                        result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, simple.DisplayText, simple.Duration, simpleOffset, simple.Language, simple.LanguageDetectionConfidence, simple.SpeakerId, undefined, textBody, resultProps);
                    }
                    else {
                        const detailed = _Exports__WEBPACK_IMPORTED_MODULE_10__.DetailedSpeechPhrase.fromJSON(textBody);
                        const totalOffset = detailed.Offset + this.privRequestSession.currentTurnAudioOffset;
                        const offsetCorrectedJson = detailed.getJsonWithCorrectedOffsets(totalOffset);
                        result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, detailed.Text, detailed.Duration, totalOffset, detailed.Language, detailed.LanguageDetectionConfidence, detailed.SpeakerId, undefined, offsetCorrectedJson, resultProps);
                        offset = result.offset;
                    }
                    this.handleRecognizedCallback(result, offset, this.privRequestSession.sessionId);
                }
            }
        });
    }
    handleSpeechHypothesis(textBody) {
        const hypothesis = _Exports__WEBPACK_IMPORTED_MODULE_11__.SpeechHypothesis.fromJSON(textBody);
        const offset = hypothesis.Offset + this.privRequestSession.currentTurnAudioOffset;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, textBody);
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechRecognitionResult(this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizingSpeech, hypothesis.Text, hypothesis.Duration, offset, hypothesis.Language, hypothesis.LanguageDetectionConfidence, hypothesis.SpeakerId, undefined, textBody, resultProps);
        this.privRequestSession.onHypothesis(offset);
        this.handleRecognizingCallback(result, hypothesis.Duration, this.privRequestSession.sessionId);
    }
}

//# sourceMappingURL=ConversationServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogConnectorFactory.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogConnectorFactory.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogConnectionFactory": () => (/* binding */ DialogConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */







class DialogConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        const applicationId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.Conversation_ApplicationId, "");
        const dialogType = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.Conversation_DialogType);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region);
        const language = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, "en-US");
        const requestTurnStatus = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.Conversation_Request_Bot_Status_Messages, "true");
        const queryParams = {};
        queryParams[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Format] = config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple]).toLowerCase();
        queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Language] = language;
        queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.RequestBotStatusMessages] = requestTurnStatus;
        if (applicationId) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.BotId] = applicationId;
            if (dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.CustomCommands) {
                queryParams[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.CustomCommandsAppId] = applicationId;
            }
        }
        const resourceInfix = dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.CustomCommands ? "commands/"
            : "";
        const version = dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.CustomCommands ? "v1"
            : dialogType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceConfig.DialogTypes.BotFramework ? "v3"
                : "v0";
        const headers = {};
        if (authInfo.token != null && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        // The URL used for connection is chosen in a priority order of specification:
        //  1. If a custom endpoint is provided, that URL is used verbatim.
        //  2. If a custom host is provided (e.g. "wss://my.custom.endpoint.com:1123"), a URL is constructed from it.
        //  3. If no custom connection details are provided, a URL is constructed from default values.
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, "");
        if (!endpoint) {
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
            const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, `wss://${region}.${DialogConnectionFactory.BaseUrl}${hostSuffix}`);
            const standardizedHost = host.endsWith("/") ? host : host + "/";
            endpoint = `${standardizedHost}${resourceInfix}${DialogConnectionFactory.ApiKey}/${version}`;
        }
        this.setCommonUrlParams(config, queryParams, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_8__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
}
DialogConnectionFactory.ApiKey = "api";
DialogConnectionFactory.BaseUrl = "convai.speech";

//# sourceMappingURL=DialogConnectorFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceAdapter": () => (/* binding */ DialogServiceAdapter)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_DialogEvents__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../common/DialogEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DialogEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js");
/* harmony import */ var _DialogServiceTurnStateManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogServiceTurnStateManager */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnStateManager.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./ServiceMessages/ActivityResponsePayload */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









class DialogServiceAdapter extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, dialogServiceConnector) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, dialogServiceConnector);
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privDialogServiceConnector = dialogServiceConnector;
        this.receiveMessageOverride = () => this.receiveDialogMessageOverride();
        this.privTurnStateManager = new _DialogServiceTurnStateManager__WEBPACK_IMPORTED_MODULE_2__.DialogServiceTurnStateManager();
        this.recognizeOverride =
            (recoMode, successCallback, errorCallback) => this.listenOnce(recoMode, successCallback, errorCallback);
        this.postConnectImplOverride = (connection) => this.dialogConnectImpl(connection);
        this.configConnectionOverride = (connection) => this.configConnection(connection);
        this.disconnectOverride = () => this.privDisconnect();
        this.privDialogAudioSource = audioSource;
        this.agentConfigSent = false;
        this.privLastResult = null;
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionClosedEvent") {
                this.terminateMessageLoop = true;
            }
        });
    }
    sendMessage(message) {
        return __awaiter(this, void 0, void 0, function* () {
            const interactionGuid = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createGuid)();
            const requestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createNoDashGuid)();
            const agentMessage = {
                context: {
                    interactionId: interactionGuid
                },
                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
                messagePayload: JSON.parse(message),
                version: 0.5
            };
            const agentMessageJson = JSON.stringify(agentMessage);
            const connection = yield this.fetchConnection();
            yield connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text, "agent", requestId, "application/json", agentMessageJson));
        });
    }
    privDisconnect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.NoError, "Disconnecting");
            this.terminateMessageLoop = true;
            this.agentConfigSent = false;
            return;
        });
    }
    processTypeSpecificMessages(connectionMessage) {
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        let result;
        let processed;
        switch (connectionMessage.path.toLowerCase()) {
            case "speech.phrase":
                const speechPhrase = _Exports__WEBPACK_IMPORTED_MODULE_10__.SimpleSpeechPhrase.fromJSON(connectionMessage.textBody);
                this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + speechPhrase.Offset + speechPhrase.Duration);
                if (speechPhrase.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_11__.RecognitionStatus.TooManyRequests && speechPhrase.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_11__.RecognitionStatus.Error) {
                    const args = this.fireEventForResult(speechPhrase, resultProps);
                    this.privLastResult = args.result;
                    if (!!this.privDialogServiceConnector.recognized) {
                        try {
                            this.privDialogServiceConnector.recognized(this.privDialogServiceConnector, args);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                }
                processed = true;
                break;
            case "speech.hypothesis":
                const hypothesis = _Exports__WEBPACK_IMPORTED_MODULE_12__.SpeechHypothesis.fromJSON(connectionMessage.textBody);
                const offset = hypothesis.Offset + this.privRequestSession.currentTurnAudioOffset;
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.RecognizingSpeech, hypothesis.Text, hypothesis.Duration, offset, hypothesis.Language, hypothesis.LanguageDetectionConfidence, undefined, undefined, connectionMessage.textBody, resultProps);
                this.privRequestSession.onHypothesis(offset);
                const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechRecognitionEventArgs(result, hypothesis.Duration, this.privRequestSession.sessionId);
                if (!!this.privDialogServiceConnector.recognizing) {
                    try {
                        this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector, ev);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "speech.keyword":
                const keyword = _Exports__WEBPACK_IMPORTED_MODULE_16__.SpeechKeyword.fromJSON(connectionMessage.textBody);
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(this.privRequestSession.requestId, keyword.Status === "Accepted" ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.RecognizedKeyword : _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.NoMatch, keyword.Text, keyword.Duration, keyword.Offset, undefined, undefined, undefined, undefined, connectionMessage.textBody, resultProps);
                if (keyword.Status !== "Accepted") {
                    this.privLastResult = result;
                }
                const event = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechRecognitionEventArgs(result, result.duration, result.resultId);
                if (!!this.privDialogServiceConnector.recognized) {
                    try {
                        this.privDialogServiceConnector.recognized(this.privDialogServiceConnector, event);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "audio":
                {
                    const audioRequestId = connectionMessage.requestId.toUpperCase();
                    const turn = this.privTurnStateManager.GetTurn(audioRequestId);
                    try {
                        // Empty binary message signals end of stream.
                        if (!connectionMessage.binaryBody) {
                            turn.endAudioStream();
                        }
                        else {
                            turn.audioStream.write(connectionMessage.binaryBody);
                        }
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "response":
                {
                    this.handleResponseMessage(connectionMessage);
                }
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_17__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        return __awaiter(this, void 0, void 0, function* () {
            this.terminateMessageLoop = true;
            if (!!this.privRequestSession.isRecognizing) {
                yield this.privRequestSession.onStopRecognizing();
            }
            if (!!this.privDialogServiceConnector.canceled) {
                const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyCollection();
                properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_18__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode[errorCode]);
                const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__.SpeechRecognitionCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
                try {
                    this.privDialogServiceConnector.canceled(this.privDialogServiceConnector, cancelEvent);
                    /* eslint-disable no-empty */
                }
                catch (_a) { }
                if (!!this.privSuccessCallback) {
                    const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(undefined, // ResultId
                    _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.ResultReason.Canceled, undefined, // Text
                    undefined, // Duration
                    undefined, // Offset
                    undefined, // Language
                    undefined, // Language Detection Confidence
                    undefined, // Speaker Id
                    error, undefined, // Json
                    properties);
                    try {
                        this.privSuccessCallback(result);
                        this.privSuccessCallback = undefined;
                        /* eslint-disable no-empty */
                    }
                    catch (_b) { }
                }
            }
        });
    }
    listenOnce(recoMode, successCallback, errorCallback) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privRecognizerConfig.recognitionMode = recoMode;
            this.privSuccessCallback = successCallback;
            this.privErrorCallback = errorCallback;
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events);
            this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Speech_SessionId, this.privRequestSession.sessionId);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            const preAudioPromise = this.sendPreAudioMessages();
            const node = yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId);
            const format = yield this.privDialogAudioSource.format;
            const deviceInfo = yield this.privDialogAudioSource.deviceInfo;
            const audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_20__.ReplayableAudioNode(node, format.avgBytesPerSec);
            yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
            this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            try {
                yield conPromise;
                yield preAudioPromise;
            }
            catch (error) {
                yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.ConnectionFailure, error);
                return Promise.resolve();
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            const audioSendPromise = this.sendAudio(audioNode);
            // /* eslint-disable no-empty */
            audioSendPromise.then(() => { }, (error) => __awaiter(this, void 0, void 0, function* () {
                yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.RuntimeError, error);
            }));
        });
    }
    // Establishes a websocket connection to the end point.
    dialogConnectImpl(connection) {
        this.privConnectionLoop = this.startMessageLoop();
        return connection;
    }
    receiveDialogMessageOverride() {
        // we won't rely on the cascading promises of the connection since we want to continually be available to receive messages
        const communicationCustodian = new _common_Exports__WEBPACK_IMPORTED_MODULE_17__.Deferred();
        const loop = () => __awaiter(this, void 0, void 0, function* () {
            try {
                const isDisposed = this.isDisposed();
                const terminateMessageLoop = (!this.isDisposed() && this.terminateMessageLoop);
                if (isDisposed || terminateMessageLoop) {
                    // We're done.
                    communicationCustodian.resolve(undefined);
                    return;
                }
                const connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (!message) {
                    return loop();
                }
                const connectionMessage = _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage.fromConnectionMessage(message);
                switch (connectionMessage.path.toLowerCase()) {
                    case "turn.start":
                        {
                            const turnRequestId = connectionMessage.requestId.toUpperCase();
                            const audioSessionReqId = this.privRequestSession.requestId.toUpperCase();
                            // turn started by the service
                            if (turnRequestId !== audioSessionReqId) {
                                this.privTurnStateManager.StartTurn(turnRequestId);
                            }
                            else {
                                this.privRequestSession.onServiceTurnStartResponse();
                            }
                        }
                        break;
                    case "speech.startdetected":
                        const speechStartDetected = _Exports__WEBPACK_IMPORTED_MODULE_22__.SpeechDetected.fromJSON(connectionMessage.textBody);
                        const speechStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_23__.RecognitionEventArgs(speechStartDetected.Offset, this.privRequestSession.sessionId);
                        if (!!this.privRecognizer.speechStartDetected) {
                            this.privRecognizer.speechStartDetected(this.privRecognizer, speechStartEventArgs);
                        }
                        break;
                    case "speech.enddetected":
                        let json;
                        if (connectionMessage.textBody.length > 0) {
                            json = connectionMessage.textBody;
                        }
                        else {
                            // If the request was empty, the JSON returned is empty.
                            json = "{ Offset: 0 }";
                        }
                        const speechStopDetected = _Exports__WEBPACK_IMPORTED_MODULE_22__.SpeechDetected.fromJSON(json);
                        this.privRequestSession.onServiceRecognized(speechStopDetected.Offset + this.privRequestSession.currentTurnAudioOffset);
                        const speechStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_23__.RecognitionEventArgs(speechStopDetected.Offset + this.privRequestSession.currentTurnAudioOffset, this.privRequestSession.sessionId);
                        if (!!this.privRecognizer.speechEndDetected) {
                            this.privRecognizer.speechEndDetected(this.privRecognizer, speechStopEventArgs);
                        }
                        break;
                    case "turn.end":
                        {
                            const turnEndRequestId = connectionMessage.requestId.toUpperCase();
                            const audioSessionReqId = this.privRequestSession.requestId.toUpperCase();
                            // turn started by the service
                            if (turnEndRequestId !== audioSessionReqId) {
                                this.privTurnStateManager.CompleteTurn(turnEndRequestId);
                            }
                            else {
                                // Audio session turn
                                const sessionStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__.SessionEventArgs(this.privRequestSession.sessionId);
                                yield this.privRequestSession.onServiceTurnEndResponse(false);
                                if (!this.privRecognizerConfig.isContinuousRecognition || this.privRequestSession.isSpeechEnded || !this.privRequestSession.isRecognizing) {
                                    if (!!this.privRecognizer.sessionStopped) {
                                        this.privRecognizer.sessionStopped(this.privRecognizer, sessionStopEventArgs);
                                    }
                                }
                                // report result to promise.
                                if (!!this.privSuccessCallback && this.privLastResult) {
                                    try {
                                        this.privSuccessCallback(this.privLastResult);
                                        this.privLastResult = null;
                                    }
                                    catch (e) {
                                        if (!!this.privErrorCallback) {
                                            this.privErrorCallback(e);
                                        }
                                    }
                                    // Only invoke the call back once.
                                    // and if it's successful don't invoke the
                                    // error after that.
                                    this.privSuccessCallback = undefined;
                                    this.privErrorCallback = undefined;
                                }
                            }
                        }
                        break;
                    default:
                        try {
                            const processed = yield this.processTypeSpecificMessages(connectionMessage);
                            if (!processed) {
                                if (!!this.serviceEvents) {
                                    this.serviceEvents.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_24__.ServiceEvent(connectionMessage.path.toLowerCase(), connectionMessage.textBody));
                                }
                            }
                        }
                        catch (e) {
                            //
                        }
                }
                const ret = loop();
                return ret;
            }
            catch (error) {
                this.terminateMessageLoop = true;
                communicationCustodian.resolve();
            }
        });
        loop().catch((reason) => {
            _common_Exports__WEBPACK_IMPORTED_MODULE_25__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_26__.BackgroundEvent(reason));
        });
        return communicationCustodian.promise;
    }
    startMessageLoop() {
        return __awaiter(this, void 0, void 0, function* () {
            this.terminateMessageLoop = false;
            try {
                yield this.receiveDialogMessageOverride();
            }
            catch (error) {
                yield this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCode.RuntimeError, error);
            }
            return Promise.resolve();
        });
    }
    // Takes an established websocket connection to the endpoint and sends speech configuration information.
    configConnection(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.terminateMessageLoop) {
                this.terminateMessageLoop = false;
                return Promise.reject("Connection to service terminated.");
            }
            yield this.sendSpeechServiceConfig(connection, this.privRequestSession, this.privRecognizerConfig.SpeechServiceConfig.serialize());
            yield this.sendAgentConfig(connection);
            return connection;
        });
    }
    sendPreAudioMessages() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.addKeywordContextData();
            yield this.sendSpeechContext(connection, true);
            yield this.sendAgentContext(connection);
            yield this.sendWaveHeader(connection);
        });
    }
    sendAgentConfig(connection) {
        if (this.agentConfig && !this.agentConfigSent) {
            if (this.privRecognizerConfig
                .parameters
                .getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Conversation_DialogType) === _sdk_Exports__WEBPACK_IMPORTED_MODULE_27__.DialogServiceConfig.DialogTypes.CustomCommands) {
                const config = this.agentConfig.get();
                config.botInfo.commandsCulture = this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_RecoLanguage, "en-us");
                this.agentConfig.set(config);
            }
            this.onEvent(new _common_DialogEvents__WEBPACK_IMPORTED_MODULE_28__.SendingAgentContextMessageEvent(this.agentConfig));
            const agentConfigJson = this.agentConfig.toJsonString();
            // guard against sending this multiple times on one connection
            this.agentConfigSent = true;
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text, "agent.config", this.privRequestSession.requestId, "application/json", agentConfigJson));
        }
        return;
    }
    sendAgentContext(connection) {
        const guid = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createGuid)();
        const speechActivityTemplate = this.privDialogServiceConnector.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Conversation_Speech_Activity_Template);
        const agentContext = {
            channelData: "",
            context: {
                interactionId: guid
            },
            messagePayload: typeof speechActivityTemplate === undefined ? undefined : speechActivityTemplate,
            version: 0.5
        };
        const agentContextJson = JSON.stringify(agentContext);
        return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_4__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_5__.MessageType.Text, "speech.agent.context", this.privRequestSession.requestId, "application/json", agentContextJson));
    }
    fireEventForResult(serviceResult, properties) {
        const resultReason = _Exports__WEBPACK_IMPORTED_MODULE_29__.EnumTranslation.implTranslateRecognitionResult(serviceResult.RecognitionStatus);
        const offset = serviceResult.Offset + this.privRequestSession.currentTurnAudioOffset;
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, serviceResult.DisplayText, serviceResult.Duration, offset, serviceResult.Language, serviceResult.LanguageDetectionConfidence, undefined, undefined, JSON.stringify(serviceResult), properties);
        const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechRecognitionEventArgs(result, offset, this.privRequestSession.sessionId);
        return ev;
    }
    handleResponseMessage(responseMessage) {
        // "response" messages can contain either "message" (activity) or "MessageStatus" data. Fire the appropriate
        // event according to the message type that's specified.
        const responsePayload = JSON.parse(responseMessage.textBody);
        switch (responsePayload.messageType.toLowerCase()) {
            case "message":
                const responseRequestId = responseMessage.requestId.toUpperCase();
                const activityPayload = _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_30__.ActivityPayloadResponse.fromJSON(responseMessage.textBody);
                const turn = this.privTurnStateManager.GetTurn(responseRequestId);
                // update the conversation Id
                if (activityPayload.conversationId) {
                    const updateAgentConfig = this.agentConfig.get();
                    updateAgentConfig.botInfo.conversationId = activityPayload.conversationId;
                    this.agentConfig.set(updateAgentConfig);
                }
                const pullAudioOutputStream = turn.processActivityPayload(activityPayload, _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_31__.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)));
                const activity = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_32__.ActivityReceivedEventArgs(activityPayload.messagePayload, pullAudioOutputStream);
                if (!!this.privDialogServiceConnector.activityReceived) {
                    try {
                        this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector, activity);
                        /* eslint-disable-next-line no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                break;
            case "messagestatus":
                if (!!this.privDialogServiceConnector.turnStatusReceived) {
                    try {
                        this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector, new _sdk_Exports__WEBPACK_IMPORTED_MODULE_33__.TurnStatusReceivedEventArgs(responseMessage.textBody));
                        /* eslint-disable-next-line no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                break;
            default:
                _common_Exports__WEBPACK_IMPORTED_MODULE_25__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_26__.BackgroundEvent(`Unexpected response of type ${responsePayload.messageType}. Ignoring.`));
                break;
        }
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_25__.Events.instance.onEvent(event);
    }
    addKeywordContextData() {
        const keywordPropertyValue = this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");
        if (keywordPropertyValue === undefined) {
            return;
        }
        const keywordOffsetPropertyValue = this.privRecognizerConfig.parameters
            .getProperty("SPEECH-KeywordsToDetect-Offsets");
        const keywordDurationPropertyValue = this.privRecognizerConfig.parameters
            .getProperty("SPEECH-KeywordsToDetect-Durations");
        const keywords = keywordPropertyValue.split(";");
        const keywordOffsets = keywordOffsetPropertyValue === undefined ? [] : keywordOffsetPropertyValue.split(";");
        const keywordDurations = keywordDurationPropertyValue === undefined ? [] : keywordDurationPropertyValue.split(";");
        const keywordDefinitionArray = [];
        for (let i = 0; i < keywords.length; i++) {
            const definition = {};
            definition.text = keywords[i];
            if (i < keywordOffsets.length) {
                definition.offset = Number(keywordOffsets[i]);
            }
            if (i < keywordDurations.length) {
                definition.duration = Number(keywordDurations[i]);
            }
            keywordDefinitionArray.push(definition);
        }
        this.speechContext.setSection("invocationSource", "VoiceActivationWithKeyword");
        this.speechContext.setSection("keywordDetection", [{
                clientDetectedKeywords: keywordDefinitionArray,
                onReject: { action: "EndOfTurn" },
                type: "startTrigger"
            }]);
    }
}

//# sourceMappingURL=DialogServiceAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnState.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnState.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceTurnState": () => (/* binding */ DialogServiceTurnState)
/* harmony export */ });
/* harmony import */ var _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
/* harmony import */ var _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ServiceMessages/ActivityResponsePayload */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class DialogServiceTurnState {
    constructor(manager, requestId) {
        this.privRequestId = requestId;
        this.privIsCompleted = false;
        this.privAudioStream = null;
        this.privTurnManager = manager;
        this.resetTurnEndTimeout();
    }
    get audioStream() {
        // Called when is needed to stream.
        this.resetTurnEndTimeout();
        return this.privAudioStream;
    }
    processActivityPayload(payload, audioFormat) {
        if (payload.messageDataStreamType === _ServiceMessages_ActivityResponsePayload__WEBPACK_IMPORTED_MODULE_0__.MessageDataStreamType.TextToSpeechAudio) {
            this.privAudioStream = _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_1__.AudioOutputStream.createPullStream();
            this.privAudioStream.format = (audioFormat !== undefined) ? audioFormat : _sdk_Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__.AudioOutputFormatImpl.getDefaultOutputFormat();
        }
        return this.privAudioStream;
    }
    endAudioStream() {
        if (this.privAudioStream !== null && !this.privAudioStream.isClosed) {
            this.privAudioStream.close();
        }
    }
    complete() {
        if (this.privTimeoutToken !== undefined) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            clearTimeout(this.privTimeoutToken);
        }
        this.endAudioStream();
    }
    resetTurnEndTimeout() {
        if (this.privTimeoutToken !== undefined) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            clearTimeout(this.privTimeoutToken);
        }
        this.privTimeoutToken = setTimeout(() => {
            this.privTurnManager.CompleteTurn(this.privRequestId);
            return;
        }, 2000);
    }
}

//# sourceMappingURL=DialogServiceTurnState.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnStateManager.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnStateManager.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceTurnStateManager": () => (/* binding */ DialogServiceTurnStateManager)
/* harmony export */ });
/* harmony import */ var _common_Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _DialogServiceTurnState__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DialogServiceTurnState */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceTurnState.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class DialogServiceTurnStateManager {
    constructor() {
        this.privTurnMap = new Map();
        return;
    }
    StartTurn(id) {
        if (this.privTurnMap.has(id)) {
            throw new _common_Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Service error: There is already a turn with id:" + id);
        }
        const turnState = new _DialogServiceTurnState__WEBPACK_IMPORTED_MODULE_1__.DialogServiceTurnState(this, id);
        this.privTurnMap.set(id, turnState);
        return this.privTurnMap.get(id);
    }
    GetTurn(id) {
        return this.privTurnMap.get(id);
    }
    CompleteTurn(id) {
        if (!this.privTurnMap.has(id)) {
            throw new _common_Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Service error: Received turn end for an unknown turn id:" + id);
        }
        const turnState = this.privTurnMap.get(id);
        turnState.complete();
        this.privTurnMap.delete(id);
        return turnState;
    }
}

//# sourceMappingURL=DialogServiceTurnStateManager.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DynamicGrammarBuilder": () => (/* binding */ DynamicGrammarBuilder)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Responsible for building the object to be sent to the speech service to support dynamic grammars.
 * @class DynamicGrammarBuilder
 */
class DynamicGrammarBuilder {
    // Adds one more reference phrases to the dynamic grammar to send.
    // All added phrases are generic phrases.
    addPhrase(phrase) {
        if (!this.privPhrases) {
            this.privPhrases = [];
        }
        if (phrase instanceof Array) {
            this.privPhrases = this.privPhrases.concat(phrase);
        }
        else {
            this.privPhrases.push(phrase);
        }
    }
    // Clears all phrases stored in the current object.
    clearPhrases() {
        this.privPhrases = undefined;
    }
    // Adds one or more reference grammars to the current grammar.
    addReferenceGrammar(grammar) {
        if (!this.privGrammars) {
            this.privGrammars = [];
        }
        if (grammar instanceof Array) {
            this.privGrammars = this.privGrammars.concat(grammar);
        }
        else {
            this.privGrammars.push(grammar);
        }
    }
    // clears all grammars stored on the recognizer.
    clearGrammars() {
        this.privGrammars = undefined;
    }
    // Generates an object that represents the dynamic grammar used by the Speech Service.
    // This is done by building an object with the correct layout based on the phrases and reference grammars added to this instance
    // of a DynamicGrammarBuilder
    generateGrammarObject() {
        if (this.privGrammars === undefined && this.privPhrases === undefined) {
            return undefined;
        }
        const retObj = {};
        retObj.ReferenceGrammars = this.privGrammars;
        if (undefined !== this.privPhrases && 0 !== this.privPhrases.length) {
            const retPhrases = [];
            this.privPhrases.forEach((value) => {
                retPhrases.push({
                    Text: value,
                });
            });
            retObj.Groups = [{ Type: "Generic", Items: retPhrases }];
        }
        return retObj;
    }
}

//# sourceMappingURL=DynamicGrammarBuilder.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarInterfaces.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarInterfaces.js ***!
  \**************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=DynamicGrammarInterfaces.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EnumTranslation": () => (/* binding */ EnumTranslation)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class EnumTranslation {
    static implTranslateRecognitionResult(recognitionStatus) {
        let reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.Canceled;
        switch (recognitionStatus) {
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Success:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.RecognizedSpeech;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.NoMatch:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.InitialSilenceTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BabbleTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.EndOfDictation:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.NoMatch;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Error:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BadRequest:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Forbidden:
            default:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.Canceled;
                break;
        }
        return reason;
    }
    static implTranslateCancelResult(recognitionStatus) {
        let reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason.EndOfStream;
        switch (recognitionStatus) {
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Success:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.EndOfDictation:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.NoMatch:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason.EndOfStream;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.InitialSilenceTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BabbleTimeout:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Error:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BadRequest:
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Forbidden:
            default:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationReason.Error;
                break;
        }
        return reason;
    }
    static implTranslateCancelErrorCode(recognitionStatus) {
        let reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError;
        switch (recognitionStatus) {
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Error:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.ServiceError;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.TooManyRequests:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.TooManyRequests;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.BadRequest:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.BadRequestParameters;
                break;
            case _Exports__WEBPACK_IMPORTED_MODULE_1__.RecognitionStatus.Forbidden:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.Forbidden;
                break;
            default:
                reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError;
                break;
        }
        return reason;
    }
    static implTranslateErrorDetails(cancellationErrorCode) {
        let errorDetails = "The speech service encountered an internal error and could not continue.";
        switch (cancellationErrorCode) {
            case _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.Forbidden:
                errorDetails = "The recognizer is using a free subscription that ran out of quota.";
                break;
            case _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.BadRequestParameters:
                errorDetails = "Invalid parameter or unsupported audio format in the request.";
                break;
            case _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.TooManyRequests:
                errorDetails = "The number of parallel requests exceeded the number of allowed concurrent transcriptions.";
                break;
            default:
                break;
        }
        return errorDetails;
    }
}

//# sourceMappingURL=EnumTranslation.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AddedLmIntent": () => (/* reexport safe */ _AddedLmIntent__WEBPACK_IMPORTED_MODULE_30__.AddedLmIntent),
/* harmony export */   "AgentConfig": () => (/* reexport safe */ _AgentConfig__WEBPACK_IMPORTED_MODULE_39__.AgentConfig),
/* harmony export */   "AuthInfo": () => (/* reexport safe */ _IAuthentication__WEBPACK_IMPORTED_MODULE_2__.AuthInfo),
/* harmony export */   "AutoDetectSourceLanguagesOpenRangeOptionName": () => (/* binding */ AutoDetectSourceLanguagesOpenRangeOptionName),
/* harmony export */   "CancellationErrorCodePropertyName": () => (/* binding */ CancellationErrorCodePropertyName),
/* harmony export */   "CognitiveSubscriptionKeyAuthentication": () => (/* reexport safe */ _CognitiveSubscriptionKeyAuthentication__WEBPACK_IMPORTED_MODULE_0__.CognitiveSubscriptionKeyAuthentication),
/* harmony export */   "CognitiveTokenAuthentication": () => (/* reexport safe */ _CognitiveTokenAuthentication__WEBPACK_IMPORTED_MODULE_1__.CognitiveTokenAuthentication),
/* harmony export */   "ConnectingToServiceEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.ConnectingToServiceEvent),
/* harmony export */   "Context": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.Context),
/* harmony export */   "ConversationConnectionConfig": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationConnectionConfig),
/* harmony export */   "ConversationManager": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationManager),
/* harmony export */   "ConversationReceivedTranslationEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationReceivedTranslationEventArgs),
/* harmony export */   "ConversationRecognizerFactory": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationRecognizerFactory),
/* harmony export */   "ConversationServiceRecognizer": () => (/* reexport safe */ _ConversationServiceRecognizer__WEBPACK_IMPORTED_MODULE_9__.ConversationServiceRecognizer),
/* harmony export */   "ConversationTranslatorCommandTypes": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationTranslatorCommandTypes),
/* harmony export */   "ConversationTranslatorMessageTypes": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ConversationTranslatorMessageTypes),
/* harmony export */   "DetailedSpeechPhrase": () => (/* reexport safe */ _ServiceMessages_DetailedSpeechPhrase__WEBPACK_IMPORTED_MODULE_28__.DetailedSpeechPhrase),
/* harmony export */   "Device": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.Device),
/* harmony export */   "DialogServiceAdapter": () => (/* reexport safe */ _DialogServiceAdapter__WEBPACK_IMPORTED_MODULE_38__.DialogServiceAdapter),
/* harmony export */   "DynamicGrammarBuilder": () => (/* reexport safe */ _DynamicGrammarBuilder__WEBPACK_IMPORTED_MODULE_36__.DynamicGrammarBuilder),
/* harmony export */   "EnumTranslation": () => (/* reexport safe */ _EnumTranslation__WEBPACK_IMPORTED_MODULE_17__.EnumTranslation),
/* harmony export */   "ForceDictationPropertyName": () => (/* binding */ ForceDictationPropertyName),
/* harmony export */   "IntentConnectionFactory": () => (/* reexport safe */ _IntentConnectionFactory__WEBPACK_IMPORTED_MODULE_5__.IntentConnectionFactory),
/* harmony export */   "IntentResponse": () => (/* reexport safe */ _ServiceMessages_IntentResponse__WEBPACK_IMPORTED_MODULE_32__.IntentResponse),
/* harmony export */   "IntentServiceRecognizer": () => (/* reexport safe */ _IntentServiceRecognizer__WEBPACK_IMPORTED_MODULE_31__.IntentServiceRecognizer),
/* harmony export */   "InternalParticipants": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.InternalParticipants),
/* harmony export */   "ListeningStartedEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.ListeningStartedEvent),
/* harmony export */   "LockRoomEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.LockRoomEventArgs),
/* harmony export */   "MetadataType": () => (/* reexport safe */ _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_41__.MetadataType),
/* harmony export */   "MuteAllEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.MuteAllEventArgs),
/* harmony export */   "OS": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.OS),
/* harmony export */   "OutputFormatPropertyName": () => (/* binding */ OutputFormatPropertyName),
/* harmony export */   "ParticipantAttributeEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ParticipantAttributeEventArgs),
/* harmony export */   "ParticipantEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ParticipantEventArgs),
/* harmony export */   "ParticipantsListEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.ParticipantsListEventArgs),
/* harmony export */   "RecognitionCompletionStatus": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionCompletionStatus),
/* harmony export */   "RecognitionEndedEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionEndedEvent),
/* harmony export */   "RecognitionMode": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.RecognitionMode),
/* harmony export */   "RecognitionStartedEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionStartedEvent),
/* harmony export */   "RecognitionStatus": () => (/* reexport safe */ _ServiceMessages_Enums__WEBPACK_IMPORTED_MODULE_18__.RecognitionStatus),
/* harmony export */   "RecognitionTriggeredEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.RecognitionTriggeredEvent),
/* harmony export */   "RecognizerConfig": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.RecognizerConfig),
/* harmony export */   "RequestSession": () => (/* reexport safe */ _RequestSession__WEBPACK_IMPORTED_MODULE_34__.RequestSession),
/* harmony export */   "ServicePropertiesPropertyName": () => (/* binding */ ServicePropertiesPropertyName),
/* harmony export */   "ServiceRecognizerBase": () => (/* reexport safe */ _ServiceRecognizerBase__WEBPACK_IMPORTED_MODULE_8__.ServiceRecognizerBase),
/* harmony export */   "SimpleSpeechPhrase": () => (/* reexport safe */ _ServiceMessages_SimpleSpeechPhrase__WEBPACK_IMPORTED_MODULE_29__.SimpleSpeechPhrase),
/* harmony export */   "SpeakerRecognitionConfig": () => (/* reexport safe */ _SpeakerRecognitionConfig__WEBPACK_IMPORTED_MODULE_47__.SpeakerRecognitionConfig),
/* harmony export */   "SpeakerRecognitionConnectionFactory": () => (/* reexport safe */ _SpeakerRecognitionConnectionFactory__WEBPACK_IMPORTED_MODULE_6__.SpeakerRecognitionConnectionFactory),
/* harmony export */   "SpeakerServiceRecognizer": () => (/* reexport safe */ _SpeakerServiceRecognizer__WEBPACK_IMPORTED_MODULE_48__.SpeakerServiceRecognizer),
/* harmony export */   "SpeechConnectionFactory": () => (/* reexport safe */ _SpeechConnectionFactory__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionFactory),
/* harmony export */   "SpeechContext": () => (/* reexport safe */ _SpeechContext__WEBPACK_IMPORTED_MODULE_35__.SpeechContext),
/* harmony export */   "SpeechDetected": () => (/* reexport safe */ _ServiceMessages_SpeechDetected__WEBPACK_IMPORTED_MODULE_23__.SpeechDetected),
/* harmony export */   "SpeechHypothesis": () => (/* reexport safe */ _ServiceMessages_SpeechHypothesis__WEBPACK_IMPORTED_MODULE_24__.SpeechHypothesis),
/* harmony export */   "SpeechKeyword": () => (/* reexport safe */ _ServiceMessages_SpeechKeyword__WEBPACK_IMPORTED_MODULE_25__.SpeechKeyword),
/* harmony export */   "SpeechRecognitionEvent": () => (/* reexport safe */ _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__.SpeechRecognitionEvent),
/* harmony export */   "SpeechResultFormat": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.SpeechResultFormat),
/* harmony export */   "SpeechServiceConfig": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.SpeechServiceConfig),
/* harmony export */   "SpeechServiceRecognizer": () => (/* reexport safe */ _SpeechServiceRecognizer__WEBPACK_IMPORTED_MODULE_26__.SpeechServiceRecognizer),
/* harmony export */   "SpeechSynthesisConnectionFactory": () => (/* reexport safe */ _SpeechSynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_16__.SpeechSynthesisConnectionFactory),
/* harmony export */   "SynthesisAdapterBase": () => (/* reexport safe */ _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_43__.SynthesisAdapterBase),
/* harmony export */   "SynthesisAudioMetadata": () => (/* reexport safe */ _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_41__.SynthesisAudioMetadata),
/* harmony export */   "SynthesisContext": () => (/* reexport safe */ _SynthesisContext__WEBPACK_IMPORTED_MODULE_46__.SynthesisContext),
/* harmony export */   "SynthesisRestAdapter": () => (/* reexport safe */ _SynthesisRestAdapter__WEBPACK_IMPORTED_MODULE_44__.SynthesisRestAdapter),
/* harmony export */   "SynthesisServiceType": () => (/* reexport safe */ _SynthesizerConfig__WEBPACK_IMPORTED_MODULE_45__.SynthesisServiceType),
/* harmony export */   "SynthesisStatus": () => (/* reexport safe */ _ServiceMessages_Enums__WEBPACK_IMPORTED_MODULE_18__.SynthesisStatus),
/* harmony export */   "SynthesisTurn": () => (/* reexport safe */ _SynthesisTurn__WEBPACK_IMPORTED_MODULE_42__.SynthesisTurn),
/* harmony export */   "SynthesizerConfig": () => (/* reexport safe */ _SynthesizerConfig__WEBPACK_IMPORTED_MODULE_45__.SynthesizerConfig),
/* harmony export */   "System": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.System),
/* harmony export */   "TranscriberConnectionFactory": () => (/* reexport safe */ _TranscriberConnectionFactory__WEBPACK_IMPORTED_MODULE_14__.TranscriberConnectionFactory),
/* harmony export */   "TranscriberRecognizer": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__.TranscriberRecognizer),
/* harmony export */   "TranscriptionServiceRecognizer": () => (/* reexport safe */ _TranscriptionServiceRecognizer__WEBPACK_IMPORTED_MODULE_27__.TranscriptionServiceRecognizer),
/* harmony export */   "TranslationConnectionFactory": () => (/* reexport safe */ _TranslationConnectionFactory__WEBPACK_IMPORTED_MODULE_15__.TranslationConnectionFactory),
/* harmony export */   "TranslationHypothesis": () => (/* reexport safe */ _ServiceMessages_TranslationHypothesis__WEBPACK_IMPORTED_MODULE_20__.TranslationHypothesis),
/* harmony export */   "TranslationPhrase": () => (/* reexport safe */ _ServiceMessages_TranslationPhrase__WEBPACK_IMPORTED_MODULE_21__.TranslationPhrase),
/* harmony export */   "TranslationServiceRecognizer": () => (/* reexport safe */ _TranslationServiceRecognizer__WEBPACK_IMPORTED_MODULE_22__.TranslationServiceRecognizer),
/* harmony export */   "TranslationSynthesisEnd": () => (/* reexport safe */ _ServiceMessages_TranslationSynthesisEnd__WEBPACK_IMPORTED_MODULE_19__.TranslationSynthesisEnd),
/* harmony export */   "VoiceProfileConnectionFactory": () => (/* reexport safe */ _SpeakerRecognitionConnectionFactory__WEBPACK_IMPORTED_MODULE_6__.VoiceProfileConnectionFactory),
/* harmony export */   "VoiceServiceRecognizer": () => (/* reexport safe */ _VoiceServiceRecognizer__WEBPACK_IMPORTED_MODULE_49__.VoiceServiceRecognizer),
/* harmony export */   "WebsocketMessageFormatter": () => (/* reexport safe */ _WebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_12__.WebsocketMessageFormatter),
/* harmony export */   "connectivity": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.connectivity),
/* harmony export */   "type": () => (/* reexport safe */ _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__.type)
/* harmony export */ });
/* harmony import */ var _CognitiveSubscriptionKeyAuthentication__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CognitiveSubscriptionKeyAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js");
/* harmony import */ var _CognitiveTokenAuthentication__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CognitiveTokenAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _IAuthentication__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./IAuthentication */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js");
/* harmony import */ var _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./IConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IConnectionFactory.js");
/* harmony import */ var _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _IConnectionFactory__WEBPACK_IMPORTED_MODULE_3__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ISynthesisConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ISynthesisConnectionFactory.js");
/* harmony import */ var _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _ISynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_4__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _IntentConnectionFactory__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./IntentConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js");
/* harmony import */ var _SpeakerRecognitionConnectionFactory__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SpeakerRecognitionConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js");
/* harmony import */ var _RecognitionEvents__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./RecognitionEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js");
/* harmony import */ var _ServiceRecognizerBase__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ServiceRecognizerBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _ConversationServiceRecognizer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ConversationServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js");
/* harmony import */ var _RecognizerConfig__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./RecognizerConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./SpeechServiceInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceInterfaces.js");
/* harmony import */ var _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo","IntentConnectionFactory","SpeakerRecognitionConnectionFactory","VoiceProfileConnectionFactory","ConnectingToServiceEvent","ListeningStartedEvent","RecognitionCompletionStatus","RecognitionEndedEvent","RecognitionStartedEvent","RecognitionTriggeredEvent","SpeechRecognitionEvent","ServiceRecognizerBase","ConversationServiceRecognizer","Context","Device","OS","RecognitionMode","RecognizerConfig","SpeechResultFormat","SpeechServiceConfig","System","connectivity","type"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _SpeechServiceInterfaces__WEBPACK_IMPORTED_MODULE_11__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _WebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./WebsocketMessageFormatter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _SpeechConnectionFactory__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SpeechConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js");
/* harmony import */ var _TranscriberConnectionFactory__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./TranscriberConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js");
/* harmony import */ var _TranslationConnectionFactory__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./TranslationConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js");
/* harmony import */ var _SpeechSynthesisConnectionFactory__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./SpeechSynthesisConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js");
/* harmony import */ var _EnumTranslation__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./EnumTranslation */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _ServiceMessages_Enums__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./ServiceMessages/Enums */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _ServiceMessages_TranslationSynthesisEnd__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ServiceMessages/TranslationSynthesisEnd */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js");
/* harmony import */ var _ServiceMessages_TranslationHypothesis__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./ServiceMessages/TranslationHypothesis */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js");
/* harmony import */ var _ServiceMessages_TranslationPhrase__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./ServiceMessages/TranslationPhrase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js");
/* harmony import */ var _TranslationServiceRecognizer__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./TranslationServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js");
/* harmony import */ var _ServiceMessages_SpeechDetected__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./ServiceMessages/SpeechDetected */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js");
/* harmony import */ var _ServiceMessages_SpeechHypothesis__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./ServiceMessages/SpeechHypothesis */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _ServiceMessages_SpeechKeyword__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./ServiceMessages/SpeechKeyword */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js");
/* harmony import */ var _SpeechServiceRecognizer__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./SpeechServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js");
/* harmony import */ var _TranscriptionServiceRecognizer__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./TranscriptionServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js");
/* harmony import */ var _ServiceMessages_DetailedSpeechPhrase__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./ServiceMessages/DetailedSpeechPhrase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js");
/* harmony import */ var _ServiceMessages_SimpleSpeechPhrase__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./ServiceMessages/SimpleSpeechPhrase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _AddedLmIntent__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./AddedLmIntent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js");
/* harmony import */ var _IntentServiceRecognizer__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./IntentServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js");
/* harmony import */ var _ServiceMessages_IntentResponse__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./ServiceMessages/IntentResponse */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js");
/* harmony import */ var _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./ServiceMessages/SpeakerResponse */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeakerResponse.js");
/* harmony import */ var _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33___default = /*#__PURE__*/__webpack_require__.n(_ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo","IntentConnectionFactory","SpeakerRecognitionConnectionFactory","VoiceProfileConnectionFactory","ConnectingToServiceEvent","ListeningStartedEvent","RecognitionCompletionStatus","RecognitionEndedEvent","RecognitionStartedEvent","RecognitionTriggeredEvent","SpeechRecognitionEvent","ServiceRecognizerBase","ConversationServiceRecognizer","Context","Device","OS","RecognitionMode","RecognizerConfig","SpeechResultFormat","SpeechServiceConfig","System","connectivity","type","WebsocketMessageFormatter","SpeechConnectionFactory","TranscriberConnectionFactory","TranslationConnectionFactory","SpeechSynthesisConnectionFactory","EnumTranslation","RecognitionStatus","SynthesisStatus","TranslationSynthesisEnd","TranslationHypothesis","TranslationPhrase","TranslationServiceRecognizer","SpeechDetected","SpeechHypothesis","SpeechKeyword","SpeechServiceRecognizer","TranscriptionServiceRecognizer","DetailedSpeechPhrase","SimpleSpeechPhrase","AddedLmIntent","IntentServiceRecognizer","IntentResponse"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _ServiceMessages_SpeakerResponse__WEBPACK_IMPORTED_MODULE_33__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _RequestSession__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./RequestSession */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js");
/* harmony import */ var _SpeechContext__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./SpeechContext */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js");
/* harmony import */ var _DynamicGrammarBuilder__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./DynamicGrammarBuilder */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js");
/* harmony import */ var _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./DynamicGrammarInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarInterfaces.js");
/* harmony import */ var _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(_DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__);
/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};
/* harmony reexport (unknown) */ for(const __WEBPACK_IMPORT_KEY__ in _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__) if(["default","OutputFormatPropertyName","CancellationErrorCodePropertyName","ServicePropertiesPropertyName","ForceDictationPropertyName","AutoDetectSourceLanguagesOpenRangeOptionName","CognitiveSubscriptionKeyAuthentication","CognitiveTokenAuthentication","AuthInfo","IntentConnectionFactory","SpeakerRecognitionConnectionFactory","VoiceProfileConnectionFactory","ConnectingToServiceEvent","ListeningStartedEvent","RecognitionCompletionStatus","RecognitionEndedEvent","RecognitionStartedEvent","RecognitionTriggeredEvent","SpeechRecognitionEvent","ServiceRecognizerBase","ConversationServiceRecognizer","Context","Device","OS","RecognitionMode","RecognizerConfig","SpeechResultFormat","SpeechServiceConfig","System","connectivity","type","WebsocketMessageFormatter","SpeechConnectionFactory","TranscriberConnectionFactory","TranslationConnectionFactory","SpeechSynthesisConnectionFactory","EnumTranslation","RecognitionStatus","SynthesisStatus","TranslationSynthesisEnd","TranslationHypothesis","TranslationPhrase","TranslationServiceRecognizer","SpeechDetected","SpeechHypothesis","SpeechKeyword","SpeechServiceRecognizer","TranscriptionServiceRecognizer","DetailedSpeechPhrase","SimpleSpeechPhrase","AddedLmIntent","IntentServiceRecognizer","IntentResponse","RequestSession","SpeechContext","DynamicGrammarBuilder"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = () => _DynamicGrammarInterfaces__WEBPACK_IMPORTED_MODULE_37__[__WEBPACK_IMPORT_KEY__]
/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);
/* harmony import */ var _DialogServiceAdapter__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./DialogServiceAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js");
/* harmony import */ var _AgentConfig__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./AgentConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/Exports.js");
/* harmony import */ var _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./ServiceMessages/SynthesisAudioMetadata */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js");
/* harmony import */ var _SynthesisTurn__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./SynthesisTurn */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js");
/* harmony import */ var _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./SynthesisAdapterBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _SynthesisRestAdapter__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./SynthesisRestAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js");
/* harmony import */ var _SynthesizerConfig__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./SynthesizerConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js");
/* harmony import */ var _SynthesisContext__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./SynthesisContext */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js");
/* harmony import */ var _SpeakerRecognitionConfig__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./SpeakerRecognitionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConfig.js");
/* harmony import */ var _SpeakerServiceRecognizer__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./SpeakerServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js");
/* harmony import */ var _VoiceServiceRecognizer__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./VoiceServiceRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Make sure not to export internal modules.
//


















































const OutputFormatPropertyName = "OutputFormat";
const CancellationErrorCodePropertyName = "CancellationErrorCode";
const ServicePropertiesPropertyName = "ServiceProperties";
const ForceDictationPropertyName = "ForceDictation";
const AutoDetectSourceLanguagesOpenRangeOptionName = "OpenRange";

//# sourceMappingURL=Exports.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HeaderNames": () => (/* binding */ HeaderNames)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class HeaderNames {
}
HeaderNames.AuthKey = "Ocp-Apim-Subscription-Key";
HeaderNames.Authorization = "Authorization";
HeaderNames.SpIDAuthKey = "Apim-Subscription-Id";
HeaderNames.ConnectionId = "X-ConnectionId";
HeaderNames.ContentType = "Content-Type";
HeaderNames.CustomCommandsAppId = "X-CommandsAppId";
HeaderNames.Path = "Path";
HeaderNames.RequestId = "X-RequestId";
HeaderNames.RequestStreamId = "X-StreamId";
HeaderNames.RequestTimestamp = "X-Timestamp";

//# sourceMappingURL=HeaderNames.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IAuthentication.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AuthInfo": () => (/* binding */ AuthInfo)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class AuthInfo {
    constructor(headerName, token) {
        this.privHeaderName = headerName;
        this.privToken = token;
    }
    get headerName() {
        return this.privHeaderName;
    }
    get token() {
        return this.privToken;
    }
}

//# sourceMappingURL=IAuthentication.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IConnectionFactory.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IConnectionFactory.js ***!
  \********************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=IConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ISynthesisConnectionFactory.js":
/*!*****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ISynthesisConnectionFactory.js ***!
  \*****************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=ISynthesisConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentConnectionFactory": () => (/* binding */ IntentConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.





class IntentConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint);
        if (!endpoint) {
            const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_IntentRegion);
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
            const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, "wss://" + region + ".sr.speech" + hostSuffix);
            endpoint = host + "/speech/recognition/interactive/cognitiveservices/v1";
        }
        const queryParams = {
            format: "simple",
            language: config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage),
        };
        this.setCommonUrlParams(config, queryParams, endpoint);
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    getSpeechRegionFromIntentRegion(intentRegion) {
        switch (intentRegion) {
            case "West US":
            case "US West":
            case "westus":
                return "uswest";
            case "West US 2":
            case "US West 2":
            case "westus2":
                return "uswest2";
            case "South Central US":
            case "US South Central":
            case "southcentralus":
                return "ussouthcentral";
            case "West Central US":
            case "US West Central":
            case "westcentralus":
                return "uswestcentral";
            case "East US":
            case "US East":
            case "eastus":
                return "useast";
            case "East US 2":
            case "US East 2":
            case "eastus2":
                return "useast2";
            case "West Europe":
            case "Europe West":
            case "westeurope":
                return "europewest";
            case "North Europe":
            case "Europe North":
            case "northeurope":
                return "europenorth";
            case "Brazil South":
            case "South Brazil":
            case "southbrazil":
                return "brazilsouth";
            case "Australia East":
            case "East Australia":
            case "eastaustralia":
                return "australiaeast";
            case "Southeast Asia":
            case "Asia Southeast":
            case "southeastasia":
                return "asiasoutheast";
            case "East Asia":
            case "Asia East":
            case "eastasia":
                return "asiaeast";
            default:
                return intentRegion;
        }
    }
}

//# sourceMappingURL=IntentConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentServiceRecognizer": () => (/* binding */ IntentServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



// eslint-disable-next-line max-classes-per-file
class IntentServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.privIntentRecognizer = recognizer;
        this.privIntentDataSent = false;
    }
    setIntents(addedIntents, umbrellaIntent) {
        this.privAddedLmIntents = addedIntents;
        this.privUmbrellaIntent = umbrellaIntent;
        this.privIntentDataSent = true;
    }
    processTypeSpecificMessages(connectionMessage) {
        let result;
        let ev;
        let processed = false;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_2__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        switch (connectionMessage.path.toLowerCase()) {
            case "speech.hypothesis":
                const speechHypothesis = _Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechHypothesis.fromJSON(connectionMessage.textBody);
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(undefined, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.RecognizingIntent, speechHypothesis.Text, speechHypothesis.Duration, speechHypothesis.Offset + this.privRequestSession.currentTurnAudioOffset, speechHypothesis.Language, speechHypothesis.LanguageDetectionConfidence, undefined, connectionMessage.textBody, resultProps);
                this.privRequestSession.onHypothesis(result.offset);
                ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(result, speechHypothesis.Offset + this.privRequestSession.currentTurnAudioOffset, this.privRequestSession.sessionId);
                if (!!this.privIntentRecognizer.recognizing) {
                    try {
                        this.privIntentRecognizer.recognizing(this.privIntentRecognizer, ev);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                processed = true;
                break;
            case "speech.phrase":
                const simple = _Exports__WEBPACK_IMPORTED_MODULE_8__.SimpleSpeechPhrase.fromJSON(connectionMessage.textBody);
                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(undefined, this.privRequestSession.requestId, _Exports__WEBPACK_IMPORTED_MODULE_9__.EnumTranslation.implTranslateRecognitionResult(simple.RecognitionStatus), simple.DisplayText, simple.Duration, simple.Offset + this.privRequestSession.currentTurnAudioOffset, simple.Language, simple.LanguageDetectionConfidence, undefined, connectionMessage.textBody, resultProps);
                ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(result, result.offset, this.privRequestSession.sessionId);
                const sendEvent = () => {
                    if (!!this.privIntentRecognizer.recognized) {
                        try {
                            this.privIntentRecognizer.recognized(this.privIntentRecognizer, ev);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    // report result to promise.
                    if (!!this.privSuccessCallback) {
                        try {
                            this.privSuccessCallback(result);
                        }
                        catch (e) {
                            if (!!this.privErrorCallback) {
                                this.privErrorCallback(e);
                            }
                        }
                        // Only invoke the call back once.
                        // and if it's successful don't invoke the
                        // error after that.
                        this.privSuccessCallback = undefined;
                        this.privErrorCallback = undefined;
                    }
                };
                // If intent data was sent, the terminal result for this recognizer is an intent being found.
                // If no intent data was sent, the terminal event is speech recognition being successful.
                if (false === this.privIntentDataSent || _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.NoMatch === ev.result.reason) {
                    // Advance the buffers.
                    this.privRequestSession.onPhraseRecognized(ev.offset + ev.result.duration);
                    sendEvent();
                }
                else {
                    // Squirrel away the args, when the response event arrives it will build upon them
                    // and then return
                    this.privPendingIntentArgs = ev;
                }
                processed = true;
                break;
            case "response":
                // Response from LUIS
                ev = this.privPendingIntentArgs;
                this.privPendingIntentArgs = undefined;
                if (undefined === ev) {
                    if ("" === connectionMessage.textBody) {
                        // This condition happens if there is nothing but silence in the
                        // audio sent to the service.
                        return;
                    }
                    // Odd... Not sure this can happen
                    ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(), 0, this.privRequestSession.sessionId);
                }
                const intentResponse = _Exports__WEBPACK_IMPORTED_MODULE_10__.IntentResponse.fromJSON(connectionMessage.textBody);
                // If LUIS didn't return anything, send the existing event, else
                // modify it to show the match.
                // See if the intent found is in the list of intents asked for.
                if (null !== intentResponse && !!intentResponse.topScoringIntent && !!intentResponse.topScoringIntent.intent) {
                    let addedIntent = this.privAddedLmIntents[intentResponse.topScoringIntent.intent];
                    if (this.privUmbrellaIntent !== undefined) {
                        addedIntent = this.privUmbrellaIntent;
                    }
                    if (!!addedIntent) {
                        const intentId = addedIntent === undefined || addedIntent.intentName === undefined ? intentResponse.topScoringIntent.intent : addedIntent.intentName;
                        let reason = ev.result.reason;
                        if (undefined !== intentId) {
                            reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.RecognizedIntent;
                        }
                        // make sure, properties is set.
                        const properties = (undefined !== ev.result.properties) ?
                            ev.result.properties : new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
                        properties.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.LanguageUnderstandingServiceResponse_JsonResult, connectionMessage.textBody);
                        ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentRecognitionEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(intentId, ev.result.resultId, reason, ev.result.text, ev.result.duration, ev.result.offset, undefined, undefined, ev.result.errorDetails, ev.result.json, properties), ev.offset, ev.sessionId);
                    }
                }
                this.privRequestSession.onPhraseRecognized(ev.offset + ev.result.duration);
                if (!!this.privIntentRecognizer.recognized) {
                    try {
                        this.privIntentRecognizer.recognized(this.privIntentRecognizer, ev);
                        /* eslint-disable no-empty */
                    }
                    catch (error) {
                        // Not going to let errors in the event handler
                        // trip things up.
                    }
                }
                // report result to promise.
                if (!!this.privSuccessCallback) {
                    try {
                        this.privSuccessCallback(ev.result);
                    }
                    catch (e) {
                        if (!!this.privErrorCallback) {
                            this.privErrorCallback(e);
                        }
                    }
                    // Only invoke the call back once.
                    // and if it's successful don't invoke the
                    // error after that.
                    this.privSuccessCallback = undefined;
                    this.privErrorCallback = undefined;
                }
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_11__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.CancellationErrorCode[errorCode]);
        if (!!this.privIntentRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.IntentRecognitionCanceledEventArgs(cancellationReason, error, errorCode, undefined, undefined, sessionId);
            try {
                this.privIntentRecognizer.canceled(this.privIntentRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.IntentRecognitionResult(undefined, // Intent Id
            requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ResultReason.Canceled, undefined, // Text
            undefined, // Duration
            undefined, // Offset
            undefined, // Language
            undefined, // LanguageDetectionConfidence
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                this.privSuccessCallback = undefined;
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
}

//# sourceMappingURL=IntentServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "QueryParameterNames": () => (/* binding */ QueryParameterNames)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class QueryParameterNames {
}
QueryParameterNames.BotId = "botid";
QueryParameterNames.CustomSpeechDeploymentId = "cid";
QueryParameterNames.CustomVoiceDeploymentId = "deploymentId";
QueryParameterNames.EnableAudioLogging = "storeAudio";
QueryParameterNames.EnableLanguageId = "lidEnabled";
QueryParameterNames.EnableWordLevelTimestamps = "wordLevelTimestamps";
QueryParameterNames.EndSilenceTimeoutMs = "endSilenceTimeoutMs";
QueryParameterNames.SegmentationSilenceTimeoutMs = "segmentationSilenceTimeoutMs";
QueryParameterNames.Format = "format";
QueryParameterNames.InitialSilenceTimeoutMs = "initialSilenceTimeoutMs";
QueryParameterNames.Language = "language";
QueryParameterNames.Profanity = "profanity";
QueryParameterNames.RequestBotStatusMessages = "enableBotMessageStatus";
QueryParameterNames.StableIntermediateThreshold = "stableIntermediateThreshold";
QueryParameterNames.StableTranslation = "stableTranslation";
QueryParameterNames.TestHooks = "testhooks";
QueryParameterNames.Postprocessing = "postprocessing";
QueryParameterNames.CtsMeetingId = "meetingId";
QueryParameterNames.CtsDeviceId = "deviceId";
QueryParameterNames.CtsIsParticipant = "isParticipant";

//# sourceMappingURL=QueryParameterNames.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectingToServiceEvent": () => (/* binding */ ConnectingToServiceEvent),
/* harmony export */   "ListeningStartedEvent": () => (/* binding */ ListeningStartedEvent),
/* harmony export */   "RecognitionCompletionStatus": () => (/* binding */ RecognitionCompletionStatus),
/* harmony export */   "RecognitionEndedEvent": () => (/* binding */ RecognitionEndedEvent),
/* harmony export */   "RecognitionStartedEvent": () => (/* binding */ RecognitionStartedEvent),
/* harmony export */   "RecognitionTriggeredEvent": () => (/* binding */ RecognitionTriggeredEvent),
/* harmony export */   "SpeechRecognitionEvent": () => (/* binding */ SpeechRecognitionEvent)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class SpeechRecognitionEvent extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, requestId, sessionId, eventType = _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privRequestId = requestId;
        this.privSessionId = sessionId;
    }
    get requestId() {
        return this.privRequestId;
    }
    get sessionId() {
        return this.privSessionId;
    }
}
class RecognitionTriggeredEvent extends SpeechRecognitionEvent {
    constructor(requestId, sessionId, audioSourceId, audioNodeId) {
        super("RecognitionTriggeredEvent", requestId, sessionId);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
}
class ListeningStartedEvent extends SpeechRecognitionEvent {
    constructor(requestId, sessionId, audioSourceId, audioNodeId) {
        super("ListeningStartedEvent", requestId, sessionId);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
}
class ConnectingToServiceEvent extends SpeechRecognitionEvent {
    constructor(requestId, authFetchEventid, sessionId) {
        super("ConnectingToServiceEvent", requestId, sessionId);
        this.privAuthFetchEventid = authFetchEventid;
    }
    get authFetchEventid() {
        return this.privAuthFetchEventid;
    }
}
class RecognitionStartedEvent extends SpeechRecognitionEvent {
    constructor(requestId, audioSourceId, audioNodeId, authFetchEventId, sessionId) {
        super("RecognitionStartedEvent", requestId, sessionId);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
        this.privAuthFetchEventId = authFetchEventId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
}
var RecognitionCompletionStatus;
(function (RecognitionCompletionStatus) {
    RecognitionCompletionStatus[RecognitionCompletionStatus["Success"] = 0] = "Success";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AudioSourceError"] = 1] = "AudioSourceError";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AudioSourceTimeout"] = 2] = "AudioSourceTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AuthTokenFetchError"] = 3] = "AuthTokenFetchError";
    RecognitionCompletionStatus[RecognitionCompletionStatus["AuthTokenFetchTimeout"] = 4] = "AuthTokenFetchTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["UnAuthorized"] = 5] = "UnAuthorized";
    RecognitionCompletionStatus[RecognitionCompletionStatus["ConnectTimeout"] = 6] = "ConnectTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["ConnectError"] = 7] = "ConnectError";
    RecognitionCompletionStatus[RecognitionCompletionStatus["ClientRecognitionActivityTimeout"] = 8] = "ClientRecognitionActivityTimeout";
    RecognitionCompletionStatus[RecognitionCompletionStatus["UnknownError"] = 9] = "UnknownError";
})(RecognitionCompletionStatus || (RecognitionCompletionStatus = {}));
class RecognitionEndedEvent extends SpeechRecognitionEvent {
    constructor(requestId, audioSourceId, audioNodeId, authFetchEventId, sessionId, serviceTag, status, error) {
        super("RecognitionEndedEvent", requestId, sessionId, status === RecognitionCompletionStatus.Success ? _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Info : _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
        this.privAuthFetchEventId = authFetchEventId;
        this.privStatus = status;
        this.privError = error;
        this.privServiceTag = serviceTag;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
    get serviceTag() {
        return this.privServiceTag;
    }
    get status() {
        return this.privStatus;
    }
    get error() {
        return this.privError;
    }
}

//# sourceMappingURL=RecognitionEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Context": () => (/* binding */ Context),
/* harmony export */   "Device": () => (/* binding */ Device),
/* harmony export */   "OS": () => (/* binding */ OS),
/* harmony export */   "RecognitionMode": () => (/* binding */ RecognitionMode),
/* harmony export */   "RecognizerConfig": () => (/* binding */ RecognizerConfig),
/* harmony export */   "SpeechResultFormat": () => (/* binding */ SpeechResultFormat),
/* harmony export */   "SpeechServiceConfig": () => (/* binding */ SpeechServiceConfig),
/* harmony export */   "System": () => (/* binding */ System),
/* harmony export */   "connectivity": () => (/* binding */ connectivity),
/* harmony export */   "type": () => (/* binding */ type)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

var RecognitionMode;
(function (RecognitionMode) {
    RecognitionMode[RecognitionMode["Interactive"] = 0] = "Interactive";
    RecognitionMode[RecognitionMode["Conversation"] = 1] = "Conversation";
    RecognitionMode[RecognitionMode["Dictation"] = 2] = "Dictation";
})(RecognitionMode || (RecognitionMode = {}));
var SpeechResultFormat;
(function (SpeechResultFormat) {
    SpeechResultFormat[SpeechResultFormat["Simple"] = 0] = "Simple";
    SpeechResultFormat[SpeechResultFormat["Detailed"] = 1] = "Detailed";
})(SpeechResultFormat || (SpeechResultFormat = {}));
class RecognizerConfig {
    constructor(speechServiceConfig, parameters) {
        this.privSpeechServiceConfig = speechServiceConfig ? speechServiceConfig : new SpeechServiceConfig(new Context(null));
        this.privParameters = parameters;
        this.privMaxRetryCount = parseInt(parameters.getProperty("SPEECH-Error-MaxRetryCount", "4"), 10);
        this.privLanguageIdMode = parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_LanguageIdMode, undefined);
    }
    get parameters() {
        return this.privParameters;
    }
    get recognitionMode() {
        return this.privRecognitionMode;
    }
    set recognitionMode(value) {
        this.privRecognitionMode = value;
        this.privRecognitionActivityTimeout = value === RecognitionMode.Interactive ? 8000 : 25000;
        this.privSpeechServiceConfig.Recognition = RecognitionMode[value];
    }
    get SpeechServiceConfig() {
        return this.privSpeechServiceConfig;
    }
    get recognitionActivityTimeout() {
        return this.privRecognitionActivityTimeout;
    }
    get isContinuousRecognition() {
        return this.privRecognitionMode !== RecognitionMode.Interactive;
    }
    get languageIdMode() {
        return this.privLanguageIdMode;
    }
    get autoDetectSourceLanguages() {
        return this.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, undefined);
    }
    get recognitionEndpointVersion() {
        return this.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion, undefined);
    }
    get sourceLanguageModels() {
        const models = [];
        let modelsExist = false;
        if (this.autoDetectSourceLanguages !== undefined) {
            for (const language of this.autoDetectSourceLanguages.split(",")) {
                const customProperty = language + _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EndpointId.toString();
                const modelId = this.parameters.getProperty(customProperty, undefined);
                if (modelId !== undefined) {
                    models.push({ language, endpoint: modelId });
                    modelsExist = true;
                }
                else {
                    models.push({ language, endpoint: "" });
                }
            }
        }
        return modelsExist ? models : undefined;
    }
    get maxRetryCount() {
        return this.privMaxRetryCount;
    }
}
// The config is serialized and sent as the Speech.Config
class SpeechServiceConfig {
    constructor(context) {
        this.context = context;
    }
    serialize() {
        return JSON.stringify(this, (key, value) => {
            if (value && typeof value === "object") {
                const replacement = {};
                for (const k in value) {
                    if (Object.hasOwnProperty.call(value, k)) {
                        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
                        replacement[k && k.charAt(0).toLowerCase() + k.substring(1)] = value[k];
                    }
                }
                return replacement;
            }
            return value;
        });
    }
    get Context() {
        return this.context;
    }
    get Recognition() {
        return this.recognition;
    }
    set Recognition(value) {
        this.recognition = value.toLowerCase();
    }
}
class Context {
    constructor(os) {
        this.system = new System();
        this.os = os;
    }
}
class System {
    constructor() {
        // Note: below will be patched for official builds.
        const SPEECHSDK_CLIENTSDK_VERSION = "1.30.1";
        this.name = "SpeechSDK";
        this.version = SPEECHSDK_CLIENTSDK_VERSION;
        this.build = "JavaScript";
        this.lang = "JavaScript";
    }
}
class OS {
    constructor(platform, name, version) {
        this.platform = platform;
        this.name = name;
        this.version = version;
    }
}
class Device {
    constructor(manufacturer, model, version) {
        this.manufacturer = manufacturer;
        this.model = model;
        this.version = version;
    }
}
var connectivity;
(function (connectivity) {
    connectivity["Bluetooth"] = "Bluetooth";
    connectivity["Wired"] = "Wired";
    connectivity["WiFi"] = "WiFi";
    connectivity["Cellular"] = "Cellular";
    connectivity["InBuilt"] = "InBuilt";
    connectivity["Unknown"] = "Unknown";
})(connectivity || (connectivity = {}));
var type;
(function (type) {
    type["Phone"] = "Phone";
    type["Speaker"] = "Speaker";
    type["Car"] = "Car";
    type["Headset"] = "Headset";
    type["Thermostat"] = "Thermostat";
    type["Microphones"] = "Microphones";
    type["Deskphone"] = "Deskphone";
    type["RemoteControl"] = "RemoteControl";
    type["Unknown"] = "Unknown";
    type["File"] = "File";
    type["Stream"] = "Stream";
})(type || (type = {}));

//# sourceMappingURL=RecognizerConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RequestSession": () => (/* binding */ RequestSession)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./RecognitionEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js");
/* harmony import */ var _ServiceTelemetryListener_Internal__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ServiceTelemetryListener.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceTelemetryListener.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class RequestSession {
    constructor(audioSourceId) {
        this.privIsDisposed = false;
        this.privDetachables = new Array();
        this.privIsAudioNodeDetached = false;
        this.privIsRecognizing = false;
        this.privIsSpeechEnded = false;
        this.privTurnStartAudioOffset = 0;
        this.privLastRecoOffset = 0;
        this.privHypothesisReceived = false;
        this.privBytesSent = 0;
        this.privRecogNumber = 0;
        this.privInTurn = false;
        this.privConnectionAttempts = 0;
        this.privAudioSourceId = audioSourceId;
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privAudioNodeId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        // We're not in a turn, so resolve.
        this.privTurnDeferral.resolve();
    }
    get sessionId() {
        return this.privSessionId;
    }
    get requestId() {
        return this.privRequestId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
    get turnCompletionPromise() {
        return this.privTurnDeferral.promise;
    }
    get isSpeechEnded() {
        return this.privIsSpeechEnded;
    }
    get isRecognizing() {
        return this.privIsRecognizing;
    }
    get currentTurnAudioOffset() {
        return this.privTurnStartAudioOffset;
    }
    get recogNumber() {
        return this.privRecogNumber;
    }
    get numConnectionAttempts() {
        return this.privConnectionAttempts;
    }
    // The number of bytes sent for the current connection.
    // Counter is reset to 0 each time a connection is established.
    get bytesSent() {
        return this.privBytesSent;
    }
    listenForServiceTelemetry(eventSource) {
        if (!!this.privServiceTelemetryListener) {
            this.privDetachables.push(eventSource.attachListener(this.privServiceTelemetryListener));
        }
    }
    startNewRecognition() {
        this.privIsSpeechEnded = false;
        this.privIsRecognizing = true;
        this.privTurnStartAudioOffset = 0;
        this.privLastRecoOffset = 0;
        this.privRecogNumber++;
        this.privServiceTelemetryListener = new _ServiceTelemetryListener_Internal__WEBPACK_IMPORTED_MODULE_2__.ServiceTelemetryListener(this.privRequestId, this.privAudioSourceId, this.privAudioNodeId);
        this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.RecognitionTriggeredEvent(this.requestId, this.privSessionId, this.privAudioSourceId, this.privAudioNodeId));
    }
    onAudioSourceAttachCompleted(audioNode, isError) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privAudioNode = audioNode;
            this.privIsAudioNodeDetached = false;
            if (isError) {
                yield this.onComplete();
            }
            else {
                this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.ListeningStartedEvent(this.privRequestId, this.privSessionId, this.privAudioSourceId, this.privAudioNodeId));
            }
        });
    }
    onPreConnectionStart(authFetchEventId, connectionId) {
        this.privAuthFetchEventId = authFetchEventId;
        this.privSessionId = connectionId;
        this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.ConnectingToServiceEvent(this.privRequestId, this.privAuthFetchEventId, this.privSessionId));
    }
    onAuthCompleted(isError) {
        return __awaiter(this, void 0, void 0, function* () {
            if (isError) {
                yield this.onComplete();
            }
        });
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    onConnectionEstablishCompleted(statusCode, reason) {
        return __awaiter(this, void 0, void 0, function* () {
            if (statusCode === 200) {
                this.onEvent(new _RecognitionEvents__WEBPACK_IMPORTED_MODULE_3__.RecognitionStartedEvent(this.requestId, this.privAudioSourceId, this.privAudioNodeId, this.privAuthFetchEventId, this.privSessionId));
                if (!!this.privAudioNode) {
                    this.privAudioNode.replay();
                }
                this.privTurnStartAudioOffset = this.privLastRecoOffset;
                this.privBytesSent = 0;
                return;
            }
            else if (statusCode === 403) {
                yield this.onComplete();
            }
        });
    }
    onServiceTurnEndResponse(continuousRecognition) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privTurnDeferral.resolve();
            if (!continuousRecognition || this.isSpeechEnded) {
                yield this.onComplete();
                this.privInTurn = false;
            }
            else {
                // Start a new request set.
                this.privTurnStartAudioOffset = this.privLastRecoOffset;
                this.privAudioNode.replay();
            }
        });
    }
    onSpeechContext() {
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
    }
    onServiceTurnStartResponse() {
        if (!!this.privTurnDeferral && !!this.privInTurn) {
            // What? How are we starting a turn with another not done?
            this.privTurnDeferral.reject("Another turn started before current completed.");
            // Avoid UnhandledPromiseRejection if privTurnDeferral is not being awaited
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            this.privTurnDeferral.promise.then().catch(() => { });
        }
        this.privInTurn = true;
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
    }
    onHypothesis(offset) {
        if (!this.privHypothesisReceived) {
            this.privHypothesisReceived = true;
            this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(offset));
        }
    }
    onPhraseRecognized(offset) {
        this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(offset));
        this.onServiceRecognized(offset);
    }
    onServiceRecognized(offset) {
        this.privLastRecoOffset = offset;
        this.privHypothesisReceived = false;
        this.privAudioNode.shrinkBuffers(offset);
        this.privConnectionAttempts = 0;
    }
    onAudioSent(bytesSent) {
        this.privBytesSent += bytesSent;
    }
    onRetryConnection() {
        this.privConnectionAttempts++;
    }
    dispose() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsDisposed) {
                // we should have completed by now. If we did not its an unknown error.
                this.privIsDisposed = true;
                for (const detachable of this.privDetachables) {
                    yield detachable.detach();
                }
                if (!!this.privServiceTelemetryListener) {
                    this.privServiceTelemetryListener.dispose();
                }
                this.privIsRecognizing = false;
            }
        });
    }
    getTelemetry() {
        if (this.privServiceTelemetryListener.hasTelemetry) {
            return this.privServiceTelemetryListener.getTelemetry();
        }
        else {
            return null;
        }
    }
    onStopRecognizing() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.onComplete();
        });
    }
    // Should be called with the audioNode for this session has indicated that it is out of speech.
    onSpeechEnded() {
        this.privIsSpeechEnded = true;
    }
    onEvent(event) {
        if (!!this.privServiceTelemetryListener) {
            this.privServiceTelemetryListener.onEvent(event);
        }
        _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Events.instance.onEvent(event);
    }
    onComplete() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privIsRecognizing) {
                this.privIsRecognizing = false;
                yield this.detachAudioNode();
            }
        });
    }
    detachAudioNode() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsAudioNodeDetached) {
                this.privIsAudioNodeDetached = true;
                if (this.privAudioNode) {
                    yield this.privAudioNode.detach();
                }
            }
        });
    }
}

//# sourceMappingURL=RequestSession.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/ActivityResponsePayload.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityPayloadResponse": () => (/* binding */ ActivityPayloadResponse),
/* harmony export */   "MessageDataStreamType": () => (/* binding */ MessageDataStreamType)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// response
class ActivityPayloadResponse {
    constructor(json) {
        this.privActivityResponse = JSON.parse(json);
    }
    static fromJSON(json) {
        return new ActivityPayloadResponse(json);
    }
    get conversationId() {
        return this.privActivityResponse.conversationId;
    }
    get messageDataStreamType() {
        return this.privActivityResponse.messageDataStreamType;
    }
    get messagePayload() {
        return this.privActivityResponse.messagePayload;
    }
    get version() {
        return this.privActivityResponse.version;
    }
}
var MessageDataStreamType;
(function (MessageDataStreamType) {
    MessageDataStreamType[MessageDataStreamType["None"] = 0] = "None";
    MessageDataStreamType[MessageDataStreamType["TextToSpeechAudio"] = 1] = "TextToSpeechAudio";
})(MessageDataStreamType || (MessageDataStreamType = {}));

//# sourceMappingURL=ActivityResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DetailedSpeechPhrase": () => (/* binding */ DetailedSpeechPhrase)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class DetailedSpeechPhrase {
    constructor(json) {
        this.privDetailedSpeechPhrase = JSON.parse(json);
        this.privDetailedSpeechPhrase.RecognitionStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionStatus[this.privDetailedSpeechPhrase.RecognitionStatus];
    }
    static fromJSON(json) {
        return new DetailedSpeechPhrase(json);
    }
    getJsonWithCorrectedOffsets(baseOffset) {
        if (!!this.privDetailedSpeechPhrase.NBest) {
            let firstWordOffset;
            for (const phrase of this.privDetailedSpeechPhrase.NBest) {
                if (!!phrase.Words && !!phrase.Words[0]) {
                    firstWordOffset = phrase.Words[0].Offset;
                    break;
                }
            }
            if (!!firstWordOffset && firstWordOffset < baseOffset) {
                const offset = baseOffset - firstWordOffset;
                for (const details of this.privDetailedSpeechPhrase.NBest) {
                    if (!!details.Words) {
                        for (const word of details.Words) {
                            word.Offset += offset;
                        }
                    }
                    if (!!details.DisplayWords) {
                        for (const word of details.DisplayWords) {
                            word.Offset += offset;
                        }
                    }
                }
            }
        }
        return JSON.stringify(this.privDetailedSpeechPhrase);
    }
    get RecognitionStatus() {
        return this.privDetailedSpeechPhrase.RecognitionStatus;
    }
    get NBest() {
        return this.privDetailedSpeechPhrase.NBest;
    }
    get Duration() {
        return this.privDetailedSpeechPhrase.Duration;
    }
    get Offset() {
        return this.privDetailedSpeechPhrase.Offset;
    }
    get Language() {
        return this.privDetailedSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privDetailedSpeechPhrase.PrimaryLanguage.Language;
    }
    get LanguageDetectionConfidence() {
        return this.privDetailedSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence;
    }
    get Text() {
        if (!!this.privDetailedSpeechPhrase.NBest && this.privDetailedSpeechPhrase.NBest[0]) {
            return this.privDetailedSpeechPhrase.NBest[0].Display || this.privDetailedSpeechPhrase.NBest[0].DisplayText;
        }
        return this.privDetailedSpeechPhrase.DisplayText;
    }
    get SpeakerId() {
        return this.privDetailedSpeechPhrase.SpeakerId;
    }
}

//# sourceMappingURL=DetailedSpeechPhrase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecognitionStatus": () => (/* binding */ RecognitionStatus),
/* harmony export */   "SynthesisStatus": () => (/* binding */ SynthesisStatus)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * @class SynthesisStatus
 * @private
 */
var SynthesisStatus;
(function (SynthesisStatus) {
    /**
     * The response contains valid audio data.
     * @member SynthesisStatus.Success
     */
    SynthesisStatus[SynthesisStatus["Success"] = 0] = "Success";
    /**
     * Indicates the end of audio data. No valid audio data is included in the message.
     * @member SynthesisStatus.SynthesisEnd
     */
    SynthesisStatus[SynthesisStatus["SynthesisEnd"] = 1] = "SynthesisEnd";
    /**
     * Indicates an error occurred during synthesis data processing.
     * @member SynthesisStatus.Error
     */
    SynthesisStatus[SynthesisStatus["Error"] = 2] = "Error";
})(SynthesisStatus || (SynthesisStatus = {}));
var RecognitionStatus;
(function (RecognitionStatus) {
    RecognitionStatus[RecognitionStatus["Success"] = 0] = "Success";
    RecognitionStatus[RecognitionStatus["NoMatch"] = 1] = "NoMatch";
    RecognitionStatus[RecognitionStatus["InitialSilenceTimeout"] = 2] = "InitialSilenceTimeout";
    RecognitionStatus[RecognitionStatus["BabbleTimeout"] = 3] = "BabbleTimeout";
    RecognitionStatus[RecognitionStatus["Error"] = 4] = "Error";
    RecognitionStatus[RecognitionStatus["EndOfDictation"] = 5] = "EndOfDictation";
    RecognitionStatus[RecognitionStatus["TooManyRequests"] = 6] = "TooManyRequests";
    RecognitionStatus[RecognitionStatus["BadRequest"] = 7] = "BadRequest";
    RecognitionStatus[RecognitionStatus["Forbidden"] = 8] = "Forbidden";
})(RecognitionStatus || (RecognitionStatus = {}));

//# sourceMappingURL=Enums.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/IntentResponse.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentResponse": () => (/* binding */ IntentResponse)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// response
class IntentResponse {
    constructor(json) {
        if (json === "") {
            this.privIntentResponse = {};
        }
        else {
            this.privIntentResponse = JSON.parse(json);
        }
    }
    static fromJSON(json) {
        return new IntentResponse(json);
    }
    get query() {
        return this.privIntentResponse.query;
    }
    get topScoringIntent() {
        return this.privIntentResponse.topScoringIntent;
    }
    get entities() {
        return this.privIntentResponse.entities;
    }
}

//# sourceMappingURL=IntentResponse.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js":
/*!************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js ***!
  \************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SimpleSpeechPhrase": () => (/* binding */ SimpleSpeechPhrase)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class SimpleSpeechPhrase {
    constructor(json) {
        this.privSimpleSpeechPhrase = JSON.parse(json);
        this.privSimpleSpeechPhrase.RecognitionStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionStatus[this.privSimpleSpeechPhrase.RecognitionStatus];
    }
    static fromJSON(json) {
        return new SimpleSpeechPhrase(json);
    }
    get RecognitionStatus() {
        return this.privSimpleSpeechPhrase.RecognitionStatus;
    }
    get DisplayText() {
        return this.privSimpleSpeechPhrase.DisplayText;
    }
    get Offset() {
        return this.privSimpleSpeechPhrase.Offset;
    }
    get Duration() {
        return this.privSimpleSpeechPhrase.Duration;
    }
    get Language() {
        return this.privSimpleSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privSimpleSpeechPhrase.PrimaryLanguage.Language;
    }
    get LanguageDetectionConfidence() {
        return this.privSimpleSpeechPhrase.PrimaryLanguage === undefined ? undefined : this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence;
    }
    get SpeakerId() {
        return this.privSimpleSpeechPhrase.SpeakerId;
    }
}

//# sourceMappingURL=SimpleSpeechPhrase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeakerResponse.js":
/*!*********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeakerResponse.js ***!
  \*********************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

//# sourceMappingURL=SpeakerResponse.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechDetected": () => (/* binding */ SpeechDetected)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class SpeechDetected {
    constructor(json) {
        this.privSpeechStartDetected = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SpeechDetected(json);
    }
    get Offset() {
        return this.privSpeechStartDetected.Offset;
    }
}

//# sourceMappingURL=SpeechDetected.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechHypothesis": () => (/* binding */ SpeechHypothesis)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class SpeechHypothesis {
    constructor(json) {
        this.privSpeechHypothesis = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SpeechHypothesis(json);
    }
    get Text() {
        return this.privSpeechHypothesis.Text;
    }
    get Offset() {
        return this.privSpeechHypothesis.Offset;
    }
    get Duration() {
        return this.privSpeechHypothesis.Duration;
    }
    get Language() {
        return this.privSpeechHypothesis.PrimaryLanguage === undefined ? undefined : this.privSpeechHypothesis.PrimaryLanguage.Language;
    }
    get LanguageDetectionConfidence() {
        return this.privSpeechHypothesis.PrimaryLanguage === undefined ? undefined : this.privSpeechHypothesis.PrimaryLanguage.Confidence;
    }
    get SpeakerId() {
        return this.privSpeechHypothesis.SpeakerId;
    }
}

//# sourceMappingURL=SpeechHypothesis.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechKeyword.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechKeyword": () => (/* binding */ SpeechKeyword)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class SpeechKeyword {
    constructor(json) {
        this.privSpeechKeyword = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SpeechKeyword(json);
    }
    get Status() {
        return this.privSpeechKeyword.Status;
    }
    get Text() {
        return this.privSpeechKeyword.Text;
    }
    get Offset() {
        return this.privSpeechKeyword.Offset;
    }
    get Duration() {
        return this.privSpeechKeyword.Duration;
    }
}

//# sourceMappingURL=SpeechKeyword.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js":
/*!****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MetadataType": () => (/* binding */ MetadataType),
/* harmony export */   "SynthesisAudioMetadata": () => (/* binding */ SynthesisAudioMetadata)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var MetadataType;
(function (MetadataType) {
    MetadataType["WordBoundary"] = "WordBoundary";
    MetadataType["Bookmark"] = "Bookmark";
    MetadataType["Viseme"] = "Viseme";
    MetadataType["SentenceBoundary"] = "SentenceBoundary";
    MetadataType["SessionEnd"] = "SessionEnd";
})(MetadataType || (MetadataType = {}));
class SynthesisAudioMetadata {
    constructor(json) {
        this.privSynthesisAudioMetadata = JSON.parse(json);
    }
    static fromJSON(json) {
        return new SynthesisAudioMetadata(json);
    }
    get Metadata() {
        return this.privSynthesisAudioMetadata.Metadata;
    }
}

//# sourceMappingURL=SynthesisAudioMetadata.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js":
/*!***************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js ***!
  \***************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationHypothesis": () => (/* binding */ TranslationHypothesis)
/* harmony export */ });
/* harmony import */ var _TranslationStatus__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../TranslationStatus */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class TranslationHypothesis {
    constructor(json) {
        this.privTranslationHypothesis = JSON.parse(json);
        this.privTranslationHypothesis.Translation.TranslationStatus = _TranslationStatus__WEBPACK_IMPORTED_MODULE_0__.TranslationStatus[this.privTranslationHypothesis.Translation.TranslationStatus];
    }
    static fromJSON(json) {
        return new TranslationHypothesis(json);
    }
    get Duration() {
        return this.privTranslationHypothesis.Duration;
    }
    get Offset() {
        return this.privTranslationHypothesis.Offset;
    }
    get Text() {
        return this.privTranslationHypothesis.Text;
    }
    get Translation() {
        return this.privTranslationHypothesis.Translation;
    }
}

//# sourceMappingURL=TranslationHypothesis.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationPhrase": () => (/* binding */ TranslationPhrase)
/* harmony export */ });
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _TranslationStatus__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../TranslationStatus */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class TranslationPhrase {
    constructor(phrase) {
        this.privTranslationPhrase = phrase;
        this.privTranslationPhrase.RecognitionStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionStatus[this.privTranslationPhrase.RecognitionStatus];
        if (this.privTranslationPhrase.Translation !== undefined) {
            this.privTranslationPhrase.Translation.TranslationStatus = _TranslationStatus__WEBPACK_IMPORTED_MODULE_1__.TranslationStatus[this.privTranslationPhrase.Translation.TranslationStatus];
        }
    }
    static fromJSON(json) {
        return new TranslationPhrase(JSON.parse(json));
    }
    static fromTranslationResponse(translationResponse) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(translationResponse, "translationResponse");
        const phrase = translationResponse.SpeechPhrase;
        translationResponse.SpeechPhrase = undefined;
        phrase.Translation = translationResponse;
        phrase.Text = phrase.DisplayText;
        return new TranslationPhrase(phrase);
    }
    get RecognitionStatus() {
        return this.privTranslationPhrase.RecognitionStatus;
    }
    get Offset() {
        return this.privTranslationPhrase.Offset;
    }
    get Duration() {
        return this.privTranslationPhrase.Duration;
    }
    get Text() {
        return this.privTranslationPhrase.Text;
    }
    get Language() {
        var _a;
        return (_a = this.privTranslationPhrase.PrimaryLanguage) === null || _a === void 0 ? void 0 : _a.Language;
    }
    get Confidence() {
        var _a;
        return (_a = this.privTranslationPhrase.PrimaryLanguage) === null || _a === void 0 ? void 0 : _a.Confidence;
    }
    get Translation() {
        return this.privTranslationPhrase.Translation;
    }
}

//# sourceMappingURL=TranslationPhrase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationSynthesisEnd": () => (/* binding */ TranslationSynthesisEnd)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class TranslationSynthesisEnd {
    constructor(json) {
        this.privSynthesisEnd = JSON.parse(json);
        if (!!this.privSynthesisEnd.SynthesisStatus) {
            this.privSynthesisEnd.SynthesisStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus];
        }
        if (!!this.privSynthesisEnd.Status) {
            this.privSynthesisEnd.SynthesisStatus = _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisStatus[this.privSynthesisEnd.Status];
        }
    }
    static fromJSON(json) {
        return new TranslationSynthesisEnd(json);
    }
    get SynthesisStatus() {
        return this.privSynthesisEnd.SynthesisStatus;
    }
    get FailureReason() {
        return this.privSynthesisEnd.FailureReason;
    }
}

//# sourceMappingURL=TranslationSynthesisEnd.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TurnStatusPayload.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TurnStatusPayload.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TurnStatusResponsePayload": () => (/* binding */ TurnStatusResponsePayload)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class TurnStatusResponsePayload {
    constructor(json) {
        this.privMessageStatusResponse = JSON.parse(json);
    }
    static fromJSON(json) {
        return new TurnStatusResponsePayload(json);
    }
    get interactionId() {
        return this.privMessageStatusResponse.interactionId;
    }
    get conversationId() {
        return this.privMessageStatusResponse.conversationId;
    }
    get statusCode() {
        // Payloads may contain a limited set of textual representations or a numeric status
        // code. The textual values are here converted into numeric ones.
        switch (this.privMessageStatusResponse.statusCode) {
            case "Success":
                return 200;
            case "Failed":
                return 400;
            case "TimedOut":
                return 429;
            default:
                // eslint-disable-next-line @typescript-eslint/no-unsafe-return
                return this.privMessageStatusResponse.statusCode;
        }
    }
}

//# sourceMappingURL=TurnStatusPayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServiceRecognizerBase": () => (/* binding */ ServiceRecognizerBase)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RequestSession.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DynamicGrammarBuilder.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechDetected.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        // A promise for a configured connection.
        // Do not consume directly, call fetchConnection instead.
        this.privConnectionConfigurationPromise = undefined;
        // A promise for a connection, but one that has not had the speech context sent yet.
        // Do not consume directly, call fetchConnection instead.
        this.privConnectionPromise = undefined;
        this.privSetTimeout = setTimeout;
        this.privIsLiveAudio = false;
        this.recognizeOverride = undefined;
        this.recognizeSpeaker = undefined;
        this.disconnectOverride = undefined;
        this.receiveMessageOverride = undefined;
        this.sendPrePayloadJSONOverride = undefined;
        this.postConnectImplOverride = undefined;
        this.configConnectionOverride = undefined;
        this.handleSpeechPhraseMessage = undefined;
        this.handleSpeechHypothesisMessage = undefined;
        if (!authentication) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("authentication");
        }
        if (!connectionFactory) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("connectionFactory");
        }
        if (!audioSource) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("audioSource");
        }
        if (!recognizerConfig) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("recognizerConfig");
        }
        this.privMustReportEndOfStream = false;
        this.privAuthentication = authentication;
        this.privConnectionFactory = connectionFactory;
        this.privAudioSource = audioSource;
        this.privRecognizerConfig = recognizerConfig;
        this.privIsDisposed = false;
        this.privRecognizer = recognizer;
        this.privRequestSession = new _Exports__WEBPACK_IMPORTED_MODULE_1__.RequestSession(this.privAudioSource.id());
        this.privConnectionEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privServiceEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privDynamicGrammar = new _Exports__WEBPACK_IMPORTED_MODULE_3__.DynamicGrammarBuilder();
        this.privSpeechContext = new _Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechContext(this.privDynamicGrammar);
        this.privAgentConfig = new _Exports__WEBPACK_IMPORTED_MODULE_5__.AgentConfig();
        if (typeof (Blob) !== "undefined" && typeof (Worker) !== "undefined") {
            this.privSetTimeout = _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Timeout.setTimeout;
        }
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionClosedEvent") {
                const connectionClosedEvent = connectionEvent;
                if (connectionClosedEvent.statusCode === 1003 ||
                    connectionClosedEvent.statusCode === 1007 ||
                    connectionClosedEvent.statusCode === 1002 ||
                    connectionClosedEvent.statusCode === 4000 ||
                    this.privRequestSession.numConnectionAttempts > this.privRecognizerConfig.maxRetryCount) {
                    void this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, connectionClosedEvent.statusCode === 1007 ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.BadRequestParameters : _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.ConnectionFailure, `${connectionClosedEvent.reason} websocket error code: ${connectionClosedEvent.statusCode}`);
                }
            }
        });
        const phraseDetection = {};
        if (recognizerConfig.autoDetectSourceLanguages !== undefined) {
            const sourceLanguages = recognizerConfig.autoDetectSourceLanguages.split(",");
            let speechContextLidMode;
            if (recognizerConfig.languageIdMode === "Continuous") {
                speechContextLidMode = "DetectContinuous";
            }
            else { // recognizerConfig.languageIdMode === "AtStart"
                speechContextLidMode = "DetectAtAudioStart";
            }
            this.privSpeechContext.setSection("languageId", {
                Priority: "PrioritizeLatency",
                languages: sourceLanguages,
                mode: speechContextLidMode,
                onSuccess: { action: "Recognize" },
                onUnknown: { action: "None" }
            });
            this.privSpeechContext.setSection("phraseOutput", {
                interimResults: {
                    resultType: "Auto"
                },
                phraseResults: {
                    resultType: "Always"
                }
            });
            const customModels = recognizerConfig.sourceLanguageModels;
            if (customModels !== undefined) {
                phraseDetection.customModels = customModels;
                phraseDetection.onInterim = { action: "None" };
                phraseDetection.onSuccess = { action: "None" };
            }
        }
        const isEmpty = (obj) => {
            // eslint-disable-next-line guard-for-in, brace-style
            for (const x in obj) {
                return false;
            }
            return true;
        };
        if (!isEmpty(phraseDetection)) {
            this.privSpeechContext.setSection("phraseDetection", phraseDetection);
        }
    }
    setSpeechSegmentationTimeout() {
        const speechSegmentationTimeout = this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.Speech_SegmentationSilenceTimeoutMs, undefined);
        if (speechSegmentationTimeout !== undefined) {
            const mode = this.recognitionMode === _Exports__WEBPACK_IMPORTED_MODULE_10__.RecognitionMode.Conversation ? "CONVERSATION" :
                this.recognitionMode === _Exports__WEBPACK_IMPORTED_MODULE_10__.RecognitionMode.Dictation ? "DICTATION" : "INTERACTIVE";
            const segmentationSilenceTimeoutMs = parseInt(speechSegmentationTimeout, 10);
            const phraseDetection = this.privSpeechContext.getSection("phraseDetection");
            phraseDetection.mode = mode;
            phraseDetection[mode] = {
                segmentation: {
                    mode: "Custom",
                    segmentationSilenceTimeoutMs
                }
            };
            this.privSpeechContext.setSection("phraseDetection", phraseDetection);
        }
    }
    get audioSource() {
        return this.privAudioSource;
    }
    get speechContext() {
        return this.privSpeechContext;
    }
    get dynamicGrammar() {
        return this.privDynamicGrammar;
    }
    get agentConfig() {
        return this.privAgentConfig;
    }
    set conversationTranslatorToken(token) {
        this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.ConversationTranslator_Token, token);
    }
    set voiceProfileType(type) {
        this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_SpeakerIdMode, type);
    }
    set authentication(auth) {
        this.privAuthentication = this.authentication;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose(reason) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privIsDisposed = true;
            if (this.privConnectionConfigurationPromise !== undefined) {
                try {
                    const connection = yield this.privConnectionConfigurationPromise;
                    yield connection.dispose(reason);
                }
                catch (error) {
                    // The connection is in a bad state. But we're trying to kill it, so...
                    return;
                }
            }
        });
    }
    get connectionEvents() {
        return this.privConnectionEvents;
    }
    get serviceEvents() {
        return this.privServiceEvents;
    }
    get recognitionMode() {
        return this.privRecognizerConfig.recognitionMode;
    }
    recognize(recoMode, successCallback, errorCallBack) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.recognizeOverride !== undefined) {
                yield this.recognizeOverride(recoMode, successCallback, errorCallBack);
                return;
            }
            // Clear the existing configuration promise to force a re-transmission of config and context.
            this.privConnectionConfigurationPromise = undefined;
            this.privRecognizerConfig.recognitionMode = recoMode;
            this.setSpeechSegmentationTimeout();
            this.privSuccessCallback = successCallback;
            this.privErrorCallback = errorCallBack;
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            let audioNode;
            try {
                const audioStreamNode = yield this.audioSource.attach(this.privRequestSession.audioNodeId);
                const format = yield this.audioSource.format;
                const deviceInfo = yield this.audioSource.deviceInfo;
                this.privIsLiveAudio = deviceInfo.type && deviceInfo.type === _Exports__WEBPACK_IMPORTED_MODULE_10__.type.Microphones;
                audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__.ReplayableAudioNode(audioStreamNode, format.avgBytesPerSec);
                yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
                this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            }
            catch (error) {
                yield this.privRequestSession.onStopRecognizing();
                throw error;
            }
            try {
                yield conPromise;
            }
            catch (error) {
                yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.ConnectionFailure, error);
                return;
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            void this.receiveMessage();
            const audioSendPromise = this.sendAudio(audioNode);
            audioSendPromise.catch((error) => __awaiter(this, void 0, void 0, function* () {
                yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.RuntimeError, error);
            }));
            return;
        });
    }
    stopRecognizing() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privRequestSession.isRecognizing) {
                try {
                    yield this.audioSource.turnOff();
                    yield this.sendFinalAudio();
                    yield this.privRequestSession.onStopRecognizing();
                    yield this.privRequestSession.turnCompletionPromise;
                }
                finally {
                    yield this.privRequestSession.dispose();
                }
            }
            return;
        });
    }
    connect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.connectImpl();
            return Promise.resolve();
        });
    }
    connectAsync(cb, err) {
        this.connectImpl().then(() => {
            try {
                if (!!cb) {
                    cb();
                }
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
        }, (reason) => {
            try {
                if (!!err) {
                    err(reason);
                }
                /* eslint-disable no-empty */
            }
            catch (error) {
            }
        });
    }
    disconnect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.NoError, "Disconnecting");
            if (this.disconnectOverride !== undefined) {
                yield this.disconnectOverride();
            }
            if (this.privConnectionPromise !== undefined) {
                try {
                    yield (yield this.privConnectionPromise).dispose();
                }
                catch (error) {
                }
            }
            this.privConnectionPromise = undefined;
        });
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    sendMessage(message) {
        return;
    }
    sendNetworkMessage(path, payload) {
        return __awaiter(this, void 0, void 0, function* () {
            const type = typeof payload === "string" ? _common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text : _common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary;
            const contentType = typeof payload === "string" ? "application/json" : "";
            const connection = yield this.fetchConnection();
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(type, path, this.privRequestSession.requestId, contentType, payload));
        });
    }
    set activityTemplate(messagePayload) {
        this.privActivityTemplate = messagePayload;
    }
    get activityTemplate() {
        return this.privActivityTemplate;
    }
    sendTelemetryData() {
        return __awaiter(this, void 0, void 0, function* () {
            const telemetryData = this.privRequestSession.getTelemetry();
            if (ServiceRecognizerBase.telemetryDataEnabled !== true ||
                this.privIsDisposed ||
                null === telemetryData) {
                return;
            }
            if (!!ServiceRecognizerBase.telemetryData) {
                try {
                    ServiceRecognizerBase.telemetryData(telemetryData);
                    /* eslint-disable no-empty */
                }
                catch (_a) { }
            }
            const connection = yield this.fetchConnection();
            yield connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text, "telemetry", this.privRequestSession.requestId, "application/json", telemetryData));
        });
    }
    // Cancels recognition.
    cancelRecognitionLocal(cancellationReason, errorCode, error) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privRequestSession.isRecognizing) {
                yield this.privRequestSession.onStopRecognizing();
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, cancellationReason, errorCode, error);
            }
        });
    }
    receiveMessage() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                if (this.privIsDisposed) {
                    // We're done.
                    return;
                }
                let connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (this.receiveMessageOverride !== undefined) {
                    return this.receiveMessageOverride();
                }
                // indicates we are draining the queue and it came with no message;
                if (!message) {
                    if (!this.privRequestSession.isRecognizing) {
                        return;
                    }
                    else {
                        return this.receiveMessage();
                    }
                }
                this.privServiceHasSentMessage = true;
                const connectionMessage = _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage.fromConnectionMessage(message);
                if (connectionMessage.requestId.toLowerCase() === this.privRequestSession.requestId.toLowerCase()) {
                    switch (connectionMessage.path.toLowerCase()) {
                        case "turn.start":
                            this.privMustReportEndOfStream = true;
                            this.privRequestSession.onServiceTurnStartResponse();
                            break;
                        case "speech.startdetected":
                            const speechStartDetected = _Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechDetected.fromJSON(connectionMessage.textBody);
                            const speechStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.RecognitionEventArgs(speechStartDetected.Offset, this.privRequestSession.sessionId);
                            if (!!this.privRecognizer.speechStartDetected) {
                                this.privRecognizer.speechStartDetected(this.privRecognizer, speechStartEventArgs);
                            }
                            break;
                        case "speech.enddetected":
                            let json;
                            if (connectionMessage.textBody.length > 0) {
                                json = connectionMessage.textBody;
                            }
                            else {
                                // If the request was empty, the JSON returned is empty.
                                json = "{ Offset: 0 }";
                            }
                            const speechStopDetected = _Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechDetected.fromJSON(json);
                            const speechStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.RecognitionEventArgs(speechStopDetected.Offset + this.privRequestSession.currentTurnAudioOffset, this.privRequestSession.sessionId);
                            if (!!this.privRecognizer.speechEndDetected) {
                                this.privRecognizer.speechEndDetected(this.privRecognizer, speechStopEventArgs);
                            }
                            break;
                        case "turn.end":
                            yield this.sendTelemetryData();
                            if (this.privRequestSession.isSpeechEnded && this.privMustReportEndOfStream) {
                                this.privMustReportEndOfStream = false;
                                yield this.cancelRecognitionLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationReason.EndOfStream, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.NoError, undefined);
                            }
                            const sessionStopEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.SessionEventArgs(this.privRequestSession.sessionId);
                            yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition);
                            if (!this.privRecognizerConfig.isContinuousRecognition || this.privRequestSession.isSpeechEnded || !this.privRequestSession.isRecognizing) {
                                if (!!this.privRecognizer.sessionStopped) {
                                    this.privRecognizer.sessionStopped(this.privRecognizer, sessionStopEventArgs);
                                }
                                return;
                            }
                            else {
                                connection = yield this.fetchConnection();
                                yield this.sendPrePayloadJSON(connection);
                            }
                            break;
                        default:
                            if (!(yield this.processTypeSpecificMessages(connectionMessage))) {
                                // here are some messages that the derived class has not processed, dispatch them to connect class
                                if (!!this.privServiceEvents) {
                                    this.serviceEvents.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_17__.ServiceEvent(connectionMessage.path.toLowerCase(), connectionMessage.textBody));
                                }
                            }
                    }
                }
                return this.receiveMessage();
            }
            catch (error) {
                return null;
            }
        });
    }
    sendSpeechContext(connection, generateNewRequestId) {
        const speechContextJson = this.speechContext.toJSON();
        if (generateNewRequestId) {
            this.privRequestSession.onSpeechContext();
        }
        if (speechContextJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text, "speech.context", this.privRequestSession.requestId, "application/json", speechContextJson));
        }
        return;
    }
    noOp() {
        // operation not supported
        return;
    }
    // Encapsulated for derived service recognizers that need to send additional JSON
    sendPrePayloadJSON(connection, generateNewRequestId = true) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.sendPrePayloadJSONOverride !== undefined) {
                return this.sendPrePayloadJSONOverride(connection);
            }
            yield this.sendSpeechContext(connection, generateNewRequestId);
            yield this.sendWaveHeader(connection);
            return;
        });
    }
    sendWaveHeader(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            const format = yield this.audioSource.format;
            // this.writeBufferToConsole(format.header);
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary, "audio", this.privRequestSession.requestId, "audio/x-wav", format.header));
        });
    }
    // Establishes a websocket connection to the end point.
    connectImpl() {
        if (this.privConnectionPromise !== undefined) {
            return this.privConnectionPromise.then((connection) => {
                if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ConnectionState.Disconnected) {
                    this.privConnectionId = null;
                    this.privConnectionPromise = undefined;
                    this.privServiceHasSentMessage = false;
                    return this.connectImpl();
                }
                return this.privConnectionPromise;
            }, () => {
                this.privConnectionId = null;
                this.privConnectionPromise = undefined;
                this.privServiceHasSentMessage = false;
                return this.connectImpl();
            });
        }
        this.privConnectionPromise = this.retryableConnect();
        // Attach an empty handler to allow the promise to run in the background while
        // other startup events happen. It'll eventually be awaited on.
        // eslint-disable-next-line @typescript-eslint/no-empty-function
        this.privConnectionPromise.catch(() => { });
        if (this.postConnectImplOverride !== undefined) {
            return this.postConnectImplOverride(this.privConnectionPromise);
        }
        return this.privConnectionPromise;
    }
    sendSpeechServiceConfig(connection, requestSession, SpeechServiceConfigJson) {
        requestSession.onSpeechContext();
        // filter out anything that is not required for the service to work.
        if (ServiceRecognizerBase.telemetryDataEnabled !== true) {
            const withTelemetry = JSON.parse(SpeechServiceConfigJson);
            const replacement = {
                context: {
                    system: withTelemetry.context.system,
                },
            };
            SpeechServiceConfigJson = JSON.stringify(replacement);
        }
        if (this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2", "false").toLowerCase() === "true") {
            const json = JSON.parse(SpeechServiceConfigJson);
            json.context.DisableReferenceChannel = "True";
            json.context.MicSpec = "1_0_0";
            SpeechServiceConfigJson = JSON.stringify(json);
        }
        if (SpeechServiceConfigJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Text, "speech.config", requestSession.requestId, "application/json", SpeechServiceConfigJson));
        }
        return;
    }
    fetchConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privConnectionConfigurationPromise !== undefined) {
                return this.privConnectionConfigurationPromise.then((connection) => {
                    if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ConnectionState.Disconnected) {
                        this.privConnectionId = null;
                        this.privConnectionConfigurationPromise = undefined;
                        this.privServiceHasSentMessage = false;
                        return this.fetchConnection();
                    }
                    return this.privConnectionConfigurationPromise;
                }, () => {
                    this.privConnectionId = null;
                    this.privConnectionConfigurationPromise = undefined;
                    this.privServiceHasSentMessage = false;
                    return this.fetchConnection();
                });
            }
            this.privConnectionConfigurationPromise = this.configureConnection();
            return yield this.privConnectionConfigurationPromise;
        });
    }
    sendAudio(audioStreamNode) {
        return __awaiter(this, void 0, void 0, function* () {
            const audioFormat = yield this.audioSource.format;
            // The time we last sent data to the service.
            let nextSendTime = Date.now();
            // Max amount to send before we start to throttle
            const fastLaneSizeMs = this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs", "5000");
            const maxSendUnthrottledBytes = audioFormat.avgBytesPerSec / 1000 * parseInt(fastLaneSizeMs, 10);
            const startRecogNumber = this.privRequestSession.recogNumber;
            const readAndUploadCycle = () => __awaiter(this, void 0, void 0, function* () {
                // If speech is done, stop sending audio.
                if (!this.privIsDisposed &&
                    !this.privRequestSession.isSpeechEnded &&
                    this.privRequestSession.isRecognizing &&
                    this.privRequestSession.recogNumber === startRecogNumber) {
                    const connection = yield this.fetchConnection();
                    const audioStreamChunk = yield audioStreamNode.read();
                    // we have a new audio chunk to upload.
                    if (this.privRequestSession.isSpeechEnded) {
                        // If service already recognized audio end then don't send any more audio
                        return;
                    }
                    let payload;
                    let sendDelay;
                    if (!audioStreamChunk || audioStreamChunk.isEnd) {
                        payload = null;
                        sendDelay = 0;
                    }
                    else {
                        payload = audioStreamChunk.buffer;
                        this.privRequestSession.onAudioSent(payload.byteLength);
                        if (maxSendUnthrottledBytes >= this.privRequestSession.bytesSent) {
                            sendDelay = 0;
                        }
                        else {
                            sendDelay = Math.max(0, nextSendTime - Date.now());
                        }
                    }
                    if (0 !== sendDelay) {
                        yield this.delay(sendDelay);
                    }
                    if (payload !== null) {
                        nextSendTime = Date.now() + (payload.byteLength * 1000 / (audioFormat.avgBytesPerSec * 2));
                    }
                    // Are we still alive?
                    if (!this.privIsDisposed &&
                        !this.privRequestSession.isSpeechEnded &&
                        this.privRequestSession.isRecognizing &&
                        this.privRequestSession.recogNumber === startRecogNumber) {
                        connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary, "audio", this.privRequestSession.requestId, null, payload)).catch(() => {
                            // eslint-disable-next-line @typescript-eslint/no-empty-function
                            this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(() => { });
                        });
                        if (!(audioStreamChunk === null || audioStreamChunk === void 0 ? void 0 : audioStreamChunk.isEnd)) {
                            // this.writeBufferToConsole(payload);
                            // Regardless of success or failure, schedule the next upload.
                            // If the underlying connection was broken, the next cycle will
                            // get a new connection and re-transmit missing audio automatically.
                            return readAndUploadCycle();
                        }
                        else {
                            // the audio stream has been closed, no need to schedule next
                            // read-upload cycle.
                            if (!this.privIsLiveAudio) {
                                this.privRequestSession.onSpeechEnded();
                            }
                        }
                    }
                }
            });
            return readAndUploadCycle();
        });
    }
    retryableConnect() {
        return __awaiter(this, void 0, void 0, function* () {
            let isUnAuthorized = false;
            this.privAuthFetchEventId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_19__.createNoDashGuid)();
            const sessionId = this.privRequestSession.sessionId;
            this.privConnectionId = (sessionId !== undefined) ? sessionId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_19__.createNoDashGuid)();
            this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId, this.privConnectionId);
            let lastStatusCode = 0;
            let lastReason = "";
            while (this.privRequestSession.numConnectionAttempts <= this.privRecognizerConfig.maxRetryCount) {
                // Get the auth information for the connection. This is a bit of overkill for the current API surface, but leaving the plumbing in place to be able to raise a developer-customer
                // facing event when a connection fails to let them try and provide new auth information.
                const authPromise = isUnAuthorized ? this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId) : this.privAuthentication.fetch(this.privAuthFetchEventId);
                const auth = yield authPromise;
                yield this.privRequestSession.onAuthCompleted(false);
                // Create the connection
                const connection = this.privConnectionFactory.create(this.privRecognizerConfig, auth, this.privConnectionId);
                // Attach the telemetry handlers.
                this.privRequestSession.listenForServiceTelemetry(connection.events);
                // Attach to the underlying event. No need to hold onto the detach pointers as in the event the connection goes away,
                // it'll stop sending events.
                connection.events.attach((event) => {
                    this.connectionEvents.onEvent(event);
                });
                const response = yield connection.open();
                // 200 == everything is fine.
                if (response.statusCode === 200) {
                    yield this.privRequestSession.onConnectionEstablishCompleted(response.statusCode);
                    return Promise.resolve(connection);
                }
                else if (response.statusCode === 1006) {
                    isUnAuthorized = true;
                }
                lastStatusCode = response.statusCode;
                lastReason = response.reason;
                this.privRequestSession.onRetryConnection();
            }
            yield this.privRequestSession.onConnectionEstablishCompleted(lastStatusCode, lastReason);
            return Promise.reject(`Unable to contact server. StatusCode: ${lastStatusCode}, ${this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${lastReason}`);
        });
    }
    delay(delayMs) {
        return new Promise((resolve) => this.privSetTimeout(resolve, delayMs));
    }
    writeBufferToConsole(buffer) {
        let out = "Buffer Size: ";
        if (null === buffer) {
            out += "null";
        }
        else {
            const readView = new Uint8Array(buffer);
            out += `${buffer.byteLength}\r\n`;
            for (let i = 0; i < buffer.byteLength; i++) {
                out += readView[i].toString(16).padStart(2, "0") + " ";
                if (((i + 1) % 16) === 0) {
                    // eslint-disable-next-line no-console
                    console.info(out);
                    out = "";
                }
            }
        }
        // eslint-disable-next-line no-console
        console.info(out);
    }
    sendFinalAudio() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            yield connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_14__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_13__.MessageType.Binary, "audio", this.privRequestSession.requestId, null, null));
            return;
        });
    }
    // Takes an established websocket connection to the endpoint and sends speech configuration information.
    configureConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.connectImpl();
            if (this.configConnectionOverride !== undefined) {
                return this.configConnectionOverride(connection);
            }
            yield this.sendSpeechServiceConfig(connection, this.privRequestSession, this.privRecognizerConfig.SpeechServiceConfig.serialize());
            yield this.sendPrePayloadJSON(connection, false);
            return connection;
        });
    }
}
ServiceRecognizerBase.telemetryDataEnabled = true;

//# sourceMappingURL=ServiceRecognizerBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceTelemetryListener.Internal.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceTelemetryListener.Internal.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServiceTelemetryListener": () => (/* binding */ ServiceTelemetryListener)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _RecognitionEvents__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RecognitionEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognitionEvents.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


class ServiceTelemetryListener {
    constructor(requestId, audioSourceId, audioNodeId) {
        this.privIsDisposed = false;
        this.privListeningTriggerMetric = null;
        this.privMicMetric = null;
        this.privConnectionEstablishMetric = null;
        this.privRequestId = requestId;
        this.privAudioSourceId = audioSourceId;
        this.privAudioNodeId = audioNodeId;
        this.privReceivedMessages = {};
        this.privPhraseLatencies = [];
        this.privHypothesisLatencies = [];
    }
    phraseReceived(audioReceivedTime) {
        if (audioReceivedTime > 0) { // 0 indicates the time is unknown. Drop it.
            this.privPhraseLatencies.push(Date.now() - audioReceivedTime);
        }
    }
    hypothesisReceived(audioReceivedTime) {
        if (audioReceivedTime > 0) { // 0 indicates the time is unknown. Drop it.
            this.privHypothesisLatencies.push(Date.now() - audioReceivedTime);
        }
    }
    onEvent(e) {
        if (this.privIsDisposed) {
            return;
        }
        if (e instanceof _RecognitionEvents__WEBPACK_IMPORTED_MODULE_0__.RecognitionTriggeredEvent && e.requestId === this.privRequestId) {
            this.privListeningTriggerMetric = {
                End: e.eventTime,
                Name: "ListeningTrigger",
                Start: e.eventTime,
            };
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeAttachingEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            this.privMicStartTime = e.eventTime;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeAttachedEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            this.privMicStartTime = e.eventTime;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioSourceErrorEvent && e.audioSourceId === this.privAudioSourceId) {
            if (!this.privMicMetric) {
                this.privMicMetric = {
                    End: e.eventTime,
                    Error: e.error,
                    Name: "Microphone",
                    Start: this.privMicStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeErrorEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            if (!this.privMicMetric) {
                this.privMicMetric = {
                    End: e.eventTime,
                    Error: e.error,
                    Name: "Microphone",
                    Start: this.privMicStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_1__.AudioStreamNodeDetachedEvent && e.audioSourceId === this.privAudioSourceId && e.audioNodeId === this.privAudioNodeId) {
            if (!this.privMicMetric) {
                this.privMicMetric = {
                    End: e.eventTime,
                    Name: "Microphone",
                    Start: this.privMicStartTime,
                };
            }
        }
        if (e instanceof _RecognitionEvents__WEBPACK_IMPORTED_MODULE_0__.ConnectingToServiceEvent && e.requestId === this.privRequestId) {
            this.privConnectionId = e.sessionId;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionStartEvent && e.connectionId === this.privConnectionId) {
            this.privConnectionStartTime = e.eventTime;
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionEstablishedEvent && e.connectionId === this.privConnectionId) {
            if (!this.privConnectionEstablishMetric) {
                this.privConnectionEstablishMetric = {
                    End: e.eventTime,
                    Id: this.privConnectionId,
                    Name: "Connection",
                    Start: this.privConnectionStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionEstablishErrorEvent && e.connectionId === this.privConnectionId) {
            if (!this.privConnectionEstablishMetric) {
                this.privConnectionEstablishMetric = {
                    End: e.eventTime,
                    Error: this.getConnectionError(e.statusCode),
                    Id: this.privConnectionId,
                    Name: "Connection",
                    Start: this.privConnectionStartTime,
                };
            }
        }
        if (e instanceof _common_Exports__WEBPACK_IMPORTED_MODULE_2__.ConnectionMessageReceivedEvent && e.connectionId === this.privConnectionId) {
            if (e.message && e.message.headers && e.message.headers.path) {
                if (!this.privReceivedMessages[e.message.headers.path]) {
                    this.privReceivedMessages[e.message.headers.path] = new Array();
                }
                const maxMessagesToSend = 50;
                if (this.privReceivedMessages[e.message.headers.path].length < maxMessagesToSend) {
                    this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime);
                }
            }
        }
    }
    getTelemetry() {
        const metrics = new Array();
        if (this.privListeningTriggerMetric) {
            metrics.push(this.privListeningTriggerMetric);
        }
        if (this.privMicMetric) {
            metrics.push(this.privMicMetric);
        }
        if (this.privConnectionEstablishMetric) {
            metrics.push(this.privConnectionEstablishMetric);
        }
        if (this.privPhraseLatencies.length > 0) {
            metrics.push({
                PhraseLatencyMs: this.privPhraseLatencies,
            });
        }
        if (this.privHypothesisLatencies.length > 0) {
            metrics.push({
                FirstHypothesisLatencyMs: this.privHypothesisLatencies,
            });
        }
        const telemetry = {
            Metrics: metrics,
            ReceivedMessages: this.privReceivedMessages,
        };
        const json = JSON.stringify(telemetry);
        // We dont want to send the same telemetry again. So clean those out.
        this.privReceivedMessages = {};
        this.privListeningTriggerMetric = null;
        this.privMicMetric = null;
        this.privConnectionEstablishMetric = null;
        this.privPhraseLatencies = [];
        this.privHypothesisLatencies = [];
        return json;
    }
    // Determines if there are any telemetry events to send to the service.
    get hasTelemetry() {
        return (Object.keys(this.privReceivedMessages).length !== 0 ||
            this.privListeningTriggerMetric !== null ||
            this.privMicMetric !== null ||
            this.privConnectionEstablishMetric !== null ||
            this.privPhraseLatencies.length !== 0 ||
            this.privHypothesisLatencies.length !== 0);
    }
    dispose() {
        this.privIsDisposed = true;
    }
    getConnectionError(statusCode) {
        /*
        -- Websocket status codes --
        NormalClosure = 1000,
        EndpointUnavailable = 1001,
        ProtocolError = 1002,
        InvalidMessageType = 1003,
        Empty = 1005,
        InvalidPayloadData = 1007,
        PolicyViolation = 1008,
        MessageTooBig = 1009,
        MandatoryExtension = 1010,
        InternalServerError = 1011
        */
        switch (statusCode) {
            case 400:
            case 1002:
            case 1003:
            case 1005:
            case 1007:
            case 1008:
            case 1009: return "BadRequest";
            case 401: return "Unauthorized";
            case 403: return "Forbidden";
            case 503:
            case 1001: return "ServerUnavailable";
            case 500:
            case 1011: return "ServerError";
            case 408:
            case 504: return "Timeout";
            default: return "statuscode:" + statusCode.toString();
        }
    }
}

//# sourceMappingURL=ServiceTelemetryListener.Internal.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConfig.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConfig.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognitionConfig": () => (/* binding */ SpeakerRecognitionConfig)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class SpeakerRecognitionConfig {
    constructor(context, parameters) {
        this.privContext = context ? context : new _Exports__WEBPACK_IMPORTED_MODULE_0__.Context(null);
        this.privParameters = parameters;
    }
    get parameters() {
        return this.privParameters;
    }
    get Context() {
        return this.privContext;
    }
}

//# sourceMappingURL=SpeakerRecognitionConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognitionConnectionFactory": () => (/* binding */ SpeakerRecognitionConnectionFactory),
/* harmony export */   "VoiceProfileConnectionFactory": () => (/* binding */ VoiceProfileConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */





class SpeakerRecognitionConnectionFactoryBase extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, endpointPath, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint);
        if (!endpoint) {
            const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region);
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
            const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, `wss://${region}.spr-frontend.speech${hostSuffix}`);
            const scenario = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SpeakerIdMode, "TextIndependentIdentification");
            endpoint = `${host}/speaker/ws/${this.scenarioToPath(scenario)}/${endpointPath}`;
        }
        const queryParams = {
            format: "simple",
            language: config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage),
        };
        this.setCommonUrlParams(config, queryParams, endpoint);
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.SpIDAuthKey] = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key);
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    scenarioToPath(mode) {
        switch (mode) {
            case "TextIndependentVerification":
            case "2":
                return "verification/text-independent";
            case "TextDependentVerification":
            case "1":
                return "verification/text-dependent";
            default:
                return "identification/text-independent";
        }
    }
}
class SpeakerRecognitionConnectionFactory extends SpeakerRecognitionConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        return super.create(config, authInfo, "recognition", connectionId);
    }
}
class VoiceProfileConnectionFactory extends SpeakerRecognitionConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        return super.create(config, authInfo, "profile", connectionId);
    }
}

//# sourceMappingURL=SpeakerRecognitionConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerServiceRecognizer": () => (/* binding */ SpeakerServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





// eslint-disable-next-line max-classes-per-file
class SpeakerServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.privSpeakerRecognizer = recognizer;
        this.privSpeakerAudioSource = audioSource;
        this.recognizeSpeaker = (model) => this.recognizeSpeakerOnce(model);
        this.sendPrePayloadJSONOverride = () => this.noOp();
    }
    processTypeSpecificMessages(connectionMessage) {
        let processed = false;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_2__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        switch (connectionMessage.path.toLowerCase()) {
            case "speaker.response":
                const response = JSON.parse(connectionMessage.textBody);
                let result;
                if (response.status.statusCode.toLowerCase() !== "success") {
                    result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeakerRecognitionResult(response, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ServiceError, response.status.reason);
                }
                else {
                    result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeakerRecognitionResult(response, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizedSpeaker);
                }
                if (!!this.privResultDeferral) {
                    this.privResultDeferral.resolve(result);
                }
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_7__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode[errorCode]);
        if (!!this.privResultDeferral) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeakerRecognitionResult({
                scenario: this.privSpeakerModel.scenario,
                status: { statusCode: error, reason: error }
            }, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, errorCode, error);
            try {
                this.privResultDeferral.resolve(result);
            }
            catch (error) {
                this.privResultDeferral.reject(error);
            }
        }
    }
    recognizeSpeakerOnce(model) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privSpeakerModel = model;
            this.voiceProfileType = model.scenario;
            if (!this.privResultDeferral) {
                this.privResultDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_7__.Deferred();
            }
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events);
            this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.Speech_SessionId, this.privRequestSession.sessionId);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            const preAudioPromise = this.sendPreAudioMessages(this.extractSpeakerContext(model));
            const node = yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId);
            const format = yield this.privSpeakerAudioSource.format;
            const deviceInfo = yield this.privSpeakerAudioSource.deviceInfo;
            const audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.ReplayableAudioNode(node, format.avgBytesPerSec);
            yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
            this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            try {
                yield conPromise;
                yield preAudioPromise;
            }
            catch (err) {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ConnectionFailure, err);
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            void this.receiveMessage();
            const audioSendPromise = this.sendAudio(audioNode);
            // /* eslint-disable no-empty */
            audioSendPromise.then(() => { }, (error) => {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.RuntimeError, error);
            });
            return this.privResultDeferral.promise;
        });
    }
    sendPreAudioMessages(context) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            yield this.sendSpeakerRecognition(connection, context);
            // await this.sendWaveHeader(connection);
        });
    }
    sendSpeakerRecognition(connection, context) {
        return __awaiter(this, void 0, void 0, function* () {
            const speakerContextJson = JSON.stringify(context);
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_12__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_2__.MessageType.Text, "speaker.context", this.privRequestSession.requestId, "application/json; charset=utf-8", speakerContextJson));
        });
    }
    extractSpeakerContext(model) {
        return {
            features: {
                interimResult: "enabled",
                progressiveDetection: "disabled",
            },
            profileIds: model.profileIds,
            scenario: model.scenario,
        };
    }
}

//# sourceMappingURL=SpeakerServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechConnectionFactory": () => (/* binding */ SpeechConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







class SpeechConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    constructor() {
        super(...arguments);
        this.interactiveRelativeUri = "/speech/recognition/interactive/cognitiveservices/v1";
        this.conversationRelativeUri = "/speech/recognition/conversation/cognitiveservices/v1";
        this.dictationRelativeUri = "/speech/recognition/dictation/cognitiveservices/v1";
        this.universalUri = "/speech/universal/v";
    }
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, undefined);
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
        const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, "wss://" + region + ".stt.speech" + hostSuffix);
        const queryParams = {};
        const endpointId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId, undefined);
        const language = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, undefined);
        if (endpointId) {
            if (!endpoint || endpoint.search(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.CustomSpeechDeploymentId) === -1) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.CustomSpeechDeploymentId] = endpointId;
            }
        }
        else if (language) {
            if (!endpoint || endpoint.search(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Language) === -1) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Language] = language;
            }
        }
        if (!endpoint || endpoint.search(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Format) === -1) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.Format] = config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormatPropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat.Simple]).toLowerCase();
        }
        if (config.autoDetectSourceLanguages !== undefined) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_2__.QueryParameterNames.EnableLanguageId] = "true";
        }
        this.setCommonUrlParams(config, queryParams, endpoint);
        if (!endpoint) {
            switch (config.recognitionMode) {
                case _Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation:
                    if (config.parameters.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ForceDictationPropertyName, "false") === "true") {
                        endpoint = host + this.dictationRelativeUri;
                    }
                    else {
                        if (config.recognitionEndpointVersion !== undefined && parseInt(config.recognitionEndpointVersion, 10) > 1) {
                            endpoint = `${host}${this.universalUri}${config.recognitionEndpointVersion}`;
                        }
                        else {
                            endpoint = host + this.conversationRelativeUri;
                        }
                    }
                    break;
                case _Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Dictation:
                    endpoint = host + this.dictationRelativeUri;
                    break;
                default:
                    if (config.recognitionEndpointVersion !== undefined && parseInt(config.recognitionEndpointVersion, 10) > 1) {
                        endpoint = `${host}${this.universalUri}${config.recognitionEndpointVersion}`;
                    }
                    else {
                        endpoint = host + this.interactiveRelativeUri; // default is interactive
                    }
                    break;
            }
        }
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_6__.HeaderNames.ConnectionId] = connectionId;
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        const webSocketConnection = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_8__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
        // Set the value of SpeechServiceConnection_Url to webSocketConnection.uri (and not to `endpoint`), since this value is the final
        // URI that was used to make the connection (including query parameters).
        const uri = webSocketConnection.uri;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, uri);
        return webSocketConnection;
    }
}

//# sourceMappingURL=SpeechConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechConnectionMessage": () => (/* binding */ SpeechConnectionMessage)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class SpeechConnectionMessage extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ConnectionMessage {
    constructor(messageType, path, requestId, contentType, body, streamId, additionalHeaders, id) {
        if (!path) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ArgumentNullError("path");
        }
        if (!requestId) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ArgumentNullError("requestId");
        }
        const headers = {};
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Path] = path;
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestId] = requestId;
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestTimestamp] = new Date().toISOString();
        if (contentType) {
            headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ContentType] = contentType;
        }
        if (streamId) {
            headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestStreamId] = streamId;
        }
        if (additionalHeaders) {
            for (const headerName in additionalHeaders) {
                if (headerName) {
                    headers[headerName] = additionalHeaders[headerName];
                }
            }
        }
        if (id) {
            super(messageType, body, headers, id);
        }
        else {
            super(messageType, body, headers);
        }
        this.privPath = path;
        this.privRequestId = requestId;
        this.privContentType = contentType;
        this.privStreamId = streamId;
        this.privAdditionalHeaders = additionalHeaders;
    }
    get path() {
        return this.privPath;
    }
    get requestId() {
        return this.privRequestId;
    }
    get contentType() {
        return this.privContentType;
    }
    get streamId() {
        return this.privStreamId;
    }
    get additionalHeaders() {
        return this.privAdditionalHeaders;
    }
    static fromConnectionMessage(message) {
        let path = null;
        let requestId = null;
        let contentType = null;
        // let requestTimestamp = null;
        let streamId = null;
        const additionalHeaders = {};
        if (message.headers) {
            for (const headerName in message.headers) {
                if (headerName) {
                    if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.Path.toLowerCase()) {
                        path = message.headers[headerName];
                    }
                    else if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestId.toLowerCase()) {
                        requestId = message.headers[headerName];
                        // } else if (headerName.toLowerCase() === HeaderNames.RequestTimestamp.toLowerCase()) {
                        //  requestTimestamp = message.headers[headerName];
                    }
                    else if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ContentType.toLowerCase()) {
                        contentType = message.headers[headerName];
                    }
                    else if (headerName.toLowerCase() === _HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.RequestStreamId.toLowerCase()) {
                        streamId = message.headers[headerName];
                    }
                    else {
                        additionalHeaders[headerName] = message.headers[headerName];
                    }
                }
            }
        }
        return new SpeechConnectionMessage(message.messageType, path, requestId, contentType, message.body, streamId, additionalHeaders, message.id);
    }
}

//# sourceMappingURL=SpeechConnectionMessage.Internal.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechContext.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechContext": () => (/* binding */ SpeechContext)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Represents the JSON used in the speech.context message sent to the speech service.
 * The dynamic grammar is always refreshed from the encapsulated dynamic grammar object.
 */
class SpeechContext {
    constructor(dynamicGrammar) {
        this.privContext = {};
        this.privDynamicGrammar = dynamicGrammar;
    }
    /**
     * Gets a section of the speech.context object.
     * @param sectionName Name of the section to get.
     * @return string or Context JSON serializable object that represents the value.
     */
    getSection(sectionName) {
        return (this.privContext[sectionName] || {});
    }
    /**
     * Adds a section to the speech.context object.
     * @param sectionName Name of the section to add.
     * @param value JSON serializable object that represents the value.
     */
    setSection(sectionName, value) {
        this.privContext[sectionName] = value;
    }
    /**
     * @Internal
     * This is only used by pronunciation assessment config.
     * Do not use externally, object returned will change without warning or notice.
     */
    setPronunciationAssessmentParams(params) {
        if (this.privContext.phraseDetection === undefined) {
            this.privContext.phraseDetection = {
                enrichment: {
                    pronunciationAssessment: {}
                }
            };
        }
        this.privContext.phraseDetection.enrichment.pronunciationAssessment = JSON.parse(params);
        this.setWordLevelTimings();
        this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment");
        if (this.privContext.phraseOutput.detailed.options.indexOf("SNR") === -1) {
            this.privContext.phraseOutput.detailed.options.push("SNR");
        }
    }
    setWordLevelTimings() {
        if (this.privContext.phraseOutput === undefined) {
            this.privContext.phraseOutput = {
                detailed: {
                    options: []
                },
                format: {}
            };
        }
        if (this.privContext.phraseOutput.detailed === undefined) {
            this.privContext.phraseOutput.detailed = {
                options: []
            };
        }
        this.privContext.phraseOutput.format = "Detailed";
        if (this.privContext.phraseOutput.detailed.options.indexOf("WordTimings") === -1) {
            this.privContext.phraseOutput.detailed.options.push("WordTimings");
        }
    }
    toJSON() {
        const dgi = this.privDynamicGrammar.generateGrammarObject();
        this.setSection("dgi", dgi);
        const ret = JSON.stringify(this.privContext);
        return ret;
    }
}

//# sourceMappingURL=SpeechContext.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceInterfaces.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceInterfaces.js ***!
  \*************************************************************************************************************************/
/***/ (() => {

// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

//# sourceMappingURL=SpeechServiceInterfaces.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js":
/*!*************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js ***!
  \*************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechServiceRecognizer": () => (/* binding */ SpeechServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SpeechHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/DetailedSpeechPhrase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


// eslint-disable-next-line max-classes-per-file
class SpeechServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, speechRecognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, speechRecognizer);
        this.privSpeechRecognizer = speechRecognizer;
    }
    processTypeSpecificMessages(connectionMessage) {
        return __awaiter(this, void 0, void 0, function* () {
            let result;
            const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
            let processed = false;
            switch (connectionMessage.path.toLowerCase()) {
                case "speech.hypothesis":
                case "speech.fragment":
                    const hypothesis = _Exports__WEBPACK_IMPORTED_MODULE_3__.SpeechHypothesis.fromJSON(connectionMessage.textBody);
                    const offset = hypothesis.Offset + this.privRequestSession.currentTurnAudioOffset;
                    result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizingSpeech, hypothesis.Text, hypothesis.Duration, offset, hypothesis.Language, hypothesis.LanguageDetectionConfidence, undefined, // Speaker Id
                    undefined, connectionMessage.textBody, resultProps);
                    this.privRequestSession.onHypothesis(offset);
                    const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechRecognitionEventArgs(result, hypothesis.Duration, this.privRequestSession.sessionId);
                    if (!!this.privSpeechRecognizer.recognizing) {
                        try {
                            this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer, ev);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    processed = true;
                    break;
                case "speech.phrase":
                    const simple = _Exports__WEBPACK_IMPORTED_MODULE_7__.SimpleSpeechPhrase.fromJSON(connectionMessage.textBody);
                    const resultReason = _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateRecognitionResult(simple.RecognitionStatus);
                    this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + simple.Offset + simple.Duration);
                    if (_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled === resultReason) {
                        const cancelReason = _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateCancelResult(simple.RecognitionStatus);
                        const cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateCancelErrorCode(simple.RecognitionStatus);
                        yield this.cancelRecognitionLocal(cancelReason, cancellationErrorCode, _Exports__WEBPACK_IMPORTED_MODULE_8__.EnumTranslation.implTranslateErrorDetails(cancellationErrorCode));
                    }
                    else {
                        if (!(this.privRequestSession.isSpeechEnded && resultReason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.NoMatch && simple.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_9__.RecognitionStatus.InitialSilenceTimeout)) {
                            if (this.privRecognizerConfig.parameters.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_10__.OutputFormatPropertyName) === _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.OutputFormat.Simple]) {
                                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, simple.DisplayText, simple.Duration, simple.Offset + this.privRequestSession.currentTurnAudioOffset, simple.Language, simple.LanguageDetectionConfidence, undefined, // Speaker Id
                                undefined, connectionMessage.textBody, resultProps);
                            }
                            else {
                                const detailed = _Exports__WEBPACK_IMPORTED_MODULE_12__.DetailedSpeechPhrase.fromJSON(connectionMessage.textBody);
                                const totalOffset = detailed.Offset + this.privRequestSession.currentTurnAudioOffset;
                                const offsetCorrectedJson = detailed.getJsonWithCorrectedOffsets(totalOffset);
                                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(this.privRequestSession.requestId, resultReason, detailed.RecognitionStatus === _Exports__WEBPACK_IMPORTED_MODULE_9__.RecognitionStatus.Success ? detailed.NBest[0].Display : undefined, detailed.Duration, totalOffset, detailed.Language, detailed.LanguageDetectionConfidence, undefined, // Speaker Id
                                undefined, offsetCorrectedJson, resultProps);
                            }
                            const event = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechRecognitionEventArgs(result, result.offset, this.privRequestSession.sessionId);
                            if (!!this.privSpeechRecognizer.recognized) {
                                try {
                                    this.privSpeechRecognizer.recognized(this.privSpeechRecognizer, event);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                        }
                        if (!!this.privSuccessCallback) {
                            try {
                                this.privSuccessCallback(result);
                            }
                            catch (e) {
                                if (!!this.privErrorCallback) {
                                    this.privErrorCallback(e);
                                }
                            }
                            // Only invoke the call back once.
                            // and if it's successful don't invoke the
                            // error after that.
                            this.privSuccessCallback = undefined;
                            this.privErrorCallback = undefined;
                        }
                    }
                    processed = true;
                    break;
                default:
                    break;
            }
            return processed;
        });
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_10__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.CancellationErrorCode[errorCode]);
        if (!!this.privSpeechRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.SpeechRecognitionCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
            try {
                this.privSpeechRecognizer.canceled(this.privSpeechRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechRecognitionResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, undefined, // Text
            undefined, // Duration
            undefined, // Offset
            undefined, // Language
            undefined, // Language Detection Confidence
            undefined, // Speaker Id
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                this.privSuccessCallback = undefined;
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
}

//# sourceMappingURL=SpeechServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisConnectionFactory": () => (/* binding */ SpeechSynthesisConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.






class SpeechSynthesisConnectionFactory {
    constructor() {
        this.synthesisUri = "/cognitiveservices/websocket/v1";
    }
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Region, undefined);
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__.ConnectionFactoryBase.getHostSuffix(region);
        const endpointId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_EndpointId, undefined);
        const hostPrefix = (endpointId === undefined) ? "tts" : "voice";
        const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Host, "wss://" + region + "." + hostPrefix + ".speech" + hostSuffix);
        const queryParams = {};
        if (!endpoint) {
            endpoint = host + this.synthesisUri;
        }
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        if (endpointId !== undefined) {
            headers[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CustomVoiceDeploymentId] = endpointId;
        }
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_5__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__.ProxyInfo.fromParameters(config.parameters), enableCompression, connectionId);
    }
}

//# sourceMappingURL=SpeechSynthesisConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisAdapterBase": () => (/* binding */ SynthesisAdapterBase)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AgentConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class SynthesisAdapterBase {
    constructor(authentication, connectionFactory, synthesizerConfig, speechSynthesizer, audioDestination) {
        this.speakOverride = undefined;
        this.receiveMessageOverride = undefined;
        this.connectImplOverride = undefined;
        this.configConnectionOverride = undefined;
        // A promise for a configured connection.
        // Do not consume directly, call fetchConnection instead.
        this.privConnectionConfigurationPromise = undefined;
        if (!authentication) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("authentication");
        }
        if (!connectionFactory) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("connectionFactory");
        }
        if (!synthesizerConfig) {
            throw new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("synthesizerConfig");
        }
        this.privAuthentication = authentication;
        this.privConnectionFactory = connectionFactory;
        this.privSynthesizerConfig = synthesizerConfig;
        this.privIsDisposed = false;
        this.privSpeechSynthesizer = speechSynthesizer;
        this.privSessionAudioDestination = audioDestination;
        this.privSynthesisTurn = new _Exports__WEBPACK_IMPORTED_MODULE_1__.SynthesisTurn();
        this.privConnectionEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privServiceEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.EventSource();
        this.privSynthesisContext = new _Exports__WEBPACK_IMPORTED_MODULE_3__.SynthesisContext(this.privSpeechSynthesizer);
        this.privAgentConfig = new _Exports__WEBPACK_IMPORTED_MODULE_4__.AgentConfig();
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionClosedEvent") {
                const connectionClosedEvent = connectionEvent;
                if (connectionClosedEvent.statusCode !== 1000) {
                    this.cancelSynthesisLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, connectionClosedEvent.statusCode === 1007 ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.BadRequestParameters : _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ConnectionFailure, `${connectionClosedEvent.reason} websocket error code: ${connectionClosedEvent.statusCode}`);
                }
            }
        });
    }
    get synthesisContext() {
        return this.privSynthesisContext;
    }
    get agentConfig() {
        return this.privAgentConfig;
    }
    get connectionEvents() {
        return this.privConnectionEvents;
    }
    get serviceEvents() {
        return this.privServiceEvents;
    }
    set activityTemplate(messagePayload) {
        this.privActivityTemplate = messagePayload;
    }
    get activityTemplate() {
        return this.privActivityTemplate;
    }
    set audioOutputFormat(format) {
        this.privAudioOutputFormat = format;
        this.privSynthesisTurn.audioOutputFormat = format;
        if (this.privSessionAudioDestination !== undefined) {
            this.privSessionAudioDestination.format = format;
        }
        if (this.synthesisContext !== undefined) {
            this.synthesisContext.audioOutputFormat = format;
        }
    }
    static addHeader(audio, format) {
        if (!format.hasHeader) {
            return audio;
        }
        format.updateHeader(audio.byteLength);
        const tmp = new Uint8Array(audio.byteLength + format.header.byteLength);
        tmp.set(new Uint8Array(format.header), 0);
        tmp.set(new Uint8Array(audio), format.header.byteLength);
        return tmp.buffer;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose(reason) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privIsDisposed = true;
            if (this.privSessionAudioDestination !== undefined) {
                this.privSessionAudioDestination.close();
            }
            if (this.privConnectionConfigurationPromise !== undefined) {
                const connection = yield this.privConnectionConfigurationPromise;
                yield connection.dispose(reason);
            }
        });
    }
    connect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.connectImpl();
        });
    }
    sendNetworkMessage(path, payload) {
        return __awaiter(this, void 0, void 0, function* () {
            const type = typeof payload === "string" ? _common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text : _common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Binary;
            const contentType = typeof payload === "string" ? "application/json" : "";
            const connection = yield this.fetchConnection();
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(type, path, this.privSynthesisTurn.requestId, contentType, payload));
        });
    }
    Speak(text, isSSML, requestId, successCallback, errorCallBack, audioDestination) {
        return __awaiter(this, void 0, void 0, function* () {
            let ssml;
            if (isSSML) {
                ssml = text;
            }
            else {
                ssml = this.privSpeechSynthesizer.buildSsml(text);
            }
            if (this.speakOverride !== undefined) {
                return this.speakOverride(ssml, requestId, successCallback, errorCallBack);
            }
            this.privSuccessCallback = successCallback;
            this.privErrorCallback = errorCallBack;
            this.privSynthesisTurn.startNewSynthesis(requestId, text, isSSML, audioDestination);
            try {
                yield this.connectImpl();
                const connection = yield this.fetchConnection();
                yield this.sendSynthesisContext(connection);
                yield this.sendSsmlMessage(connection, ssml, requestId);
                const synthesisStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.SynthesizingAudioStarted));
                if (!!this.privSpeechSynthesizer.synthesisStarted) {
                    this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer, synthesisStartEventArgs);
                }
                void this.receiveMessage();
            }
            catch (e) {
                this.cancelSynthesisLocal(_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.ConnectionFailure, e);
                return Promise.reject(e);
            }
        });
    }
    // Cancels synthesis.
    cancelSynthesis(requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_13__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode[errorCode]);
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.Canceled, undefined, error, properties);
        if (!!this.privSpeechSynthesizer.SynthesisCanceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(result);
            try {
                this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            try {
                this.privSuccessCallback(result);
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
    // Cancels synthesis.
    cancelSynthesisLocal(cancellationReason, errorCode, error) {
        if (!!this.privSynthesisTurn.isSynthesizing) {
            this.privSynthesisTurn.onStopSynthesizing();
            this.cancelSynthesis(this.privSynthesisTurn.requestId, cancellationReason, errorCode, error);
        }
    }
    // eslint-disable-next-line @typescript-eslint/no-unused-vars
    processTypeSpecificMessages(connectionMessage) {
        return true;
    }
    receiveMessage() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (this.receiveMessageOverride !== undefined) {
                    return this.receiveMessageOverride();
                }
                if (this.privIsDisposed) {
                    // We're done.
                    return;
                }
                // indicates we are draining the queue and it came with no message;
                if (!message) {
                    if (!this.privSynthesisTurn.isSynthesizing) {
                        return;
                    }
                    else {
                        return this.receiveMessage();
                    }
                }
                const connectionMessage = _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage.fromConnectionMessage(message);
                if (connectionMessage.requestId.toLowerCase() === this.privSynthesisTurn.requestId.toLowerCase()) {
                    switch (connectionMessage.path.toLowerCase()) {
                        case "turn.start":
                            this.privSynthesisTurn.onServiceTurnStartResponse();
                            break;
                        case "response":
                            this.privSynthesisTurn.onServiceResponseMessage(connectionMessage.textBody);
                            break;
                        case "audio":
                            if (this.privSynthesisTurn.streamId.toLowerCase() === connectionMessage.streamId.toLowerCase()
                                && !!connectionMessage.binaryBody) {
                                this.privSynthesisTurn.onAudioChunkReceived(connectionMessage.binaryBody);
                                if (!!this.privSpeechSynthesizer.synthesizing) {
                                    try {
                                        const audioWithHeader = SynthesisAdapterBase.addHeader(connectionMessage.binaryBody, this.privSynthesisTurn.audioOutputFormat);
                                        const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(this.privSynthesisTurn.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.SynthesizingAudio, audioWithHeader));
                                        this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer, ev);
                                    }
                                    catch (error) {
                                        // Not going to let errors in the event handler
                                        // trip things up.
                                    }
                                }
                                if (this.privSessionAudioDestination !== undefined) {
                                    this.privSessionAudioDestination.write(connectionMessage.binaryBody);
                                }
                            }
                            break;
                        case "audio.metadata":
                            const metadataList = _Exports__WEBPACK_IMPORTED_MODULE_14__.SynthesisAudioMetadata.fromJSON(connectionMessage.textBody).Metadata;
                            for (const metadata of metadataList) {
                                switch (metadata.Type) {
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.WordBoundary:
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.SentenceBoundary:
                                        this.privSynthesisTurn.onTextBoundaryEvent(metadata);
                                        const wordBoundaryEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechSynthesisWordBoundaryEventArgs(metadata.Data.Offset, metadata.Data.Duration, metadata.Data.text.Text, metadata.Data.text.Length, metadata.Type === _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.WordBoundary
                                            ? this.privSynthesisTurn.currentTextOffset : this.privSynthesisTurn.currentSentenceOffset, metadata.Data.text.BoundaryType);
                                        if (!!this.privSpeechSynthesizer.wordBoundary) {
                                            try {
                                                this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer, wordBoundaryEventArgs);
                                            }
                                            catch (error) {
                                                // Not going to let errors in the event handler
                                                // trip things up.
                                            }
                                        }
                                        break;
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.Bookmark:
                                        const bookmarkEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.SpeechSynthesisBookmarkEventArgs(metadata.Data.Offset, metadata.Data.Bookmark);
                                        if (!!this.privSpeechSynthesizer.bookmarkReached) {
                                            try {
                                                this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer, bookmarkEventArgs);
                                            }
                                            catch (error) {
                                                // Not going to let errors in the event handler
                                                // trip things up.
                                            }
                                        }
                                        break;
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.Viseme:
                                        this.privSynthesisTurn.onVisemeMetadataReceived(metadata);
                                        if (metadata.Data.IsLastAnimation) {
                                            const visemeEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__.SpeechSynthesisVisemeEventArgs(metadata.Data.Offset, metadata.Data.VisemeId, this.privSynthesisTurn.getAndClearVisemeAnimation());
                                            if (!!this.privSpeechSynthesizer.visemeReceived) {
                                                try {
                                                    this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer, visemeEventArgs);
                                                }
                                                catch (error) {
                                                    // Not going to let errors in the event handler
                                                    // trip things up.
                                                }
                                            }
                                        }
                                        break;
                                    case _Exports__WEBPACK_IMPORTED_MODULE_14__.MetadataType.SessionEnd:
                                        this.privSynthesisTurn.onSessionEnd(metadata);
                                        break;
                                }
                            }
                            break;
                        case "turn.end":
                            this.privSynthesisTurn.onServiceTurnEndResponse();
                            let result;
                            try {
                                const audioBuffer = yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();
                                result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechSynthesisResult(this.privSynthesisTurn.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.ResultReason.SynthesizingAudioCompleted, audioBuffer, undefined, undefined, this.privSynthesisTurn.audioDuration);
                                if (!!this.privSuccessCallback) {
                                    this.privSuccessCallback(result);
                                }
                            }
                            catch (error) {
                                if (!!this.privErrorCallback) {
                                    this.privErrorCallback(error);
                                }
                            }
                            if (this.privSpeechSynthesizer.synthesisCompleted) {
                                try {
                                    this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer, new _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechSynthesisEventArgs(result));
                                }
                                catch (e) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                            break;
                        default:
                            if (!this.processTypeSpecificMessages(connectionMessage)) {
                                // here are some messages that the derived class has not processed, dispatch them to connect class
                                if (!!this.privServiceEvents) {
                                    this.serviceEvents.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ServiceEvent(connectionMessage.path.toLowerCase(), connectionMessage.textBody));
                                }
                            }
                    }
                }
                return this.receiveMessage();
            }
            catch (e) {
                // TODO: What goes here?
            }
        });
    }
    sendSynthesisContext(connection) {
        const synthesisContextJson = this.synthesisContext.toJSON();
        if (synthesisContextJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text, "synthesis.context", this.privSynthesisTurn.requestId, "application/json", synthesisContextJson));
        }
        return;
    }
    connectImpl(isUnAuthorized = false) {
        if (this.privConnectionPromise != null) {
            return this.privConnectionPromise.then((connection) => {
                if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_19__.ConnectionState.Disconnected) {
                    this.privConnectionId = null;
                    this.privConnectionPromise = null;
                    return this.connectImpl();
                }
                return this.privConnectionPromise;
            }, () => {
                this.privConnectionId = null;
                this.privConnectionPromise = null;
                return this.connectImpl();
            });
        }
        this.privAuthFetchEventId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_20__.createNoDashGuid)();
        this.privConnectionId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_20__.createNoDashGuid)();
        this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);
        const authPromise = isUnAuthorized ? this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId) : this.privAuthentication.fetch(this.privAuthFetchEventId);
        this.privConnectionPromise = authPromise.then((result) => __awaiter(this, void 0, void 0, function* () {
            this.privSynthesisTurn.onAuthCompleted(false);
            const connection = this.privConnectionFactory.create(this.privSynthesizerConfig, result, this.privConnectionId);
            // Attach to the underlying event. No need to hold onto the detach pointers as in the event the connection goes away,
            // it'll stop sending events.
            connection.events.attach((event) => {
                this.connectionEvents.onEvent(event);
            });
            const response = yield connection.open();
            if (response.statusCode === 200) {
                this.privSynthesisTurn.onConnectionEstablishCompleted(response.statusCode);
                return Promise.resolve(connection);
            }
            else if (response.statusCode === 403 && !isUnAuthorized) {
                return this.connectImpl(true);
            }
            else {
                this.privSynthesisTurn.onConnectionEstablishCompleted(response.statusCode);
                return Promise.reject(`Unable to contact server. StatusCode: ${response.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_21__.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${response.reason}`);
            }
        }), (error) => {
            this.privSynthesisTurn.onAuthCompleted(true);
            throw new Error(error);
        });
        // Attach an empty handler to allow the promise to run in the background while
        // other startup events happen. It'll eventually be awaited on.
        // eslint-disable-next-line @typescript-eslint/no-empty-function
        this.privConnectionPromise.catch(() => { });
        return this.privConnectionPromise;
    }
    sendSpeechServiceConfig(connection, SpeechServiceConfigJson) {
        if (SpeechServiceConfigJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text, "speech.config", this.privSynthesisTurn.requestId, "application/json", SpeechServiceConfigJson));
        }
    }
    sendSsmlMessage(connection, ssml, requestId) {
        return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_8__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text, "ssml", requestId, "application/ssml+xml", ssml));
    }
    fetchConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privConnectionConfigurationPromise !== undefined) {
                return this.privConnectionConfigurationPromise.then((connection) => {
                    if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_19__.ConnectionState.Disconnected) {
                        this.privConnectionId = null;
                        this.privConnectionConfigurationPromise = undefined;
                        return this.fetchConnection();
                    }
                    return this.privConnectionConfigurationPromise;
                }, () => {
                    this.privConnectionId = null;
                    this.privConnectionConfigurationPromise = undefined;
                    return this.fetchConnection();
                });
            }
            this.privConnectionConfigurationPromise = this.configureConnection();
            return yield this.privConnectionConfigurationPromise;
        });
    }
    // Takes an established websocket connection to the endpoint and sends speech configuration information.
    configureConnection() {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.connectImpl();
            if (this.configConnectionOverride !== undefined) {
                return this.configConnectionOverride(connection);
            }
            yield this.sendSpeechServiceConfig(connection, this.privSynthesizerConfig.SpeechServiceConfig.serialize());
            return connection;
        });
    }
}
SynthesisAdapterBase.telemetryDataEnabled = true;

//# sourceMappingURL=SynthesisAdapterBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisContext.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisContext": () => (/* binding */ SynthesisContext)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents the JSON used in the synthesis.context message sent to the speech service.
 * The dynamic grammar is always refreshed from the encapsulated dynamic grammar object.
 */
class SynthesisContext {
    constructor(speechSynthesizer) {
        this.privContext = {};
        this.privSpeechSynthesizer = speechSynthesizer;
    }
    /**
     * Adds a section to the synthesis.context object.
     * @param sectionName Name of the section to add.
     * @param value JSON serializable object that represents the value.
     */
    setSection(sectionName, value) {
        this.privContext[sectionName] = value;
    }
    /**
     * Sets the audio output format for synthesis context generation.
     * @param format {AudioOutputFormatImpl} the output format
     */
    set audioOutputFormat(format) {
        this.privAudioOutputFormat = format;
    }
    toJSON() {
        const synthesisSection = this.buildSynthesisContext();
        this.setSection("synthesis", synthesisSection);
        return JSON.stringify(this.privContext);
    }
    buildSynthesisContext() {
        return {
            audio: {
                metadataOptions: {
                    bookmarkEnabled: (!!this.privSpeechSynthesizer.bookmarkReached),
                    punctuationBoundaryEnabled: this.privSpeechSynthesizer.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary, (!!this.privSpeechSynthesizer.wordBoundary)),
                    sentenceBoundaryEnabled: this.privSpeechSynthesizer.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestSentenceBoundary, false),
                    sessionEndEnabled: true,
                    visemeEnabled: (!!this.privSpeechSynthesizer.visemeReceived),
                    wordBoundaryEnabled: this.privSpeechSynthesizer.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceResponse_RequestWordBoundary, (!!this.privSpeechSynthesizer.wordBoundary)),
                },
                outputFormat: this.privAudioOutputFormat.requestAudioFormatString,
            },
            language: {
                autoDetection: this.privSpeechSynthesizer.autoDetectSourceLanguage
            }
        };
    }
}

//# sourceMappingURL=SynthesisContext.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisEvents.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisEvents.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectingToSynthesisServiceEvent": () => (/* binding */ ConnectingToSynthesisServiceEvent),
/* harmony export */   "SpeechSynthesisEvent": () => (/* binding */ SpeechSynthesisEvent),
/* harmony export */   "SynthesisStartedEvent": () => (/* binding */ SynthesisStartedEvent),
/* harmony export */   "SynthesisTriggeredEvent": () => (/* binding */ SynthesisTriggeredEvent)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class SpeechSynthesisEvent extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, requestId, eventType = _common_Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privRequestId = requestId;
    }
    get requestId() {
        return this.privRequestId;
    }
}
class SynthesisTriggeredEvent extends SpeechSynthesisEvent {
    constructor(requestId, sessionAudioDestinationId, turnAudioDestinationId) {
        super("SynthesisTriggeredEvent", requestId);
        this.privSessionAudioDestinationId = sessionAudioDestinationId;
        this.privTurnAudioDestinationId = turnAudioDestinationId;
    }
    get audioSessionDestinationId() {
        return this.privSessionAudioDestinationId;
    }
    get audioTurnDestinationId() {
        return this.privTurnAudioDestinationId;
    }
}
class ConnectingToSynthesisServiceEvent extends SpeechSynthesisEvent {
    constructor(requestId, authFetchEventId) {
        super("ConnectingToSynthesisServiceEvent", requestId);
        this.privAuthFetchEventId = authFetchEventId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
}
class SynthesisStartedEvent extends SpeechSynthesisEvent {
    constructor(requestId, authFetchEventId) {
        super("SynthesisStartedEvent", requestId);
        this.privAuthFetchEventId = authFetchEventId;
    }
    get authFetchEventId() {
        return this.privAuthFetchEventId;
    }
}

//# sourceMappingURL=SynthesisEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisRestAdapter": () => (/* binding */ SynthesisRestAdapter)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");




/**
 * Implements methods for speaker recognition classes, sending requests to endpoint
 * and parsing response into expected format
 * @class SynthesisRestAdapter
 */
class SynthesisRestAdapter {
    constructor(config, authentication) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        if (!endpoint) {
            const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Region, "westus");
            const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_1__.ConnectionFactoryBase.getHostSuffix(region);
            endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId.SpeechServiceConnection_Host, `https://${region}.tts.speech${hostSuffix}`);
        }
        this.privUri = `${endpoint}/cognitiveservices/voices/list`;
        const options = _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__.RestConfigBase.requestOptions;
        this.privRestAdapter = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.RestMessageAdapter(options);
        this.privAuthentication = authentication;
    }
    /**
     * Sends list voices request to endpoint.
     * @function
     * @public
     * @param connectionId - guid for connectionId
     * @returns {Promise<IRestResponse>} rest response to status request
     */
    getVoicesList(connectionId) {
        this.privRestAdapter.setHeaders(_HeaderNames__WEBPACK_IMPORTED_MODULE_4__.HeaderNames.ConnectionId, connectionId);
        return this.privAuthentication.fetch(connectionId).then((authInfo) => {
            this.privRestAdapter.setHeaders(authInfo.headerName, authInfo.token);
            return this.privRestAdapter.request(_common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.RestRequestType.Get, this.privUri);
        });
    }
}

//# sourceMappingURL=SynthesisRestAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisTurn.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisTurn": () => (/* binding */ SynthesisTurn)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Audio/AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ServiceMessages/SynthesisAudioMetadata */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SynthesisAudioMetadata.js");
/* harmony import */ var _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SynthesisAdapterBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SynthesisEvents */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisEvents.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class SynthesisTurn {
    constructor() {
        this.privIsDisposed = false;
        this.privIsSynthesizing = false;
        this.privIsSynthesisEnded = false;
        this.privBytesReceived = 0;
        this.privInTurn = false;
        this.privTextOffset = 0;
        this.privNextSearchTextIndex = 0;
        this.privSentenceOffset = 0;
        this.privNextSearchSentenceIndex = 0;
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        // We're not in a turn, so resolve.
        this.privTurnDeferral.resolve();
    }
    get requestId() {
        return this.privRequestId;
    }
    get streamId() {
        return this.privStreamId;
    }
    set streamId(value) {
        this.privStreamId = value;
    }
    get audioOutputFormat() {
        return this.privAudioOutputFormat;
    }
    set audioOutputFormat(format) {
        this.privAudioOutputFormat = format;
    }
    get turnCompletionPromise() {
        return this.privTurnDeferral.promise;
    }
    get isSynthesisEnded() {
        return this.privIsSynthesisEnded;
    }
    get isSynthesizing() {
        return this.privIsSynthesizing;
    }
    get currentTextOffset() {
        return this.privTextOffset;
    }
    get currentSentenceOffset() {
        return this.privSentenceOffset;
    }
    // The number of bytes received for current turn
    get bytesReceived() {
        return this.privBytesReceived;
    }
    get audioDuration() {
        return this.privAudioDuration;
    }
    getAllReceivedAudio() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privReceivedAudio) {
                return Promise.resolve(this.privReceivedAudio);
            }
            if (!this.privIsSynthesisEnded) {
                return null;
            }
            yield this.readAllAudioFromStream();
            return Promise.resolve(this.privReceivedAudio);
        });
    }
    getAllReceivedAudioWithHeader() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privReceivedAudioWithHeader) {
                return this.privReceivedAudioWithHeader;
            }
            if (!this.privIsSynthesisEnded) {
                return null;
            }
            if (this.audioOutputFormat.hasHeader) {
                const audio = yield this.getAllReceivedAudio();
                this.privReceivedAudioWithHeader = _SynthesisAdapterBase__WEBPACK_IMPORTED_MODULE_2__.SynthesisAdapterBase.addHeader(audio, this.audioOutputFormat);
                return this.privReceivedAudioWithHeader;
            }
            else {
                return this.getAllReceivedAudio();
            }
        });
    }
    startNewSynthesis(requestId, rawText, isSSML, audioDestination) {
        this.privIsSynthesisEnded = false;
        this.privIsSynthesizing = true;
        this.privRequestId = requestId;
        this.privRawText = rawText;
        this.privIsSSML = isSSML;
        this.privAudioOutputStream = new _sdk_Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.PullAudioOutputStreamImpl();
        this.privAudioOutputStream.format = this.privAudioOutputFormat;
        this.privReceivedAudio = null;
        this.privReceivedAudioWithHeader = null;
        this.privBytesReceived = 0;
        this.privTextOffset = 0;
        this.privNextSearchTextIndex = 0;
        this.privSentenceOffset = 0;
        this.privNextSearchSentenceIndex = 0;
        this.privPartialVisemeAnimation = "";
        if (audioDestination !== undefined) {
            this.privTurnAudioDestination = audioDestination;
            this.privTurnAudioDestination.format = this.privAudioOutputFormat;
        }
        this.onEvent(new _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__.SynthesisTriggeredEvent(this.requestId, undefined, audioDestination === undefined ? undefined : audioDestination.id()));
    }
    onPreConnectionStart(authFetchEventId) {
        this.privAuthFetchEventId = authFetchEventId;
        this.onEvent(new _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__.ConnectingToSynthesisServiceEvent(this.privRequestId, this.privAuthFetchEventId));
    }
    onAuthCompleted(isError) {
        if (isError) {
            this.onComplete();
        }
    }
    onConnectionEstablishCompleted(statusCode) {
        if (statusCode === 200) {
            this.onEvent(new _SynthesisEvents__WEBPACK_IMPORTED_MODULE_4__.SynthesisStartedEvent(this.requestId, this.privAuthFetchEventId));
            this.privBytesReceived = 0;
            return;
        }
        else if (statusCode === 403) {
            this.onComplete();
        }
    }
    onServiceResponseMessage(responseJson) {
        const response = JSON.parse(responseJson);
        this.streamId = response.audio.streamId;
    }
    onServiceTurnEndResponse() {
        this.privInTurn = false;
        this.privTurnDeferral.resolve();
        this.onComplete();
    }
    onServiceTurnStartResponse() {
        if (!!this.privTurnDeferral && !!this.privInTurn) {
            // What? How are we starting a turn with another not done?
            this.privTurnDeferral.reject("Another turn started before current completed.");
            // Avoid UnhandledPromiseRejection if privTurnDeferral is not being awaited
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            this.privTurnDeferral.promise.then().catch(() => { });
        }
        this.privInTurn = true;
        this.privTurnDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
    }
    onAudioChunkReceived(data) {
        if (this.isSynthesizing) {
            this.privAudioOutputStream.write(data);
            this.privBytesReceived += data.byteLength;
            if (this.privTurnAudioDestination !== undefined) {
                this.privTurnAudioDestination.write(data);
            }
        }
    }
    onTextBoundaryEvent(metadata) {
        this.updateTextOffset(metadata.Data.text.Text, metadata.Type);
    }
    onVisemeMetadataReceived(metadata) {
        if (metadata.Data.AnimationChunk !== undefined) {
            this.privPartialVisemeAnimation += metadata.Data.AnimationChunk;
        }
    }
    onSessionEnd(metadata) {
        this.privAudioDuration = metadata.Data.Offset;
    }
    dispose() {
        if (!this.privIsDisposed) {
            // we should have completed by now. If we did not its an unknown error.
            this.privIsDisposed = true;
        }
    }
    onStopSynthesizing() {
        this.onComplete();
    }
    /**
     * Gets the viseme animation string (merged from animation chunk), and clears the internal
     * partial animation.
     */
    getAndClearVisemeAnimation() {
        const animation = this.privPartialVisemeAnimation;
        this.privPartialVisemeAnimation = "";
        return animation;
    }
    onEvent(event) {
        _common_Exports__WEBPACK_IMPORTED_MODULE_5__.Events.instance.onEvent(event);
    }
    /**
     * Check if the text is an XML(SSML) tag
     * @param text
     * @private
     */
    static isXmlTag(text) {
        return text.length >= 2 && text[0] === "<" && text[text.length - 1] === ">";
    }
    updateTextOffset(text, type) {
        if (type === _ServiceMessages_SynthesisAudioMetadata__WEBPACK_IMPORTED_MODULE_6__.MetadataType.WordBoundary) {
            this.privTextOffset = this.privRawText.indexOf(text, this.privNextSearchTextIndex);
            if (this.privTextOffset >= 0) {
                this.privNextSearchTextIndex = this.privTextOffset + text.length;
                if (this.privIsSSML) {
                    if (this.withinXmlTag(this.privTextOffset) && !SynthesisTurn.isXmlTag(text)) {
                        this.updateTextOffset(text, type);
                    }
                }
            }
        }
        else {
            this.privSentenceOffset = this.privRawText.indexOf(text, this.privNextSearchSentenceIndex);
            if (this.privSentenceOffset >= 0) {
                this.privNextSearchSentenceIndex = this.privSentenceOffset + text.length;
                if (this.privIsSSML) {
                    if (this.withinXmlTag(this.privSentenceOffset) && !SynthesisTurn.isXmlTag(text)) {
                        this.updateTextOffset(text, type);
                    }
                }
            }
        }
    }
    onComplete() {
        if (this.privIsSynthesizing) {
            this.privIsSynthesizing = false;
            this.privIsSynthesisEnded = true;
            this.privAudioOutputStream.close();
            this.privInTurn = false;
            if (this.privTurnAudioDestination !== undefined) {
                this.privTurnAudioDestination.close();
                this.privTurnAudioDestination = undefined;
            }
        }
    }
    readAllAudioFromStream() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privIsSynthesisEnded) {
                this.privReceivedAudio = new ArrayBuffer(this.bytesReceived);
                try {
                    yield this.privAudioOutputStream.read(this.privReceivedAudio);
                }
                catch (e) {
                    this.privReceivedAudio = new ArrayBuffer(0);
                }
            }
        });
    }
    /**
     * Check if current idx is in XML(SSML) tag
     * @param idx
     * @private
     */
    withinXmlTag(idx) {
        return this.privRawText.indexOf("<", idx + 1) > this.privRawText.indexOf(">", idx + 1);
    }
}

//# sourceMappingURL=SynthesisTurn.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisServiceType": () => (/* binding */ SynthesisServiceType),
/* harmony export */   "SynthesizerConfig": () => (/* binding */ SynthesizerConfig)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

var SynthesisServiceType;
(function (SynthesisServiceType) {
    SynthesisServiceType[SynthesisServiceType["Standard"] = 0] = "Standard";
    SynthesisServiceType[SynthesisServiceType["Custom"] = 1] = "Custom";
})(SynthesisServiceType || (SynthesisServiceType = {}));
class SynthesizerConfig {
    constructor(speechServiceConfig, parameters) {
        this.privSynthesisServiceType = SynthesisServiceType.Standard;
        this.privSpeechServiceConfig = speechServiceConfig ? speechServiceConfig : new _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechServiceConfig(new _Exports__WEBPACK_IMPORTED_MODULE_0__.Context(null));
        this.privParameters = parameters;
    }
    get parameters() {
        return this.privParameters;
    }
    get synthesisServiceType() {
        return this.privSynthesisServiceType;
    }
    set synthesisServiceType(value) {
        this.privSynthesisServiceType = value;
    }
    get SpeechServiceConfig() {
        return this.privSpeechServiceConfig;
    }
}

//# sourceMappingURL=SynthesizerConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranscriberConnectionFactory": () => (/* binding */ TranscriberConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.






class TranscriberConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    constructor() {
        super(...arguments);
        this.multiaudioRelativeUri = "/speech/recognition/multiaudio";
    }
    create(config, authInfo, connectionId) {
        let endpoint = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, "centralus");
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
        const hostDefault = "wss://transcribe." + region + ".cts.speech" + hostSuffix + this.multiaudioRelativeUri;
        const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, hostDefault);
        const queryParams = {};
        this.setQueryParams(queryParams, config, endpoint);
        if (!endpoint) {
            endpoint = host;
        }
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_3__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    setQueryParams(queryParams, config, endpointUrl) {
        const endpointId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId, undefined);
        const language = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, undefined);
        if (endpointId && !(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.CustomSpeechDeploymentId in queryParams)) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.CustomSpeechDeploymentId] = endpointId;
        }
        if (language && !(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.Language in queryParams)) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.Language] = language;
        }
        const wordLevelTimings = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, "false").toLowerCase() === "true";
        const detailed = config.parameters.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_7__.OutputFormatPropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Simple]) !== _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Simple];
        if (wordLevelTimings || detailed) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_6__.QueryParameterNames.Format] = _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat[_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.OutputFormat.Detailed].toLowerCase();
        }
        this.setCommonUrlParams(config, queryParams, endpointUrl);
    }
}

//# sourceMappingURL=TranscriberConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js":
/*!********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js ***!
  \********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionConfig": () => (/* binding */ ConversationConnectionConfig)
/* harmony export */ });
/* harmony import */ var _common_browser_RestConfigBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common.browser/RestConfigBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ConversationConnectionConfig extends _common_browser_RestConfigBase__WEBPACK_IMPORTED_MODULE_0__.RestConfigBase {
    static get host() {
        return ConversationConnectionConfig.privHost;
    }
    static get apiVersion() {
        return ConversationConnectionConfig.privApiVersion;
    }
    static get clientAppId() {
        return ConversationConnectionConfig.privClientAppId;
    }
    static get defaultLanguageCode() {
        return ConversationConnectionConfig.privDefaultLanguageCode;
    }
    static get restPath() {
        return ConversationConnectionConfig.privRestPath;
    }
    static get webSocketPath() {
        return ConversationConnectionConfig.privWebSocketPath;
    }
    static get transcriptionEventKeys() {
        return ConversationConnectionConfig.privTranscriptionEventKeys;
    }
}
ConversationConnectionConfig.privHost = "dev.microsofttranslator.com";
ConversationConnectionConfig.privRestPath = "/capito/room";
ConversationConnectionConfig.privApiVersion = "2.0";
ConversationConnectionConfig.privDefaultLanguageCode = "en-US";
ConversationConnectionConfig.privClientAppId = "FC539C22-1767-4F1F-84BC-B4D811114F15";
ConversationConnectionConfig.privWebSocketPath = "/capito/translate";
ConversationConnectionConfig.privTranscriptionEventKeys = ["iCalUid", "callId", "organizer", "FLAC", "MTUri", "DifferentiateGuestSpeakers", "audiorecording", "Threadid", "OrganizerMri", "OrganizerTenantId", "UserToken"];

//# sourceMappingURL=ConversationConnectionConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionFactory.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionFactory.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionFactory": () => (/* binding */ ConversationConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationConnectionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _ConversationWebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ConversationWebsocketMessageFormatter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationWebsocketMessageFormatter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







/**
 * Create a connection to the Conversation Translator websocket for sending instant messages and commands, and for receiving translated messages.
 * The conversation must already have been started or joined.
 */
class ConversationConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        const endpointHost = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.ConversationTranslator_Host, _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.host);
        const correlationId = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.ConversationTranslator_CorrelationId, (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.createGuid)());
        const endpoint = `wss://${endpointHost}${_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.webSocketPath}`;
        const token = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.ConversationTranslator_Token, undefined);
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_4__.Contracts.throwIfNullOrUndefined(token, "token");
        const queryParams = {};
        queryParams[_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.configParams.apiVersion] = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.apiVersion;
        queryParams[_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.configParams.token] = token;
        queryParams[_ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionConfig.configParams.correlationId] = correlationId;
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_5__.WebsocketConnection(endpoint, queryParams, {}, new _ConversationWebsocketMessageFormatter__WEBPACK_IMPORTED_MODULE_6__.ConversationWebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_7__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
}

//# sourceMappingURL=ConversationConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionMessage": () => (/* binding */ ConversationConnectionMessage)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ConversationConnectionMessage extends _common_Exports__WEBPACK_IMPORTED_MODULE_0__.ConnectionMessage {
    constructor(messageType, body, headers, id) {
        super(messageType, body, headers, id);
        const json = JSON.parse(this.textBody);
        if (json.type !== undefined) {
            this.privConversationMessageType = json.type;
        }
    }
    get conversationMessageType() {
        return this.privConversationMessageType;
    }
}

//# sourceMappingURL=ConversationConnectionMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationManager": () => (/* binding */ ConversationManager)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestMessageAdapter.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConversationConnectionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.




class ConversationManager {
    constructor() {
        //
        this.privRequestParams = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.configParams;
        this.privErrors = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.restErrors;
        this.privHost = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.host;
        this.privApiVersion = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.apiVersion;
        this.privRestPath = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.restPath;
        this.privRestAdapter = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestMessageAdapter({});
    }
    /**
     * Make a POST request to the Conversation Manager service endpoint to create or join a conversation.
     * @param args
     * @param conversationCode
     * @param callback
     * @param errorCallback
     */
    createOrJoin(args, conversationCode, cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(args, "args");
            const languageCode = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage, _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.defaultLanguageCode);
            const nickname = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_Name, "conversation_host");
            const endpointHost = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_Host, this.privHost);
            const correlationId = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_CorrelationId);
            const subscriptionKey = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Key);
            const subscriptionRegion = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Region);
            const authToken = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(languageCode, "languageCode");
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(nickname, "nickname");
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(endpointHost, "endpointHost");
            const queryParams = {};
            queryParams[this.privRequestParams.apiVersion] = this.privApiVersion;
            queryParams[this.privRequestParams.languageCode] = languageCode;
            queryParams[this.privRequestParams.nickname] = nickname;
            const headers = {};
            if (correlationId) {
                headers[this.privRequestParams.correlationId] = correlationId;
            }
            headers[this.privRequestParams.clientAppId] = _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_0__.ConversationConnectionConfig.clientAppId;
            if (conversationCode !== undefined) {
                queryParams[this.privRequestParams.roomId] = conversationCode;
            }
            else {
                _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(subscriptionRegion, this.privErrors.authInvalidSubscriptionRegion);
                headers[this.privRequestParams.subscriptionRegion] = subscriptionRegion;
                if (subscriptionKey) {
                    headers[this.privRequestParams.subscriptionKey] = subscriptionKey;
                }
                else if (authToken) {
                    headers[this.privRequestParams.authorization] = `Bearer ${authToken}`;
                }
                else {
                    _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(subscriptionKey, this.privErrors.authInvalidSubscriptionKey);
                }
            }
            const config = {};
            config.headers = headers;
            this.privRestAdapter.options = config;
            const endpoint = `https://${endpointHost}${this.privRestPath}`;
            // TODO: support a proxy and certificate validation
            this.privRestAdapter.request(_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestRequestType.Post, endpoint, queryParams, null).then((response) => {
                const requestId = _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId, response.headers);
                if (!response.ok) {
                    if (!!err) {
                        // get the error
                        let errorMessage = this.privErrors.invalidCreateJoinConversationResponse.replace("{status}", response.status.toString());
                        let errMessageRaw;
                        try {
                            errMessageRaw = JSON.parse(response.data);
                            errorMessage += ` [${errMessageRaw.error.code}: ${errMessageRaw.error.message}]`;
                        }
                        catch (e) {
                            errorMessage += ` [${response.data}]`;
                        }
                        if (requestId) {
                            errorMessage += ` ${requestId}`;
                        }
                        err(errorMessage);
                    }
                    return;
                }
                const conversation = JSON.parse(response.data);
                if (conversation) {
                    conversation.requestId = requestId;
                }
                if (!!cb) {
                    try {
                        cb(conversation);
                    }
                    catch (e) {
                        if (!!err) {
                            err(e);
                        }
                    }
                    cb = undefined;
                }
                // eslint-disable-next-line @typescript-eslint/no-empty-function
            }).catch(() => { });
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
        }
    }
    /**
     * Make a DELETE request to the Conversation Manager service endpoint to leave the conversation.
     * @param args
     * @param sessionToken
     * @param callback
     */
    leave(args, sessionToken) {
        return new Promise((resolve, reject) => {
            try {
                _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(args, this.privErrors.invalidArgs.replace("{arg}", "config"));
                _sdk_Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(sessionToken, this.privErrors.invalidArgs.replace("{arg}", "token"));
                const endpointHost = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_Host, this.privHost);
                const correlationId = args.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.ConversationTranslator_CorrelationId);
                const queryParams = {};
                queryParams[this.privRequestParams.apiVersion] = this.privApiVersion;
                queryParams[this.privRequestParams.sessionToken] = sessionToken;
                const headers = {};
                if (correlationId) {
                    headers[this.privRequestParams.correlationId] = correlationId;
                }
                const config = {};
                config.headers = headers;
                this.privRestAdapter.options = config;
                const endpoint = `https://${endpointHost}${this.privRestPath}`;
                // TODO: support a proxy and certificate validation
                this.privRestAdapter.request(_common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.RestRequestType.Delete, endpoint, queryParams, null).then((response) => {
                    if (!response.ok) {
                        // ignore errors on delete
                    }
                    resolve();
                    // eslint-disable-next-line @typescript-eslint/no-empty-function
                }).catch(() => { });
            }
            catch (error) {
                if (error instanceof Error) {
                    const typedError = error;
                    reject(typedError.name + ": " + typedError.message);
                }
                else {
                    reject(error);
                }
            }
        });
    }
}

//# sourceMappingURL=ConversationManager.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationRequestSession.js":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationRequestSession.js ***!
  \******************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationRequestSession": () => (/* binding */ ConversationRequestSession)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};

/**
 * Placeholder class for the Conversation Request Session. Based off RequestSession.
 * TODO: define what telemetry is required.
 */
class ConversationRequestSession {
    constructor(sessionId) {
        this.privIsDisposed = false;
        this.privDetachables = new Array();
        this.privSessionId = sessionId;
        this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privRequestCompletionDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Deferred();
    }
    get sessionId() {
        return this.privSessionId;
    }
    get requestId() {
        return this.privRequestId;
    }
    get completionPromise() {
        return this.privRequestCompletionDeferral.promise;
    }
    onPreConnectionStart(authFetchEventId, connectionId) {
        this.privSessionId = connectionId;
    }
    onAuthCompleted(isError) {
        if (isError) {
            this.onComplete();
        }
    }
    onConnectionEstablishCompleted(statusCode) {
        if (statusCode === 200) {
            return;
        }
        else if (statusCode === 403) {
            this.onComplete();
        }
    }
    onServiceTurnEndResponse(continuousRecognition) {
        if (!continuousRecognition) {
            this.onComplete();
        }
        else {
            this.privRequestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        }
    }
    dispose() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsDisposed) {
                // we should have completed by now. If we did not its an unknown error.
                this.privIsDisposed = true;
                for (const detachable of this.privDetachables) {
                    yield detachable.detach();
                }
            }
        });
    }
    onComplete() {
        //
    }
}

//# sourceMappingURL=ConversationRequestSession.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationServiceAdapter.js":
/*!******************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationServiceAdapter.js ***!
  \******************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationServiceAdapter": () => (/* binding */ ConversationServiceAdapter)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ConversationConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js");
/* harmony import */ var _ConversationRequestSession__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConversationRequestSession */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationRequestSession.js");
/* harmony import */ var _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ConversationTranslatorEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js");
/* harmony import */ var _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ConversationTranslatorInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js");
/* harmony import */ var _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ServiceMessages/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/CommandResponsePayload.js");
/* harmony import */ var _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./ServiceMessages/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/ParticipantResponsePayload.js");
/* harmony import */ var _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./ServiceMessages/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/TranslationResponsePayload.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








/**
 * The service adapter handles sending and receiving messages to the Conversation Translator websocket.
 */
class ConversationServiceAdapter extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, conversationServiceConnector) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, conversationServiceConnector);
        this.privConnectionConfigPromise = undefined;
        this.privLastPartialUtteranceId = "";
        this.privConversationServiceConnector = conversationServiceConnector;
        this.privConversationAuthentication = authentication;
        this.receiveMessageOverride = () => this.receiveConversationMessageOverride();
        this.recognizeOverride = () => this.noOp();
        this.postConnectImplOverride = (connection) => this.conversationConnectImpl(connection);
        this.configConnectionOverride = () => this.configConnection();
        this.disconnectOverride = () => this.privDisconnect();
        this.privConversationRequestSession = new _ConversationRequestSession__WEBPACK_IMPORTED_MODULE_1__.ConversationRequestSession((0,_common_Exports__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)());
        this.privConversationConnectionFactory = connectionFactory;
        this.privConversationIsDisposed = false;
    }
    isDisposed() {
        return super.isDisposed() || this.privConversationIsDisposed;
    }
    dispose(reason) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            this.privConversationIsDisposed = true;
            if (this.privConnectionConfigPromise !== undefined) {
                const connection = yield this.privConnectionConfigPromise;
                yield connection.dispose(reason);
            }
            yield _super.dispose.call(this, reason);
        });
    }
    sendMessage(message) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            return connection.send(new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_3__.ConversationConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_4__.MessageType.Text, message));
        });
    }
    sendMessageAsync(message) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            yield connection.send(new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_3__.ConversationConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_4__.MessageType.Text, message));
        });
    }
    privDisconnect() {
        if (this.terminateMessageLoop) {
            return;
        }
        this.cancelRecognition(this.privConversationRequestSession.sessionId, this.privConversationRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.NoError, "Disconnecting");
        this.terminateMessageLoop = true;
        return Promise.resolve();
    }
    // eslint-disable-next-line @typescript-eslint/require-await
    processTypeSpecificMessages() {
        return __awaiter(this, void 0, void 0, function* () {
            return true;
        });
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        this.terminateMessageLoop = true;
        const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
        try {
            if (!!this.privConversationServiceConnector.canceled) {
                this.privConversationServiceConnector.canceled(this.privConversationServiceConnector, cancelEvent);
            }
        }
        catch (_a) {
            // continue on error
        }
    }
    /**
     * Establishes a websocket connection to the end point.
     */
    conversationConnectImpl(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            this.privConnectionLoop = this.startMessageLoop();
            return connection;
        });
    }
    /**
     * Process incoming websocket messages
     */
    receiveConversationMessageOverride() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.isDisposed() || this.terminateMessageLoop) {
                return Promise.resolve();
            }
            // we won't rely on the cascading promises of the connection since we want to continually be available to receive messages
            const communicationCustodian = new _common_Exports__WEBPACK_IMPORTED_MODULE_8__.Deferred();
            try {
                const connection = yield this.fetchConnection();
                const message = yield connection.read();
                if (this.isDisposed() || this.terminateMessageLoop) {
                    // We're done.
                    communicationCustodian.resolve();
                    return Promise.resolve();
                }
                if (!message) {
                    return this.receiveConversationMessageOverride();
                }
                const sessionId = this.privConversationRequestSession.sessionId;
                const conversationMessageType = message.conversationMessageType.toLowerCase();
                let sendFinal = false;
                try {
                    switch (conversationMessageType) {
                        case "info":
                        case "participant_command":
                        case "command":
                            const commandPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_9__.CommandResponsePayload.fromJSON(message.textBody);
                            switch (commandPayload.command.toLowerCase()) {
                                /**
                                 * 'ParticpantList' is the first message sent to the user after the websocket connection has opened.
                                 * The consuming client must wait for this message to arrive
                                 * before starting to send their own data.
                                 */
                                case "participantlist":
                                    const participantsPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_10__.ParticipantsListPayloadResponse.fromJSON(message.textBody);
                                    const participantsResult = participantsPayload.participants.map((p) => {
                                        const participant = {
                                            avatar: p.avatar,
                                            displayName: p.nickname,
                                            id: p.participantId,
                                            isHost: p.ishost,
                                            isMuted: p.ismuted,
                                            isUsingTts: p.usetts,
                                            preferredLanguage: p.locale
                                        };
                                        return participant;
                                    });
                                    if (!!this.privConversationServiceConnector.participantsListReceived) {
                                        this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantsListEventArgs(participantsPayload.roomid, participantsPayload.token, participantsPayload.translateTo, participantsPayload.profanityFilter, participantsPayload.roomProfanityFilter, participantsPayload.roomLocked, participantsPayload.muteAll, participantsResult, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetTranslateToLanguages' represents the list of languages being used in the Conversation by all users(?).
                                 * This is sent at the start of the Conversation
                                 */
                                case "settranslatetolanguages":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setTranslateToLanguages, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetProfanityFiltering' lets the client set the level of profanity filtering.
                                 * If sent by the participant the setting will effect only their own profanity level.
                                 * If sent by the host, the setting will effect all participants including the host.
                                 * Note: the profanity filters differ from Speech Service (?): 'marked', 'raw', 'removed', 'tagged'
                                 */
                                case "setprofanityfiltering":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setProfanityFiltering, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetMute' is sent if the participant has been muted by the host.
                                 * Check the 'participantId' to determine if the current user has been muted.
                                 */
                                case "setmute":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setMute, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetMuteAll' is sent if the Conversation has been muted by the host.
                                 */
                                case "setmuteall":
                                    if (!!this.privConversationServiceConnector.muteAllCommandReceived) {
                                        this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.MuteAllEventArgs(commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'RoomExpirationWarning' is sent towards the end of the Conversation session to give a timeout warning.
                                 */
                                case "roomexpirationwarning":
                                    if (!!this.privConversationServiceConnector.conversationExpiration) {
                                        this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector, new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.ConversationExpirationEventArgs(commandPayload.value, this.privConversationRequestSession.sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetUseTts' is sent as a confirmation if the user requests TTS to be turned on or off.
                                 */
                                case "setusetts":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.setUseTTS, commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'SetLockState' is set if the host has locked or unlocked the Conversation.
                                 */
                                case "setlockstate":
                                    if (!!this.privConversationServiceConnector.lockRoomCommandReceived) {
                                        this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.LockRoomEventArgs(commandPayload.value, sessionId));
                                    }
                                    break;
                                /**
                                 * 'ChangeNickname' is received if a user changes their display name.
                                 * Any cached particpiants list should be updated to reflect the display name.
                                 */
                                case "changenickname":
                                    if (!!this.privConversationServiceConnector.participantUpdateCommandReceived) {
                                        this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantAttributeEventArgs(commandPayload.participantId, _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorCommandTypes.changeNickname, commandPayload.nickname, sessionId));
                                    }
                                    break;
                                /**
                                 * 'JoinSession' is sent when a user joins the Conversation.
                                 */
                                case "joinsession":
                                    const joinParticipantPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_10__.ParticipantPayloadResponse.fromJSON(message.textBody);
                                    const joiningParticipant = {
                                        avatar: joinParticipantPayload.avatar,
                                        displayName: joinParticipantPayload.nickname,
                                        id: joinParticipantPayload.participantId,
                                        isHost: joinParticipantPayload.ishost,
                                        isMuted: joinParticipantPayload.ismuted,
                                        isUsingTts: joinParticipantPayload.usetts,
                                        preferredLanguage: joinParticipantPayload.locale,
                                    };
                                    if (!!this.privConversationServiceConnector.participantJoinCommandReceived) {
                                        this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantEventArgs(joiningParticipant, sessionId));
                                    }
                                    break;
                                /**
                                 * 'LeaveSession' is sent when a user leaves the Conversation'.
                                 */
                                case "leavesession":
                                    const leavingParticipant = {
                                        id: commandPayload.participantId
                                    };
                                    if (!!this.privConversationServiceConnector.participantLeaveCommandReceived) {
                                        this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ParticipantEventArgs(leavingParticipant, sessionId));
                                    }
                                    break;
                                /**
                                 * 'DisconnectSession' is sent when a user is disconnected from the session (e.g. network problem).
                                 * Check the 'ParticipantId' to check whether the message is for the current user.
                                 */
                                case "disconnectsession":
                                    // eslint-disable-next-line @typescript-eslint/no-unused-vars
                                    const disconnectParticipant = {
                                        id: commandPayload.participantId
                                    };
                                    break;
                                case "token":
                                    const token = new _Exports__WEBPACK_IMPORTED_MODULE_14__.CognitiveTokenAuthentication(() => {
                                        const authorizationToken = commandPayload.token;
                                        return Promise.resolve(authorizationToken);
                                    }, () => {
                                        const authorizationToken = commandPayload.token;
                                        return Promise.resolve(authorizationToken);
                                    });
                                    this.authentication = token;
                                    break;
                                /**
                                 * Message not recognized.
                                 */
                                default:
                                    break;
                            }
                            break;
                        /**
                         * 'partial' (or 'hypothesis') represents a unfinalized speech message.
                         */
                        case "partial":
                        /**
                         * 'final' (or 'phrase') represents a finalized speech message.
                         */
                        case "final":
                            const speechPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_15__.SpeechResponsePayload.fromJSON(message.textBody);
                            const conversationResultReason = (conversationMessageType === "final") ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.ResultReason.TranslatedParticipantSpeech : _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.ResultReason.TranslatingParticipantSpeech;
                            const speechResult = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__.ConversationTranslationResult(speechPayload.participantId, this.getTranslations(speechPayload.translations), speechPayload.language, speechPayload.id, conversationResultReason, speechPayload.recognition, undefined, undefined, message.textBody, undefined);
                            if (speechPayload.isFinal) {
                                // check the length, sometimes empty finals are returned
                                if (speechResult.text !== undefined && speechResult.text.length > 0) {
                                    sendFinal = true;
                                }
                                else if (speechPayload.id === this.privLastPartialUtteranceId) {
                                    // send final as normal. We had a non-empty partial for this same utterance
                                    // so sending the empty final is important
                                    sendFinal = true;
                                }
                                else {
                                    // suppress unneeded final
                                }
                                if (sendFinal) {
                                    if (!!this.privConversationServiceConnector.translationReceived) {
                                        this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ConversationReceivedTranslationEventArgs(_ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorMessageTypes.final, speechResult, sessionId));
                                    }
                                }
                            }
                            else if (speechResult.text !== undefined) {
                                this.privLastPartialUtteranceId = speechPayload.id;
                                if (!!this.privConversationServiceConnector.translationReceived) {
                                    this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ConversationReceivedTranslationEventArgs(_ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorMessageTypes.partial, speechResult, sessionId));
                                }
                            }
                            break;
                        /**
                         * "translated_message" is a text message or instant message (IM).
                         */
                        case "translated_message":
                            const textPayload = _ServiceMessages_Exports__WEBPACK_IMPORTED_MODULE_15__.TextResponsePayload.fromJSON(message.textBody);
                            // TODO: (Native parity) a result reason should be set based whether the participantId is ours or not
                            const textResult = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_17__.ConversationTranslationResult(textPayload.participantId, this.getTranslations(textPayload.translations), textPayload.language, undefined, undefined, textPayload.originalText, undefined, undefined, undefined, message.textBody, undefined);
                            if (!!this.privConversationServiceConnector.translationReceived) {
                                this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector, new _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_11__.ConversationReceivedTranslationEventArgs(_ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_12__.ConversationTranslatorMessageTypes.instantMessage, textResult, sessionId));
                            }
                            break;
                        default:
                            // ignore any unsupported message types
                            break;
                    }
                }
                catch (e) {
                    // continue
                }
                return this.receiveConversationMessageOverride();
            }
            catch (e) {
                this.terminateMessageLoop = true;
            }
            return communicationCustodian.promise;
        });
    }
    startMessageLoop() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.isDisposed()) {
                return Promise.resolve();
            }
            this.terminateMessageLoop = false;
            const messageRetrievalPromise = this.receiveConversationMessageOverride();
            try {
                const r = yield messageRetrievalPromise;
                return r;
            }
            catch (error) {
                this.cancelRecognition(this.privRequestSession ? this.privRequestSession.sessionId : "", this.privRequestSession ? this.privRequestSession.requestId : "", _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCode.RuntimeError, error);
                return null;
            }
        });
    }
    // Takes an established websocket connection to the endpoint
    configConnection() {
        if (this.isDisposed()) {
            return Promise.resolve(undefined);
        }
        if (this.privConnectionConfigPromise !== undefined) {
            return this.privConnectionConfigPromise.then((connection) => {
                if (connection.state() === _common_Exports__WEBPACK_IMPORTED_MODULE_18__.ConnectionState.Disconnected) {
                    this.privConnectionId = null;
                    this.privConnectionConfigPromise = undefined;
                    return this.configConnection();
                }
                return this.privConnectionConfigPromise;
            }, () => {
                this.privConnectionId = null;
                this.privConnectionConfigPromise = undefined;
                return this.configConnection();
            });
        }
        if (this.terminateMessageLoop) {
            return Promise.resolve(undefined);
        }
        this.privConnectionConfigPromise = this.connectImpl().then((connection) => connection);
        return this.privConnectionConfigPromise;
    }
    getTranslations(serviceResultTranslations) {
        let translations;
        if (undefined !== serviceResultTranslations) {
            translations = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_19__.Translations();
            for (const translation of serviceResultTranslations) {
                translations.set(translation.lang, translation.translation);
            }
        }
        return translations;
    }
}

//# sourceMappingURL=ConversationServiceAdapter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorConnectionFactory.js":
/*!*******************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorConnectionFactory.js ***!
  \*******************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslatorConnectionFactory": () => (/* binding */ ConversationTranslatorConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/RestConfigBase.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_StringUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/StringUtils */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.








/**
 * Connection factory for the conversation translator. Handles connecting to the regular translator endpoint,
 * as well as the virtual microphone array transcription endpoint
 */
class ConversationTranslatorConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    constructor(convGetter) {
        super();
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(convGetter, "convGetter");
        this.privConvGetter = convGetter;
    }
    create(config, authInfo, connectionId) {
        const isVirtMicArrayEndpoint = config.parameters.getProperty("ConversationTranslator_MultiChannelAudio", "").toUpperCase() === "TRUE";
        const convInfo = this.privConvGetter().room;
        const region = convInfo.cognitiveSpeechRegion || config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, "");
        const replacementValues = {
            hostSuffix: _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region),
            path: ConversationTranslatorConnectionFactory.CTS_VIRT_MIC_PATH,
            region: encodeURIComponent(region)
        };
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Language] = encodeURIComponent(config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage, ""));
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsMeetingId] = encodeURIComponent(convInfo.roomId);
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsDeviceId] = encodeURIComponent(convInfo.participantId);
        replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsIsParticipant] = convInfo.isHost ? "" : ("&" + _QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsIsParticipant);
        let endpointUrl = "";
        const queryParams = {};
        const headers = {};
        if (isVirtMicArrayEndpoint) {
            // connecting to the conversation transcription virtual microphone array endpoint
            endpointUrl = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Endpoint);
            if (!endpointUrl) {
                const hostName = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Host, "transcribe.{region}.cts.speech{hostSuffix}");
                endpointUrl = "wss://" + hostName + "{path}";
            }
            // because the region can change during a session, we support being passed a format string which we can then
            // replace with the correct information.
            endpointUrl = _common_StringUtils__WEBPACK_IMPORTED_MODULE_4__.StringUtils.formatString(endpointUrl, replacementValues);
            const parsedUrl = new URL(endpointUrl);
            parsedUrl.searchParams.forEach((val, key) => {
                queryParams[key] = val;
            });
            const connFactory = new _Exports__WEBPACK_IMPORTED_MODULE_5__.TranscriberConnectionFactory();
            connFactory.setQueryParams(queryParams, config, endpointUrl);
            // Some query parameters are required for the CTS endpoint, let's explicity set them here
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsMeetingId] = replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsMeetingId];
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsDeviceId] = replacementValues[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsDeviceId];
            if (!convInfo.isHost) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.CtsIsParticipant] = ""; // this doesn't have a value so set to an empty string
            }
            if (!(_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Format in queryParams)) {
                queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_3__.QueryParameterNames.Format] = "simple";
            }
            parsedUrl.searchParams.forEach((val, key) => {
                parsedUrl.searchParams.set(key, queryParams[key]);
                delete queryParams[key];
            });
            endpointUrl = parsedUrl.toString();
        }
        else {
            // connecting to regular translation endpoint
            const connFactory = new _Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationConnectionFactory();
            endpointUrl = connFactory.getEndpointUrl(config, true);
            endpointUrl = _common_StringUtils__WEBPACK_IMPORTED_MODULE_4__.StringUtils.formatString(endpointUrl, replacementValues);
            connFactory.setQueryParams(queryParams, config, endpointUrl);
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_7__.HeaderNames.ConnectionId] = connectionId;
        headers[_common_browser_Exports__WEBPACK_IMPORTED_MODULE_8__.RestConfigBase.configParams.token] = convInfo.token;
        if (authInfo.token) {
            headers[authInfo.headerName] = authInfo.token;
        }
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "").toUpperCase() === "TRUE";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_9__.WebsocketConnection(endpointUrl, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_10__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_11__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
}
ConversationTranslatorConnectionFactory.CTS_VIRT_MIC_PATH = "/speech/recognition/dynamicaudio";

//# sourceMappingURL=ConversationTranslatorConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationReceivedTranslationEventArgs": () => (/* binding */ ConversationReceivedTranslationEventArgs),
/* harmony export */   "LockRoomEventArgs": () => (/* binding */ LockRoomEventArgs),
/* harmony export */   "MuteAllEventArgs": () => (/* binding */ MuteAllEventArgs),
/* harmony export */   "ParticipantAttributeEventArgs": () => (/* binding */ ParticipantAttributeEventArgs),
/* harmony export */   "ParticipantEventArgs": () => (/* binding */ ParticipantEventArgs),
/* harmony export */   "ParticipantsListEventArgs": () => (/* binding */ ParticipantsListEventArgs)
/* harmony export */ });
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class MuteAllEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(isMuted, sessionId) {
        super(sessionId);
        this.privIsMuted = isMuted;
    }
    get isMuted() {
        return this.privIsMuted;
    }
}
class LockRoomEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(isLocked, sessionId) {
        super(sessionId);
        this.privIsLocked = isLocked;
    }
    get isMuted() {
        return this.privIsLocked;
    }
}
class ParticipantEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(participant, sessionId) {
        super(sessionId);
        this.privParticipant = participant;
    }
    get participant() {
        return this.privParticipant;
    }
}
class ParticipantAttributeEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(participantId, key, value, sessionId) {
        super(sessionId);
        this.privKey = key;
        this.privValue = value;
        this.privParticipantId = participantId;
    }
    get value() {
        return this.privValue;
    }
    get key() {
        return this.privKey;
    }
    get id() {
        return this.privParticipantId;
    }
}
class ParticipantsListEventArgs extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(conversationId, token, translateTo, profanityFilter, roomProfanityFilter, isRoomLocked, isMuteAll, participants, sessionId) {
        super(sessionId);
        this.privRoomId = conversationId;
        this.privSessionToken = token;
        this.privTranslateTo = translateTo;
        this.privProfanityFilter = profanityFilter;
        this.privRoomProfanityFilter = roomProfanityFilter;
        this.privIsRoomLocked = isRoomLocked;
        this.privIsRoomLocked = isMuteAll;
        this.privParticipants = participants;
    }
    get sessionToken() {
        return this.privSessionToken;
    }
    get conversationId() {
        return this.privRoomId;
    }
    get translateTo() {
        return this.privTranslateTo;
    }
    get profanityFilter() {
        return this.privProfanityFilter;
    }
    get roomProfanityFilter() {
        return this.privRoomProfanityFilter;
    }
    get isRoomLocked() {
        return this.privIsRoomLocked;
    }
    get isMuteAll() {
        return this.privIsMuteAll;
    }
    get participants() {
        return this.privParticipants;
    }
}
class ConversationReceivedTranslationEventArgs {
    constructor(command, payload, sessionId) {
        this.privPayload = payload;
        this.privCommand = command;
        this.privSessionId = sessionId;
    }
    get payload() {
        return this.privPayload;
    }
    get command() {
        return this.privCommand;
    }
    get sessionId() {
        return this.privSessionId;
    }
}

//# sourceMappingURL=ConversationTranslatorEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslatorCommandTypes": () => (/* binding */ ConversationTranslatorCommandTypes),
/* harmony export */   "ConversationTranslatorMessageTypes": () => (/* binding */ ConversationTranslatorMessageTypes),
/* harmony export */   "InternalParticipants": () => (/* binding */ InternalParticipants)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/** Users participating in the conversation */
class InternalParticipants {
    constructor(participants = [], meId) {
        this.participants = participants;
        this.meId = meId;
    }
    /**
     * Add or update a participant
     * @param value
     */
    addOrUpdateParticipant(value) {
        if (value === undefined) {
            return;
        }
        const exists = this.getParticipantIndex(value.id);
        if (exists > -1) {
            this.participants.splice(exists, 1, value);
        }
        else {
            this.participants.push(value);
        }
        // ensure it was added ok
        return this.getParticipant(value.id);
    }
    /**
     * Find the participant's position in the participants list.
     * @param id
     */
    getParticipantIndex(id) {
        return this.participants.findIndex((p) => p.id === id);
    }
    /**
     * Find the participant by id.
     * @param id
     */
    getParticipant(id) {
        return this.participants.find((p) => p.id === id);
    }
    /**
     * Remove a participant from the participants list.
     */
    deleteParticipant(id) {
        this.participants = this.participants.filter((p) => p.id !== id);
    }
    /**
     * Helper to return the conversation host.
     */
    get host() {
        return this.participants.find((p) => p.isHost === true);
    }
    /**
     * Helper to return the current user.
     */
    get me() {
        return this.getParticipant(this.meId);
    }
}
/**
 * List of command message types
 */
const ConversationTranslatorMessageTypes = {
    command: "command",
    final: "final",
    info: "info",
    instantMessage: "instant_message",
    keepAlive: "keep_alive",
    partial: "partial",
    participantCommand: "participant_command",
    translatedMessage: "translated_message"
};
/**
 * List of command types
 */
const ConversationTranslatorCommandTypes = {
    changeNickname: "ChangeNickname",
    disconnectSession: "DisconnectSession",
    ejectParticipant: "EjectParticipant",
    instant_message: "instant_message",
    joinSession: "JoinSession",
    leaveSession: "LeaveSession",
    participantList: "ParticipantList",
    roomExpirationWarning: "RoomExpirationWarning",
    setLockState: "SetLockState",
    setMute: "SetMute",
    setMuteAll: "SetMuteAll",
    setProfanityFiltering: "SetProfanityFiltering",
    setTranslateToLanguages: "SetTranslateToLanguages",
    setUseTTS: "SetUseTTS"
};

//# sourceMappingURL=ConversationTranslatorInterfaces.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js":
/*!************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js ***!
  \************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationRecognizerFactory": () => (/* binding */ ConversationRecognizerFactory),
/* harmony export */   "ConversationTranslatorRecognizer": () => (/* binding */ ConversationTranslatorRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
/* harmony import */ var _ConversationConnectionFactory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionFactory.js");
/* harmony import */ var _ConversationServiceAdapter__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ConversationServiceAdapter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationServiceAdapter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
// eslint-disable-next-line max-classes-per-file






class ConversationRecognizerFactory {
    static fromConfig(conversation, speechConfig, audioConfig) {
        return new ConversationTranslatorRecognizer(conversation, speechConfig, audioConfig);
    }
}
/**
 * Sends messages to the Conversation Translator websocket and listens for incoming events containing websocket messages.
 * Based off the recognizers in the SDK folder.
 */
class ConversationTranslatorRecognizer extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    constructor(conversation, speechConfig, audioConfig) {
        const serviceConfigImpl = speechConfig;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(serviceConfigImpl, "speechConfig");
        const conversationImpl = conversation;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(conversationImpl, "conversationImpl");
        super(audioConfig, serviceConfigImpl.properties, new _ConversationConnectionFactory__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionFactory());
        this.privConversation = conversationImpl;
        this.privIsDisposed = false;
        this.privProperties = serviceConfigImpl.properties.clone();
        this.privConnection = _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.Connection.fromRecognizer(this);
        this.privSetTimeout = (typeof (Blob) !== "undefined" && typeof (Worker) !== "undefined") ? _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Timeout.setTimeout : setTimeout;
        this.privClearTimeout = (typeof (Blob) !== "undefined" && typeof (Worker) !== "undefined") ? _common_Exports__WEBPACK_IMPORTED_MODULE_4__.Timeout.clearTimeout : clearTimeout;
    }
    set connected(cb) {
        this.privConnection.connected = cb;
    }
    set disconnected(cb) {
        this.privConnection.disconnected = cb;
    }
    /**
     * Return the speech language used by the recognizer
     */
    get speechRecognitionLanguage() {
        return this.privSpeechRecognitionLanguage;
    }
    /**
     * Return the properties for the recognizer
     */
    get properties() {
        return this.privProperties;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    /**
     * Connect to the recognizer
     * @param token
     */
    connect(token, cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
            this.privReco.conversationTranslatorToken = token;
            this.resetConversationTimeout();
            this.privReco.connectAsync(cb, err);
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
        }
    }
    /**
     * Disconnect from the recognizer
     */
    disconnect(cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            if (this.privTimeoutToken !== undefined) {
                // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
                this.privClearTimeout(this.privTimeoutToken);
            }
            this.privReco.disconnect().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
            // Destroy the recognizer.
            this.dispose(true).catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_5__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.BackgroundEvent(reason));
            });
        }
    }
    /**
     * Send the mute all participants command to the websocket
     * @param conversationId
     * @param participantId
     * @param isMuted
     */
    sendRequest(command, cb, err) {
        try {
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            this.sendMessage(command, cb, err);
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
            // Destroy the recognizer.
            this.dispose(true).catch((reason) => {
                _common_Exports__WEBPACK_IMPORTED_MODULE_5__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.BackgroundEvent(reason));
            });
        }
    }
    /**
     * Close and dispose the recognizer
     */
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privIsDisposed) {
                if (!!this.privConnection) {
                    this.privConnection.closeConnection();
                    this.privConnection.close();
                }
                this.privConnection = undefined;
                yield this.dispose(true);
            }
        });
    }
    /**
     * Dispose the recognizer
     * @param disposing
     */
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privIsDisposed) {
                return;
            }
            if (disposing) {
                if (this.privTimeoutToken !== undefined) {
                    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
                    this.privClearTimeout(this.privTimeoutToken);
                }
                this.privIsDisposed = true;
                if (!!this.privConnection) {
                    this.privConnection.closeConnection();
                    this.privConnection.close();
                    this.privConnection = undefined;
                }
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    /**
     * Create the config for the recognizer
     * @param speechConfig
     */
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognizerConfig(speechConfig, this.privProperties);
    }
    /**
     * Create the service recognizer.
     * The audio source is redundnant here but is required by the implementation.
     * @param authentication
     * @param connectionFactory
     * @param audioConfig
     * @param recognizerConfig
     */
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioSource = audioConfig;
        return new _ConversationServiceAdapter__WEBPACK_IMPORTED_MODULE_8__.ConversationServiceAdapter(authentication, connectionFactory, audioSource, recognizerConfig, this);
    }
    sendMessage(msg, cb, err) {
        const withAsync = this.privReco;
        const PromiseToEmptyCallback = (promise, cb, err) => {
            if (promise !== undefined) {
                promise.then(() => {
                    try {
                        if (!!cb) {
                            cb();
                        }
                    }
                    catch (e) {
                        if (!!err) {
                            err(`'Unhandled error on promise callback: ${e}'`);
                        }
                    }
                }, (reason) => {
                    try {
                        if (!!err) {
                            err(reason);
                        }
                        // eslint-disable-next-line no-empty
                    }
                    catch (error) { }
                });
            }
            else {
                if (!!err) {
                    err("Null promise");
                }
            }
        };
        PromiseToEmptyCallback(withAsync.sendMessageAsync(msg), cb, err);
        this.resetConversationTimeout();
    }
    resetConversationTimeout() {
        if (this.privTimeoutToken !== undefined) {
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            this.privClearTimeout(this.privTimeoutToken);
        }
        this.privTimeoutToken = this.privSetTimeout(() => {
            this.sendRequest(this.privConversation.getKeepAlive());
        }, 60000);
    }
}

//# sourceMappingURL=ConversationTranslatorRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationWebsocketMessageFormatter.js":
/*!*****************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationWebsocketMessageFormatter.js ***!
  \*****************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationWebsocketMessageFormatter": () => (/* binding */ ConversationWebsocketMessageFormatter)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js");
/* harmony import */ var _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Based off WebsocketMessageFormatter. The messages for Conversation Translator have some variations from the Speech messages.
 */
class ConversationWebsocketMessageFormatter {
    /**
     * Format incoming messages: text (speech partial/final, IM) or binary (tts)
     */
    toConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const incomingMessage = new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionMessage(message.messageType, message.textContent, {}, message.id);
                deferral.resolve(incomingMessage);
            }
            else if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
                deferral.resolve(new _ConversationConnectionMessage__WEBPACK_IMPORTED_MODULE_2__.ConversationConnectionMessage(message.messageType, message.binaryContent, undefined, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. Error: ${e}`);
        }
        return deferral.promise;
    }
    /**
     * Format outgoing messages: text (commands or IM)
     */
    fromConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const payload = `${message.textBody ? message.textBody : ""}`;
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text, payload, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. ${e}`);
        }
        return deferral.promise;
    }
}

//# sourceMappingURL=ConversationWebsocketMessageFormatter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/Exports.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/Exports.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationConnectionConfig": () => (/* reexport safe */ _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig),
/* harmony export */   "ConversationManager": () => (/* reexport safe */ _ConversationManager__WEBPACK_IMPORTED_MODULE_0__.ConversationManager),
/* harmony export */   "ConversationReceivedTranslationEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ConversationReceivedTranslationEventArgs),
/* harmony export */   "ConversationRecognizerFactory": () => (/* reexport safe */ _ConversationTranslatorRecognizer__WEBPACK_IMPORTED_MODULE_2__.ConversationRecognizerFactory),
/* harmony export */   "ConversationTranslatorCommandTypes": () => (/* reexport safe */ _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__.ConversationTranslatorCommandTypes),
/* harmony export */   "ConversationTranslatorMessageTypes": () => (/* reexport safe */ _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__.ConversationTranslatorMessageTypes),
/* harmony export */   "InternalParticipants": () => (/* reexport safe */ _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__.InternalParticipants),
/* harmony export */   "LockRoomEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.LockRoomEventArgs),
/* harmony export */   "MuteAllEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.MuteAllEventArgs),
/* harmony export */   "ParticipantAttributeEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ParticipantAttributeEventArgs),
/* harmony export */   "ParticipantEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ParticipantEventArgs),
/* harmony export */   "ParticipantsListEventArgs": () => (/* reexport safe */ _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__.ParticipantsListEventArgs),
/* harmony export */   "TranscriberRecognizer": () => (/* reexport safe */ _TranscriberRecognizer__WEBPACK_IMPORTED_MODULE_3__.TranscriberRecognizer)
/* harmony export */ });
/* harmony import */ var _ConversationManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConversationManager */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js");
/* harmony import */ var _ConversationConnectionConfig__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConversationConnectionConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _ConversationTranslatorRecognizer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ConversationTranslatorRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js");
/* harmony import */ var _TranscriberRecognizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TranscriberRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js");
/* harmony import */ var _ConversationTranslatorEventArgs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ConversationTranslatorEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorEventArgs.js");
/* harmony import */ var _ConversationTranslatorInterfaces__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ConversationTranslatorInterfaces */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







//# sourceMappingURL=Exports.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/CommandResponsePayload.js":
/*!******************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/CommandResponsePayload.js ***!
  \******************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CommandResponsePayload": () => (/* binding */ CommandResponsePayload)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
const parseCommandResponse = (json) => JSON.parse(json);
class CommandResponsePayload {
    constructor(json) {
        this.privCommandResponse = parseCommandResponse(json);
    }
    get type() {
        return this.privCommandResponse.type;
    }
    get command() {
        return this.privCommandResponse.command;
    }
    get id() {
        return this.privCommandResponse.id;
    }
    get nickname() {
        return this.privCommandResponse.nickname;
    }
    get participantId() {
        return this.privCommandResponse.participantId;
    }
    get roomid() {
        return this.privCommandResponse.roomid;
    }
    get value() {
        return this.privCommandResponse.value;
    }
    get token() {
        return this.privCommandResponse.token;
    }
    static fromJSON(json) {
        return new CommandResponsePayload(json);
    }
}

//# sourceMappingURL=CommandResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/ParticipantResponsePayload.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/ParticipantResponsePayload.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ParticipantPayloadResponse": () => (/* binding */ ParticipantPayloadResponse),
/* harmony export */   "ParticipantsListPayloadResponse": () => (/* binding */ ParticipantsListPayloadResponse)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
const parseListResponse = (json) => JSON.parse(json);
const parseParticipantResponse = (json) => JSON.parse(json);
class ParticipantsListPayloadResponse {
    constructor(json) {
        this.privParticipantsPayloadResponse = parseListResponse(json);
    }
    get roomid() {
        return this.privParticipantsPayloadResponse.roomid;
    }
    get id() {
        return this.privParticipantsPayloadResponse.id;
    }
    get command() {
        return this.privParticipantsPayloadResponse.command;
    }
    get participants() {
        return this.privParticipantsPayloadResponse.participants;
    }
    get token() {
        return this.privParticipantsPayloadResponse.token;
    }
    get translateTo() {
        return this.privParticipantsPayloadResponse.translateTo;
    }
    get profanityFilter() {
        return this.privParticipantsPayloadResponse.profanityFilter;
    }
    get roomProfanityFilter() {
        return this.privParticipantsPayloadResponse.roomProfanityFilter;
    }
    get roomLocked() {
        return this.privParticipantsPayloadResponse.roomLocked;
    }
    get muteAll() {
        return this.privParticipantsPayloadResponse.muteAll;
    }
    get type() {
        return this.privParticipantsPayloadResponse.type;
    }
    static fromJSON(json) {
        return new ParticipantsListPayloadResponse(json);
    }
}
class ParticipantPayloadResponse {
    constructor(json) {
        this.privParticipantPayloadResponse = parseParticipantResponse(json);
    }
    get nickname() {
        return this.privParticipantPayloadResponse.nickname;
    }
    get locale() {
        return this.privParticipantPayloadResponse.locale;
    }
    get usetts() {
        return this.privParticipantPayloadResponse.usetts;
    }
    get ismuted() {
        return this.privParticipantPayloadResponse.ismuted;
    }
    get ishost() {
        return this.privParticipantPayloadResponse.ishost;
    }
    get participantId() {
        return this.privParticipantPayloadResponse.participantId;
    }
    get avatar() {
        return this.privParticipantPayloadResponse.avatar;
    }
    static fromJSON(json) {
        return new ParticipantPayloadResponse(json);
    }
}

//# sourceMappingURL=ParticipantResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/TranslationResponsePayload.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ServiceMessages/TranslationResponsePayload.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechResponsePayload": () => (/* binding */ SpeechResponsePayload),
/* harmony export */   "TextResponsePayload": () => (/* binding */ TextResponsePayload)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
const parseSpeechResponse = (json) => JSON.parse(json);
const parseTextResponse = (json) => JSON.parse(json);
class SpeechResponsePayload {
    constructor(json) {
        this.privSpeechResponse = parseSpeechResponse(json);
    }
    get recognition() {
        return this.privSpeechResponse.recognition;
    }
    get translations() {
        return this.privSpeechResponse.translations;
    }
    get id() {
        return this.privSpeechResponse.id;
    }
    get language() {
        return this.privSpeechResponse.language;
    }
    get nickname() {
        return this.privSpeechResponse.nickname;
    }
    get participantId() {
        return this.privSpeechResponse.participantId;
    }
    get roomid() {
        return this.privSpeechResponse.roomid;
    }
    get timestamp() {
        return this.privSpeechResponse.timestamp;
    }
    get type() {
        return this.privSpeechResponse.type;
    }
    get isFinal() {
        return this.privSpeechResponse.type === "final";
    }
    static fromJSON(json) {
        return new SpeechResponsePayload(json);
    }
}
class TextResponsePayload {
    constructor(json) {
        this.privTextResponse = parseTextResponse(json);
    }
    get originalText() {
        return this.privTextResponse.originalText;
    }
    get translations() {
        return this.privTextResponse.translations;
    }
    get id() {
        return this.privTextResponse.id;
    }
    get language() {
        return this.privTextResponse.language;
    }
    get nickname() {
        return this.privTextResponse.nickname;
    }
    get participantId() {
        return this.privTextResponse.participantId;
    }
    get roomid() {
        return this.privTextResponse.roomid;
    }
    get timestamp() {
        return this.privTextResponse.timestamp;
    }
    get type() {
        return this.privTextResponse.type;
    }
    static fromJSON(json) {
        return new TextResponsePayload(json);
    }
}

//# sourceMappingURL=TranslationResponsePayload.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranscriberRecognizer": () => (/* binding */ TranscriberRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../sdk/Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriberConnectionFactory.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class TranscriberRecognizer extends _sdk_Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * TranscriberRecognizer constructor.
     * @constructor
     * @param {SpeechTranslationConfig} speechTranslationConfig - Non-audio configuration associated with the recognizer
     * @param {AudioConfig} audioConfig - An audio configuration associated with the recognizer
     */
    constructor(speechTranslationConfig, audioConfig) {
        const speechTranslationConfigImpl = speechTranslationConfig;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(speechTranslationConfigImpl, "speechTranslationConfig");
        const audioConfigImpl = audioConfig;
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(audioConfigImpl, "audioConfigImpl");
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(speechTranslationConfigImpl.speechRecognitionLanguage, _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        super(audioConfig, speechTranslationConfigImpl.properties, new _Exports__WEBPACK_IMPORTED_MODULE_3__.TranscriberConnectionFactory());
        this.privDisposedRecognizer = false;
    }
    get speechRecognitionLanguage() {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    get properties() {
        return this.privProperties;
    }
    get authorizationToken() {
        return this.properties.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token);
    }
    set authorizationToken(token) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    set conversation(c) {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(c, "Conversation");
        this.privConversation = c;
    }
    getConversationInfo() {
        _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(this.privConversation, "Conversation");
        return this.privConversation.conversationInfo;
    }
    startContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privDisposedRecognizer) {
                yield this.dispose(true);
            }
        });
    }
    // Push async join/leave conversation message via serviceRecognizer
    pushConversationEvent(conversationInfo, command) {
        return __awaiter(this, void 0, void 0, function* () {
            const reco = (this.privReco);
            _sdk_Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(reco, "serviceRecognizer");
            yield reco.sendSpeechEventAsync(conversationInfo, command);
        });
    }
    enforceAudioGating() {
        return __awaiter(this, void 0, void 0, function* () {
            const audioConfigImpl = this.audioConfig;
            const format = yield audioConfigImpl.format;
            const channels = format.channels;
            if (channels === 1) {
                if (this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2", "false").toLowerCase() !== "true") {
                    throw new Error("Single channel audio configuration for ConversationTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details");
                }
            }
            else if (channels !== 8) {
                throw new Error(`Unsupported audio configuration: Detected ${channels}-channel audio`);
            }
            return;
        });
    }
    connectCallbacks(transcriber) {
        this.canceled = (s, e) => {
            if (!!transcriber.canceled) {
                transcriber.canceled(transcriber, e);
            }
        };
        this.recognizing = (s, e) => {
            if (!!transcriber.transcribing) {
                transcriber.transcribing(transcriber, e);
            }
        };
        this.recognized = (s, e) => {
            if (!!transcriber.transcribed) {
                transcriber.transcribed(transcriber, e);
            }
        };
        this.sessionStarted = (s, e) => {
            if (!!transcriber.sessionStarted) {
                transcriber.sessionStarted(transcriber, e);
            }
        };
        this.sessionStopped = (s, e) => {
            if (!!transcriber.sessionStopped) {
                transcriber.sessionStopped(transcriber, e);
            }
        };
    }
    disconnectCallbacks() {
        this.canceled = undefined;
        this.recognizing = undefined;
        this.recognized = undefined;
        this.sessionStarted = undefined;
        this.sessionStopped = undefined;
    }
    /**
     * Disposes any resources held by the object.
     * @member ConversationTranscriber.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - true if disposing the object.
     */
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedRecognizer = true;
                yield this.implRecognizerStop();
            }
            yield _super.dispose.call(this, disposing);
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.properties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const configImpl = audioConfig;
        return new _Exports__WEBPACK_IMPORTED_MODULE_6__.TranscriptionServiceRecognizer(authentication, connectionFactory, configImpl, recognizerConfig, this);
    }
}

//# sourceMappingURL=TranscriberRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js":
/*!********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranscriptionServiceRecognizer.js ***!
  \********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranscriptionServiceRecognizer": () => (/* binding */ TranscriptionServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




// eslint-disable-next-line max-classes-per-file
class TranscriptionServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ConversationServiceRecognizer {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, transcriber) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, transcriber);
        this.privTranscriberRecognizer = transcriber;
        this.sendPrePayloadJSONOverride = (connection) => this.sendTranscriptionStartJSON(connection);
        if (this.privRecognizerConfig.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps) === "true") {
            this.privSpeechContext.setWordLevelTimings();
        }
    }
    sendSpeechEventAsync(info, command) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privRequestSession.isRecognizing) {
                const connection = yield this.fetchConnection();
                yield this.sendSpeechEvent(connection, this.createSpeechEventPayload(info, command));
            }
        });
    }
    processTypeSpecificMessages(connectionMessage) {
        return this.processSpeechMessages(connectionMessage);
    }
    handleRecognizedCallback(result, offset, sessionId) {
        try {
            const event = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionEventArgs(result, offset, sessionId);
            this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer, event);
            if (!!this.privSuccessCallback) {
                try {
                    this.privSuccessCallback(result);
                }
                catch (e) {
                    if (!!this.privErrorCallback) {
                        this.privErrorCallback(e);
                    }
                }
                // Only invoke the call back once.
                // and if it's successful don't invoke the
                // error after that.
                this.privSuccessCallback = undefined;
                this.privErrorCallback = undefined;
            }
            /* eslint-disable no-empty */
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    handleRecognizingCallback(result, duration, sessionId) {
        try {
            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechRecognitionEventArgs(result, duration, sessionId);
            this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer, ev);
            /* eslint-disable no-empty */
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationErrorCode[errorCode]);
        if (!!this.privTranscriberRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.ConversationTranscriptionCanceledEventArgs(cancellationReason, error, errorCode, undefined, sessionId);
            try {
                this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_7__.SpeechRecognitionResult(requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.ResultReason.Canceled, undefined, // Text
            undefined, // Duration
            undefined, // Offset
            undefined, // Language
            undefined, // Language Detection Confidence
            undefined, // Speaker Id
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                this.privSuccessCallback = undefined;
                /* eslint-disable no-empty */
            }
            catch (_b) { }
        }
    }
    // Encapsulated for derived service recognizers that need to send additional JSON
    sendTranscriptionStartJSON(connection) {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.sendSpeechContext(connection, true);
            const info = this.privTranscriberRecognizer.getConversationInfo();
            const payload = this.createSpeechEventPayload(info, "start");
            yield this.sendSpeechEvent(connection, payload);
            yield this.sendWaveHeader(connection);
            return;
        });
    }
    sendSpeechEvent(connection, payload) {
        const speechEventJson = JSON.stringify(payload);
        if (speechEventJson) {
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_9__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_10__.MessageType.Text, "speech.event", this.privRequestSession.requestId, "application/json", speechEventJson));
        }
        return;
    }
    createSpeechEventPayload(info, command) {
        const eventDict = { id: "meeting", name: command, meeting: info.conversationProperties };
        eventDict.meeting.id = info.id;
        eventDict.meeting.attendees = info.participants;
        eventDict.meeting.record = info.conversationProperties.audiorecording === "on" ? "true" : "false";
        return eventDict;
    }
}

//# sourceMappingURL=TranscriptionServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationConnectionFactory": () => (/* binding */ TranslationConnectionFactory)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/WebsocketConnection.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ProxyInfo.js");
/* harmony import */ var _common_StringUtils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/StringUtils */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ConnectionFactoryBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConnectionFactoryBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js");
/* harmony import */ var _HeaderNames__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./QueryParameterNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/QueryParameterNames.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.







class TranslationConnectionFactory extends _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase {
    create(config, authInfo, connectionId) {
        const endpoint = this.getEndpointUrl(config);
        const queryParams = {};
        if (config.autoDetectSourceLanguages !== undefined) {
            queryParams[_QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.EnableLanguageId] = "true";
        }
        this.setQueryParams(queryParams, config, endpoint);
        const headers = {};
        if (authInfo.token !== undefined && authInfo.token !== "") {
            headers[authInfo.headerName] = authInfo.token;
        }
        headers[_HeaderNames__WEBPACK_IMPORTED_MODULE_2__.HeaderNames.ConnectionId] = connectionId;
        config.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Url, endpoint);
        const enableCompression = config.parameters.getProperty("SPEECH-EnableWebsocketCompression", "false") === "true";
        return new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_4__.WebsocketConnection(endpoint, queryParams, headers, new _Exports__WEBPACK_IMPORTED_MODULE_5__.WebsocketMessageFormatter(), _common_browser_Exports__WEBPACK_IMPORTED_MODULE_6__.ProxyInfo.fromRecognizerConfig(config), enableCompression, connectionId);
    }
    getEndpointUrl(config, returnRegionPlaceholder) {
        const region = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Region);
        const hostSuffix = _ConnectionFactoryBase__WEBPACK_IMPORTED_MODULE_0__.ConnectionFactoryBase.getHostSuffix(region);
        let endpointUrl = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Endpoint, undefined);
        if (!endpointUrl) {
            if (config.autoDetectSourceLanguages !== undefined) {
                const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Host, "wss://{region}.stt.speech" + hostSuffix);
                endpointUrl = host + "/speech/universal/v2";
            }
            else {
                const host = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Host, "wss://{region}.s2s.speech" + hostSuffix);
                endpointUrl = host + "/speech/translation/cognitiveservices/v1";
            }
        }
        if (returnRegionPlaceholder === true) {
            return endpointUrl;
        }
        return _common_StringUtils__WEBPACK_IMPORTED_MODULE_7__.StringUtils.formatString(endpointUrl, { region });
    }
    setQueryParams(queryParams, config, endpointUrl) {
        queryParams.from = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage);
        queryParams.to = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages);
        this.setCommonUrlParams(config, queryParams, endpointUrl);
        this.setUrlParameter(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult, _QueryParameterNames__WEBPACK_IMPORTED_MODULE_1__.QueryParameterNames.StableTranslation, config, queryParams, endpointUrl);
        const translationVoice = config.parameters.getProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice, undefined);
        if (translationVoice !== undefined) {
            queryParams.voice = translationVoice;
            queryParams.features = "texttospeech";
        }
    }
}

//# sourceMappingURL=TranslationConnectionFactory.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationServiceRecognizer": () => (/* binding */ TranslationServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ConversationServiceRecognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationHypothesis.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationPhrase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TranslationSynthesisEnd.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



// eslint-disable-next-line max-classes-per-file
class TranslationServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ConversationServiceRecognizer {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, translationRecognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, translationRecognizer);
        this.privTranslationRecognizer = translationRecognizer;
        this.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionEstablishedEvent") {
                this.privTranslationRecognizer.onConnection();
            }
            else if (connectionEvent.name === "ConnectionClosedEvent") {
                void this.privTranslationRecognizer.onDisconnection();
            }
        });
    }
    processTypeSpecificMessages(connectionMessage) {
        return __awaiter(this, void 0, void 0, function* () {
            const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
            let processed = yield this.processSpeechMessages(connectionMessage);
            if (processed) {
                return true;
            }
            const handleTranslationPhrase = (translatedPhrase) => __awaiter(this, void 0, void 0, function* () {
                this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset + translatedPhrase.Offset + translatedPhrase.Duration);
                if (translatedPhrase.RecognitionStatus === _Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.Success) {
                    // OK, the recognition was successful. How'd the translation do?
                    const result = this.fireEventForResult(translatedPhrase, resultProps);
                    if (!!this.privTranslationRecognizer.recognized) {
                        try {
                            this.privTranslationRecognizer.recognized(this.privTranslationRecognizer, result);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    // report result to promise.
                    if (!!this.privSuccessCallback) {
                        try {
                            this.privSuccessCallback(result.result);
                        }
                        catch (e) {
                            if (!!this.privErrorCallback) {
                                this.privErrorCallback(e);
                            }
                        }
                        // Only invoke the call back once.
                        // and if it's successful don't invoke the
                        // error after that.
                        this.privSuccessCallback = undefined;
                        this.privErrorCallback = undefined;
                    }
                }
                else {
                    const reason = _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateRecognitionResult(translatedPhrase.RecognitionStatus);
                    const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult(undefined, this.privRequestSession.requestId, reason, translatedPhrase.Text, translatedPhrase.Duration, this.privRequestSession.currentTurnAudioOffset + translatedPhrase.Offset, translatedPhrase.Language, translatedPhrase.Confidence, undefined, connectionMessage.textBody, resultProps);
                    if (reason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled) {
                        const cancelReason = _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateCancelResult(translatedPhrase.RecognitionStatus);
                        const cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateCancelErrorCode(translatedPhrase.RecognitionStatus);
                        yield this.cancelRecognitionLocal(cancelReason, cancellationErrorCode, _Exports__WEBPACK_IMPORTED_MODULE_3__.EnumTranslation.implTranslateErrorDetails(cancellationErrorCode));
                    }
                    else {
                        if (!(this.privRequestSession.isSpeechEnded && reason === _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.NoMatch && translatedPhrase.RecognitionStatus !== _Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.InitialSilenceTimeout)) {
                            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(result, result.offset, this.privRequestSession.sessionId);
                            if (!!this.privTranslationRecognizer.recognized) {
                                try {
                                    this.privTranslationRecognizer.recognized(this.privTranslationRecognizer, ev);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                        }
                        // report result to promise.
                        if (!!this.privSuccessCallback) {
                            try {
                                this.privSuccessCallback(result);
                            }
                            catch (e) {
                                if (!!this.privErrorCallback) {
                                    this.privErrorCallback(e);
                                }
                            }
                            // Only invoke the call back once.
                            // and if it's successful don't invoke the
                            // error after that.
                            this.privSuccessCallback = undefined;
                            this.privErrorCallback = undefined;
                        }
                    }
                    processed = true;
                }
            });
            if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_7__.MessageType.Text) {
                resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
            }
            switch (connectionMessage.path.toLowerCase()) {
                case "translation.hypothesis":
                    const result = this.fireEventForResult(_Exports__WEBPACK_IMPORTED_MODULE_9__.TranslationHypothesis.fromJSON(connectionMessage.textBody), resultProps);
                    this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset + result.offset);
                    if (!!this.privTranslationRecognizer.recognizing) {
                        try {
                            this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer, result);
                            /* eslint-disable no-empty */
                        }
                        catch (error) {
                            // Not going to let errors in the event handler
                            // trip things up.
                        }
                    }
                    processed = true;
                    break;
                case "translation.response":
                    const phrase = JSON.parse(connectionMessage.textBody);
                    if (!!phrase.SpeechPhrase) {
                        yield handleTranslationPhrase(_Exports__WEBPACK_IMPORTED_MODULE_10__.TranslationPhrase.fromTranslationResponse(phrase));
                    }
                    break;
                case "translation.phrase":
                    yield handleTranslationPhrase(_Exports__WEBPACK_IMPORTED_MODULE_10__.TranslationPhrase.fromJSON(connectionMessage.textBody));
                    break;
                case "translation.synthesis":
                    this.sendSynthesisAudio(connectionMessage.binaryBody, this.privRequestSession.sessionId);
                    processed = true;
                    break;
                case "audio.end":
                case "translation.synthesis.end":
                    const synthEnd = _Exports__WEBPACK_IMPORTED_MODULE_11__.TranslationSynthesisEnd.fromJSON(connectionMessage.textBody);
                    switch (synthEnd.SynthesisStatus) {
                        case _Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisStatus.Error:
                            if (!!this.privTranslationRecognizer.synthesizing) {
                                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.TranslationSynthesisResult(_sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, undefined);
                                const retEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.TranslationSynthesisEventArgs(result, this.privRequestSession.sessionId);
                                try {
                                    this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer, retEvent);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                            if (!!this.privTranslationRecognizer.canceled) {
                                // And raise a canceled event to send the rich(er) error message back.
                                const canceledResult = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.CancellationReason.Error, synthEnd.FailureReason, _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.CancellationErrorCode.ServiceError, null);
                                try {
                                    this.privTranslationRecognizer.canceled(this.privTranslationRecognizer, canceledResult);
                                    /* eslint-disable no-empty */
                                }
                                catch (error) {
                                    // Not going to let errors in the event handler
                                    // trip things up.
                                }
                            }
                            break;
                        case _Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisStatus.Success:
                            this.sendSynthesisAudio(undefined, this.privRequestSession.sessionId);
                            break;
                        default:
                            break;
                    }
                    processed = true;
                    break;
                default:
                    break;
            }
            return processed;
        });
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyCollection();
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_17__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.CancellationErrorCode[errorCode]);
        if (!!this.privTranslationRecognizer.canceled) {
            const cancelEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.TranslationRecognitionCanceledEventArgs(sessionId, cancellationReason, error, errorCode, undefined);
            try {
                this.privTranslationRecognizer.canceled(this.privTranslationRecognizer, cancelEvent);
                /* eslint-disable no-empty */
            }
            catch (_a) { }
        }
        if (!!this.privSuccessCallback) {
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult(undefined, // Translations
            requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.Canceled, undefined, // Text
            undefined, // Druation
            undefined, // Offset
            undefined, // Language
            undefined, // LanguageDetectionConfidence
            error, undefined, // Json
            properties);
            try {
                this.privSuccessCallback(result);
                /* eslint-disable no-empty */
                this.privSuccessCallback = undefined;
            }
            catch (_b) { }
        }
    }
    handleRecognizingCallback(result, duration, sessionId) {
        try {
            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult.fromSpeechRecognitionResult(result), duration, sessionId);
            this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer, ev);
            /* eslint-disable no-empty */
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    handleRecognizedCallback(result, offset, sessionId) {
        try {
            const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult.fromSpeechRecognitionResult(result), offset, sessionId);
            this.privTranslationRecognizer.recognized(this.privTranslationRecognizer, ev);
        }
        catch (error) {
            // Not going to let errors in the event handler
            // trip things up.
        }
    }
    fireEventForResult(serviceResult, properties) {
        let translations;
        if (undefined !== serviceResult.Translation.Translations) {
            translations = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_18__.Translations();
            for (const translation of serviceResult.Translation.Translations) {
                translations.set(translation.Language, translation.Text || translation.DisplayText);
            }
        }
        let resultReason;
        let language;
        let confidence;
        if (serviceResult instanceof _Exports__WEBPACK_IMPORTED_MODULE_10__.TranslationPhrase) {
            if (!!serviceResult.Translation && serviceResult.Translation.TranslationStatus === _common_Exports__WEBPACK_IMPORTED_MODULE_19__.TranslationStatus.Success) {
                resultReason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.TranslatedSpeech;
            }
            else {
                resultReason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.RecognizedSpeech;
            }
            language = serviceResult.Language;
            confidence = serviceResult.Confidence;
        }
        else {
            resultReason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.TranslatingSpeech;
        }
        const offset = serviceResult.Offset + this.privRequestSession.currentTurnAudioOffset;
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.TranslationRecognitionResult(translations, this.privRequestSession.requestId, resultReason, serviceResult.Text, serviceResult.Duration, offset, language, confidence, serviceResult.Translation.FailureReason, JSON.stringify(serviceResult), properties);
        const ev = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationRecognitionEventArgs(result, offset, this.privRequestSession.sessionId);
        return ev;
    }
    sendSynthesisAudio(audio, sessionId) {
        const reason = (undefined === audio) ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.SynthesizingAudioCompleted : _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.ResultReason.SynthesizingAudio;
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.TranslationSynthesisResult(reason, audio);
        const retEvent = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_13__.TranslationSynthesisEventArgs(result, sessionId);
        if (!!this.privTranslationRecognizer.synthesizing) {
            try {
                this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer, retEvent);
                /* eslint-disable no-empty */
            }
            catch (error) {
                // Not going to let errors in the event handler
                // trip things up.
            }
        }
    }
}

//# sourceMappingURL=TranslationServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationStatus.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationStatus": () => (/* binding */ TranslationStatus)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines translation status.
 * @class TranslationStatus
 */
var TranslationStatus;
(function (TranslationStatus) {
    /**
     * @member TranslationStatus.Success
     */
    TranslationStatus[TranslationStatus["Success"] = 0] = "Success";
    /**
     * @member TranslationStatus.Error
     */
    TranslationStatus[TranslationStatus["Error"] = 1] = "Error";
})(TranslationStatus || (TranslationStatus = {}));

//# sourceMappingURL=TranslationStatus.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceServiceRecognizer": () => (/* binding */ VoiceServiceRecognizer)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ReplayableAudioNode.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DeferralMap.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js");
/* harmony import */ var _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../sdk/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SpeechConnectionMessage.Internal */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionMessage.Internal.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





// eslint-disable-next-line max-classes-per-file
class VoiceServiceRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.ServiceRecognizerBase {
    constructor(authentication, connectionFactory, audioSource, recognizerConfig, recognizer) {
        super(authentication, connectionFactory, audioSource, recognizerConfig, recognizer);
        this.privDeferralMap = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.DeferralMap();
        this.privSpeakerAudioSource = audioSource;
        this.sendPrePayloadJSONOverride = () => this.noOp();
    }
    set SpeakerAudioSource(audioSource) {
        this.privSpeakerAudioSource = audioSource;
    }
    processTypeSpecificMessages(connectionMessage) {
        let processed = false;
        const resultProps = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        if (connectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text) {
            resultProps.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, connectionMessage.textBody);
        }
        switch (connectionMessage.path.toLowerCase()) {
            // Profile management response for create, fetch, delete, reset
            case "speaker.profiles":
                const response = JSON.parse(connectionMessage.textBody);
                switch (response.operation.toLowerCase()) {
                    case "create":
                        this.handleCreateResponse(response, connectionMessage.requestId);
                        break;
                    case "delete":
                    case "reset":
                        this.handleResultResponse(response, connectionMessage.requestId);
                        break;
                    case "fetch":
                        const enrollmentResponse = JSON.parse(connectionMessage.textBody);
                        this.handleFetchResponse(enrollmentResponse, connectionMessage.requestId);
                        break;
                    default:
                        break;
                }
                processed = true;
                break;
            // Activation and authorization phrase response
            case "speaker.phrases":
                const phraseResponse = JSON.parse(connectionMessage.textBody);
                this.handlePhrasesResponse(phraseResponse, connectionMessage.requestId);
                processed = true;
                break;
            // Enrollment response
            case "speaker.profile.enrollment":
                const enrollmentResponse = JSON.parse(connectionMessage.textBody);
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(!!enrollmentResponse.enrollment ? enrollmentResponse.enrollment.enrollmentStatus : enrollmentResponse.status.statusCode), !!enrollmentResponse.enrollment ? JSON.stringify(enrollmentResponse.enrollment) : undefined, enrollmentResponse.status.reason);
                if (!!this.privDeferralMap.getId(connectionMessage.requestId)) {
                    this.privDeferralMap.complete(connectionMessage.requestId, result);
                }
                this.privRequestSession.onSpeechEnded();
                processed = true;
                break;
            default:
                break;
        }
        const defferal = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
        defferal.resolve(processed);
        return defferal.promise;
    }
    // Cancels recognition.
    cancelRecognition(sessionId, requestId, cancellationReason, errorCode, error) {
        const properties = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        // const enrollmentResponse: EnrollmentResponse = JSON.parse(connectionMessage.textBody) as EnrollmentResponse;
        properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_7__.CancellationErrorCodePropertyName, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode[errorCode]);
        const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(_sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled, error, error);
        if (!!this.privDeferralMap.getId(requestId)) {
            this.privDeferralMap.complete(requestId, result);
        }
    }
    createProfile(profileType, locale) {
        return __awaiter(this, void 0, void 0, function* () {
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            this.voiceProfileType = profileType.toString();
            const conPromise = this.connectImpl();
            try {
                const createProfileDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
                yield conPromise;
                yield this.sendCreateProfile(createProfileDeferral, profileType, locale);
                void this.receiveMessage();
                return createProfileDeferral.promise;
            }
            catch (err) {
                throw err;
            }
        });
    }
    resetProfile(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            return this.sendCommonRequest("reset", profile.profileType, profile);
        });
    }
    deleteProfile(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            return this.sendCommonRequest("delete", profile.profileType, profile);
        });
    }
    retrieveEnrollmentResult(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            this.privExpectedProfileId = profile.profileId;
            return this.sendCommonRequest("fetch", profile.profileType, profile);
        });
    }
    getAllProfiles(profileType) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profileType.toString();
            return this.sendCommonRequest("fetch", profileType);
        });
    }
    getActivationPhrases(profileType, lang) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profileType.toString();
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            try {
                const getPhrasesDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
                yield conPromise;
                yield this.sendPhrasesRequest(getPhrasesDeferral, profileType, lang);
                void this.receiveMessage();
                return getPhrasesDeferral.promise;
            }
            catch (err) {
                throw err;
            }
        });
    }
    enrollProfile(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.voiceProfileType = profile.profileType.toString();
            const enrollmentDeferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
            this.privRequestSession.startNewRecognition();
            this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events);
            this.privRecognizerConfig.parameters.setProperty(_sdk_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Speech_SessionId, this.privRequestSession.sessionId);
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            const preAudioPromise = this.sendPreAudioMessages(profile, enrollmentDeferral);
            const node = yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId);
            const format = yield this.privSpeakerAudioSource.format;
            const deviceInfo = yield this.privSpeakerAudioSource.deviceInfo;
            const audioNode = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_10__.ReplayableAudioNode(node, format.avgBytesPerSec);
            yield this.privRequestSession.onAudioSourceAttachCompleted(audioNode, false);
            this.privRecognizerConfig.SpeechServiceConfig.Context.audio = { source: deviceInfo };
            try {
                yield conPromise;
                yield preAudioPromise;
            }
            catch (err) {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.ConnectionFailure, err);
            }
            const sessionStartEventArgs = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_12__.SessionEventArgs(this.privRequestSession.sessionId);
            if (!!this.privRecognizer.sessionStarted) {
                this.privRecognizer.sessionStarted(this.privRecognizer, sessionStartEventArgs);
            }
            void this.receiveMessage();
            const audioSendPromise = this.sendAudio(audioNode);
            // /* eslint-disable no-empty */
            audioSendPromise.then(() => { }, (error) => {
                this.cancelRecognition(this.privRequestSession.sessionId, this.privRequestSession.requestId, _sdk_Exports__WEBPACK_IMPORTED_MODULE_11__.CancellationReason.Error, _sdk_Exports__WEBPACK_IMPORTED_MODULE_8__.CancellationErrorCode.RuntimeError, error);
            });
            return enrollmentDeferral.promise;
        });
    }
    sendPreAudioMessages(profile, enrollmentDeferral) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.privRequestSession.onSpeechContext();
            this.privDeferralMap.add(this.privRequestSession.requestId, enrollmentDeferral);
            yield this.sendBaseRequest(connection, "enroll", this.scenarioFrom(profile.profileType), profile);
        });
    }
    sendPhrasesRequest(getPhrasesDeferral, profileType, locale) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.privRequestSession.onSpeechContext();
            this.privDeferralMap.add(this.privRequestSession.requestId, getPhrasesDeferral);
            const scenario = this.scenarioFrom(profileType);
            const profileCreateRequest = {
                locale,
                scenario,
            };
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text, "speaker.profile.phrases", this.privRequestSession.requestId, "application/json; charset=utf-8", JSON.stringify(profileCreateRequest)));
        });
    }
    sendCreateProfile(createProfileDeferral, profileType, locale) {
        return __awaiter(this, void 0, void 0, function* () {
            const connection = yield this.fetchConnection();
            this.privRequestSession.onSpeechContext();
            this.privDeferralMap.add(this.privRequestSession.requestId, createProfileDeferral);
            const scenario = profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentIdentification ? "TextIndependentIdentification" :
                profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentVerification ? "TextIndependentVerification" : "TextDependentVerification";
            const profileCreateRequest = {
                locale,
                number: "1",
                scenario,
            };
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text, "speaker.profile.create", this.privRequestSession.requestId, "application/json; charset=utf-8", JSON.stringify(profileCreateRequest)));
        });
    }
    sendCommonRequest(operation, profileType, profile = undefined) {
        return __awaiter(this, void 0, void 0, function* () {
            // Start the connection to the service. The promise this will create is stored and will be used by configureConnection().
            const conPromise = this.connectImpl();
            try {
                const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Deferred();
                this.privRequestSession.onSpeechContext();
                yield conPromise;
                const connection = yield this.fetchConnection();
                this.privDeferralMap.add(this.privRequestSession.requestId, deferral);
                yield this.sendBaseRequest(connection, operation, this.scenarioFrom(profileType), profile);
                void this.receiveMessage();
                return deferral.promise;
            }
            catch (err) {
                throw err;
            }
        });
    }
    sendBaseRequest(connection, operation, scenario, profile) {
        return __awaiter(this, void 0, void 0, function* () {
            const profileRequest = {
                scenario
            };
            if (!!profile) {
                profileRequest.profileIds = [profile.profileId];
            }
            else {
                profileRequest.maxPageSize = -1;
            }
            return connection.send(new _SpeechConnectionMessage_Internal__WEBPACK_IMPORTED_MODULE_13__.SpeechConnectionMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text, `speaker.profile.${operation}`, this.privRequestSession.requestId, "application/json; charset=utf-8", JSON.stringify(profileRequest)));
        });
    }
    extractSpeakerContext(model) {
        return {
            features: {
                interimResult: "enabled",
                progressiveDetection: "disabled",
            },
            profileIds: model.profileIds,
            scenario: model.scenario,
        };
    }
    handlePhrasesResponse(response, requestId) {
        if (!!this.privDeferralMap.getId(requestId)) {
            if (response.status.statusCode.toLowerCase() !== "success") {
                const reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled;
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.VoiceProfilePhraseResult(reason, response.status.statusCode, response.passPhraseType, []);
                this.privDeferralMap.complete(requestId, result);
            }
            else if (!!response.phrases && response.phrases.length > 0) {
                const reason = _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.EnrollingVoiceProfile;
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_15__.VoiceProfilePhraseResult(reason, response.status.statusCode, response.passPhraseType, response.phrases);
                this.privDeferralMap.complete(requestId, result);
            }
            else {
                throw new Error("Voice Profile get activation phrases failed, no phrases received");
            }
        }
        else {
            throw new Error(`Voice Profile get activation phrases request for requestID ${requestId} not found`);
        }
    }
    handleCreateResponse(response, requestId) {
        if (!!response.profiles && response.profiles.length > 0) {
            if (!!this.privDeferralMap.getId(requestId)) {
                const profileIds = response.profiles.map((profile) => profile.profileId);
                this.privDeferralMap.complete(requestId, profileIds);
            }
            else {
                throw new Error(`Voice Profile create request for requestID ${requestId} not found`);
            }
        }
        else {
            throw new Error("Voice Profile create failed, no profile id received");
        }
    }
    handleResultResponse(response, requestId) {
        if (!!this.privDeferralMap.getId(requestId)) {
            const successReason = response.operation.toLowerCase() === "delete" ? _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.DeletedVoiceProfile : _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.ResetVoiceProfile;
            const reason = response.status.statusCode.toLowerCase() === "success" ? successReason : _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled;
            const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_16__.VoiceProfileResult(reason, `statusCode: ${response.status.statusCode}, errorDetails: ${response.status.reason}`);
            this.privDeferralMap.complete(requestId, result);
        }
        else {
            throw new Error(`Voice Profile create request for requestID ${requestId} not found`);
        }
    }
    handleFetchResponse(enrollmentResponse, requestId) {
        if (!!this.privDeferralMap.getId(requestId) && !!enrollmentResponse.profiles[0]) {
            if (!!this.privExpectedProfileId && enrollmentResponse.profiles.length === 1 && enrollmentResponse.profiles[0].profileId === this.privExpectedProfileId) {
                this.privExpectedProfileId = undefined;
                const profileInfo = enrollmentResponse.profiles[0];
                const result = new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(profileInfo.enrollmentStatus), JSON.stringify(profileInfo), enrollmentResponse.status.reason);
                this.privDeferralMap.complete(requestId, result);
            }
            else if (enrollmentResponse.profiles.length > 0) {
                const iProfiles = enrollmentResponse.profiles;
                const profileResults = [];
                for (const profile of iProfiles) {
                    profileResults.push(new _sdk_Exports__WEBPACK_IMPORTED_MODULE_5__.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(profile.enrollmentStatus), JSON.stringify(profile), enrollmentResponse.status.reason));
                }
                this.privDeferralMap.complete(requestId, profileResults);
            }
        }
        else {
            throw new Error(`Voice Profile fetch request for requestID ${requestId} not found`);
        }
    }
    enrollmentReasonFrom(statusCode) {
        switch (statusCode.toLowerCase()) {
            case "enrolled":
                return _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.EnrolledVoiceProfile;
            case "invalidlocale":
            case "invalidphrase":
            case "invalidaudioformat":
            case "invalidscenario":
            case "invalidprofilecount":
            case "invalidoperation":
            case "audiotooshort":
            case "audiotoolong":
            case "toomanyenrollments":
            case "storageconflict":
            case "profilenotfound":
            case "incompatibleprofiles":
            case "incompleteenrollment":
                return _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.Canceled;
            default:
                return _sdk_Exports__WEBPACK_IMPORTED_MODULE_9__.ResultReason.EnrollingVoiceProfile;
        }
    }
    scenarioFrom(profileType) {
        return profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentIdentification ? "TextIndependentIdentification" :
            profileType === _sdk_Exports__WEBPACK_IMPORTED_MODULE_14__.VoiceProfileType.TextIndependentVerification ? "TextIndependentVerification" : "TextDependentVerification";
    }
}

//# sourceMappingURL=VoiceServiceRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/WebsocketMessageFormatter.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebsocketMessageFormatter": () => (/* binding */ WebsocketMessageFormatter)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

const CRLF = "\r\n";
class WebsocketMessageFormatter {
    toConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const textMessage = message.textContent;
                let headers = {};
                let body = null;
                if (textMessage) {
                    const headerBodySplit = textMessage.split("\r\n\r\n");
                    if (headerBodySplit && headerBodySplit.length > 0) {
                        headers = this.parseHeaders(headerBodySplit[0]);
                        if (headerBodySplit.length > 1) {
                            body = headerBodySplit[1];
                        }
                    }
                }
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ConnectionMessage(message.messageType, body, headers, message.id));
            }
            else if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
                const binaryMessage = message.binaryContent;
                let headers = {};
                let body = null;
                if (!binaryMessage || binaryMessage.byteLength < 2) {
                    throw new Error("Invalid binary message format. Header length missing.");
                }
                const dataView = new DataView(binaryMessage);
                const headerLength = dataView.getInt16(0);
                if (binaryMessage.byteLength < headerLength + 2) {
                    throw new Error("Invalid binary message format. Header content missing.");
                }
                let headersString = "";
                for (let i = 0; i < headerLength; i++) {
                    headersString += String.fromCharCode((dataView).getInt8(i + 2));
                }
                headers = this.parseHeaders(headersString);
                if (binaryMessage.byteLength > headerLength + 2) {
                    body = binaryMessage.slice(2 + headerLength);
                }
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.ConnectionMessage(message.messageType, body, headers, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. Error: ${e}`);
        }
        return deferral.promise;
    }
    fromConnectionMessage(message) {
        const deferral = new _common_Exports__WEBPACK_IMPORTED_MODULE_0__.Deferred();
        try {
            if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
                const payload = `${this.makeHeaders(message)}${CRLF}${message.textBody ? message.textBody : ""}`;
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text, payload, message.id));
            }
            else if (message.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
                const headersString = this.makeHeaders(message);
                const content = message.binaryBody;
                const headerBuffer = this.stringToArrayBuffer(headersString);
                const headerInt8Array = new Int8Array(headerBuffer);
                const headerLength = headerInt8Array.byteLength;
                const payloadInt8Array = new Int8Array(2 + headerLength + (content ? content.byteLength : 0));
                payloadInt8Array[0] = ((headerLength >> 8) & 0xff);
                payloadInt8Array[1] = headerLength & 0xff;
                payloadInt8Array.set(headerInt8Array, 2);
                if (content) {
                    const bodyInt8Array = new Int8Array(content);
                    payloadInt8Array.set(bodyInt8Array, 2 + headerLength);
                }
                const payload = payloadInt8Array.buffer;
                deferral.resolve(new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.RawWebsocketMessage(_common_Exports__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary, payload, message.id));
            }
        }
        catch (e) {
            deferral.reject(`Error formatting the message. ${e}`);
        }
        return deferral.promise;
    }
    makeHeaders(message) {
        let headersString = "";
        if (message.headers) {
            for (const header in message.headers) {
                if (header) {
                    headersString += `${header}: ${message.headers[header]}${CRLF}`;
                }
            }
        }
        return headersString;
    }
    parseHeaders(headersString) {
        const headers = {};
        if (headersString) {
            const headerMatches = headersString.match(/[^\r\n]+/g);
            if (headers) {
                for (const header of headerMatches) {
                    if (header) {
                        const separatorIndex = header.indexOf(":");
                        const headerName = separatorIndex > 0 ? header.substr(0, separatorIndex).trim().toLowerCase() : header;
                        const headerValue = separatorIndex > 0 && header.length > (separatorIndex + 1) ?
                            header.substr(separatorIndex + 1).trim() :
                            "";
                        headers[headerName] = headerValue;
                    }
                }
            }
        }
        return headers;
    }
    stringToArrayBuffer(str) {
        const buffer = new ArrayBuffer(str.length);
        const view = new DataView(buffer);
        for (let i = 0; i < str.length; i++) {
            view.setUint8(i, str.charCodeAt(i));
        }
        return buffer;
    }
}

//# sourceMappingURL=WebsocketMessageFormatter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioSourceErrorEvent": () => (/* binding */ AudioSourceErrorEvent),
/* harmony export */   "AudioSourceEvent": () => (/* binding */ AudioSourceEvent),
/* harmony export */   "AudioSourceInitializingEvent": () => (/* binding */ AudioSourceInitializingEvent),
/* harmony export */   "AudioSourceOffEvent": () => (/* binding */ AudioSourceOffEvent),
/* harmony export */   "AudioSourceReadyEvent": () => (/* binding */ AudioSourceReadyEvent),
/* harmony export */   "AudioStreamNodeAttachedEvent": () => (/* binding */ AudioStreamNodeAttachedEvent),
/* harmony export */   "AudioStreamNodeAttachingEvent": () => (/* binding */ AudioStreamNodeAttachingEvent),
/* harmony export */   "AudioStreamNodeDetachedEvent": () => (/* binding */ AudioStreamNodeDetachedEvent),
/* harmony export */   "AudioStreamNodeErrorEvent": () => (/* binding */ AudioStreamNodeErrorEvent),
/* harmony export */   "AudioStreamNodeEvent": () => (/* binding */ AudioStreamNodeEvent)
/* harmony export */ });
/* harmony import */ var _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PlatformEvent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

class AudioSourceEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, audioSourceId, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privAudioSourceId = audioSourceId;
    }
    get audioSourceId() {
        return this.privAudioSourceId;
    }
}
class AudioSourceInitializingEvent extends AudioSourceEvent {
    constructor(audioSourceId) {
        super("AudioSourceInitializingEvent", audioSourceId);
    }
}
class AudioSourceReadyEvent extends AudioSourceEvent {
    constructor(audioSourceId) {
        super("AudioSourceReadyEvent", audioSourceId);
    }
}
class AudioSourceOffEvent extends AudioSourceEvent {
    constructor(audioSourceId) {
        super("AudioSourceOffEvent", audioSourceId);
    }
}
class AudioSourceErrorEvent extends AudioSourceEvent {
    constructor(audioSourceId, error) {
        super("AudioSourceErrorEvent", audioSourceId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privError = error;
    }
    get error() {
        return this.privError;
    }
}
class AudioStreamNodeEvent extends AudioSourceEvent {
    constructor(eventName, audioSourceId, audioNodeId) {
        super(eventName, audioSourceId);
        this.privAudioNodeId = audioNodeId;
    }
    get audioNodeId() {
        return this.privAudioNodeId;
    }
}
class AudioStreamNodeAttachingEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId) {
        super("AudioStreamNodeAttachingEvent", audioSourceId, audioNodeId);
    }
}
class AudioStreamNodeAttachedEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId) {
        super("AudioStreamNodeAttachedEvent", audioSourceId, audioNodeId);
    }
}
class AudioStreamNodeDetachedEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId) {
        super("AudioStreamNodeDetachedEvent", audioSourceId, audioNodeId);
    }
}
class AudioStreamNodeErrorEvent extends AudioStreamNodeEvent {
    constructor(audioSourceId, audioNodeId, error) {
        super("AudioStreamNodeErrorEvent", audioSourceId, audioNodeId);
        this.privError = error;
    }
    get error() {
        return this.privError;
    }
}

//# sourceMappingURL=AudioSourceEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BackgroundEvent": () => (/* binding */ BackgroundEvent)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class BackgroundEvent extends _Exports__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(error) {
        super("BackgroundEvent", _Exports__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privError = error;
    }
    get error() {
        return this.privError;
    }
}

//# sourceMappingURL=BackgroundError.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ChunkedArrayBufferStream": () => (/* binding */ ChunkedArrayBufferStream)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ChunkedArrayBufferStream extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Stream {
    constructor(targetChunkSize, streamId) {
        super(streamId);
        this.privTargetChunkSize = targetChunkSize;
        this.privNextBufferReadyBytes = 0;
    }
    writeStreamChunk(chunk) {
        // No pending write, and the buffer is the right size so write it.
        if (chunk.isEnd ||
            (0 === this.privNextBufferReadyBytes && chunk.buffer.byteLength === this.privTargetChunkSize)) {
            super.writeStreamChunk(chunk);
            return;
        }
        let bytesCopiedFromBuffer = 0;
        while (bytesCopiedFromBuffer < chunk.buffer.byteLength) {
            // Fill the next buffer.
            if (undefined === this.privNextBufferToWrite) {
                this.privNextBufferToWrite = new ArrayBuffer(this.privTargetChunkSize);
                this.privNextBufferStartTime = chunk.timeReceived;
            }
            // Find out how many bytes we can copy into the read buffer.
            const bytesToCopy = Math.min(chunk.buffer.byteLength - bytesCopiedFromBuffer, this.privTargetChunkSize - this.privNextBufferReadyBytes);
            const targetView = new Uint8Array(this.privNextBufferToWrite);
            const sourceView = new Uint8Array(chunk.buffer.slice(bytesCopiedFromBuffer, bytesToCopy + bytesCopiedFromBuffer));
            targetView.set(sourceView, this.privNextBufferReadyBytes);
            this.privNextBufferReadyBytes += bytesToCopy;
            bytesCopiedFromBuffer += bytesToCopy;
            // Are we ready to write?
            if (this.privNextBufferReadyBytes === this.privTargetChunkSize) {
                super.writeStreamChunk({
                    buffer: this.privNextBufferToWrite,
                    isEnd: false,
                    timeReceived: this.privNextBufferStartTime,
                });
                this.privNextBufferReadyBytes = 0;
                this.privNextBufferToWrite = undefined;
            }
        }
    }
    close() {
        // Send whatever is pending, then close the base class.
        if (0 !== this.privNextBufferReadyBytes && !this.isClosed) {
            super.writeStreamChunk({
                buffer: this.privNextBufferToWrite.slice(0, this.privNextBufferReadyBytes),
                isEnd: false,
                timeReceived: this.privNextBufferStartTime,
            });
        }
        super.close();
    }
}

//# sourceMappingURL=ChunkedArrayBufferStream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionEvents.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionClosedEvent": () => (/* binding */ ConnectionClosedEvent),
/* harmony export */   "ConnectionErrorEvent": () => (/* binding */ ConnectionErrorEvent),
/* harmony export */   "ConnectionEstablishErrorEvent": () => (/* binding */ ConnectionEstablishErrorEvent),
/* harmony export */   "ConnectionEstablishedEvent": () => (/* binding */ ConnectionEstablishedEvent),
/* harmony export */   "ConnectionEvent": () => (/* binding */ ConnectionEvent),
/* harmony export */   "ConnectionMessageReceivedEvent": () => (/* binding */ ConnectionMessageReceivedEvent),
/* harmony export */   "ConnectionMessageSentEvent": () => (/* binding */ ConnectionMessageSentEvent),
/* harmony export */   "ConnectionStartEvent": () => (/* binding */ ConnectionStartEvent),
/* harmony export */   "ServiceEvent": () => (/* binding */ ServiceEvent)
/* harmony export */ });
/* harmony import */ var _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PlatformEvent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class ServiceEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, jsonstring, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privJsonResult = jsonstring;
    }
    get jsonString() {
        return this.privJsonResult;
    }
}
class ConnectionEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, connectionId, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
        this.privConnectionId = connectionId;
    }
    get connectionId() {
        return this.privConnectionId;
    }
}
class ConnectionStartEvent extends ConnectionEvent {
    constructor(connectionId, uri, headers) {
        super("ConnectionStartEvent", connectionId);
        this.privUri = uri;
        this.privHeaders = headers;
    }
    get uri() {
        return this.privUri;
    }
    get headers() {
        return this.privHeaders;
    }
}
class ConnectionEstablishedEvent extends ConnectionEvent {
    constructor(connectionId) {
        super("ConnectionEstablishedEvent", connectionId);
    }
}
class ConnectionClosedEvent extends ConnectionEvent {
    constructor(connectionId, statusCode, reason) {
        super("ConnectionClosedEvent", connectionId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Debug);
        this.privReason = reason;
        this.privStatusCode = statusCode;
    }
    get reason() {
        return this.privReason;
    }
    get statusCode() {
        return this.privStatusCode;
    }
}
class ConnectionErrorEvent extends ConnectionEvent {
    constructor(connectionId, message, type) {
        super("ConnectionErrorEvent", connectionId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Debug);
        this.privMessage = message;
        this.privType = type;
    }
    get message() {
        return this.privMessage;
    }
    get type() {
        return this.privType;
    }
}
class ConnectionEstablishErrorEvent extends ConnectionEvent {
    constructor(connectionId, statuscode, reason) {
        super("ConnectionEstablishErrorEvent", connectionId, _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Error);
        this.privStatusCode = statuscode;
        this.privReason = reason;
    }
    get reason() {
        return this.privReason;
    }
    get statusCode() {
        return this.privStatusCode;
    }
}
class ConnectionMessageReceivedEvent extends ConnectionEvent {
    constructor(connectionId, networkReceivedTimeISO, message) {
        super("ConnectionMessageReceivedEvent", connectionId);
        this.privNetworkReceivedTime = networkReceivedTimeISO;
        this.privMessage = message;
    }
    get networkReceivedTime() {
        return this.privNetworkReceivedTime;
    }
    get message() {
        return this.privMessage;
    }
}
class ConnectionMessageSentEvent extends ConnectionEvent {
    constructor(connectionId, networkSentTimeISO, message) {
        super("ConnectionMessageSentEvent", connectionId);
        this.privNetworkSentTime = networkSentTimeISO;
        this.privMessage = message;
    }
    get networkSentTime() {
        return this.privNetworkSentTime;
    }
    get message() {
        return this.privMessage;
    }
}

//# sourceMappingURL=ConnectionEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionMessage": () => (/* binding */ ConnectionMessage),
/* harmony export */   "MessageType": () => (/* binding */ MessageType)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* eslint-disable @typescript-eslint/no-unsafe-return */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


var MessageType;
(function (MessageType) {
    MessageType[MessageType["Text"] = 0] = "Text";
    MessageType[MessageType["Binary"] = 1] = "Binary";
})(MessageType || (MessageType = {}));
class ConnectionMessage {
    constructor(messageType, body, headers, id) {
        this.privBody = null;
        if (messageType === MessageType.Text && body && !(typeof (body) === "string")) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be a string");
        }
        if (messageType === MessageType.Binary && body && !(body instanceof ArrayBuffer)) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be ArrayBuffer");
        }
        this.privMessageType = messageType;
        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment
        this.privBody = body;
        this.privHeaders = headers ? headers : {};
        this.privId = id ? id : (0,_Guid__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        switch (this.messageType) {
            case MessageType.Binary:
                this.privSize = this.binaryBody !== null ? this.binaryBody.byteLength : 0;
                break;
            case MessageType.Text:
                this.privSize = this.textBody.length;
        }
    }
    get messageType() {
        return this.privMessageType;
    }
    get headers() {
        return this.privHeaders;
    }
    get body() {
        return this.privBody;
    }
    get textBody() {
        if (this.privMessageType === MessageType.Binary) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for binary message");
        }
        return this.privBody;
    }
    get binaryBody() {
        if (this.privMessageType === MessageType.Text) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for text message");
        }
        return this.privBody;
    }
    get id() {
        return this.privId;
    }
}

//# sourceMappingURL=ConnectionMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionOpenResponse.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionOpenResponse.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionOpenResponse": () => (/* binding */ ConnectionOpenResponse)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class ConnectionOpenResponse {
    constructor(statusCode, reason) {
        this.privStatusCode = statusCode;
        this.privReason = reason;
    }
    get statusCode() {
        return this.privStatusCode;
    }
    get reason() {
        return this.privReason;
    }
}

//# sourceMappingURL=ConnectionOpenResponse.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DeferralMap.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DeferralMap.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DeferralMap": () => (/* binding */ DeferralMap)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * The error that is thrown when an argument passed in is null.
 *
 * @export
 * @class DefferalMap
 */
class DeferralMap {
    constructor() {
        this.privMap = {};
    }
    add(id, deferral) {
        this.privMap[id] = deferral;
    }
    getId(id) {
        return this.privMap[id];
    }
    complete(id, result) {
        try {
            this.privMap[id].resolve(result);
        }
        catch (error) {
            this.privMap[id].reject(error);
        }
        finally {
            this.privMap[id] = undefined;
        }
    }
}

//# sourceMappingURL=DeferralMap.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DialogEvents.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/DialogEvents.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogEvent": () => (/* binding */ DialogEvent),
/* harmony export */   "SendingAgentContextMessageEvent": () => (/* binding */ SendingAgentContextMessageEvent)
/* harmony export */ });
/* harmony import */ var _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PlatformEvent */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class DialogEvent extends _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.PlatformEvent {
    constructor(eventName, eventType = _PlatformEvent__WEBPACK_IMPORTED_MODULE_0__.EventType.Info) {
        super(eventName, eventType);
    }
}
class SendingAgentContextMessageEvent extends DialogEvent {
    constructor(agentConfig) {
        super("SendingAgentContextMessageEvent");
        this.privAgentConfig = agentConfig;
    }
    get agentConfig() {
        return this.privAgentConfig;
    }
}

//# sourceMappingURL=DialogEvents.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ArgumentNullError": () => (/* binding */ ArgumentNullError),
/* harmony export */   "InvalidOperationError": () => (/* binding */ InvalidOperationError),
/* harmony export */   "ObjectDisposedError": () => (/* binding */ ObjectDisposedError)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */
/**
 * The error that is thrown when an argument passed in is null.
 *
 * @export
 * @class ArgumentNullError
 * @extends {Error}
 */
class ArgumentNullError extends Error {
    /**
     * Creates an instance of ArgumentNullError.
     *
     * @param {string} argumentName - Name of the argument that is null
     *
     * @memberOf ArgumentNullError
     */
    constructor(argumentName) {
        super(argumentName);
        this.name = "ArgumentNull";
        this.message = argumentName;
    }
}
/**
 * The error that is thrown when an invalid operation is performed in the code.
 *
 * @export
 * @class InvalidOperationError
 * @extends {Error}
 */
class InvalidOperationError extends Error {
    /**
     * Creates an instance of InvalidOperationError.
     *
     * @param {string} error - The error
     *
     * @memberOf InvalidOperationError
     */
    constructor(error) {
        super(error);
        this.name = "InvalidOperation";
        this.message = error;
    }
}
/**
 * The error that is thrown when an object is disposed.
 *
 * @export
 * @class ObjectDisposedError
 * @extends {Error}
 */
class ObjectDisposedError extends Error {
    /**
     * Creates an instance of ObjectDisposedError.
     *
     * @param {string} objectName - The object that is disposed
     * @param {string} error - The error
     *
     * @memberOf ObjectDisposedError
     */
    constructor(objectName, error) {
        super(error);
        this.name = objectName + "ObjectDisposed";
        this.message = error;
    }
}

//# sourceMappingURL=Error.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EventSource": () => (/* binding */ EventSource)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class EventSource {
    constructor(metadata) {
        this.privEventListeners = {};
        this.privIsDisposed = false;
        this.privConsoleListener = undefined;
        this.privMetadata = metadata;
    }
    onEvent(event) {
        if (this.isDisposed()) {
            throw (new _Error__WEBPACK_IMPORTED_MODULE_0__.ObjectDisposedError("EventSource"));
        }
        if (this.metadata) {
            for (const paramName in this.metadata) {
                if (paramName) {
                    if (event.metadata) {
                        if (!event.metadata[paramName]) {
                            event.metadata[paramName] = this.metadata[paramName];
                        }
                    }
                }
            }
        }
        for (const eventId in this.privEventListeners) {
            if (eventId && this.privEventListeners[eventId]) {
                this.privEventListeners[eventId](event);
            }
        }
    }
    attach(onEventCallback) {
        const id = (0,_Guid__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        this.privEventListeners[id] = onEventCallback;
        return {
            detach: () => {
                delete this.privEventListeners[id];
                return Promise.resolve();
            },
        };
    }
    attachListener(listener) {
        return this.attach((e) => listener.onEvent(e));
    }
    attachConsoleListener(listener) {
        if (!!this.privConsoleListener) {
            void this.privConsoleListener.detach(); // Detach implementation for eventListeners is synchronous
        }
        this.privConsoleListener = this.attach((e) => listener.onEvent(e));
        return this.privConsoleListener;
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose() {
        this.privEventListeners = null;
        this.privIsDisposed = true;
    }
    get metadata() {
        return this.privMetadata;
    }
}

//# sourceMappingURL=EventSource.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Events": () => (/* binding */ Events)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _EventSource__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./EventSource */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class Events {
    static setEventSource(eventSource) {
        if (!eventSource) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("eventSource");
        }
        Events.privInstance = eventSource;
    }
    static get instance() {
        return Events.privInstance;
    }
}
Events.privInstance = new _EventSource__WEBPACK_IMPORTED_MODULE_1__.EventSource();

//# sourceMappingURL=Events.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createGuid": () => (/* binding */ createGuid),
/* harmony export */   "createNoDashGuid": () => (/* binding */ createNoDashGuid)
/* harmony export */ });
/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uuid */ "./node_modules/uuid/dist/esm-browser/v4.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

const createGuid = () => (0,uuid__WEBPACK_IMPORTED_MODULE_0__["default"])();
const createNoDashGuid = () => createGuid().replace(new RegExp("-", "g"), "").toUpperCase();


//# sourceMappingURL=Guid.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/IConnection.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionState": () => (/* binding */ ConnectionState)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var ConnectionState;
(function (ConnectionState) {
    ConnectionState[ConnectionState["None"] = 0] = "None";
    ConnectionState[ConnectionState["Connected"] = 1] = "Connected";
    ConnectionState[ConnectionState["Connecting"] = 2] = "Connecting";
    ConnectionState[ConnectionState["Disconnected"] = 3] = "Disconnected";
})(ConnectionState || (ConnectionState = {}));

//# sourceMappingURL=IConnection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/List.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/List.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "List": () => (/* binding */ List)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class List {
    constructor(list) {
        this.privSubscriptionIdCounter = 0;
        this.privAddSubscriptions = {};
        this.privRemoveSubscriptions = {};
        this.privDisposedSubscriptions = {};
        this.privDisposeReason = null;
        this.privList = [];
        // copy the list rather than taking as is.
        if (list) {
            for (const item of list) {
                this.privList.push(item);
            }
        }
    }
    get(itemIndex) {
        this.throwIfDisposed();
        return this.privList[itemIndex];
    }
    first() {
        return this.get(0);
    }
    last() {
        return this.get(this.length() - 1);
    }
    add(item) {
        this.throwIfDisposed();
        this.insertAt(this.privList.length, item);
    }
    insertAt(index, item) {
        this.throwIfDisposed();
        if (index === 0) {
            this.privList.unshift(item);
        }
        else if (index === this.privList.length) {
            this.privList.push(item);
        }
        else {
            this.privList.splice(index, 0, item);
        }
        this.triggerSubscriptions(this.privAddSubscriptions);
    }
    removeFirst() {
        this.throwIfDisposed();
        return this.removeAt(0);
    }
    removeLast() {
        this.throwIfDisposed();
        return this.removeAt(this.length() - 1);
    }
    removeAt(index) {
        this.throwIfDisposed();
        return this.remove(index, 1)[0];
    }
    remove(index, count) {
        this.throwIfDisposed();
        const removedElements = this.privList.splice(index, count);
        this.triggerSubscriptions(this.privRemoveSubscriptions);
        return removedElements;
    }
    clear() {
        this.throwIfDisposed();
        this.remove(0, this.length());
    }
    length() {
        this.throwIfDisposed();
        return this.privList.length;
    }
    onAdded(addedCallback) {
        this.throwIfDisposed();
        const subscriptionId = this.privSubscriptionIdCounter++;
        this.privAddSubscriptions[subscriptionId] = addedCallback;
        return {
            detach: () => {
                delete this.privAddSubscriptions[subscriptionId];
                return Promise.resolve();
            },
        };
    }
    onRemoved(removedCallback) {
        this.throwIfDisposed();
        const subscriptionId = this.privSubscriptionIdCounter++;
        this.privRemoveSubscriptions[subscriptionId] = removedCallback;
        return {
            detach: () => {
                delete this.privRemoveSubscriptions[subscriptionId];
                return Promise.resolve();
            },
        };
    }
    onDisposed(disposedCallback) {
        this.throwIfDisposed();
        const subscriptionId = this.privSubscriptionIdCounter++;
        this.privDisposedSubscriptions[subscriptionId] = disposedCallback;
        return {
            detach: () => {
                delete this.privDisposedSubscriptions[subscriptionId];
                return Promise.resolve();
            },
        };
    }
    join(seperator) {
        this.throwIfDisposed();
        return this.privList.join(seperator);
    }
    toArray() {
        const cloneCopy = Array();
        this.privList.forEach((val) => {
            cloneCopy.push(val);
        });
        return cloneCopy;
    }
    any(callback) {
        this.throwIfDisposed();
        if (callback) {
            return this.where(callback).length() > 0;
        }
        else {
            return this.length() > 0;
        }
    }
    all(callback) {
        this.throwIfDisposed();
        return this.where(callback).length() === this.length();
    }
    forEach(callback) {
        this.throwIfDisposed();
        for (let i = 0; i < this.length(); i++) {
            callback(this.privList[i], i);
        }
    }
    select(callback) {
        this.throwIfDisposed();
        const selectList = [];
        for (let i = 0; i < this.privList.length; i++) {
            selectList.push(callback(this.privList[i], i));
        }
        return new List(selectList);
    }
    where(callback) {
        this.throwIfDisposed();
        const filteredList = new List();
        for (let i = 0; i < this.privList.length; i++) {
            if (callback(this.privList[i], i)) {
                filteredList.add(this.privList[i]);
            }
        }
        return filteredList;
    }
    orderBy(compareFn) {
        this.throwIfDisposed();
        const clonedArray = this.toArray();
        const orderedArray = clonedArray.sort(compareFn);
        return new List(orderedArray);
    }
    orderByDesc(compareFn) {
        this.throwIfDisposed();
        return this.orderBy((a, b) => compareFn(b, a));
    }
    clone() {
        this.throwIfDisposed();
        return new List(this.toArray());
    }
    concat(list) {
        this.throwIfDisposed();
        return new List(this.privList.concat(list.toArray()));
    }
    concatArray(array) {
        this.throwIfDisposed();
        return new List(this.privList.concat(array));
    }
    isDisposed() {
        return this.privList == null;
    }
    dispose(reason) {
        if (!this.isDisposed()) {
            this.privDisposeReason = reason;
            this.privList = null;
            this.privAddSubscriptions = null;
            this.privRemoveSubscriptions = null;
            this.triggerSubscriptions(this.privDisposedSubscriptions);
        }
    }
    throwIfDisposed() {
        if (this.isDisposed()) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.ObjectDisposedError("List", this.privDisposeReason);
        }
    }
    triggerSubscriptions(subscriptions) {
        if (subscriptions) {
            for (const subscriptionId in subscriptions) {
                if (subscriptionId) {
                    subscriptions[subscriptionId]();
                }
            }
        }
    }
}

//# sourceMappingURL=List.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EventType": () => (/* binding */ EventType),
/* harmony export */   "PlatformEvent": () => (/* binding */ PlatformEvent)
/* harmony export */ });
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

var EventType;
(function (EventType) {
    EventType[EventType["Debug"] = 0] = "Debug";
    EventType[EventType["Info"] = 1] = "Info";
    EventType[EventType["Warning"] = 2] = "Warning";
    EventType[EventType["Error"] = 3] = "Error";
    EventType[EventType["None"] = 4] = "None";
})(EventType || (EventType = {}));
class PlatformEvent {
    constructor(eventName, eventType) {
        this.privName = eventName;
        this.privEventId = (0,_Guid__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privEventTime = new Date().toISOString();
        this.privEventType = eventType;
        this.privMetadata = {};
    }
    get name() {
        return this.privName;
    }
    get eventId() {
        return this.privEventId;
    }
    get eventTime() {
        return this.privEventTime;
    }
    get eventType() {
        return this.privEventType;
    }
    get metadata() {
        return this.privMetadata;
    }
}

//# sourceMappingURL=PlatformEvent.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Deferred": () => (/* binding */ Deferred),
/* harmony export */   "PromiseResult": () => (/* binding */ PromiseResult),
/* harmony export */   "PromiseResultEventSource": () => (/* binding */ PromiseResultEventSource),
/* harmony export */   "PromiseState": () => (/* binding */ PromiseState),
/* harmony export */   "Sink": () => (/* binding */ Sink),
/* harmony export */   "marshalPromiseToCallbacks": () => (/* binding */ marshalPromiseToCallbacks)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file, @typescript-eslint/typedef */
var PromiseState;
(function (PromiseState) {
    PromiseState[PromiseState["None"] = 0] = "None";
    PromiseState[PromiseState["Resolved"] = 1] = "Resolved";
    PromiseState[PromiseState["Rejected"] = 2] = "Rejected";
})(PromiseState || (PromiseState = {}));
class PromiseResult {
    constructor(promiseResultEventSource) {
        this.throwIfError = () => {
            if (this.isError) {
                throw this.error;
            }
        };
        promiseResultEventSource.on((result) => {
            if (!this.privIsCompleted) {
                this.privIsCompleted = true;
                this.privIsError = false;
                this.privResult = result;
            }
        }, (error) => {
            if (!this.privIsCompleted) {
                this.privIsCompleted = true;
                this.privIsError = true;
                this.privError = error;
            }
        });
    }
    get isCompleted() {
        return this.privIsCompleted;
    }
    get isError() {
        return this.privIsError;
    }
    get error() {
        return this.privError;
    }
    get result() {
        return this.privResult;
    }
}
class PromiseResultEventSource {
    constructor() {
        this.setResult = (result) => {
            this.privOnSetResult(result);
        };
        this.setError = (error) => {
            this.privOnSetError(error);
        };
        this.on = (onSetResult, onSetError) => {
            this.privOnSetResult = onSetResult;
            this.privOnSetError = onSetError;
        };
    }
}
class Deferred {
    constructor() {
        this.resolve = (result) => {
            this.privResolve(result);
            return this;
        };
        this.reject = (error) => {
            this.privReject(error);
            return this;
        };
        // eslint-disable-next-line @typescript-eslint/explicit-function-return-type
        this.privPromise = new Promise((resolve, reject) => {
            this.privResolve = resolve;
            this.privReject = reject;
        });
    }
    get promise() {
        return this.privPromise;
    }
}
class Sink {
    constructor() {
        this.privState = PromiseState.None;
        this.privPromiseResult = null;
        this.privPromiseResultEvents = null;
        this.privSuccessHandlers = [];
        this.privErrorHandlers = [];
        this.privPromiseResultEvents = new PromiseResultEventSource();
        this.privPromiseResult = new PromiseResult(this.privPromiseResultEvents);
    }
    get state() {
        return this.privState;
    }
    get result() {
        return this.privPromiseResult;
    }
    resolve(result) {
        if (this.privState !== PromiseState.None) {
            throw new Error("'Cannot resolve a completed promise'");
        }
        this.privState = PromiseState.Resolved;
        this.privPromiseResultEvents.setResult(result);
        for (let i = 0; i < this.privSuccessHandlers.length; i++) {
            this.executeSuccessCallback(result, this.privSuccessHandlers[i], this.privErrorHandlers[i]);
        }
        this.detachHandlers();
    }
    reject(error) {
        if (this.privState !== PromiseState.None) {
            throw new Error("'Cannot reject a completed promise'");
        }
        this.privState = PromiseState.Rejected;
        this.privPromiseResultEvents.setError(error);
        for (const errorHandler of this.privErrorHandlers) {
            this.executeErrorCallback(error, errorHandler);
        }
        this.detachHandlers();
    }
    on(successCallback, errorCallback) {
        if (successCallback == null) {
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            successCallback = () => { };
        }
        if (this.privState === PromiseState.None) {
            this.privSuccessHandlers.push(successCallback);
            this.privErrorHandlers.push(errorCallback);
        }
        else {
            if (this.privState === PromiseState.Resolved) {
                this.executeSuccessCallback(this.privPromiseResult.result, successCallback, errorCallback);
            }
            else if (this.privState === PromiseState.Rejected) {
                this.executeErrorCallback(this.privPromiseResult.error, errorCallback);
            }
            this.detachHandlers();
        }
    }
    executeSuccessCallback(result, successCallback, errorCallback) {
        try {
            successCallback(result);
        }
        catch (e) {
            this.executeErrorCallback(`'Unhandled callback error: ${e}'`, errorCallback);
        }
    }
    executeErrorCallback(error, errorCallback) {
        if (errorCallback) {
            try {
                errorCallback(error);
            }
            catch (e) {
                throw new Error(`'Unhandled callback error: ${e}. InnerError: ${error}'`);
            }
        }
        else {
            throw new Error(`'Unhandled error: ${error}'`);
        }
    }
    detachHandlers() {
        this.privErrorHandlers = [];
        this.privSuccessHandlers = [];
    }
}
// eslint-disable-next-line prefer-arrow/prefer-arrow-functions
function marshalPromiseToCallbacks(promise, cb, err) {
    promise.then((val) => {
        try {
            if (!!cb) {
                cb(val);
            }
        }
        catch (error) {
            if (!!err) {
                try {
                    if (error instanceof Error) {
                        const typedError = error;
                        err(typedError.name + ": " + typedError.message);
                    }
                    else {
                        err(error);
                    }
                    // eslint-disable-next-line no-empty
                }
                catch (error) { }
            }
        }
    }, (error) => {
        if (!!err) {
            try {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
                // eslint-disable-next-line no-empty
            }
            catch (error) { }
        }
    });
}

//# sourceMappingURL=Promise.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Queue": () => (/* binding */ Queue)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _List__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./List */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/List.js");
/* harmony import */ var _Promise__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Promise */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



var SubscriberType;
(function (SubscriberType) {
    SubscriberType[SubscriberType["Dequeue"] = 0] = "Dequeue";
    SubscriberType[SubscriberType["Peek"] = 1] = "Peek";
})(SubscriberType || (SubscriberType = {}));
class Queue {
    constructor(list) {
        this.privPromiseStore = new _List__WEBPACK_IMPORTED_MODULE_0__.List();
        this.privIsDrainInProgress = false;
        this.privIsDisposing = false;
        this.privDisposeReason = null;
        this.privList = list ? list : new _List__WEBPACK_IMPORTED_MODULE_0__.List();
        this.privDetachables = [];
        this.privSubscribers = new _List__WEBPACK_IMPORTED_MODULE_0__.List();
        this.privDetachables.push(this.privList.onAdded(() => this.drain()));
    }
    enqueue(item) {
        this.throwIfDispose();
        this.enqueueFromPromise(new Promise((resolve) => resolve(item)));
    }
    enqueueFromPromise(promise) {
        this.throwIfDispose();
        promise.then((val) => {
            this.privList.add(val);
            // eslint-disable-next-line @typescript-eslint/no-empty-function
        }, () => { });
    }
    dequeue() {
        this.throwIfDispose();
        const deferredSubscriber = new _Promise__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        if (this.privSubscribers) {
            this.privSubscribers.add({ deferral: deferredSubscriber, type: SubscriberType.Dequeue });
            this.drain();
        }
        return deferredSubscriber.promise;
    }
    peek() {
        this.throwIfDispose();
        const deferredSubscriber = new _Promise__WEBPACK_IMPORTED_MODULE_1__.Deferred();
        const subs = this.privSubscribers;
        if (subs) {
            this.privSubscribers.add({ deferral: deferredSubscriber, type: SubscriberType.Peek });
            this.drain();
        }
        return deferredSubscriber.promise;
    }
    length() {
        this.throwIfDispose();
        return this.privList.length();
    }
    isDisposed() {
        return this.privSubscribers == null;
    }
    drainAndDispose(pendingItemProcessor, reason) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.isDisposed() && !this.privIsDisposing) {
                this.privDisposeReason = reason;
                this.privIsDisposing = true;
                const subs = this.privSubscribers;
                if (subs) {
                    while (subs.length() > 0) {
                        const subscriber = subs.removeFirst();
                        // TODO: this needs work (Resolve(null) instead?).
                        subscriber.deferral.resolve(undefined);
                        // subscriber.deferral.reject("Disposed");
                    }
                    // note: this block assumes cooperative multitasking, i.e.,
                    // between the if-statement and the assignment there are no
                    // thread switches.
                    // Reason is that between the initial const = this.; and this
                    // point there is the derral.resolve() operation that might have
                    // caused recursive calls to the Queue, especially, calling
                    // Dispose() on the queue alredy (which would reset the var
                    // here to null!).
                    // That should generally hold true for javascript...
                    if (this.privSubscribers === subs) {
                        this.privSubscribers = subs;
                    }
                }
                for (const detachable of this.privDetachables) {
                    yield detachable.detach();
                }
                if (this.privPromiseStore.length() > 0 && pendingItemProcessor) {
                    const promiseArray = [];
                    this.privPromiseStore.toArray().forEach((wrapper) => {
                        promiseArray.push(wrapper);
                    });
                    return Promise.all(promiseArray).finally(() => {
                        this.privSubscribers = null;
                        this.privList.forEach((item) => {
                            pendingItemProcessor(item);
                        });
                        this.privList = null;
                        return;
                    }).then();
                }
                else {
                    this.privSubscribers = null;
                    this.privList = null;
                }
            }
        });
    }
    dispose(reason) {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.drainAndDispose(null, reason);
        });
    }
    drain() {
        if (!this.privIsDrainInProgress && !this.privIsDisposing) {
            this.privIsDrainInProgress = true;
            const subs = this.privSubscribers;
            const lists = this.privList;
            if (subs && lists) {
                while (lists.length() > 0 && subs.length() > 0 && !this.privIsDisposing) {
                    const subscriber = subs.removeFirst();
                    if (subscriber.type === SubscriberType.Peek) {
                        subscriber.deferral.resolve(lists.first());
                    }
                    else {
                        const dequeuedItem = lists.removeFirst();
                        subscriber.deferral.resolve(dequeuedItem);
                    }
                }
                // note: this block assumes cooperative multitasking, i.e.,
                // between the if-statement and the assignment there are no
                // thread switches.
                // Reason is that between the initial const = this.; and this
                // point there is the derral.resolve() operation that might have
                // caused recursive calls to the Queue, especially, calling
                // Dispose() on the queue alredy (which would reset the var
                // here to null!).
                // That should generally hold true for javascript...
                if (this.privSubscribers === subs) {
                    this.privSubscribers = subs;
                }
                // note: this block assumes cooperative multitasking, i.e.,
                // between the if-statement and the assignment there are no
                // thread switches.
                // Reason is that between the initial const = this.; and this
                // point there is the derral.resolve() operation that might have
                // caused recursive calls to the Queue, especially, calling
                // Dispose() on the queue alredy (which would reset the var
                // here to null!).
                // That should generally hold true for javascript...
                if (this.privList === lists) {
                    this.privList = lists;
                }
            }
            this.privIsDrainInProgress = false;
        }
    }
    throwIfDispose() {
        if (this.isDisposed()) {
            if (this.privDisposeReason) {
                throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError(this.privDisposeReason);
            }
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.ObjectDisposedError("Queue");
        }
        else if (this.privIsDisposing) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError("Queue disposing");
        }
    }
}

//# sourceMappingURL=Queue.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RawWebsocketMessage.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RawWebsocketMessage": () => (/* binding */ RawWebsocketMessage)
/* harmony export */ });
/* harmony import */ var _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* eslint-disable @typescript-eslint/no-unsafe-assignment */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



class RawWebsocketMessage {
    constructor(messageType, payload, id) {
        this.privPayload = null;
        if (!payload) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.ArgumentNullError("payload");
        }
        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
        if (messageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary && payload.__proto__.constructor.name !== "ArrayBuffer") {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be ArrayBuffer");
        }
        if (messageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text && !(typeof (payload) === "string")) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Payload must be a string");
        }
        this.privMessageType = messageType;
        this.privPayload = payload;
        this.privId = id ? id : (0,_Guid__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)();
    }
    get messageType() {
        return this.privMessageType;
    }
    get payload() {
        // eslint-disable-next-line @typescript-eslint/no-unsafe-return
        return this.privPayload;
    }
    get textContent() {
        if (this.privMessageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Binary) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for binary message");
        }
        return this.privPayload;
    }
    get binaryContent() {
        if (this.privMessageType === _ConnectionMessage__WEBPACK_IMPORTED_MODULE_1__.MessageType.Text) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_0__.InvalidOperationError("Not supported for text message");
        }
        return this.privPayload;
    }
    get id() {
        return this.privId;
    }
}

//# sourceMappingURL=RawWebsocketMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RiffPcmEncoder.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/RiffPcmEncoder.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RiffPcmEncoder": () => (/* binding */ RiffPcmEncoder)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class RiffPcmEncoder {
    constructor(actualSampleRate, desiredSampleRate) {
        this.privActualSampleRate = actualSampleRate;
        this.privDesiredSampleRate = desiredSampleRate;
    }
    encode(actualAudioFrame) {
        const audioFrame = this.downSampleAudioFrame(actualAudioFrame, this.privActualSampleRate, this.privDesiredSampleRate);
        if (!audioFrame) {
            return null;
        }
        const audioLength = audioFrame.length * 2;
        const buffer = new ArrayBuffer(audioLength);
        const view = new DataView(buffer);
        this.floatTo16BitPCM(view, 0, audioFrame);
        return buffer;
    }
    setString(view, offset, str) {
        for (let i = 0; i < str.length; i++) {
            view.setUint8(offset + i, str.charCodeAt(i));
        }
    }
    floatTo16BitPCM(view, offset, input) {
        for (let i = 0; i < input.length; i++, offset += 2) {
            const s = Math.max(-1, Math.min(1, input[i]));
            view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true);
        }
    }
    downSampleAudioFrame(srcFrame, srcRate, dstRate) {
        if (!srcFrame) {
            return null;
        }
        if (dstRate === srcRate || dstRate > srcRate) {
            return srcFrame;
        }
        const ratio = srcRate / dstRate;
        const dstLength = Math.round(srcFrame.length / ratio);
        const dstFrame = new Float32Array(dstLength);
        let srcOffset = 0;
        let dstOffset = 0;
        while (dstOffset < dstLength) {
            const nextSrcOffset = Math.round((dstOffset + 1) * ratio);
            let accum = 0;
            let count = 0;
            while (srcOffset < nextSrcOffset && srcOffset < srcFrame.length) {
                accum += srcFrame[srcOffset++];
                count++;
            }
            dstFrame[dstOffset++] = accum / count;
        }
        return dstFrame;
    }
}

//# sourceMappingURL=RiffPcmEncoder.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Stream": () => (/* binding */ Stream)
/* harmony export */ });
/* harmony import */ var _Error__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Guid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _Queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Queue */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



class Stream {
    constructor(streamId) {
        this.privIsWriteEnded = false;
        this.privIsReadEnded = false;
        this.privId = streamId ? streamId : (0,_Guid__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privReaderQueue = new _Queue__WEBPACK_IMPORTED_MODULE_1__.Queue();
    }
    get isClosed() {
        return this.privIsWriteEnded;
    }
    get isReadEnded() {
        return this.privIsReadEnded;
    }
    get id() {
        return this.privId;
    }
    close() {
        if (!this.privIsWriteEnded) {
            this.writeStreamChunk({
                buffer: null,
                isEnd: true,
                timeReceived: Date.now(),
            });
            this.privIsWriteEnded = true;
        }
    }
    writeStreamChunk(streamChunk) {
        this.throwIfClosed();
        if (!this.privReaderQueue.isDisposed()) {
            try {
                this.privReaderQueue.enqueue(streamChunk);
            }
            catch (e) {
                // Do nothing
            }
        }
    }
    read() {
        if (this.privIsReadEnded) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError("Stream read has already finished");
        }
        return this.privReaderQueue
            .dequeue()
            .then((streamChunk) => __awaiter(this, void 0, void 0, function* () {
            if (streamChunk === undefined || streamChunk.isEnd) {
                yield this.privReaderQueue.dispose("End of stream reached");
            }
            return streamChunk;
        }));
    }
    readEnded() {
        if (!this.privIsReadEnded) {
            this.privIsReadEnded = true;
            this.privReaderQueue = new _Queue__WEBPACK_IMPORTED_MODULE_1__.Queue();
        }
    }
    throwIfClosed() {
        if (this.privIsWriteEnded) {
            throw new _Error__WEBPACK_IMPORTED_MODULE_2__.InvalidOperationError("Stream closed");
        }
    }
}

//# sourceMappingURL=Stream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/StringUtils.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "StringUtils": () => (/* binding */ StringUtils)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * String helper functions
 */
class StringUtils {
    /**
     * Formats a string by replacing the named {keys} in the string with the values contained in the replacement dictionary.
     * @param format The format string that contains the parts to replace surrounded by {}. For example: "wss://{region}.cts.speech.microsoft.com".
     * If your string needs to contain a { or } you can use the {{ and }} escape sequences respectively.
     * @param replacements The dictionary of replacements. If a replacement is not found, it is replaced with an empty string
     * @returns The formatted string. If you pass in a null or undefined format string, an empty string will be returned
     */
    static formatString(format, replacements) {
        if (!format) {
            return "";
        }
        if (!replacements) {
            return format;
        }
        let formatted = "";
        let key = "";
        const appendToFormatted = (str) => {
            formatted += str;
        };
        const appendToKey = (str) => {
            key += str;
        };
        let appendFunc = appendToFormatted;
        for (let i = 0; i < format.length; i++) {
            const c = format[i];
            const next = i + 1 < format.length ? format[i + 1] : "";
            switch (c) {
                case "{":
                    if (next === "{") {
                        appendFunc("{");
                        i++;
                    }
                    else {
                        appendFunc = appendToKey;
                    }
                    break;
                case "}":
                    if (next === "}") {
                        appendFunc("}");
                        i++;
                    }
                    else {
                        if (replacements.hasOwnProperty(key)) {
                            formatted += replacements[key];
                        }
                        appendFunc = appendToFormatted;
                        key = "";
                    }
                    break;
                default:
                    appendFunc(c);
                    break;
            }
        }
        return formatted;
    }
}

//# sourceMappingURL=StringUtils.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Timeout.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Timeout": () => (/* binding */ Timeout)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class Timeout {
    static load() {
        // Prefilling the Maps with a function indexed by zero is necessary to be compliant with the specification.
        const scheduledTimeoutFunctions = new Map([[0, () => { }]]); // eslint-disable-line @typescript-eslint/no-empty-function
        const unhandledRequests = new Map();
        // eslint-disable-next-line
        const workerScript = `!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`;
        const workerUrl = "data:text/javascript;base64," + btoa(workerScript);
        const worker = new Worker(workerUrl);
        worker.addEventListener("message", ({ data }) => {
            if (Timeout.isCallNotification(data)) {
                const { params: { timerId } } = data;
                const idOrFunc = scheduledTimeoutFunctions.get(timerId);
                if (typeof idOrFunc === "number") {
                    const unhandledTimerId = unhandledRequests.get(idOrFunc);
                    if (unhandledTimerId === undefined ||
                        unhandledTimerId !== timerId) {
                        throw new Error("The timer is in an undefined state.");
                    }
                }
                else if (typeof idOrFunc !== "undefined") {
                    idOrFunc();
                    // A timeout can be safely deleted because it is only called once.
                    scheduledTimeoutFunctions.delete(timerId);
                }
                else {
                    throw new Error("The timer is in an undefined state.");
                }
            }
            else if (Timeout.isClearResponse(data)) {
                const { id } = data;
                const unhandledTimerId = unhandledRequests.get(id);
                if (unhandledTimerId === undefined) {
                    throw new Error("The timer is in an undefined state.");
                }
                unhandledRequests.delete(id);
                scheduledTimeoutFunctions.delete(unhandledTimerId);
            }
            else {
                const { error: { message } } = data;
                throw new Error(message);
            }
        });
        const clearTimeout = (timerId) => {
            const id = Math.random();
            unhandledRequests.set(id, timerId);
            scheduledTimeoutFunctions.set(timerId, id);
            worker.postMessage({
                id,
                method: "clear",
                params: { timerId }
            });
        };
        const setTimeout = (func, delay) => {
            const timerId = Math.random();
            scheduledTimeoutFunctions.set(timerId, func);
            worker.postMessage({
                id: null,
                method: "set",
                params: {
                    delay,
                    now: performance.now(),
                    timerId
                }
            });
            return timerId;
        };
        return {
            clearTimeout,
            setTimeout
        };
    }
    static loadWorkerTimers() {
        return () => {
            if (Timeout.workerTimers !== null) {
                return Timeout.workerTimers;
            }
            Timeout.workerTimers = Timeout.load();
            return Timeout.workerTimers;
        };
    }
    static isCallNotification(message) {
        return message.method !== undefined && message.method === "call";
    }
    static isClearResponse(message) {
        return message.error === null && typeof message.id === "number";
    }
}
Timeout.workerTimers = null;
Timeout.clearTimeout = (timerId) => Timeout.timers().clearTimeout(timerId);
Timeout.setTimeout = (func, delay) => Timeout.timers().setTimeout(func, delay);
Timeout.timers = Timeout.loadWorkerTimers();

//# sourceMappingURL=Timeout.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityReceivedEventArgs": () => (/* binding */ ActivityReceivedEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of received message/events.
 * @class ActivityReceivedEventArgs
 */
class ActivityReceivedEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {any} activity - The activity..
     */
    constructor(activity, audioStream) {
        this.privActivity = activity;
        this.privAudioStream = audioStream;
    }
    /**
     * Gets the received activity
     * @member ActivityReceivedEventArgs.prototype.activity
     * @function
     * @public
     * @returns {any} the received activity.
     */
    get activity() {
        return this.privActivity;
    }
    get audioStream() {
        return this.privAudioStream;
    }
}

//# sourceMappingURL=ActivityReceivedEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioConfig": () => (/* binding */ AudioConfig),
/* harmony export */   "AudioConfigImpl": () => (/* binding */ AudioConfigImpl),
/* harmony export */   "AudioOutputConfigImpl": () => (/* binding */ AudioOutputConfigImpl)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/PCMRecorder.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/MicAudioSource.js");
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/FileAudioSource.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js");
/* harmony import */ var _AudioInputStream__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AudioInputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js");
/* harmony import */ var _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _AudioFileWriter__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./AudioFileWriter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.






/**
 * Represents audio input configuration used for specifying what type of input to use (microphone, file, stream).
 * @class AudioConfig
 * Updated in version 1.11.0
 */
class AudioConfig {
    /**
     * Creates an AudioConfig object representing the default microphone on the system.
     * @member AudioConfig.fromDefaultMicrophoneInput
     * @function
     * @public
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromDefaultMicrophoneInput() {
        const pcmRecorder = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.PcmRecorder(true);
        return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.MicAudioSource(pcmRecorder));
    }
    /**
     * Creates an AudioConfig object representing a microphone with the specified device ID.
     * @member AudioConfig.fromMicrophoneInput
     * @function
     * @public
     * @param {string | undefined} deviceId - Specifies the device ID of the microphone to be used.
     * Default microphone is used the value is omitted.
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromMicrophoneInput(deviceId) {
        const pcmRecorder = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.PcmRecorder(true);
        return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.MicAudioSource(pcmRecorder, deviceId));
    }
    /**
     * Creates an AudioConfig object representing the specified file.
     * @member AudioConfig.fromWavFileInput
     * @function
     * @public
     * @param {File} fileName - Specifies the audio input file. Currently, only WAV / PCM is supported.
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromWavFileInput(file, name = "unnamedBuffer.wav") {
        return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_2__.FileAudioSource(file, name));
    }
    /**
     * Creates an AudioConfig object representing the specified stream.
     * @member AudioConfig.fromStreamInput
     * @function
     * @public
     * @param {AudioInputStream | PullAudioInputStreamCallback | MediaStream} audioStream - Specifies the custom audio input
     * stream. Currently, only WAV / PCM is supported.
     * @returns {AudioConfig} The audio input configuration being created.
     */
    static fromStreamInput(audioStream) {
        if (audioStream instanceof _Exports__WEBPACK_IMPORTED_MODULE_3__.PullAudioInputStreamCallback) {
            return new AudioConfigImpl(new _AudioInputStream__WEBPACK_IMPORTED_MODULE_4__.PullAudioInputStreamImpl(audioStream));
        }
        if (audioStream instanceof _AudioInputStream__WEBPACK_IMPORTED_MODULE_4__.AudioInputStream) {
            return new AudioConfigImpl(audioStream);
        }
        if (typeof MediaStream !== "undefined" && audioStream instanceof MediaStream) {
            const pcmRecorder = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.PcmRecorder(false);
            return new AudioConfigImpl(new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_1__.MicAudioSource(pcmRecorder, null, null, audioStream));
        }
        throw new Error("Not Supported Type");
    }
    /**
     * Creates an AudioConfig object representing the default speaker.
     * @member AudioConfig.fromDefaultSpeakerOutput
     * @function
     * @public
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.11.0
     */
    static fromDefaultSpeakerOutput() {
        return new AudioOutputConfigImpl(new _Exports__WEBPACK_IMPORTED_MODULE_5__.SpeakerAudioDestination());
    }
    /**
     * Creates an AudioConfig object representing the custom IPlayer object.
     * You can use the IPlayer object to control pause, resume, etc.
     * @member AudioConfig.fromSpeakerOutput
     * @function
     * @public
     * @param {IPlayer} player - the IPlayer object for playback.
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.12.0
     */
    static fromSpeakerOutput(player) {
        if (player === undefined) {
            return AudioConfig.fromDefaultSpeakerOutput();
        }
        if (player instanceof _Exports__WEBPACK_IMPORTED_MODULE_5__.SpeakerAudioDestination) {
            return new AudioOutputConfigImpl(player);
        }
        throw new Error("Not Supported Type");
    }
    /**
     * Creates an AudioConfig object representing a specified output audio file
     * @member AudioConfig.fromAudioFileOutput
     * @function
     * @public
     * @param {PathLike} filename - the filename of the output audio file
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.11.0
     */
    static fromAudioFileOutput(filename) {
        return new AudioOutputConfigImpl(new _AudioFileWriter__WEBPACK_IMPORTED_MODULE_6__.AudioFileWriter(filename));
    }
    /**
     * Creates an AudioConfig object representing a specified audio output stream
     * @member AudioConfig.fromStreamOutput
     * @function
     * @public
     * @param {AudioOutputStream | PushAudioOutputStreamCallback} audioStream - Specifies the custom audio output
     * stream.
     * @returns {AudioConfig} The audio output configuration being created.
     * Added in version 1.11.0
     */
    static fromStreamOutput(audioStream) {
        if (audioStream instanceof _Exports__WEBPACK_IMPORTED_MODULE_7__.PushAudioOutputStreamCallback) {
            return new AudioOutputConfigImpl(new _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__.PushAudioOutputStreamImpl(audioStream));
        }
        if (audioStream instanceof _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__.PushAudioOutputStream) {
            return new AudioOutputConfigImpl(audioStream);
        }
        if (audioStream instanceof _AudioOutputStream__WEBPACK_IMPORTED_MODULE_8__.PullAudioOutputStream) {
            return new AudioOutputConfigImpl(audioStream);
        }
        throw new Error("Not Supported Type");
    }
}
/**
 * Represents audio input stream used for custom audio input configurations.
 * @private
 * @class AudioConfigImpl
 */
class AudioConfigImpl extends AudioConfig {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {IAudioSource} source - An audio source.
     */
    constructor(source) {
        super();
        this.privSource = source;
    }
    /**
     * Format information for the audio
     */
    get format() {
        return this.privSource.format;
    }
    /**
     * @member AudioConfigImpl.prototype.close
     * @function
     * @public
     */
    close(cb, err) {
        this.privSource.turnOff().then(() => {
            if (!!cb) {
                cb();
            }
        }, (error) => {
            if (!!err) {
                err(error);
            }
        });
    }
    /**
     * @member AudioConfigImpl.prototype.id
     * @function
     * @public
     */
    id() {
        return this.privSource.id();
    }
    /**
     * @member AudioConfigImpl.prototype.turnOn
     * @function
     * @public
     * @returns {Promise<void>} A promise.
     */
    turnOn() {
        return this.privSource.turnOn();
    }
    /**
     * @member AudioConfigImpl.prototype.attach
     * @function
     * @public
     * @param {string} audioNodeId - The audio node id.
     * @returns {Promise<IAudioStreamNode>} A promise.
     */
    attach(audioNodeId) {
        return this.privSource.attach(audioNodeId);
    }
    /**
     * @member AudioConfigImpl.prototype.detach
     * @function
     * @public
     * @param {string} audioNodeId - The audio node id.
     */
    detach(audioNodeId) {
        return this.privSource.detach(audioNodeId);
    }
    /**
     * @member AudioConfigImpl.prototype.turnOff
     * @function
     * @public
     * @returns {Promise<void>} A promise.
     */
    turnOff() {
        return this.privSource.turnOff();
    }
    /**
     * @member AudioConfigImpl.prototype.events
     * @function
     * @public
     * @returns {EventSource<AudioSourceEvent>} An event source for audio events.
     */
    get events() {
        return this.privSource.events;
    }
    setProperty(name, value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNull(value, "value");
        if (undefined !== this.privSource.setProperty) {
            this.privSource.setProperty(name, value);
        }
        else {
            throw new Error("This AudioConfig instance does not support setting properties.");
        }
    }
    getProperty(name, def) {
        if (undefined !== this.privSource.getProperty) {
            return this.privSource.getProperty(name, def);
        }
        else {
            throw new Error("This AudioConfig instance does not support getting properties.");
        }
        return def;
    }
    get deviceInfo() {
        return this.privSource.deviceInfo;
    }
}
class AudioOutputConfigImpl extends AudioConfig {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {IAudioDestination} destination - An audio destination.
     */
    constructor(destination) {
        super();
        this.privDestination = destination;
    }
    set format(format) {
        this.privDestination.format = format;
    }
    write(buffer) {
        this.privDestination.write(buffer);
    }
    close() {
        this.privDestination.close();
    }
    id() {
        return this.privDestination.id();
    }
    setProperty() {
        throw new Error("This AudioConfig instance does not support setting properties.");
    }
    getProperty() {
        throw new Error("This AudioConfig instance does not support getting properties.");
    }
}

//# sourceMappingURL=AudioConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioFileWriter": () => (/* binding */ AudioFileWriter)
/* harmony export */ });
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ "?9463");
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


class AudioFileWriter {
    constructor(filename) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(fs__WEBPACK_IMPORTED_MODULE_0__.openSync, "\nFile System access not available, please use Push or PullAudioOutputStream");
        this.privFd = fs__WEBPACK_IMPORTED_MODULE_0__.openSync(filename, "w");
    }
    set format(format) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNotUndefined(this.privAudioFormat, "format is already set");
        this.privAudioFormat = format;
        let headerOffset = 0;
        if (this.privAudioFormat.hasHeader) {
            headerOffset = this.privAudioFormat.header.byteLength;
        }
        if (this.privFd !== undefined) {
            this.privWriteStream = fs__WEBPACK_IMPORTED_MODULE_0__.createWriteStream("", { fd: this.privFd, start: headerOffset, autoClose: false });
        }
    }
    write(buffer) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(this.privAudioFormat, "must set format before writing.");
        if (this.privWriteStream !== undefined) {
            this.privWriteStream.write(new Uint8Array(buffer.slice(0)));
        }
    }
    close() {
        if (this.privFd !== undefined) {
            this.privWriteStream.on("finish", () => {
                if (this.privAudioFormat.hasHeader) {
                    this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten);
                    fs__WEBPACK_IMPORTED_MODULE_0__.writeSync(this.privFd, new Int8Array(this.privAudioFormat.header), 0, this.privAudioFormat.header.byteLength, 0);
                }
                fs__WEBPACK_IMPORTED_MODULE_0__.closeSync(this.privFd);
                this.privFd = undefined;
            });
            this.privWriteStream.end();
        }
    }
    id() {
        return this.privId;
    }
}

//# sourceMappingURL=AudioFileWriter.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioInputStream": () => (/* binding */ AudioInputStream),
/* harmony export */   "PullAudioInputStream": () => (/* binding */ PullAudioInputStream),
/* harmony export */   "PullAudioInputStreamImpl": () => (/* binding */ PullAudioInputStreamImpl),
/* harmony export */   "PushAudioInputStream": () => (/* binding */ PushAudioInputStream),
/* harmony export */   "PushAudioInputStreamImpl": () => (/* binding */ PushAudioInputStreamImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/EventSource.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ChunkedArrayBufferStream.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/AudioSourceEvents.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Guid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common/Guid */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */





/**
 * Represents audio input stream used for custom audio input configurations.
 * @class AudioInputStream
 */
class AudioInputStream {
    /**
     * Creates and initializes an instance.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Creates a memory backed PushAudioInputStream with the specified audio format.
     * @member AudioInputStream.createPushStream
     * @function
     * @public
     * @param {AudioStreamFormat} format - The audio data format in which audio will be
     * written to the push audio stream's write() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PushAudioInputStream} The audio input stream being created.
     */
    static createPushStream(format) {
        return PushAudioInputStream.create(format);
    }
    /**
     * Creates a PullAudioInputStream that delegates to the specified callback interface for read()
     * and close() methods.
     * @member AudioInputStream.createPullStream
     * @function
     * @public
     * @param {PullAudioInputStreamCallback} callback - The custom audio input object, derived from
     * PullAudioInputStreamCallback
     * @param {AudioStreamFormat} format - The audio data format in which audio will be returned from
     * the callback's read() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PullAudioInputStream} The audio input stream being created.
     */
    static createPullStream(callback, format) {
        return PullAudioInputStream.create(callback, format);
        // throw new Error("Oops");
    }
}
/**
 * Represents memory backed push audio input stream used for custom audio input configurations.
 * @class PushAudioInputStream
 */
class PushAudioInputStream extends AudioInputStream {
    /**
     * Creates a memory backed PushAudioInputStream with the specified audio format.
     * @member PushAudioInputStream.create
     * @function
     * @public
     * @param {AudioStreamFormat} format - The audio data format in which audio will be written to the
     * push audio stream's write() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PushAudioInputStream} The push audio input stream being created.
     */
    static create(format) {
        return new PushAudioInputStreamImpl(format);
    }
}
/**
 * Represents memory backed push audio input stream used for custom audio input configurations.
 * @private
 * @class PushAudioInputStreamImpl
 */
class PushAudioInputStreamImpl extends PushAudioInputStream {
    /**
     * Creates and initalizes an instance with the given values.
     * @constructor
     * @param {AudioStreamFormat} format - The audio stream format.
     */
    constructor(format) {
        super();
        if (format === undefined) {
            this.privFormat = _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormatImpl.getDefaultInputFormat();
        }
        else {
            this.privFormat = format;
        }
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privId = (0,_common_Guid__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)();
        this.privStream = new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec / 10);
    }
    /**
     * Format information for the audio
     */
    get format() {
        return Promise.resolve(this.privFormat);
    }
    /**
     * Writes the audio data specified by making an internal copy of the data.
     * @member PushAudioInputStreamImpl.prototype.write
     * @function
     * @public
     * @param {ArrayBuffer} dataBuffer - The audio buffer of which this function will make a copy.
     */
    write(dataBuffer) {
        this.privStream.writeStreamChunk({
            buffer: dataBuffer,
            isEnd: false,
            timeReceived: Date.now()
        });
    }
    /**
     * Closes the stream.
     * @member PushAudioInputStreamImpl.prototype.close
     * @function
     * @public
     */
    close() {
        this.privStream.close();
    }
    id() {
        return this.privId;
    }
    turnOn() {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceInitializingEvent(this.privId)); // no stream id
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceReadyEvent(this.privId));
        return;
    }
    attach(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
            yield this.turnOn();
            const stream = this.privStream;
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return {
                detach: () => __awaiter(this, void 0, void 0, function* () {
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    return this.turnOff();
                }),
                id: () => audioNodeId,
                read: () => stream.read(),
            };
        });
    }
    detach(audioNodeId) {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
    }
    turnOff() {
        return;
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return Promise.resolve({
            bitspersample: this.privFormat.bitsPerSample,
            channelcount: this.privFormat.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: "PushStream",
            samplerate: this.privFormat.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.type.Stream,
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Events.instance.onEvent(event);
    }
    toBuffer(arrayBuffer) {
        const buf = Buffer.alloc(arrayBuffer.byteLength);
        const view = new Uint8Array(arrayBuffer);
        for (let i = 0; i < buf.length; ++i) {
            buf[i] = view[i];
        }
        return buf;
    }
}
/*
 * Represents audio input stream used for custom audio input configurations.
 * @class PullAudioInputStream
 */
class PullAudioInputStream extends AudioInputStream {
    /**
     * Creates and initializes and instance.
     * @constructor
     */
    constructor() {
        super();
    }
    /**
     * Creates a PullAudioInputStream that delegates to the specified callback interface for
     * read() and close() methods, using the default format (16 kHz 16bit mono PCM).
     * @member PullAudioInputStream.create
     * @function
     * @public
     * @param {PullAudioInputStreamCallback} callback - The custom audio input object,
     * derived from PullAudioInputStreamCustomCallback
     * @param {AudioStreamFormat} format - The audio data format in which audio will be
     * returned from the callback's read() method (Required if format is not 16 kHz 16bit mono PCM).
     * @returns {PullAudioInputStream} The push audio input stream being created.
     */
    static create(callback, format) {
        return new PullAudioInputStreamImpl(callback, format);
    }
}
/**
 * Represents audio input stream used for custom audio input configurations.
 * @private
 * @class PullAudioInputStreamImpl
 */
class PullAudioInputStreamImpl extends PullAudioInputStream {
    /**
     * Creates a PullAudioInputStream that delegates to the specified callback interface for
     * read() and close() methods, using the default format (16 kHz 16bit mono PCM).
     * @constructor
     * @param {PullAudioInputStreamCallback} callback - The custom audio input object,
     * derived from PullAudioInputStreamCustomCallback
     * @param {AudioStreamFormat} format - The audio data format in which audio will be
     * returned from the callback's read() method (Required if format is not 16 kHz 16bit mono PCM).
     */
    constructor(callback, format) {
        super();
        if (undefined === format) {
            this.privFormat = _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormat.getDefaultInputFormat();
        }
        else {
            this.privFormat = format;
        }
        this.privEvents = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.EventSource();
        this.privId = (0,_common_Guid__WEBPACK_IMPORTED_MODULE_2__.createNoDashGuid)();
        this.privCallback = callback;
        this.privIsClosed = false;
        this.privBufferSize = this.privFormat.avgBytesPerSec / 10;
    }
    /**
     * Format information for the audio
     */
    get format() {
        return Promise.resolve(this.privFormat);
    }
    /**
     * Closes the stream.
     * @member PullAudioInputStreamImpl.prototype.close
     * @function
     * @public
     */
    close() {
        this.privIsClosed = true;
        this.privCallback.close();
    }
    id() {
        return this.privId;
    }
    turnOn() {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceInitializingEvent(this.privId)); // no stream id
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioSourceReadyEvent(this.privId));
        return;
    }
    attach(audioNodeId) {
        return __awaiter(this, void 0, void 0, function* () {
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachingEvent(this.privId, audioNodeId));
            yield this.turnOn();
            this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeAttachedEvent(this.privId, audioNodeId));
            return {
                detach: () => {
                    this.privCallback.close();
                    this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
                    return this.turnOff();
                },
                id: () => audioNodeId,
                read: () => {
                    let totalBytes = 0;
                    let transmitBuff;
                    // Until we have the minimum number of bytes to send in a transmission, keep asking for more.
                    while (totalBytes < this.privBufferSize) {
                        // Sizing the read buffer to the delta between the perfect size and what's left means we won't ever get too much
                        // data back.
                        const readBuff = new ArrayBuffer(this.privBufferSize - totalBytes);
                        const pulledBytes = this.privCallback.read(readBuff);
                        // If there is no return buffer yet defined, set the return buffer to the that was just populated.
                        // This was, if we have enough data there's no copy penalty, but if we don't we have a buffer that's the
                        // preferred size allocated.
                        if (undefined === transmitBuff) {
                            transmitBuff = readBuff;
                        }
                        else {
                            // Not the first bite at the apple, so fill the return buffer with the data we got back.
                            const intView = new Int8Array(transmitBuff);
                            intView.set(new Int8Array(readBuff), totalBytes);
                        }
                        // If there are no bytes to read, just break out and be done.
                        if (0 === pulledBytes) {
                            break;
                        }
                        totalBytes += pulledBytes;
                    }
                    return Promise.resolve({
                        buffer: transmitBuff.slice(0, totalBytes),
                        isEnd: this.privIsClosed || totalBytes === 0,
                        timeReceived: Date.now(),
                    });
                },
            };
        });
    }
    detach(audioNodeId) {
        this.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.AudioStreamNodeDetachedEvent(this.privId, audioNodeId));
    }
    turnOff() {
        return;
    }
    get events() {
        return this.privEvents;
    }
    get deviceInfo() {
        return Promise.resolve({
            bitspersample: this.privFormat.bitsPerSample,
            channelcount: this.privFormat.channels,
            connectivity: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.connectivity.Unknown,
            manufacturer: "Speech SDK",
            model: "PullStream",
            samplerate: this.privFormat.samplesPerSec,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.type.Stream,
        });
    }
    onEvent(event) {
        this.privEvents.onEvent(event);
        _common_Exports__WEBPACK_IMPORTED_MODULE_6__.Events.instance.onEvent(event);
    }
}

//# sourceMappingURL=AudioInputStream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioOutputFormatImpl": () => (/* binding */ AudioOutputFormatImpl)
/* harmony export */ });
/* harmony import */ var _SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../SpeechSynthesisOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
/* harmony import */ var _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * @private
 * @class AudioOutputFormatImpl
 * Updated in version 1.17.0
 */
// eslint-disable-next-line max-classes-per-file
class AudioOutputFormatImpl extends _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormatImpl {
    /**
     * Creates an instance with the given values.
     * @constructor
     * @param formatTag
     * @param {number} channels - Number of channels.
     * @param {number} samplesPerSec - Samples per second.
     * @param {number} avgBytesPerSec - Average bytes per second.
     * @param {number} blockAlign - Block alignment.
     * @param {number} bitsPerSample - Bits per sample.
     * @param {string} audioFormatString - Audio format string
     * @param {string} requestAudioFormatString - Audio format string sent to service.
     * @param {boolean} hasHeader - If the format has header or not.
     */
    constructor(formatTag, channels, samplesPerSec, avgBytesPerSec, blockAlign, bitsPerSample, audioFormatString, requestAudioFormatString, hasHeader) {
        super(samplesPerSec, bitsPerSample, channels, formatTag);
        this.formatTag = formatTag;
        this.avgBytesPerSec = avgBytesPerSec;
        this.blockAlign = blockAlign;
        this.priAudioFormatString = audioFormatString;
        this.priRequestAudioFormatString = requestAudioFormatString;
        this.priHasHeader = hasHeader;
    }
    static fromSpeechSynthesisOutputFormat(speechSynthesisOutputFormat) {
        if (speechSynthesisOutputFormat === undefined) {
            return AudioOutputFormatImpl.getDefaultOutputFormat();
        }
        return AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(AudioOutputFormatImpl.SpeechSynthesisOutputFormatToString[speechSynthesisOutputFormat]);
    }
    static fromSpeechSynthesisOutputFormatString(speechSynthesisOutputFormatString) {
        switch (speechSynthesisOutputFormatString) {
            case "raw-8khz-8bit-mono-mulaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-16khz-16kbps-mono-siren":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.Siren, 1, 16000, 2000, 40, 0, speechSynthesisOutputFormatString, "audio-16khz-16kbps-mono-siren", true);
            case "audio-16khz-16kbps-mono-siren":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.Siren, 1, 16000, 2000, 40, 0, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-32kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 16000, 32 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-128kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 16000, 128 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-64kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 16000, 64 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-48kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 24000, 48 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-96kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 24000, 96 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-160kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 24000, 160 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-16khz-16bit-mono-truesilk":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.SILKSkype, 1, 16000, 32000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-8khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 8000, 16000, 2, 16, speechSynthesisOutputFormatString, "raw-8khz-16bit-mono-pcm", true);
            case "riff-24khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 24000, 48000, 2, 16, speechSynthesisOutputFormatString, "raw-24khz-16bit-mono-pcm", true);
            case "riff-8khz-8bit-mono-mulaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, "raw-8khz-8bit-mono-mulaw", true);
            case "raw-16khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 16000, 32000, 2, 16, speechSynthesisOutputFormatString, "raw-16khz-16bit-mono-pcm", false);
            case "raw-24khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 24000, 48000, 2, 16, speechSynthesisOutputFormatString, "raw-24khz-16bit-mono-pcm", false);
            case "raw-8khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 8000, 16000, 2, 16, speechSynthesisOutputFormatString, "raw-8khz-16bit-mono-pcm", false);
            case "ogg-16khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS, 1, 16000, 8192, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "ogg-24khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS, 1, 24000, 8192, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-48khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 48000, 96000, 2, 16, speechSynthesisOutputFormatString, "raw-48khz-16bit-mono-pcm", false);
            case "riff-48khz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 48000, 96000, 2, 16, speechSynthesisOutputFormatString, "raw-48khz-16bit-mono-pcm", true);
            case "audio-48khz-96kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 48000, 96 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-48khz-192kbitrate-mono-mp3":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3, 1, 48000, 192 << 7, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "ogg-48khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS, 1, 48000, 12000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "webm-16khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS, 1, 16000, 4000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "webm-24khz-16bit-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS, 1, 24000, 6000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "webm-24khz-16bit-24kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS, 1, 24000, 3000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-16khz-16bit-32kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OPUS, 1, 16000, 4000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-16bit-48kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OPUS, 1, 24000, 6000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-16bit-24kbps-mono-opus":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OPUS, 1, 24000, 3000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-24khz-16bit-mono-flac":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.FLAC, 1, 24000, 24000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "audio-48khz-16bit-mono-flac":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.FLAC, 1, 48000, 30000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-24khz-16bit-mono-truesilk":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.SILKSkype, 1, 24000, 48000, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "raw-8khz-8bit-mono-alaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-8khz-8bit-mono-alaw":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw, 1, 8000, 8000, 1, 8, speechSynthesisOutputFormatString, "raw-8khz-8bit-mono-alaw", true);
            case "raw-22050hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 22050, 44100, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-22050hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 22050, 44100, 2, 16, speechSynthesisOutputFormatString, "raw-22050hz-16bit-mono-pcm", true);
            case "raw-44100hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 44100, 88200, 2, 16, speechSynthesisOutputFormatString, speechSynthesisOutputFormatString, false);
            case "riff-44100hz-16bit-mono-pcm":
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 44100, 88200, 2, 16, speechSynthesisOutputFormatString, "raw-44100hz-16bit-mono-pcm", true);
            case "riff-16khz-16bit-mono-pcm":
            default:
                return new AudioOutputFormatImpl(_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM, 1, 16000, 32000, 2, 16, "riff-16khz-16bit-mono-pcm", "raw-16khz-16bit-mono-pcm", true);
        }
    }
    static getDefaultOutputFormat() {
        return AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString((typeof window !== "undefined") ? "audio-24khz-48kbitrate-mono-mp3" : "riff-16khz-16bit-mono-pcm");
    }
    /**
     * Specifies if this audio output format has a header
     * @boolean AudioOutputFormatImpl.prototype.hasHeader
     * @function
     * @public
     */
    get hasHeader() {
        return this.priHasHeader;
    }
    /**
     * Specifies the header of this format
     * @ArrayBuffer AudioOutputFormatImpl.prototype.header
     * @function
     * @public
     */
    get header() {
        if (this.hasHeader) {
            return this.privHeader;
        }
        return undefined;
    }
    /**
     * Updates the header based on the audio length
     * @member AudioOutputFormatImpl.updateHeader
     * @function
     * @public
     * @param {number} audioLength - the audio length
     */
    updateHeader(audioLength) {
        if (this.priHasHeader) {
            const view = new DataView(this.privHeader);
            view.setUint32(4, audioLength + this.privHeader.byteLength - 8, true);
            view.setUint32(40, audioLength, true);
        }
    }
    /**
     * Specifies the audio format string to be sent to the service
     * @string AudioOutputFormatImpl.prototype.requestAudioFormatString
     * @function
     * @public
     */
    get requestAudioFormatString() {
        return this.priRequestAudioFormatString;
    }
}
AudioOutputFormatImpl.SpeechSynthesisOutputFormatToString = {
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]: "raw-8khz-8bit-mono-mulaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]: "riff-16khz-16kbps-mono-siren",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]: "audio-16khz-16kbps-mono-siren",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]: "audio-16khz-32kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]: "audio-16khz-128kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]: "audio-16khz-64kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]: "audio-24khz-48kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]: "audio-24khz-96kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]: "audio-24khz-160kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]: "raw-16khz-16bit-mono-truesilk",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]: "riff-16khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]: "riff-8khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]: "riff-24khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]: "riff-8khz-8bit-mono-mulaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]: "raw-16khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]: "raw-24khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]: "raw-8khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]: "ogg-16khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]: "ogg-24khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]: "raw-48khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]: "riff-48khz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]: "audio-48khz-96kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]: "audio-48khz-192kbitrate-mono-mp3",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]: "ogg-48khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]: "webm-16khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]: "webm-24khz-16bit-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]: "webm-24khz-16bit-24kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]: "raw-24khz-16bit-mono-truesilk",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]: "raw-8khz-8bit-mono-alaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]: "riff-8khz-8bit-mono-alaw",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]: "audio-16khz-16bit-32kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]: "audio-24khz-16bit-48kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]: "audio-24khz-16bit-24kbps-mono-opus",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]: "raw-22050hz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]: "riff-22050hz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]: "raw-44100hz-16bit-mono-pcm",
    [_SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_1__.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]: "riff-44100hz-16bit-mono-pcm",
};

//# sourceMappingURL=AudioOutputFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioOutputStream": () => (/* binding */ AudioOutputStream),
/* harmony export */   "PullAudioOutputStream": () => (/* binding */ PullAudioOutputStream),
/* harmony export */   "PullAudioOutputStreamImpl": () => (/* binding */ PullAudioOutputStreamImpl),
/* harmony export */   "PushAudioOutputStream": () => (/* binding */ PushAudioOutputStream),
/* harmony export */   "PushAudioOutputStreamImpl": () => (/* binding */ PushAudioOutputStreamImpl)
/* harmony export */ });
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Stream.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */



/**
 * Represents audio output stream used for custom audio output configurations.
 * @class AudioOutputStream
 */
class AudioOutputStream {
    /**
     * Creates and initializes an instance.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Creates a memory backed PullAudioOutputStream with the specified audio format.
     * @member AudioOutputStream.createPullStream
     * @function
     * @public
     * @returns {PullAudioOutputStream} The audio output stream being created.
     */
    static createPullStream() {
        return PullAudioOutputStream.create();
    }
}
/**
 * Represents memory backed push audio output stream used for custom audio output configurations.
 * @class PullAudioOutputStream
 */
class PullAudioOutputStream extends AudioOutputStream {
    /**
     * Creates a memory backed PullAudioOutputStream with the specified audio format.
     * @member PullAudioOutputStream.create
     * @function
     * @public
     * @returns {PullAudioOutputStream} The push audio output stream being created.
     */
    static create() {
        return new PullAudioOutputStreamImpl();
    }
}
/**
 * Represents memory backed push audio output stream used for custom audio output configurations.
 * @private
 * @class PullAudioOutputStreamImpl
 */
class PullAudioOutputStreamImpl extends PullAudioOutputStream {
    /**
     * Creates and initializes an instance with the given values.
     * @constructor
     */
    constructor() {
        super();
        this.privId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privStream = new _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Stream();
    }
    /**
     * Sets the format information to the stream. For internal use only.
     * @param {AudioStreamFormat} format - the format to be set.
     */
    set format(format) {
        if (format === undefined || format === null) {
            this.privFormat = _AudioOutputFormat__WEBPACK_IMPORTED_MODULE_2__.AudioOutputFormatImpl.getDefaultOutputFormat();
        }
        this.privFormat = format;
    }
    /**
     * Format information for the audio
     */
    get format() {
        return this.privFormat;
    }
    /**
     * Checks if the stream is closed
     * @member PullAudioOutputStreamImpl.prototype.isClosed
     * @property
     * @public
     */
    get isClosed() {
        return this.privStream.isClosed;
    }
    /**
     * Gets the id of the stream
     * @member PullAudioOutputStreamImpl.prototype.id
     * @property
     * @public
     */
    id() {
        return this.privId;
    }
    /**
     * Reads audio data from the internal buffer.
     * @member PullAudioOutputStreamImpl.prototype.read
     * @function
     * @public
     * @param {ArrayBuffer} dataBuffer - An ArrayBuffer to store the read data.
     * @returns {Promise<number>} - Audio buffer length has been read.
     */
    read(dataBuffer) {
        return __awaiter(this, void 0, void 0, function* () {
            const intView = new Int8Array(dataBuffer);
            let totalBytes = 0;
            if (this.privLastChunkView !== undefined) {
                if (this.privLastChunkView.length > dataBuffer.byteLength) {
                    intView.set(this.privLastChunkView.slice(0, dataBuffer.byteLength));
                    this.privLastChunkView = this.privLastChunkView.slice(dataBuffer.byteLength);
                    return Promise.resolve(dataBuffer.byteLength);
                }
                intView.set(this.privLastChunkView);
                totalBytes = this.privLastChunkView.length;
                this.privLastChunkView = undefined;
            }
            // Until we have the minimum number of bytes to send in a transmission, keep asking for more.
            while (totalBytes < dataBuffer.byteLength && !this.privStream.isReadEnded) {
                const chunk = yield this.privStream.read();
                if (chunk !== undefined && !chunk.isEnd) {
                    let tmpBuffer;
                    if (chunk.buffer.byteLength > dataBuffer.byteLength - totalBytes) {
                        tmpBuffer = chunk.buffer.slice(0, dataBuffer.byteLength - totalBytes);
                        this.privLastChunkView = new Int8Array(chunk.buffer.slice(dataBuffer.byteLength - totalBytes));
                    }
                    else {
                        tmpBuffer = chunk.buffer;
                    }
                    intView.set(new Int8Array(tmpBuffer), totalBytes);
                    totalBytes += tmpBuffer.byteLength;
                }
                else {
                    this.privStream.readEnded();
                }
            }
            return totalBytes;
        });
    }
    /**
     * Writes the audio data specified by making an internal copy of the data.
     * @member PullAudioOutputStreamImpl.prototype.write
     * @function
     * @public
     * @param {ArrayBuffer} dataBuffer - The audio buffer of which this function will make a copy.
     */
    write(dataBuffer) {
        _Contracts__WEBPACK_IMPORTED_MODULE_3__.Contracts.throwIfNullOrUndefined(this.privStream, "must set format before writing");
        this.privStream.writeStreamChunk({
            buffer: dataBuffer,
            isEnd: false,
            timeReceived: Date.now()
        });
    }
    /**
     * Closes the stream.
     * @member PullAudioOutputStreamImpl.prototype.close
     * @function
     * @public
     */
    close() {
        this.privStream.close();
    }
}
/*
 * Represents audio output stream used for custom audio output configurations.
 * @class PushAudioOutputStream
 */
class PushAudioOutputStream extends AudioOutputStream {
    /**
     * Creates and initializes and instance.
     * @constructor
     */
    constructor() {
        super();
    }
    /**
     * Creates a PushAudioOutputStream that delegates to the specified callback interface for
     * write() and close() methods.
     * @member PushAudioOutputStream.create
     * @function
     * @public
     * @param {PushAudioOutputStreamCallback} callback - The custom audio output object,
     * derived from PushAudioOutputStreamCallback
     * @returns {PushAudioOutputStream} The push audio output stream being created.
     */
    static create(callback) {
        return new PushAudioOutputStreamImpl(callback);
    }
}
/**
 * Represents audio output stream used for custom audio output configurations.
 * @private
 * @class PushAudioOutputStreamImpl
 */
class PushAudioOutputStreamImpl extends PushAudioOutputStream {
    /**
     * Creates a PushAudioOutputStream that delegates to the specified callback interface for
     * read() and close() methods.
     * @constructor
     * @param {PushAudioOutputStreamCallback} callback - The custom audio output object,
     * derived from PushAudioOutputStreamCallback
     */
    constructor(callback) {
        super();
        this.privId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.createNoDashGuid)();
        this.privCallback = callback;
    }
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    set format(format) { }
    write(buffer) {
        if (!!this.privCallback.write) {
            this.privCallback.write(buffer);
        }
    }
    close() {
        if (!!this.privCallback.close) {
            this.privCallback.close();
        }
    }
    id() {
        return this.privId;
    }
}

//# sourceMappingURL=AudioOutputStream.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioFormatTag": () => (/* binding */ AudioFormatTag),
/* harmony export */   "AudioStreamFormat": () => (/* binding */ AudioStreamFormat),
/* harmony export */   "AudioStreamFormatImpl": () => (/* binding */ AudioStreamFormatImpl)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// eslint-disable-next-line max-classes-per-file
var AudioFormatTag;
(function (AudioFormatTag) {
    AudioFormatTag[AudioFormatTag["PCM"] = 1] = "PCM";
    AudioFormatTag[AudioFormatTag["MuLaw"] = 2] = "MuLaw";
    AudioFormatTag[AudioFormatTag["Siren"] = 3] = "Siren";
    AudioFormatTag[AudioFormatTag["MP3"] = 4] = "MP3";
    AudioFormatTag[AudioFormatTag["SILKSkype"] = 5] = "SILKSkype";
    AudioFormatTag[AudioFormatTag["OGG_OPUS"] = 6] = "OGG_OPUS";
    AudioFormatTag[AudioFormatTag["WEBM_OPUS"] = 7] = "WEBM_OPUS";
    AudioFormatTag[AudioFormatTag["ALaw"] = 8] = "ALaw";
    AudioFormatTag[AudioFormatTag["FLAC"] = 9] = "FLAC";
    AudioFormatTag[AudioFormatTag["OPUS"] = 10] = "OPUS";
})(AudioFormatTag || (AudioFormatTag = {}));
/**
 * Represents audio stream format used for custom audio input configurations.
 * @class AudioStreamFormat
 */
class AudioStreamFormat {
    /**
     * Creates an audio stream format object representing the default audio stream
     * format (16KHz 16bit mono PCM).
     * @member AudioStreamFormat.getDefaultInputFormat
     * @function
     * @public
     * @returns {AudioStreamFormat} The audio stream format being created.
     */
    static getDefaultInputFormat() {
        return AudioStreamFormatImpl.getDefaultInputFormat();
    }
    /**
     * Creates an audio stream format object with the specified format characteristics.
     * @member AudioStreamFormat.getWaveFormat
     * @function
     * @public
     * @param {number} samplesPerSecond - Sample rate, in samples per second (Hertz).
     * @param {number} bitsPerSample - Bits per sample, typically 16.
     * @param {number} channels - Number of channels in the waveform-audio data. Monaural data
     * uses one channel and stereo data uses two channels.
     * @param {AudioFormatTag} format - Audio format (PCM, alaw or mulaw).
     * @returns {AudioStreamFormat} The audio stream format being created.
     */
    static getWaveFormat(samplesPerSecond, bitsPerSample, channels, format) {
        return new AudioStreamFormatImpl(samplesPerSecond, bitsPerSample, channels, format);
    }
    /**
     * Creates an audio stream format object with the specified pcm waveformat characteristics.
     * @member AudioStreamFormat.getWaveFormatPCM
     * @function
     * @public
     * @param {number} samplesPerSecond - Sample rate, in samples per second (Hertz).
     * @param {number} bitsPerSample - Bits per sample, typically 16.
     * @param {number} channels - Number of channels in the waveform-audio data. Monaural data
     * uses one channel and stereo data uses two channels.
     * @returns {AudioStreamFormat} The audio stream format being created.
     */
    static getWaveFormatPCM(samplesPerSecond, bitsPerSample, channels) {
        return new AudioStreamFormatImpl(samplesPerSecond, bitsPerSample, channels);
    }
}
/**
 * @private
 * @class AudioStreamFormatImpl
 */
class AudioStreamFormatImpl extends AudioStreamFormat {
    /**
     * Creates an instance with the given values.
     * @constructor
     * @param {number} samplesPerSec - Samples per second.
     * @param {number} bitsPerSample - Bits per sample.
     * @param {number} channels - Number of channels.
     * @param {AudioFormatTag} format - Audio format (PCM, alaw or mulaw).
     */
    constructor(samplesPerSec = 16000, bitsPerSample = 16, channels = 1, format = AudioFormatTag.PCM) {
        super();
        let isWavFormat = true;
        /* 1 for PCM; 6 for alaw; 7 for mulaw */
        switch (format) {
            case AudioFormatTag.PCM:
                this.formatTag = 1;
                break;
            case AudioFormatTag.ALaw:
                this.formatTag = 6;
                break;
            case AudioFormatTag.MuLaw:
                this.formatTag = 7;
                break;
            default:
                isWavFormat = false;
        }
        this.bitsPerSample = bitsPerSample;
        this.samplesPerSec = samplesPerSec;
        this.channels = channels;
        this.avgBytesPerSec = this.samplesPerSec * this.channels * (this.bitsPerSample / 8);
        this.blockAlign = this.channels * Math.max(this.bitsPerSample, 8);
        if (isWavFormat) {
            this.privHeader = new ArrayBuffer(44);
            // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView
            const view = new DataView(this.privHeader);
            /* RIFF identifier */
            this.setString(view, 0, "RIFF");
            /* file length */
            view.setUint32(4, 0, true);
            /* RIFF type & Format */
            this.setString(view, 8, "WAVEfmt ");
            /* format chunk length */
            view.setUint32(16, 16, true);
            /* audio format */
            view.setUint16(20, this.formatTag, true);
            /* channel count */
            view.setUint16(22, this.channels, true);
            /* sample rate */
            view.setUint32(24, this.samplesPerSec, true);
            /* byte rate (sample rate * block align) */
            view.setUint32(28, this.avgBytesPerSec, true);
            /* block align (channel count * bytes per sample) */
            view.setUint16(32, this.channels * (this.bitsPerSample / 8), true);
            /* bits per sample */
            view.setUint16(34, this.bitsPerSample, true);
            /* data chunk identifier */
            this.setString(view, 36, "data");
            /* data chunk length */
            view.setUint32(40, 0, true);
        }
    }
    /**
     * Retrieves the default input format.
     * @member AudioStreamFormatImpl.getDefaultInputFormat
     * @function
     * @public
     * @returns {AudioStreamFormatImpl} The default input format.
     */
    static getDefaultInputFormat() {
        return new AudioStreamFormatImpl();
    }
    /**
     * Creates an audio context appropriate to current browser
     * @member AudioStreamFormatImpl.getAudioContext
     * @function
     * @public
     * @returns {AudioContext} An audio context instance
     */
    /* eslint-disable */
    static getAudioContext(sampleRate) {
        // Workaround for Speech SDK bug in Safari.
        const AudioContext = window.AudioContext // our preferred impl
            || window.webkitAudioContext // fallback, mostly when on Safari
            || false; // could not find.
        // https://developer.mozilla.org/en-US/docs/Web/API/AudioContext
        if (!!AudioContext) {
            if (sampleRate !== undefined && navigator.mediaDevices.getSupportedConstraints().sampleRate) {
                return new AudioContext({ sampleRate });
            }
            else {
                return new AudioContext();
            }
        }
        else {
            throw new Error("Browser does not support Web Audio API (AudioContext is not available).");
        }
    }
    /* eslint-enable */
    /**
     * Closes the configuration object.
     * @member AudioStreamFormatImpl.prototype.close
     * @function
     * @public
     */
    close() {
        return;
    }
    get header() {
        return this.privHeader;
    }
    setString(view, offset, str) {
        for (let i = 0; i < str.length; i++) {
            view.setUint8(offset + i, str.charCodeAt(i));
        }
    }
}

//# sourceMappingURL=AudioStreamFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/BaseAudioPlayer.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/BaseAudioPlayer.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BaseAudioPlayer": () => (/* binding */ BaseAudioPlayer)
/* harmony export */ });
/* harmony import */ var _common_Error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Error */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Error.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Base audio player class
 * TODO: Plays only PCM for now.
 * @class
 */
class BaseAudioPlayer {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {AudioStreamFormat} audioFormat audio stream format recognized by the player.
     */
    constructor(audioFormat) {
        this.audioContext = null;
        this.gainNode = null;
        this.autoUpdateBufferTimer = 0;
        if (audioFormat === undefined) {
            audioFormat = _Exports__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormat.getDefaultInputFormat();
        }
        this.init(audioFormat);
    }
    /**
     * play Audio sample
     * @param newAudioData audio data to be played.
     */
    playAudioSample(newAudioData, cb, err) {
        try {
            this.ensureInitializedContext();
            const audioData = this.formatAudioData(newAudioData);
            const newSamplesData = new Float32Array(this.samples.length + audioData.length);
            newSamplesData.set(this.samples, 0);
            newSamplesData.set(audioData, this.samples.length);
            this.samples = newSamplesData;
            if (!!cb) {
                cb();
            }
        }
        catch (e) {
            if (!!err) {
                err(e);
            }
        }
    }
    /**
     * stops audio and clears the buffers
     */
    stopAudio(cb, err) {
        if (this.audioContext !== null) {
            this.samples = new Float32Array();
            // eslint-disable-next-line @typescript-eslint/no-unsafe-argument
            clearInterval(this.autoUpdateBufferTimer);
            this.audioContext.close().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
            this.audioContext = null;
        }
    }
    init(audioFormat) {
        this.audioFormat = audioFormat;
        this.samples = new Float32Array();
    }
    ensureInitializedContext() {
        if (this.audioContext === null) {
            this.createAudioContext();
            const timerPeriod = 200;
            this.autoUpdateBufferTimer = setInterval(() => {
                this.updateAudioBuffer();
            }, timerPeriod);
        }
    }
    createAudioContext() {
        // new ((window as any).AudioContext || (window as any).webkitAudioContext)();
        this.audioContext = _Exports__WEBPACK_IMPORTED_MODULE_0__.AudioStreamFormatImpl.getAudioContext();
        // TODO: Various examples shows this gain node, it does not seem to be needed unless we plan
        // to control the volume, not likely
        this.gainNode = this.audioContext.createGain();
        this.gainNode.gain.value = 1;
        this.gainNode.connect(this.audioContext.destination);
        this.startTime = this.audioContext.currentTime;
    }
    formatAudioData(audioData) {
        switch (this.audioFormat.bitsPerSample) {
            case 8:
                return this.formatArrayBuffer(new Int8Array(audioData), 128);
            case 16:
                return this.formatArrayBuffer(new Int16Array(audioData), 32768);
            case 32:
                return this.formatArrayBuffer(new Int32Array(audioData), 2147483648);
            default:
                throw new _common_Error__WEBPACK_IMPORTED_MODULE_1__.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time");
        }
    }
    formatArrayBuffer(audioData, maxValue) {
        const float32Data = new Float32Array(audioData.length);
        for (let i = 0; i < audioData.length; i++) {
            float32Data[i] = audioData[i] / maxValue;
        }
        return float32Data;
    }
    updateAudioBuffer() {
        if (this.samples.length === 0) {
            return;
        }
        const channelCount = this.audioFormat.channels;
        const bufferSource = this.audioContext.createBufferSource();
        const frameCount = this.samples.length / channelCount;
        const audioBuffer = this.audioContext.createBuffer(channelCount, frameCount, this.audioFormat.samplesPerSec);
        // TODO: Should we do the conversion in the pushAudioSample instead?
        for (let channel = 0; channel < channelCount; channel++) {
            // Fill in individual channel data
            let channelOffset = channel;
            const audioData = audioBuffer.getChannelData(channel);
            for (let i = 0; i < this.samples.length; i++, channelOffset += channelCount) {
                audioData[i] = this.samples[channelOffset];
            }
        }
        if (this.startTime < this.audioContext.currentTime) {
            this.startTime = this.audioContext.currentTime;
        }
        bufferSource.buffer = audioBuffer;
        bufferSource.connect(this.gainNode);
        bufferSource.start(this.startTime);
        // Make sure we play the next sample after the current one.
        this.startTime += audioBuffer.duration;
        // Clear the samples for the next pushed data.
        this.samples = new Float32Array();
    }
    playAudio(audioData) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.audioContext === null) {
                this.createAudioContext();
            }
            const source = this.audioContext.createBufferSource();
            const destination = this.audioContext.destination;
            yield this.audioContext.decodeAudioData(audioData, (newBuffer) => {
                source.buffer = newBuffer;
                source.connect(destination);
                source.start(0);
            });
        });
    }
}

//# sourceMappingURL=BaseAudioPlayer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PullAudioInputStreamCallback": () => (/* binding */ PullAudioInputStreamCallback)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * An abstract base class that defines callback methods (read() and close()) for
 * custom audio input streams).
 * @class PullAudioInputStreamCallback
 */
class PullAudioInputStreamCallback {
}

//# sourceMappingURL=PullAudioInputStreamCallback.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js ***!
  \***************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PushAudioOutputStreamCallback": () => (/* binding */ PushAudioOutputStreamCallback)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * An abstract base class that defines callback methods (write() and close()) for
 * custom audio output streams).
 * @class PushAudioOutputStreamCallback
 */
class PushAudioOutputStreamCallback {
}

//# sourceMappingURL=PushAudioOutputStreamCallback.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerAudioDestination": () => (/* binding */ SpeakerAudioDestination)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/BackgroundError.js");
/* harmony import */ var _AudioOutputStream__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




const MediaDurationPlaceholderSeconds = 60 * 30;
const AudioFormatToMimeType = {
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM]: "audio/wav",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw]: "audio/x-wav",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MP3]: "audio/mpeg",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.OGG_OPUS]: "audio/ogg",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.WEBM_OPUS]: "audio/webm; codecs=opus",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw]: "audio/x-wav",
    [_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.FLAC]: "audio/flac",
};
/**
 * Represents the speaker playback audio destination, which only works in browser.
 * Note: the SDK will try to use <a href="https://www.w3.org/TR/media-source/">Media Source Extensions</a> to play audio.
 * Mp3 format has better supports on Microsoft Edge, Chrome and Safari (desktop), so, it's better to specify mp3 format for playback.
 * @class SpeakerAudioDestination
 * Updated in version 1.17.0
 */
class SpeakerAudioDestination {
    constructor(audioDestinationId) {
        this.privPlaybackStarted = false;
        this.privAppendingToBuffer = false;
        this.privMediaSourceOpened = false;
        this.privBytesReceived = 0;
        this.privId = audioDestinationId ? audioDestinationId : (0,_common_Exports__WEBPACK_IMPORTED_MODULE_1__.createNoDashGuid)();
        this.privIsPaused = false;
        this.privIsClosed = false;
    }
    id() {
        return this.privId;
    }
    write(buffer, cb, err) {
        if (this.privAudioBuffer !== undefined) {
            this.privAudioBuffer.push(buffer);
            this.updateSourceBuffer().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        else if (this.privAudioOutputStream !== undefined) {
            this.privAudioOutputStream.write(buffer);
            this.privBytesReceived += buffer.byteLength;
        }
    }
    close(cb, err) {
        this.privIsClosed = true;
        if (this.privSourceBuffer !== undefined) {
            this.handleSourceBufferUpdateEnd().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        else if (this.privAudioOutputStream !== undefined && typeof window !== "undefined") {
            if ((this.privFormat.formatTag === _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.PCM || this.privFormat.formatTag === _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.MuLaw
                || this.privFormat.formatTag === _AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag.ALaw) && this.privFormat.hasHeader === false) {
                // eslint-disable-next-line no-console
                console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header.");
                if (!!this.onAudioEnd) {
                    this.onAudioEnd(this);
                }
            }
            else {
                let receivedAudio = new ArrayBuffer(this.privBytesReceived);
                this.privAudioOutputStream.read(receivedAudio).then(() => {
                    receivedAudio = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.SynthesisAdapterBase.addHeader(receivedAudio, this.privFormat);
                    const audioBlob = new Blob([receivedAudio], { type: AudioFormatToMimeType[this.privFormat.formatTag] });
                    this.privAudio.src = window.URL.createObjectURL(audioBlob);
                    this.notifyPlayback().then(() => {
                        if (!!cb) {
                            cb();
                        }
                    }, (error) => {
                        if (!!err) {
                            err(error);
                        }
                    });
                }, (error) => {
                    if (!!err) {
                        err(error);
                    }
                });
            }
        }
        else {
            // unsupported format, call onAudioEnd directly.
            if (!!this.onAudioEnd) {
                this.onAudioEnd(this);
            }
        }
    }
    set format(format) {
        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access
        if (typeof (AudioContext) !== "undefined" || (typeof (window) !== "undefined" && typeof (window.webkitAudioContext) !== "undefined")) {
            this.privFormat = format;
            const mimeType = AudioFormatToMimeType[this.privFormat.formatTag];
            if (mimeType === undefined) {
                // eslint-disable-next-line no-console
                console.warn(`Unknown mimeType for format ${_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`);
            }
            else if (typeof (MediaSource) !== "undefined" && MediaSource.isTypeSupported(mimeType)) {
                this.privAudio = new Audio();
                this.privAudioBuffer = [];
                this.privMediaSource = new MediaSource();
                this.privAudio.src = URL.createObjectURL(this.privMediaSource);
                this.privAudio.load();
                this.privMediaSource.onsourceopen = () => {
                    this.privMediaSourceOpened = true;
                    this.privMediaSource.duration = MediaDurationPlaceholderSeconds;
                    this.privSourceBuffer = this.privMediaSource.addSourceBuffer(mimeType);
                    this.privSourceBuffer.onupdate = () => {
                        this.updateSourceBuffer().catch((reason) => {
                            _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.BackgroundEvent(reason));
                        });
                    };
                    this.privSourceBuffer.onupdateend = () => {
                        this.handleSourceBufferUpdateEnd().catch((reason) => {
                            _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.BackgroundEvent(reason));
                        });
                    };
                    this.privSourceBuffer.onupdatestart = () => {
                        this.privAppendingToBuffer = false;
                    };
                };
                this.updateSourceBuffer().catch((reason) => {
                    _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Events.instance.onEvent(new _common_Exports__WEBPACK_IMPORTED_MODULE_4__.BackgroundEvent(reason));
                });
            }
            else {
                // eslint-disable-next-line no-console
                console.warn(`Format ${_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_0__.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`);
                this.privAudioOutputStream = new _AudioOutputStream__WEBPACK_IMPORTED_MODULE_5__.PullAudioOutputStreamImpl();
                this.privAudioOutputStream.format = this.privFormat;
                this.privAudio = new Audio();
            }
        }
    }
    get volume() {
        var _a, _b;
        return (_b = (_a = this.privAudio) === null || _a === void 0 ? void 0 : _a.volume) !== null && _b !== void 0 ? _b : -1;
    }
    set volume(volume) {
        if (!!this.privAudio) {
            this.privAudio.volume = volume;
        }
    }
    mute() {
        if (!!this.privAudio) {
            this.privAudio.muted = true;
        }
    }
    unmute() {
        if (!!this.privAudio) {
            this.privAudio.muted = false;
        }
    }
    get isClosed() {
        return this.privIsClosed;
    }
    get currentTime() {
        if (this.privAudio !== undefined) {
            return this.privAudio.currentTime;
        }
        return -1;
    }
    pause() {
        if (!this.privIsPaused && this.privAudio !== undefined) {
            this.privAudio.pause();
            this.privIsPaused = true;
        }
    }
    resume(cb, err) {
        if (this.privIsPaused && this.privAudio !== undefined) {
            this.privAudio.play().then(() => {
                if (!!cb) {
                    cb();
                }
            }, (error) => {
                if (!!err) {
                    err(error);
                }
            });
            this.privIsPaused = false;
        }
    }
    get internalAudio() {
        return this.privAudio;
    }
    updateSourceBuffer() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privAudioBuffer !== undefined && (this.privAudioBuffer.length > 0) && this.sourceBufferAvailable()) {
                this.privAppendingToBuffer = true;
                const binary = this.privAudioBuffer.shift();
                try {
                    this.privSourceBuffer.appendBuffer(binary);
                }
                catch (error) {
                    this.privAudioBuffer.unshift(binary);
                    // eslint-disable-next-line no-console
                    console.log("buffer filled, pausing addition of binaries until space is made");
                    return;
                }
                yield this.notifyPlayback();
            }
            else if (this.canEndStream()) {
                yield this.handleSourceBufferUpdateEnd();
            }
        });
    }
    handleSourceBufferUpdateEnd() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.canEndStream() && this.sourceBufferAvailable()) {
                this.privMediaSource.endOfStream();
                yield this.notifyPlayback();
            }
        });
    }
    notifyPlayback() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privPlaybackStarted && this.privAudio !== undefined) {
                this.privPlaybackStarted = true;
                if (!!this.onAudioStart) {
                    this.onAudioStart(this);
                }
                this.privAudio.onended = () => {
                    if (!!this.onAudioEnd) {
                        this.onAudioEnd(this);
                    }
                };
                if (!this.privIsPaused) {
                    yield this.privAudio.play();
                }
            }
        });
    }
    canEndStream() {
        return (this.isClosed && this.privSourceBuffer !== undefined && (this.privAudioBuffer.length === 0)
            && this.privMediaSourceOpened && !this.privAppendingToBuffer && this.privMediaSource.readyState === "open");
    }
    sourceBufferAvailable() {
        return (this.privSourceBuffer !== undefined && !this.privSourceBuffer.updating);
    }
}

//# sourceMappingURL=SpeakerAudioDestination.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageConfig.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageConfig.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AutoDetectSourceLanguageConfig": () => (/* binding */ AutoDetectSourceLanguageConfig)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _LanguageIdMode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LanguageIdMode */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.




/**
 * Language auto detect configuration.
 * @class AutoDetectSourceLanguageConfig
 * Added in version 1.13.0.
 */
class AutoDetectSourceLanguageConfig {
    constructor() {
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_LanguageIdMode, "AtStart");
        this.privLanguageIdMode = _LanguageIdMode__WEBPACK_IMPORTED_MODULE_2__.LanguageIdMode.AtStart;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.fromOpenRange
     * @function
     * @public
     * Only [[SpeechSynthesizer]] supports source language auto detection from open range,
     * for [[Recognizer]], please use AutoDetectSourceLanguageConfig with specific source languages.
     * @return {AutoDetectSourceLanguageConfig} Instance of AutoDetectSourceLanguageConfig
     * @summary Creates an instance of the AutoDetectSourceLanguageConfig with open range.
     */
    static fromOpenRange() {
        const config = new AutoDetectSourceLanguageConfig();
        config.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.AutoDetectSourceLanguagesOpenRangeOptionName);
        return config;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.fromLanguages
     * @function
     * @public
     * @param {string[]} languages Comma-separated string of languages (eg. "en-US,fr-FR") to populate properties of config.
     * @return {AutoDetectSourceLanguageConfig} Instance of AutoDetectSourceLanguageConfig
     * @summary Creates an instance of the AutoDetectSourceLanguageConfig with given languages.
     */
    static fromLanguages(languages) {
        _Contracts__WEBPACK_IMPORTED_MODULE_4__.Contracts.throwIfArrayEmptyOrWhitespace(languages, "languages");
        const config = new AutoDetectSourceLanguageConfig();
        config.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, languages.join());
        return config;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.fromSourceLanguageConfigs
     * @function
     * @public
     * @param {SourceLanguageConfig[]} configs SourceLanguageConfigs to populate properties of config.
     * @return {AutoDetectSourceLanguageConfig} Instance of AutoDetectSourceLanguageConfig
     * @summary Creates an instance of the AutoDetectSourceLanguageConfig with given SourceLanguageConfigs.
     */
    static fromSourceLanguageConfigs(configs) {
        if (configs.length < 1) {
            throw new Error("Expected non-empty SourceLanguageConfig array.");
        }
        const autoConfig = new AutoDetectSourceLanguageConfig();
        const langs = [];
        configs.forEach((config) => {
            langs.push(config.language);
            if (config.endpointId !== undefined && config.endpointId !== "") {
                const customProperty = config.language + _Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId.toString();
                autoConfig.properties.setProperty(customProperty, config.endpointId);
            }
        });
        autoConfig.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, langs.join());
        return autoConfig;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.prototype.properties
     * @function
     * @public
     * @return {PropertyCollection} Properties of the config.
     * @summary Gets an auto detected language config properties
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * @member AutoDetectSourceLanguageConfig.prototype.mode
     * @function
     * @public
     * @param {LanguageIdMode} mode LID mode desired.
     * @summary Sets LID operation to desired mode
     */
    set mode(mode) {
        if (mode === _LanguageIdMode__WEBPACK_IMPORTED_MODULE_2__.LanguageIdMode.Continuous) {
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion, "2");
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_LanguageIdMode, "Continuous");
        }
        else { // LanguageIdMode.AtStart
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion, "1");
            this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_LanguageIdMode, "AtStart");
        }
        this.privLanguageIdMode = mode;
    }
}

//# sourceMappingURL=AutoDetectSourceLanguageConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageResult.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageResult.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AutoDetectSourceLanguageResult": () => (/* binding */ AutoDetectSourceLanguageResult)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Output format
 * @class AutoDetectSourceLanguageResult
 */
class AutoDetectSourceLanguageResult {
    constructor(language, languageDetectionConfidence) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(language, "language");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(languageDetectionConfidence, "languageDetectionConfidence");
        this.privLanguage = language;
        this.privLanguageDetectionConfidence = languageDetectionConfidence;
    }
    /**
     * Creates an instance of AutoDetectSourceLanguageResult object from a SpeechRecognitionResult instance.
     * @member AutoDetectSourceLanguageResult.fromResult
     * @function
     * @public
     * @param {SpeechRecognitionResult} result - The recognition result.
     * @returns {AutoDetectSourceLanguageResult} AutoDetectSourceLanguageResult object being created.
     */
    static fromResult(result) {
        return new AutoDetectSourceLanguageResult(result.language, result.languageDetectionConfidence);
    }
    get language() {
        return this.privLanguage;
    }
    get languageDetectionConfidence() {
        return this.privLanguageDetectionConfidence;
    }
}

//# sourceMappingURL=AutoDetectSourceLanguageResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/BotFrameworkConfig.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/BotFrameworkConfig.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BotFrameworkConfig": () => (/* binding */ BotFrameworkConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DialogServiceConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * Class that defines configurations for the dialog service connector object for using a Bot Framework backend.
 * @class BotFrameworkConfig
 */
class BotFrameworkConfig extends _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl {
    /**
     * Creates an instance of BotFrameworkConfig.
     */
    constructor() {
        super();
    }
    /**
     * Creates a bot framework configuration instance with the provided subscription information.
     * @member BotFrameworkConfig.fromSubscription
     * @function
     * @public
     * @param subscription Subscription key associated with the bot
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @param botId Optional. Identifier for using a specific bot within an Azure resource group. Equivalent to the
     * resource name.
     * @returns {BotFrameworkConfig} A new bot framework configuration instance.
     */
    static fromSubscription(subscription, region, botId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(subscription, "subscription");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscription);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        if (botId) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, botId);
        }
        return botFrameworkConfig;
    }
    /**
     * Creates a bot framework configuration instance for the specified authorization token and region.
     * Note: The caller must ensure that an authorization token is valid. Before an authorization token expires, the
     * caller must refresh it by setting the authorizationToken property on the corresponding
     * DialogServiceConnector instance created with this config. The contents of configuration objects are copied
     * when connectors are created, so setting authorizationToken on a DialogServiceConnector will not update the
     * original configuration's authorization token. Create a new configuration instance or set the
     * SpeechServiceAuthorization_Token property to update an existing instance if it will be used to create
     * further DialogServiceConnectors.
     * @member BotFrameworkConfig.fromAuthorizationToken
     * @function
     * @public
     * @param authorizationToken The authorization token associated with the bot
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @param botId Optional. Identifier for using a specific bot within an Azure resource group. Equivalent to the
     * resource name.
     * @returns {BotFrameworkConfig} A new bot framework configuration instance.
     */
    static fromAuthorizationToken(authorizationToken, region, botId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, authorizationToken);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        if (botId) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, botId);
        }
        return botFrameworkConfig;
    }
    /**
     * Creates an instance of a BotFrameworkConfig.
     * This method is intended only for users who use a non-default service host. The standard resource path will be
     * assumed. For services with a non-standard resource path or no path at all, use fromEndpoint instead.
     * Note: Query parameters are not allowed in the host URI and must be set by other APIs.
     * Note: To use an authorization token with fromHost, use fromHost(URL) and then set the AuthorizationToken
     * property on the created BotFrameworkConfig instance.
     * Note: Added in version 1.15.0.
     * @member BotFrameworkConfig.fromHost
     * @function
     * @public
     * @param {URL | string} host - If a URL is provided, the fully-qualified host with protocol (e.g.
     * wss://your.host.com:1234) will be used. If a string is provided, it will be embedded in
     * wss://{host}.convai.speech.azure.us.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization
     * token must be set.
     * @param botId Optional. Identifier for using a specific bot within an Azure resource group. Equivalent to the
     * resource name.
     * @returns {BotFrameworkConfig} A new bot framework configuration instance.
     */
    static fromHost(host, subscriptionKey, botId) {
        void botId;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(host, "host");
        const resolvedHost = host instanceof URL ? host : new URL(`wss://${host}.convai.speech.azure.us`);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(resolvedHost, "resolvedHost");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Host, resolvedHost.toString());
        if (undefined !== subscriptionKey) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return botFrameworkConfig;
    }
    /**
     * Creates an instance of a BotFrameworkConfig.
     * This method is intended only for users who use a non-standard service endpoint or parameters.
     * Note: The query parameters specified in the endpoint URL are not changed, even if they are set by any other APIs.
     * Note: To use authorization token with fromEndpoint, pass an empty string to the subscriptionKey in the
     * fromEndpoint method, and then set authorizationToken="token" on the created BotFrameworkConfig instance to
     * use the authorization token.
     * Note: Added in version 1.15.0.
     * @member BotFrameworkConfig.fromEndpoint
     * @function
     * @public
     * @param {URL} endpoint - The service endpoint to connect to.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization
     * token must be set.
     * @returns {BotFrameworkConfig} - A new bot framework configuration instance using the provided endpoint.
     */
    static fromEndpoint(endpoint, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(endpoint, "endpoint");
        const botFrameworkConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.BotFramework);
        botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Endpoint, endpoint.toString());
        if (undefined !== subscriptionKey) {
            botFrameworkConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return botFrameworkConfig;
    }
}

//# sourceMappingURL=BotFrameworkConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetails.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetails.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationDetails": () => (/* binding */ CancellationDetails)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/EnumTranslation.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CancellationDetailsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * Contains detailed information about why a result was canceled.
 * @class CancellationDetails
 */
class CancellationDetails extends _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of CancellationDetails object for the canceled RecognitionResult.
     * @member CancellationDetails.fromResult
     * @function
     * @public
     * @param {RecognitionResult | SpeechSynthesisResult} result - The result that was canceled.
     * @returns {CancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        let reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode.NoError;
        if (result instanceof _Exports__WEBPACK_IMPORTED_MODULE_3__.RecognitionResult && !!result.json) {
            const simpleSpeech = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.SimpleSpeechPhrase.fromJSON(result.json);
            reason = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.EnumTranslation.implTranslateCancelResult(simpleSpeech.RecognitionStatus);
        }
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCode.NoError])];
        }
        return new CancellationDetails(reason, result.errorDetails || _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.EnumTranslation.implTranslateErrorDetails(errorCode), errorCode);
    }
}

//# sourceMappingURL=CancellationDetails.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationDetailsBase": () => (/* binding */ CancellationDetailsBase)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Contains detailed information about why a result was canceled.
 * @class CancellationDetailsBase
 */
class CancellationDetailsBase {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {CancellationReason} reason - The cancellation reason.
     * @param {string} errorDetails - The error details, if provided.
     */
    constructor(reason, errorDetails, errorCode) {
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privErrorCode = errorCode;
    }
    /**
     * The reason the recognition was canceled.
     * @member CancellationDetailsBase.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member CancellationDetailsBase.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
    /**
     * The error code in case of an unsuccessful recognition.
     * Added in version 1.1.0.
     * @return An error code that represents the error reason.
     */
    get ErrorCode() {
        return this.privErrorCode;
    }
}

//# sourceMappingURL=CancellationDetailsBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationErrorCode": () => (/* binding */ CancellationErrorCode)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines error code in case that CancellationReason is Error.
 * Added in version 1.1.0.
 */
var CancellationErrorCode;
(function (CancellationErrorCode) {
    /**
     * Indicates that no error occurred during speech recognition.
     */
    CancellationErrorCode[CancellationErrorCode["NoError"] = 0] = "NoError";
    /**
     * Indicates an authentication error.
     */
    CancellationErrorCode[CancellationErrorCode["AuthenticationFailure"] = 1] = "AuthenticationFailure";
    /**
     * Indicates that one or more recognition parameters are invalid.
     */
    CancellationErrorCode[CancellationErrorCode["BadRequestParameters"] = 2] = "BadRequestParameters";
    /**
     * Indicates that the number of parallel requests exceeded the number of allowed
     * concurrent transcriptions for the subscription.
     */
    CancellationErrorCode[CancellationErrorCode["TooManyRequests"] = 3] = "TooManyRequests";
    /**
     * Indicates a connection error.
     */
    CancellationErrorCode[CancellationErrorCode["ConnectionFailure"] = 4] = "ConnectionFailure";
    /**
     * Indicates a time-out error when waiting for response from service.
     */
    CancellationErrorCode[CancellationErrorCode["ServiceTimeout"] = 5] = "ServiceTimeout";
    /**
     * Indicates that an error is returned by the service.
     */
    CancellationErrorCode[CancellationErrorCode["ServiceError"] = 6] = "ServiceError";
    /**
     * Indicates an unexpected runtime error.
     */
    CancellationErrorCode[CancellationErrorCode["RuntimeError"] = 7] = "RuntimeError";
    /**
     * Indicates an quota overrun on existing key.
     */
    CancellationErrorCode[CancellationErrorCode["Forbidden"] = 8] = "Forbidden";
})(CancellationErrorCode || (CancellationErrorCode = {}));

//# sourceMappingURL=CancellationErrorCodes.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationEventArgsBase": () => (/* binding */ CancellationEventArgsBase)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines content of a CancellationEvent.
 * @class CancellationEventArgsBase
 */
class CancellationEventArgsBase extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {CancellationReason} reason - The cancellation reason.
     * @param {string} errorDetails - Error details, if provided.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(reason, errorDetails, errorCode, offset, sessionId) {
        super(offset, sessionId);
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privErrorCode = errorCode;
    }
    /**
     * The reason the recognition was canceled.
     * @member CancellationEventArgsBase.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * The error code in case of an unsuccessful operation.
     * @return An error code that represents the error reason.
     */
    get errorCode() {
        return this.privErrorCode;
    }
    /**
     * In case of an unsuccessful operation, provides details of the occurred error.
     * @member CancellationEventArgsBase.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
}

//# sourceMappingURL=CancellationEventArgsBase.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CancellationReason": () => (/* binding */ CancellationReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the possible reasons a recognition result might be canceled.
 * @class CancellationReason
 */
var CancellationReason;
(function (CancellationReason) {
    /**
     * Indicates that an error occurred during speech recognition.
     * @member CancellationReason.Error
     */
    CancellationReason[CancellationReason["Error"] = 0] = "Error";
    /**
     * Indicates that the end of the audio stream was reached.
     * @member CancellationReason.EndOfStream
     */
    CancellationReason[CancellationReason["EndOfStream"] = 1] = "EndOfStream";
})(CancellationReason || (CancellationReason = {}));

//# sourceMappingURL=CancellationReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Connection": () => (/* binding */ Connection)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _ConnectionMessage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//





/**
 * Connection is a proxy class for managing connection to the speech service of the specified Recognizer.
 * By default, a Recognizer autonomously manages connection to service when needed.
 * The Connection class provides additional methods for users to explicitly open or close a connection and
 * to subscribe to connection status changes.
 * The use of Connection is optional, and mainly for scenarios where fine tuning of application
 * behavior based on connection status is needed. Users can optionally call Open() to manually set up a connection
 * in advance before starting recognition on the Recognizer associated with this Connection.
 * If the Recognizer needs to connect or disconnect to service, it will
 * setup or shutdown the connection independently. In this case the Connection will be notified by change of connection
 * status via Connected/Disconnected events.
 * Added in version 1.2.1.
 */
class Connection {
    /**
     * Gets the Connection instance from the specified recognizer.
     * @param recognizer The recognizer associated with the connection.
     * @return The Connection instance of the recognizer.
     */
    static fromRecognizer(recognizer) {
        const recoBase = recognizer.internalData;
        const ret = new Connection();
        ret.privInternalData = recoBase;
        ret.setupEvents();
        return ret;
    }
    /**
     * Gets the Connection instance from the specified synthesizer.
     * @param synthesizer The synthesizer associated with the connection.
     * @return The Connection instance of the synthesizer.
     */
    static fromSynthesizer(synthesizer) {
        const synthBase = synthesizer.internalData;
        const ret = new Connection();
        ret.privInternalData = synthBase;
        ret.setupEvents();
        return ret;
    }
    /**
     * Starts to set up connection to the service.
     * Users can optionally call openConnection() to manually set up a connection in advance before starting recognition on the
     * Recognizer associated with this Connection. After starting recognition, calling Open() will have no effect
     *
     * Note: On return, the connection might not be ready yet. Please subscribe to the Connected event to
     * be notified when the connection is established.
     */
    openConnection(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.marshalPromiseToCallbacks)(this.privInternalData.connect(), cb, err);
    }
    /**
     * Closes the connection the service.
     * Users can optionally call closeConnection() to manually shutdown the connection of the associated Recognizer.
     *
     * If closeConnection() is called during recognition, recognition will fail and cancel with an error.
     */
    closeConnection(cb, err) {
        if (this.privInternalData instanceof _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.SynthesisAdapterBase) {
            throw new Error("Disconnecting a synthesizer's connection is currently not supported");
        }
        else {
            (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.marshalPromiseToCallbacks)(this.privInternalData.disconnect(), cb, err);
        }
    }
    /**
     * Appends a parameter in a message to service.
     * Added in version 1.12.1.
     * @param path The path of the network message.
     * @param propertyName Name of the property
     * @param propertyValue Value of the property. This is a json string.
     */
    setMessageProperty(path, propertyName, propertyValue) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(propertyName, "propertyName");
        if (this.privInternalData instanceof _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ServiceRecognizerBase) {
            if (path.toLowerCase() !== "speech.context") {
                throw new Error("Only speech.context message property sets are currently supported for recognizer");
            }
            else {
                this.privInternalData.speechContext.setSection(propertyName, propertyValue);
            }
        }
        else if (this.privInternalData instanceof _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.SynthesisAdapterBase) {
            if (path.toLowerCase() !== "synthesis.context") {
                throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");
            }
            else {
                this.privInternalData.synthesisContext.setSection(propertyName, propertyValue);
            }
        }
    }
    /**
     * Sends a message to the speech service.
     * Added in version 1.13.0.
     * @param path The WebSocket path of the message
     * @param payload The payload of the message. This is a json string or a ArrayBuffer.
     * @param success A callback to indicate success.
     * @param error A callback to indicate an error.
     */
    sendMessageAsync(path, payload, success, error) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_0__.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(path, payload), success, error);
    }
    /**
     * Dispose of associated resources.
     */
    close() {
        /* eslint-disable no-empty */
    }
    setupEvents() {
        this.privEventListener = this.privInternalData.connectionEvents.attach((connectionEvent) => {
            if (connectionEvent.name === "ConnectionEstablishedEvent") {
                if (!!this.connected) {
                    this.connected(new _Exports__WEBPACK_IMPORTED_MODULE_4__.ConnectionEventArgs(connectionEvent.connectionId));
                }
            }
            else if (connectionEvent.name === "ConnectionClosedEvent") {
                if (!!this.disconnected) {
                    this.disconnected(new _Exports__WEBPACK_IMPORTED_MODULE_4__.ConnectionEventArgs(connectionEvent.connectionId));
                }
            }
            else if (connectionEvent.name === "ConnectionMessageSentEvent") {
                if (!!this.messageSent) {
                    this.messageSent(new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConnectionMessageEventArgs(new _ConnectionMessage__WEBPACK_IMPORTED_MODULE_6__.ConnectionMessageImpl(connectionEvent.message)));
                }
            }
            else if (connectionEvent.name === "ConnectionMessageReceivedEvent") {
                if (!!this.messageReceived) {
                    this.messageReceived(new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConnectionMessageEventArgs(new _ConnectionMessage__WEBPACK_IMPORTED_MODULE_6__.ConnectionMessageImpl(connectionEvent.message)));
                }
            }
        });
        this.privServiceEventListener = this.privInternalData.serviceEvents.attach((e) => {
            if (!!this.receivedServiceMessage) {
                this.receivedServiceMessage(new _Exports__WEBPACK_IMPORTED_MODULE_7__.ServiceEventArgs(e.jsonString, e.name));
            }
        });
    }
}

//# sourceMappingURL=Connection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionEventArgs": () => (/* binding */ ConnectionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//

/**
 * Defines payload for connection events like Connected/Disconnected.
 * Added in version 1.2.0
 */
class ConnectionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
}

//# sourceMappingURL=ConnectionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionMessage": () => (/* binding */ ConnectionMessage),
/* harmony export */   "ConnectionMessageImpl": () => (/* binding */ ConnectionMessageImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common.speech/HeaderNames */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/HeaderNames.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/ConnectionMessage.js");
/* harmony import */ var _PropertyCollection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PropertyCollection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _PropertyId__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PropertyId */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//
// eslint-disable-next-line max-classes-per-file




/**
 * ConnectionMessage represents implementation specific messages sent to and received from
 * the speech service. These messages are provided for debugging purposes and should not
 * be used for production use cases with the Azure Cognitive Services Speech Service.
 * Messages sent to and received from the Speech Service are subject to change without
 * notice. This includes message contents, headers, payloads, ordering, etc.
 * Added in version 1.11.0.
 */
class ConnectionMessage {
}
class ConnectionMessageImpl {
    constructor(message) {
        this.privConnectionMessage = message;
        this.privProperties = new _PropertyCollection__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        if (!!this.privConnectionMessage.headers[_common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_1__.HeaderNames.ConnectionId]) {
            this.privProperties.setProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Speech_SessionId, this.privConnectionMessage.headers[_common_speech_HeaderNames__WEBPACK_IMPORTED_MODULE_1__.HeaderNames.ConnectionId]);
        }
        Object.keys(this.privConnectionMessage.headers).forEach((header) => {
            this.privProperties.setProperty(header, this.privConnectionMessage.headers[header]);
        });
    }
    /**
     * The message path.
     */
    get path() {
        return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((key) => key.toLowerCase() === "path".toLowerCase())];
    }
    /**
     * Checks to see if the ConnectionMessage is a text message.
     * See also IsBinaryMessage().
     */
    get isTextMessage() {
        return this.privConnectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Text;
    }
    /**
     * Checks to see if the ConnectionMessage is a binary message.
     * See also GetBinaryMessage().
     */
    get isBinaryMessage() {
        return this.privConnectionMessage.messageType === _common_Exports__WEBPACK_IMPORTED_MODULE_3__.MessageType.Binary;
    }
    /**
     * Gets the text message payload. Typically the text message content-type is
     * application/json. To determine other content-types use
     * Properties.GetProperty("Content-Type").
     */
    get TextMessage() {
        return this.privConnectionMessage.textBody;
    }
    /**
     * Gets the binary message payload.
     */
    get binaryMessage() {
        return this.privConnectionMessage.binaryBody;
    }
    /**
     * A collection of properties and their values defined for this <see cref="ConnectionMessage"/>.
     * Message headers can be accessed via this collection (e.g. "Content-Type").
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Returns a string that represents the connection message.
     */
    toString() {
        return "";
    }
}

//# sourceMappingURL=ConnectionMessage.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionMessageEventArgs": () => (/* binding */ ConnectionMessageEventArgs)
/* harmony export */ });
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//
class ConnectionMessageEventArgs {
    constructor(message) {
        this.privConnectionMessage = message;
    }
    /**
     * Gets the <see cref="ConnectionMessage"/> associated with this <see cref="ConnectionMessageEventArgs"/>.
     */
    get message() {
        return this.privConnectionMessage;
    }
    /**
     * Returns a string that represents the connection message event.
     */
    toString() {
        return "Message: " + this.privConnectionMessage.toString();
    }
}

//# sourceMappingURL=ConnectionMessageEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Contracts": () => (/* binding */ Contracts)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * @class Contracts
 * @private
 */
class Contracts {
    static throwIfNullOrUndefined(param, name) {
        if (param === undefined || param === null) {
            throw new Error("throwIfNullOrUndefined:" + name);
        }
    }
    static throwIfNull(param, name) {
        if (param === null) {
            throw new Error("throwIfNull:" + name);
        }
    }
    static throwIfNullOrWhitespace(param, name) {
        Contracts.throwIfNullOrUndefined(param, name);
        if (("" + param).trim().length < 1) {
            throw new Error("throwIfNullOrWhitespace:" + name);
        }
    }
    static throwIfNullOrTooLong(param, name, maxLength) {
        Contracts.throwIfNullOrUndefined(param, name);
        if (("" + param).length > maxLength) {
            throw new Error("throwIfNullOrTooLong:" + name + " (more than " + maxLength.toString() + " characters)");
        }
    }
    static throwIfNullOrTooShort(param, name, minLength) {
        Contracts.throwIfNullOrUndefined(param, name);
        if (("" + param).length < minLength) {
            throw new Error("throwIfNullOrTooShort:" + name + " (less than " + minLength.toString() + " characters)");
        }
    }
    static throwIfDisposed(isDisposed) {
        if (isDisposed) {
            throw new Error("the object is already disposed");
        }
    }
    static throwIfArrayEmptyOrWhitespace(array, name) {
        Contracts.throwIfNullOrUndefined(array, name);
        if (array.length === 0) {
            throw new Error("throwIfArrayEmptyOrWhitespace:" + name);
        }
        for (const item of array) {
            Contracts.throwIfNullOrWhitespace(item, name);
        }
    }
    static throwIfFileDoesNotExist(param, name) {
        Contracts.throwIfNullOrWhitespace(param, name);
        // TODO check for file existence.
    }
    static throwIfNotUndefined(param, name) {
        if (param !== undefined) {
            throw new Error("throwIfNotUndefined:" + name);
        }
    }
}

//# sourceMappingURL=Contracts.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js":
/*!**********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js ***!
  \**********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranscriptionCanceledEventArgs": () => (/* binding */ ConversationTranscriptionCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CancellationEventArgsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines content of a RecognitionErrorEvent.
 * @class ConversationTranscriptionCanceledEventArgs
 */
class ConversationTranscriptionCanceledEventArgs extends _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationEventArgsBase {
}

//# sourceMappingURL=ConversationTranscriptionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CustomCommandsConfig.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CustomCommandsConfig.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomCommandsConfig": () => (/* binding */ CustomCommandsConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DialogServiceConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.



/**
 * Class that defines configurations for the dialog service connector object for using a CustomCommands backend.
 * @class CustomCommandsConfig
 */
class CustomCommandsConfig extends _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl {
    /**
     * Creates an instance of CustomCommandsConfig.
     */
    constructor() {
        super();
    }
    /**
     * Creates an instance of the bot framework config with the specified subscription and region.
     * @member CustomCommandsConfig.fromSubscription
     * @function
     * @public
     * @param applicationId Speech Commands application id.
     * @param subscription Subscription key associated with the bot
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {CustomCommandsConfig} A new bot framework config.
     */
    static fromSubscription(applicationId, subscription, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(applicationId, "applicationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(subscription, "subscription");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const customCommandsConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.CustomCommands);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, applicationId);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscription);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return customCommandsConfig;
    }
    /**
     * Creates an instance of the bot framework config with the specified Speech Commands application id, authorization token and region.
     * Note: The caller needs to ensure that the authorization token is valid. Before the authorization token
     * expires, the caller needs to refresh it by calling this setter with a new valid token.
     * As configuration values are copied when creating a new recognizer, the new token value will not apply to recognizers that have already been created.
     * For recognizers that have been created before, you need to set authorization token of the corresponding recognizer
     * to refresh the token. Otherwise, the recognizers will encounter errors during recognition.
     * @member CustomCommandsConfig.fromAuthorizationToken
     * @function
     * @public
     * @param applicationId Speech Commands application id.
     * @param authorizationToken The authorization token associated with the application.
     * @param region The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {CustomCommandsConfig} A new speech commands config.
     */
    static fromAuthorizationToken(applicationId, authorizationToken, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(applicationId, "applicationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const customCommandsConfig = new _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfigImpl();
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_DialogType, _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_0__.DialogServiceConfig.DialogTypes.CustomCommands);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, applicationId);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, authorizationToken);
        customCommandsConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return customCommandsConfig;
    }
    /**
     * Sets the corresponding backend application identifier.
     * @member CustomCommandsConfig.prototype.Conversation_ApplicationId
     * @function
     * @public
     * @param {string} value - The application identifier to set.
     */
    set applicationId(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId, value);
    }
    /**
     * Gets the corresponding backend application identifier.
     * @member CustomCommandsConfig.prototype.Conversation_ApplicationId
     * @function
     * @public
     * @param {string} value - The application identifier to get.
     */
    get applicationId() {
        return this.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.Conversation_ApplicationId);
    }
}

//# sourceMappingURL=CustomCommandsConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Diagnostics.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Diagnostics.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Diagnostics": () => (/* binding */ Diagnostics)
/* harmony export */ });
/* harmony import */ var _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common.browser/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.browser/ConsoleLoggingListener.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Events.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//


/**
 * Defines diagnostics API for managing console output
 * Added in version 1.21.0
 */
class Diagnostics {
    static SetLoggingLevel(logLevel) {
        this.privListener = new _common_browser_Exports__WEBPACK_IMPORTED_MODULE_0__.ConsoleLoggingListener(logLevel);
        _common_Exports__WEBPACK_IMPORTED_MODULE_1__.Events.instance.attachConsoleListener(this.privListener);
    }
    static StartConsoleOutput() {
        if (!!this.privListener) {
            this.privListener.enableConsoleOutput = true;
        }
    }
    static StopConsoleOutput() {
        if (!!this.privListener) {
            this.privListener.enableConsoleOutput = false;
        }
    }
    static SetLogOutputPath(path) {
        if (typeof window === "undefined") {
            if (!!this.privListener) {
                this.privListener.logPath = path;
            }
        }
        else {
            throw new Error("File system logging not available in browser.");
        }
    }
}
Diagnostics.privListener = undefined;

//# sourceMappingURL=Diagnostics.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js":
/*!***********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceConfig": () => (/* binding */ DialogServiceConfig),
/* harmony export */   "DialogServiceConfigImpl": () => (/* binding */ DialogServiceConfigImpl)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


/**
 * Class that defines base configurations for dialog service connector
 * @class DialogServiceConfig
 */
class DialogServiceConfig {
    /**
     * Creates an instance of DialogService config.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Sets the corresponding backend application identifier.
     * @member DialogServiceConfig.prototype.Conversation_ApplicationId
     * @function
     * @public
     * @param {string} value - The application identifier to set.
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    set applicationId(value) { }
    static get DialogTypes() {
        return {
            BotFramework: "bot_framework",
            CustomCommands: "custom_commands"
        };
    }
}
/**
 * Dialog Service configuration.
 * @class DialogServiceConfigImpl
 */
class DialogServiceConfigImpl extends DialogServiceConfig {
    /**
     * Creates an instance of dialogService config.
     */
    constructor() {
        super();
        this.privSpeechConfig = new _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechConfigImpl();
    }
    /**
     * Provides access to custom properties.
     * @member DialogServiceConfigImpl.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The properties.
     */
    get properties() {
        return this.privSpeechConfig.properties;
    }
    /**
     * Gets the speech recognition language.
     * @member DialogServiceConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     */
    get speechRecognitionLanguage() {
        return this.privSpeechConfig.speechRecognitionLanguage;
    }
    /**
     * Sets the speech recognition language.
     * @member DialogServiceConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @param {string} value - The language to set.
     */
    set speechRecognitionLanguage(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechConfig.speechRecognitionLanguage = value;
    }
    get outputFormat() {
        return this.privSpeechConfig.outputFormat;
    }
    set outputFormat(value) {
        this.privSpeechConfig.outputFormat = value;
    }
    /**
     * Sets a named property as value
     * @member DialogServiceConfigImpl.prototype.setProperty
     * @function
     * @public
     * @param {PropertyId | string} name - The property to set.
     * @param {string} value - The value.
     */
    setProperty(name, value) {
        this.privSpeechConfig.setProperty(name, value);
    }
    /**
     * Sets a named property as value
     * @member DialogServiceConfigImpl.prototype.getProperty
     * @function
     * @public
     * @param {PropertyId | string} name - The property to get.
     * @param {string} def - The default value to return in case the property is not known.
     * @returns {string} The current value, or provided default, of the given property.
     */
    getProperty(name, def) {
        void def;
        return this.privSpeechConfig.getProperty(name);
    }
    /**
     * Sets the proxy configuration.
     * Only relevant in Node.js environments.
     * Added in version 1.4.0.
     * @param proxyHostName The host name of the proxy server, without the protocol scheme (http://)
     * @param proxyPort The port number of the proxy server.
     * @param proxyUserName The user name of the proxy server.
     * @param proxyPassword The password of the proxy server.
     */
    setProxy(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyHostName, proxyHostName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPort, `${proxyPort}`);
        if (proxyUserName) {
            this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyUserName, proxyUserName);
        }
        if (proxyPassword) {
            this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPassword, proxyPassword);
        }
    }
    setServiceProperty(name, value, channel) {
        void channel;
        this.privSpeechConfig.setServiceProperty(name, value);
    }
    /**
     * Dispose of associated resources.
     * @member DialogServiceConfigImpl.prototype.close
     * @function
     * @public
     */
    close() {
        return;
    }
}

//# sourceMappingURL=DialogServiceConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConnector.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConnector.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DialogServiceConnector": () => (/* binding */ DialogServiceConnector)
/* harmony export */ });
/* harmony import */ var _common_speech_DialogConnectorFactory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/DialogConnectorFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogConnectorFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/DialogServiceAdapter.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _PropertyId__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PropertyId */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






/**
 * Dialog Service Connector
 * @class DialogServiceConnector
 */
class DialogServiceConnector extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the DialogServiceConnector.
     * @constructor
     * @param {DialogServiceConfig} dialogConfig - Set of properties to configure this recognizer.
     * @param {AudioConfig} audioConfig - An optional audio config associated with the recognizer
     */
    constructor(dialogConfig, audioConfig) {
        const dialogServiceConfigImpl = dialogConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(dialogConfig, "dialogConfig");
        super(audioConfig, dialogServiceConfigImpl.properties, new _common_speech_DialogConnectorFactory__WEBPACK_IMPORTED_MODULE_2__.DialogConnectionFactory());
        this.isTurnComplete = true;
        this.privIsDisposed = false;
        this.privProperties = dialogServiceConfigImpl.properties.clone();
        const agentConfig = this.buildAgentConfig();
        this.privReco.agentConfig.set(agentConfig);
    }
    /**
     * Starts a connection to the service.
     * Users can optionally call connect() to manually set up a connection in advance, before starting interactions.
     *
     * Note: On return, the connection might not be ready yet. Please subscribe to the Connected event to
     * be notified when the connection is established.
     * @member DialogServiceConnector.prototype.connect
     * @function
     * @public
     */
    connect(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.privReco.connect(), cb, err);
    }
    /**
     * Closes the connection the service.
     * Users can optionally call disconnect() to manually shutdown the connection of the associated DialogServiceConnector.
     *
     * If disconnect() is called during a recognition, recognition will fail and cancel with an error.
     */
    disconnect(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.privReco.disconnect(), cb, err);
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member DialogServiceConnector.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Sets the authorization token used to communicate with the service.
     * @member DialogServiceConnector.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * The collection of properties and their values defined for this DialogServiceConnector.
     * @member DialogServiceConnector.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this DialogServiceConnector.
     */
    get properties() {
        return this.privProperties;
    }
    /** Gets the template for the activity generated by service from speech.
     * Properties from the template will be stamped on the generated activity.
     * It can be empty
     */
    get speechActivityTemplate() {
        return this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Speech_Activity_Template);
    }
    /** Sets the template for the activity generated by service from speech.
     * Properties from the template will be stamped on the generated activity.
     * It can be null or empty.
     * Note: it has to be a valid Json object.
     */
    set speechActivityTemplate(speechActivityTemplate) {
        this.properties.setProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Speech_Activity_Template, speechActivityTemplate);
    }
    /**
     * Starts recognition and stops after the first utterance is recognized.
     * @member DialogServiceConnector.prototype.listenOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the result when the reco has completed.
     * @param err - Callback invoked in case of an error.
     */
    listenOnceAsync(cb, err) {
        if (this.isTurnComplete) {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
            const callbackHolder = () => __awaiter(this, void 0, void 0, function* () {
                yield this.privReco.connect();
                yield this.implRecognizerStop();
                this.isTurnComplete = false;
                const ret = new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Deferred();
                yield this.privReco.recognize(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation, ret.resolve, ret.reject);
                const e = yield ret.promise;
                yield this.implRecognizerStop();
                return e;
            });
            const retPromise = callbackHolder();
            retPromise.catch(() => {
                // Destroy the recognizer.
                // We've done all we can here.
                // eslint-disable-next-line @typescript-eslint/no-empty-function
                this.dispose(true).catch(() => { });
            });
            (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(retPromise.finally(() => {
                this.isTurnComplete = true;
            }), cb, err);
        }
    }
    sendActivityAsync(activity, cb, errCb) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.privReco.sendMessage(activity), cb, errCb);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member DialogServiceConnector.prototype.close
     * @function
     * @public
     */
    close(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privIsDisposed);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.dispose(true), cb, err);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privIsDisposed) {
                return;
            }
            if (disposing) {
                this.privIsDisposed = true;
                yield this.implRecognizerStop();
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioSource = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.DialogServiceAdapter(authentication, connectionFactory, audioSource, recognizerConfig, this);
    }
    buildAgentConfig() {
        const communicationType = this.properties.getProperty("Conversation_Communication_Type", "Default");
        return {
            botInfo: {
                commType: communicationType,
                commandsCulture: undefined,
                connectionId: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Agent_Connection_Id),
                conversationId: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_Conversation_Id, undefined),
                fromId: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.Conversation_From_Id, undefined),
                ttsAudioFormat: this.properties.getProperty(_PropertyId__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)
            },
            version: 0.2
        };
    }
}

//# sourceMappingURL=DialogServiceConnector.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Exports.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Exports.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ActivityReceivedEventArgs": () => (/* reexport safe */ _ActivityReceivedEventArgs__WEBPACK_IMPORTED_MODULE_48__.ActivityReceivedEventArgs),
/* harmony export */   "AudioConfig": () => (/* reexport safe */ _Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_0__.AudioConfig),
/* harmony export */   "AudioFormatTag": () => (/* reexport safe */ _Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_1__.AudioFormatTag),
/* harmony export */   "AudioInputStream": () => (/* reexport safe */ _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__.AudioInputStream),
/* harmony export */   "AudioOutputStream": () => (/* reexport safe */ _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.AudioOutputStream),
/* harmony export */   "AudioStreamFormat": () => (/* reexport safe */ _Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_1__.AudioStreamFormat),
/* harmony export */   "AutoDetectSourceLanguageConfig": () => (/* reexport safe */ _AutoDetectSourceLanguageConfig__WEBPACK_IMPORTED_MODULE_63__.AutoDetectSourceLanguageConfig),
/* harmony export */   "AutoDetectSourceLanguageResult": () => (/* reexport safe */ _AutoDetectSourceLanguageResult__WEBPACK_IMPORTED_MODULE_64__.AutoDetectSourceLanguageResult),
/* harmony export */   "BaseAudioPlayer": () => (/* reexport safe */ _Audio_BaseAudioPlayer__WEBPACK_IMPORTED_MODULE_52__.BaseAudioPlayer),
/* harmony export */   "BotFrameworkConfig": () => (/* reexport safe */ _BotFrameworkConfig__WEBPACK_IMPORTED_MODULE_45__.BotFrameworkConfig),
/* harmony export */   "CancellationDetails": () => (/* reexport safe */ _CancellationDetails__WEBPACK_IMPORTED_MODULE_38__.CancellationDetails),
/* harmony export */   "CancellationDetailsBase": () => (/* reexport safe */ _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_37__.CancellationDetailsBase),
/* harmony export */   "CancellationErrorCode": () => (/* reexport safe */ _CancellationErrorCodes__WEBPACK_IMPORTED_MODULE_39__.CancellationErrorCode),
/* harmony export */   "CancellationReason": () => (/* reexport safe */ _CancellationReason__WEBPACK_IMPORTED_MODULE_4__.CancellationReason),
/* harmony export */   "Connection": () => (/* reexport safe */ _Connection__WEBPACK_IMPORTED_MODULE_42__.Connection),
/* harmony export */   "ConnectionEventArgs": () => (/* reexport safe */ _ConnectionEventArgs__WEBPACK_IMPORTED_MODULE_40__.ConnectionEventArgs),
/* harmony export */   "ConnectionMessage": () => (/* reexport safe */ _ConnectionMessage__WEBPACK_IMPORTED_MODULE_54__.ConnectionMessage),
/* harmony export */   "ConnectionMessageEventArgs": () => (/* reexport safe */ _ConnectionMessageEventArgs__WEBPACK_IMPORTED_MODULE_53__.ConnectionMessageEventArgs),
/* harmony export */   "Conversation": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_67__.Conversation),
/* harmony export */   "ConversationExpirationEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_68__.ConversationExpirationEventArgs),
/* harmony export */   "ConversationParticipantsChangedEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_69__.ConversationParticipantsChangedEventArgs),
/* harmony export */   "ConversationTranscriber": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_74__.ConversationTranscriber),
/* harmony export */   "ConversationTranscriptionCanceledEventArgs": () => (/* reexport safe */ _ConversationTranscriptionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_89__.ConversationTranscriptionCanceledEventArgs),
/* harmony export */   "ConversationTranscriptionEventArgs": () => (/* reexport safe */ _SpeechRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_16__.ConversationTranscriptionEventArgs),
/* harmony export */   "ConversationTranslationCanceledEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_70__.ConversationTranslationCanceledEventArgs),
/* harmony export */   "ConversationTranslationEventArgs": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_71__.ConversationTranslationEventArgs),
/* harmony export */   "ConversationTranslationResult": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_72__.ConversationTranslationResult),
/* harmony export */   "ConversationTranslator": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_73__.ConversationTranslator),
/* harmony export */   "CustomCommandsConfig": () => (/* reexport safe */ _CustomCommandsConfig__WEBPACK_IMPORTED_MODULE_46__.CustomCommandsConfig),
/* harmony export */   "Diagnostics": () => (/* reexport safe */ _Diagnostics__WEBPACK_IMPORTED_MODULE_95__.Diagnostics),
/* harmony export */   "DialogServiceConfig": () => (/* reexport safe */ _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_44__.DialogServiceConfig),
/* harmony export */   "DialogServiceConnector": () => (/* reexport safe */ _DialogServiceConnector__WEBPACK_IMPORTED_MODULE_47__.DialogServiceConnector),
/* harmony export */   "IntentRecognitionCanceledEventArgs": () => (/* reexport safe */ _IntentRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_36__.IntentRecognitionCanceledEventArgs),
/* harmony export */   "IntentRecognitionEventArgs": () => (/* reexport safe */ _IntentRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_11__.IntentRecognitionEventArgs),
/* harmony export */   "IntentRecognitionResult": () => (/* reexport safe */ _IntentRecognitionResult__WEBPACK_IMPORTED_MODULE_14__.IntentRecognitionResult),
/* harmony export */   "IntentRecognizer": () => (/* reexport safe */ _IntentRecognizer__WEBPACK_IMPORTED_MODULE_29__.IntentRecognizer),
/* harmony export */   "KeywordRecognitionModel": () => (/* reexport safe */ _KeywordRecognitionModel__WEBPACK_IMPORTED_MODULE_7__.KeywordRecognitionModel),
/* harmony export */   "LanguageIdMode": () => (/* reexport safe */ _LanguageIdMode__WEBPACK_IMPORTED_MODULE_94__.LanguageIdMode),
/* harmony export */   "LanguageUnderstandingModel": () => (/* reexport safe */ _LanguageUnderstandingModel__WEBPACK_IMPORTED_MODULE_15__.LanguageUnderstandingModel),
/* harmony export */   "LogLevel": () => (/* reexport safe */ _LogLevel__WEBPACK_IMPORTED_MODULE_96__.EventType),
/* harmony export */   "NoMatchDetails": () => (/* reexport safe */ _NoMatchDetails__WEBPACK_IMPORTED_MODULE_34__.NoMatchDetails),
/* harmony export */   "NoMatchReason": () => (/* reexport safe */ _NoMatchReason__WEBPACK_IMPORTED_MODULE_33__.NoMatchReason),
/* harmony export */   "OutputFormat": () => (/* reexport safe */ _OutputFormat__WEBPACK_IMPORTED_MODULE_10__.OutputFormat),
/* harmony export */   "Participant": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_75__.Participant),
/* harmony export */   "ParticipantChangedReason": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_76__.ParticipantChangedReason),
/* harmony export */   "PhraseListGrammar": () => (/* reexport safe */ _PhraseListGrammar__WEBPACK_IMPORTED_MODULE_43__.PhraseListGrammar),
/* harmony export */   "ProfanityOption": () => (/* reexport safe */ _ProfanityOption__WEBPACK_IMPORTED_MODULE_51__.ProfanityOption),
/* harmony export */   "PronunciationAssessmentConfig": () => (/* reexport safe */ _PronunciationAssessmentConfig__WEBPACK_IMPORTED_MODULE_92__.PronunciationAssessmentConfig),
/* harmony export */   "PronunciationAssessmentGradingSystem": () => (/* reexport safe */ _PronunciationAssessmentGradingSystem__WEBPACK_IMPORTED_MODULE_90__.PronunciationAssessmentGradingSystem),
/* harmony export */   "PronunciationAssessmentGranularity": () => (/* reexport safe */ _PronunciationAssessmentGranularity__WEBPACK_IMPORTED_MODULE_91__.PronunciationAssessmentGranularity),
/* harmony export */   "PronunciationAssessmentResult": () => (/* reexport safe */ _PronunciationAssessmentResult__WEBPACK_IMPORTED_MODULE_93__.PronunciationAssessmentResult),
/* harmony export */   "PropertyCollection": () => (/* reexport safe */ _PropertyCollection__WEBPACK_IMPORTED_MODULE_25__.PropertyCollection),
/* harmony export */   "PropertyId": () => (/* reexport safe */ _PropertyId__WEBPACK_IMPORTED_MODULE_26__.PropertyId),
/* harmony export */   "PullAudioInputStream": () => (/* reexport safe */ _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__.PullAudioInputStream),
/* harmony export */   "PullAudioInputStreamCallback": () => (/* reexport safe */ _Audio_PullAudioInputStreamCallback__WEBPACK_IMPORTED_MODULE_5__.PullAudioInputStreamCallback),
/* harmony export */   "PullAudioOutputStream": () => (/* reexport safe */ _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.PullAudioOutputStream),
/* harmony export */   "PushAudioInputStream": () => (/* reexport safe */ _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__.PushAudioInputStream),
/* harmony export */   "PushAudioOutputStream": () => (/* reexport safe */ _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__.PushAudioOutputStream),
/* harmony export */   "PushAudioOutputStreamCallback": () => (/* reexport safe */ _Audio_PushAudioOutputStreamCallback__WEBPACK_IMPORTED_MODULE_6__.PushAudioOutputStreamCallback),
/* harmony export */   "RecognitionEventArgs": () => (/* reexport safe */ _RecognitionEventArgs__WEBPACK_IMPORTED_MODULE_9__.RecognitionEventArgs),
/* harmony export */   "RecognitionResult": () => (/* reexport safe */ _RecognitionResult__WEBPACK_IMPORTED_MODULE_12__.RecognitionResult),
/* harmony export */   "Recognizer": () => (/* reexport safe */ _Recognizer__WEBPACK_IMPORTED_MODULE_27__.Recognizer),
/* harmony export */   "ResultReason": () => (/* reexport safe */ _ResultReason__WEBPACK_IMPORTED_MODULE_22__.ResultReason),
/* harmony export */   "ServiceEventArgs": () => (/* reexport safe */ _ServiceEventArgs__WEBPACK_IMPORTED_MODULE_41__.ServiceEventArgs),
/* harmony export */   "ServicePropertyChannel": () => (/* reexport safe */ _ServicePropertyChannel__WEBPACK_IMPORTED_MODULE_50__.ServicePropertyChannel),
/* harmony export */   "SessionEventArgs": () => (/* reexport safe */ _SessionEventArgs__WEBPACK_IMPORTED_MODULE_8__.SessionEventArgs),
/* harmony export */   "SourceLanguageConfig": () => (/* reexport safe */ _SourceLanguageConfig__WEBPACK_IMPORTED_MODULE_65__.SourceLanguageConfig),
/* harmony export */   "SpeakerAudioDestination": () => (/* reexport safe */ _Audio_SpeakerAudioDestination__WEBPACK_IMPORTED_MODULE_88__.SpeakerAudioDestination),
/* harmony export */   "SpeakerIdentificationModel": () => (/* reexport safe */ _SpeakerIdentificationModel__WEBPACK_IMPORTED_MODULE_61__.SpeakerIdentificationModel),
/* harmony export */   "SpeakerRecognitionCancellationDetails": () => (/* reexport safe */ _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__.SpeakerRecognitionCancellationDetails),
/* harmony export */   "SpeakerRecognitionResult": () => (/* reexport safe */ _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__.SpeakerRecognitionResult),
/* harmony export */   "SpeakerRecognitionResultType": () => (/* reexport safe */ _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__.SpeakerRecognitionResultType),
/* harmony export */   "SpeakerRecognizer": () => (/* reexport safe */ _SpeakerRecognizer__WEBPACK_IMPORTED_MODULE_60__.SpeakerRecognizer),
/* harmony export */   "SpeakerVerificationModel": () => (/* reexport safe */ _SpeakerVerificationModel__WEBPACK_IMPORTED_MODULE_62__.SpeakerVerificationModel),
/* harmony export */   "SpeechConfig": () => (/* reexport safe */ _SpeechConfig__WEBPACK_IMPORTED_MODULE_23__.SpeechConfig),
/* harmony export */   "SpeechConfigImpl": () => (/* reexport safe */ _SpeechConfig__WEBPACK_IMPORTED_MODULE_23__.SpeechConfigImpl),
/* harmony export */   "SpeechRecognitionCanceledEventArgs": () => (/* reexport safe */ _SpeechRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_17__.SpeechRecognitionCanceledEventArgs),
/* harmony export */   "SpeechRecognitionEventArgs": () => (/* reexport safe */ _SpeechRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_16__.SpeechRecognitionEventArgs),
/* harmony export */   "SpeechRecognitionResult": () => (/* reexport safe */ _SpeechRecognitionResult__WEBPACK_IMPORTED_MODULE_13__.SpeechRecognitionResult),
/* harmony export */   "SpeechRecognizer": () => (/* reexport safe */ _SpeechRecognizer__WEBPACK_IMPORTED_MODULE_28__.SpeechRecognizer),
/* harmony export */   "SpeechSynthesisBookmarkEventArgs": () => (/* reexport safe */ _SpeechSynthesisBookmarkEventArgs__WEBPACK_IMPORTED_MODULE_83__.SpeechSynthesisBookmarkEventArgs),
/* harmony export */   "SpeechSynthesisBoundaryType": () => (/* reexport safe */ _SpeechSynthesisBoundaryType__WEBPACK_IMPORTED_MODULE_85__.SpeechSynthesisBoundaryType),
/* harmony export */   "SpeechSynthesisEventArgs": () => (/* reexport safe */ _SpeechSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_81__.SpeechSynthesisEventArgs),
/* harmony export */   "SpeechSynthesisOutputFormat": () => (/* reexport safe */ _SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_77__.SpeechSynthesisOutputFormat),
/* harmony export */   "SpeechSynthesisResult": () => (/* reexport safe */ _SpeechSynthesisResult__WEBPACK_IMPORTED_MODULE_80__.SpeechSynthesisResult),
/* harmony export */   "SpeechSynthesisVisemeEventArgs": () => (/* reexport safe */ _SpeechSynthesisVisemeEventArgs__WEBPACK_IMPORTED_MODULE_84__.SpeechSynthesisVisemeEventArgs),
/* harmony export */   "SpeechSynthesisWordBoundaryEventArgs": () => (/* reexport safe */ _SpeechSynthesisWordBoundaryEventArgs__WEBPACK_IMPORTED_MODULE_82__.SpeechSynthesisWordBoundaryEventArgs),
/* harmony export */   "SpeechSynthesizer": () => (/* reexport safe */ _SpeechSynthesizer__WEBPACK_IMPORTED_MODULE_78__.SpeechSynthesizer),
/* harmony export */   "SpeechTranslationConfig": () => (/* reexport safe */ _SpeechTranslationConfig__WEBPACK_IMPORTED_MODULE_24__.SpeechTranslationConfig),
/* harmony export */   "SpeechTranslationConfigImpl": () => (/* reexport safe */ _SpeechTranslationConfig__WEBPACK_IMPORTED_MODULE_24__.SpeechTranslationConfigImpl),
/* harmony export */   "SynthesisResult": () => (/* reexport safe */ _SynthesisResult__WEBPACK_IMPORTED_MODULE_79__.SynthesisResult),
/* harmony export */   "SynthesisVoicesResult": () => (/* reexport safe */ _SynthesisVoicesResult__WEBPACK_IMPORTED_MODULE_86__.SynthesisVoicesResult),
/* harmony export */   "TranslationRecognitionCanceledEventArgs": () => (/* reexport safe */ _TranslationRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_35__.TranslationRecognitionCanceledEventArgs),
/* harmony export */   "TranslationRecognitionEventArgs": () => (/* reexport safe */ _TranslationRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_18__.TranslationRecognitionEventArgs),
/* harmony export */   "TranslationRecognitionResult": () => (/* reexport safe */ _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_20__.TranslationRecognitionResult),
/* harmony export */   "TranslationRecognizer": () => (/* reexport safe */ _TranslationRecognizer__WEBPACK_IMPORTED_MODULE_31__.TranslationRecognizer),
/* harmony export */   "TranslationSynthesisEventArgs": () => (/* reexport safe */ _TranslationSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_19__.TranslationSynthesisEventArgs),
/* harmony export */   "TranslationSynthesisResult": () => (/* reexport safe */ _TranslationSynthesisResult__WEBPACK_IMPORTED_MODULE_21__.TranslationSynthesisResult),
/* harmony export */   "Translations": () => (/* reexport safe */ _Translations__WEBPACK_IMPORTED_MODULE_32__.Translations),
/* harmony export */   "TurnStatusReceivedEventArgs": () => (/* reexport safe */ _TurnStatusReceivedEventArgs__WEBPACK_IMPORTED_MODULE_49__.TurnStatusReceivedEventArgs),
/* harmony export */   "User": () => (/* reexport safe */ _Transcription_Exports__WEBPACK_IMPORTED_MODULE_75__.User),
/* harmony export */   "VoiceInfo": () => (/* reexport safe */ _VoiceInfo__WEBPACK_IMPORTED_MODULE_87__.VoiceInfo),
/* harmony export */   "VoiceProfile": () => (/* reexport safe */ _VoiceProfile__WEBPACK_IMPORTED_MODULE_55__.VoiceProfile),
/* harmony export */   "VoiceProfileCancellationDetails": () => (/* reexport safe */ _VoiceProfileResult__WEBPACK_IMPORTED_MODULE_57__.VoiceProfileCancellationDetails),
/* harmony export */   "VoiceProfileClient": () => (/* reexport safe */ _VoiceProfileClient__WEBPACK_IMPORTED_MODULE_59__.VoiceProfileClient),
/* harmony export */   "VoiceProfileEnrollmentCancellationDetails": () => (/* reexport safe */ _VoiceProfileEnrollmentResult__WEBPACK_IMPORTED_MODULE_56__.VoiceProfileEnrollmentCancellationDetails),
/* harmony export */   "VoiceProfileEnrollmentResult": () => (/* reexport safe */ _VoiceProfileEnrollmentResult__WEBPACK_IMPORTED_MODULE_56__.VoiceProfileEnrollmentResult),
/* harmony export */   "VoiceProfilePhraseResult": () => (/* reexport safe */ _VoiceProfilePhraseResult__WEBPACK_IMPORTED_MODULE_58__.VoiceProfilePhraseResult),
/* harmony export */   "VoiceProfileResult": () => (/* reexport safe */ _VoiceProfileResult__WEBPACK_IMPORTED_MODULE_57__.VoiceProfileResult),
/* harmony export */   "VoiceProfileType": () => (/* reexport safe */ _VoiceProfileType__WEBPACK_IMPORTED_MODULE_30__.VoiceProfileType)
/* harmony export */ });
/* harmony import */ var _Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Audio/AudioConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Audio_AudioStreamFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Audio/AudioStreamFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioStreamFormat.js");
/* harmony import */ var _Audio_AudioInputStream__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Audio/AudioInputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js");
/* harmony import */ var _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Audio/AudioOutputStream */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _CancellationReason__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CancellationReason */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _Audio_PullAudioInputStreamCallback__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Audio/PullAudioInputStreamCallback */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PullAudioInputStreamCallback.js");
/* harmony import */ var _Audio_PushAudioOutputStreamCallback__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Audio/PushAudioOutputStreamCallback */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js");
/* harmony import */ var _KeywordRecognitionModel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./KeywordRecognitionModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/KeywordRecognitionModel.js");
/* harmony import */ var _SessionEventArgs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./SessionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
/* harmony import */ var _RecognitionEventArgs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./RecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
/* harmony import */ var _OutputFormat__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./OutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _IntentRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./IntentRecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js");
/* harmony import */ var _RecognitionResult__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./RecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js");
/* harmony import */ var _SpeechRecognitionResult__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./SpeechRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
/* harmony import */ var _IntentRecognitionResult__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./IntentRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js");
/* harmony import */ var _LanguageUnderstandingModel__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./LanguageUnderstandingModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageUnderstandingModel.js");
/* harmony import */ var _SpeechRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./SpeechRecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js");
/* harmony import */ var _SpeechRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./SpeechRecognitionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js");
/* harmony import */ var _TranslationRecognitionEventArgs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./TranslationRecognitionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js");
/* harmony import */ var _TranslationSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./TranslationSynthesisEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js");
/* harmony import */ var _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./TranslationRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js");
/* harmony import */ var _TranslationSynthesisResult__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./TranslationSynthesisResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js");
/* harmony import */ var _ResultReason__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./ResultReason */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _SpeechConfig__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./SpeechConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js");
/* harmony import */ var _SpeechTranslationConfig__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./SpeechTranslationConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js");
/* harmony import */ var _PropertyCollection__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./PropertyCollection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _PropertyId__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./PropertyId */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Recognizer__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./Recognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _SpeechRecognizer__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./SpeechRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognizer.js");
/* harmony import */ var _IntentRecognizer__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./IntentRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognizer.js");
/* harmony import */ var _VoiceProfileType__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./VoiceProfileType */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
/* harmony import */ var _TranslationRecognizer__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./TranslationRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js");
/* harmony import */ var _Translations__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./Translations */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js");
/* harmony import */ var _NoMatchReason__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./NoMatchReason */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js");
/* harmony import */ var _NoMatchDetails__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./NoMatchDetails */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchDetails.js");
/* harmony import */ var _TranslationRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./TranslationRecognitionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js");
/* harmony import */ var _IntentRecognitionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./IntentRecognitionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js");
/* harmony import */ var _CancellationDetailsBase__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./CancellationDetailsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _CancellationDetails__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./CancellationDetails */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetails.js");
/* harmony import */ var _CancellationErrorCodes__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./CancellationErrorCodes */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _ConnectionEventArgs__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./ConnectionEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionEventArgs.js");
/* harmony import */ var _ServiceEventArgs__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./ServiceEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js");
/* harmony import */ var _Connection__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./Connection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
/* harmony import */ var _PhraseListGrammar__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./PhraseListGrammar */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PhraseListGrammar.js");
/* harmony import */ var _DialogServiceConfig__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./DialogServiceConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConfig.js");
/* harmony import */ var _BotFrameworkConfig__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./BotFrameworkConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/BotFrameworkConfig.js");
/* harmony import */ var _CustomCommandsConfig__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./CustomCommandsConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CustomCommandsConfig.js");
/* harmony import */ var _DialogServiceConnector__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./DialogServiceConnector */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/DialogServiceConnector.js");
/* harmony import */ var _ActivityReceivedEventArgs__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./ActivityReceivedEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ActivityReceivedEventArgs.js");
/* harmony import */ var _TurnStatusReceivedEventArgs__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./TurnStatusReceivedEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js");
/* harmony import */ var _ServicePropertyChannel__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./ServicePropertyChannel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js");
/* harmony import */ var _ProfanityOption__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ./ProfanityOption */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Audio_BaseAudioPlayer__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ./Audio/BaseAudioPlayer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/BaseAudioPlayer.js");
/* harmony import */ var _ConnectionMessageEventArgs__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ./ConnectionMessageEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessageEventArgs.js");
/* harmony import */ var _ConnectionMessage__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ./ConnectionMessage */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConnectionMessage.js");
/* harmony import */ var _VoiceProfile__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ./VoiceProfile */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js");
/* harmony import */ var _VoiceProfileEnrollmentResult__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ./VoiceProfileEnrollmentResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js");
/* harmony import */ var _VoiceProfileResult__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ./VoiceProfileResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
/* harmony import */ var _VoiceProfilePhraseResult__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! ./VoiceProfilePhraseResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js");
/* harmony import */ var _VoiceProfileClient__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! ./VoiceProfileClient */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileClient.js");
/* harmony import */ var _SpeakerRecognizer__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! ./SpeakerRecognizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognizer.js");
/* harmony import */ var _SpeakerIdentificationModel__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! ./SpeakerIdentificationModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerIdentificationModel.js");
/* harmony import */ var _SpeakerVerificationModel__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! ./SpeakerVerificationModel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerVerificationModel.js");
/* harmony import */ var _AutoDetectSourceLanguageConfig__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! ./AutoDetectSourceLanguageConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageConfig.js");
/* harmony import */ var _AutoDetectSourceLanguageResult__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! ./AutoDetectSourceLanguageResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/AutoDetectSourceLanguageResult.js");
/* harmony import */ var _SourceLanguageConfig__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! ./SourceLanguageConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SourceLanguageConfig.js");
/* harmony import */ var _SpeakerRecognitionResult__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! ./SpeakerRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_70__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_71__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_72__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_73__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslator.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_74__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranscriber.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_75__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js");
/* harmony import */ var _Transcription_Exports__WEBPACK_IMPORTED_MODULE_76__ = __webpack_require__(/*! ./Transcription/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js");
/* harmony import */ var _SpeechSynthesisOutputFormat__WEBPACK_IMPORTED_MODULE_77__ = __webpack_require__(/*! ./SpeechSynthesisOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
/* harmony import */ var _SpeechSynthesizer__WEBPACK_IMPORTED_MODULE_78__ = __webpack_require__(/*! ./SpeechSynthesizer */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesizer.js");
/* harmony import */ var _SynthesisResult__WEBPACK_IMPORTED_MODULE_79__ = __webpack_require__(/*! ./SynthesisResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js");
/* harmony import */ var _SpeechSynthesisResult__WEBPACK_IMPORTED_MODULE_80__ = __webpack_require__(/*! ./SpeechSynthesisResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js");
/* harmony import */ var _SpeechSynthesisEventArgs__WEBPACK_IMPORTED_MODULE_81__ = __webpack_require__(/*! ./SpeechSynthesisEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js");
/* harmony import */ var _SpeechSynthesisWordBoundaryEventArgs__WEBPACK_IMPORTED_MODULE_82__ = __webpack_require__(/*! ./SpeechSynthesisWordBoundaryEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js");
/* harmony import */ var _SpeechSynthesisBookmarkEventArgs__WEBPACK_IMPORTED_MODULE_83__ = __webpack_require__(/*! ./SpeechSynthesisBookmarkEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js");
/* harmony import */ var _SpeechSynthesisVisemeEventArgs__WEBPACK_IMPORTED_MODULE_84__ = __webpack_require__(/*! ./SpeechSynthesisVisemeEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js");
/* harmony import */ var _SpeechSynthesisBoundaryType__WEBPACK_IMPORTED_MODULE_85__ = __webpack_require__(/*! ./SpeechSynthesisBoundaryType */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBoundaryType.js");
/* harmony import */ var _SynthesisVoicesResult__WEBPACK_IMPORTED_MODULE_86__ = __webpack_require__(/*! ./SynthesisVoicesResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js");
/* harmony import */ var _VoiceInfo__WEBPACK_IMPORTED_MODULE_87__ = __webpack_require__(/*! ./VoiceInfo */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js");
/* harmony import */ var _Audio_SpeakerAudioDestination__WEBPACK_IMPORTED_MODULE_88__ = __webpack_require__(/*! ./Audio/SpeakerAudioDestination */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/SpeakerAudioDestination.js");
/* harmony import */ var _ConversationTranscriptionCanceledEventArgs__WEBPACK_IMPORTED_MODULE_89__ = __webpack_require__(/*! ./ConversationTranscriptionCanceledEventArgs */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ConversationTranscriptionCanceledEventArgs.js");
/* harmony import */ var _PronunciationAssessmentGradingSystem__WEBPACK_IMPORTED_MODULE_90__ = __webpack_require__(/*! ./PronunciationAssessmentGradingSystem */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js");
/* harmony import */ var _PronunciationAssessmentGranularity__WEBPACK_IMPORTED_MODULE_91__ = __webpack_require__(/*! ./PronunciationAssessmentGranularity */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js");
/* harmony import */ var _PronunciationAssessmentConfig__WEBPACK_IMPORTED_MODULE_92__ = __webpack_require__(/*! ./PronunciationAssessmentConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentConfig.js");
/* harmony import */ var _PronunciationAssessmentResult__WEBPACK_IMPORTED_MODULE_93__ = __webpack_require__(/*! ./PronunciationAssessmentResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentResult.js");
/* harmony import */ var _LanguageIdMode__WEBPACK_IMPORTED_MODULE_94__ = __webpack_require__(/*! ./LanguageIdMode */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js");
/* harmony import */ var _Diagnostics__WEBPACK_IMPORTED_MODULE_95__ = __webpack_require__(/*! ./Diagnostics */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Diagnostics.js");
/* harmony import */ var _LogLevel__WEBPACK_IMPORTED_MODULE_96__ = __webpack_require__(/*! ./LogLevel */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/PlatformEvent.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

























































































//# sourceMappingURL=Exports.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionCanceledEventArgs.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognitionCanceledEventArgs": () => (/* binding */ IntentRecognitionCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Define payload of intent recognition canceled result events.
 * @class IntentRecognitionCanceledEventArgs
 */
class IntentRecognitionCanceledEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.IntentRecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {CancellationReason} result - The result of the intent recognition.
     * @param {string} offset - The offset.
     * @param {IntentRecognitionResult} sessionId - The session id.
     */
    constructor(reason, errorDetails, errorCode, result, offset, sessionId) {
        super(result, offset, sessionId);
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privErrorCode = errorCode;
    }
    /**
     * The reason the recognition was canceled.
     * @member IntentRecognitionCanceledEventArgs.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * The error code in case of an unsuccessful recognition.
     * Added in version 1.1.0.
     * @return An error code that represents the error reason.
     */
    get errorCode() {
        return this.privErrorCode;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member IntentRecognitionCanceledEventArgs.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
}

//# sourceMappingURL=IntentRecognitionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionEventArgs.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognitionEventArgs": () => (/* binding */ IntentRecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Intent recognition result event arguments.
 * @class
 */
class IntentRecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param result - The result of the intent recognition.
     * @param offset - The offset.
     * @param sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Represents the intent recognition result.
     * @member IntentRecognitionEventArgs.prototype.result
     * @function
     * @public
     * @returns {IntentRecognitionResult} Represents the intent recognition result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=IntentRecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognitionResult.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognitionResult": () => (/* binding */ IntentRecognitionResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Intent recognition result.
 * @class
 */
class IntentRecognitionResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechRecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param intentId - The intent id.
     * @param resultId - The result id.
     * @param reason - The reason.
     * @param text - The recognized text.
     * @param duration - The duration.
     * @param offset - The offset into the stream.
     * @param language - Primary Language detected, if provided.
     * @param languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param errorDetails - Error details, if provided.
     * @param json - Additional Json, if provided.
     * @param properties - Additional properties, if provided.
     */
    constructor(intentId, resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties) {
        super(resultId, reason, text, duration, offset, language, languageDetectionConfidence, undefined, errorDetails, json, properties);
        this.privIntentId = intentId;
    }
    /**
     * A String that represents the intent identifier being recognized.
     * @member IntentRecognitionResult.prototype.intentId
     * @function
     * @public
     * @returns {string} A String that represents the intent identifier being recognized.
     */
    get intentId() {
        return this.privIntentId;
    }
}

//# sourceMappingURL=IntentRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognizer.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/IntentRecognizer.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IntentRecognizer": () => (/* binding */ IntentRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/AddedLmIntent.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/IntentServiceRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Intent recognizer.
 * @class
 */
class IntentRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the IntentRecognizer.
     * @constructor
     * @param {SpeechConfig} speechConfig - The set of configuration properties.
     * @param {AudioConfig} audioConfig - An optional audio input config associated with the recognizer
     */
    constructor(speechConfig, audioConfig) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(speechConfig, "speechConfig");
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(configImpl, "speechConfig");
        super(audioConfig, configImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.IntentConnectionFactory());
        this.privAddedIntents = [];
        this.privAddedLmIntents = {};
        this.privDisposedIntentRecognizer = false;
        this.privProperties = configImpl.properties;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage]);
    }
    /**
     * Gets the spoken language of recognition.
     * @member IntentRecognizer.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} the spoken language of recognition.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member IntentRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * Note: Please use a token derived from your LanguageUnderstanding subscription key for the Intent recognizer.
     * @member IntentRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} value - Authorization token.
     */
    set authorizationToken(value) {
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    /**
     * The collection of properties and their values defined for this IntentRecognizer.
     * @member IntentRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their
     * values defined for this IntentRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Starts intent recognition, and stops after the first utterance is recognized.
     * The task returns the recognition text and intent as result.
     * Note: RecognizeOnceAsync() returns when the first utterance has been recognized,
     * so it is suitable only for single shot recognition like command or query.
     * For long-running recognition, use StartContinuousRecognitionAsync() instead.
     * @member IntentRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the recognition has finished with an IntentRecognitionResult.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        if (Object.keys(this.privAddedLmIntents).length !== 0 || undefined !== this.privUmbrellaIntent) {
            const context = this.buildSpeechContext();
            this.privReco.speechContext.setSection("intent", context.Intent);
            this.privReco.dynamicGrammar.addReferenceGrammar(context.ReferenceGrammars);
            const intentReco = this.privReco;
            intentReco.setIntents(this.privAddedLmIntents, this.privUmbrellaIntent);
        }
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Interactive), cb, err);
    }
    /**
     * Starts speech recognition, until stopContinuousRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * @member IntentRecognizer.prototype.startContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startContinuousRecognitionAsync(cb, err) {
        if (Object.keys(this.privAddedLmIntents).length !== 0 || undefined !== this.privUmbrellaIntent) {
            const context = this.buildSpeechContext();
            this.privReco.speechContext.setSection("intent", context.Intent);
            this.privReco.dynamicGrammar.addReferenceGrammar(context.ReferenceGrammars);
            const intentReco = this.privReco;
            intentReco.setIntents(this.privAddedLmIntents, this.privUmbrellaIntent);
        }
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Stops continuous intent recognition.
     * @member IntentRecognizer.prototype.stopContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    /**
     * Starts speech recognition with keyword spotting, until stopKeywordRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * Note: Key word spotting functionality is only available on the Speech Devices SDK.
     * This functionality is currently not included in the SDK itself.
     * @member IntentRecognizer.prototype.startKeywordRecognitionAsync
     * @function
     * @public
     * @param {KeywordRecognitionModel} model - The keyword recognition model that specifies the keyword to be recognized.
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startKeywordRecognitionAsync(model, cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        if (!!err) {
            err("Not yet implemented.");
        }
    }
    /**
     * Stops continuous speech recognition.
     * Note: Key word spotting functionality is only available on the Speech Devices SDK.
     * This functionality is currently not included in the SDK itself.
     * @member IntentRecognizer.prototype.stopKeywordRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopKeywordRecognitionAsync(cb, err) {
        if (!!cb) {
            try {
                cb();
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
        }
    }
    /**
     * Adds a phrase that should be recognized as intent.
     * @member IntentRecognizer.prototype.addIntent
     * @function
     * @public
     * @param {string} intentId - A String that represents the identifier of the intent to be recognized.
     * @param {string} phrase - A String that specifies the phrase representing the intent.
     */
    addIntent(simplePhrase, intentId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(intentId, "intentId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(simplePhrase, "simplePhrase");
        this.privAddedIntents.push([intentId, simplePhrase]);
    }
    /**
     * Adds an intent from Language Understanding service for recognition.
     * @member IntentRecognizer.prototype.addIntentWithLanguageModel
     * @function
     * @public
     * @param {string} intentId - A String that represents the identifier of the intent
     * to be recognized. Ignored if intentName is empty.
     * @param {string} model - The intent model from Language Understanding service.
     * @param {string} intentName - The intent name defined in the intent model. If it
     * is empty, all intent names defined in the model will be added.
     */
    addIntentWithLanguageModel(intentId, model, intentName) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(intentId, "intentId");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        const modelImpl = model;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(modelImpl.appId, "model.appId");
        this.privAddedLmIntents[intentId] = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.AddedLmIntent(modelImpl, intentName);
    }
    /**
     * @summary Adds all intents from the specified Language Understanding Model.
     * @member IntentRecognizer.prototype.addAllIntents
     * @function
     * @public
     * @function
     * @public
     * @param {LanguageUnderstandingModel} model - The language understanding model containing the intents.
     * @param {string} intentId - A custom id String to be returned in the IntentRecognitionResult's getIntentId() method.
     */
    addAllIntents(model, intentId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        const modelImpl = model;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(modelImpl.appId, "model.appId");
        this.privUmbrellaIntent = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.AddedLmIntent(modelImpl, intentId);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member IntentRecognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.IntentServiceRecognizer(authentication, connectionFactory, audioImpl, recognizerConfig, this);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedIntentRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedIntentRecognizer = true;
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    buildSpeechContext() {
        let appId;
        let region;
        let subscriptionKey;
        const refGrammers = [];
        if (undefined !== this.privUmbrellaIntent) {
            appId = this.privUmbrellaIntent.modelImpl.appId;
            region = this.privUmbrellaIntent.modelImpl.region;
            subscriptionKey = this.privUmbrellaIntent.modelImpl.subscriptionKey;
        }
        // Build the reference grammer array.
        for (const intentId of Object.keys(this.privAddedLmIntents)) {
            const addedLmIntent = this.privAddedLmIntents[intentId];
            // validate all the same model, region, and key...
            if (appId === undefined) {
                appId = addedLmIntent.modelImpl.appId;
            }
            else {
                if (appId !== addedLmIntent.modelImpl.appId) {
                    throw new Error("Intents must all be from the same LUIS model");
                }
            }
            if (region === undefined) {
                region = addedLmIntent.modelImpl.region;
            }
            else {
                if (region !== addedLmIntent.modelImpl.region) {
                    throw new Error("Intents must all be from the same LUIS model in a single region");
                }
            }
            if (subscriptionKey === undefined) {
                subscriptionKey = addedLmIntent.modelImpl.subscriptionKey;
            }
            else {
                if (subscriptionKey !== addedLmIntent.modelImpl.subscriptionKey) {
                    throw new Error("Intents must all use the same subscription key");
                }
            }
            const grammer = "luis/" + appId + "-PRODUCTION#" + intentId;
            refGrammers.push(grammer);
        }
        return {
            Intent: {
                id: appId,
                key: (subscriptionKey === undefined) ? this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_Key]) : subscriptionKey,
                provider: "LUIS",
            },
            ReferenceGrammars: (undefined === this.privUmbrellaIntent) ? refGrammers : ["luis/" + appId + "-PRODUCTION"],
        };
    }
}

//# sourceMappingURL=IntentRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/KeywordRecognitionModel.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/KeywordRecognitionModel.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "KeywordRecognitionModel": () => (/* binding */ KeywordRecognitionModel)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents a keyword recognition model for recognizing when
 * the user says a keyword to initiate further speech recognition.
 * @class KeywordRecognitionModel
 */
class KeywordRecognitionModel {
    /**
     * Create and initializes a new instance.
     * @constructor
     */
    constructor() {
        this.privDisposed = false;
        return;
    }
    /**
     * Creates a keyword recognition model using the specified filename.
     * @member KeywordRecognitionModel.fromFile
     * @function
     * @public
     * @param {string} fileName - A string that represents file name for the keyword recognition model.
     * Note, the file can point to a zip file in which case the model
     * will be extracted from the zip.
     * @returns {KeywordRecognitionModel} The keyword recognition model being created.
     */
    static fromFile(fileName) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfFileDoesNotExist(fileName, "fileName");
        throw new Error("Not yet implemented.");
    }
    /**
     * Creates a keyword recognition model using the specified filename.
     * @member KeywordRecognitionModel.fromStream
     * @function
     * @public
     * @param {string} file - A File that represents file for the keyword recognition model.
     * Note, the file can point to a zip file in which case the model will be extracted from the zip.
     * @returns {KeywordRecognitionModel} The keyword recognition model being created.
     */
    static fromStream(file) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(file, "file");
        throw new Error("Not yet implemented.");
    }
    /**
     * Dispose of associated resources.
     * @member KeywordRecognitionModel.prototype.close
     * @function
     * @public
     */
    close() {
        if (this.privDisposed) {
            return;
        }
        this.privDisposed = true;
    }
}

//# sourceMappingURL=KeywordRecognitionModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageIdMode.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LanguageIdMode": () => (/* binding */ LanguageIdMode)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Language Identification mode
 * @class LanguageIdMode
 */
var LanguageIdMode;
(function (LanguageIdMode) {
    /**
     * Detect language at audio start
     * @member LanguageIdMode.AtStart
     */
    LanguageIdMode[LanguageIdMode["AtStart"] = 0] = "AtStart";
    /**
     * Continuously detect language
     * @member LanguageIdMode.Continuous
     */
    LanguageIdMode[LanguageIdMode["Continuous"] = 1] = "Continuous";
})(LanguageIdMode || (LanguageIdMode = {}));

//# sourceMappingURL=LanguageIdMode.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageUnderstandingModel.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/LanguageUnderstandingModel.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LanguageUnderstandingModel": () => (/* binding */ LanguageUnderstandingModel),
/* harmony export */   "LanguageUnderstandingModelImpl": () => (/* binding */ LanguageUnderstandingModelImpl)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// eslint-disable-next-line max-classes-per-file

/**
 * Language understanding model
 * @class LanguageUnderstandingModel
 */
class LanguageUnderstandingModel {
    /**
     * Creates and initializes a new instance
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Creates an language understanding model using the specified endpoint.
     * @member LanguageUnderstandingModel.fromEndpoint
     * @function
     * @public
     * @param {URL} uri - A String that represents the endpoint of the language understanding model.
     * @returns {LanguageUnderstandingModel} The language understanding model being created.
     */
    static fromEndpoint(uri) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(uri, "uri");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(uri.hostname, "uri");
        const langModelImp = new LanguageUnderstandingModelImpl();
        // Need to extract the app ID from the URL.
        // URL is in the format: https://<region>.api.cognitive.microsoft.com/luis/v2.0/apps/<Guid>?subscription-key=<key>&timezoneOffset=-360
        // Start tearing the string apart.
        // region can be extracted from the host name.
        const firstDot = uri.host.indexOf(".");
        if (-1 === firstDot) {
            throw new Error("Could not determine region from endpoint");
        }
        langModelImp.region = uri.host.substr(0, firstDot);
        // Now the app ID.
        const lastSegment = uri.pathname.lastIndexOf("/") + 1;
        if (-1 === lastSegment) {
            throw new Error("Could not determine appId from endpoint");
        }
        langModelImp.appId = uri.pathname.substr(lastSegment);
        // And finally the key.
        langModelImp.subscriptionKey = uri.searchParams.get("subscription-key");
        if (undefined === langModelImp.subscriptionKey) {
            throw new Error("Could not determine subscription key from endpoint");
        }
        return langModelImp;
    }
    /**
     * Creates an language understanding model using the application id of Language Understanding service.
     * @member LanguageUnderstandingModel.fromAppId
     * @function
     * @public
     * @param {string} appId - A String that represents the application id of Language Understanding service.
     * @returns {LanguageUnderstandingModel} The language understanding model being created.
     */
    static fromAppId(appId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(appId, "appId");
        const langModelImp = new LanguageUnderstandingModelImpl();
        langModelImp.appId = appId;
        return langModelImp;
    }
    /**
     * Creates a language understanding model using hostname, subscription key and application
     * id of Language Understanding service.
     * @member LanguageUnderstandingModel.fromSubscription
     * @function
     * @public
     * @param {string} subscriptionKey - A String that represents the subscription key of
     * Language Understanding service.
     * @param {string} appId - A String that represents the application id of Language
     * Understanding service.
     * @param {LanguageUnderstandingModel} region - A String that represents the region
     * of the Language Understanding service (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {LanguageUnderstandingModel} The language understanding model being created.
     */
    static fromSubscription(subscriptionKey, appId, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(subscriptionKey, "subscriptionKey");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(appId, "appId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(region, "region");
        const langModelImp = new LanguageUnderstandingModelImpl();
        langModelImp.appId = appId;
        langModelImp.region = region;
        langModelImp.subscriptionKey = subscriptionKey;
        return langModelImp;
    }
}
/**
 * @private
 * @class LanguageUnderstandingModelImpl
 */
class LanguageUnderstandingModelImpl extends LanguageUnderstandingModel {
}

//# sourceMappingURL=LanguageUnderstandingModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchDetails.js":
/*!******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchDetails.js ***!
  \******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NoMatchDetails": () => (/* binding */ NoMatchDetails)
/* harmony export */ });
/* harmony import */ var _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../src/common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/SimpleSpeechPhrase.js");
/* harmony import */ var _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../src/common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/Enums.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Contains detailed information for NoMatch recognition results.
 * @class NoMatchDetails
 */
class NoMatchDetails {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {NoMatchReason} reason - The no-match reason.
     */
    constructor(reason) {
        this.privReason = reason;
    }
    /**
     * Creates an instance of NoMatchDetails object for the NoMatch SpeechRecognitionResults.
     * @member NoMatchDetails.fromResult
     * @function
     * @public
     * @param {SpeechRecognitionResult | IntentRecognitionResult | TranslationRecognitionResult}
     * result - The recognition result that was not recognized.
     * @returns {NoMatchDetails} The no match details object being created.
     */
    static fromResult(result) {
        const simpleSpeech = _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_0__.SimpleSpeechPhrase.fromJSON(result.json);
        let reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.NotRecognized;
        switch (simpleSpeech.RecognitionStatus) {
            case _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.BabbleTimeout:
                reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.InitialBabbleTimeout;
                break;
            case _src_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.RecognitionStatus.InitialSilenceTimeout:
                reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.InitialSilenceTimeout;
                break;
            default:
                reason = _Exports__WEBPACK_IMPORTED_MODULE_1__.NoMatchReason.NotRecognized;
                break;
        }
        return new NoMatchDetails(reason);
    }
    /**
     * The reason the recognition was canceled.
     * @member NoMatchDetails.prototype.reason
     * @function
     * @public
     * @returns {NoMatchReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privReason;
    }
}

//# sourceMappingURL=NoMatchDetails.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/NoMatchReason.js ***!
  \*****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NoMatchReason": () => (/* binding */ NoMatchReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the possible reasons a recognition result might not be recognized.
 * @class NoMatchReason
 */
var NoMatchReason;
(function (NoMatchReason) {
    /**
     * Indicates that speech was detected, but not recognized.
     * @member NoMatchReason.NotRecognized
     */
    NoMatchReason[NoMatchReason["NotRecognized"] = 0] = "NotRecognized";
    /**
     * Indicates that the start of the audio stream contained only silence,
     * and the service timed out waiting for speech.
     * @member NoMatchReason.InitialSilenceTimeout
     */
    NoMatchReason[NoMatchReason["InitialSilenceTimeout"] = 1] = "InitialSilenceTimeout";
    /**
     * Indicates that the start of the audio stream contained only noise,
     * and the service timed out waiting for speech.
     * @member NoMatchReason.InitialBabbleTimeout
     */
    NoMatchReason[NoMatchReason["InitialBabbleTimeout"] = 2] = "InitialBabbleTimeout";
})(NoMatchReason || (NoMatchReason = {}));

//# sourceMappingURL=NoMatchReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OutputFormat": () => (/* binding */ OutputFormat)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Define Speech Recognizer output formats.
 * @class OutputFormat
 */
var OutputFormat;
(function (OutputFormat) {
    /**
     * @member OutputFormat.Simple
     */
    OutputFormat[OutputFormat["Simple"] = 0] = "Simple";
    /**
     * @member OutputFormat.Detailed
     */
    OutputFormat[OutputFormat["Detailed"] = 1] = "Detailed";
})(OutputFormat || (OutputFormat = {}));

//# sourceMappingURL=OutputFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PhraseListGrammar.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PhraseListGrammar.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PhraseListGrammar": () => (/* binding */ PhraseListGrammar)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Allows additions of new phrases to improve speech recognition.
 *
 * Phrases added to the recognizer are effective at the start of the next recognition, or the next time the SpeechSDK must reconnect
 * to the speech service.
 */
class PhraseListGrammar {
    constructor(recogBase) {
        this.privGrammerBuilder = recogBase.dynamicGrammar;
    }
    /**
     * Creates a PhraseListGrammar from a given speech recognizer. Will accept any recognizer that derives from @class Recognizer.
     * @param recognizer The recognizer to add phrase lists to.
     */
    static fromRecognizer(recognizer) {
        const recoBase = recognizer.internalData;
        return new PhraseListGrammar(recoBase);
    }
    /**
     * Adds a single phrase to the current recognizer.
     * @param phrase Phrase to add.
     */
    addPhrase(phrase) {
        this.privGrammerBuilder.addPhrase(phrase);
    }
    /**
     * Adds multiple phrases to the current recognizer.
     * @param phrases Array of phrases to add.
     */
    addPhrases(phrases) {
        this.privGrammerBuilder.addPhrase(phrases);
    }
    /**
     * Clears all phrases added to the current recognizer.
     */
    clear() {
        this.privGrammerBuilder.clearPhrases();
    }
}

//# sourceMappingURL=PhraseListGrammar.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ProfanityOption": () => (/* binding */ ProfanityOption)
/* harmony export */ });
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
/**
 * Profanity option.
 * Added in version 1.7.0.
 */
var ProfanityOption;
(function (ProfanityOption) {
    ProfanityOption[ProfanityOption["Masked"] = 0] = "Masked";
    ProfanityOption[ProfanityOption["Removed"] = 1] = "Removed";
    ProfanityOption[ProfanityOption["Raw"] = 2] = "Raw";
})(ProfanityOption || (ProfanityOption = {}));

//# sourceMappingURL=ProfanityOption.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentConfig.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentConfig.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentConfig": () => (/* binding */ PronunciationAssessmentConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Pronunciation assessment configuration.
 * @class PronunciationAssessmentConfig
 * Added in version 1.15.0.
 */
class PronunciationAssessmentConfig {
    /**
     * PronunciationAssessmentConfig constructor.
     * @constructor
     * @param {string} referenceText
     * @param gradingSystem
     * @param granularity
     * @param enableMiscue
     */
    constructor(referenceText, gradingSystem = _Exports__WEBPACK_IMPORTED_MODULE_0__.PronunciationAssessmentGradingSystem.FivePoint, granularity = _Exports__WEBPACK_IMPORTED_MODULE_1__.PronunciationAssessmentGranularity.Phoneme, enableMiscue = false) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(referenceText, "referenceText");
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText, referenceText);
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_GradingSystem, _Exports__WEBPACK_IMPORTED_MODULE_0__.PronunciationAssessmentGradingSystem[gradingSystem]);
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Granularity, _Exports__WEBPACK_IMPORTED_MODULE_1__.PronunciationAssessmentGranularity[granularity]);
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_EnableMiscue, String(enableMiscue));
    }
    /**
     * @member PronunciationAssessmentConfig.fromJSON
     * @function
     * @public
     * @param {string} json The json string containing the pronunciation assessment parameters.
     * @return {PronunciationAssessmentConfig} Instance of PronunciationAssessmentConfig
     * @summary Creates an instance of the PronunciationAssessmentConfig from json.
     */
    static fromJSON(json) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(json, "json");
        const config = new PronunciationAssessmentConfig("");
        config.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        config.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Json, json);
        return config;
    }
    toJSON() {
        this.updateJson();
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Params);
    }
    applyTo(recognizer) {
        this.updateJson();
        const recoBase = recognizer.internalData;
        recoBase.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Params));
    }
    /**
     * Gets the reference text.
     * @member PronunciationAssessmentConfig.prototype.referenceText
     * @function
     * @public
     * @returns {string} Reference text.
     */
    get referenceText() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText);
    }
    /**
     * Gets/Sets the reference text.
     * @member PronunciationAssessmentConfig.prototype.referenceText
     * @function
     * @public
     * @param {string} referenceText - Reference text.
     */
    set referenceText(referenceText) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(referenceText, "referenceText");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText, referenceText);
    }
    /**
     * Sets the phoneme alphabet.
     * The valid values are "SAPI" (default) and "IPA".
     * Added in version 1.20.0
     * @member PronunciationAssessmentConfig.prototype.phonemeAlphabet
     * @function
     * @public
     * @param {string} phonemeAlphabet - Phoneme alphabet.
     */
    set phonemeAlphabet(phonemeAlphabet) {
        _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrWhitespace(phonemeAlphabet, "phonemeAlphabet");
        this.privPhonemeAlphabet = phonemeAlphabet;
    }
    /**
     * Sets the boolean enableMiscue property.
     * Added in version 1.26.0
     * @member PronunciationAssessmentConfig.prototype.enableMiscue
     * @function
     * @public
     * @param {boolean} enableMiscue - enable miscue.
     */
    set enableMiscue(enableMiscue) {
        const enableMiscueString = enableMiscue ? "true" : "false";
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_EnableMiscue, enableMiscueString);
    }
    /**
     * Gets the boolean enableMiscue property.
     * Added in version 1.26.0
     * @member PronunciationAssessmentConfig.prototype.enableMiscue
     * @function
     * @public
     * @return {boolean} enableMiscue - enable miscue.
     */
    get enableMiscue() {
        const enableMiscueString = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_EnableMiscue, "false");
        return (enableMiscueString.toLowerCase() === "true");
    }
    /**
     * Sets the nbest phoneme count
     * Added in version 1.20.0
     * @member PronunciationAssessmentConfig.prototype.nbestPhonemeCount
     * @function
     * @public
     * @param {number} nbestPhonemeCount - NBest phoneme count.
     */
    set nbestPhonemeCount(nbestPhonemeCount) {
        this.privNBestPhonemeCount = nbestPhonemeCount;
    }
    /**
     * @member PronunciationAssessmentConfig.prototype.properties
     * @function
     * @public
     * @return {PropertyCollection} Properties of the config.
     * @summary Gets a pronunciation assessment config properties
     */
    get properties() {
        return this.privProperties;
    }
    updateJson() {
        const jsonString = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Json, "{}");
        const paramsJson = JSON.parse(jsonString);
        const referenceText = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_ReferenceText);
        if (referenceText) {
            paramsJson.referenceText = referenceText;
        }
        const gradingSystem = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_GradingSystem);
        if (gradingSystem) {
            paramsJson.gradingSystem = gradingSystem;
        }
        const granularity = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Granularity);
        if (granularity) {
            paramsJson.granularity = granularity;
        }
        if (this.privPhonemeAlphabet) {
            paramsJson.phonemeAlphabet = this.privPhonemeAlphabet;
        }
        if (this.privNBestPhonemeCount) {
            paramsJson.nbestPhonemeCount = this.privNBestPhonemeCount;
        }
        // always set dimension to Comprehensive
        paramsJson.dimension = "Comprehensive";
        paramsJson.enableMiscue = this.enableMiscue;
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.PronunciationAssessment_Params, JSON.stringify(paramsJson));
    }
}

//# sourceMappingURL=PronunciationAssessmentConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGradingSystem.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentGradingSystem": () => (/* binding */ PronunciationAssessmentGradingSystem)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the point system for pronunciation score calibration; default value is FivePoint.
 * Added in version 1.15.0
 * @class PronunciationAssessmentGradingSystem
 */
var PronunciationAssessmentGradingSystem;
(function (PronunciationAssessmentGradingSystem) {
    /**
     * Five point calibration
     * @member PronunciationAssessmentGradingSystem.FivePoint
     */
    PronunciationAssessmentGradingSystem[PronunciationAssessmentGradingSystem["FivePoint"] = 1] = "FivePoint";
    /**
     * Hundred mark
     * @member PronunciationAssessmentGradingSystem.HundredMark
     */
    PronunciationAssessmentGradingSystem[PronunciationAssessmentGradingSystem["HundredMark"] = 2] = "HundredMark";
})(PronunciationAssessmentGradingSystem || (PronunciationAssessmentGradingSystem = {}));

//# sourceMappingURL=PronunciationAssessmentGradingSystem.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentGranularity.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentGranularity": () => (/* binding */ PronunciationAssessmentGranularity)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the pronunciation evaluation granularity; default value is Phoneme.
 * Added in version 1.15.0
 * @class PronunciationAssessmentGranularity
 */
var PronunciationAssessmentGranularity;
(function (PronunciationAssessmentGranularity) {
    /**
     * Shows the score on the full text, word and phoneme level
     * @member PronunciationAssessmentGranularity.Phoneme
     */
    PronunciationAssessmentGranularity[PronunciationAssessmentGranularity["Phoneme"] = 1] = "Phoneme";
    /**
     * Shows the score on the full text and word level
     * @member PronunciationAssessmentGranularity.Word
     */
    PronunciationAssessmentGranularity[PronunciationAssessmentGranularity["Word"] = 2] = "Word";
    /**
     * Shows the score on the full text level only
     * @member PronunciationAssessmentGranularity.FullText
     */
    PronunciationAssessmentGranularity[PronunciationAssessmentGranularity["FullText"] = 3] = "FullText";
})(PronunciationAssessmentGranularity || (PronunciationAssessmentGranularity = {}));

//# sourceMappingURL=PronunciationAssessmentGranularity.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentResult.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PronunciationAssessmentResult.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PronunciationAssessmentResult": () => (/* binding */ PronunciationAssessmentResult)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Pronunciation assessment results.
 * @class PronunciationAssessmentResult
 * Added in version 1.15.0.
 */
class PronunciationAssessmentResult {
    constructor(jsonString) {
        const j = JSON.parse(jsonString);
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(j.NBest[0], "NBest");
        this.privPronJson = j.NBest[0];
    }
    /**
     * @member PronunciationAssessmentResult.fromResult
     * @function
     * @public
     * @param {RecognitionResult} result The recognition result.
     * @return {PronunciationAssessmentConfig} Instance of PronunciationAssessmentConfig
     * @summary Creates an instance of the PronunciationAssessmentResult from recognition result.
     */
    static fromResult(result) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(result, "result");
        const json = result.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_JsonResult);
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(json, "json");
        return new PronunciationAssessmentResult(json);
    }
    /**
     * Gets the detail result of pronunciation assessment.
     * @member PronunciationAssessmentConfig.prototype.detailResult
     * @function
     * @public
     * @returns {DetailResult} detail result.
     */
    get detailResult() {
        return this.privPronJson;
    }
    /**
     * The score indicating the pronunciation accuracy of the given speech, which indicates
     * how closely the phonemes match a native speaker's pronunciation.
     * @member PronunciationAssessmentResult.prototype.accuracyScore
     * @function
     * @public
     * @returns {number} Accuracy score.
     */
    get accuracyScore() {
        return this.detailResult.PronunciationAssessment.AccuracyScore;
    }
    /**
     * The overall score indicating the pronunciation quality of the given speech.
     * This is calculated from AccuracyScore, FluencyScore and CompletenessScore with weight.
     * @member PronunciationAssessmentResult.prototype.pronunciationScore
     * @function
     * @public
     * @returns {number} Pronunciation score.
     */
    get pronunciationScore() {
        return this.detailResult.PronunciationAssessment.PronScore;
    }
    /**
     * The score indicating the completeness of the given speech by calculating the ratio of pronounced words towards entire input.
     * @member PronunciationAssessmentResult.prototype.completenessScore
     * @function
     * @public
     * @returns {number} Completeness score.
     */
    get completenessScore() {
        return this.detailResult.PronunciationAssessment.CompletenessScore;
    }
    /**
     * The score indicating the fluency of the given speech.
     * @member PronunciationAssessmentResult.prototype.fluencyScore
     * @function
     * @public
     * @returns {number} Fluency score.
     */
    get fluencyScore() {
        return this.detailResult.PronunciationAssessment.FluencyScore;
    }
}

//# sourceMappingURL=PronunciationAssessmentResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PropertyCollection": () => (/* binding */ PropertyCollection)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents collection of properties and their values.
 * @class PropertyCollection
 */
class PropertyCollection {
    constructor() {
        this.privKeys = [];
        this.privValues = [];
    }
    /**
     * Returns the property value in type String.
     * Currently only String, int and bool are allowed.
     * If the name is not available, the specified defaultValue is returned.
     * @member PropertyCollection.prototype.getProperty
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string | number | boolean} def - The default value which is returned if the parameter
     * is not available in the collection.
     * @returns {string} value of the parameter.
     */
    getProperty(key, def) {
        let keyToUse;
        if (typeof key === "string") {
            keyToUse = key;
        }
        else {
            keyToUse = _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId[key];
        }
        for (let n = 0; n < this.privKeys.length; n++) {
            if (this.privKeys[n] === keyToUse) {
                return this.privValues[n];
            }
        }
        if (def === undefined) {
            return undefined;
        }
        return String(def);
    }
    /**
     * Sets the String value of the parameter specified by name.
     * @member PropertyCollection.prototype.setProperty
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string} value - The value of the parameter.
     */
    setProperty(key, value) {
        let keyToUse;
        if (typeof key === "string") {
            keyToUse = key;
        }
        else {
            keyToUse = _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyId[key];
        }
        for (let n = 0; n < this.privKeys.length; n++) {
            if (this.privKeys[n] === keyToUse) {
                this.privValues[n] = value;
                return;
            }
        }
        this.privKeys.push(keyToUse);
        this.privValues.push(value);
    }
    /**
     * Clones the collection.
     * @member PropertyCollection.prototype.clone
     * @function
     * @public
     * @returns {PropertyCollection} A copy of the collection.
     */
    clone() {
        const clonedMap = new PropertyCollection();
        for (let n = 0; n < this.privKeys.length; n++) {
            clonedMap.privKeys.push(this.privKeys[n]);
            clonedMap.privValues.push(this.privValues[n]);
        }
        return clonedMap;
    }
    /**
     * Merges this set of properties into another, no overwrites.
     * @member PropertyCollection.prototype.mergeTo
     * @function
     * @public
     * @param {PropertyCollection}  destinationCollection - The collection to merge into.
     */
    mergeTo(destinationCollection) {
        this.privKeys.forEach((key) => {
            if (destinationCollection.getProperty(key, undefined) === undefined) {
                const value = this.getProperty(key);
                destinationCollection.setProperty(key, value);
            }
        });
    }
    /**
     * Get the keys in Property Collection.
     * @member PropertyCollection.prototype.keys
     * @function
     * @public
     * @returns {string []} Keys in the collection.
     */
    get keys() {
        return this.privKeys;
    }
}

//# sourceMappingURL=PropertyCollection.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "PropertyId": () => (/* binding */ PropertyId)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines speech property ids.
 * @class PropertyId
 */
var PropertyId;
(function (PropertyId) {
    /**
     * The Cognitive Services Speech Service subscription Key. If you are using an intent recognizer, you need to
     * specify the LUIS endpoint key for your particular LUIS app. Under normal circumstances, you shouldn't
     * have to use this property directly.
     * Instead, use [[SpeechConfig.fromSubscription]].
     * @member PropertyId.SpeechServiceConnection_Key
     */
    PropertyId[PropertyId["SpeechServiceConnection_Key"] = 0] = "SpeechServiceConnection_Key";
    /**
     * The Cognitive Services Speech Service endpoint (url). Under normal circumstances, you shouldn't
     * have to use this property directly.
     * Instead, use [[SpeechConfig.fromEndpoint]].
     * NOTE: This endpoint is not the same as the endpoint used to obtain an access token.
     * @member PropertyId.SpeechServiceConnection_Endpoint
     */
    PropertyId[PropertyId["SpeechServiceConnection_Endpoint"] = 1] = "SpeechServiceConnection_Endpoint";
    /**
     * The Cognitive Services Speech Service region. Under normal circumstances, you shouldn't have to
     * use this property directly.
     * Instead, use [[SpeechConfig.fromSubscription]], [[SpeechConfig.fromEndpoint]], [[SpeechConfig.fromAuthorizationToken]].
     * @member PropertyId.SpeechServiceConnection_Region
     */
    PropertyId[PropertyId["SpeechServiceConnection_Region"] = 2] = "SpeechServiceConnection_Region";
    /**
     * The Cognitive Services Speech Service authorization token (aka access token). Under normal circumstances,
     * you shouldn't have to use this property directly.
     * Instead, use [[SpeechConfig.fromAuthorizationToken]], [[SpeechRecognizer.authorizationToken]],
     * [[IntentRecognizer.authorizationToken]], [[TranslationRecognizer.authorizationToken]], [[SpeakerRecognizer.authorizationToken]].
     * @member PropertyId.SpeechServiceAuthorization_Token
     */
    PropertyId[PropertyId["SpeechServiceAuthorization_Token"] = 3] = "SpeechServiceAuthorization_Token";
    /**
     * The Cognitive Services Speech Service authorization type. Currently unused.
     * @member PropertyId.SpeechServiceAuthorization_Type
     */
    PropertyId[PropertyId["SpeechServiceAuthorization_Type"] = 4] = "SpeechServiceAuthorization_Type";
    /**
     * The Cognitive Services Speech Service endpoint id. Under normal circumstances, you shouldn't
     * have to use this property directly.
     * Instead, use [[SpeechConfig.endpointId]].
     * NOTE: The endpoint id is available in the Speech Portal, listed under Endpoint Details.
     * @member PropertyId.SpeechServiceConnection_EndpointId
     */
    PropertyId[PropertyId["SpeechServiceConnection_EndpointId"] = 5] = "SpeechServiceConnection_EndpointId";
    /**
     * The list of comma separated languages (BCP-47 format) used as target translation languages. Under normal circumstances,
     * you shouldn't have to use this property directly.
     * Instead use [[SpeechTranslationConfig.addTargetLanguage]],
     * [[SpeechTranslationConfig.targetLanguages]], [[TranslationRecognizer.targetLanguages]].
     * @member PropertyId.SpeechServiceConnection_TranslationToLanguages
     */
    PropertyId[PropertyId["SpeechServiceConnection_TranslationToLanguages"] = 6] = "SpeechServiceConnection_TranslationToLanguages";
    /**
     * The name of the Cognitive Service Text to Speech Service Voice. Under normal circumstances, you shouldn't have to use this
     * property directly.
     * Instead, use [[SpeechTranslationConfig.voiceName]].
     * NOTE: Valid voice names can be found <a href="https://aka.ms/csspeech/voicenames">here</a>.
     * @member PropertyId.SpeechServiceConnection_TranslationVoice
     */
    PropertyId[PropertyId["SpeechServiceConnection_TranslationVoice"] = 7] = "SpeechServiceConnection_TranslationVoice";
    /**
     * Translation features.
     * @member PropertyId.SpeechServiceConnection_TranslationFeatures
     */
    PropertyId[PropertyId["SpeechServiceConnection_TranslationFeatures"] = 8] = "SpeechServiceConnection_TranslationFeatures";
    /**
     * The Language Understanding Service Region. Under normal circumstances, you shouldn't have to use this property directly.
     * Instead, use [[LanguageUnderstandingModel]].
     * @member PropertyId.SpeechServiceConnection_IntentRegion
     */
    PropertyId[PropertyId["SpeechServiceConnection_IntentRegion"] = 9] = "SpeechServiceConnection_IntentRegion";
    /**
     * The host name of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyHostName"] = 10] = "SpeechServiceConnection_ProxyHostName";
    /**
     * The port of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyPort"] = 11] = "SpeechServiceConnection_ProxyPort";
    /**
     * The user name of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyUserName"] = 12] = "SpeechServiceConnection_ProxyUserName";
    /**
     * The password of the proxy server used to connect to the Cognitive Services Speech Service. Only relevant in Node.js environments.
     * You shouldn't have to use this property directly.
     * Instead use <see cref="SpeechConfig.SetProxy(string,int,string,string)"/>.
     * Added in version 1.4.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_ProxyPassword"] = 13] = "SpeechServiceConnection_ProxyPassword";
    /**
     * The Cognitive Services Speech Service recognition Mode. Can be "INTERACTIVE", "CONVERSATION", "DICTATION".
     * This property is intended to be read-only. The SDK is using it internally.
     * @member PropertyId.SpeechServiceConnection_RecoMode
     */
    PropertyId[PropertyId["SpeechServiceConnection_RecoMode"] = 14] = "SpeechServiceConnection_RecoMode";
    /**
     * The spoken language to be recognized (in BCP-47 format). Under normal circumstances, you shouldn't have to use this property
     * directly.
     * Instead, use [[SpeechConfig.speechRecognitionLanguage]].
     * @member PropertyId.SpeechServiceConnection_RecoLanguage
     */
    PropertyId[PropertyId["SpeechServiceConnection_RecoLanguage"] = 15] = "SpeechServiceConnection_RecoLanguage";
    /**
     * The session id. This id is a universally unique identifier (aka UUID) representing a specific binding of an audio input stream
     * and the underlying speech recognition instance to which it is bound. Under normal circumstances, you shouldn't have to use this
     * property directly.
     * Instead use [[SessionEventArgs.sessionId]].
     * @member PropertyId.Speech_SessionId
     */
    PropertyId[PropertyId["Speech_SessionId"] = 16] = "Speech_SessionId";
    /**
     * The spoken language to be synthesized (e.g. en-US)
     * @member PropertyId.SpeechServiceConnection_SynthLanguage
     */
    PropertyId[PropertyId["SpeechServiceConnection_SynthLanguage"] = 17] = "SpeechServiceConnection_SynthLanguage";
    /**
     * The name of the TTS voice to be used for speech synthesis
     * @member PropertyId.SpeechServiceConnection_SynthVoice
     */
    PropertyId[PropertyId["SpeechServiceConnection_SynthVoice"] = 18] = "SpeechServiceConnection_SynthVoice";
    /**
     * The string to specify TTS output audio format
     * @member PropertyId.SpeechServiceConnection_SynthOutputFormat
     */
    PropertyId[PropertyId["SpeechServiceConnection_SynthOutputFormat"] = 19] = "SpeechServiceConnection_SynthOutputFormat";
    /**
     * The list of comma separated languages used as possible source languages
     * Added in version 1.13.0
     * @member PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages
     */
    PropertyId[PropertyId["SpeechServiceConnection_AutoDetectSourceLanguages"] = 20] = "SpeechServiceConnection_AutoDetectSourceLanguages";
    /**
     * The requested Cognitive Services Speech Service response output format (simple or detailed). Under normal circumstances, you shouldn't have
     * to use this property directly.
     * Instead use [[SpeechConfig.outputFormat]].
     * @member PropertyId.SpeechServiceResponse_RequestDetailedResultTrueFalse
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestDetailedResultTrueFalse"] = 21] = "SpeechServiceResponse_RequestDetailedResultTrueFalse";
    /**
     * The requested Cognitive Services Speech Service response output profanity level. Currently unused.
     * @member PropertyId.SpeechServiceResponse_RequestProfanityFilterTrueFalse
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestProfanityFilterTrueFalse"] = 22] = "SpeechServiceResponse_RequestProfanityFilterTrueFalse";
    /**
     * The Cognitive Services Speech Service response output (in JSON format). This property is available on recognition result objects only.
     * @member PropertyId.SpeechServiceResponse_JsonResult
     */
    PropertyId[PropertyId["SpeechServiceResponse_JsonResult"] = 23] = "SpeechServiceResponse_JsonResult";
    /**
     * The Cognitive Services Speech Service error details (in JSON format). Under normal circumstances, you shouldn't have to
     * use this property directly. Instead use [[CancellationDetails.errorDetails]].
     * @member PropertyId.SpeechServiceResponse_JsonErrorDetails
     */
    PropertyId[PropertyId["SpeechServiceResponse_JsonErrorDetails"] = 24] = "SpeechServiceResponse_JsonErrorDetails";
    /**
     * The cancellation reason. Currently unused.
     * @member PropertyId.CancellationDetails_Reason
     */
    PropertyId[PropertyId["CancellationDetails_Reason"] = 25] = "CancellationDetails_Reason";
    /**
     * The cancellation text. Currently unused.
     * @member PropertyId.CancellationDetails_ReasonText
     */
    PropertyId[PropertyId["CancellationDetails_ReasonText"] = 26] = "CancellationDetails_ReasonText";
    /**
     * The Cancellation detailed text. Currently unused.
     * @member PropertyId.CancellationDetails_ReasonDetailedText
     */
    PropertyId[PropertyId["CancellationDetails_ReasonDetailedText"] = 27] = "CancellationDetails_ReasonDetailedText";
    /**
     * The Language Understanding Service response output (in JSON format). Available via [[IntentRecognitionResult]]
     * @member PropertyId.LanguageUnderstandingServiceResponse_JsonResult
     */
    PropertyId[PropertyId["LanguageUnderstandingServiceResponse_JsonResult"] = 28] = "LanguageUnderstandingServiceResponse_JsonResult";
    /**
     * The URL string built from speech configuration.
     * This property is intended to be read-only. The SDK is using it internally.
     * NOTE: Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceConnection_Url"] = 29] = "SpeechServiceConnection_Url";
    /**
     * The initial silence timeout value (in milliseconds) used by the service.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_InitialSilenceTimeoutMs"] = 30] = "SpeechServiceConnection_InitialSilenceTimeoutMs";
    /**
     * The end silence timeout value (in milliseconds) used by the service.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_EndSilenceTimeoutMs"] = 31] = "SpeechServiceConnection_EndSilenceTimeoutMs";
    /**
     * A duration of detected silence, measured in milliseconds, after which speech-to-text will determine a spoken
     * phrase has ended and generate a final Recognized result. Configuring this timeout may be helpful in situations
     * where spoken input is significantly faster or slower than usual and default segmentation behavior consistently
     * yields results that are too long or too short. Segmentation timeout values that are inappropriately high or low
     * can negatively affect speech-to-text accuracy; this property should be carefully configured and the resulting
     * behavior should be thoroughly validated as intended.
     *
     * For more information about timeout configuration that includes discussion of default behaviors, please visit
     * https://aka.ms/csspeech/timeouts.
     *
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["Speech_SegmentationSilenceTimeoutMs"] = 32] = "Speech_SegmentationSilenceTimeoutMs";
    /**
     * A boolean value specifying whether audio logging is enabled in the service or not.
     * Audio and content logs are stored either in Microsoft-owned storage, or in your own storage account linked
     * to your Cognitive Services subscription (Bring Your Own Storage (BYOS) enabled Speech resource).
     * The logs will be removed after 30 days.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_EnableAudioLogging"] = 33] = "SpeechServiceConnection_EnableAudioLogging";
    /**
     * The speech service connection language identifier mode.
     * Can be "AtStart" (the default), or "Continuous". See Language
     * Identification document https://aka.ms/speech/lid?pivots=programming-language-javascript
     * for more details.
     * Added in 1.25.0
     **/
    PropertyId[PropertyId["SpeechServiceConnection_LanguageIdMode"] = 34] = "SpeechServiceConnection_LanguageIdMode";
    /**
     * A string value representing the desired endpoint version to target for Speech Recognition.
     * Added in version 1.21.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_RecognitionEndpointVersion"] = 35] = "SpeechServiceConnection_RecognitionEndpointVersion";
    /**
    /**
     * A string value the current speaker recognition scenario/mode (TextIndependentIdentification, etc.).
     * Added in version 1.23.0
     */
    PropertyId[PropertyId["SpeechServiceConnection_SpeakerIdMode"] = 36] = "SpeechServiceConnection_SpeakerIdMode";
    /**
     * The requested Cognitive Services Speech Service response output profanity setting.
     * Allowed values are "masked", "removed", and "raw".
     * Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_ProfanityOption"] = 37] = "SpeechServiceResponse_ProfanityOption";
    /**
     * A string value specifying which post processing option should be used by service.
     * Allowed values are "TrueText".
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceResponse_PostProcessingOption"] = 38] = "SpeechServiceResponse_PostProcessingOption";
    /**
     * A boolean value specifying whether to include word-level timestamps in the response result.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestWordLevelTimestamps"] = 39] = "SpeechServiceResponse_RequestWordLevelTimestamps";
    /**
     * The number of times a word has to be in partial results to be returned.
     * Added in version 1.7.0
     */
    PropertyId[PropertyId["SpeechServiceResponse_StablePartialResultThreshold"] = 40] = "SpeechServiceResponse_StablePartialResultThreshold";
    /**
     * A string value specifying the output format option in the response result. Internal use only.
     * Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_OutputFormatOption"] = 41] = "SpeechServiceResponse_OutputFormatOption";
    /**
     * A boolean value to request for stabilizing translation partial results by omitting words in the end.
     * Added in version 1.7.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_TranslationRequestStablePartialResult"] = 42] = "SpeechServiceResponse_TranslationRequestStablePartialResult";
    /**
     * A boolean value specifying whether to request WordBoundary events.
     * @member PropertyId.SpeechServiceResponse_RequestWordBoundary
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestWordBoundary"] = 43] = "SpeechServiceResponse_RequestWordBoundary";
    /**
     * A boolean value specifying whether to request punctuation boundary in WordBoundary Events. Default is true.
     * @member PropertyId.SpeechServiceResponse_RequestPunctuationBoundary
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestPunctuationBoundary"] = 44] = "SpeechServiceResponse_RequestPunctuationBoundary";
    /**
     * A boolean value specifying whether to request sentence boundary in WordBoundary Events. Default is false.
     * @member PropertyId.SpeechServiceResponse_RequestSentenceBoundary
     * Added in version 1.21.0.
     */
    PropertyId[PropertyId["SpeechServiceResponse_RequestSentenceBoundary"] = 45] = "SpeechServiceResponse_RequestSentenceBoundary";
    /**
     * Identifier used to connect to the backend service.
     * @member PropertyId.Conversation_ApplicationId
     */
    PropertyId[PropertyId["Conversation_ApplicationId"] = 46] = "Conversation_ApplicationId";
    /**
     * Type of dialog backend to connect to.
     * @member PropertyId.Conversation_DialogType
     */
    PropertyId[PropertyId["Conversation_DialogType"] = 47] = "Conversation_DialogType";
    /**
     * Silence timeout for listening
     * @member PropertyId.Conversation_Initial_Silence_Timeout
     */
    PropertyId[PropertyId["Conversation_Initial_Silence_Timeout"] = 48] = "Conversation_Initial_Silence_Timeout";
    /**
     * From Id to add to speech recognition activities.
     * @member PropertyId.Conversation_From_Id
     */
    PropertyId[PropertyId["Conversation_From_Id"] = 49] = "Conversation_From_Id";
    /**
     * ConversationId for the session.
     * @member PropertyId.Conversation_Conversation_Id
     */
    PropertyId[PropertyId["Conversation_Conversation_Id"] = 50] = "Conversation_Conversation_Id";
    /**
     * Comma separated list of custom voice deployment ids.
     * @member PropertyId.Conversation_Custom_Voice_Deployment_Ids
     */
    PropertyId[PropertyId["Conversation_Custom_Voice_Deployment_Ids"] = 51] = "Conversation_Custom_Voice_Deployment_Ids";
    /**
     * Speech activity template, stamp properties from the template on the activity generated by the service for speech.
     * @member PropertyId.Conversation_Speech_Activity_Template
     * Added in version 1.10.0.
     */
    PropertyId[PropertyId["Conversation_Speech_Activity_Template"] = 52] = "Conversation_Speech_Activity_Template";
    /**
     * Enables or disables the receipt of turn status messages as obtained on the turnStatusReceived event.
     * @member PropertyId.Conversation_Request_Bot_Status_Messages
     * Added in version 1.15.0.
     */
    PropertyId[PropertyId["Conversation_Request_Bot_Status_Messages"] = 53] = "Conversation_Request_Bot_Status_Messages";
    /**
     * Specifies the connection ID to be provided in the Agent configuration message, e.g. a Direct Line token for
     * channel authentication.
     * Added in version 1.15.1.
     */
    PropertyId[PropertyId["Conversation_Agent_Connection_Id"] = 54] = "Conversation_Agent_Connection_Id";
    /**
     * The Cognitive Services Speech Service host (url). Under normal circumstances, you shouldn't have to use this property directly.
     * Instead, use [[SpeechConfig.fromHost]].
     */
    PropertyId[PropertyId["SpeechServiceConnection_Host"] = 55] = "SpeechServiceConnection_Host";
    /**
     * Set the host for service calls to the Conversation Translator REST management and websocket calls.
     */
    PropertyId[PropertyId["ConversationTranslator_Host"] = 56] = "ConversationTranslator_Host";
    /**
     * Optionally set the the host's display name.
     * Used when joining a conversation.
     */
    PropertyId[PropertyId["ConversationTranslator_Name"] = 57] = "ConversationTranslator_Name";
    /**
     * Optionally set a value for the X-CorrelationId request header.
     * Used for troubleshooting errors in the server logs. It should be a valid guid.
     */
    PropertyId[PropertyId["ConversationTranslator_CorrelationId"] = 58] = "ConversationTranslator_CorrelationId";
    /**
     * Set the conversation token to be sent to the speech service. This enables the
     * service to service call from the speech service to the Conversation Translator service for relaying
     * recognitions. For internal use.
     */
    PropertyId[PropertyId["ConversationTranslator_Token"] = 59] = "ConversationTranslator_Token";
    /**
     * The reference text of the audio for pronunciation evaluation.
     * For this and the following pronunciation assessment parameters, see
     * https://docs.microsoft.com/azure/cognitive-services/speech-service/rest-speech-to-text#pronunciation-assessment-parameters for details.
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_ReferenceText"] = 60] = "PronunciationAssessment_ReferenceText";
    /**
     * The point system for pronunciation score calibration (FivePoint or HundredMark).
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_GradingSystem"] = 61] = "PronunciationAssessment_GradingSystem";
    /**
     * The pronunciation evaluation granularity (Phoneme, Word, or FullText).
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_Granularity"] = 62] = "PronunciationAssessment_Granularity";
    /**
     * Defines if enable miscue calculation.
     * With this enabled, the pronounced words will be compared to the reference text,
     * and will be marked with omission/insertion based on the comparison. The default setting is False.
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_EnableMiscue"] = 63] = "PronunciationAssessment_EnableMiscue";
    /**
     * The json string of pronunciation assessment parameters
     * Under normal circumstances, you shouldn't have to use this property directly.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_Json"] = 64] = "PronunciationAssessment_Json";
    /**
     * Pronunciation assessment parameters.
     * This property is intended to be read-only. The SDK is using it internally.
     * Added in version 1.15.0
     */
    PropertyId[PropertyId["PronunciationAssessment_Params"] = 65] = "PronunciationAssessment_Params";
    /**
     * Version of Speaker Recognition API to use.
     * Added in version 1.18.0
     */
    PropertyId[PropertyId["SpeakerRecognition_Api_Version"] = 66] = "SpeakerRecognition_Api_Version";
})(PropertyId || (PropertyId = {}));

//# sourceMappingURL=PropertyId.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecognitionEventArgs": () => (/* binding */ RecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines payload for session events like Speech Start/End Detected
 * @class
 */
class RecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(offset, sessionId) {
        super(sessionId);
        this.privOffset = offset;
    }
    /**
     * Represents the message offset
     * @member RecognitionEventArgs.prototype.offset
     * @function
     * @public
     */
    get offset() {
        return this.privOffset;
    }
}

//# sourceMappingURL=RecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RecognitionResult": () => (/* binding */ RecognitionResult)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines result of speech recognition.
 * @class RecognitionResult
 */
class RecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} text - The recognized text.
     * @param {number} duration - The duration.
     * @param {number} offset - The offset into the stream.
     * @param {string} language - Primary Language detected, if provided.
     * @param {string} languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param {string} errorDetails - Error details, if provided.
     * @param {string} json - Additional Json, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties) {
        this.privResultId = resultId;
        this.privReason = reason;
        this.privText = text;
        this.privDuration = duration;
        this.privOffset = offset;
        this.privLanguage = language;
        this.privLanguageDetectionConfidence = languageDetectionConfidence;
        this.privErrorDetails = errorDetails;
        this.privJson = json;
        this.privProperties = properties;
    }
    /**
     * Specifies the result identifier.
     * @member RecognitionResult.prototype.resultId
     * @function
     * @public
     * @returns {string} Specifies the result identifier.
     */
    get resultId() {
        return this.privResultId;
    }
    /**
     * Specifies status of the result.
     * @member RecognitionResult.prototype.reason
     * @function
     * @public
     * @returns {ResultReason} Specifies status of the result.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * Presents the recognized text in the result.
     * @member RecognitionResult.prototype.text
     * @function
     * @public
     * @returns {string} Presents the recognized text in the result.
     */
    get text() {
        return this.privText;
    }
    /**
     * Duration of recognized speech in 100 nano second increments.
     * @member RecognitionResult.prototype.duration
     * @function
     * @public
     * @returns {number} Duration of recognized speech in 100 nano second increments.
     */
    get duration() {
        return this.privDuration;
    }
    /**
     * Offset of recognized speech in 100 nano second increments.
     * @member RecognitionResult.prototype.offset
     * @function
     * @public
     * @returns {number} Offset of recognized speech in 100 nano second increments.
     */
    get offset() {
        return this.privOffset;
    }
    /**
     * Primary Language detected.
     * @member RecognitionResult.prototype.language
     * @function
     * @public
     * @returns {string} language detected.
     */
    get language() {
        return this.privLanguage;
    }
    /**
     * Primary Language detection confidence (Unknown, Low, Medium, High).
     * @member RecognitionResult.prototype.languageDetectionConfidence
     * @function
     * @public
     * @returns {string} detection confidence strength.
     */
    get languageDetectionConfidence() {
        return this.privLanguageDetectionConfidence;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member RecognitionResult.prototype.errorDetails
     * @function
     * @public
     * @returns {string} a brief description of an error.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
    /**
     * A string containing Json serialized recognition result as it was received from the service.
     * @member RecognitionResult.prototype.json
     * @function
     * @private
     * @returns {string} Json serialized representation of the result.
     */
    get json() {
        return this.privJson;
    }
    /**
     * The set of properties exposed in the result.
     * @member RecognitionResult.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The set of properties exposed in the result.
     */
    get properties() {
        return this.privProperties;
    }
}

//# sourceMappingURL=RecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Recognizer": () => (/* binding */ Recognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceRecognizerBase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Defines the base class Recognizer which mainly contains common event handlers.
 * @class Recognizer
 */
class Recognizer {
    /**
     * Creates and initializes an instance of a Recognizer
     * @constructor
     * @param {AudioConfig} audioInput - An optional audio input stream associated with the recognizer
     */
    constructor(audioConfig, properties, connectionFactory) {
        this.audioConfig = (audioConfig !== undefined) ? audioConfig : _Exports__WEBPACK_IMPORTED_MODULE_0__.AudioConfig.fromDefaultMicrophoneInput();
        this.privDisposed = false;
        this.privProperties = properties.clone();
        this.privConnectionFactory = connectionFactory;
        this.implCommonRecognizerSetup();
    }
    /**
     * Dispose of associated resources.
     * @member Recognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_2__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * @Internal
     * Internal data member to support fromRecognizer* pattern methods on other classes.
     * Do not use externally, object returned will change without warning or notice.
     */
    get internalData() {
        return this.privReco;
    }
    /**
     * This method performs cleanup of resources.
     * The Boolean parameter disposing indicates whether the method is called
     * from Dispose (if disposing is true) or from the finalizer (if disposing is false).
     * Derived classes should override this method to dispose resource if needed.
     * @member Recognizer.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - Flag to request disposal.
     */
    dispose(disposing) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposed) {
                return;
            }
            this.privDisposed = true;
            if (disposing) {
                if (this.privReco) {
                    yield this.privReco.audioSource.turnOff();
                    yield this.privReco.dispose();
                }
            }
        });
    }
    /**
     * This method returns the current state of the telemetry setting.
     * @member Recognizer.prototype.telemetryEnabled
     * @function
     * @public
     * @returns true if the telemetry is enabled, false otherwise.
     */
    static get telemetryEnabled() {
        return _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ServiceRecognizerBase.telemetryDataEnabled;
    }
    /**
     * This method globally enables or disables telemetry.
     * @member Recognizer.prototype.enableTelemetry
     * @function
     * @public
     * @param enabled - Global setting for telemetry collection.
     * If set to true, telemetry information like microphone errors,
     * recognition errors are collected and sent to Microsoft.
     * If set to false, no telemetry is sent to Microsoft.
     */
    static enableTelemetry(enabled) {
        _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.ServiceRecognizerBase.telemetryDataEnabled = enabled;
    }
    // Does the generic recognizer setup that is common across all recognizer types.
    implCommonRecognizerSetup() {
        let osPlatform = (typeof window !== "undefined") ? "Browser" : "Node";
        let osName = "unknown";
        let osVersion = "unknown";
        if (typeof navigator !== "undefined") {
            osPlatform = osPlatform + "/" + navigator.platform;
            osName = navigator.userAgent;
            osVersion = navigator.appVersion;
        }
        const recognizerConfig = this.createRecognizerConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.SpeechServiceConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.Context(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OS(osPlatform, osName, osVersion))));
        this.privReco = this.createServiceRecognizer(Recognizer.getAuthFromProperties(this.privProperties), this.privConnectionFactory, this.audioConfig, recognizerConfig);
    }
    recognizeOnceAsyncImpl(recognitionMode) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
            const ret = new _common_Exports__WEBPACK_IMPORTED_MODULE_2__.Deferred();
            yield this.implRecognizerStop();
            yield this.privReco.recognize(recognitionMode, ret.resolve, ret.reject);
            const result = yield ret.promise;
            yield this.implRecognizerStop();
            return result;
        });
    }
    startContinuousRecognitionAsyncImpl(recognitionMode) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
            yield this.implRecognizerStop();
            yield this.privReco.recognize(recognitionMode, undefined, undefined);
        });
    }
    stopContinuousRecognitionAsyncImpl() {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposed);
            yield this.implRecognizerStop();
        });
    }
    implRecognizerStop() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privReco) {
                yield this.privReco.stopRecognizing();
            }
            return;
        });
    }
    static getAuthFromProperties(properties) {
        const subscriptionKey = properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceConnection_Key, undefined);
        const authentication = (subscriptionKey && subscriptionKey !== "") ?
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.CognitiveSubscriptionKeyAuthentication(subscriptionKey) :
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.CognitiveTokenAuthentication(() => {
                const authorizationToken = properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            }, () => {
                const authorizationToken = properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            });
        return authentication;
    }
}

//# sourceMappingURL=Recognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ResultReason": () => (/* binding */ ResultReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the possible reasons a recognition result might be generated.
 * @class ResultReason
 */
var ResultReason;
(function (ResultReason) {
    /**
     * Indicates speech could not be recognized. More details
     * can be found in the NoMatchDetails object.
     * @member ResultReason.NoMatch
     */
    ResultReason[ResultReason["NoMatch"] = 0] = "NoMatch";
    /**
     * Indicates that the recognition was canceled. More details
     * can be found using the CancellationDetails object.
     * @member ResultReason.Canceled
     */
    ResultReason[ResultReason["Canceled"] = 1] = "Canceled";
    /**
     * Indicates the speech result contains hypothesis text.
     * @member ResultReason.RecognizedSpeech
     */
    ResultReason[ResultReason["RecognizingSpeech"] = 2] = "RecognizingSpeech";
    /**
     * Indicates the speech result contains final text that has been recognized.
     * Speech Recognition is now complete for this phrase.
     * @member ResultReason.RecognizedSpeech
     */
    ResultReason[ResultReason["RecognizedSpeech"] = 3] = "RecognizedSpeech";
    /**
     * Indicates the speech result contains a finalized acceptance of a provided keyword.
     * Speech recognition will continue unless otherwise configured.
     * @member ResultReason.RecognizedKeyword
     */
    ResultReason[ResultReason["RecognizedKeyword"] = 4] = "RecognizedKeyword";
    /**
     * Indicates the intent result contains hypothesis text and intent.
     * @member ResultReason.RecognizingIntent
     */
    ResultReason[ResultReason["RecognizingIntent"] = 5] = "RecognizingIntent";
    /**
     * Indicates the intent result contains final text and intent.
     * Speech Recognition and Intent determination are now complete for this phrase.
     * @member ResultReason.RecognizedIntent
     */
    ResultReason[ResultReason["RecognizedIntent"] = 6] = "RecognizedIntent";
    /**
     * Indicates the translation result contains hypothesis text and its translation(s).
     * @member ResultReason.TranslatingSpeech
     */
    ResultReason[ResultReason["TranslatingSpeech"] = 7] = "TranslatingSpeech";
    /**
     * Indicates the translation result contains final text and corresponding translation(s).
     * Speech Recognition and Translation are now complete for this phrase.
     * @member ResultReason.TranslatedSpeech
     */
    ResultReason[ResultReason["TranslatedSpeech"] = 8] = "TranslatedSpeech";
    /**
     * Indicates the synthesized audio result contains a non-zero amount of audio data
     * @member ResultReason.SynthesizingAudio
     */
    ResultReason[ResultReason["SynthesizingAudio"] = 9] = "SynthesizingAudio";
    /**
     * Indicates the synthesized audio is now complete for this phrase.
     * @member ResultReason.SynthesizingAudioCompleted
     */
    ResultReason[ResultReason["SynthesizingAudioCompleted"] = 10] = "SynthesizingAudioCompleted";
    /**
     * Indicates the speech synthesis is now started
     * @member ResultReason.SynthesizingAudioStarted
     */
    ResultReason[ResultReason["SynthesizingAudioStarted"] = 11] = "SynthesizingAudioStarted";
    /**
     * Indicates the voice profile is being enrolled and customers need to send more audio to create a voice profile.
     * @member ResultReason.EnrollingVoiceProfile
     */
    ResultReason[ResultReason["EnrollingVoiceProfile"] = 12] = "EnrollingVoiceProfile";
    /**
     * Indicates the voice profile has been enrolled.
     * @member ResultReason.EnrolledVoiceProfile
     */
    ResultReason[ResultReason["EnrolledVoiceProfile"] = 13] = "EnrolledVoiceProfile";
    /**
     * Indicates successful identification of some speakers.
     * @member ResultReason.RecognizedSpeakers
     */
    ResultReason[ResultReason["RecognizedSpeakers"] = 14] = "RecognizedSpeakers";
    /**
     * Indicates successfully verified one speaker.
     * @member ResultReason.RecognizedSpeaker
     */
    ResultReason[ResultReason["RecognizedSpeaker"] = 15] = "RecognizedSpeaker";
    /**
     * Indicates a voice profile has been reset successfully.
     * @member ResultReason.ResetVoiceProfile
     */
    ResultReason[ResultReason["ResetVoiceProfile"] = 16] = "ResetVoiceProfile";
    /**
     * Indicates a voice profile has been deleted successfully.
     * @member ResultReason.DeletedVoiceProfile
     */
    ResultReason[ResultReason["DeletedVoiceProfile"] = 17] = "DeletedVoiceProfile";
    /**
     * Indicates synthesis voices list has been successfully retrieved.
     * @member ResultReason.VoicesListRetrieved
     */
    ResultReason[ResultReason["VoicesListRetrieved"] = 18] = "VoicesListRetrieved";
    /**
     * Indicates the transcription result contains hypothesis text and its translation(s) for
     * other participants in the conversation.
     * @member ResultReason.TranslatingParticipantSpeech
     */
    ResultReason[ResultReason["TranslatingParticipantSpeech"] = 19] = "TranslatingParticipantSpeech";
    /**
     * Indicates the transcription result contains final text and corresponding translation(s)
     * for other participants in the conversation. Speech Recognition and Translation are now
     * complete for this phrase.
     * @member ResultReason.TranslatedParticipantSpeech
     */
    ResultReason[ResultReason["TranslatedParticipantSpeech"] = 20] = "TranslatedParticipantSpeech";
    /**
     * <summary>
     * Indicates the transcription result contains the instant message and corresponding
     * translation(s).
     * @member ResultReason.TranslatedInstantMessage
     */
    ResultReason[ResultReason["TranslatedInstantMessage"] = 21] = "TranslatedInstantMessage";
    /**
     * Indicates the transcription result contains the instant message for other participants
     * in the conversation and corresponding translation(s).
     * @member ResultReason.TranslatedParticipantInstantMessage
     */
    ResultReason[ResultReason["TranslatedParticipantInstantMessage"] = 22] = "TranslatedParticipantInstantMessage";
})(ResultReason || (ResultReason = {}));

//# sourceMappingURL=ResultReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServiceEventArgs.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServiceEventArgs": () => (/* binding */ ServiceEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
//
// Copyright (c) Microsoft. All rights reserved.
// Licensed under the MIT license. See LICENSE.md file in the project root for full license information.
//

/**
 * Defines payload for any Service message event
 * Added in version 1.9.0
 */
class ServiceEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} json - json payload of the USP message.
     */
    constructor(json, name, sessionId) {
        super(sessionId);
        this.privJsonResult = json;
        this.privEventName = name;
    }
    get jsonString() {
        return this.privJsonResult;
    }
    get eventName() {
        return this.privEventName;
    }
}

//# sourceMappingURL=ServiceEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js":
/*!**************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ServicePropertyChannel": () => (/* binding */ ServicePropertyChannel)
/* harmony export */ });
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
/**
 * Defines channels used to pass property settings to service.
 * Added in version 1.7.0.
 */
var ServicePropertyChannel;
(function (ServicePropertyChannel) {
    /**
     * Uses URI query parameter to pass property settings to service.
     */
    ServicePropertyChannel[ServicePropertyChannel["UriQueryParameter"] = 0] = "UriQueryParameter";
})(ServicePropertyChannel || (ServicePropertyChannel = {}));

//# sourceMappingURL=ServicePropertyChannel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SessionEventArgs": () => (/* binding */ SessionEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines content for session events like SessionStarted/Stopped, SoundStarted/Stopped.
 * @class SessionEventArgs
 */
class SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} sessionId - The session id.
     */
    constructor(sessionId) {
        this.privSessionId = sessionId;
    }
    /**
     * Represents the session identifier.
     * @member SessionEventArgs.prototype.sessionId
     * @function
     * @public
     * @returns {string} Represents the session identifier.
     */
    get sessionId() {
        return this.privSessionId;
    }
}

//# sourceMappingURL=SessionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SourceLanguageConfig.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SourceLanguageConfig.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SourceLanguageConfig": () => (/* binding */ SourceLanguageConfig)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Source Language configuration.
 * @class SourceLanguageConfig
 */
class SourceLanguageConfig {
    constructor(language, endpointId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(language, "language");
        this.privLanguage = language;
        this.privEndpointId = endpointId;
    }
    /**
     * @member SourceLanguageConfig.fromLanguage
     * @function
     * @public
     * @param {string} language language (eg. "en-US") value of config.
     * @param {string?} endpointId endpointId of model bound to given language of config.
     * @return {SourceLanguageConfig} Instance of SourceLanguageConfig
     * @summary Creates an instance of the SourceLanguageConfig with the given language and optional endpointId.
     * Added in version 1.13.0.
     */
    static fromLanguage(language, endpointId) {
        return new SourceLanguageConfig(language, endpointId);
    }
    get language() {
        return this.privLanguage;
    }
    get endpointId() {
        return this.privEndpointId;
    }
}

//# sourceMappingURL=SourceLanguageConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerIdentificationModel.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerIdentificationModel.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerIdentificationModel": () => (/* binding */ SpeakerIdentificationModel)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Defines SpeakerIdentificationModel class for Speaker Recognition
 * Model contains a set of profiles against which to identify speaker(s)
 * @class SpeakerIdentificationModel
 */
class SpeakerIdentificationModel {
    constructor(profiles) {
        this.privVoiceProfiles = [];
        this.privProfileIds = [];
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(profiles, "VoiceProfiles");
        if (profiles.length === 0) {
            throw new Error("Empty Voice Profiles array");
        }
        for (const profile of profiles) {
            if (profile.profileType !== _Exports__WEBPACK_IMPORTED_MODULE_1__.VoiceProfileType.TextIndependentIdentification) {
                throw new Error("Identification model can only be created from Identification profile: " + profile.profileId);
            }
            this.privVoiceProfiles.push(profile);
            this.privProfileIds.push(profile.profileId);
        }
    }
    static fromProfiles(profiles) {
        return new SpeakerIdentificationModel(profiles);
    }
    get voiceProfileIds() {
        return this.privProfileIds.join(",");
    }
    get profileIds() {
        return this.privProfileIds;
    }
    get scenario() {
        return "TextIndependentIdentification";
    }
}

//# sourceMappingURL=SpeakerIdentificationModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognitionResult.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognitionCancellationDetails": () => (/* binding */ SpeakerRecognitionCancellationDetails),
/* harmony export */   "SpeakerRecognitionResult": () => (/* binding */ SpeakerRecognitionResult),
/* harmony export */   "SpeakerRecognitionResultType": () => (/* binding */ SpeakerRecognitionResultType)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


var SpeakerRecognitionResultType;
(function (SpeakerRecognitionResultType) {
    SpeakerRecognitionResultType[SpeakerRecognitionResultType["Verify"] = 0] = "Verify";
    SpeakerRecognitionResultType[SpeakerRecognitionResultType["Identify"] = 1] = "Identify";
})(SpeakerRecognitionResultType || (SpeakerRecognitionResultType = {}));
/**
 * Output format
 * @class SpeakerRecognitionResult
 */
class SpeakerRecognitionResult {
    constructor(response, resultReason = _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.RecognizedSpeaker, cancellationErrorCode = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode.NoError, errorDetails = "") {
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        const resultType = response.scenario === "TextIndependentIdentification" ? SpeakerRecognitionResultType.Identify : SpeakerRecognitionResultType.Verify;
        this.privReason = resultReason;
        if (this.privReason !== _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.Canceled) {
            if (resultType === SpeakerRecognitionResultType.Identify) {
                this.privProfileId = response.identificationResult.identifiedProfile.profileId;
                this.privScore = response.identificationResult.identifiedProfile.score;
                this.privReason = _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.RecognizedSpeakers;
            }
            else {
                this.privScore = response.verificationResult.score;
                if (response.verificationResult.recognitionResult.toLowerCase() !== "accept") {
                    this.privReason = _Exports__WEBPACK_IMPORTED_MODULE_0__.ResultReason.NoMatch;
                }
                if (response.verificationResult.profileId !== undefined && response.verificationResult.profileId !== "") {
                    this.privProfileId = response.verificationResult.profileId;
                }
            }
        }
        else {
            this.privErrorDetails = errorDetails;
            this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode[cancellationErrorCode]);
        }
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceResponse_JsonResult, JSON.stringify(response));
    }
    get properties() {
        return this.privProperties;
    }
    get reason() {
        return this.privReason;
    }
    get profileId() {
        return this.privProfileId;
    }
    get errorDetails() {
        return this.privErrorDetails;
    }
    get score() {
        return this.privScore;
    }
}
/**
 * @class SpeakerRecognitionCancellationDetails
 */
class SpeakerRecognitionCancellationDetails extends _Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of SpeakerRecognitionCancellationDetails object for the canceled SpeakerRecognitionResult
     * @member SpeakerRecognitionCancellationDetails.fromResult
     * @function
     * @public
     * @param {SpeakerRecognitionResult} result - The result that was canceled.
     * @returns {SpeakerRecognitionCancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        const reason = _Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode.NoError;
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_1__.CancellationErrorCode.NoError])];
        }
        return new SpeakerRecognitionCancellationDetails(reason, result.errorDetails, errorCode);
    }
}

//# sourceMappingURL=SpeakerRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognizer.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerRecognizer.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerRecognizer": () => (/* binding */ SpeakerRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerServiceRecognizer.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};



/**
 * Defines SpeakerRecognizer class for Speaker Recognition
 * Handles operations from user for Voice Profile operations (e.g. createProfile, deleteProfile)
 * @class SpeakerRecognizer
 */
class SpeakerRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the SpeakerRecognizer.
     * @constructor
     * @param {SpeechConfig} speechConfig - The set of configuration properties.
     * @param {AudioConfig} audioConfig - An optional audio input config associated with the recognizer
     */
    constructor(speechConfig, audioConfig) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(speechConfig, "speechConfig");
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(configImpl, "speechConfig");
        super(audioConfig, configImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeakerRecognitionConnectionFactory());
        this.privAudioConfigImpl = audioConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(this.privAudioConfigImpl, "audioConfig");
        this.privDisposedSpeakerRecognizer = false;
        this.privProperties = configImpl.properties;
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member SpeakerRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member SpeakerRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * The collection of properties and their values defined for this SpeakerRecognizer.
     * @member SpeakerRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeakerRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Get recognition result for model using given audio
     * @member SpeakerRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @async
     * @param {SpeakerIdentificationModel | SpeakerVerificationModel} model Model containing Voice Profiles to be identified
     * @param cb - Callback invoked once result is returned.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(model) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer);
            return this.recognizeSpeakerOnceAsyncImpl(model);
        });
    }
    /**
     * Included for compatibility
     * @member SpeakerRecognizer.prototype.close
     * @function
     * @public
     * @async
     */
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer);
            yield this.dispose(true);
        });
    }
    recognizeSpeakerOnceAsyncImpl(model) {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer);
            yield this.implRecognizerStop();
            const result = yield this.privReco.recognizeSpeaker(model);
            yield this.implRecognizerStop();
            return result;
        });
    }
    implRecognizerStop() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privReco) {
                yield this.privReco.stopRecognizing();
            }
            return;
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.SpeakerServiceRecognizer(authentication, connectionFactory, audioImpl, recognizerConfig, this);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedSpeakerRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedSpeakerRecognizer = true;
                yield _super.dispose.call(this, disposing);
            }
        });
    }
}

//# sourceMappingURL=SpeakerRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerVerificationModel.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeakerVerificationModel.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeakerVerificationModel": () => (/* binding */ SpeakerVerificationModel)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Defines SpeakerVerificationModel class for Speaker Recognition
 * Model contains a profile against which to verify a speaker
 * @class SpeakerVerificationModel
 */
class SpeakerVerificationModel {
    constructor(profile) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(profile, "VoiceProfile");
        if (profile.profileType === _Exports__WEBPACK_IMPORTED_MODULE_1__.VoiceProfileType.TextIndependentIdentification) {
            throw new Error("Verification model cannot be created from Identification profile");
        }
        this.privVoiceProfile = profile;
    }
    static fromProfile(profile) {
        return new SpeakerVerificationModel(profile);
    }
    get voiceProfile() {
        return this.privVoiceProfile;
    }
    get profileIds() {
        return [this.voiceProfile.profileId];
    }
    get scenario() {
        if (this.voiceProfile.profileType === _Exports__WEBPACK_IMPORTED_MODULE_1__.VoiceProfileType.TextDependentVerification) {
            return "TextDependentVerification";
        }
        else {
            return "TextIndependentVerification";
        }
    }
}

//# sourceMappingURL=SpeakerVerificationModel.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechConfig": () => (/* binding */ SpeechConfig),
/* harmony export */   "SpeechConfigImpl": () => (/* binding */ SpeechConfigImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */



/**
 * Speech configuration.
 * @class SpeechConfig
 */
class SpeechConfig {
    /**
     * Creates and initializes an instance.
     * @constructor
     */
    constructor() {
        return;
    }
    /**
     * Static instance of SpeechConfig returned by passing subscriptionKey and service region.
     * Note: Please use your LanguageUnderstanding subscription key in case you want to use the Intent recognizer.
     * @member SpeechConfig.fromSubscription
     * @function
     * @public
     * @param {string} subscriptionKey - The subscription key.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechConfig} The speech factory
     */
    static fromSubscription(subscriptionKey, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(subscriptionKey, "subscriptionKey");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(region, "region");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, region);
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_IntentRegion, region);
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        return speechImpl;
    }
    /**
     * Creates an instance of the speech config with specified endpoint and subscription key.
     * This method is intended only for users who use a non-standard service endpoint or parameters.
     * Note: Please use your LanguageUnderstanding subscription key in case you want to use the Intent recognizer.
     * Note: The query parameters specified in the endpoint URL are not changed, even if they are set by any other APIs.
     * For example, if language is defined in the uri as query parameter "language=de-DE", and also set by
     * SpeechConfig.speechRecognitionLanguage = "en-US", the language setting in uri takes precedence,
     * and the effective language is "de-DE". Only the parameters that are not specified in the
     * endpoint URL can be set by other APIs.
     * Note: To use authorization token with fromEndpoint, pass an empty string to the subscriptionKey in the
     * fromEndpoint method, and then set authorizationToken="token" on the created SpeechConfig instance to
     * use the authorization token.
     * @member SpeechConfig.fromEndpoint
     * @function
     * @public
     * @param {URL} endpoint - The service endpoint to connect to.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization token must be set.
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromEndpoint(endpoint, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(endpoint, "endpoint");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint, endpoint.href);
        if (undefined !== subscriptionKey) {
            speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return speechImpl;
    }
    /**
     * Creates an instance of the speech config with specified host and subscription key.
     * This method is intended only for users who use a non-default service host. Standard resource path will be assumed.
     * For services with a non-standard resource path or no path at all, use fromEndpoint instead.
     * Note: Query parameters are not allowed in the host URI and must be set by other APIs.
     * Note: To use an authorization token with fromHost, use fromHost(URL),
     * and then set the AuthorizationToken property on the created SpeechConfig instance.
     * Note: Added in version 1.9.0.
     * @member SpeechConfig.fromHost
     * @function
     * @public
     * @param {URL} host - The service endpoint to connect to. Format is "protocol://host:port" where ":port" is optional.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization token must be set.
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromHost(hostName, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(hostName, "hostName");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Host, hostName.protocol + "//" + hostName.hostname + (hostName.port === "" ? "" : ":" + hostName.port));
        if (undefined !== subscriptionKey) {
            speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return speechImpl;
    }
    /**
     * Creates an instance of the speech factory with specified initial authorization token and region.
     * Note: The caller needs to ensure that the authorization token is valid. Before the authorization token
     * expires, the caller needs to refresh it by calling this setter with a new valid token.
     * Note: Please use a token derived from your LanguageUnderstanding subscription key in case you want
     * to use the Intent recognizer. As configuration values are copied when creating a new recognizer,
     * the new token value will not apply to recognizers that have already been created. For recognizers
     * that have been created before, you need to set authorization token of the corresponding recognizer
     * to refresh the token. Otherwise, the recognizers will encounter errors during recognition.
     * @member SpeechConfig.fromAuthorizationToken
     * @function
     * @public
     * @param {string} authorizationToken - The initial authorization token.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromAuthorizationToken(authorizationToken, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(region, "region");
        const speechImpl = new SpeechConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region, region);
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_IntentRegion, region);
        speechImpl.authorizationToken = authorizationToken;
        return speechImpl;
    }
    /**
     * Closes the configuration.
     * @member SpeechConfig.prototype.close
     * @function
     * @public
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    close() { }
}
/**
 * @public
 * @class SpeechConfigImpl
 */
class SpeechConfigImpl extends SpeechConfig {
    constructor() {
        super();
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection();
        this.speechRecognitionLanguage = "en-US"; // Should we have a default?
        this.outputFormat = _Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormat.Simple;
    }
    get properties() {
        return this.privProperties;
    }
    get endPoint() {
        return new URL(this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Endpoint));
    }
    get subscriptionKey() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Key);
    }
    get region() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_Region);
    }
    get authorizationToken() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceAuthorization_Token);
    }
    set authorizationToken(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    get speechRecognitionLanguage() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    set speechRecognitionLanguage(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_RecoLanguage, value);
    }
    get autoDetectSourceLanguages() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages);
    }
    set autoDetectSourceLanguages(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages, value);
    }
    get outputFormat() {
        return _Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormat[this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, undefined)];
    }
    set outputFormat(value) {
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, _Exports__WEBPACK_IMPORTED_MODULE_3__.OutputFormat[value]);
    }
    get endpointId() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId);
    }
    set endpointId(value) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EndpointId, value);
    }
    setProperty(name, value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(value, "value");
        this.privProperties.setProperty(name, value);
    }
    getProperty(name, def) {
        return this.privProperties.getProperty(name, def);
    }
    setProxy(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyHostName], proxyHostName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyPort], proxyPort);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyUserName], proxyUserName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_ProxyPassword], proxyPassword);
    }
    setServiceProperty(name, value) {
        const currentProperties = JSON.parse(this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ServicePropertiesPropertyName, "{}"));
        currentProperties[name] = value;
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ServicePropertiesPropertyName, JSON.stringify(currentProperties));
    }
    setProfanity(profanity) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_ProfanityOption, _Exports__WEBPACK_IMPORTED_MODULE_5__.ProfanityOption[profanity]);
    }
    enableAudioLogging() {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_EnableAudioLogging, "true");
    }
    requestWordLevelTimestamps() {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, "true");
    }
    enableDictation() {
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ForceDictationPropertyName, "true");
    }
    clone() {
        const ret = new SpeechConfigImpl();
        ret.privProperties = this.privProperties.clone();
        return ret;
    }
    get speechSynthesisLanguage() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthLanguage);
    }
    set speechSynthesisLanguage(language) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthLanguage, language);
    }
    get speechSynthesisVoiceName() {
        return this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthVoice);
    }
    set speechSynthesisVoiceName(voice) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthVoice, voice);
    }
    get speechSynthesisOutputFormat() {
        return _Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechSynthesisOutputFormat[this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)];
    }
    set speechSynthesisOutputFormat(format) {
        this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_1__.PropertyId.SpeechServiceConnection_SynthOutputFormat, _Exports__WEBPACK_IMPORTED_MODULE_6__.SpeechSynthesisOutputFormat[format]);
    }
}

//# sourceMappingURL=SpeechConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionCanceledEventArgs.js ***!
  \**************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechRecognitionCanceledEventArgs": () => (/* binding */ SpeechRecognitionCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CancellationEventArgsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

class SpeechRecognitionCanceledEventArgs extends _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationEventArgsBase {
}

//# sourceMappingURL=SpeechRecognitionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionEventArgs.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranscriptionEventArgs": () => (/* binding */ ConversationTranscriptionEventArgs),
/* harmony export */   "SpeechRecognitionEventArgs": () => (/* binding */ SpeechRecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */

/**
 * Defines contents of speech recognizing/recognized event.
 * @class SpeechRecognitionEventArgs
 */
class SpeechRecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {SpeechRecognitionResult} result - The speech recognition result.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the recognition result.
     * @member SpeechRecognitionEventArgs.prototype.result
     * @function
     * @public
     * @returns {SpeechRecognitionResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
}
/**
 * Defines contents of conversation transcribed/transcribing event.
 * @class ConversationTranscriptionEventArgs
 */
class ConversationTranscriptionEventArgs extends SpeechRecognitionEventArgs {
}

//# sourceMappingURL=SpeechRecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechRecognitionResult": () => (/* binding */ SpeechRecognitionResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines result of speech recognition.
 * @class SpeechRecognitionResult
 */
class SpeechRecognitionResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @public
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} text - The recognized text.
     * @param {number} duration - The duration.
     * @param {number} offset - The offset into the stream.
     * @param {string} language - Primary Language detected, if provided.
     * @param {string} languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param {string} speakerId - speaker id for conversation transcription, if provided.
     * @param {string} errorDetails - Error details, if provided.
     * @param {string} json - Additional Json, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(resultId, reason, text, duration, offset, language, languageDetectionConfidence, speakerId, errorDetails, json, properties) {
        super(resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties);
        this.privSpeakerId = speakerId;
    }
    /**
     * speaker id from conversation transcription/id scenarios
     * @member SpeechRecognitionResult.prototype.speakerId
     * @function
     * @public
     * @returns {string} id of speaker in given result
     */
    get speakerId() {
        return this.privSpeakerId;
    }
}

//# sourceMappingURL=SpeechRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognizer.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognizer.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechRecognizer": () => (/* binding */ SpeechRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechServiceRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Performs speech recognition from microphone, file, or other audio input streams, and gets transcribed text as result.
 * @class SpeechRecognizer
 */
class SpeechRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * SpeechRecognizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - an set of initial properties for this recognizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    constructor(speechConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(speechConfigImpl, "speechConfig");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(speechConfigImpl.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage), _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        super(audioConfig, speechConfigImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.SpeechConnectionFactory());
        this.privDisposedRecognizer = false;
    }
    /**
     * SpeechRecognizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - an set of initial properties for this recognizer
     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the recognizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    static FromConfig(speechConfig, autoDetectSourceLanguageConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        autoDetectSourceLanguageConfig.properties.mergeTo(speechConfigImpl.properties);
        const recognizer = new SpeechRecognizer(speechConfig, audioConfig);
        return recognizer;
    }
    /**
     * Gets the endpoint id of a customized speech model that is used for speech recognition.
     * @member SpeechRecognizer.prototype.endpointId
     * @function
     * @public
     * @returns {string} the endpoint id of a customized speech model that is used for speech recognition.
     */
    get endpointId() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EndpointId, "00000000-0000-0000-0000-000000000000");
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member SpeechRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member SpeechRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * Gets the spoken language of recognition.
     * @member SpeechRecognizer.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} The spoken language of recognition.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * Gets the output format of recognition.
     * @member SpeechRecognizer.prototype.outputFormat
     * @function
     * @public
     * @returns {OutputFormat} The output format of recognition.
     */
    get outputFormat() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        if (this.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormatPropertyName, _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat[_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple]) === _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat[_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple]) {
            return _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Simple;
        }
        else {
            return _Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormat.Detailed;
        }
    }
    /**
     * The collection of properties and their values defined for this SpeechRecognizer.
     * @member SpeechRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeechRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Starts speech recognition, and stops after the first utterance is recognized.
     * The task returns the recognition text as result.
     * Note: RecognizeOnceAsync() returns when the first utterance has been recognized,
     * so it is suitable only for single shot recognition
     * like command or query. For long-running recognition, use StartContinuousRecognitionAsync() instead.
     * @member SpeechRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the SpeechRecognitionResult.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognitionMode.Interactive), cb, err);
    }
    /**
     * Starts speech recognition, until stopContinuousRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * @member SpeechRecognizer.prototype.startContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Stops continuous speech recognition.
     * @member SpeechRecognizer.prototype.stopContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    /**
     * Starts speech recognition with keyword spotting, until
     * stopKeywordRecognitionAsync() is called.
     * User must subscribe to events to receive recognition results.
     * Note: Key word spotting functionality is only available on the
     * Speech Devices SDK. This functionality is currently not included in the SDK itself.
     * @member SpeechRecognizer.prototype.startKeywordRecognitionAsync
     * @function
     * @public
     * @param {KeywordRecognitionModel} model The keyword recognition model that
     * specifies the keyword to be recognized.
     * @param cb - Callback invoked once the recognition has started.
     * @param err - Callback invoked in case of an error.
     */
    startKeywordRecognitionAsync(model, cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(model, "model");
        if (!!err) {
            err("Not yet implemented.");
        }
    }
    /**
     * Stops continuous speech recognition.
     * Note: Key word spotting functionality is only available on the
     * Speech Devices SDK. This functionality is currently not included in the SDK itself.
     * @member SpeechRecognizer.prototype.stopKeywordRecognitionAsync
     * @function
     * @public
     * @param cb - Callback invoked once the recognition has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopKeywordRecognitionAsync(cb) {
        if (!!cb) {
            cb();
        }
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member SpeechRecognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * Disposes any resources held by the object.
     * @member SpeechRecognizer.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - true if disposing the object.
     */
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedRecognizer) {
                return;
            }
            if (disposing) {
                this.privDisposedRecognizer = true;
                yield this.implRecognizerStop();
            }
            yield _super.dispose.call(this, disposing);
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const configImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.SpeechServiceRecognizer(authentication, connectionFactory, configImpl, recognizerConfig, this);
    }
}

//# sourceMappingURL=SpeechRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBookmarkEventArgs.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisBookmarkEventArgs": () => (/* binding */ SpeechSynthesisBookmarkEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis bookmark event.
 * @class SpeechSynthesisBookmarkEventArgs
 * Added in version 1.16.0
 */
class SpeechSynthesisBookmarkEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} audioOffset - The audio offset.
     * @param {string} text - The bookmark text.
     */
    constructor(audioOffset, text) {
        this.privAudioOffset = audioOffset;
        this.privText = text;
    }
    /**
     * Specifies the audio offset.
     * @member SpeechSynthesisBookmarkEventArgs.prototype.audioOffset
     * @function
     * @public
     * @returns {number} the audio offset.
     */
    get audioOffset() {
        return this.privAudioOffset;
    }
    /**
     * Specifies the bookmark.
     * @member SpeechSynthesisBookmarkEventArgs.prototype.text
     * @function
     * @public
     * @returns {string} the bookmark text.
     */
    get text() {
        return this.privText;
    }
}

//# sourceMappingURL=SpeechSynthesisBookmarkEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBoundaryType.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisBoundaryType.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisBoundaryType": () => (/* binding */ SpeechSynthesisBoundaryType)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the boundary type of speech synthesis boundary event.
 * @class SpeechSynthesisBoundaryType
 * Added in version 1.21.0
 */
var SpeechSynthesisBoundaryType;
(function (SpeechSynthesisBoundaryType) {
    /**
     * Indicates the boundary text is a word.
     * @member SpeechSynthesisBoundaryType.Word
     */
    SpeechSynthesisBoundaryType["Word"] = "WordBoundary";
    /**
     * Indicates the boundary text is a punctuation.
     * @member SpeechSynthesisBoundaryType.Punctuation
     */
    SpeechSynthesisBoundaryType["Punctuation"] = "PunctuationBoundary";
    /**
     * Indicates the boundary text is a sentence.
     * @member SpeechSynthesisBoundaryType.Sentence
     */
    SpeechSynthesisBoundaryType["Sentence"] = "SentenceBoundary";
})(SpeechSynthesisBoundaryType || (SpeechSynthesisBoundaryType = {}));

//# sourceMappingURL=SpeechSynthesisBoundaryType.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisEventArgs.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisEventArgs": () => (/* binding */ SpeechSynthesisEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis events.
 * @class SpeechSynthesisEventArgs
 * Added in version 1.11.0
 */
class SpeechSynthesisEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {SpeechSynthesisResult} result - The speech synthesis result.
     */
    constructor(result) {
        this.privResult = result;
    }
    /**
     * Specifies the synthesis result.
     * @member SpeechSynthesisEventArgs.prototype.result
     * @function
     * @public
     * @returns {SpeechSynthesisResult} the synthesis result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=SpeechSynthesisEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisOutputFormat": () => (/* binding */ SpeechSynthesisOutputFormat)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Define speech synthesis audio output formats.
 * @enum SpeechSynthesisOutputFormat
 * Updated in version 1.17.0
 */
var SpeechSynthesisOutputFormat;
(function (SpeechSynthesisOutputFormat) {
    /**
     * raw-8khz-8bit-mono-mulaw
     * @member SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw,
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw8Khz8BitMonoMULaw"] = 0] = "Raw8Khz8BitMonoMULaw";
    /**
     * riff-16khz-16kbps-mono-siren
     * @note Unsupported by the service. Do not use this value.
     * @member SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff16Khz16KbpsMonoSiren"] = 1] = "Riff16Khz16KbpsMonoSiren";
    /**
     * audio-16khz-16kbps-mono-siren
     * @note Unsupported by the service. Do not use this value.
     * @member SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz16KbpsMonoSiren"] = 2] = "Audio16Khz16KbpsMonoSiren";
    /**
     * audio-16khz-32kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz32KBitRateMonoMp3"] = 3] = "Audio16Khz32KBitRateMonoMp3";
    /**
     * audio-16khz-128kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz128KBitRateMonoMp3"] = 4] = "Audio16Khz128KBitRateMonoMp3";
    /**
     * audio-16khz-64kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz64KBitRateMonoMp3"] = 5] = "Audio16Khz64KBitRateMonoMp3";
    /**
     * audio-24khz-48kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz48KBitRateMonoMp3"] = 6] = "Audio24Khz48KBitRateMonoMp3";
    /**
     * audio-24khz-96kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz96KBitRateMonoMp3"] = 7] = "Audio24Khz96KBitRateMonoMp3";
    /**
     * audio-24khz-160kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz160KBitRateMonoMp3"] = 8] = "Audio24Khz160KBitRateMonoMp3";
    /**
     * raw-16khz-16bit-mono-truesilk
     * @member SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw16Khz16BitMonoTrueSilk"] = 9] = "Raw16Khz16BitMonoTrueSilk";
    /**
     * riff-16khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff16Khz16BitMonoPcm"] = 10] = "Riff16Khz16BitMonoPcm";
    /**
     * riff-8khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff8Khz16BitMonoPcm"] = 11] = "Riff8Khz16BitMonoPcm";
    /**
     * riff-24khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff24Khz16BitMonoPcm"] = 12] = "Riff24Khz16BitMonoPcm";
    /**
     * riff-8khz-8bit-mono-mulaw
     * @member SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff8Khz8BitMonoMULaw"] = 13] = "Riff8Khz8BitMonoMULaw";
    /**
     * raw-16khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw16Khz16BitMonoPcm"] = 14] = "Raw16Khz16BitMonoPcm";
    /**
     * raw-24khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw24Khz16BitMonoPcm"] = 15] = "Raw24Khz16BitMonoPcm";
    /**
     * raw-8khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw8Khz16BitMonoPcm"] = 16] = "Raw8Khz16BitMonoPcm";
    /**
     * ogg-16khz-16bit-mono-opus
     * @member SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Ogg16Khz16BitMonoOpus"] = 17] = "Ogg16Khz16BitMonoOpus";
    /**
     * ogg-24khz-16bit-mono-opus
     * @member SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Ogg24Khz16BitMonoOpus"] = 18] = "Ogg24Khz16BitMonoOpus";
    /**
     * raw-48khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw48Khz16BitMonoPcm"] = 19] = "Raw48Khz16BitMonoPcm";
    /**
     * riff-48khz-16bit-mono-pcm
     * @member SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff48Khz16BitMonoPcm"] = 20] = "Riff48Khz16BitMonoPcm";
    /**
     * audio-48khz-96kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio48Khz96KBitRateMonoMp3"] = 21] = "Audio48Khz96KBitRateMonoMp3";
    /**
     * audio-48khz-192kbitrate-mono-mp3
     * @member SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio48Khz192KBitRateMonoMp3"] = 22] = "Audio48Khz192KBitRateMonoMp3";
    /**
     * ogg-48khz-16bit-mono-opus
     * Added in version 1.16.0
     * @member SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Ogg48Khz16BitMonoOpus"] = 23] = "Ogg48Khz16BitMonoOpus";
    /**
     * webm-16khz-16bit-mono-opus
     * Added in version 1.16.0
     * @member SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Webm16Khz16BitMonoOpus"] = 24] = "Webm16Khz16BitMonoOpus";
    /**
     * webm-24khz-16bit-mono-opus
     * Added in version 1.16.0
     * @member SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Webm24Khz16BitMonoOpus"] = 25] = "Webm24Khz16BitMonoOpus";
    /**
     * raw-24khz-16bit-mono-truesilk
     * Added in version 1.17.0
     * @member SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw24Khz16BitMonoTrueSilk"] = 26] = "Raw24Khz16BitMonoTrueSilk";
    /**
     * raw-8khz-8bit-mono-alaw
     * Added in version 1.17.0
     * @member SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw8Khz8BitMonoALaw"] = 27] = "Raw8Khz8BitMonoALaw";
    /**
     * riff-8khz-8bit-mono-alaw
     * Added in version 1.17.0
     * @member SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff8Khz8BitMonoALaw"] = 28] = "Riff8Khz8BitMonoALaw";
    /**
     * webm-24khz-16bit-24kbps-mono-opus
     * Audio compressed by OPUS codec in a webm container, with bitrate of 24kbps, optimized for IoT scenario.
     * Added in version 1.19.0
     * @member SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Webm24Khz16Bit24KbpsMonoOpus"] = 29] = "Webm24Khz16Bit24KbpsMonoOpus";
    /**
     * audio-16khz-16bit-32kbps-mono-opus
     * Audio compressed by OPUS codec without container, with bitrate of 32kbps.
     * Added in version 1.20.0
     * @member SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio16Khz16Bit32KbpsMonoOpus"] = 30] = "Audio16Khz16Bit32KbpsMonoOpus";
    /**
     * audio-24khz-16bit-48kbps-mono-opus
     * Audio compressed by OPUS codec without container, with bitrate of 48kbps.
     * Added in version 1.20.0
     * @member SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz16Bit48KbpsMonoOpus"] = 31] = "Audio24Khz16Bit48KbpsMonoOpus";
    /**
     * audio-24khz-16bit-24kbps-mono-opus
     * Audio compressed by OPUS codec without container, with bitrate of 24kbps.
     * Added in version 1.20.0
     * @member SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Audio24Khz16Bit24KbpsMonoOpus"] = 32] = "Audio24Khz16Bit24KbpsMonoOpus";
    /**
     * raw-22050hz-16bit-mono-pcm
     * Raw PCM audio at 22050Hz sampling rate and 16-bit depth.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw22050Hz16BitMonoPcm"] = 33] = "Raw22050Hz16BitMonoPcm";
    /**
     * riff-22050hz-16bit-mono-pcm
     * PCM audio at 22050Hz sampling rate and 16-bit depth, with RIFF header.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff22050Hz16BitMonoPcm"] = 34] = "Riff22050Hz16BitMonoPcm";
    /**
     * raw-44100hz-16bit-mono-pcm
     * Raw PCM audio at 44100Hz sampling rate and 16-bit depth.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Raw44100Hz16BitMonoPcm"] = 35] = "Raw44100Hz16BitMonoPcm";
    /**
     * riff-44100hz-16bit-mono-pcm
     * PCM audio at 44100Hz sampling rate and 16-bit depth, with RIFF header.
     * Added in version 1.22.0
     * @member SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm
     */
    SpeechSynthesisOutputFormat[SpeechSynthesisOutputFormat["Riff44100Hz16BitMonoPcm"] = 36] = "Riff44100Hz16BitMonoPcm";
})(SpeechSynthesisOutputFormat || (SpeechSynthesisOutputFormat = {}));

//# sourceMappingURL=SpeechSynthesisOutputFormat.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisResult.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisResult": () => (/* binding */ SpeechSynthesisResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines result of speech synthesis.
 * @class SpeechSynthesisResult
 * Added in version 1.11.0
 */
class SpeechSynthesisResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {ArrayBuffer} audioData - The synthesized audio binary.
     * @param {string} errorDetails - Error details, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     * @param {number} audioDuration - The audio duration.
     */
    constructor(resultId, reason, audioData, errorDetails, properties, audioDuration) {
        super(resultId, reason, errorDetails, properties);
        this.privAudioData = audioData;
        this.privAudioDuration = audioDuration;
    }
    /**
     * The synthesized audio data
     * @member SpeechSynthesisResult.prototype.audioData
     * @function
     * @public
     * @returns {ArrayBuffer} The synthesized audio data.
     */
    get audioData() {
        return this.privAudioData;
    }
    /**
     * The time duration of synthesized audio, in ticks (100 nanoseconds).
     * @member SpeechSynthesisResult.prototype.audioDuration
     * @function
     * @public
     * @returns {number} The time duration of synthesized audio.
     */
    get audioDuration() {
        return this.privAudioDuration;
    }
}

//# sourceMappingURL=SpeechSynthesisResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js":
/*!**********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisVisemeEventArgs.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisVisemeEventArgs": () => (/* binding */ SpeechSynthesisVisemeEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis viseme event.
 * @class SpeechSynthesisVisemeEventArgs
 * Added in version 1.16.0
 */
class SpeechSynthesisVisemeEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} audioOffset - The audio offset.
     * @param {number} visemeId - The viseme ID.
     * @param {string} animation - The animation, could be in svg or other format.
     */
    constructor(audioOffset, visemeId, animation) {
        this.privAudioOffset = audioOffset;
        this.privVisemeId = visemeId;
        this.privAnimation = animation;
    }
    /**
     * Specifies the audio offset.
     * @member SpeechSynthesisVisemeEventArgs.prototype.audioOffset
     * @function
     * @public
     * @returns {number} the audio offset.
     */
    get audioOffset() {
        return this.privAudioOffset;
    }
    /**
     * Specifies the viseme ID.
     * @member SpeechSynthesisVisemeEventArgs.prototype.visemeId
     * @function
     * @public
     * @returns {number} the viseme ID.
     */
    get visemeId() {
        return this.privVisemeId;
    }
    /**
     * Specifies the animation.
     * @member SpeechSynthesisVisemeEventArgs.prototype.animation
     * @function
     * @public
     * @returns {string} the animation, could be in svg or other format.
     */
    get animation() {
        return this.privAnimation;
    }
}

//# sourceMappingURL=SpeechSynthesisVisemeEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisWordBoundaryEventArgs.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesisWordBoundaryEventArgs": () => (/* binding */ SpeechSynthesisWordBoundaryEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines contents of speech synthesis word boundary event.
 * @class SpeechSynthesisWordBoundaryEventArgs
 * Added in version 1.11.0
 */
class SpeechSynthesisWordBoundaryEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {number} audioOffset - The audio offset.
     * @param {number} duration - The audio duration.
     * @param {string} text - The text.
     * @param {number} wordLength - The length of the word.
     * @param {number} textOffset - The text offset.
     * @param {SpeechSynthesisBoundaryType} boundaryType - The boundary type
     */
    constructor(audioOffset, duration, text, wordLength, textOffset, boundaryType) {
        this.privAudioOffset = audioOffset;
        this.privDuration = duration;
        this.privText = text;
        this.privWordLength = wordLength;
        this.privTextOffset = textOffset;
        this.privBoundaryType = boundaryType;
    }
    /**
     * Specifies the audio offset.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.audioOffset
     * @function
     * @public
     * @returns {number} the audio offset.
     */
    get audioOffset() {
        return this.privAudioOffset;
    }
    /**
     * Specifies the duration, in ticks (100 nanoseconds).
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.duration
     * @function
     * @public
     * @returns {number} Duration in 100 nanosecond increments.
     */
    get duration() {
        return this.privDuration;
    }
    /**
     * Specifies the text of the word boundary event.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.text
     * @function
     * @public
     * @returns {string} the text.
     */
    get text() {
        return this.privText;
    }
    /**
     * Specifies the word length
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.wordLength
     * @function
     * @public
     * @returns {number} the word length
     */
    get wordLength() {
        return this.privWordLength;
    }
    /**
     * Specifies the text offset.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.textOffset
     * @function
     * @public
     * @returns {number} the text offset.
     */
    get textOffset() {
        return this.privTextOffset;
    }
    /**
     * Specifies the boundary type.
     * @member SpeechSynthesisWordBoundaryEventArgs.prototype.boundaryType
     * @function
     * @public
     * @returns {SpeechSynthesisBoundaryType} the boundary type.
     */
    get boundaryType() {
        return this.privBoundaryType;
    }
}

//# sourceMappingURL=SpeechSynthesisWordBoundaryEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesizer.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesizer.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechSynthesizer": () => (/* binding */ SpeechSynthesizer),
/* harmony export */   "SynthesisRequest": () => (/* binding */ SynthesisRequest)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeechSynthesisConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisAdapterBase.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveSubscriptionKeyAuthentication.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/CognitiveTokenAuthentication.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SynthesisRestAdapter.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Queue.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Guid.js");
/* harmony import */ var _Audio_AudioFileWriter__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Audio/AudioFileWriter */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioFileWriter.js");
/* harmony import */ var _Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Audio/AudioOutputFormat */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputFormat.js");
/* harmony import */ var _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioOutputStream.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/PushAudioOutputStreamCallback.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js");
/* eslint-disable @typescript-eslint/no-empty-function */
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







/**
 * Defines the class SpeechSynthesizer for text to speech.
 * Updated in version 1.16.0
 * @class SpeechSynthesizer
 */
class SpeechSynthesizer {
    /**
     * SpeechSynthesizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - An set of initial properties for this synthesizer.
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the synthesizer.
     */
    constructor(speechConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(speechConfigImpl, "speechConfig");
        if (audioConfig !== null) {
            if (audioConfig === undefined) {
                this.audioConfig = (typeof window === "undefined") ? undefined : _Exports__WEBPACK_IMPORTED_MODULE_1__.AudioConfig.fromDefaultSpeakerOutput();
            }
            else {
                this.audioConfig = audioConfig;
            }
        }
        this.privProperties = speechConfigImpl.properties.clone();
        this.privDisposed = false;
        this.privSynthesizing = false;
        this.privConnectionFactory = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.SpeechSynthesisConnectionFactory();
        this.synthesisRequestQueue = new _common_Exports__WEBPACK_IMPORTED_MODULE_3__.Queue();
        this.implCommonSynthesizeSetup();
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member SpeechSynthesizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member SpeechSynthesizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * The collection of properties and their values defined for this SpeechSynthesizer.
     * @member SpeechSynthesizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this SpeechSynthesizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Indicates if auto detect source language is enabled
     * @member SpeechSynthesizer.prototype.properties
     * @function
     * @public
     * @returns {boolean} if auto detect source language is enabled
     */
    get autoDetectSourceLanguage() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages) === _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.AutoDetectSourceLanguagesOpenRangeOptionName;
    }
    /**
     * SpeechSynthesizer constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - an set of initial properties for this synthesizer
     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the synthesizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the synthesizer
     */
    static FromConfig(speechConfig, autoDetectSourceLanguageConfig, audioConfig) {
        const speechConfigImpl = speechConfig;
        autoDetectSourceLanguageConfig.properties.mergeTo(speechConfigImpl.properties);
        return new SpeechSynthesizer(speechConfig, audioConfig);
    }
    buildSsml(text) {
        const languageToDefaultVoice = {
            ["af-ZA"]: "af-ZA-AdriNeural",
            ["am-ET"]: "am-ET-AmehaNeural",
            ["ar-AE"]: "ar-AE-FatimaNeural",
            ["ar-BH"]: "ar-BH-AliNeural",
            ["ar-DZ"]: "ar-DZ-AminaNeural",
            ["ar-EG"]: "ar-EG-SalmaNeural",
            ["ar-IQ"]: "ar-IQ-BasselNeural",
            ["ar-JO"]: "ar-JO-SanaNeural",
            ["ar-KW"]: "ar-KW-FahedNeural",
            ["ar-LY"]: "ar-LY-ImanNeural",
            ["ar-MA"]: "ar-MA-JamalNeural",
            ["ar-QA"]: "ar-QA-AmalNeural",
            ["ar-SA"]: "ar-SA-HamedNeural",
            ["ar-SY"]: "ar-SY-AmanyNeural",
            ["ar-TN"]: "ar-TN-HediNeural",
            ["ar-YE"]: "ar-YE-MaryamNeural",
            ["bg-BG"]: "bg-BG-BorislavNeural",
            ["bn-BD"]: "bn-BD-NabanitaNeural",
            ["bn-IN"]: "bn-IN-BashkarNeural",
            ["ca-ES"]: "ca-ES-JoanaNeural",
            ["cs-CZ"]: "cs-CZ-AntoninNeural",
            ["cy-GB"]: "cy-GB-AledNeural",
            ["da-DK"]: "da-DK-ChristelNeural",
            ["de-AT"]: "de-AT-IngridNeural",
            ["de-CH"]: "de-CH-JanNeural",
            ["de-DE"]: "de-DE-KatjaNeural",
            ["el-GR"]: "el-GR-AthinaNeural",
            ["en-AU"]: "en-AU-NatashaNeural",
            ["en-CA"]: "en-CA-ClaraNeural",
            ["en-GB"]: "en-GB-LibbyNeural",
            ["en-HK"]: "en-HK-SamNeural",
            ["en-IE"]: "en-IE-ConnorNeural",
            ["en-IN"]: "en-IN-NeerjaNeural",
            ["en-KE"]: "en-KE-AsiliaNeural",
            ["en-NG"]: "en-NG-AbeoNeural",
            ["en-NZ"]: "en-NZ-MitchellNeural",
            ["en-PH"]: "en-PH-JamesNeural",
            ["en-SG"]: "en-SG-LunaNeural",
            ["en-TZ"]: "en-TZ-ElimuNeural",
            ["en-US"]: "en-US-JennyNeural",
            ["en-ZA"]: "en-ZA-LeahNeural",
            ["es-AR"]: "es-AR-ElenaNeural",
            ["es-BO"]: "es-BO-MarceloNeural",
            ["es-CL"]: "es-CL-CatalinaNeural",
            ["es-CO"]: "es-CO-GonzaloNeural",
            ["es-CR"]: "es-CR-JuanNeural",
            ["es-CU"]: "es-CU-BelkysNeural",
            ["es-DO"]: "es-DO-EmilioNeural",
            ["es-EC"]: "es-EC-AndreaNeural",
            ["es-ES"]: "es-ES-AlvaroNeural",
            ["es-GQ"]: "es-GQ-JavierNeural",
            ["es-GT"]: "es-GT-AndresNeural",
            ["es-HN"]: "es-HN-CarlosNeural",
            ["es-MX"]: "es-MX-DaliaNeural",
            ["es-NI"]: "es-NI-FedericoNeural",
            ["es-PA"]: "es-PA-MargaritaNeural",
            ["es-PE"]: "es-PE-AlexNeural",
            ["es-PR"]: "es-PR-KarinaNeural",
            ["es-PY"]: "es-PY-MarioNeural",
            ["es-SV"]: "es-SV-LorenaNeural",
            ["es-US"]: "es-US-AlonsoNeural",
            ["es-UY"]: "es-UY-MateoNeural",
            ["es-VE"]: "es-VE-PaolaNeural",
            ["et-EE"]: "et-EE-AnuNeural",
            ["fa-IR"]: "fa-IR-DilaraNeural",
            ["fi-FI"]: "fi-FI-SelmaNeural",
            ["fil-PH"]: "fil-PH-AngeloNeural",
            ["fr-BE"]: "fr-BE-CharlineNeural",
            ["fr-CA"]: "fr-CA-SylvieNeural",
            ["fr-CH"]: "fr-CH-ArianeNeural",
            ["fr-FR"]: "fr-FR-DeniseNeural",
            ["ga-IE"]: "ga-IE-ColmNeural",
            ["gl-ES"]: "gl-ES-RoiNeural",
            ["gu-IN"]: "gu-IN-DhwaniNeural",
            ["he-IL"]: "he-IL-AvriNeural",
            ["hi-IN"]: "hi-IN-MadhurNeural",
            ["hr-HR"]: "hr-HR-GabrijelaNeural",
            ["hu-HU"]: "hu-HU-NoemiNeural",
            ["id-ID"]: "id-ID-ArdiNeural",
            ["is-IS"]: "is-IS-GudrunNeural",
            ["it-IT"]: "it-IT-IsabellaNeural",
            ["ja-JP"]: "ja-JP-NanamiNeural",
            ["jv-ID"]: "jv-ID-DimasNeural",
            ["kk-KZ"]: "kk-KZ-AigulNeural",
            ["km-KH"]: "km-KH-PisethNeural",
            ["kn-IN"]: "kn-IN-GaganNeural",
            ["ko-KR"]: "ko-KR-SunHiNeural",
            ["lo-LA"]: "lo-LA-ChanthavongNeural",
            ["lt-LT"]: "lt-LT-LeonasNeural",
            ["lv-LV"]: "lv-LV-EveritaNeural",
            ["mk-MK"]: "mk-MK-AleksandarNeural",
            ["ml-IN"]: "ml-IN-MidhunNeural",
            ["mr-IN"]: "mr-IN-AarohiNeural",
            ["ms-MY"]: "ms-MY-OsmanNeural",
            ["mt-MT"]: "mt-MT-GraceNeural",
            ["my-MM"]: "my-MM-NilarNeural",
            ["nb-NO"]: "nb-NO-PernilleNeural",
            ["nl-BE"]: "nl-BE-ArnaudNeural",
            ["nl-NL"]: "nl-NL-ColetteNeural",
            ["pl-PL"]: "pl-PL-AgnieszkaNeural",
            ["ps-AF"]: "ps-AF-GulNawazNeural",
            ["pt-BR"]: "pt-BR-FranciscaNeural",
            ["pt-PT"]: "pt-PT-DuarteNeural",
            ["ro-RO"]: "ro-RO-AlinaNeural",
            ["ru-RU"]: "ru-RU-SvetlanaNeural",
            ["si-LK"]: "si-LK-SameeraNeural",
            ["sk-SK"]: "sk-SK-LukasNeural",
            ["sl-SI"]: "sl-SI-PetraNeural",
            ["so-SO"]: "so-SO-MuuseNeural",
            ["sr-RS"]: "sr-RS-NicholasNeural",
            ["su-ID"]: "su-ID-JajangNeural",
            ["sv-SE"]: "sv-SE-SofieNeural",
            ["sw-KE"]: "sw-KE-RafikiNeural",
            ["sw-TZ"]: "sw-TZ-DaudiNeural",
            ["ta-IN"]: "ta-IN-PallaviNeural",
            ["ta-LK"]: "ta-LK-KumarNeural",
            ["ta-SG"]: "ta-SG-AnbuNeural",
            ["te-IN"]: "te-IN-MohanNeural",
            ["th-TH"]: "th-TH-PremwadeeNeural",
            ["tr-TR"]: "tr-TR-AhmetNeural",
            ["uk-UA"]: "uk-UA-OstapNeural",
            ["ur-IN"]: "ur-IN-GulNeural",
            ["ur-PK"]: "ur-PK-AsadNeural",
            ["uz-UZ"]: "uz-UZ-MadinaNeural",
            ["vi-VN"]: "vi-VN-HoaiMyNeural",
            ["zh-CN"]: "zh-CN-XiaoxiaoNeural",
            ["zh-HK"]: "zh-HK-HiuMaanNeural",
            ["zh-TW"]: "zh-TW-HsiaoChenNeural",
            ["zu-ZA"]: "zu-ZA-ThandoNeural",
        };
        let language = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthLanguage, "en-US");
        let voice = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthVoice, "");
        let ssml = SpeechSynthesizer.XMLEncode(text);
        if (this.autoDetectSourceLanguage) {
            language = "en-US";
        }
        else {
            voice = voice || languageToDefaultVoice[language];
        }
        if (voice) {
            ssml = `<voice name='${voice}'>${ssml}</voice>`;
        }
        ssml = `<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${language}'>${ssml}</speak>`;
        return ssml;
    }
    /**
     * Executes speech synthesis on plain text.
     * The task returns the synthesis result.
     * @member SpeechSynthesizer.prototype.speakTextAsync
     * @function
     * @public
     * @param text - Text to be synthesized.
     * @param cb - Callback that received the SpeechSynthesisResult.
     * @param err - Callback invoked in case of an error.
     * @param stream - AudioOutputStream to receive the synthesized audio.
     */
    speakTextAsync(text, cb, err, stream) {
        this.speakImpl(text, false, cb, err, stream);
    }
    /**
     * Executes speech synthesis on SSML.
     * The task returns the synthesis result.
     * @member SpeechSynthesizer.prototype.speakSsmlAsync
     * @function
     * @public
     * @param ssml - SSML to be synthesized.
     * @param cb - Callback that received the SpeechSynthesisResult.
     * @param err - Callback invoked in case of an error.
     * @param stream - AudioOutputStream to receive the synthesized audio.
     */
    speakSsmlAsync(ssml, cb, err, stream) {
        this.speakImpl(ssml, true, cb, err, stream);
    }
    /**
     * Get list of synthesis voices available.
     * The task returns the synthesis voice result.
     * @member SpeechSynthesizer.prototype.getVoicesAsync
     * @function
     * @async
     * @public
     * @param locale - Locale of voices in BCP-47 format; if left empty, get all available voices.
     * @return {Promise<SynthesisVoicesResult>} - Promise of a SynthesisVoicesResult.
     */
    getVoicesAsync(locale = "") {
        return __awaiter(this, void 0, void 0, function* () {
            return this.getVoices(locale);
        });
    }
    /**
     * Dispose of associated resources.
     * @member SpeechSynthesizer.prototype.close
     * @function
     * @public
     */
    close(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privDisposed);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_6__.marshalPromiseToCallbacks)(this.dispose(true), cb, err);
    }
    /**
     * @Internal
     * Do not use externally, object returned will change without warning or notice.
     */
    get internalData() {
        return this.privAdapter;
    }
    /**
     * This method performs cleanup of resources.
     * The Boolean parameter disposing indicates whether the method is called
     * from Dispose (if disposing is true) or from the finalizer (if disposing is false).
     * Derived classes should override this method to dispose resource if needed.
     * @member SpeechSynthesizer.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - Flag to request disposal.
     */
    dispose(disposing) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposed) {
                return;
            }
            if (disposing) {
                if (this.privAdapter) {
                    yield this.privAdapter.dispose();
                }
            }
            this.privDisposed = true;
        });
    }
    //
    // ################################################################################################################
    // IMPLEMENTATION.
    // Move to independent class
    // ################################################################################################################
    //
    createSynthesizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.SynthesizerConfig(speechConfig, this.privProperties);
    }
    // Creates the synthesis adapter
    createSynthesisAdapter(authentication, connectionFactory, audioConfig, synthesizerConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.SynthesisAdapterBase(authentication, connectionFactory, synthesizerConfig, this, this.audioConfig);
    }
    implCommonSynthesizeSetup() {
        let osPlatform = (typeof window !== "undefined") ? "Browser" : "Node";
        let osName = "unknown";
        let osVersion = "unknown";
        if (typeof navigator !== "undefined") {
            osPlatform = osPlatform + "/" + navigator.platform;
            osName = navigator.userAgent;
            osVersion = navigator.appVersion;
        }
        const synthesizerConfig = this.createSynthesizerConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.SpeechServiceConfig(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.Context(new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.OS(osPlatform, osName, osVersion))));
        const subscriptionKey = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_Key, undefined);
        const authentication = (subscriptionKey && subscriptionKey !== "") ?
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_10__.CognitiveSubscriptionKeyAuthentication(subscriptionKey) :
            new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__.CognitiveTokenAuthentication(() => {
                const authorizationToken = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            }, () => {
                const authorizationToken = this.privProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceAuthorization_Token, undefined);
                return Promise.resolve(authorizationToken);
            });
        this.privAdapter = this.createSynthesisAdapter(authentication, this.privConnectionFactory, this.audioConfig, synthesizerConfig);
        this.privAdapter.audioOutputFormat = _Audio_AudioOutputFormat__WEBPACK_IMPORTED_MODULE_12__.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(_Exports__WEBPACK_IMPORTED_MODULE_13__.SpeechSynthesisOutputFormat[this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_4__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)]);
        this.privRestAdapter = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_14__.SynthesisRestAdapter(synthesizerConfig, authentication);
    }
    speakImpl(text, IsSsml, cb, err, dataStream) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privDisposed);
            const requestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.createNoDashGuid)();
            let audioDestination;
            if (dataStream instanceof _Exports__WEBPACK_IMPORTED_MODULE_16__.PushAudioOutputStreamCallback) {
                audioDestination = new _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_17__.PushAudioOutputStreamImpl(dataStream);
            }
            else if (dataStream instanceof _Audio_AudioOutputStream__WEBPACK_IMPORTED_MODULE_17__.PullAudioOutputStream) {
                audioDestination = dataStream;
            }
            else if (dataStream !== undefined) {
                audioDestination = new _Audio_AudioFileWriter__WEBPACK_IMPORTED_MODULE_18__.AudioFileWriter(dataStream);
            }
            else {
                audioDestination = undefined;
            }
            this.synthesisRequestQueue.enqueue(new SynthesisRequest(requestId, text, IsSsml, (e) => {
                this.privSynthesizing = false;
                if (!!cb) {
                    try {
                        cb(e);
                    }
                    catch (e) {
                        if (!!err) {
                            err(e);
                        }
                    }
                }
                cb = undefined;
                /* eslint-disable no-empty */
                this.adapterSpeak().catch(() => { });
            }, (e) => {
                if (!!err) {
                    err(e);
                }
            }, audioDestination));
            /* eslint-disable no-empty-function */
            this.adapterSpeak().catch(() => { });
        }
        catch (error) {
            if (!!err) {
                if (error instanceof Error) {
                    const typedError = error;
                    err(typedError.name + ": " + typedError.message);
                }
                else {
                    err(error);
                }
            }
            // Destroy the synthesizer.
            /* eslint-disable no-empty */
            this.dispose(true).catch(() => { });
        }
    }
    getVoices(locale) {
        return __awaiter(this, void 0, void 0, function* () {
            const requestId = (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.createNoDashGuid)();
            const response = yield this.privRestAdapter.getVoicesList(requestId);
            if (response.ok && Array.isArray(response.json)) {
                let json = response.json;
                if (!!locale && locale.length > 0) {
                    json = json.filter((item) => !!item.Locale && item.Locale.toLowerCase() === locale.toLowerCase());
                }
                return new _Exports__WEBPACK_IMPORTED_MODULE_19__.SynthesisVoicesResult(requestId, json, undefined);
            }
            else {
                return new _Exports__WEBPACK_IMPORTED_MODULE_19__.SynthesisVoicesResult(requestId, undefined, `Error: ${response.status}: ${response.statusText}`);
            }
        });
    }
    adapterSpeak() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.privDisposed && !this.privSynthesizing) {
                this.privSynthesizing = true;
                const request = yield this.synthesisRequestQueue.dequeue();
                return this.privAdapter.Speak(request.text, request.isSSML, request.requestId, request.cb, request.err, request.dataStream);
            }
        });
    }
    static XMLEncode(text) {
        return text.replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&apos;");
    }
}
class SynthesisRequest {
    constructor(requestId, text, isSSML, cb, err, dataStream) {
        this.requestId = requestId;
        this.text = text;
        this.isSSML = isSSML;
        this.cb = cb;
        this.err = err;
        this.dataStream = dataStream;
    }
}

//# sourceMappingURL=SpeechSynthesizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js":
/*!***************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js ***!
  \***************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SpeechTranslationConfig": () => (/* binding */ SpeechTranslationConfig),
/* harmony export */   "SpeechTranslationConfigImpl": () => (/* binding */ SpeechTranslationConfigImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/OutputFormat.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechSynthesisOutputFormat.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */



/**
 * Speech translation configuration.
 * @class SpeechTranslationConfig
 */
class SpeechTranslationConfig extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechConfig {
    /**
     * Creates an instance of recognizer config.
     */
    constructor() {
        super();
    }
    /**
     * Static instance of SpeechTranslationConfig returned by passing a subscription key and service region.
     * @member SpeechTranslationConfig.fromSubscription
     * @function
     * @public
     * @param {string} subscriptionKey - The subscription key.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechTranslationConfig} The speech translation config.
     */
    static fromSubscription(subscriptionKey, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(subscriptionKey, "subscriptionKey");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const ret = new SpeechTranslationConfigImpl();
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return ret;
    }
    /**
     * Static instance of SpeechTranslationConfig returned by passing authorization token and service region.
     * Note: The caller needs to ensure that the authorization token is valid. Before the authorization token
     * expires, the caller needs to refresh it by setting the property authorizationToken with a new
     * valid token. Otherwise, all the recognizers created by this SpeechTranslationConfig instance
     * will encounter errors during recognition.
     * As configuration values are copied when creating a new recognizer, the new token value will not apply
     * to recognizers that have already been created.
     * For recognizers that have been created before, you need to set authorization token of the corresponding recognizer
     * to refresh the token. Otherwise, the recognizers will encounter errors during recognition.
     * @member SpeechTranslationConfig.fromAuthorizationToken
     * @function
     * @public
     * @param {string} authorizationToken - The authorization token.
     * @param {string} region - The region name (see the <a href="https://aka.ms/csspeech/region">region page</a>).
     * @returns {SpeechTranslationConfig} The speech translation config.
     */
    static fromAuthorizationToken(authorizationToken, region) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(authorizationToken, "authorizationToken");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(region, "region");
        const ret = new SpeechTranslationConfigImpl();
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, authorizationToken);
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region, region);
        return ret;
    }
    /**
     * Creates an instance of the speech config with specified host and subscription key.
     * This method is intended only for users who use a non-default service host. Standard resource path will be assumed.
     * For services with a non-standard resource path or no path at all, use fromEndpoint instead.
     * Note: Query parameters are not allowed in the host URI and must be set by other APIs.
     * Note: To use an authorization token with fromHost, use fromHost(URL),
     * and then set the AuthorizationToken property on the created SpeechConfig instance.
     * Note: Added in version 1.9.0.
     * @member SpeechConfig.fromHost
     * @function
     * @public
     * @param {URL} host - The service endpoint to connect to. Format is "protocol://host:port" where ":port" is optional.
     * @param {string} subscriptionKey - The subscription key. If a subscription key is not specified, an authorization token must be set.
     * @returns {SpeechConfig} A speech factory instance.
     */
    static fromHost(hostName, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(hostName, "hostName");
        const speechImpl = new SpeechTranslationConfigImpl();
        speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Host, hostName.protocol + "//" + hostName.hostname + (hostName.port === "" ? "" : ":" + hostName.port));
        if (undefined !== subscriptionKey) {
            speechImpl.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        }
        return speechImpl;
    }
    /**
     * Creates an instance of the speech translation config with specified endpoint and subscription key.
     * This method is intended only for users who use a non-standard service endpoint or paramters.
     * Note: The query properties specified in the endpoint URL are not changed, even if they are
     * set by any other APIs. For example, if language is defined in the uri as query parameter
     * "language=de-DE", and also set by the speechRecognitionLanguage property, the language
     * setting in uri takes precedence, and the effective language is "de-DE".
     * Only the properties that are not specified in the endpoint URL can be set by other APIs.
     * Note: To use authorization token with fromEndpoint, pass an empty string to the subscriptionKey in the
     * fromEndpoint method, and then set authorizationToken="token" on the created SpeechConfig instance to
     * use the authorization token.
     * @member SpeechTranslationConfig.fromEndpoint
     * @function
     * @public
     * @param {URL} endpoint - The service endpoint to connect to.
     * @param {string} subscriptionKey - The subscription key.
     * @returns {SpeechTranslationConfig} A speech config instance.
     */
    static fromEndpoint(endpoint, subscriptionKey) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(endpoint, "endpoint");
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(subscriptionKey, "subscriptionKey");
        const ret = new SpeechTranslationConfigImpl();
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Endpoint, endpoint.href);
        ret.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key, subscriptionKey);
        return ret;
    }
}
/**
 * @private
 * @class SpeechTranslationConfigImpl
 */
class SpeechTranslationConfigImpl extends SpeechTranslationConfig {
    constructor() {
        super();
        this.privSpeechProperties = new _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyCollection();
        this.outputFormat = _Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat.Simple;
    }
    /**
     * Gets/Sets the authorization token.
     * If this is set, subscription key is ignored.
     * User needs to make sure the provided authorization token is valid and not expired.
     * @member SpeechTranslationConfigImpl.prototype.authorizationToken
     * @function
     * @public
     * @param {string} value - The authorization token.
     */
    set authorizationToken(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    /**
     * Sets the speech recognition language.
     * @member SpeechTranslationConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @param {string} value - The authorization token.
     */
    set speechRecognitionLanguage(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage, value);
    }
    /**
     * Gets the speech recognition language.
     * @member SpeechTranslationConfigImpl.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @return {string} The speechRecognitionLanguage.
     */
    get speechRecognitionLanguage() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
    }
    /**
     * @member SpeechTranslationConfigImpl.prototype.subscriptionKey
     * @function
     * @public
     */
    get subscriptionKey() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Key]);
    }
    /**
     * Gets the output format
     * @member SpeechTranslationConfigImpl.prototype.outputFormat
     * @function
     * @public
     */
    get outputFormat() {
        // eslint-disable-next-line
        return _Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat[this.privSpeechProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormatPropertyName, undefined)];
    }
    /**
     * Gets/Sets the output format
     * @member SpeechTranslationConfigImpl.prototype.outputFormat
     * @function
     * @public
     */
    set outputFormat(value) {
        this.privSpeechProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.OutputFormatPropertyName, _Exports__WEBPACK_IMPORTED_MODULE_4__.OutputFormat[value]);
    }
    /**
     * Gets the endpoint id.
     * @member SpeechTranslationConfigImpl.prototype.endpointId
     * @function
     * @public
     */
    get endpointId() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EndpointId);
    }
    /**
     * Gets/Sets the endpoint id.
     * @member SpeechTranslationConfigImpl.prototype.endpointId
     * @function
     * @public
     */
    set endpointId(value) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EndpointId, value);
    }
    /**
     * Add a (text) target language to translate into.
     * @member SpeechTranslationConfigImpl.prototype.addTargetLanguage
     * @function
     * @public
     * @param {string} value - The language such as de-DE
     */
    addTargetLanguage(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        const languages = this.targetLanguages;
        languages.push(value);
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationToLanguages, languages.join(","));
    }
    /**
     * Gets the (text) target language to translate into.
     * @member SpeechTranslationConfigImpl.prototype.targetLanguages
     * @function
     * @public
     * @param {string} value - The language such as de-DE
     */
    get targetLanguages() {
        if (this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationToLanguages, undefined) !== undefined) {
            return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
        }
        else {
            return [];
        }
    }
    /**
     * Gets the voice name.
     * @member SpeechTranslationConfigImpl.prototype.voiceName
     * @function
     * @public
     */
    get voiceName() {
        return this.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationVoice]);
    }
    /**
     * Gets/Sets the voice of the translated language, enable voice synthesis output.
     * @member SpeechTranslationConfigImpl.prototype.voiceName
     * @function
     * @public
     * @param {string} value - The name of the voice.
     */
    set voiceName(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(value, "value");
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_TranslationVoice, value);
    }
    /**
     * Provides the region.
     * @member SpeechTranslationConfigImpl.prototype.region
     * @function
     * @public
     * @returns {string} The region.
     */
    get region() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_Region);
    }
    setProxy(proxyHostName, proxyPort, proxyUserName, proxyPassword) {
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyHostName], proxyHostName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPort], proxyPort);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyUserName], proxyUserName);
        this.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_ProxyPassword], proxyPassword);
    }
    /**
     * Gets an arbitrary property value.
     * @member SpeechTranslationConfigImpl.prototype.getProperty
     * @function
     * @public
     * @param {string} name - The name of the property.
     * @param {string} def - The default value of the property in case it is not set.
     * @returns {string} The value of the property.
     */
    getProperty(name, def) {
        return this.privSpeechProperties.getProperty(name, def);
    }
    /**
     * Gets/Sets an arbitrary property value.
     * @member SpeechTranslationConfigImpl.prototype.setProperty
     * @function
     * @public
     * @param {string | PropertyId} name - The name of the property to set.
     * @param {string} value - The value of the property.
     */
    setProperty(name, value) {
        this.privSpeechProperties.setProperty(name, value);
    }
    /**
     * Provides access to custom properties.
     * @member SpeechTranslationConfigImpl.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The properties.
     */
    get properties() {
        return this.privSpeechProperties;
    }
    /**
     * Dispose of associated resources.
     * @member SpeechTranslationConfigImpl.prototype.close
     * @function
     * @public
     */
    close() {
        return;
    }
    setServiceProperty(name, value) {
        const currentProperties = JSON.parse(this.privSpeechProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.ServicePropertiesPropertyName, "{}"));
        currentProperties[name] = value;
        this.privSpeechProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.ServicePropertiesPropertyName, JSON.stringify(currentProperties));
    }
    setProfanity(profanity) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_ProfanityOption, _Exports__WEBPACK_IMPORTED_MODULE_6__.ProfanityOption[profanity]);
    }
    enableAudioLogging() {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_EnableAudioLogging, "true");
    }
    requestWordLevelTimestamps() {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps, "true");
    }
    enableDictation() {
        this.privSpeechProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.ForceDictationPropertyName, "true");
    }
    get speechSynthesisLanguage() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthLanguage);
    }
    set speechSynthesisLanguage(language) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthLanguage, language);
    }
    get speechSynthesisVoiceName() {
        return this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthVoice);
    }
    set speechSynthesisVoiceName(voice) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthVoice, voice);
    }
    get speechSynthesisOutputFormat() {
        // eslint-disable-next-line
        return _Exports__WEBPACK_IMPORTED_MODULE_7__.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthOutputFormat, undefined)];
    }
    set speechSynthesisOutputFormat(format) {
        this.privSpeechProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_SynthOutputFormat, _Exports__WEBPACK_IMPORTED_MODULE_7__.SpeechSynthesisOutputFormat[format]);
    }
}

//# sourceMappingURL=SpeechTranslationConfig.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisResult": () => (/* binding */ SynthesisResult)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Base class for synthesis results
 * @class SynthesisResult
 * Added in version 1.20.0
 */
class SynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} errorDetails - Error details, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(resultId, reason, errorDetails, properties) {
        this.privResultId = resultId;
        this.privReason = reason;
        this.privErrorDetails = errorDetails;
        this.privProperties = properties;
    }
    /**
     * Specifies the result identifier.
     * @member SynthesisResult.prototype.resultId
     * @function
     * @public
     * @returns {string} Specifies the result identifier.
     */
    get resultId() {
        return this.privResultId;
    }
    /**
     * Specifies status of the result.
     * @member SynthesisResult.prototype.reason
     * @function
     * @public
     * @returns {ResultReason} Specifies status of the result.
     */
    get reason() {
        return this.privReason;
    }
    /**
     * In case of an unsuccessful synthesis, provides details of the occurred error.
     * @member SynthesisResult.prototype.errorDetails
     * @function
     * @public
     * @returns {string} a brief description of an error.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
    /**
     * The set of properties exposed in the result.
     * @member SynthesisResult.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The set of properties exposed in the result.
     */
    get properties() {
        return this.privProperties;
    }
}

//# sourceMappingURL=SynthesisResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisVoicesResult.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisVoicesResult": () => (/* binding */ SynthesisVoicesResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SynthesisResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines result of speech synthesis.
 * @class SynthesisVoicesResult
 * Added in version 1.20.0
 */
class SynthesisVoicesResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param requestId - result id for request.
     * @param json - json payload from endpoint.
     */
    constructor(requestId, json, errorDetails) {
        if (Array.isArray(json)) {
            super(requestId, _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.VoicesListRetrieved, undefined, new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection());
            this.privVoices = [];
            for (const item of json) {
                this.privVoices.push(new _Exports__WEBPACK_IMPORTED_MODULE_3__.VoiceInfo(item));
            }
        }
        else {
            super(requestId, _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled, errorDetails ? errorDetails : "Error information unavailable", new _Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyCollection());
        }
    }
    /**
     * The list of voices
     * @member SynthesisVoicesResult.prototype.voices
     * @function
     * @public
     * @returns {VoiceInfo[]} List of synthesized voices.
     */
    get voices() {
        return this.privVoices;
    }
}

//# sourceMappingURL=SynthesisVoicesResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Conversation": () => (/* binding */ Conversation),
/* harmony export */   "ConversationImpl": () => (/* binding */ ConversationImpl)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorInterfaces.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationManager.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */




class Conversation {
    constructor() {
        return;
    }
    /**
     * Create a conversation
     * @param speechConfig
     * @param cb
     * @param err
     */
    static createConversationAsync(speechConfig, arg2, arg3, arg4) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(speechConfig, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}", "config"));
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(speechConfig.region, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}", "SpeechServiceConnection_Region"));
        if (!speechConfig.subscriptionKey && !speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token])) {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(speechConfig.subscriptionKey, _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}", "SpeechServiceConnection_Key"));
        }
        let conversationImpl;
        let cb;
        let err;
        if (typeof arg2 === "string") {
            conversationImpl = new ConversationImpl(speechConfig, arg2);
            // eslint-disable-next-line @typescript-eslint/no-empty-function
            (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () { }))(), arg3, arg4);
        }
        else {
            conversationImpl = new ConversationImpl(speechConfig);
            cb = arg2;
            err = arg3;
            conversationImpl.createConversationAsync((() => {
                if (!!cb) {
                    cb();
                }
            }), (error) => {
                if (!!err) {
                    err(error);
                }
            });
        }
        return conversationImpl;
    }
}
class ConversationImpl extends Conversation {
    /**
     * Create a conversation impl
     * @param speechConfig
     * @param {string} id - optional conversationId
     */
    constructor(speechConfig, id) {
        super();
        this.privErrors = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.restErrors;
        /** websocket callbacks */
        /* eslint-disable @typescript-eslint/typedef */
        this.onConnected = (e) => {
            var _a;
            this.privIsConnected = true;
            try {
                if (!!((_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.sessionStarted)) {
                    this.privConversationTranslator.sessionStarted(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
        };
        this.onDisconnected = (e) => {
            var _a;
            try {
                if (!!((_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.sessionStopped)) {
                    this.privConversationTranslator.sessionStopped(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
            finally {
                void this.close(false);
            }
        };
        this.onCanceled = (r, e) => {
            var _a;
            try {
                if (!!((_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.canceled)) {
                    this.privConversationTranslator.canceled(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantUpdateCommandReceived = (r, e) => {
            try {
                const updatedParticipant = this.privParticipants.getParticipant(e.id);
                if (updatedParticipant !== undefined) {
                    switch (e.key) {
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.changeNickname:
                            updatedParticipant.displayName = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setUseTTS:
                            updatedParticipant.isUsingTts = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setProfanityFiltering:
                            updatedParticipant.profanity = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setMute:
                            updatedParticipant.isMuted = e.value;
                            break;
                        case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setTranslateToLanguages:
                            updatedParticipant.translateToLanguages = e.value;
                            break;
                    }
                    this.privParticipants.addOrUpdateParticipant(updatedParticipant);
                    if (!!this.privConversationTranslator) {
                        this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.Updated, [this.toParticipant(updatedParticipant)], e.sessionId));
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onLockRoomCommandReceived = () => {
            // TODO
        };
        this.onMuteAllCommandReceived = (r, e) => {
            try {
                this.privParticipants.participants.forEach((p) => p.isMuted = (p.isHost ? false : e.isMuted));
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.Updated, this.toParticipants(false), e.sessionId));
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantJoinCommandReceived = (r, e) => {
            try {
                const newParticipant = this.privParticipants.addOrUpdateParticipant(e.participant);
                if (newParticipant !== undefined) {
                    if (!!this.privConversationTranslator) {
                        this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.JoinedConversation, [this.toParticipant(newParticipant)], e.sessionId));
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantLeaveCommandReceived = (r, e) => {
            try {
                const ejectedParticipant = this.privParticipants.getParticipant(e.participant.id);
                if (ejectedParticipant !== undefined) {
                    // remove the participant from the internal participants list
                    this.privParticipants.deleteParticipant(e.participant.id);
                    if (!!this.privConversationTranslator) {
                        // notify subscribers that the participant has left the conversation
                        this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.LeftConversation, [this.toParticipant(ejectedParticipant)], e.sessionId));
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onTranslationReceived = (r, e) => {
            try {
                switch (e.command) {
                    case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.final:
                        if (!!this.privConversationTranslator) {
                            this.privConversationTranslator.transcribed(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationEventArgs(e.payload, undefined, e.sessionId));
                        }
                        break;
                    case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.partial:
                        if (!!this.privConversationTranslator) {
                            this.privConversationTranslator.transcribing(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationEventArgs(e.payload, undefined, e.sessionId));
                        }
                        break;
                    case _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.instantMessage:
                        if (!!this.privConversationTranslator) {
                            this.privConversationTranslator.textMessageReceived(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_7__.ConversationTranslationEventArgs(e.payload, undefined, e.sessionId));
                        }
                        break;
                }
            }
            catch (e) {
                //
            }
        };
        this.onParticipantsListReceived = (r, e) => {
            var _a;
            try {
                // check if the session token needs to be updated
                if (e.sessionToken !== undefined && e.sessionToken !== null) {
                    this.privRoom.token = e.sessionToken;
                }
                // save the participants
                this.privParticipants.participants = [...e.participants];
                // enable the conversation
                if (this.privParticipants.me !== undefined) {
                    this.privIsReady = true;
                }
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.participantsChanged(this.privConversationTranslator, new _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationParticipantsChangedEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_6__.ParticipantChangedReason.JoinedConversation, this.toParticipants(true), e.sessionId));
                }
                // if this is the host, update the nickname if needed
                if (this.me.isHost) {
                    const nickname = (_a = this.privConversationTranslator) === null || _a === void 0 ? void 0 : _a.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.ConversationTranslator_Name);
                    if (nickname !== undefined && nickname.length > 0 && nickname !== this.me.displayName) {
                        // issue a change nickname request
                        this.changeNicknameAsync(nickname);
                    }
                }
            }
            catch (e) {
                //
            }
        };
        this.onConversationExpiration = (r, e) => {
            try {
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.conversationExpiration(this.privConversationTranslator, e);
                }
            }
            catch (e) {
                //
            }
        };
        this.privIsConnected = false;
        this.privIsDisposed = false;
        this.privConversationId = "";
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_8__.PropertyCollection();
        this.privManager = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_9__.ConversationManager();
        // check the speech language
        const language = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        if (!language) {
            speechConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage], _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.defaultLanguageCode);
        }
        this.privLanguage = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage]);
        if (!id) {
            // check the target language(s)
            if (speechConfig.targetLanguages.length === 0) {
                speechConfig.addTargetLanguage(this.privLanguage);
            }
            // check the profanity setting: speech and conversationTranslator should be in sync
            const profanity = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceResponse_ProfanityOption]);
            if (!profanity) {
                speechConfig.setProfanity(_Exports__WEBPACK_IMPORTED_MODULE_10__.ProfanityOption.Masked);
            }
            // check the nickname: it should pass this regex: ^\w+([\s-][\w\(\)]+)*$"
            // TODO: specify the regex required. Nicknames must be unique or get the duplicate nickname error
            // TODO: check what the max length is and if a truncation is required or if the service handles it without an error
            let hostNickname = speechConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.ConversationTranslator_Name]);
            if (hostNickname === undefined || hostNickname === null) {
                hostNickname = "Host";
            }
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrTooLong(hostNickname, "nickname", 50);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrTooShort(hostNickname, "nickname", 2);
            speechConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.ConversationTranslator_Name], hostNickname);
        }
        else {
            this.privConversationId = id;
        }
        // save the speech config for future usage
        this.privConfig = speechConfig;
        // save the config properties
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNull(configImpl, "speechConfig");
        this.privProperties = configImpl.properties.clone();
        this.privIsConnected = false;
        this.privParticipants = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.InternalParticipants();
        this.privIsReady = false;
        this.privTextMessageMaxLength = 1000;
    }
    // get the internal data about a conversation
    get room() {
        return this.privRoom;
    }
    // get the wrapper for connecting to the websockets
    get connection() {
        return this.privConversationRecognizer; // this.privConnection;
    }
    // get the config
    get config() {
        return this.privConfig;
    }
    // get the conversation Id
    get conversationId() {
        return this.privRoom ? this.privRoom.roomId : this.privConversationId;
    }
    // get the properties
    get properties() {
        return this.privProperties;
    }
    // get the speech language
    get speechRecognitionLanguage() {
        return this.privLanguage;
    }
    get isMutedByHost() {
        var _a, _b;
        return ((_a = this.privParticipants.me) === null || _a === void 0 ? void 0 : _a.isHost) ? false : (_b = this.privParticipants.me) === null || _b === void 0 ? void 0 : _b.isMuted;
    }
    get isConnected() {
        return this.privIsConnected && this.privIsReady;
    }
    get participants() {
        return this.toParticipants(true);
    }
    get me() {
        return this.toParticipant(this.privParticipants.me);
    }
    get host() {
        return this.toParticipant(this.privParticipants.host);
    }
    get transcriberRecognizer() {
        return this.privTranscriberRecognizer;
    }
    get conversationInfo() {
        const convId = this.conversationId;
        const p = this.participants.map((part) => ({
            id: part.id,
            preferredLanguage: part.preferredLanguage,
            voice: part.voice
        }));
        const props = {};
        for (const key of _common_speech_Exports__WEBPACK_IMPORTED_MODULE_1__.ConversationConnectionConfig.transcriptionEventKeys) {
            const val = this.properties.getProperty(key, "");
            if (val !== "") {
                props[key] = val;
            }
        }
        const info = { id: convId, participants: p, conversationProperties: props };
        return info;
    }
    get canSend() {
        var _a;
        return this.privIsConnected && !((_a = this.privParticipants.me) === null || _a === void 0 ? void 0 : _a.isMuted);
    }
    get canSendAsHost() {
        var _a;
        return this.privIsConnected && ((_a = this.privParticipants.me) === null || _a === void 0 ? void 0 : _a.isHost);
    }
    // get / set the speech auth token
    // eslint-disable-next-line @typescript-eslint/member-ordering
    get authorizationToken() {
        return this.privToken;
    }
    set authorizationToken(value) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(value, "authorizationToken");
        this.privToken = value;
    }
    set conversationTranslator(conversationTranslator) {
        this.privConversationTranslator = conversationTranslator;
    }
    /**
     * Create a new conversation as Host
     * @param cb
     * @param err
     */
    createConversationAsync(cb, err) {
        try {
            if (!!this.privConversationRecognizer) {
                this.handleError(new Error(this.privErrors.permissionDeniedStart), err);
            }
            this.privManager.createOrJoin(this.privProperties, undefined, ((room) => {
                if (!room) {
                    this.handleError(new Error(this.privErrors.permissionDeniedConnect), err);
                }
                this.privRoom = room;
                this.handleCallback(cb, err);
            }), ((error) => {
                this.handleError(error, err);
            }));
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Starts a new conversation as host.
     * @param cb
     * @param err
     */
    startConversationAsync(cb, err) {
        try {
            // check if there is already a recognizer
            if (!!this.privConversationRecognizer) {
                this.handleError(new Error(this.privErrors.permissionDeniedStart), err);
            }
            // check if there is conversation data available
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedConnect);
            // connect to the conversation websocket
            this.privParticipants.meId = this.privRoom.participantId;
            this.privConversationRecognizer = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_11__.ConversationRecognizerFactory.fromConfig(this, this.privConfig);
            // Because ConversationTranslator manually sets up and manages the connection, Conversation
            // has to forward serviceRecognizer connection events that usually get passed automatically
            this.privConversationRecognizer.connected = this.onConnected;
            this.privConversationRecognizer.disconnected = this.onDisconnected;
            this.privConversationRecognizer.canceled = this.onCanceled;
            this.privConversationRecognizer.participantUpdateCommandReceived = this.onParticipantUpdateCommandReceived;
            this.privConversationRecognizer.lockRoomCommandReceived = this.onLockRoomCommandReceived;
            this.privConversationRecognizer.muteAllCommandReceived = this.onMuteAllCommandReceived;
            this.privConversationRecognizer.participantJoinCommandReceived = this.onParticipantJoinCommandReceived;
            this.privConversationRecognizer.participantLeaveCommandReceived = this.onParticipantLeaveCommandReceived;
            this.privConversationRecognizer.translationReceived = this.onTranslationReceived;
            this.privConversationRecognizer.participantsListReceived = this.onParticipantsListReceived;
            this.privConversationRecognizer.conversationExpiration = this.onConversationExpiration;
            this.privConversationRecognizer.connect(this.privRoom.token, (() => {
                this.handleCallback(cb, err);
            }), ((error) => {
                this.handleError(error, err);
            }));
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Join a conversation as a participant.
     * @param { IParticipant } participant - participant to add
     * @param cb
     * @param err
     */
    addParticipantAsync(participant, cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(participant, "Participant");
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.addParticipantImplAsync(participant), cb, err);
    }
    /**
     * Join a conversation as a participant.
     * @param conversation
     * @param nickname
     * @param lang
     * @param cb
     * @param err
     */
    joinConversationAsync(conversationId, nickname, lang, cb, err) {
        try {
            // TODO
            // if (!!this.privConversationRecognizer) {
            //     throw new Error(this.privErrors.permissionDeniedStart);
            // }
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(conversationId, this.privErrors.invalidArgs.replace("{arg}", "conversationId"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(lang, this.privErrors.invalidArgs.replace("{arg}", "language"));
            // join the conversation
            this.privManager.createOrJoin(this.privProperties, conversationId, ((room) => {
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(room, this.privErrors.permissionDeniedConnect);
                this.privRoom = room;
                this.privConfig.authorizationToken = room.cognitiveSpeechAuthToken;
                // join callback
                if (!!cb) {
                    cb(room.cognitiveSpeechAuthToken);
                }
            }), ((error) => {
                this.handleError(error, err);
            }));
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Deletes a conversation
     * @param cb
     * @param err
     */
    deleteConversationAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(), cb, err);
    }
    deleteConversationImplAsync() {
        return __awaiter(this, void 0, void 0, function* () {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privProperties, this.privErrors.permissionDeniedConnect);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.token, this.privErrors.permissionDeniedConnect);
            yield this.privManager.leave(this.privProperties, this.privRoom.token);
            this.dispose();
        });
    }
    /**
     * Issues a request to close the client websockets
     * @param cb
     * @param err
     */
    endConversationAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.endConversationImplAsync(), cb, err);
    }
    endConversationImplAsync() {
        return this.close(true);
    }
    /**
     * Issues a request to lock the conversation
     * @param cb
     * @param err
     */
    lockConversationAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "lock")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getLockCommand(true), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to mute the conversation
     * @param cb
     * @param err
     */
    muteAllParticipantsAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer, this.privErrors.permissionDeniedSend);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            // check the user's permissions
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "mute")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(true), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to mute a participant in the conversation
     * @param userId
     * @param cb
     * @param err
     */
    muteParticipantAsync(userId, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(userId, this.privErrors.invalidArgs.replace("{arg}", "userId"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            // check the connection is open (host + participant can perform the mute command)
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            // if not host, check the participant is not muting another participant
            if (!this.me.isHost && this.me.id !== userId) {
                this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}", "mute")), err);
            }
            // check the user exists
            const exists = this.privParticipants.getParticipantIndex(userId);
            if (exists === -1) {
                this.handleError(new Error(this.privErrors.invalidParticipantRequest), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteCommand(userId, true), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to remove a participant from the conversation
     * @param userId
     * @param cb
     * @param err
     */
    removeParticipantAsync(userId, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            if (!!this.privTranscriberRecognizer && userId.hasOwnProperty("id")) {
                // Assume this is a transcription participant
                (0,_common_Exports__WEBPACK_IMPORTED_MODULE_3__.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(userId), cb, err);
            }
            else {
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
                if (!this.canSendAsHost) {
                    this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}", "remove")), err);
                }
                let participantId = "";
                if (typeof userId === "string") {
                    participantId = userId;
                }
                else if (userId.hasOwnProperty("id")) {
                    const participant = userId;
                    participantId = participant.id;
                }
                else if (userId.hasOwnProperty("userId")) {
                    const user = userId;
                    participantId = user.userId;
                }
                _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(participantId, this.privErrors.invalidArgs.replace("{arg}", "userId"));
                // check the participant exists
                const index = this.participants.findIndex((p) => p.id === participantId);
                if (index === -1) {
                    this.handleError(new Error(this.privErrors.invalidParticipantRequest), err);
                }
                if (!!this.privConversationRecognizer) {
                    this.privConversationRecognizer.sendRequest(this.getEjectCommand(participantId), (() => {
                        this.handleCallback(cb, err);
                    }), ((error) => {
                        this.handleError(error, err);
                    }));
                }
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to unlock the conversation
     * @param cb
     * @param err
     */
    unlockConversationAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "unlock")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getLockCommand(false), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to unmute all participants in the conversation
     * @param cb
     * @param err
     */
    unmuteAllParticipantsAsync(cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSendAsHost) {
                this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}", "unmute all")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(false), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Issues a request to unmute a participant in the conversation
     * @param userId
     * @param cb
     * @param err
     */
    unmuteParticipantAsync(userId, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(userId, this.privErrors.invalidArgs.replace("{arg}", "userId"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            // check the connection is open (host + participant can perform the mute command)
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            // if not host, check the participant is not muting another participant
            if (!this.me.isHost && this.me.id !== userId) {
                this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}", "mute")), err);
            }
            // check the user exists
            const exists = this.privParticipants.getParticipantIndex(userId);
            if (exists === -1) {
                this.handleError(new Error(this.privErrors.invalidParticipantRequest), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMuteCommand(userId, false), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Send a text message
     * @param message
     * @param cb
     * @param err
     */
    sendTextMessageAsync(message, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(message, this.privErrors.invalidArgs.replace("{arg}", "message"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            // TODO: is a max length check required?
            if (message.length > this.privTextMessageMaxLength) {
                this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}", "message length")), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getMessageCommand(message), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Set translated to languages
     * @param {string[]} languages - languages to translate to
     * @param cb
     * @param err
     */
    setTranslatedLanguagesAsync(languages, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfArrayEmptyOrWhitespace(languages, this.privErrors.invalidArgs.replace("{arg}", "languages"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(languages), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Change nickname
     * @param {string} nickname - new nickname for the room
     * @param cb
     * @param err
     */
    changeNicknameAsync(nickname, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privIsDisposed);
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed());
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
            _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrUndefined(this.privRoom, this.privErrors.permissionDeniedSend);
            if (!this.canSend) {
                this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
            }
            if (!!this.privConversationRecognizer) {
                this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(nickname), (() => {
                    this.handleCallback(cb, err);
                }), ((error) => {
                    this.handleError(error, err);
                }));
            }
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose() {
        if (this.isDisposed) {
            return;
        }
        this.privIsDisposed = true;
        if (!!this.config) {
            this.config.close();
        }
        this.privConfig = undefined;
        this.privLanguage = undefined;
        this.privProperties = undefined;
        this.privRoom = undefined;
        this.privToken = undefined;
        this.privManager = undefined;
        this.privIsConnected = false;
        this.privIsReady = false;
        this.privParticipants = undefined;
    }
    connectTranscriberRecognizer(recognizer) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!!this.privTranscriberRecognizer) {
                yield this.privTranscriberRecognizer.close();
            }
            yield recognizer.enforceAudioGating();
            this.privTranscriberRecognizer = recognizer;
            this.privTranscriberRecognizer.conversation = this;
        });
    }
    getKeepAlive() {
        const nickname = (!!this.me) ? this.me.displayName : "default_nickname";
        return JSON.stringify({
            id: "0",
            nickname,
            participantId: this.privRoom.participantId,
            roomId: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.keepAlive
        });
    }
    /* eslint-enable @typescript-eslint/typedef */
    addParticipantImplAsync(participant) {
        const newParticipant = this.privParticipants.addOrUpdateParticipant(participant);
        if (newParticipant !== undefined) {
            if (!!this.privTranscriberRecognizer) {
                const conversationInfo = this.conversationInfo;
                conversationInfo.participants = [participant];
                return this.privTranscriberRecognizer.pushConversationEvent(conversationInfo, "join");
            }
        }
    }
    removeParticipantImplAsync(participant) {
        this.privParticipants.deleteParticipant(participant.id);
        const conversationInfo = this.conversationInfo;
        conversationInfo.participants = [participant];
        return this.privTranscriberRecognizer.pushConversationEvent(conversationInfo, "leave");
    }
    close(dispose) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.privIsConnected = false;
                yield ((_a = this.privConversationRecognizer) === null || _a === void 0 ? void 0 : _a.close());
                this.privConversationRecognizer = undefined;
                if (!!this.privConversationTranslator) {
                    this.privConversationTranslator.dispose();
                }
            }
            catch (e) {
                // ignore error
                throw e;
            }
            if (dispose) {
                this.dispose();
            }
        });
    }
    /** Helpers */
    handleCallback(cb, err) {
        if (!!cb) {
            try {
                cb();
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
            cb = undefined;
        }
    }
    handleError(error, err) {
        if (!!err) {
            if (error instanceof Error) {
                const typedError = error;
                err(typedError.name + ": " + typedError.message);
            }
            else {
                err(error);
            }
        }
    }
    /** Participant Helpers */
    toParticipants(includeHost) {
        const participants = this.privParticipants.participants.map((p) => (this.toParticipant(p)));
        if (!includeHost) {
            return participants.filter((p) => p.isHost === false);
        }
        else {
            return participants;
        }
    }
    toParticipant(p) {
        return new _Exports__WEBPACK_IMPORTED_MODULE_12__.Participant(p.id, p.avatar, p.displayName, p.isHost, p.isMuted, p.isUsingTts, p.preferredLanguage, p.voice);
    }
    getMuteAllCommand(isMuted) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setMuteAll,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: isMuted
        });
    }
    getMuteCommand(participantId, isMuted) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setMute,
            // eslint-disable-next-line object-shorthand
            participantId: participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: isMuted
        });
    }
    getLockCommand(isLocked) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setLockState,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: isLocked
        });
    }
    getEjectCommand(participantId) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.ejectParticipant,
            // eslint-disable-next-line object-shorthand
            participantId: participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
        });
    }
    getSetTranslateToLanguagesCommand(languages) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.setTranslateToLanguages,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: languages
        });
    }
    getChangeNicknameCommand(nickname) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(nickname, "nickname");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        return JSON.stringify({
            command: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorCommandTypes.changeNickname,
            nickname,
            participantId: this.privRoom.participantId,
            roomid: this.privRoom.roomId,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.participantCommand,
            value: nickname
        });
    }
    getMessageCommand(message) {
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId, "conversationId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId, "participantId");
        _Contracts__WEBPACK_IMPORTED_MODULE_0__.Contracts.throwIfNullOrWhitespace(message, "message");
        return JSON.stringify({
            participantId: this.privRoom.participantId,
            roomId: this.privRoom.roomId,
            text: message,
            type: _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.ConversationTranslatorMessageTypes.instantMessage
        });
    }
}

//# sourceMappingURL=Conversation.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationCommon.js":
/*!************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationCommon.js ***!
  \************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationCommon": () => (/* binding */ ConversationCommon)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
class ConversationCommon {
    constructor(audioConfig) {
        this.privAudioConfig = audioConfig;
    }
    handleCallback(cb, err) {
        if (!!cb) {
            try {
                cb();
            }
            catch (e) {
                if (!!err) {
                    err(e);
                }
            }
            cb = undefined;
        }
    }
    handleError(error, err) {
        if (!!err) {
            if (error instanceof Error) {
                const typedError = error;
                err(typedError.name + ": " + typedError.message);
            }
            else {
                err(error);
            }
        }
    }
}

//# sourceMappingURL=ConversationCommon.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js":
/*!*************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationExpirationEventArgs.js ***!
  \*************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationExpirationEventArgs": () => (/* binding */ ConversationExpirationEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationExpirationEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(expirationTime, sessionId) {
        super(sessionId);
        this.privExpirationTime = expirationTime;
    }
    /** How much longer until the conversation expires (in minutes). */
    get expirationTime() {
        return this.privExpirationTime;
    }
}

//# sourceMappingURL=ConversationExpirationEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationParticipantsChangedEventArgs.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationParticipantsChangedEventArgs": () => (/* binding */ ConversationParticipantsChangedEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationParticipantsChangedEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    constructor(reason, participants, sessionId) {
        super(sessionId);
        this.privReason = reason;
        this.privParticipant = participants;
    }
    get reason() {
        return this.privReason;
    }
    get participants() {
        return this.privParticipant;
    }
}

//# sourceMappingURL=ConversationParticipantsChangedEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranscriber.js":
/*!*****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranscriber.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranscriber": () => (/* binding */ ConversationTranscriber)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/TranscriberRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




class ConversationTranscriber {
    /**
     * ConversationTranscriber constructor.
     * @constructor
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    constructor(audioConfig) {
        this.privAudioConfig = audioConfig;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        this.privRecognizer = undefined;
        this.privDisposedRecognizer = false;
    }
    /**
     * Gets the spoken language of recognition.
     * @member ConversationTranscriber.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} The spoken language of recognition.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * The collection of properties and their values defined for this ConversationTranscriber.
     * @member ConversationTranscriber.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this ConversationTranscriber.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * @Internal
     * Internal data member to support fromRecognizer* pattern methods on other classes.
     * Do not use externally, object returned will change without warning or notice.
     */
    get internalData() {
        return this.privRecognizer.internalData;
    }
    /**
     * @Deprecated
     * @Obsolete
     * Please use the Connection.fromRecognizer pattern to obtain a connection object
     */
    get connection() {
        return _Exports__WEBPACK_IMPORTED_MODULE_3__.Connection.fromRecognizer(this.privRecognizer);
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member ConversationTranscriber.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member ConversationTranscriber.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_2__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * @param {Conversation} conversation - conversation to be recognized
     */
    joinConversationAsync(conversation, cb, err) {
        const conversationImpl = conversation;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(conversationImpl, "Conversation");
        // ref the conversation object
        // create recognizer and subscribe to recognizer events
        this.privRecognizer = new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.TranscriberRecognizer(conversation.config, this.privAudioConfig);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(this.privRecognizer, "Recognizer");
        this.privRecognizer.connectCallbacks(this);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_5__.marshalPromiseToCallbacks)(conversationImpl.connectTranscriberRecognizer(this.privRecognizer), cb, err);
    }
    /**
     * Starts conversation transcription, until stopTranscribingAsync() is called.
     * User must subscribe to events to receive transcription results.
     * @member ConversationTranscriber.prototype.startTranscribingAsync
     * @function
     * @public
     * @param cb - Callback invoked once the transcription has started.
     * @param err - Callback invoked in case of an error.
     */
    startTranscribingAsync(cb, err) {
        this.privRecognizer.startContinuousRecognitionAsync(cb, err);
    }
    /**
     * Starts conversation transcription, until stopTranscribingAsync() is called.
     * User must subscribe to events to receive transcription results.
     * @member ConversationTranscriber.prototype.stopTranscribingAsync
     * @function
     * @public
     * @param cb - Callback invoked once the transcription has started.
     * @param err - Callback invoked in case of an error.
     */
    stopTranscribingAsync(cb, err) {
        this.privRecognizer.stopContinuousRecognitionAsync(cb, err);
    }
    /**
     * Leave the current conversation. After this is called, you will no longer receive any events.
     */
    leaveConversationAsync(cb, err) {
        this.privRecognizer.disconnectCallbacks();
        // eslint-disable-next-line
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_5__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () { return; }))(), cb, err);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member ConversationTranscriber.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_5__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * Disposes any resources held by the object.
     * @member ConversationTranscriber.prototype.dispose
     * @function
     * @public
     * @param {boolean} disposing - true if disposing the object.
     */
    dispose(disposing) {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedRecognizer) {
                return;
            }
            if (!!this.privRecognizer) {
                yield this.privRecognizer.close();
                this.privRecognizer = undefined;
            }
            if (disposing) {
                this.privDisposedRecognizer = true;
            }
        });
    }
}

//# sourceMappingURL=ConversationTranscriber.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslationCanceledEventArgs": () => (/* binding */ ConversationTranslationCanceledEventArgs)
/* harmony export */ });
/* harmony import */ var _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../CancellationEventArgsBase */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationEventArgsBase.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationTranslationCanceledEventArgs extends _CancellationEventArgsBase__WEBPACK_IMPORTED_MODULE_0__.CancellationEventArgsBase {
}

//# sourceMappingURL=ConversationTranslationCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js":
/*!**************************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationEventArgs.js ***!
  \**************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslationEventArgs": () => (/* binding */ ConversationTranslationEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationTranslationEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {ConversationTranslationResult} result - The translation recognition result.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the recognition result.
     * @returns {ConversationTranslationResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=ConversationTranslationEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js":
/*!***********************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationResult.js ***!
  \***********************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslationResult": () => (/* binding */ ConversationTranslationResult)
/* harmony export */ });
/* harmony import */ var _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../TranslationRecognitionResult */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.

class ConversationTranslationResult extends _TranslationRecognitionResult__WEBPACK_IMPORTED_MODULE_0__.TranslationRecognitionResult {
    constructor(participantId, translations, originalLanguage, resultId, reason, text, duration, offset, errorDetails, json, properties) {
        super(translations, resultId, reason, text, duration, offset, undefined, undefined, errorDetails, json, properties);
        this.privId = participantId;
        this.privOrigLang = originalLanguage;
    }
    /**
     * The unique identifier for the participant this result is for.
     */
    get participantId() {
        return this.privId;
    }
    /**
     * The original language this result was in.
     */
    get originalLang() {
        return this.privOrigLang;
    }
}

//# sourceMappingURL=ConversationTranslationResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslator.js":
/*!****************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslator.js ***!
  \****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConversationTranslator": () => (/* binding */ ConversationTranslator),
/* harmony export */   "SpeechState": () => (/* binding */ SpeechState)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationConnectionConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _common_speech_Transcription_ConversationTranslatorConnectionFactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common.speech/Transcription/ConversationTranslatorConnectionFactory */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Transcription/ConversationTranslatorConnectionFactory.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechTranslationConfig.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ProfanityOption.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ServicePropertyChannel.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Conversation__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Conversation */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/Conversation.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationTranslationCanceledEventArgs.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ConversationCommon.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable max-classes-per-file */







var SpeechState;
(function (SpeechState) {
    SpeechState[SpeechState["Inactive"] = 0] = "Inactive";
    SpeechState[SpeechState["Connecting"] = 1] = "Connecting";
    SpeechState[SpeechState["Connected"] = 2] = "Connected";
})(SpeechState || (SpeechState = {}));
// child class of TranslationRecognizer meant only for use with ConversationTranslator
class ConversationTranslationRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.TranslationRecognizer {
    constructor(speechConfig, audioConfig, translator, convGetter) {
        super(speechConfig, audioConfig, new _common_speech_Transcription_ConversationTranslatorConnectionFactory__WEBPACK_IMPORTED_MODULE_1__.ConversationTranslatorConnectionFactory(convGetter));
        this.privSpeechState = SpeechState.Inactive;
        if (!!translator) {
            this.privTranslator = translator;
            this.sessionStarted = () => {
                this.privSpeechState = SpeechState.Connected;
            };
            this.sessionStopped = () => {
                this.privSpeechState = SpeechState.Inactive;
            };
            this.recognizing = (tr, e) => {
                if (!!this.privTranslator.recognizing) {
                    this.privTranslator.recognizing(this.privTranslator, e);
                }
            };
            // eslint-disable-next-line @typescript-eslint/no-misused-promises
            this.recognized = (tr, e) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                // if there is an error connecting to the conversation service from the speech service the error will be returned in the ErrorDetails field.
                if ((_a = e.result) === null || _a === void 0 ? void 0 : _a.errorDetails) {
                    yield this.cancelSpeech();
                    // TODO: format the error message contained in 'errorDetails'
                    this.fireCancelEvent(e.result.errorDetails);
                }
                else {
                    if (!!this.privTranslator.recognized) {
                        this.privTranslator.recognized(this.privTranslator, e);
                    }
                }
                return;
            });
            // eslint-disable-next-line @typescript-eslint/no-misused-promises
            this.canceled = () => __awaiter(this, void 0, void 0, function* () {
                if (this.privSpeechState !== SpeechState.Inactive) {
                    try {
                        yield this.cancelSpeech();
                    }
                    catch (error) {
                        this.privSpeechState = SpeechState.Inactive;
                    }
                }
            });
        }
    }
    get state() {
        return this.privSpeechState;
    }
    set state(newState) {
        this.privSpeechState = newState;
    }
    onConnection() {
        this.privSpeechState = SpeechState.Connected;
    }
    onDisconnection() {
        return __awaiter(this, void 0, void 0, function* () {
            this.privSpeechState = SpeechState.Inactive;
            yield this.cancelSpeech();
        });
    }
    /**
     * Fire a cancel event
     * @param error
     */
    fireCancelEvent(error) {
        try {
            if (!!this.privTranslator.canceled) {
                const cancelEvent = new _Exports__WEBPACK_IMPORTED_MODULE_2__.ConversationTranslationCanceledEventArgs(_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationReason.Error, error, _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.RuntimeError);
                this.privTranslator.canceled(this.privTranslator, cancelEvent);
            }
        }
        catch (e) {
            //
        }
    }
    cancelSpeech() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.stopContinuousRecognitionAsync();
                yield ((_a = this.privReco) === null || _a === void 0 ? void 0 : _a.disconnect());
                this.privSpeechState = SpeechState.Inactive;
            }
            catch (e) {
                // ignore the error
            }
        });
    }
}
/**
 * Join, leave or connect to a conversation.
 */
class ConversationTranslator extends _Exports__WEBPACK_IMPORTED_MODULE_5__.ConversationCommon {
    constructor(audioConfig) {
        super(audioConfig);
        this.privErrors = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.ConversationConnectionConfig.restErrors;
        this.privIsDisposed = false;
        this.privIsSpeaking = false;
        this.privPlaceholderKey = "abcdefghijklmnopqrstuvwxyz012345";
        this.privPlaceholderRegion = "westus";
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_7__.PropertyCollection();
    }
    get properties() {
        return this.privProperties;
    }
    get speechRecognitionLanguage() {
        return this.privSpeechRecognitionLanguage;
    }
    get participants() {
        var _a;
        return (_a = this.privConversation) === null || _a === void 0 ? void 0 : _a.participants;
    }
    get canSpeak() {
        // is there a Conversation websocket available and has the Recognizer been set up
        if (!this.privConversation.isConnected || !this.privCTRecognizer) {
            return false;
        }
        // is the user already speaking
        if (this.privIsSpeaking || this.privCTRecognizer.state === SpeechState.Connected || this.privCTRecognizer.state === SpeechState.Connecting) {
            return false;
        }
        // is the user muted
        if (this.privConversation.isMutedByHost) {
            return false;
        }
        return true;
    }
    setServiceProperty(name, value) {
        const currentProperties = JSON.parse(this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.ServicePropertiesPropertyName, "{}"));
        currentProperties[name] = value;
        this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.ServicePropertiesPropertyName, JSON.stringify(currentProperties));
    }
    joinConversationAsync(conversation, nickname, param1, param2, param3) {
        try {
            if (typeof conversation === "string") {
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(conversation, this.privErrors.invalidArgs.replace("{arg}", "conversation id"));
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
                if (!!this.privConversation) {
                    this.handleError(new Error(this.privErrors.permissionDeniedStart), param3);
                }
                let lang = param1;
                if (lang === undefined || lang === null || lang === "") {
                    lang = _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.ConversationConnectionConfig.defaultLanguageCode;
                }
                // create a placeholder config
                this.privSpeechTranslationConfig = _Exports__WEBPACK_IMPORTED_MODULE_10__.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey, this.privPlaceholderRegion);
                this.privSpeechTranslationConfig.setProfanity(_Exports__WEBPACK_IMPORTED_MODULE_11__.ProfanityOption.Masked);
                this.privSpeechTranslationConfig.addTargetLanguage(lang);
                this.privSpeechTranslationConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_RecoLanguage], lang);
                this.privSpeechTranslationConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.ConversationTranslator_Name], nickname);
                const propertyIdsToCopy = [
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Host,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.ConversationTranslator_Host,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Endpoint,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyHostName,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyPassword,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyPort,
                    _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_ProxyUserName,
                    "ConversationTranslator_MultiChannelAudio",
                    "ConversationTranslator_Region"
                ];
                for (const prop of propertyIdsToCopy) {
                    const value = this.privProperties.getProperty(prop);
                    if (value) {
                        const key = typeof prop === "string" ? prop : _Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[prop];
                        this.privSpeechTranslationConfig.setProperty(key, value);
                    }
                }
                const currentProperties = JSON.parse(this.privProperties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.ServicePropertiesPropertyName, "{}"));
                for (const prop of Object.keys(currentProperties)) {
                    this.privSpeechTranslationConfig.setServiceProperty(prop, currentProperties[prop], _Exports__WEBPACK_IMPORTED_MODULE_13__.ServicePropertyChannel.UriQueryParameter);
                }
                // join the conversation
                this.privConversation = new _Conversation__WEBPACK_IMPORTED_MODULE_14__.ConversationImpl(this.privSpeechTranslationConfig);
                this.privConversation.conversationTranslator = this;
                this.privConversation.joinConversationAsync(conversation, nickname, lang, ((result) => {
                    if (!result) {
                        this.handleError(new Error(this.privErrors.permissionDeniedConnect), param3);
                    }
                    this.privSpeechTranslationConfig.authorizationToken = result;
                    this.privConversation.room.isHost = false;
                    // connect to the ws
                    this.privConversation.startConversationAsync((() => {
                        this.handleCallback(param2, param3);
                    }), ((error) => {
                        this.handleError(error, param3);
                    }));
                }), ((error) => {
                    this.handleError(error, param3);
                }));
            }
            else if (typeof conversation === "object") {
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(conversation, this.privErrors.invalidArgs.replace("{arg}", "conversation id"));
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrWhitespace(nickname, this.privErrors.invalidArgs.replace("{arg}", "nickname"));
                // save the nickname
                this.privProperties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.ConversationTranslator_Name, nickname);
                // ref the conversation object
                this.privConversation = conversation;
                // ref the conversation translator object
                this.privConversation.conversationTranslator = this;
                this.privConversation.room.isHost = true;
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation, this.privErrors.permissionDeniedConnect);
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation.room.token, this.privErrors.permissionDeniedConnect);
                this.privSpeechTranslationConfig = conversation.config;
                this.handleCallback(param1, param2);
            }
            else {
                this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}", "invalid conversation type")), param2);
            }
        }
        catch (error) {
            this.handleError(error, typeof param1 === "string" ? param3 : param2);
        }
    }
    /**
     * Leave the conversation
     * @param cb
     * @param err
     */
    leaveConversationAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            // stop the speech websocket
            yield this.cancelSpeech();
            // stop the websocket
            yield this.privConversation.endConversationImplAsync();
            // https delete request
            yield this.privConversation.deleteConversationImplAsync();
            this.dispose();
        }))(), cb, err);
    }
    /**
     * Send a text message
     * @param message
     * @param cb
     * @param err
     */
    sendTextMessageAsync(message, cb, err) {
        try {
            _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation, this.privErrors.permissionDeniedSend);
            _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrWhitespace(message, this.privErrors.invalidArgs.replace("{arg}", message));
            this.privConversation.sendTextMessageAsync(message, cb, err);
        }
        catch (error) {
            this.handleError(error, err);
        }
    }
    /**
     * Start speaking
     * @param cb
     * @param err
     */
    startTranscribingAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            try {
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation, this.privErrors.permissionDeniedSend);
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privConversation.room.token, this.privErrors.permissionDeniedConnect);
                if (this.privCTRecognizer === undefined) {
                    yield this.connectTranslatorRecognizer();
                }
                _Contracts__WEBPACK_IMPORTED_MODULE_9__.Contracts.throwIfNullOrUndefined(this.privCTRecognizer, this.privErrors.permissionDeniedSend);
                if (!this.canSpeak) {
                    this.handleError(new Error(this.privErrors.permissionDeniedSend), err);
                }
                yield this.startContinuousRecognition();
                this.privIsSpeaking = true;
            }
            catch (error) {
                this.privIsSpeaking = false;
                yield this.cancelSpeech();
                throw error;
            }
        }))(), cb, err);
    }
    /**
     * Stop speaking
     * @param cb
     * @param err
     */
    stopTranscribingAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            try {
                if (!this.privIsSpeaking) {
                    // stop speech
                    yield this.cancelSpeech();
                    return;
                }
                // stop the recognition but leave the websocket open
                this.privIsSpeaking = false;
                yield new Promise((resolve, reject) => {
                    this.privCTRecognizer.stopContinuousRecognitionAsync(resolve, reject);
                });
            }
            catch (error) {
                yield this.cancelSpeech();
            }
        }))(), cb, err);
    }
    isDisposed() {
        return this.privIsDisposed;
    }
    dispose(reason, success, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_15__.marshalPromiseToCallbacks)((() => __awaiter(this, void 0, void 0, function* () {
            if (this.isDisposed && !this.privIsSpeaking) {
                return;
            }
            yield this.cancelSpeech();
            this.privIsDisposed = true;
            this.privSpeechTranslationConfig.close();
            this.privSpeechRecognitionLanguage = undefined;
            this.privProperties = undefined;
            this.privAudioConfig = undefined;
            this.privSpeechTranslationConfig = undefined;
            this.privConversation.dispose();
            this.privConversation = undefined;
        }))(), success, err);
    }
    /**
     * Cancel the speech websocket
     */
    cancelSpeech() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            try {
                this.privIsSpeaking = false;
                yield ((_a = this.privCTRecognizer) === null || _a === void 0 ? void 0 : _a.onDisconnection());
                this.privCTRecognizer = undefined;
            }
            catch (e) {
                // ignore the error
            }
        });
    }
    /**
     * Connect to the speech translation recognizer.
     * Currently there is no language validation performed before sending the SpeechLanguage code to the service.
     * If it's an invalid language the raw error will be: 'Error during WebSocket handshake: Unexpected response code: 400'
     * e.g. pass in 'fr' instead of 'fr-FR', or a text-only language 'cy'
     */
    connectTranslatorRecognizer() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                if (this.privAudioConfig === undefined) {
                    this.privAudioConfig = _Exports__WEBPACK_IMPORTED_MODULE_16__.AudioConfig.fromDefaultMicrophoneInput();
                }
                // clear the temp subscription key if it's a participant joining
                if (this.privSpeechTranslationConfig.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Key])
                    === this.privPlaceholderKey) {
                    this.privSpeechTranslationConfig.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_12__.PropertyId.SpeechServiceConnection_Key], "");
                }
                const convGetter = () => this.privConversation;
                this.privCTRecognizer = new ConversationTranslationRecognizer(this.privSpeechTranslationConfig, this.privAudioConfig, this, convGetter);
            }
            catch (error) {
                yield this.cancelSpeech();
                throw error;
            }
        });
    }
    /**
     * Handle the start speaking request
     */
    startContinuousRecognition() {
        return new Promise((resolve, reject) => {
            this.privCTRecognizer.startContinuousRecognitionAsync(resolve, reject);
        });
    }
}

//# sourceMappingURL=ConversationTranslator.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/IParticipant.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Participant": () => (/* binding */ Participant),
/* harmony export */   "User": () => (/* binding */ User)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
/* eslint-disable max-classes-per-file */

class User {
    constructor(userId) {
        this.privUserId = userId;
    }
    get userId() {
        return this.privUserId;
    }
}
class Participant {
    constructor(id, avatar, displayName, isHost, isMuted, isUsingTts, preferredLanguage, voice) {
        this.privId = id;
        this.privAvatar = avatar;
        this.privDisplayName = displayName;
        this.privIsHost = isHost;
        this.privIsMuted = isMuted;
        this.privIsUsingTts = isUsingTts;
        this.privPreferredLanguage = preferredLanguage;
        this.privVoice = voice;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
    }
    get avatar() {
        return this.privAvatar;
    }
    get displayName() {
        return this.privDisplayName;
    }
    get id() {
        return this.privId;
    }
    get preferredLanguage() {
        return this.privPreferredLanguage;
    }
    get isHost() {
        return this.privIsHost;
    }
    get isMuted() {
        return this.privIsMuted;
    }
    get isUsingTts() {
        return this.privIsUsingTts;
    }
    get voice() {
        return this.privVoice;
    }
    get properties() {
        return this.privProperties;
    }
    static From(id, language, voice) {
        return new Participant(id, "", id, false, false, false, language, voice);
    }
}

//# sourceMappingURL=IParticipant.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js":
/*!******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Transcription/ParticipantChangedReason.js ***!
  \******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ParticipantChangedReason": () => (/* binding */ ParticipantChangedReason)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
// Multi-device Conversation is a Preview feature.
var ParticipantChangedReason;
(function (ParticipantChangedReason) {
    /** Participant has joined the conversation. */
    ParticipantChangedReason[ParticipantChangedReason["JoinedConversation"] = 0] = "JoinedConversation";
    /** Participant has left the conversation. This could be voluntary, or involuntary
     * (e.g. they are experiencing networking issues).
     */
    ParticipantChangedReason[ParticipantChangedReason["LeftConversation"] = 1] = "LeftConversation";
    /** The participants' state has changed (e.g. they became muted, changed their nickname). */
    ParticipantChangedReason[ParticipantChangedReason["Updated"] = 2] = "Updated";
})(ParticipantChangedReason || (ParticipantChangedReason = {}));

//# sourceMappingURL=ParticipantChangedReason.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js":
/*!*******************************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionCanceledEventArgs.js ***!
  \*******************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognitionCanceledEventArgs": () => (/* binding */ TranslationRecognitionCanceledEventArgs)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Define payload of speech recognition canceled result events.
 * @class TranslationRecognitionCanceledEventArgs
 */
class TranslationRecognitionCanceledEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} sessionid - The session id.
     * @param {CancellationReason} cancellationReason - The cancellation reason.
     * @param {string} errorDetails - Error details, if provided.
     * @param {TranslationRecognitionResult} result - The result.
     */
    constructor(sessionid, cancellationReason, errorDetails, errorCode, result) {
        this.privCancelReason = cancellationReason;
        this.privErrorDetails = errorDetails;
        this.privResult = result;
        this.privSessionId = sessionid;
        this.privErrorCode = errorCode;
    }
    /**
     * Specifies the recognition result.
     * @member TranslationRecognitionCanceledEventArgs.prototype.result
     * @function
     * @public
     * @returns {TranslationRecognitionResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
    /**
     * Specifies the session identifier.
     * @member TranslationRecognitionCanceledEventArgs.prototype.sessionId
     * @function
     * @public
     * @returns {string} the session identifier.
     */
    get sessionId() {
        return this.privSessionId;
    }
    /**
     * The reason the recognition was canceled.
     * @member TranslationRecognitionCanceledEventArgs.prototype.reason
     * @function
     * @public
     * @returns {CancellationReason} Specifies the reason canceled.
     */
    get reason() {
        return this.privCancelReason;
    }
    /**
     * The error code in case of an unsuccessful recognition.
     * Added in version 1.1.0.
     * @return An error code that represents the error reason.
     */
    get errorCode() {
        return this.privErrorCode;
    }
    /**
     * In case of an unsuccessful recognition, provides details of the occurred error.
     * @member TranslationRecognitionCanceledEventArgs.prototype.errorDetails
     * @function
     * @public
     * @returns {string} A String that represents the error details.
     */
    get errorDetails() {
        return this.privErrorDetails;
    }
}

//# sourceMappingURL=TranslationRecognitionCanceledEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js":
/*!***********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionEventArgs.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognitionEventArgs": () => (/* binding */ TranslationRecognitionEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/RecognitionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Translation text result event arguments.
 * @class TranslationRecognitionEventArgs
 */
class TranslationRecognitionEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.RecognitionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {TranslationRecognitionResult} result - The translation recognition result.
     * @param {number} offset - The offset.
     * @param {string} sessionId - The session id.
     */
    constructor(result, offset, sessionId) {
        super(offset, sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the recognition result.
     * @member TranslationRecognitionEventArgs.prototype.result
     * @function
     * @public
     * @returns {TranslationRecognitionResult} the recognition result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=TranslationRecognitionEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognitionResult.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognitionResult": () => (/* binding */ TranslationRecognitionResult)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SpeechRecognitionResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Translation text result.
 * @class TranslationRecognitionResult
 */
class TranslationRecognitionResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SpeechRecognitionResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {Translations} translations - The translations.
     * @param {string} resultId - The result id.
     * @param {ResultReason} reason - The reason.
     * @param {string} text - The recognized text.
     * @param {number} duration - The duration.
     * @param {number} offset - The offset into the stream.
     * @param {string} language - Primary Language detected, if provided.
     * @param {string} languageDetectionConfidence - Primary Language confidence ("Unknown," "Low," "Medium," "High"...), if provided.
     * @param {string} errorDetails - Error details, if provided.
     * @param {string} json - Additional Json, if provided.
     * @param {PropertyCollection} properties - Additional properties, if provided.
     */
    constructor(translations, resultId, reason, text, duration, offset, language, languageDetectionConfidence, errorDetails, json, properties) {
        super(resultId, reason, text, duration, offset, language, languageDetectionConfidence, undefined, errorDetails, json, properties);
        this.privTranslations = translations;
    }
    static fromSpeechRecognitionResult(result) {
        return new TranslationRecognitionResult(undefined, result.resultId, result.reason, result.text, result.duration, result.offset, result.language, result.languageDetectionConfidence, result.errorDetails, result.json, result.properties);
    }
    /**
     * Presents the translation results. Each item in the dictionary represents
     * a translation result in one of target languages, where the key is the name
     * of the target language, in BCP-47 format, and the value is the translation
     * text in the specified language.
     * @member TranslationRecognitionResult.prototype.translations
     * @function
     * @public
     * @returns {Translations} the current translation map that holds all translations requested.
     */
    get translations() {
        return this.privTranslations;
    }
}

//# sourceMappingURL=TranslationRecognitionResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js":
/*!*************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationRecognizer.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationRecognizer": () => (/* binding */ TranslationRecognizer)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/TranslationServiceRecognizer.js");
/* harmony import */ var _common_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common/Promise.js");
/* harmony import */ var _Connection__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Connection */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Connection.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





/**
 * Translation recognizer
 * @class TranslationRecognizer
 */
class TranslationRecognizer extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * Initializes an instance of the TranslationRecognizer.
     * @constructor
     * @param {SpeechTranslationConfig} speechConfig - Set of properties to configure this recognizer.
     * @param {AudioConfig} audioConfig - An optional audio config associated with the recognizer
     * @param {IConnectionFactory} connectionFactory - An optional connection factory to use to generate the endpoint URIs, headers to set, etc...
     */
    constructor(speechConfig, audioConfig, connectionFactory) {
        const configImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(configImpl, "speechConfig");
        super(audioConfig, configImpl.properties, connectionFactory || new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.TranslationConnectionFactory());
        this.privDisposedTranslationRecognizer = false;
        if (this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice, undefined) !== undefined) {
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice]);
        }
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages]);
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage), _Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId[_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage]);
    }
    /**
     * TranslationRecognizer constructor.
     * @constructor
     * @param {SpeechTranslationConfig} speechTranslationConfig - an set of initial properties for this recognizer
     * @param {AutoDetectSourceLanguageConfig} autoDetectSourceLanguageConfig - An source language detection configuration associated with the recognizer
     * @param {AudioConfig} audioConfig - An optional audio configuration associated with the recognizer
     */
    static FromConfig(speechTranslationConfig, autoDetectSourceLanguageConfig, audioConfig) {
        const speechTranslationConfigImpl = speechTranslationConfig;
        autoDetectSourceLanguageConfig.properties.mergeTo(speechTranslationConfigImpl.properties);
        return new TranslationRecognizer(speechTranslationConfig, audioConfig);
    }
    /**
     * Gets the language name that was set when the recognizer was created.
     * @member TranslationRecognizer.prototype.speechRecognitionLanguage
     * @function
     * @public
     * @returns {string} Gets the language name that was set when the recognizer was created.
     */
    get speechRecognitionLanguage() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_RecoLanguage);
    }
    /**
     * Gets target languages for translation that were set when the recognizer was created.
     * The language is specified in BCP-47 format. The translation will provide translated text for each of language.
     * @member TranslationRecognizer.prototype.targetLanguages
     * @function
     * @public
     * @returns {string[]} Gets target languages for translation that were set when the recognizer was created.
     */
    get targetLanguages() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
    }
    /**
     * Gets the name of output voice.
     * @member TranslationRecognizer.prototype.voiceName
     * @function
     * @public
     * @returns {string} the name of output voice.
     */
    get voiceName() {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationVoice, undefined);
    }
    /**
     * The collection of properties and their values defined for this TranslationRecognizer.
     * @member TranslationRecognizer.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this TranslationRecognizer.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member TranslationRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member TranslationRecognizer.prototype.authorizationToken
     * @function
     * @public
     * @param {string} value - Authorization token.
     */
    set authorizationToken(value) {
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceAuthorization_Token, value);
    }
    /**
     * Starts recognition and translation, and stops after the first utterance is recognized.
     * The task returns the translation text as result.
     * Note: recognizeOnceAsync returns when the first utterance has been recognized, so it is suitable only
     * for single shot recognition like command or query. For long-running recognition,
     * use startContinuousRecognitionAsync() instead.
     * @member TranslationRecognizer.prototype.recognizeOnceAsync
     * @function
     * @public
     * @param cb - Callback that received the result when the translation has completed.
     * @param err - Callback invoked in case of an error.
     */
    recognizeOnceAsync(cb, err) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Starts recognition and translation, until stopContinuousRecognitionAsync() is called.
     * User must subscribe to events to receive translation results.
     * @member TranslationRecognizer.prototype.startContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback that received the translation has started.
     * @param err - Callback invoked in case of an error.
     */
    startContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognitionMode.Conversation), cb, err);
    }
    /**
     * Stops continuous recognition and translation.
     * @member TranslationRecognizer.prototype.stopContinuousRecognitionAsync
     * @function
     * @public
     * @param cb - Callback that received the translation has stopped.
     * @param err - Callback invoked in case of an error.
     */
    stopContinuousRecognitionAsync(cb, err) {
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(), cb, err);
    }
    /**
     * dynamically remove a language from list of target language
     * (can be used while recognition is ongoing)
     * @member TranslationRecognizer.prototype.removeTargetLanguage
     * @function
     * @param lang - language to be removed
     * @public
     */
    removeTargetLanguage(lang) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(lang, "language to be removed");
        if (this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, undefined) !== undefined) {
            const languages = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
            const index = languages.indexOf(lang);
            if (index > -1) {
                languages.splice(index, 1);
                this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, languages.join(","));
                this.updateLanguages(languages);
            }
        }
    }
    /**
     * dynamically add a language to list of target language
     * (can be used while recognition is ongoing)
     * @member TranslationRecognizer.prototype.addTargetLanguage
     * @function
     * @param lang - language to be added
     * @public
     */
    addTargetLanguage(lang) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(lang, "language to be added");
        let languages = [];
        if (this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, undefined) !== undefined) {
            languages = this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",");
            if (!languages.includes(lang)) {
                languages.push(lang);
                this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, languages.join(","));
            }
        }
        else {
            this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_3__.PropertyId.SpeechServiceConnection_TranslationToLanguages, lang);
            languages = [lang];
        }
        this.updateLanguages(languages);
    }
    /**
     * closes all external resources held by an instance of this class.
     * @member TranslationRecognizer.prototype.close
     * @function
     * @public
     */
    close(cb, errorCb) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer);
        (0,_common_Exports__WEBPACK_IMPORTED_MODULE_4__.marshalPromiseToCallbacks)(this.dispose(true), cb, errorCb);
    }
    /**
     * handles ConnectionEstablishedEvent for conversation translation scenarios.
     * @member TranslationRecognizer.prototype.onConnection
     * @function
     * @public
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    onConnection() { }
    /**
     * handles disconnection events for conversation translation scenarios.
     * @member TranslationRecognizer.prototype.onDisconnection
     * @function
     * @public
     */
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    onDisconnection() {
        return __awaiter(this, void 0, void 0, function* () { });
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedTranslationRecognizer) {
                return;
            }
            this.privDisposedTranslationRecognizer = true;
            if (disposing) {
                yield this.implRecognizerStop();
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_5__.RecognizerConfig(speechConfig, this.privProperties);
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const configImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_6__.TranslationServiceRecognizer(authentication, connectionFactory, configImpl, recognizerConfig, this);
    }
    updateLanguages(languages) {
        const conn = _Connection__WEBPACK_IMPORTED_MODULE_7__.Connection.fromRecognizer(this);
        if (!!conn) {
            conn.setMessageProperty("speech.context", "translationcontext", { to: languages });
            conn.sendMessageAsync("event", JSON.stringify({
                id: "translation",
                name: "updateLanguage",
                to: languages
            }));
        }
    }
}

//# sourceMappingURL=TranslationRecognizer.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js":
/*!*********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisEventArgs.js ***!
  \*********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationSynthesisEventArgs": () => (/* binding */ TranslationSynthesisEventArgs)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/SessionEventArgs.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Translation Synthesis event arguments
 * @class TranslationSynthesisEventArgs
 */
class TranslationSynthesisEventArgs extends _Exports__WEBPACK_IMPORTED_MODULE_0__.SessionEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {TranslationSynthesisResult} result - The translation synthesis result.
     * @param {string} sessionId - The session id.
     */
    constructor(result, sessionId) {
        super(sessionId);
        this.privResult = result;
    }
    /**
     * Specifies the translation synthesis result.
     * @member TranslationSynthesisEventArgs.prototype.result
     * @function
     * @public
     * @returns {TranslationSynthesisResult} Specifies the translation synthesis result.
     */
    get result() {
        return this.privResult;
    }
}

//# sourceMappingURL=TranslationSynthesisEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TranslationSynthesisResult.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TranslationSynthesisResult": () => (/* binding */ TranslationSynthesisResult)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines translation synthesis result, i.e. the voice output of the translated
 * text in the target language.
 * @class TranslationSynthesisResult
 */
class TranslationSynthesisResult {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {ResultReason} reason - The synthesis reason.
     * @param {ArrayBuffer} audio - The audio data.
     */
    constructor(reason, audio) {
        this.privReason = reason;
        this.privAudio = audio;
    }
    /**
     * Translated text in the target language.
     * @member TranslationSynthesisResult.prototype.audio
     * @function
     * @public
     * @returns {ArrayBuffer} Translated audio in the target language.
     */
    get audio() {
        return this.privAudio;
    }
    /**
     * The synthesis status.
     * @member TranslationSynthesisResult.prototype.reason
     * @function
     * @public
     * @returns {ResultReason} The synthesis status.
     */
    get reason() {
        return this.privReason;
    }
}

//# sourceMappingURL=TranslationSynthesisResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Translations.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Translations": () => (/* binding */ Translations)
/* harmony export */ });
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Represents collection of parameters and their values.
 * @class Translations
 */
class Translations {
    constructor() {
        // Use an PropertyCollection internally, just wrapping it to hide the | enum syntax it has.
        this.privMap = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
    }
    /**
     * Get the languages in the object in a String array.
     * @member Translations.prototype.languages
     * @function
     * @public
     * @returns {string[]} languages in translations object.
     */
    get languages() {
        return this.privMap.keys;
    }
    /**
     * Returns the parameter value in type String. The parameter must have the same type as String.
     * Currently only String, int and bool are allowed.
     * If the name is not available, the specified defaultValue is returned.
     * @member Translations.prototype.get
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string} def - The default value which is returned if the parameter is not available in the collection.
     * @returns {string} value of the parameter.
     */
    get(key, def) {
        return this.privMap.getProperty(key, def);
    }
    /**
     * Sets the String value of the parameter specified by name.
     * @member Translations.prototype.set
     * @function
     * @public
     * @param {string} key - The parameter name.
     * @param {string} value - The value of the parameter.
     */
    set(key, value) {
        this.privMap.setProperty(key, value);
    }
}

//# sourceMappingURL=Translations.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js":
/*!*******************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/TurnStatusReceivedEventArgs.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TurnStatusReceivedEventArgs": () => (/* binding */ TurnStatusReceivedEventArgs)
/* harmony export */ });
/* harmony import */ var _common_speech_ServiceMessages_TurnStatusPayload__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common.speech/ServiceMessages/TurnStatusPayload */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/ServiceMessages/TurnStatusPayload.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

/**
 * Defines contents of received message/events.
 * @class TurnStatusReceivedEventArgs
 */
class TurnStatusReceivedEventArgs {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} turnStatus - The JSON-encoded turn status message.
     */
    constructor(turnStatus) {
        this.privTurnStatus = _common_speech_ServiceMessages_TurnStatusPayload__WEBPACK_IMPORTED_MODULE_0__.TurnStatusResponsePayload.fromJSON(turnStatus);
    }
    /**
     * Gets the interaction identifier associated with this turn status event.
     * @member TurnStatusReceivedEventArgs.prototype.interactionId
     * @function
     * @public
     * @returns {any} the received interaction id.
     */
    get interactionId() {
        return this.privTurnStatus.interactionId;
    }
    /**
     * Gets the conversation identifier associated with this turn status event.
     * @member TurnStatusReceivedEventArgs.prototype.conversationId
     * @function
     * @public
     * @returns {any} the received conversation id.
     */
    get conversationId() {
        return this.privTurnStatus.conversationId;
    }
    /**
     * Gets the received turn status code.
     * @member TurnStatusReceivedEventArgs.prototype.statusCode
     * @function
     * @public
     * @returns {number} the received turn status.
     */
    get statusCode() {
        return this.privTurnStatus.statusCode; // eslint-disable-line @typescript-eslint/no-unsafe-return
    }
}

//# sourceMappingURL=TurnStatusReceivedEventArgs.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceInfo.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SynthesisVoiceGender": () => (/* binding */ SynthesisVoiceGender),
/* harmony export */   "SynthesisVoiceType": () => (/* binding */ SynthesisVoiceType),
/* harmony export */   "VoiceInfo": () => (/* binding */ VoiceInfo)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines the gender of synthesis voices.
 * Added in version 1.20.0.
 */
var SynthesisVoiceGender;
(function (SynthesisVoiceGender) {
    /** Gender unknown */
    SynthesisVoiceGender[SynthesisVoiceGender["Unknown"] = 0] = "Unknown";
    /** Female voice */
    SynthesisVoiceGender[SynthesisVoiceGender["Female"] = 1] = "Female";
    /** Male voice */
    SynthesisVoiceGender[SynthesisVoiceGender["Male"] = 2] = "Male";
})(SynthesisVoiceGender || (SynthesisVoiceGender = {}));
var SynthesisVoiceType;
(function (SynthesisVoiceType) {
    SynthesisVoiceType[SynthesisVoiceType["OnlineNeural"] = 1] = "OnlineNeural";
    SynthesisVoiceType[SynthesisVoiceType["OnlineStandard"] = 2] = "OnlineStandard";
    SynthesisVoiceType[SynthesisVoiceType["OfflineNeural"] = 3] = "OfflineNeural";
    SynthesisVoiceType[SynthesisVoiceType["OfflineStandard"] = 4] = "OfflineStandard";
})(SynthesisVoiceType || (SynthesisVoiceType = {}));
/**
 * Information about Speech Synthesis voice
 * Added in version 1.20.0.
 * @class VoiceInfo
 */
class VoiceInfo {
    constructor(json) {
        this.privStyleList = [];
        this.privVoicePath = "";
        if (!!json) {
            this.privName = json.Name;
            this.privLocale = json.Locale;
            this.privShortName = json.ShortName;
            this.privLocaleName = json.LocaleName;
            this.privLocalName = json.LocalName;
            this.privVoiceType = json.VoiceType.endsWith("Standard") ? SynthesisVoiceType.OnlineStandard : SynthesisVoiceType.OnlineNeural;
            this.privGender = json.Gender === "Male" ? SynthesisVoiceGender.Male : json.Gender === "Female" ? SynthesisVoiceGender.Female : SynthesisVoiceGender.Unknown;
            if (!!json.StyleList && Array.isArray(json.StyleList)) {
                for (const style of json.StyleList) {
                    this.privStyleList.push(style);
                }
            }
        }
    }
    get name() {
        return this.privName;
    }
    get locale() {
        return this.privLocale;
    }
    get shortName() {
        return this.privShortName;
    }
    get localName() {
        return this.privLocalName;
    }
    get localeName() {
        return this.privLocaleName;
    }
    get gender() {
        return this.privGender;
    }
    get voiceType() {
        return this.privVoiceType;
    }
    get styleList() {
        return this.privStyleList;
    }
    get voicePath() {
        return this.privVoicePath;
    }
}

//# sourceMappingURL=VoiceInfo.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfile": () => (/* binding */ VoiceProfile)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Defines Voice Profile class for Speaker Recognition
 * @class VoiceProfile
 */
class VoiceProfile {
    /**
     * Creates and initializes an instance of this class.
     * @constructor
     * @param {string} profileId - profileId of this Voice Profile.
     * @param {VoiceProfileType} profileType - profileType of this Voice Profile.
     */
    constructor(profileId, profileType) {
        this.privId = profileId;
        this.privProfileType = profileType;
    }
    /**
     * profileId of this Voice Profile instance
     * @member VoiceProfile.prototype.profileId
     * @function
     * @public
     * @returns {string} profileId of this Voice Profile instance.
     */
    get profileId() {
        return this.privId;
    }
    /**
     * profileType of this Voice Profile instance
     * @member VoiceProfile.prototype.profileType
     * @function
     * @public
     * @returns {VoiceProfileType} profile type of this Voice Profile instance.
     */
    get profileType() {
        return this.privProfileType;
    }
}

//# sourceMappingURL=VoiceProfile.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileClient.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileClient.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileClient": () => (/* binding */ VoiceProfileClient)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/SpeakerRecognitionConnectionFactory.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/VoiceServiceRecognizer.js");
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/RecognizerConfig.js");
/* harmony import */ var _Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Audio/AudioConfig */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioConfig.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Recognizer.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Audio/AudioInputStream.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyId.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfile.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/**
 * Defines VoiceProfileClient class for Speaker Recognition
 * Handles operations from user for Voice Profile operations (e.g. createProfile, deleteProfile)
 * @class VoiceProfileClient
 */
class VoiceProfileClient extends _Exports__WEBPACK_IMPORTED_MODULE_0__.Recognizer {
    /**
     * VoiceProfileClient constructor.
     * @constructor
     * @param {SpeechConfig} speechConfig - An set of initial properties for this synthesizer (authentication key, region, &c)
     */
    constructor(speechConfig) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(speechConfig, "speechConfig");
        const speechConfigImpl = speechConfig;
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNull(speechConfigImpl, "speechConfig");
        super(_Audio_AudioConfig__WEBPACK_IMPORTED_MODULE_2__.AudioConfig.fromStreamInput(_Exports__WEBPACK_IMPORTED_MODULE_3__.AudioInputStream.createPushStream()), speechConfigImpl.properties, new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_4__.VoiceProfileConnectionFactory());
        this.privProperties = speechConfigImpl.properties.clone();
        this.privVoiceAdapter = this.privReco;
        this.privDisposedVoiceAdapter = false;
    }
    /**
     * The collection of properties and their values defined for this VoiceProfileClient.
     * @member VoiceProfileClient.prototype.properties
     * @function
     * @public
     * @returns {PropertyCollection} The collection of properties and their values defined for this VoiceProfileClient.
     */
    get properties() {
        return this.privProperties;
    }
    /**
     * Gets the authorization token used to communicate with the service.
     * @member VoiceProfileClient.prototype.authorizationToken
     * @function
     * @public
     * @returns {string} Authorization token.
     */
    get authorizationToken() {
        return this.properties.getProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token);
    }
    /**
     * Gets/Sets the authorization token used to communicate with the service.
     * @member VoiceProfileClient.prototype.authorizationToken
     * @function
     * @public
     * @param {string} token - Authorization token.
     */
    set authorizationToken(token) {
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrWhitespace(token, "token");
        this.properties.setProperty(_Exports__WEBPACK_IMPORTED_MODULE_5__.PropertyId.SpeechServiceAuthorization_Token, token);
    }
    /**
     * Create a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.createProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfileType} profileType Type of Voice Profile to be created
     * @param {string} lang Language string (locale) for Voice Profile
     * @return {Promise<VoiceProfile>} - Promise of a VoiceProfile.
     */
    createProfileAsync(profileType, lang) {
        return __awaiter(this, void 0, void 0, function* () {
            const profileIds = yield this.privVoiceAdapter.createProfile(profileType, lang);
            return new _Exports__WEBPACK_IMPORTED_MODULE_6__.VoiceProfile(profileIds[0], profileType);
        });
    }
    /**
     * Get current information of a voice profile
     * @member VoiceProfileClient.prototype.retrieveEnrollmentResultAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to retrieve info for
     * @return {Promise<VoiceProfileEnrollmentResult>} - Promise of a VoiceProfileEnrollmentResult.
     */
    retrieveEnrollmentResultAsync(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.retrieveEnrollmentResult(profile);
        });
    }
    /**
     * Get all voice profiles on account with given voice profile type
     * @member VoiceProfileClient.prototype.getAllProfilesAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfileType} profileType profile type (identification/verification) for which to list profiles
     * @return {Promise<VoiceProfileEnrollmentResult[]>} - Promise of an array of VoiceProfileEnrollmentResults.
     */
    getAllProfilesAsync(profileType) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.getAllProfiles(profileType);
            /*
            const result: { json: { value: EnrollmentResultJSON[] } } = await this.privAdapter.getProfiles(profileType);
            if (profileType === VoiceProfileType.TextIndependentIdentification) {
                return VoiceProfileEnrollmentResult.FromIdentificationProfileList(result.json);
            }
            return VoiceProfileEnrollmentResult.FromVerificationProfileList(result.json);
            */
        });
    }
    /**
     * Get valid authorization phrases for voice profile enrollment
     * @member VoiceProfileClient.prototype.getActivationPhrasesAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfileType} profileType Profile Type to get activation phrases for
     * @param {string} lang Language string (locale) for Voice Profile
     */
    getActivationPhrasesAsync(profileType, lang) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.getActivationPhrases(profileType, lang);
        });
    }
    /**
     * Create a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.enrollProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to create enrollment for
     * @param {AudioConfig} audioConfig source info from which to create enrollment
     * @return {Promise<VoiceProfileEnrollmentResult>} - Promise of a VoiceProfileEnrollmentResult.
     */
    enrollProfileAsync(profile, audioConfig) {
        return __awaiter(this, void 0, void 0, function* () {
            const configImpl = audioConfig;
            _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(configImpl, "audioConfig");
            this.audioConfig = audioConfig;
            this.privVoiceAdapter.SpeakerAudioSource = configImpl;
            return this.privVoiceAdapter.enrollProfile(profile);
        });
    }
    /**
     * Delete a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.deleteProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to be deleted
     * @return {Promise<VoiceProfileResult>} - Promise of a VoiceProfileResult.
     */
    deleteProfileAsync(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.deleteProfile(profile);
        });
    }
    /**
     * Remove all enrollments for a speaker recognition voice profile
     * @member VoiceProfileClient.prototype.resetProfileAsync
     * @function
     * @public
     * @async
     * @param {VoiceProfile} profile Voice Profile to be reset
     * @return {Promise<VoiceProfileResult>} - Promise of a VoiceProfileResult.
     */
    resetProfileAsync(profile) {
        return __awaiter(this, void 0, void 0, function* () {
            return this.privVoiceAdapter.resetProfile(profile);
        });
    }
    /**
     * Clean up object and close underlying connection
     * @member VoiceProfileClient.prototype.close
     * @function
     * @async
     * @public
     */
    close() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.dispose(true);
        });
    }
    createServiceRecognizer(authentication, connectionFactory, audioConfig, recognizerConfig) {
        const audioImpl = audioConfig;
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_7__.VoiceServiceRecognizer(authentication, connectionFactory, audioImpl, recognizerConfig, this);
    }
    dispose(disposing) {
        const _super = Object.create(null, {
            dispose: { get: () => super.dispose }
        });
        return __awaiter(this, void 0, void 0, function* () {
            if (this.privDisposedVoiceAdapter) {
                return;
            }
            this.privDisposedVoiceAdapter = true;
            if (disposing) {
                yield _super.dispose.call(this, disposing);
            }
        });
    }
    createRecognizerConfig(speechConfig) {
        return new _common_speech_Exports__WEBPACK_IMPORTED_MODULE_8__.RecognizerConfig(speechConfig, this.properties);
    }
    getResult(result, successReason) {
        const response = new _Exports__WEBPACK_IMPORTED_MODULE_9__.VoiceProfileResult(result.ok ? successReason : _Exports__WEBPACK_IMPORTED_MODULE_10__.ResultReason.Canceled, result.statusText);
        return (response);
    }
}

//# sourceMappingURL=VoiceProfileClient.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js":
/*!********************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileEnrollmentResult.js ***!
  \********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileEnrollmentCancellationDetails": () => (/* binding */ VoiceProfileEnrollmentCancellationDetails),
/* harmony export */   "VoiceProfileEnrollmentResult": () => (/* binding */ VoiceProfileEnrollmentResult)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */


/**
 * Output format
 * @class VoiceProfileEnrollmentResult
 */
class VoiceProfileEnrollmentResult {
    constructor(reason, json, statusText) {
        this.privReason = reason;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        if (this.privReason !== _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled) {
            if (!!json) {
                this.privDetails = JSON.parse(json);
                if (this.privDetails.enrollmentStatus.toLowerCase() === "enrolling") {
                    this.privReason = _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrollingVoiceProfile;
                }
            }
        }
        else {
            this.privErrorDetails = statusText;
            this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.ServiceError]);
        }
    }
    get reason() {
        return this.privReason;
    }
    get enrollmentsCount() {
        return this.privDetails.enrollmentsCount;
    }
    get enrollmentsLength() {
        return this.privDetails.enrollmentsLength;
    }
    get properties() {
        return this.privProperties;
    }
    get enrollmentResultDetails() {
        return this.privDetails;
    }
    get errorDetails() {
        return this.privErrorDetails;
    }
    static FromIdentificationProfileList(json) {
        const results = [];
        for (const item of json.value) {
            const reason = item.enrollmentStatus.toLowerCase() === "enrolling" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === "enrolled" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrolledVoiceProfile : _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled;
            const result = new VoiceProfileEnrollmentResult(reason, null, null);
            result.privDetails = this.getIdentificationDetails(item);
            results.push(result);
        }
        return results;
    }
    static FromVerificationProfileList(json) {
        const results = [];
        for (const item of json.value) {
            const reason = item.enrollmentStatus.toLowerCase() === "enrolling" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === "enrolled" ?
                _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.EnrolledVoiceProfile : _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled;
            const result = new VoiceProfileEnrollmentResult(reason, null, null);
            result.privDetails = this.getVerificationDetails(item);
            results.push(result);
        }
        return results;
    }
    static getIdentificationDetails(json) {
        return {
            audioLength: json.audioLength ? parseFloat(json.audioLength) : 0,
            audioSpeechLength: json.audioSpeechLength ? parseFloat(json.audioSpeechLength) : 0,
            enrollmentStatus: json.enrollmentStatus,
            enrollmentsCount: json.enrollmentsCount || 0,
            enrollmentsLength: json.enrollmentsLength ? parseFloat(json.enrollmentsLength) : 0,
            enrollmentsSpeechLength: json.enrollmentsSpeechLength ? parseFloat(json.enrollmentsSpeechLength) : 0,
            profileId: json.profileId || json.identificationProfileId,
            remainingEnrollmentsSpeechLength: json.remainingEnrollmentsSpeechLength ? parseFloat(json.remainingEnrollmentsSpeechLength) : 0
        };
    }
    static getVerificationDetails(json) {
        return {
            audioLength: json.audioLength ? parseFloat(json.audioLength) : 0,
            audioSpeechLength: json.audioSpeechLength ? parseFloat(json.audioSpeechLength) : 0,
            enrollmentStatus: json.enrollmentStatus,
            enrollmentsCount: json.enrollmentsCount,
            enrollmentsLength: json.enrollmentsLength ? parseFloat(json.enrollmentsLength) : 0,
            enrollmentsSpeechLength: json.enrollmentsSpeechLength ? parseFloat(json.enrollmentsSpeechLength) : 0,
            profileId: json.profileId || json.verificationProfileId,
            remainingEnrollmentsCount: json.remainingEnrollments || json.remainingEnrollmentsCount,
            remainingEnrollmentsSpeechLength: json.remainingEnrollmentsSpeechLength ? parseFloat(json.remainingEnrollmentsSpeechLength) : 0
        };
    }
}
/**
 * @class VoiceProfileEnrollmentCancellationDetails
 */
class VoiceProfileEnrollmentCancellationDetails extends _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of VoiceProfileEnrollmentCancellationDetails object for the canceled VoiceProfileEnrollmentResult.
     * @member VoiceProfileEnrollmentCancellationDetails.fromResult
     * @function
     * @public
     * @param {VoiceProfileEnrollmentResult} result - The result that was canceled.
     * @returns {VoiceProfileEnrollmentCancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        const reason = _Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError;
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_2__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCode.NoError])]; //eslint-disable-line
        }
        return new VoiceProfileEnrollmentCancellationDetails(reason, result.errorDetails, errorCode);
    }
}

//# sourceMappingURL=VoiceProfileEnrollmentResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfilePhraseResult.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfilePhraseResult": () => (/* binding */ VoiceProfilePhraseResult)
/* harmony export */ });
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.


/**
 * Output format
 * @class VoiceProfilePhraseResult
 */
class VoiceProfilePhraseResult extends _Exports__WEBPACK_IMPORTED_MODULE_0__.VoiceProfileResult {
    constructor(reason, statusText, type, phraseArray) {
        super(reason, statusText);
        this.privPhrases = [];
        _Contracts__WEBPACK_IMPORTED_MODULE_1__.Contracts.throwIfNullOrUndefined(phraseArray, "phrase array");
        this.privType = type;
        if (!!phraseArray && !!phraseArray[0]) {
            this.privPhrases = phraseArray;
        }
    }
    get phrases() {
        return this.privPhrases;
    }
    get type() {
        return this.privType;
    }
}

//# sourceMappingURL=VoiceProfilePhraseResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js":
/*!**********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileResult.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileCancellationDetails": () => (/* binding */ VoiceProfileCancellationDetails),
/* harmony export */   "VoiceProfileResult": () => (/* binding */ VoiceProfileResult)
/* harmony export */ });
/* harmony import */ var _common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common.speech/Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/common.speech/Exports.js");
/* harmony import */ var _Contracts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Contracts */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/Contracts.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/PropertyCollection.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/ResultReason.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationErrorCodes.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationDetailsBase.js");
/* harmony import */ var _Exports__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Exports */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/CancellationReason.js");
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/* eslint-disable max-classes-per-file */



/**
 * Output format
 * @class VoiceProfileResult
 */
class VoiceProfileResult {
    constructor(reason, statusText) {
        this.privReason = reason;
        this.privProperties = new _Exports__WEBPACK_IMPORTED_MODULE_0__.PropertyCollection();
        if (reason === _Exports__WEBPACK_IMPORTED_MODULE_1__.ResultReason.Canceled) {
            _Contracts__WEBPACK_IMPORTED_MODULE_2__.Contracts.throwIfNullOrUndefined(statusText, "statusText");
            this.privErrorDetails = statusText;
            this.privProperties.setProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.ServiceError]);
        }
    }
    get reason() {
        return this.privReason;
    }
    get properties() {
        return this.privProperties;
    }
    get errorDetails() {
        return this.privErrorDetails;
    }
}
/**
 * @class VoiceProfileCancellationDetails
 */
class VoiceProfileCancellationDetails extends _Exports__WEBPACK_IMPORTED_MODULE_5__.CancellationDetailsBase {
    constructor(reason, errorDetails, errorCode) {
        super(reason, errorDetails, errorCode);
    }
    /**
     * Creates an instance of VoiceProfileCancellationDetails object for the canceled VoiceProfileResult.
     * @member VoiceProfileCancellationDetails.fromResult
     * @function
     * @public
     * @param {VoiceProfileResult} result - The result that was canceled.
     * @returns {VoiceProfileCancellationDetails} The cancellation details object being created.
     */
    static fromResult(result) {
        const reason = _Exports__WEBPACK_IMPORTED_MODULE_6__.CancellationReason.Error;
        let errorCode = _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.NoError;
        if (!!result.properties) {
            errorCode = _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode[result.properties.getProperty(_common_speech_Exports__WEBPACK_IMPORTED_MODULE_3__.CancellationErrorCodePropertyName, _Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode[_Exports__WEBPACK_IMPORTED_MODULE_4__.CancellationErrorCode.NoError])]; //eslint-disable-line
        }
        return new VoiceProfileCancellationDetails(reason, result.errorDetails, errorCode);
    }
}

//# sourceMappingURL=VoiceProfileResult.js.map


/***/ }),

/***/ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/src/sdk/VoiceProfileType.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "VoiceProfileType": () => (/* binding */ VoiceProfileType)
/* harmony export */ });
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.
/**
 * Output format
 * @class VoiceProfileType
 */
var VoiceProfileType;
(function (VoiceProfileType) {
    /**
     * Text independent speaker identification
     * @member VoiceProfileType.TextIndependentIdentification
     */
    VoiceProfileType[VoiceProfileType["TextIndependentIdentification"] = 0] = "TextIndependentIdentification";
    /**
     * Text dependent speaker verification
     * @member VoiceProfileType.TextDependentVerification
     */
    VoiceProfileType[VoiceProfileType["TextDependentVerification"] = 1] = "TextDependentVerification";
    /**
     * Text independent speaker verification
     * @member VoiceProfileType.TextIndependentVerification
     */
    VoiceProfileType[VoiceProfileType["TextIndependentVerification"] = 2] = "TextIndependentVerification";
})(VoiceProfileType || (VoiceProfileType = {}));

//# sourceMappingURL=VoiceProfileType.js.map


/***/ }),

/***/ "./src/Options/models.ts":
/*!*******************************!*\
  !*** ./src/Options/models.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";

Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.models = void 0;
exports.models = [
    {
        'name': 'gpt-3.5-turbo',
        'id': 'openai/gpt-3.5-turbo'
    },
    {
        'name': 'gpt-3.5-turbo-16k',
        'id': 'openai/gpt-3.5-turbo-16k'
    },
    {
        'name': 'gpt-4',
        'id': 'openai/gpt-4'
    },
    {
        'name': 'gpt-4-32k',
        'id': 'openai/gpt-4-32k'
    },
    {
        'name': 'claude-2',
        'id': 'anthropic/claude-2'
    },
    {
        'name': 'claude-instant-v1',
        'id': 'anthropic/claude-instant-v1'
    },
    {
        'name': 'PaLM 2 Bison',
        'id': 'google/palm-2-chat-bison'
    },
    {
        'name': 'Llama v2 13B Chat (beta)',
        'id': 'meta-llama/llama-2-13b-chat'
    }
];


/***/ }),

/***/ "./src/Options/util.ts":
/*!*****************************!*\
  !*** ./src/Options/util.ts ***!
  \*****************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.getSettings = void 0;
const webextension_polyfill_1 = __importDefault(__webpack_require__(/*! webextension-polyfill */ "./node_modules/webextension-polyfill/dist/browser-polyfill.js"));
const models_1 = __webpack_require__(/*! ./models */ "./src/Options/models.ts");
function getSettings() {
    return __awaiter(this, void 0, void 0, function* () {
        let items = yield webextension_polyfill_1.default.storage.sync.get({
            "openApiKey": '',
            "openApiEndpoint": 'https://api.openai.com',
            "unsplashApiKey": '',
            "currentLanguage": '',
            "targetLanguage": '',
            "ankiDeckName": '',
            "licenseKey": '',
            "model": models_1.models[0]['id'], "apiKeySelection": 'licenseKey'
        });
        return items;
    });
}
exports.getSettings = getSettings;


/***/ }),

/***/ "./src/background.ts":
/*!***************************!*\
  !*** ./src/background.ts ***!
  \***************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
const webextension_polyfill_1 = __importDefault(__webpack_require__(/*! webextension-polyfill */ "./node_modules/webextension-polyfill/dist/browser-polyfill.js"));
const amplitude = __importStar(__webpack_require__(/*! @amplitude/analytics-browser */ "./node_modules/@amplitude/analytics-browser/lib/esm/index.js"));
const eventsource_parser_1 = __webpack_require__(/*! eventsource-parser */ "./node_modules/eventsource-parser/dist/index.js");
const util_1 = __webpack_require__(/*! ./util */ "./src/util.ts");
const unsplash_js_1 = __webpack_require__(/*! unsplash-js */ "./node_modules/unsplash-js/dist/unsplash-js.esm.js");
const util_2 = __webpack_require__(/*! ./Options/util */ "./src/Options/util.ts");
const util_3 = __webpack_require__(/*! ./util */ "./src/util.ts");
// content script 关闭窗口时，将此值设为 false 以中断数据渲染
// let isContinue = true
(0, util_3.getUserId)().then((userId) => {
    // 数据埋点
    amplitude.init("ed720e33b4190ef29a0718a040bbb55a", userId, {
        defaultTracking: {
            pageViews: false,
            sessions: false,
        },
    });
});
let controller = new AbortController();
const defaultOpenApiEndpoint = 'https://api.openai.com';
console.log('I am background');
webextension_polyfill_1.default.runtime.onInstalled.addListener(function () {
    console.log("插件已被安装");
    amplitude.track("install");
});
// 卸载插件后引导填写卸载原因，帮助产品优化
webextension_polyfill_1.default.runtime.setUninstallURL("https://docs.google.com/forms/d/e/1FAIpQLSdobGQN3O0Ck4fVrgfvRZMme3de-2OaEp1pFtibZkU0koc37w/viewform?usp=sf_link");
// 创建右键菜单
webextension_polyfill_1.default.contextMenus.create({
    id: "2",
    title: "Run last prompt",
    contexts: ["selection"],
}, () => {
    webextension_polyfill_1.default.runtime.lastError;
});
webextension_polyfill_1.default.contextMenus.create({
    id: "1",
    title: "Open",
    contexts: ["selection"],
}, () => {
    webextension_polyfill_1.default.runtime.lastError;
});
// 右键菜单点击事件
webextension_polyfill_1.default.contextMenus.onClicked.addListener(function (info, _tab) {
    return __awaiter(this, void 0, void 0, function* () {
        const runPrompt = info.menuItemId === '2' ? true : false;
        sendMessageToContent(runPrompt);
    });
});
// 监听快捷键
webextension_polyfill_1.default.commands.onCommand.addListener(function (command) {
    console.log('hello');
    if (command === 'RunLastPrompt') {
        // 执行相关代码
        sendMessageToContent();
    }
});
let popupPort;
// 长连接，处理 GPT 数据
webextension_polyfill_1.default.runtime.onConnect.addListener(port => {
    // 收到 content script 消息
    // console.log('连接中------------')
    if (port.name === 'fromPopupCard') {
        popupPort = port;
    }
    // amplitude.init(process.env.AMPLITUDE_KEY as string);
    // amplitude.track('executivePrompt');
    // 接收 content script 的消息
    port.onMessage.addListener((msg) => __awaiter(void 0, void 0, void 0, function* () {
        console.log('接收消息：', msg);
        // 获取 API Key 等存储的数据
        let openApiKey, apiKeySelection, model, licenseKey, currentLanguage, openApiEndpoint, targetLanguage = '';
        (0, util_2.getSettings)().then((result) => {
            apiKeySelection = result.apiKeySelection;
            licenseKey = result.licenseKey;
            openApiKey = result.openApiKey;
            openApiEndpoint = result.openApiEndpoint;
            currentLanguage = result.currentLanguage;
            targetLanguage = result.targetLanguage;
            model = result.model;
            // 请求  GPT 数据
            if (msg.type === 'getGPTMsg') {
                console.log('getGPTMsg');
                // isContinue = true 时才会渲染数据
                // isContinue = true
                // controller.abort();
                controller = new AbortController();
                let messages = msg.messages;
                if (openApiKey.length < 5 && licenseKey.length < 5) {
                    port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'code': 'invalid_api_key', 'content': '🥲 API Key error. Please modify and try again..' });
                    return;
                }
                if (openApiEndpoint.length < 5) {
                    openApiEndpoint = defaultOpenApiEndpoint;
                }
                let headers = {};
                let body;
                // 优先使用自己的 Key
                if (apiKeySelection === 'licenseKey') {
                    // 使用许可证
                    openApiEndpoint = 'https://openrouter.ai/api/v1/chat/completions';
                    openApiKey = licenseKey;
                    headers = {
                        'Authorization': 'Bearer ' + openApiKey,
                        'Content-Type': 'application/json',
                        'HTTP-Referer': 'https://notes.dabing.one/',
                        'X-Title': 'Scouter'
                    };
                    body = JSON.stringify({
                        "model": model,
                        "messages": messages,
                        "temperature": 0.7,
                        "max_tokens": 420,
                        "top_p": 1,
                        "frequency_penalty": 0,
                        "presence_penalty": 2,
                        "stream": true
                    });
                }
                else {
                    // 使用用户自己的 Key
                    if (openApiEndpoint.indexOf('azure.com') > -1) {
                        // Azure
                        headers = { 'api-key': openApiKey, 'Content-Type': 'application/json', };
                        body = JSON.stringify({
                            "model": "gpt-35-turbo",
                            "messages": messages,
                            "temperature": 0.7,
                            "max_tokens": 420,
                            "top_p": 1,
                            "frequency_penalty": 0,
                            "presence_penalty": 2,
                            "stream": true
                        });
                    }
                    else {
                        // OpenAI
                        headers = { 'Authorization': 'Bearer ' + openApiKey, 'Content-Type': 'application/json', };
                        // 去除端点末尾的 \ 符号
                        if (openApiEndpoint.slice(-1) === "/") {
                            openApiEndpoint = openApiEndpoint.slice(0, -1);
                        }
                        openApiEndpoint += '/v1/chat/completions';
                        body = JSON.stringify({
                            "model": "gpt-3.5-turbo",
                            "messages": messages,
                            "temperature": 0.7,
                            "max_tokens": 420,
                            "top_p": 1,
                            "frequency_penalty": 0,
                            "presence_penalty": 2,
                            "stream": true
                        });
                    }
                }
                fetch(openApiEndpoint, {
                    signal: controller.signal,
                    method: "POST",
                    body: body,
                    headers: headers
                }).then((response) => __awaiter(void 0, void 0, void 0, function* () {
                    var _a;
                    port.postMessage({ 'type': 'sendGPTData', 'status': 'begin', 'content': '' });
                    if (response.status !== 200) {
                        // API KEY Error
                        response.json().then((data) => {
                            port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': '🥲 ' + data.error.message, 'code': data.error.code });
                            return;
                        });
                    }
                    // 处理 server-sent events
                    const parser = (0, eventsource_parser_1.createParser)((event) => {
                        if (event.type === 'event') {
                            // console.log('createParser:');
                            try {
                                if (event.data !== '[DONE]') {
                                    let new_msg = JSON.parse(event.data)['choices'][0]['delta']['content'];
                                    if (new_msg !== undefined) {
                                        // 将数据发送给 UI 以渲染内容
                                        port.postMessage({ 'type': 'sendGPTData', 'status': 'process', 'content': JSON.parse(event.data)['choices'][0]['delta']['content'], 'chatId': JSON.parse(event.data).id });
                                    }
                                }
                            }
                            catch (_a) {
                                console.log(' createParser JSON.parse errow');
                            }
                        }
                    });
                    const reader = (_a = response.body) === null || _a === void 0 ? void 0 : _a.getReader();
                    if (reader !== undefined) {
                        try {
                            // eslint-disable-next-line no-constant-condition
                            while (true) {
                                const { done, value } = yield reader.read();
                                // const { done:boolean, value:uint8Array } = await Promise.race([reader.read(), cancelPromise]);
                                if (done) {
                                    // 数据传输结束
                                    console.log('Done');
                                    port.postMessage({ 'type': 'sendGPTData', 'status': 'end', 'content': '' });
                                    break;
                                }
                                // if (!isContinue) {
                                //   console.log('停止渲染数据')
                                //   break
                                // }
                                const str = new TextDecoder().decode(value);
                                parser.feed(str);
                            }
                        }
                        finally {
                            reader.releaseLock();
                        }
                        parser.reset();
                    }
                })).catch((error) => {
                    console.log('error');
                    console.log(error);
                    if (error.message.indexOf('aborted') >= 0) {
                        // 开启新的请求，中断旧请求
                    }
                    else {
                        const tips = error.message.indexOf('Failed to fetch') >= 0 ? '🥲An error occurred. It might be an **API endpoint error**' + '(' + openApiEndpoint + ')' + '. Please modify and try again.' : '🥲An error occurred.';
                        port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': tips + '(' + error.message + ')', 'code': error.message });
                    }
                    // port.postMessage({ 'type': 'sendGPTData', 'status': 'erro', 'content': "🥲 Encountered some issues, please try again later." })
                });
            }
            // 停止渲染数据
            if (msg.type === 'StopTheConversation') {
                // isContinue = false
                controller.abort();
            }
        });
    }));
});
webextension_polyfill_1.default.runtime.onMessage.addListener(handleMessage);
function handleMessage(request, sender, sendResponse) {
    console.log("Message from the content script: " +
        request.type);
    // Define sendResponse as an async function
    const asyncSendResponse = (response) => __awaiter(this, void 0, void 0, function* () {
        try {
            yield sendResponse(response);
        }
        catch (error) {
            console.error(error);
        }
    });
    if (request.type === 'getUnsplashImages') {
        console.log('background getUnsplashImages:');
        // 获取图片
        if (request.keyWord) {
            // port.postMessage({ 'type': 'sendImgData', 'status': 'end', 'imgs': imgs })
            (0, util_1.unsplashSearchPhotos)("t8eOwEDwJEGJe7mYWDleFDBK_EM0SaF1hK_4KYfcD_8", request.keyWord).then((imgs) => {
                console.log(imgs);
                // port.postMessage({ 'type': 'sendImgData', 'status': 'end', 'imgs': imgs })
                asyncSendResponse({ type: 'sendImgData', status: 'end', 'imgs': imgs });
            }).catch((error) => {
                console.log(error);
            });
        }
        return true;
    }
    if (request.type === 'addNote') {
        console.log('addNote');
        // Unsplash
        const unsplash = (0, unsplash_js_1.createApi)({
            accessKey: "t8eOwEDwJEGJe7mYWDleFDBK_EM0SaF1hK_4KYfcD_8"
        });
        console.log('unsplash.photos.trackDownload');
        if (request.messages.unsplash_download_location !== undefined) {
            unsplash.photos.trackDownload({ downloadLocation: request.messages.unsplash_download_location, }).then((result) => console.log(result));
        }
        (0, util_1.ankiAction)(request.messages.anki_action_type, 6, request.messages.anki_arguments).then((result) => {
            console.log(`got list of decks: ${result}`);
            // 反馈处理结果
            asyncSendResponse({ type: 'addToAnki', result: 'success', data: result.result, error: result.error });
        })
            .catch((error) => {
            console.error(error);
            asyncSendResponse({ type: 'addToAnki', result: 'failure', error: error.error });
        });
        // Return true to inform sendResponse that you will be calling it asynchronously
        return true;
    }
    // 获取用户设置的牌组和模板
    if (request.type === 'setModel') {
        const isAnkiSpace = request.messages.isAnkiSpace;
        // 获取 DeckName
        (0, util_1.getDefaultDeckName)().then((result) => {
            let defaultDeckName = result.defaultDeckName;
            if (defaultDeckName === '' || defaultDeckName === undefined) {
                defaultDeckName = 'Default';
            }
            // 获取所有 Model
            (0, util_1.ankiAction)('modelNames', 6).then((result) => {
                console.log(result.result);
                if (!result.error) {
                    let defaultModelName = 'Scouter';
                    let cardTemplates = [
                        {
                            'name': 'Card1',
                            'Front': '{{Front}}',
                            'Back': `{{Front}}
              <hr id=answer>
              {{Back}}`
                        }
                    ];
                    let inOrderFields = ["Front", "Back"];
                    if (isAnkiSpace) {
                        // Anki 完形填空
                        defaultModelName = 'Scouter Cloze Text';
                        cardTemplates = [
                            {
                                'name': 'Card2',
                                'Front': '{{cloze:Text}}',
                                'Back': `{{cloze:Text}}
                        <br>{{More}}`
                            }
                        ];
                        inOrderFields = ["Text", "More"];
                    }
                    if (result.result.includes(defaultModelName)) {
                        // 如果有 Scouter Model 则获取 Model 的字段
                        (0, util_1.ankiAction)('modelFieldNames', 6, { 'modelName': defaultModelName }).then((result) => {
                            if (result.result.length < 2) {
                                // 字段少于 2 个时无法添加笔记，引导用户修改
                                asyncSendResponse({ type: 'setModel', result: 'failure', data: {}, error: 'The Scouter model in Anki needs to include at least 2 fields. Please modify and try again.' });
                            }
                            else {
                                // 反馈处理结果
                                asyncSendResponse({ type: 'setModel', result: 'success', data: { 'defaultDeckName': defaultDeckName, 'modelName': defaultModelName, 'field1': result.result[0], 'field2': result.result[1] }, error: result.error });
                            }
                        });
                    }
                    else {
                        // 如果没有 Scouter 默认的 Model，则创建
                        (0, util_1.ankiAction)('createModel', 6, {
                            'modelName': defaultModelName,
                            'inOrderFields': inOrderFields,
                            'cardTemplates': cardTemplates,
                            'isCloze': isAnkiSpace
                        }).then((result) => {
                            if (!result.error) {
                                // 反馈处理结果
                                asyncSendResponse({
                                    type: 'setModel', result: 'success', data: {
                                        'defaultDeckName': defaultDeckName,
                                        'modelName': defaultModelName,
                                        'field1': result.result.flds[0].name,
                                        'field2': result.result.flds[1].name
                                    }, error: result.error
                                });
                            }
                        });
                    }
                }
            })
                .catch((error) => {
                console.error(error);
                asyncSendResponse({ type: 'setModel', result: 'failure', error: error.error });
            });
        });
        webextension_polyfill_1.default.storage.sync.get({ 'ankiDeckName': 'Default' }).then((result) => {
        });
        return true;
    }
    if (request.type === 'guiEditNote') {
        (0, util_1.ankiAction)(request.messages.anki_action_type, 6, request.messages.anki_arguments).then((result) => {
            console.log(`got list of decks: ${result}`);
            // 反馈处理结果
            asyncSendResponse({ type: 'guiEditNote', result: 'success', data: result.result, error: result.error });
        })
            .catch((error) => {
            console.error(error);
            asyncSendResponse({ type: 'guiEditNote', result: 'failure', error: error.error });
        });
        // Return true to inform sendResponse that you will be calling it asynchronously
        return true;
    }
    if (request.type === 'ankiAction') {
        (0, util_1.ankiAction)(request.messages.anki_action_type, 6, request.messages.anki_arguments).then((result) => {
            // 反馈处理结果
            asyncSendResponse(result);
        }).catch((error) => {
            asyncSendResponse(error);
        });
        return true;
    }
    if (request.type === 'amplitudeTrack') {
        amplitude.track(request.name);
        return true;
    }
    if (request.type === 'UPDATE_POPUP_CARD') {
        popupPort.postMessage(request);
    }
}
const sendMessageToContent = (runPrompt) => {
    console.log('sendMessageToContent:');
    let needToRunPrompt = runPrompt;
    if (needToRunPrompt === undefined) {
        needToRunPrompt = true;
    }
    webextension_polyfill_1.default.tabs.query({ active: true, currentWindow: true }).then((tabs) => {
        var _a;
        console.log(tabs);
        const activeTab = tabs[0];
        let tID = (_a = activeTab.id) !== null && _a !== void 0 ? _a : -1;
        if (activeTab && activeTab.id !== undefined) {
            let b = webextension_polyfill_1.default.tabs.sendMessage(tID, { type: 'open-scouter', runPrompt: needToRunPrompt });
            // 已知情况：刚安装插件时直接使用会报错（刷新页面后使用则正常），此时需要载入 content_script.js 才行
            // b.catch(e => {
            //   console.log(e);
            //   console.log('catch');
            //   browser.scripting.executeScript({
            //     target: { tabId: tID },
            //     files: ["js/vendor.js", "js/content_script.js"],
            //   }).then(() => {
            //     console.log('chrome.scripting.executeScript');
            //   }).then(() => {
            //     browser.tabs.sendMessage(tID, { type: 'open-scouter' })
            //   })
            // })
        }
    });
};


/***/ }),

/***/ "./src/util.ts":
/*!*********************!*\
  !*** ./src/util.ts ***!
  \*********************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";

var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
exports.getUserId = exports.getBalance = exports.playTextToSpeech = exports.getDefaultDeckName = exports.unsplashSearchPhotos = exports.ankiAction = void 0;
const webextension_polyfill_1 = __importDefault(__webpack_require__(/*! webextension-polyfill */ "./node_modules/webextension-polyfill/dist/browser-polyfill.js"));
const unsplash_js_1 = __webpack_require__(/*! unsplash-js */ "./node_modules/unsplash-js/dist/unsplash-js.esm.js");
const sdk = __importStar(__webpack_require__(/*! microsoft-cognitiveservices-speech-sdk */ "./node_modules/microsoft-cognitiveservices-speech-sdk/distrib/es2015/microsoft.cognitiveservices.speech.sdk.js"));
const uuid_1 = __webpack_require__(/*! uuid */ "./node_modules/uuid/dist/commonjs-browser/index.js");
// 将信息添加到 Anki
function ankiAction(action, version, params = {}) {
    return new Promise((resolve, reject) => {
        fetch('http://127.0.0.1:8765', {
            method: "POST",
            body: JSON.stringify({ "action": action, "version": version, "params": params })
        }).then(response => response.json()).then((data) => {
            // console.log(data);
            resolve(data);
        }).catch((error) => {
            reject({ 'result': [], 'error': 'Please open the Anki client and install the Anki-Connect plugin before trying again.' });
        });
    });
}
exports.ankiAction = ankiAction;
// 在 unsplash 中搜索照片
function unsplashSearchPhotos(API_KEY, query) {
    return new Promise((resolve, reject) => {
        const unsplash = (0, unsplash_js_1.createApi)({
            accessKey: API_KEY,
        });
        unsplash.search.getPhotos({
            query: query,
        }).then((data) => {
            // console.log(data);
            var _a, _b;
            if (((_a = data.response) === null || _a === void 0 ? void 0 : _a.results.length) === 0) {
                resolve([]);
            }
            else {
                resolve((_b = data.response) === null || _b === void 0 ? void 0 : _b.results);
            }
        }).catch((error) => {
            reject(error);
        });
    });
}
exports.unsplashSearchPhotos = unsplashSearchPhotos;
// 获取 Anki 的 Deck 名称，添加到卡片会存放到这里
function getDefaultDeckName() {
    return new Promise((resolve, reject) => {
        let defaultDeckName = '';
        // 获取用户设置的 Deck Name
        webextension_polyfill_1.default.storage.sync.get(["ankiDeckName"]).then((result) => __awaiter(this, void 0, void 0, function* () {
            // console.log('result:');
            // console.log(result);
            if (result.ankiDeckName) {
                // 用户有设置
                defaultDeckName = result.ankiDeckName;
            }
            else {
                // 用户未设置
                // 获取 Anki 的牌组列表
                defaultDeckName = yield ankiAction('deckNames', 6).then((result) => {
                    // 将第一个牌组作为默认牌组
                    return result.result[0];
                }).catch((error) => {
                    // console.log(error);
                    return '';
                });
            }
            resolve({ 'defaultDeckName': defaultDeckName });
        }));
    });
}
exports.getDefaultDeckName = getDefaultDeckName;
const playTextToSpeech = (text, voice) => {
    const audioConfig = sdk.AudioConfig.fromDefaultSpeakerOutput();
    const speechConfig = sdk.SpeechConfig.fromSubscription("51675ff213a64c3896bc95141c6c54dd", "eastus");
    speechConfig.speechSynthesisVoiceName = voice;
    const synthesizer = new sdk.SpeechSynthesizer(speechConfig, audioConfig);
    synthesizer.speakTextAsync(text, function (result) {
        if (result.reason === sdk.ResultReason.SynthesizingAudioCompleted) {
            // console.log('synthesis finished.');
        }
        else {
            console.error('Speech synthesis canceled, ' + result.errorDetails + '\nDid you set the speech resource key and region values?');
        }
        synthesizer.close();
    }, function (err) {
        // console.trace('err - ' + err);
        synthesizer.close();
    });
    // console.log('Now synthesizing...');
};
exports.playTextToSpeech = playTextToSpeech;
const getBalance = (apiKey) => {
    return new Promise((resolve, reject) => {
        const url = 'https://openrouter.ai/api/v1/auth/key';
        const headers = { 'Authorization': 'Bearer ' + apiKey, 'Content-Type': 'application/json', };
        fetch(url, {
            headers: headers
        }).then((response) => {
            response.json().then((data) => {
                resolve(data);
            });
        });
    });
};
exports.getBalance = getBalance;
const getUserId = () => {
    return new Promise((resolve, reject) => {
        chrome.storage.sync.get('userId', (result) => {
            if (chrome.runtime.lastError) {
                reject(chrome.runtime.lastError);
            }
            if (result.userId) {
                resolve(result.userId);
            }
            else {
                let uniqueId = (0, uuid_1.v4)();
                chrome.storage.sync.set({ userId: uniqueId }, () => {
                    if (chrome.runtime.lastError) {
                        reject(chrome.runtime.lastError);
                    }
                    else {
                        resolve(uniqueId);
                    }
                });
            }
        });
    });
};
exports.getUserId = getUserId;


/***/ }),

/***/ "./node_modules/unsplash-js/dist/unsplash-js.esm.js":
/*!**********************************************************!*\
  !*** ./node_modules/unsplash-js/dist/unsplash-js.esm.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Language": () => (/* binding */ Language),
/* harmony export */   "OrderBy": () => (/* binding */ OrderBy),
/* harmony export */   "_internals": () => (/* binding */ internals),
/* harmony export */   "createApi": () => (/* binding */ createApi)
/* harmony export */ });
/* harmony import */ var content_type__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! content-type */ "./node_modules/content-type/index.js");


function _extends() {
  _extends = Object.assign || function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  return _extends.apply(this, arguments);
}

function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  var sourceKeys = Object.keys(source);
  var key, i;

  for (i = 0; i < sourceKeys.length; i++) {
    key = sourceKeys[i];
    if (excluded.indexOf(key) >= 0) continue;
    target[key] = source[key];
  }

  return target;
}

var checkIsString = /*#__PURE__*/getRefinement(function (value) {
  return typeof value === 'string' ? value : null;
});
var isDefined = function isDefined(x) {
  return x !== null && x !== undefined;
};
function getRefinement(getB) {
  return function (a) {
    return isDefined(getB(a));
  };
}
var checkIsNonEmptyArray = function checkIsNonEmptyArray(a) {
  return a.length > 0;
};

/** Takes a dictionary containing nullish values and returns a dictionary of all the defined
 * (non-nullish) values.
 */

var compactDefined = function compactDefined(obj) {
  return Object.keys(obj).reduce(function (acc, key) {
    var _ref;

    var value = obj[key];
    return _extends({}, acc, isDefined(value) ? (_ref = {}, _ref[key] = value, _ref) : {});
  }, {});
};
function flow() {
  for (var _len = arguments.length, fns = new Array(_len), _key = 0; _key < _len; _key++) {
    fns[_key] = arguments[_key];
  }

  var len = fns.length - 1;
  return function () {
    for (var _len2 = arguments.length, x = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      x[_key2] = arguments[_key2];
    }

    var y = fns[0].apply(this, x);

    for (var i = 1; i <= len; i++) {
      y = fns[i].call(this, y);
    }

    return y;
  };
}

var checkIsObject = /*#__PURE__*/getRefinement(function (response) {
  return isDefined(response) && typeof response === 'object' && !Array.isArray(response) ? response : null;
});
var checkIsErrors = /*#__PURE__*/getRefinement(function (errors) {
  return Array.isArray(errors) && errors.every(checkIsString) && checkIsNonEmptyArray(errors) ? errors : null;
});
var checkIsApiError = /*#__PURE__*/getRefinement(function (response) {
  return checkIsObject(response) && 'errors' in response && checkIsErrors(response.errors) ? {
    errors: response.errors
  } : null;
});
var getErrorForBadStatusCode = function getErrorForBadStatusCode(jsonResponse) {
  if (checkIsApiError(jsonResponse)) {
    return {
      errors: jsonResponse.errors,
      source: 'api'
    };
  } else {
    return {
      errors: ['Responded with a status code outside the 2xx range, and the response body is not recognisable.'],
      source: 'decoding'
    };
  }
};
var DecodingError = function DecodingError(message) {
  this.message = message;
};

var CONTENT_TYPE_RESPONSE_HEADER = 'content-type';
var CONTENT_TYPE_JSON = 'application/json';

var checkIsJsonResponse = function checkIsJsonResponse(response) {
  var contentTypeHeader = response.headers.get(CONTENT_TYPE_RESPONSE_HEADER);
  return isDefined(contentTypeHeader) && (0,content_type__WEBPACK_IMPORTED_MODULE_0__.parse)(contentTypeHeader).type === CONTENT_TYPE_JSON;
};
/**
 * Note: restrict the type of JSON to `AnyJson` so that `any` doesn't leak downstream.
 */


var getJsonResponse = function getJsonResponse(response) {
  if (checkIsJsonResponse(response)) {
    return response.json()["catch"](function (_err) {
      throw new DecodingError('unable to parse JSON response.');
    });
  } else {
    throw new DecodingError('expected JSON response from server.');
  }
};

var handleFetchResponse = function handleFetchResponse(handleResponse) {
  return function (response) {
    return (response.ok ? handleResponse({
      response: response
    }).then(function (handledResponse) {
      return {
        type: 'success',
        status: response.status,
        response: handledResponse,
        originalResponse: response
      };
    }) : getJsonResponse(response).then(function (jsonResponse) {
      return _extends({
        type: 'error',
        status: response.status
      }, getErrorForBadStatusCode(jsonResponse), {
        originalResponse: response
      });
    }))["catch"](function (error) {
      /**
       * We want to separate expected decoding errors from unknown ones. We do so by throwing a custom
       * `DecodingError` whenever we encounter one within `handleFetchResponse` and catch them all
       * here. This allows us to easily handle all of these errors at once. Unexpected errors are not
       * caught, so that they bubble up and fail loudly.
       *
       * Note: Ideally we'd use an Either type, but this does the job without introducing dependencies
       * like `fp-ts`.
       */
      if (error instanceof DecodingError) {
        return {
          type: 'error',
          source: 'decoding',
          status: response.status,
          originalResponse: response,
          errors: [error.message]
        };
      } else {
        throw error;
      }
    });
  };
};
var castResponse = function castResponse() {
  return function (_ref) {
    var response = _ref.response;
    return getJsonResponse(response);
  };
};

var addQueryToUrl = function addQueryToUrl(query) {
  return function (url) {
    Object.keys(query).forEach(function (queryKey) {
      return url.searchParams.set(queryKey, query[queryKey].toString());
    });
  };
};

var addPathnameToUrl = function addPathnameToUrl(pathname) {
  return function (url) {
    // When there is no existing pathname, the value is `/`. Appending would give us a URL with two
    // forward slashes. This is why we replace the value in that scenario.
    if (url.pathname === '/') {
      url.pathname = pathname;
    } else {
      url.pathname += pathname;
    }
  };
};

var buildUrl = function buildUrl(_ref) {
  var pathname = _ref.pathname,
      query = _ref.query;
  return function (apiUrl) {
    var url = new URL(apiUrl);
    addPathnameToUrl(pathname)(url);
    addQueryToUrl(query)(url);
    return url.toString();
  };
};

var getQueryFromSearchParams = function getQueryFromSearchParams(searchParams) {
  var query = {};
  searchParams.forEach(function (value, key) {
    query[key] = value;
  });
  return query;
};

var parseQueryAndPathname = function parseQueryAndPathname(url) {
  var _URL = new URL(url),
      pathname = _URL.pathname,
      searchParams = _URL.searchParams;

  var query = getQueryFromSearchParams(searchParams);
  return {
    query: query,
    pathname: pathname === '/' ? undefined : pathname
  };
};

/**
 * helper used to type-check the arguments, and add default params for all requests
 */

var createRequestHandler = function createRequestHandler(fn) {
  return function (a, additionalFetchOptions) {
    if (additionalFetchOptions === void 0) {
      additionalFetchOptions = {};
    }

    var _fn = fn(a),
        headers = _fn.headers,
        query = _fn.query,
        baseReqParams = _objectWithoutPropertiesLoose(_fn, ["headers", "query"]);

    return _extends({}, baseReqParams, additionalFetchOptions, {
      query: query,
      headers: _extends({}, headers, additionalFetchOptions.headers)
    });
  };
};
var makeEndpoint = function makeEndpoint(endpoint) {
  return endpoint;
};
var initMakeRequest = function initMakeRequest(_ref) {
  var accessKey = _ref.accessKey,
      _ref$apiVersion = _ref.apiVersion,
      apiVersion = _ref$apiVersion === void 0 ? 'v1' : _ref$apiVersion,
      _ref$apiUrl = _ref.apiUrl,
      apiUrl = _ref$apiUrl === void 0 ? 'https://api.unsplash.com' : _ref$apiUrl,
      generalHeaders = _ref.headers,
      providedFetch = _ref.fetch,
      generalFetchOptions = _objectWithoutPropertiesLoose(_ref, ["accessKey", "apiVersion", "apiUrl", "headers", "fetch"]);

  return function (_ref2) {
    var handleResponse = _ref2.handleResponse,
        handleRequest = _ref2.handleRequest;
    return flow(handleRequest, function (_ref3) {
      var pathname = _ref3.pathname,
          query = _ref3.query,
          _ref3$method = _ref3.method,
          method = _ref3$method === void 0 ? 'GET' : _ref3$method,
          endpointHeaders = _ref3.headers,
          body = _ref3.body,
          signal = _ref3.signal;
      var url = buildUrl({
        pathname: pathname,
        query: query
      })(apiUrl);

      var fetchOptions = _extends({
        method: method,
        headers: _extends({}, generalHeaders, endpointHeaders, {
          'Accept-Version': apiVersion
        }, isDefined(accessKey) ? {
          Authorization: "Client-ID " + accessKey
        } : {}),
        body: body,
        signal: signal
      }, generalFetchOptions);

      var fetchToUse = providedFetch != null ? providedFetch : fetch;
      return fetchToUse(url, fetchOptions).then(handleFetchResponse(handleResponse));
    });
  };
};

var TOTAL_RESPONSE_HEADER = 'x-total';

var getTotalFromApiFeedResponse = function getTotalFromApiFeedResponse(response) {
  var totalsStr = response.headers.get(TOTAL_RESPONSE_HEADER);

  if (isDefined(totalsStr)) {
    var total = parseInt(totalsStr);

    if (Number.isInteger(total)) {
      return total;
    } else {
      throw new DecodingError("expected " + TOTAL_RESPONSE_HEADER + " header to be valid integer.");
    }
  } else {
    throw new DecodingError("expected " + TOTAL_RESPONSE_HEADER + " header to exist.");
  }
};

var handleFeedResponse = function handleFeedResponse() {
  return function (_ref) {
    var response = _ref.response;
    return castResponse()({
      response: response
    }).then(function (results) {
      return {
        results: results,
        total: getTotalFromApiFeedResponse(response)
      };
    });
  };
};

var getCollections = function getCollections(collectionIds) {
  return isDefined(collectionIds) ? {
    collections: collectionIds.join()
  } : {};
};
var getTopics = function getTopics(topicIds) {
  return isDefined(topicIds) ? {
    topics: topicIds.join()
  } : {};
};
var getFeedParams = function getFeedParams(_ref) {
  var page = _ref.page,
      perPage = _ref.perPage,
      orderBy = _ref.orderBy;
  return compactDefined({
    per_page: perPage,
    order_by: orderBy,
    page: page
  });
};

var COLLECTIONS_PATH_PREFIX = '/collections';
var getPhotos = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref) {
    var collectionId = _ref.collectionId;
    return COLLECTIONS_PATH_PREFIX + "/" + collectionId + "/photos";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref2) {
      var collectionId = _ref2.collectionId,
          orientation = _ref2.orientation,
          paginationParams = _objectWithoutPropertiesLoose(_ref2, ["collectionId", "orientation"]);

      return {
        pathname: getPathname({
          collectionId: collectionId
        }),
        query: compactDefined(_extends({}, getFeedParams(paginationParams), {
          orientation: orientation
        }))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var get = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref3) {
    var collectionId = _ref3.collectionId;
    return COLLECTIONS_PATH_PREFIX + "/" + collectionId;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref4) {
      var collectionId = _ref4.collectionId;
      return {
        pathname: getPathname({
          collectionId: collectionId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var list = /*#__PURE__*/function () {
  var getPathname = function getPathname() {
    return COLLECTIONS_PATH_PREFIX;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (paginationParams) {
      if (paginationParams === void 0) {
        paginationParams = {};
      }

      return {
        pathname: getPathname(),
        query: getFeedParams(paginationParams)
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var getRelated = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref5) {
    var collectionId = _ref5.collectionId;
    return COLLECTIONS_PATH_PREFIX + "/" + collectionId + "/related";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref6) {
      var collectionId = _ref6.collectionId;
      return {
        pathname: getPathname({
          collectionId: collectionId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();

var index = {
  __proto__: null,
  getPhotos: getPhotos,
  get: get,
  list: list,
  getRelated: getRelated
};

var PHOTOS_PATH_PREFIX = '/photos';
var list$1 = /*#__PURE__*/function () {
  var _getPathname = function getPathname() {
    return PHOTOS_PATH_PREFIX;
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname();
    },
    handleRequest: createRequestHandler(function (feedParams) {
      if (feedParams === void 0) {
        feedParams = {};
      }

      return {
        pathname: PHOTOS_PATH_PREFIX,
        query: compactDefined(getFeedParams(feedParams))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var get$1 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref) {
    var photoId = _ref.photoId;
    return PHOTOS_PATH_PREFIX + "/" + photoId;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref2) {
      var photoId = _ref2.photoId;
      return {
        pathname: getPathname({
          photoId: photoId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var getStats = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref3) {
    var photoId = _ref3.photoId;
    return PHOTOS_PATH_PREFIX + "/" + photoId + "/statistics";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref4) {
      var photoId = _ref4.photoId;
      return {
        pathname: getPathname({
          photoId: photoId
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var getRandom = /*#__PURE__*/function () {
  var getPathname = function getPathname() {
    return PHOTOS_PATH_PREFIX + "/random";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_temp) {
      var _ref5 = _temp === void 0 ? {} : _temp,
          collectionIds = _ref5.collectionIds,
          contentFilter = _ref5.contentFilter,
          topicIds = _ref5.topicIds,
          queryParams = _objectWithoutPropertiesLoose(_ref5, ["collectionIds", "contentFilter", "topicIds"]);

      return {
        pathname: getPathname(),
        query: compactDefined(_extends({}, queryParams, {
          content_filter: contentFilter
        }, getCollections(collectionIds), getTopics(topicIds))),
        headers: {
          /**
           * Avoid response caching
           */
          'cache-control': 'no-cache'
        }
      };
    }),
    handleResponse: castResponse()
  });
}();
var trackDownload = {
  handleRequest: /*#__PURE__*/createRequestHandler(function (_ref6) {
    var downloadLocation = _ref6.downloadLocation;

    var _parseQueryAndPathnam = parseQueryAndPathname(downloadLocation),
        pathname = _parseQueryAndPathnam.pathname,
        query = _parseQueryAndPathnam.query;

    if (!isDefined(pathname)) {
      throw new Error('Could not parse pathname from url.');
    }

    return {
      pathname: pathname,
      query: compactDefined(query)
    };
  }),
  handleResponse: /*#__PURE__*/castResponse()
};

var index$1 = {
  __proto__: null,
  list: list$1,
  get: get$1,
  getStats: getStats,
  getRandom: getRandom,
  trackDownload: trackDownload
};

var SEARCH_PATH_PREFIX = "/search";
var getPhotos$1 = /*#__PURE__*/function () {
  var _getPathname = function getPathname() {
    return SEARCH_PATH_PREFIX + "/photos";
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname();
    },
    handleRequest: createRequestHandler(function (_ref) {
      var query = _ref.query,
          page = _ref.page,
          perPage = _ref.perPage,
          orderBy = _ref.orderBy,
          collectionIds = _ref.collectionIds,
          lang = _ref.lang,
          contentFilter = _ref.contentFilter,
          filters = _objectWithoutPropertiesLoose(_ref, ["query", "page", "perPage", "orderBy", "collectionIds", "lang", "contentFilter"]);

      return {
        pathname: _getPathname(),
        query: compactDefined(_extends({
          query: query,
          content_filter: contentFilter,
          lang: lang,
          order_by: orderBy
        }, getFeedParams({
          page: page,
          perPage: perPage
        }), getCollections(collectionIds), filters))
      };
    }),
    handleResponse: castResponse()
  });
}();
var getCollections$1 = /*#__PURE__*/function () {
  var _getPathname2 = function getPathname() {
    return SEARCH_PATH_PREFIX + "/collections";
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname2();
    },
    handleRequest: createRequestHandler(function (_ref2) {
      var query = _ref2.query,
          paginationParams = _objectWithoutPropertiesLoose(_ref2, ["query"]);

      return {
        pathname: _getPathname2(),
        query: _extends({
          query: query
        }, getFeedParams(paginationParams))
      };
    }),
    handleResponse: castResponse()
  });
}();
var getUsers = /*#__PURE__*/function () {
  var _getPathname3 = function getPathname() {
    return SEARCH_PATH_PREFIX + "/users";
  };

  return makeEndpoint({
    // Wrapper uses type trick to allow 0 args
    getPathname: function getPathname(_params) {
      return _getPathname3();
    },
    handleRequest: createRequestHandler(function (_ref3) {
      var query = _ref3.query,
          paginationParams = _objectWithoutPropertiesLoose(_ref3, ["query"]);

      return {
        pathname: _getPathname3(),
        query: _extends({
          query: query
        }, getFeedParams(paginationParams))
      };
    }),
    handleResponse: castResponse()
  });
}();

var index$2 = {
  __proto__: null,
  getPhotos: getPhotos$1,
  getCollections: getCollections$1,
  getUsers: getUsers
};

var USERS_PATH_PREFIX = '/users';
var get$2 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref) {
    var username = _ref.username;
    return USERS_PATH_PREFIX + "/" + username;
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref2) {
      var username = _ref2.username;
      return {
        pathname: getPathname({
          username: username
        }),
        query: {}
      };
    }),
    handleResponse: castResponse()
  });
}();
var getPhotos$2 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref3) {
    var username = _ref3.username;
    return USERS_PATH_PREFIX + "/" + username + "/photos";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref4) {
      var username = _ref4.username,
          stats = _ref4.stats,
          orientation = _ref4.orientation,
          paginationParams = _objectWithoutPropertiesLoose(_ref4, ["username", "stats", "orientation"]);

      return {
        pathname: getPathname({
          username: username
        }),
        query: compactDefined(_extends({}, getFeedParams(paginationParams), {
          orientation: orientation,
          stats: stats
        }))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var getLikes = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref5) {
    var username = _ref5.username;
    return USERS_PATH_PREFIX + "/" + username + "/likes";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref6) {
      var username = _ref6.username,
          orientation = _ref6.orientation,
          paginationParams = _objectWithoutPropertiesLoose(_ref6, ["username", "orientation"]);

      return {
        pathname: getPathname({
          username: username
        }),
        query: compactDefined(_extends({}, getFeedParams(paginationParams), {
          orientation: orientation
        }))
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();
var getCollections$2 = /*#__PURE__*/function () {
  var getPathname = function getPathname(_ref7) {
    var username = _ref7.username;
    return USERS_PATH_PREFIX + "/" + username + "/collections";
  };

  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: createRequestHandler(function (_ref8) {
      var username = _ref8.username,
          paginationParams = _objectWithoutPropertiesLoose(_ref8, ["username"]);

      return {
        pathname: getPathname({
          username: username
        }),
        query: getFeedParams(paginationParams)
      };
    }),
    handleResponse: handleFeedResponse()
  });
}();

var index$3 = {
  __proto__: null,
  get: get$2,
  getPhotos: getPhotos$2,
  getLikes: getLikes,
  getCollections: getCollections$2
};

var BASE_TOPIC_PATH = '/topics';

var getTopicPath = function getTopicPath(_ref) {
  var topicIdOrSlug = _ref.topicIdOrSlug;
  return BASE_TOPIC_PATH + "/" + topicIdOrSlug;
};

var list$2 = /*#__PURE__*/makeEndpoint({
  getPathname: getTopicPath,
  handleRequest: function handleRequest(_ref2) {
    var page = _ref2.page,
        perPage = _ref2.perPage,
        orderBy = _ref2.orderBy,
        topicIdsOrSlugs = _ref2.topicIdsOrSlugs;
    return {
      pathname: BASE_TOPIC_PATH,
      query: compactDefined(_extends({}, getFeedParams({
        page: page,
        perPage: perPage
      }), {
        ids: topicIdsOrSlugs == null ? void 0 : topicIdsOrSlugs.join(','),
        order_by: orderBy
      }))
    };
  },
  handleResponse: /*#__PURE__*/handleFeedResponse()
});
var get$3 = /*#__PURE__*/makeEndpoint({
  getPathname: getTopicPath,
  handleRequest: function handleRequest(_ref3) {
    var topicIdOrSlug = _ref3.topicIdOrSlug;
    return {
      pathname: getTopicPath({
        topicIdOrSlug: topicIdOrSlug
      }),
      query: {}
    };
  },
  handleResponse: /*#__PURE__*/castResponse()
});
var getPhotos$3 = /*#__PURE__*/function () {
  var getPathname = /*#__PURE__*/flow(getTopicPath, function (topicPath) {
    return topicPath + "/photos";
  });
  return makeEndpoint({
    getPathname: getPathname,
    handleRequest: function handleRequest(_ref4) {
      var topicIdOrSlug = _ref4.topicIdOrSlug,
          orientation = _ref4.orientation,
          feedParams = _objectWithoutPropertiesLoose(_ref4, ["topicIdOrSlug", "orientation"]);

      return {
        pathname: getPathname({
          topicIdOrSlug: topicIdOrSlug
        }),
        query: compactDefined(_extends({}, getFeedParams(feedParams), {
          orientation: orientation
        }))
      };
    },
    handleResponse: handleFeedResponse()
  });
}();

var index$4 = {
  __proto__: null,
  list: list$2,
  get: get$3,
  getPhotos: getPhotos$3
};

var trackNonHotLinkedPhotoView = function trackNonHotLinkedPhotoView(_ref) {
  var appId = _ref.appId;
  return function (_ref2) {
    var photoId = _ref2.photoId;
    var ids = !Array.isArray(photoId) ? [photoId] : photoId;

    if (ids.length > 20) {
      throw new Error('You cannot track more than 20 photos at once. Please try again with fewer photos.');
    }

    return fetch("views.unsplash.com/v?photo_id=" + ids.join() + "&app_id=" + appId);
  };
};



var internals = {
  __proto__: null,
  collections: index,
  photos: index$1,
  search: index$2,
  users: index$3,
  topics: index$4,
  trackNonHotLinkedPhotoView: trackNonHotLinkedPhotoView
};

var Language;

(function (Language) {
  Language["Afrikaans"] = "af";
  Language["Amharic"] = "am";
  Language["Arabic"] = "ar";
  Language["Azerbaijani"] = "az";
  Language["Belarusian"] = "be";
  Language["Bulgarian"] = "bg";
  Language["Bengali"] = "bn";
  Language["Bosnian"] = "bs";
  Language["Catalan"] = "ca";
  Language["Cebuano"] = "ceb";
  Language["Corsican"] = "co";
  Language["Czech"] = "cs";
  Language["Welsh"] = "cy";
  Language["Danish"] = "da";
  Language["German"] = "de";
  Language["Greek"] = "el";
  Language["English"] = "en";
  Language["Esperanto"] = "eo";
  Language["Spanish"] = "es";
  Language["Estonian"] = "et";
  Language["Basque"] = "eu";
  Language["Persian"] = "fa";
  Language["Finnish"] = "fi";
  Language["French"] = "fr";
  Language["Frisian"] = "fy";
  Language["Irish"] = "ga";
  Language["ScotsGaelic"] = "gd";
  Language["Galician"] = "gl";
  Language["Gujarati"] = "gu";
  Language["Hausa"] = "ha";
  Language["Hawaiian"] = "haw";
  Language["Hindi"] = "hi";
  Language["Hmong"] = "hmn";
  Language["Croatian"] = "hr";
  Language["HaitianCreole"] = "ht";
  Language["Hungarian"] = "hu";
  Language["Armenian"] = "hy";
  Language["Indonesian"] = "id";
  Language["Igbo"] = "ig";
  Language["Icelandic"] = "is";
  Language["Italian"] = "it";
  Language["Hebrew"] = "iw";
  Language["Japanese"] = "ja";
  Language["Javanese"] = "jw";
  Language["Georgian"] = "ka";
  Language["Kazakh"] = "kk";
  Language["Khmer"] = "km";
  Language["Kannada"] = "kn";
  Language["Korean"] = "ko";
  Language["Kurdish"] = "ku";
  Language["Kyrgyz"] = "ky";
  Language["Latin"] = "la";
  Language["Luxembourgish"] = "lb";
  Language["Lao"] = "lo";
  Language["Lithuanian"] = "lt";
  Language["Latvian"] = "lv";
  Language["Malagasy"] = "mg";
  Language["Maori"] = "mi";
  Language["Macedonian"] = "mk";
  Language["Malayalam"] = "ml";
  Language["Mongolian"] = "mn";
  Language["Marathi"] = "mr";
  Language["Malay"] = "ms";
  Language["Maltese"] = "mt";
  Language["Myanmar"] = "my";
  Language["Nepali"] = "ne";
  Language["Dutch"] = "nl";
  Language["Norwegian"] = "no";
  Language["Nyanja"] = "ny";
  Language["Oriya"] = "or";
  Language["Punjabi"] = "pa";
  Language["Polish"] = "pl";
  Language["Pashto"] = "ps";
  Language["Portuguese"] = "pt";
  Language["Romanian"] = "ro";
  Language["Russian"] = "ru";
  Language["Kinyarwanda"] = "rw";
  Language["Sindhi"] = "sd";
  Language["Sinhala"] = "si";
  Language["Slovak"] = "sk";
  Language["Slovenian"] = "sl";
  Language["Samoan"] = "sm";
  Language["Shona"] = "sn";
  Language["Somali"] = "so";
  Language["Albanian"] = "sq";
  Language["Serbian"] = "sr";
  Language["Sesotho"] = "st";
  Language["Sundanese"] = "su";
  Language["Swedish"] = "sv";
  Language["Swahili"] = "sw";
  Language["Tamil"] = "ta";
  Language["Telugu"] = "te";
  Language["Tajik"] = "tg";
  Language["Thai"] = "th";
  Language["Turkmen"] = "tk";
  Language["Filipino"] = "tl";
  Language["Turkish"] = "tr";
  Language["Tatar"] = "tt";
  Language["Uighur"] = "ug";
  Language["Ukrainian"] = "uk";
  Language["Urdu"] = "ur";
  Language["Uzbek"] = "uz";
  Language["Vietnamese"] = "vi";
  Language["Xhosa"] = "xh";
  Language["Yiddish"] = "yi";
  Language["Yoruba"] = "yo";
  Language["ChineseSimplified"] = "zh";
  Language["ChineseTraditional"] = "zh-TW";
  Language["Zulu"] = "zu";
})(Language || (Language = {}));

var OrderBy;

(function (OrderBy) {
  OrderBy["LATEST"] = "latest";
  OrderBy["POPULAR"] = "popular";
  OrderBy["VIEWS"] = "views";
  OrderBy["DOWNLOADS"] = "downloads";
  OrderBy["OLDEST"] = "oldest";
})(OrderBy || (OrderBy = {}));

var createApi = /*#__PURE__*/flow(initMakeRequest, function (makeRequest) {
  return {
    photos: {
      get: makeRequest(get$1),
      list: makeRequest(list$1),
      getStats: makeRequest(getStats),
      getRandom: makeRequest(getRandom),
      trackDownload: makeRequest(trackDownload)
    },
    users: {
      getPhotos: makeRequest(getPhotos$2),
      getCollections: makeRequest(getCollections$2),
      getLikes: makeRequest(getLikes),
      get: makeRequest(get$2)
    },
    search: {
      getCollections: makeRequest(getCollections$1),
      getPhotos: makeRequest(getPhotos$1),
      getUsers: makeRequest(getUsers)
    },
    collections: {
      getPhotos: makeRequest(getPhotos),
      get: makeRequest(get),
      list: makeRequest(list),
      getRelated: makeRequest(getRelated)
    },
    topics: {
      list: makeRequest(list$2),
      get: makeRequest(get$3),
      getPhotos: makeRequest(getPhotos$3)
    }
  };
});


//# sourceMappingURL=unsplash-js.esm.js.map


/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
Object.defineProperty(exports, "NIL", ({
  enumerable: true,
  get: function get() {
    return _nil.default;
  }
}));
Object.defineProperty(exports, "parse", ({
  enumerable: true,
  get: function get() {
    return _parse.default;
  }
}));
Object.defineProperty(exports, "stringify", ({
  enumerable: true,
  get: function get() {
    return _stringify.default;
  }
}));
Object.defineProperty(exports, "v1", ({
  enumerable: true,
  get: function get() {
    return _v.default;
  }
}));
Object.defineProperty(exports, "v3", ({
  enumerable: true,
  get: function get() {
    return _v2.default;
  }
}));
Object.defineProperty(exports, "v4", ({
  enumerable: true,
  get: function get() {
    return _v3.default;
  }
}));
Object.defineProperty(exports, "v5", ({
  enumerable: true,
  get: function get() {
    return _v4.default;
  }
}));
Object.defineProperty(exports, "validate", ({
  enumerable: true,
  get: function get() {
    return _validate.default;
  }
}));
Object.defineProperty(exports, "version", ({
  enumerable: true,
  get: function get() {
    return _version.default;
  }
}));

var _v = _interopRequireDefault(__webpack_require__(/*! ./v1.js */ "./node_modules/uuid/dist/commonjs-browser/v1.js"));

var _v2 = _interopRequireDefault(__webpack_require__(/*! ./v3.js */ "./node_modules/uuid/dist/commonjs-browser/v3.js"));

var _v3 = _interopRequireDefault(__webpack_require__(/*! ./v4.js */ "./node_modules/uuid/dist/commonjs-browser/v4.js"));

var _v4 = _interopRequireDefault(__webpack_require__(/*! ./v5.js */ "./node_modules/uuid/dist/commonjs-browser/v5.js"));

var _nil = _interopRequireDefault(__webpack_require__(/*! ./nil.js */ "./node_modules/uuid/dist/commonjs-browser/nil.js"));

var _version = _interopRequireDefault(__webpack_require__(/*! ./version.js */ "./node_modules/uuid/dist/commonjs-browser/version.js"));

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

var _stringify = _interopRequireDefault(__webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js"));

var _parse = _interopRequireDefault(__webpack_require__(/*! ./parse.js */ "./node_modules/uuid/dist/commonjs-browser/parse.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/md5.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/md5.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

/*
 * Browser-compatible JavaScript MD5
 *
 * Modification of JavaScript MD5
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * https://opensource.org/licenses/MIT
 *
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
function md5(bytes) {
  if (typeof bytes === 'string') {
    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape

    bytes = new Uint8Array(msg.length);

    for (let i = 0; i < msg.length; ++i) {
      bytes[i] = msg.charCodeAt(i);
    }
  }

  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));
}
/*
 * Convert an array of little-endian words to an array of bytes
 */


function md5ToHexEncodedArray(input) {
  const output = [];
  const length32 = input.length * 32;
  const hexTab = '0123456789abcdef';

  for (let i = 0; i < length32; i += 8) {
    const x = input[i >> 5] >>> i % 32 & 0xff;
    const hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);
    output.push(hex);
  }

  return output;
}
/**
 * Calculate output length with padding and bit length
 */


function getOutputLength(inputLength8) {
  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;
}
/*
 * Calculate the MD5 of an array of little-endian words, and a bit length.
 */


function wordsToMd5(x, len) {
  /* append padding */
  x[len >> 5] |= 0x80 << len % 32;
  x[getOutputLength(len) - 1] = len;
  let a = 1732584193;
  let b = -271733879;
  let c = -1732584194;
  let d = 271733878;

  for (let i = 0; i < x.length; i += 16) {
    const olda = a;
    const oldb = b;
    const oldc = c;
    const oldd = d;
    a = md5ff(a, b, c, d, x[i], 7, -680876936);
    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);
    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);
    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);
    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);
    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);
    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);
    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);
    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);
    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);
    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);
    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);
    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);
    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);
    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);
    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);
    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);
    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);
    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);
    b = md5gg(b, c, d, a, x[i], 20, -373897302);
    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);
    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);
    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);
    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);
    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);
    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);
    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);
    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);
    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);
    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);
    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);
    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);
    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);
    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);
    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);
    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);
    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);
    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);
    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);
    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);
    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);
    d = md5hh(d, a, b, c, x[i], 11, -358537222);
    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);
    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);
    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);
    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);
    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);
    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);
    a = md5ii(a, b, c, d, x[i], 6, -198630844);
    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);
    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);
    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);
    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);
    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);
    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);
    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);
    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);
    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);
    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);
    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);
    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);
    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);
    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);
    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);
    a = safeAdd(a, olda);
    b = safeAdd(b, oldb);
    c = safeAdd(c, oldc);
    d = safeAdd(d, oldd);
  }

  return [a, b, c, d];
}
/*
 * Convert an array bytes to an array of little-endian words
 * Characters >255 have their high-byte silently ignored.
 */


function bytesToWords(input) {
  if (input.length === 0) {
    return [];
  }

  const length8 = input.length * 8;
  const output = new Uint32Array(getOutputLength(length8));

  for (let i = 0; i < length8; i += 8) {
    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;
  }

  return output;
}
/*
 * Add integers, wrapping at 2^32. This uses 16-bit operations internally
 * to work around bugs in some JS interpreters.
 */


function safeAdd(x, y) {
  const lsw = (x & 0xffff) + (y & 0xffff);
  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);
  return msw << 16 | lsw & 0xffff;
}
/*
 * Bitwise rotate a 32-bit number to the left.
 */


function bitRotateLeft(num, cnt) {
  return num << cnt | num >>> 32 - cnt;
}
/*
 * These functions implement the four basic operations the algorithm uses.
 */


function md5cmn(q, a, b, x, s, t) {
  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);
}

function md5ff(a, b, c, d, x, s, t) {
  return md5cmn(b & c | ~b & d, a, b, x, s, t);
}

function md5gg(a, b, c, d, x, s, t) {
  return md5cmn(b & d | c & ~d, a, b, x, s, t);
}

function md5hh(a, b, c, d, x, s, t) {
  return md5cmn(b ^ c ^ d, a, b, x, s, t);
}

function md5ii(a, b, c, d, x, s, t) {
  return md5cmn(c ^ (b | ~d), a, b, x, s, t);
}

var _default = md5;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/native.js":
/*!***********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/native.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var _default = {
  randomUUID
};
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/nil.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/nil.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
var _default = '00000000-0000-0000-0000-000000000000';
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/parse.js":
/*!**********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/parse.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function parse(uuid) {
  if (!(0, _validate.default)(uuid)) {
    throw TypeError('Invalid UUID');
  }

  let v;
  const arr = new Uint8Array(16); // Parse ########-....-....-....-............

  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 0xff;
  arr[2] = v >>> 8 & 0xff;
  arr[3] = v & 0xff; // Parse ........-####-....-....-............

  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 0xff; // Parse ........-....-####-....-............

  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 0xff; // Parse ........-....-....-####-............

  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 0xff; // Parse ........-....-....-....-############
  // (Use "/" to avoid 32-bit truncation when bit-shifting high-order bytes)

  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;
  arr[11] = v / 0x100000000 & 0xff;
  arr[12] = v >>> 24 & 0xff;
  arr[13] = v >>> 16 & 0xff;
  arr[14] = v >>> 8 & 0xff;
  arr[15] = v & 0xff;
  return arr;
}

var _default = parse;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/regex.js":
/*!**********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/regex.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
var _default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/rng.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/rng.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = rng;
// Unique ID creation requires a high quality random # generator. In the browser we therefore
// require the crypto API and do not support built-in fallback to lower quality random number
// generators (like Math.random()).
let getRandomValues;
const rnds8 = new Uint8Array(16);

function rng() {
  // lazy load so that environments that need to polyfill have a chance to do so
  if (!getRandomValues) {
    // getRandomValues needs to be invoked in a context where "this" is a Crypto implementation.
    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);

    if (!getRandomValues) {
      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');
    }
  }

  return getRandomValues(rnds8);
}

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/sha1.js":
/*!*********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/sha1.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, exports) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

// Adapted from Chris Veness' SHA1 code at
// http://www.movable-type.co.uk/scripts/sha1.html
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;

    case 1:
      return x ^ y ^ z;

    case 2:
      return x & y ^ x & z ^ y & z;

    case 3:
      return x ^ y ^ z;
  }
}

function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}

function sha1(bytes) {
  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];
  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];

  if (typeof bytes === 'string') {
    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape

    bytes = [];

    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    // Convert Array-like to Array
    bytes = Array.prototype.slice.call(bytes);
  }

  bytes.push(0x80);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);

  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);

    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }

    M[i] = arr;
  }

  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;

  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);

    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }

    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }

    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];

    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }

    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }

  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];
}

var _default = sha1;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/stringify.js":
/*!**************************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/stringify.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;
exports.unsafeStringify = unsafeStringify;

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */
const byteToHex = [];

for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 0x100).toString(16).slice(1));
}

function unsafeStringify(arr, offset = 0) {
  // Note: Be careful editing this code!  It's been tuned for performance
  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434
  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();
}

function stringify(arr, offset = 0) {
  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one
  // of the following:
  // - One or more input array values don't map to a hex octet (leading to
  // "undefined" in the uuid)
  // - Invalid input values for the RFC `version` or `variant` fields

  if (!(0, _validate.default)(uuid)) {
    throw TypeError('Stringified UUID is invalid');
  }

  return uuid;
}

var _default = stringify;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v1.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v1.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _rng = _interopRequireDefault(__webpack_require__(/*! ./rng.js */ "./node_modules/uuid/dist/commonjs-browser/rng.js"));

var _stringify = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// **`v1()` - Generate time-based UUID**
//
// Inspired by https://github.com/LiosK/UUID.js
// and http://docs.python.org/library/uuid.html
let _nodeId;

let _clockseq; // Previous uuid creation time


let _lastMSecs = 0;
let _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details

function v1(options, buf, offset) {
  let i = buf && offset || 0;
  const b = buf || new Array(16);
  options = options || {};
  let node = options.node || _nodeId;
  let clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not
  // specified.  We do this lazily to minimize issues related to insufficient
  // system entropy.  See #189

  if (node == null || clockseq == null) {
    const seedBytes = options.random || (options.rng || _rng.default)();

    if (node == null) {
      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)
      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];
    }

    if (clockseq == null) {
      // Per 4.2.2, randomize (14 bit) clockseq
      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;
    }
  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,
  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so
  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'
  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.


  let msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock
  // cycle to simulate higher resolution clock

  let nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)

  const dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression

  if (dt < 0 && options.clockseq === undefined) {
    clockseq = clockseq + 1 & 0x3fff;
  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new
  // time interval


  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {
    nsecs = 0;
  } // Per 4.2.1.2 Throw error if too many uuids are requested


  if (nsecs >= 10000) {
    throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");
  }

  _lastMSecs = msecs;
  _lastNSecs = nsecs;
  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch

  msecs += 12219292800000; // `time_low`

  const tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;
  b[i++] = tl >>> 24 & 0xff;
  b[i++] = tl >>> 16 & 0xff;
  b[i++] = tl >>> 8 & 0xff;
  b[i++] = tl & 0xff; // `time_mid`

  const tmh = msecs / 0x100000000 * 10000 & 0xfffffff;
  b[i++] = tmh >>> 8 & 0xff;
  b[i++] = tmh & 0xff; // `time_high_and_version`

  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version

  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)

  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`

  b[i++] = clockseq & 0xff; // `node`

  for (let n = 0; n < 6; ++n) {
    b[i + n] = node[n];
  }

  return buf || (0, _stringify.unsafeStringify)(b);
}

var _default = v1;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v3.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v3.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _v = _interopRequireDefault(__webpack_require__(/*! ./v35.js */ "./node_modules/uuid/dist/commonjs-browser/v35.js"));

var _md = _interopRequireDefault(__webpack_require__(/*! ./md5.js */ "./node_modules/uuid/dist/commonjs-browser/md5.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const v3 = (0, _v.default)('v3', 0x30, _md.default);
var _default = v3;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v35.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v35.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.URL = exports.DNS = void 0;
exports["default"] = v35;

var _stringify = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js");

var _parse = _interopRequireDefault(__webpack_require__(/*! ./parse.js */ "./node_modules/uuid/dist/commonjs-browser/parse.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function stringToBytes(str) {
  str = unescape(encodeURIComponent(str)); // UTF8 escape

  const bytes = [];

  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }

  return bytes;
}

const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';
exports.DNS = DNS;
const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';
exports.URL = URL;

function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;

    if (typeof value === 'string') {
      value = stringToBytes(value);
    }

    if (typeof namespace === 'string') {
      namespace = (0, _parse.default)(namespace);
    }

    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');
    } // Compute hash of namespace and value, Per 4.3
    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =
    // hashfunc([...namespace, ... value])`


    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 0x0f | version;
    bytes[8] = bytes[8] & 0x3f | 0x80;

    if (buf) {
      offset = offset || 0;

      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }

      return buf;
    }

    return (0, _stringify.unsafeStringify)(bytes);
  } // Function#name is not settable on some platforms (#270)


  try {
    generateUUID.name = name; // eslint-disable-next-line no-empty
  } catch (err) {} // For CommonJS default export support


  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v4.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v4.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _native = _interopRequireDefault(__webpack_require__(/*! ./native.js */ "./node_modules/uuid/dist/commonjs-browser/native.js"));

var _rng = _interopRequireDefault(__webpack_require__(/*! ./rng.js */ "./node_modules/uuid/dist/commonjs-browser/rng.js"));

var _stringify = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/commonjs-browser/stringify.js");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function v4(options, buf, offset) {
  if (_native.default.randomUUID && !buf && !options) {
    return _native.default.randomUUID();
  }

  options = options || {};

  const rnds = options.random || (options.rng || _rng.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`


  rnds[6] = rnds[6] & 0x0f | 0x40;
  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided

  if (buf) {
    offset = offset || 0;

    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }

    return buf;
  }

  return (0, _stringify.unsafeStringify)(rnds);
}

var _default = v4;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/v5.js":
/*!*******************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/v5.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _v = _interopRequireDefault(__webpack_require__(/*! ./v35.js */ "./node_modules/uuid/dist/commonjs-browser/v35.js"));

var _sha = _interopRequireDefault(__webpack_require__(/*! ./sha1.js */ "./node_modules/uuid/dist/commonjs-browser/sha1.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const v5 = (0, _v.default)('v5', 0x50, _sha.default);
var _default = v5;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/validate.js":
/*!*************************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/validate.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _regex = _interopRequireDefault(__webpack_require__(/*! ./regex.js */ "./node_modules/uuid/dist/commonjs-browser/regex.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function validate(uuid) {
  return typeof uuid === 'string' && _regex.default.test(uuid);
}

var _default = validate;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/commonjs-browser/version.js":
/*!************************************************************!*\
  !*** ./node_modules/uuid/dist/commonjs-browser/version.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _validate = _interopRequireDefault(__webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/commonjs-browser/validate.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function version(uuid) {
  if (!(0, _validate.default)(uuid)) {
    throw TypeError('Invalid UUID');
  }

  return parseInt(uuid.slice(14, 15), 16);
}

var _default = version;
exports["default"] = _default;

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/native.js":
/*!******************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/native.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  randomUUID
});

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/regex.js":
/*!*****************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/regex.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/rng.js":
/*!***************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/rng.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ rng)
/* harmony export */ });
// Unique ID creation requires a high quality random # generator. In the browser we therefore
// require the crypto API and do not support built-in fallback to lower quality random number
// generators (like Math.random()).
let getRandomValues;
const rnds8 = new Uint8Array(16);
function rng() {
  // lazy load so that environments that need to polyfill have a chance to do so
  if (!getRandomValues) {
    // getRandomValues needs to be invoked in a context where "this" is a Crypto implementation.
    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);

    if (!getRandomValues) {
      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');
    }
  }

  return getRandomValues(rnds8);
}

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/stringify.js":
/*!*********************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/stringify.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   "unsafeStringify": () => (/* binding */ unsafeStringify)
/* harmony export */ });
/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ "./node_modules/uuid/dist/esm-browser/validate.js");

/**
 * Convert array of 16 byte values to UUID string format of the form:
 * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
 */

const byteToHex = [];

for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 0x100).toString(16).slice(1));
}

function unsafeStringify(arr, offset = 0) {
  // Note: Be careful editing this code!  It's been tuned for performance
  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434
  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();
}

function stringify(arr, offset = 0) {
  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one
  // of the following:
  // - One or more input array values don't map to a hex octet (leading to
  // "undefined" in the uuid)
  // - Invalid input values for the RFC `version` or `variant` fields

  if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__["default"])(uuid)) {
    throw TypeError('Stringified UUID is invalid');
  }

  return uuid;
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/v4.js":
/*!**************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/v4.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _native_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./native.js */ "./node_modules/uuid/dist/esm-browser/native.js");
/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rng.js */ "./node_modules/uuid/dist/esm-browser/rng.js");
/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stringify.js */ "./node_modules/uuid/dist/esm-browser/stringify.js");




function v4(options, buf, offset) {
  if (_native_js__WEBPACK_IMPORTED_MODULE_0__["default"].randomUUID && !buf && !options) {
    return _native_js__WEBPACK_IMPORTED_MODULE_0__["default"].randomUUID();
  }

  options = options || {};
  const rnds = options.random || (options.rng || _rng_js__WEBPACK_IMPORTED_MODULE_1__["default"])(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`

  rnds[6] = rnds[6] & 0x0f | 0x40;
  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided

  if (buf) {
    offset = offset || 0;

    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }

    return buf;
  }

  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_2__.unsafeStringify)(rnds);
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/validate.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/validate.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ "./node_modules/uuid/dist/esm-browser/regex.js");


function validate(uuid) {
  return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__["default"].test(uuid);
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);

/***/ }),

/***/ "./node_modules/webextension-polyfill/dist/browser-polyfill.js":
/*!*********************************************************************!*\
  !*** ./node_modules/webextension-polyfill/dist/browser-polyfill.js ***!
  \*********************************************************************/
/***/ (function(module, exports) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {
  if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [module], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
		__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
		(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
		__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else { var mod; }
})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : this, function (module) {
  /* webextension-polyfill - v0.10.0 - Fri Aug 12 2022 19:42:44 */

  /* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */

  /* vim: set sts=2 sw=2 et tw=80: */

  /* This Source Code Form is subject to the terms of the Mozilla Public
   * License, v. 2.0. If a copy of the MPL was not distributed with this
   * file, You can obtain one at http://mozilla.org/MPL/2.0/. */
  "use strict";

  if (!globalThis.chrome?.runtime?.id) {
    throw new Error("This script should only be loaded in a browser extension.");
  }

  if (typeof globalThis.browser === "undefined" || Object.getPrototypeOf(globalThis.browser) !== Object.prototype) {
    const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = "The message port closed before a response was received."; // Wrapping the bulk of this polyfill in a one-time-use function is a minor
    // optimization for Firefox. Since Spidermonkey does not fully parse the
    // contents of a function until the first time it's called, and since it will
    // never actually need to be called, this allows the polyfill to be included
    // in Firefox nearly for free.

    const wrapAPIs = extensionAPIs => {
      // NOTE: apiMetadata is associated to the content of the api-metadata.json file
      // at build time by replacing the following "include" with the content of the
      // JSON file.
      const apiMetadata = {
        "alarms": {
          "clear": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "clearAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "get": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "bookmarks": {
          "create": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getChildren": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getRecent": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getSubTree": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getTree": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "move": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeTree": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "search": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        },
        "browserAction": {
          "disable": {
            "minArgs": 0,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "enable": {
            "minArgs": 0,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "getBadgeBackgroundColor": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getBadgeText": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getPopup": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getTitle": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "openPopup": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "setBadgeBackgroundColor": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setBadgeText": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setIcon": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "setPopup": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setTitle": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          }
        },
        "browsingData": {
          "remove": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "removeCache": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeCookies": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeDownloads": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeFormData": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeHistory": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeLocalStorage": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removePasswords": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removePluginData": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "settings": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "commands": {
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "contextMenus": {
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        },
        "cookies": {
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAllCookieStores": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "set": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "devtools": {
          "inspectedWindow": {
            "eval": {
              "minArgs": 1,
              "maxArgs": 2,
              "singleCallbackArg": false
            }
          },
          "panels": {
            "create": {
              "minArgs": 3,
              "maxArgs": 3,
              "singleCallbackArg": true
            },
            "elements": {
              "createSidebarPane": {
                "minArgs": 1,
                "maxArgs": 1
              }
            }
          }
        },
        "downloads": {
          "cancel": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "download": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "erase": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getFileIcon": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "open": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "pause": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeFile": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "resume": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "search": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "show": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          }
        },
        "extension": {
          "isAllowedFileSchemeAccess": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "isAllowedIncognitoAccess": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "history": {
          "addUrl": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "deleteAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "deleteRange": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "deleteUrl": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getVisits": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "search": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "i18n": {
          "detectLanguage": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAcceptLanguages": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "identity": {
          "launchWebAuthFlow": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "idle": {
          "queryState": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "management": {
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getSelf": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "setEnabled": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "uninstallSelf": {
            "minArgs": 0,
            "maxArgs": 1
          }
        },
        "notifications": {
          "clear": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "create": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getPermissionLevel": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        },
        "pageAction": {
          "getPopup": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getTitle": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "hide": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setIcon": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "setPopup": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "setTitle": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          },
          "show": {
            "minArgs": 1,
            "maxArgs": 1,
            "fallbackToNoCallback": true
          }
        },
        "permissions": {
          "contains": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "request": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "runtime": {
          "getBackgroundPage": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getPlatformInfo": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "openOptionsPage": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "requestUpdateCheck": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "sendMessage": {
            "minArgs": 1,
            "maxArgs": 3
          },
          "sendNativeMessage": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "setUninstallURL": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "sessions": {
          "getDevices": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getRecentlyClosed": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "restore": {
            "minArgs": 0,
            "maxArgs": 1
          }
        },
        "storage": {
          "local": {
            "clear": {
              "minArgs": 0,
              "maxArgs": 0
            },
            "get": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "getBytesInUse": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "remove": {
              "minArgs": 1,
              "maxArgs": 1
            },
            "set": {
              "minArgs": 1,
              "maxArgs": 1
            }
          },
          "managed": {
            "get": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "getBytesInUse": {
              "minArgs": 0,
              "maxArgs": 1
            }
          },
          "sync": {
            "clear": {
              "minArgs": 0,
              "maxArgs": 0
            },
            "get": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "getBytesInUse": {
              "minArgs": 0,
              "maxArgs": 1
            },
            "remove": {
              "minArgs": 1,
              "maxArgs": 1
            },
            "set": {
              "minArgs": 1,
              "maxArgs": 1
            }
          }
        },
        "tabs": {
          "captureVisibleTab": {
            "minArgs": 0,
            "maxArgs": 2
          },
          "create": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "detectLanguage": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "discard": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "duplicate": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "executeScript": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "get": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getCurrent": {
            "minArgs": 0,
            "maxArgs": 0
          },
          "getZoom": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getZoomSettings": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "goBack": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "goForward": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "highlight": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "insertCSS": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "move": {
            "minArgs": 2,
            "maxArgs": 2
          },
          "query": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "reload": {
            "minArgs": 0,
            "maxArgs": 2
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "removeCSS": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "sendMessage": {
            "minArgs": 2,
            "maxArgs": 3
          },
          "setZoom": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "setZoomSettings": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "update": {
            "minArgs": 1,
            "maxArgs": 2
          }
        },
        "topSites": {
          "get": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "webNavigation": {
          "getAllFrames": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "getFrame": {
            "minArgs": 1,
            "maxArgs": 1
          }
        },
        "webRequest": {
          "handlerBehaviorChanged": {
            "minArgs": 0,
            "maxArgs": 0
          }
        },
        "windows": {
          "create": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "get": {
            "minArgs": 1,
            "maxArgs": 2
          },
          "getAll": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getCurrent": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "getLastFocused": {
            "minArgs": 0,
            "maxArgs": 1
          },
          "remove": {
            "minArgs": 1,
            "maxArgs": 1
          },
          "update": {
            "minArgs": 2,
            "maxArgs": 2
          }
        }
      };

      if (Object.keys(apiMetadata).length === 0) {
        throw new Error("api-metadata.json has not been included in browser-polyfill");
      }
      /**
       * A WeakMap subclass which creates and stores a value for any key which does
       * not exist when accessed, but behaves exactly as an ordinary WeakMap
       * otherwise.
       *
       * @param {function} createItem
       *        A function which will be called in order to create the value for any
       *        key which does not exist, the first time it is accessed. The
       *        function receives, as its only argument, the key being created.
       */


      class DefaultWeakMap extends WeakMap {
        constructor(createItem, items = undefined) {
          super(items);
          this.createItem = createItem;
        }

        get(key) {
          if (!this.has(key)) {
            this.set(key, this.createItem(key));
          }

          return super.get(key);
        }

      }
      /**
       * Returns true if the given object is an object with a `then` method, and can
       * therefore be assumed to behave as a Promise.
       *
       * @param {*} value The value to test.
       * @returns {boolean} True if the value is thenable.
       */


      const isThenable = value => {
        return value && typeof value === "object" && typeof value.then === "function";
      };
      /**
       * Creates and returns a function which, when called, will resolve or reject
       * the given promise based on how it is called:
       *
       * - If, when called, `chrome.runtime.lastError` contains a non-null object,
       *   the promise is rejected with that value.
       * - If the function is called with exactly one argument, the promise is
       *   resolved to that value.
       * - Otherwise, the promise is resolved to an array containing all of the
       *   function's arguments.
       *
       * @param {object} promise
       *        An object containing the resolution and rejection functions of a
       *        promise.
       * @param {function} promise.resolve
       *        The promise's resolution function.
       * @param {function} promise.reject
       *        The promise's rejection function.
       * @param {object} metadata
       *        Metadata about the wrapped method which has created the callback.
       * @param {boolean} metadata.singleCallbackArg
       *        Whether or not the promise is resolved with only the first
       *        argument of the callback, alternatively an array of all the
       *        callback arguments is resolved. By default, if the callback
       *        function is invoked with only a single argument, that will be
       *        resolved to the promise, while all arguments will be resolved as
       *        an array if multiple are given.
       *
       * @returns {function}
       *        The generated callback function.
       */


      const makeCallback = (promise, metadata) => {
        return (...callbackArgs) => {
          if (extensionAPIs.runtime.lastError) {
            promise.reject(new Error(extensionAPIs.runtime.lastError.message));
          } else if (metadata.singleCallbackArg || callbackArgs.length <= 1 && metadata.singleCallbackArg !== false) {
            promise.resolve(callbackArgs[0]);
          } else {
            promise.resolve(callbackArgs);
          }
        };
      };

      const pluralizeArguments = numArgs => numArgs == 1 ? "argument" : "arguments";
      /**
       * Creates a wrapper function for a method with the given name and metadata.
       *
       * @param {string} name
       *        The name of the method which is being wrapped.
       * @param {object} metadata
       *        Metadata about the method being wrapped.
       * @param {integer} metadata.minArgs
       *        The minimum number of arguments which must be passed to the
       *        function. If called with fewer than this number of arguments, the
       *        wrapper will raise an exception.
       * @param {integer} metadata.maxArgs
       *        The maximum number of arguments which may be passed to the
       *        function. If called with more than this number of arguments, the
       *        wrapper will raise an exception.
       * @param {boolean} metadata.singleCallbackArg
       *        Whether or not the promise is resolved with only the first
       *        argument of the callback, alternatively an array of all the
       *        callback arguments is resolved. By default, if the callback
       *        function is invoked with only a single argument, that will be
       *        resolved to the promise, while all arguments will be resolved as
       *        an array if multiple are given.
       *
       * @returns {function(object, ...*)}
       *       The generated wrapper function.
       */


      const wrapAsyncFunction = (name, metadata) => {
        return function asyncFunctionWrapper(target, ...args) {
          if (args.length < metadata.minArgs) {
            throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);
          }

          if (args.length > metadata.maxArgs) {
            throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);
          }

          return new Promise((resolve, reject) => {
            if (metadata.fallbackToNoCallback) {
              // This API method has currently no callback on Chrome, but it return a promise on Firefox,
              // and so the polyfill will try to call it with a callback first, and it will fallback
              // to not passing the callback if the first call fails.
              try {
                target[name](...args, makeCallback({
                  resolve,
                  reject
                }, metadata));
              } catch (cbError) {
                console.warn(`${name} API method doesn't seem to support the callback parameter, ` + "falling back to call it without a callback: ", cbError);
                target[name](...args); // Update the API method metadata, so that the next API calls will not try to
                // use the unsupported callback anymore.

                metadata.fallbackToNoCallback = false;
                metadata.noCallback = true;
                resolve();
              }
            } else if (metadata.noCallback) {
              target[name](...args);
              resolve();
            } else {
              target[name](...args, makeCallback({
                resolve,
                reject
              }, metadata));
            }
          });
        };
      };
      /**
       * Wraps an existing method of the target object, so that calls to it are
       * intercepted by the given wrapper function. The wrapper function receives,
       * as its first argument, the original `target` object, followed by each of
       * the arguments passed to the original method.
       *
       * @param {object} target
       *        The original target object that the wrapped method belongs to.
       * @param {function} method
       *        The method being wrapped. This is used as the target of the Proxy
       *        object which is created to wrap the method.
       * @param {function} wrapper
       *        The wrapper function which is called in place of a direct invocation
       *        of the wrapped method.
       *
       * @returns {Proxy<function>}
       *        A Proxy object for the given method, which invokes the given wrapper
       *        method in its place.
       */


      const wrapMethod = (target, method, wrapper) => {
        return new Proxy(method, {
          apply(targetMethod, thisObj, args) {
            return wrapper.call(thisObj, target, ...args);
          }

        });
      };

      let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);
      /**
       * Wraps an object in a Proxy which intercepts and wraps certain methods
       * based on the given `wrappers` and `metadata` objects.
       *
       * @param {object} target
       *        The target object to wrap.
       *
       * @param {object} [wrappers = {}]
       *        An object tree containing wrapper functions for special cases. Any
       *        function present in this object tree is called in place of the
       *        method in the same location in the `target` object tree. These
       *        wrapper methods are invoked as described in {@see wrapMethod}.
       *
       * @param {object} [metadata = {}]
       *        An object tree containing metadata used to automatically generate
       *        Promise-based wrapper functions for asynchronous. Any function in
       *        the `target` object tree which has a corresponding metadata object
       *        in the same location in the `metadata` tree is replaced with an
       *        automatically-generated wrapper function, as described in
       *        {@see wrapAsyncFunction}
       *
       * @returns {Proxy<object>}
       */

      const wrapObject = (target, wrappers = {}, metadata = {}) => {
        let cache = Object.create(null);
        let handlers = {
          has(proxyTarget, prop) {
            return prop in target || prop in cache;
          },

          get(proxyTarget, prop, receiver) {
            if (prop in cache) {
              return cache[prop];
            }

            if (!(prop in target)) {
              return undefined;
            }

            let value = target[prop];

            if (typeof value === "function") {
              // This is a method on the underlying object. Check if we need to do
              // any wrapping.
              if (typeof wrappers[prop] === "function") {
                // We have a special-case wrapper for this method.
                value = wrapMethod(target, target[prop], wrappers[prop]);
              } else if (hasOwnProperty(metadata, prop)) {
                // This is an async method that we have metadata for. Create a
                // Promise wrapper for it.
                let wrapper = wrapAsyncFunction(prop, metadata[prop]);
                value = wrapMethod(target, target[prop], wrapper);
              } else {
                // This is a method that we don't know or care about. Return the
                // original method, bound to the underlying object.
                value = value.bind(target);
              }
            } else if (typeof value === "object" && value !== null && (hasOwnProperty(wrappers, prop) || hasOwnProperty(metadata, prop))) {
              // This is an object that we need to do some wrapping for the children
              // of. Create a sub-object wrapper for it with the appropriate child
              // metadata.
              value = wrapObject(value, wrappers[prop], metadata[prop]);
            } else if (hasOwnProperty(metadata, "*")) {
              // Wrap all properties in * namespace.
              value = wrapObject(value, wrappers[prop], metadata["*"]);
            } else {
              // We don't need to do any wrapping for this property,
              // so just forward all access to the underlying object.
              Object.defineProperty(cache, prop, {
                configurable: true,
                enumerable: true,

                get() {
                  return target[prop];
                },

                set(value) {
                  target[prop] = value;
                }

              });
              return value;
            }

            cache[prop] = value;
            return value;
          },

          set(proxyTarget, prop, value, receiver) {
            if (prop in cache) {
              cache[prop] = value;
            } else {
              target[prop] = value;
            }

            return true;
          },

          defineProperty(proxyTarget, prop, desc) {
            return Reflect.defineProperty(cache, prop, desc);
          },

          deleteProperty(proxyTarget, prop) {
            return Reflect.deleteProperty(cache, prop);
          }

        }; // Per contract of the Proxy API, the "get" proxy handler must return the
        // original value of the target if that value is declared read-only and
        // non-configurable. For this reason, we create an object with the
        // prototype set to `target` instead of using `target` directly.
        // Otherwise we cannot return a custom object for APIs that
        // are declared read-only and non-configurable, such as `chrome.devtools`.
        //
        // The proxy handlers themselves will still use the original `target`
        // instead of the `proxyTarget`, so that the methods and properties are
        // dereferenced via the original targets.

        let proxyTarget = Object.create(target);
        return new Proxy(proxyTarget, handlers);
      };
      /**
       * Creates a set of wrapper functions for an event object, which handles
       * wrapping of listener functions that those messages are passed.
       *
       * A single wrapper is created for each listener function, and stored in a
       * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`
       * retrieve the original wrapper, so that  attempts to remove a
       * previously-added listener work as expected.
       *
       * @param {DefaultWeakMap<function, function>} wrapperMap
       *        A DefaultWeakMap object which will create the appropriate wrapper
       *        for a given listener function when one does not exist, and retrieve
       *        an existing one when it does.
       *
       * @returns {object}
       */


      const wrapEvent = wrapperMap => ({
        addListener(target, listener, ...args) {
          target.addListener(wrapperMap.get(listener), ...args);
        },

        hasListener(target, listener) {
          return target.hasListener(wrapperMap.get(listener));
        },

        removeListener(target, listener) {
          target.removeListener(wrapperMap.get(listener));
        }

      });

      const onRequestFinishedWrappers = new DefaultWeakMap(listener => {
        if (typeof listener !== "function") {
          return listener;
        }
        /**
         * Wraps an onRequestFinished listener function so that it will return a
         * `getContent()` property which returns a `Promise` rather than using a
         * callback API.
         *
         * @param {object} req
         *        The HAR entry object representing the network request.
         */


        return function onRequestFinished(req) {
          const wrappedReq = wrapObject(req, {}
          /* wrappers */
          , {
            getContent: {
              minArgs: 0,
              maxArgs: 0
            }
          });
          listener(wrappedReq);
        };
      });
      const onMessageWrappers = new DefaultWeakMap(listener => {
        if (typeof listener !== "function") {
          return listener;
        }
        /**
         * Wraps a message listener function so that it may send responses based on
         * its return value, rather than by returning a sentinel value and calling a
         * callback. If the listener function returns a Promise, the response is
         * sent when the promise either resolves or rejects.
         *
         * @param {*} message
         *        The message sent by the other end of the channel.
         * @param {object} sender
         *        Details about the sender of the message.
         * @param {function(*)} sendResponse
         *        A callback which, when called with an arbitrary argument, sends
         *        that value as a response.
         * @returns {boolean}
         *        True if the wrapped listener returned a Promise, which will later
         *        yield a response. False otherwise.
         */


        return function onMessage(message, sender, sendResponse) {
          let didCallSendResponse = false;
          let wrappedSendResponse;
          let sendResponsePromise = new Promise(resolve => {
            wrappedSendResponse = function (response) {
              didCallSendResponse = true;
              resolve(response);
            };
          });
          let result;

          try {
            result = listener(message, sender, wrappedSendResponse);
          } catch (err) {
            result = Promise.reject(err);
          }

          const isResultThenable = result !== true && isThenable(result); // If the listener didn't returned true or a Promise, or called
          // wrappedSendResponse synchronously, we can exit earlier
          // because there will be no response sent from this listener.

          if (result !== true && !isResultThenable && !didCallSendResponse) {
            return false;
          } // A small helper to send the message if the promise resolves
          // and an error if the promise rejects (a wrapped sendMessage has
          // to translate the message into a resolved promise or a rejected
          // promise).


          const sendPromisedResult = promise => {
            promise.then(msg => {
              // send the message value.
              sendResponse(msg);
            }, error => {
              // Send a JSON representation of the error if the rejected value
              // is an instance of error, or the object itself otherwise.
              let message;

              if (error && (error instanceof Error || typeof error.message === "string")) {
                message = error.message;
              } else {
                message = "An unexpected error occurred";
              }

              sendResponse({
                __mozWebExtensionPolyfillReject__: true,
                message
              });
            }).catch(err => {
              // Print an error on the console if unable to send the response.
              console.error("Failed to send onMessage rejected reply", err);
            });
          }; // If the listener returned a Promise, send the resolved value as a
          // result, otherwise wait the promise related to the wrappedSendResponse
          // callback to resolve and send it as a response.


          if (isResultThenable) {
            sendPromisedResult(result);
          } else {
            sendPromisedResult(sendResponsePromise);
          } // Let Chrome know that the listener is replying.


          return true;
        };
      });

      const wrappedSendMessageCallback = ({
        reject,
        resolve
      }, reply) => {
        if (extensionAPIs.runtime.lastError) {
          // Detect when none of the listeners replied to the sendMessage call and resolve
          // the promise to undefined as in Firefox.
          // See https://github.com/mozilla/webextension-polyfill/issues/130
          if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {
            resolve();
          } else {
            reject(new Error(extensionAPIs.runtime.lastError.message));
          }
        } else if (reply && reply.__mozWebExtensionPolyfillReject__) {
          // Convert back the JSON representation of the error into
          // an Error instance.
          reject(new Error(reply.message));
        } else {
          resolve(reply);
        }
      };

      const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {
        if (args.length < metadata.minArgs) {
          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);
        }

        if (args.length > metadata.maxArgs) {
          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);
        }

        return new Promise((resolve, reject) => {
          const wrappedCb = wrappedSendMessageCallback.bind(null, {
            resolve,
            reject
          });
          args.push(wrappedCb);
          apiNamespaceObj.sendMessage(...args);
        });
      };

      const staticWrappers = {
        devtools: {
          network: {
            onRequestFinished: wrapEvent(onRequestFinishedWrappers)
          }
        },
        runtime: {
          onMessage: wrapEvent(onMessageWrappers),
          onMessageExternal: wrapEvent(onMessageWrappers),
          sendMessage: wrappedSendMessage.bind(null, "sendMessage", {
            minArgs: 1,
            maxArgs: 3
          })
        },
        tabs: {
          sendMessage: wrappedSendMessage.bind(null, "sendMessage", {
            minArgs: 2,
            maxArgs: 3
          })
        }
      };
      const settingMetadata = {
        clear: {
          minArgs: 1,
          maxArgs: 1
        },
        get: {
          minArgs: 1,
          maxArgs: 1
        },
        set: {
          minArgs: 1,
          maxArgs: 1
        }
      };
      apiMetadata.privacy = {
        network: {
          "*": settingMetadata
        },
        services: {
          "*": settingMetadata
        },
        websites: {
          "*": settingMetadata
        }
      };
      return wrapObject(extensionAPIs, staticWrappers, apiMetadata);
    }; // The build process adds a UMD wrapper around this file, which makes the
    // `module` variable available.


    module.exports = wrapAPIs(chrome);
  } else {
    module.exports = globalThis.browser;
  }
});
//# sourceMappingURL=browser-polyfill.js.map


/***/ }),

/***/ "?6483":
/*!****************************!*\
  !*** agent-base (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?0825":
/*!********************!*\
  !*** fs (ignored) ***!
  \********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?72ad":
/*!***********************************!*\
  !*** https-proxy-agent (ignored) ***!
  \***********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?a1bf":
/*!*********************!*\
  !*** net (ignored) ***!
  \*********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?14d6":
/*!*********************!*\
  !*** tls (ignored) ***!
  \*********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?e42a":
/*!********************!*\
  !*** ws (ignored) ***!
  \********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?9463":
/*!********************!*\
  !*** fs (ignored) ***!
  \********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "./node_modules/tslib/tslib.es6.mjs":
/*!******************************************!*\
  !*** ./node_modules/tslib/tslib.es6.mjs ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "__addDisposableResource": () => (/* binding */ __addDisposableResource),
/* harmony export */   "__assign": () => (/* binding */ __assign),
/* harmony export */   "__asyncDelegator": () => (/* binding */ __asyncDelegator),
/* harmony export */   "__asyncGenerator": () => (/* binding */ __asyncGenerator),
/* harmony export */   "__asyncValues": () => (/* binding */ __asyncValues),
/* harmony export */   "__await": () => (/* binding */ __await),
/* harmony export */   "__awaiter": () => (/* binding */ __awaiter),
/* harmony export */   "__classPrivateFieldGet": () => (/* binding */ __classPrivateFieldGet),
/* harmony export */   "__classPrivateFieldIn": () => (/* binding */ __classPrivateFieldIn),
/* harmony export */   "__classPrivateFieldSet": () => (/* binding */ __classPrivateFieldSet),
/* harmony export */   "__createBinding": () => (/* binding */ __createBinding),
/* harmony export */   "__decorate": () => (/* binding */ __decorate),
/* harmony export */   "__disposeResources": () => (/* binding */ __disposeResources),
/* harmony export */   "__esDecorate": () => (/* binding */ __esDecorate),
/* harmony export */   "__exportStar": () => (/* binding */ __exportStar),
/* harmony export */   "__extends": () => (/* binding */ __extends),
/* harmony export */   "__generator": () => (/* binding */ __generator),
/* harmony export */   "__importDefault": () => (/* binding */ __importDefault),
/* harmony export */   "__importStar": () => (/* binding */ __importStar),
/* harmony export */   "__makeTemplateObject": () => (/* binding */ __makeTemplateObject),
/* harmony export */   "__metadata": () => (/* binding */ __metadata),
/* harmony export */   "__param": () => (/* binding */ __param),
/* harmony export */   "__propKey": () => (/* binding */ __propKey),
/* harmony export */   "__read": () => (/* binding */ __read),
/* harmony export */   "__rest": () => (/* binding */ __rest),
/* harmony export */   "__runInitializers": () => (/* binding */ __runInitializers),
/* harmony export */   "__setFunctionName": () => (/* binding */ __setFunctionName),
/* harmony export */   "__spread": () => (/* binding */ __spread),
/* harmony export */   "__spreadArray": () => (/* binding */ __spreadArray),
/* harmony export */   "__spreadArrays": () => (/* binding */ __spreadArrays),
/* harmony export */   "__values": () => (/* binding */ __values),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/* global Reflect, Promise, SuppressedError, Symbol */

var extendStatics = function(d, b) {
  extendStatics = Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
  return extendStatics(d, b);
};

function __extends(d, b) {
  if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
  extendStatics(d, b);
  function __() { this.constructor = d; }
  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
  __assign = Object.assign || function __assign(t) {
      for (var s, i = 1, n = arguments.length; i < n; i++) {
          s = arguments[i];
          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
      }
      return t;
  }
  return __assign.apply(this, arguments);
}

function __rest(s, e) {
  var t = {};
  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
      t[p] = s[p];
  if (s != null && typeof Object.getOwnPropertySymbols === "function")
      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
              t[p[i]] = s[p[i]];
      }
  return t;
}

function __decorate(decorators, target, key, desc) {
  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
  return function (target, key) { decorator(target, key, paramIndex); }
}

function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {
  function accept(f) { if (f !== void 0 && typeof f !== "function") throw new TypeError("Function expected"); return f; }
  var kind = contextIn.kind, key = kind === "getter" ? "get" : kind === "setter" ? "set" : "value";
  var target = !descriptorIn && ctor ? contextIn["static"] ? ctor : ctor.prototype : null;
  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});
  var _, done = false;
  for (var i = decorators.length - 1; i >= 0; i--) {
      var context = {};
      for (var p in contextIn) context[p] = p === "access" ? {} : contextIn[p];
      for (var p in contextIn.access) context.access[p] = contextIn.access[p];
      context.addInitializer = function (f) { if (done) throw new TypeError("Cannot add initializers after decoration has completed"); extraInitializers.push(accept(f || null)); };
      var result = (0, decorators[i])(kind === "accessor" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);
      if (kind === "accessor") {
          if (result === void 0) continue;
          if (result === null || typeof result !== "object") throw new TypeError("Object expected");
          if (_ = accept(result.get)) descriptor.get = _;
          if (_ = accept(result.set)) descriptor.set = _;
          if (_ = accept(result.init)) initializers.unshift(_);
      }
      else if (_ = accept(result)) {
          if (kind === "field") initializers.unshift(_);
          else descriptor[key] = _;
      }
  }
  if (target) Object.defineProperty(target, contextIn.name, descriptor);
  done = true;
};

function __runInitializers(thisArg, initializers, value) {
  var useValue = arguments.length > 2;
  for (var i = 0; i < initializers.length; i++) {
      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);
  }
  return useValue ? value : void 0;
};

function __propKey(x) {
  return typeof x === "symbol" ? x : "".concat(x);
};

function __setFunctionName(f, name, prefix) {
  if (typeof name === "symbol") name = name.description ? "[".concat(name.description, "]") : "";
  return Object.defineProperty(f, "name", { configurable: true, value: prefix ? "".concat(prefix, " ", name) : name });
};

function __metadata(metadataKey, metadataValue) {
  if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
  return new (P || (P = Promise))(function (resolve, reject) {
      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
      function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
      step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
}

function __generator(thisArg, body) {
  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
  return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
  function verb(n) { return function (v) { return step([n, v]); }; }
  function step(op) {
      if (f) throw new TypeError("Generator is already executing.");
      while (g && (g = 0, op[0] && (_ = 0)), _) try {
          if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
          if (y = 0, t) op = [op[0] & 2, t.value];
          switch (op[0]) {
              case 0: case 1: t = op; break;
              case 4: _.label++; return { value: op[1], done: false };
              case 5: _.label++; y = op[1]; op = [0]; continue;
              case 7: op = _.ops.pop(); _.trys.pop(); continue;
              default:
                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                  if (t[2]) _.ops.pop();
                  _.trys.pop(); continue;
          }
          op = body.call(thisArg, _);
      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
  }
}

var __createBinding = Object.create ? (function(o, m, k, k2) {
  if (k2 === undefined) k2 = k;
  var desc = Object.getOwnPropertyDescriptor(m, k);
  if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
  }
  Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
  if (k2 === undefined) k2 = k;
  o[k2] = m[k];
});

function __exportStar(m, o) {
  for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);
}

function __values(o) {
  var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
  if (m) return m.call(o);
  if (o && typeof o.length === "number") return {
      next: function () {
          if (o && i >= o.length) o = void 0;
          return { value: o && o[i++], done: !o };
      }
  };
  throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
}

function __read(o, n) {
  var m = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m) return o;
  var i = m.call(o), r, ar = [], e;
  try {
      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
  }
  catch (error) { e = { error: error }; }
  finally {
      try {
          if (r && !r.done && (m = i["return"])) m.call(i);
      }
      finally { if (e) throw e.error; }
  }
  return ar;
}

/** @deprecated */
function __spread() {
  for (var ar = [], i = 0; i < arguments.length; i++)
      ar = ar.concat(__read(arguments[i]));
  return ar;
}

/** @deprecated */
function __spreadArrays() {
  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
  for (var r = Array(s), k = 0, i = 0; i < il; i++)
      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
          r[k] = a[j];
  return r;
}

function __spreadArray(to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
      if (ar || !(i in from)) {
          if (!ar) ar = Array.prototype.slice.call(from, 0, i);
          ar[i] = from[i];
      }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
}

function __await(v) {
  return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var g = generator.apply(thisArg, _arguments || []), i, q = [];
  return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
  function fulfill(value) { resume("next", value); }
  function reject(value) { resume("throw", value); }
  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
  var i, p;
  return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var m = o[Symbol.asyncIterator], i;
  return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
  if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
  return cooked;
};

var __setModuleDefault = Object.create ? (function(o, v) {
  Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
  o["default"] = v;
};

function __importStar(mod) {
  if (mod && mod.__esModule) return mod;
  var result = {};
  if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
  __setModuleDefault(result, mod);
  return result;
}

function __importDefault(mod) {
  return (mod && mod.__esModule) ? mod : { default: mod };
}

function __classPrivateFieldGet(receiver, state, kind, f) {
  if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
}

function __classPrivateFieldSet(receiver, state, value, kind, f) {
  if (kind === "m") throw new TypeError("Private method is not writable");
  if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
}

function __classPrivateFieldIn(state, receiver) {
  if (receiver === null || (typeof receiver !== "object" && typeof receiver !== "function")) throw new TypeError("Cannot use 'in' operator on non-object");
  return typeof state === "function" ? receiver === state : state.has(receiver);
}

function __addDisposableResource(env, value, async) {
  if (value !== null && value !== void 0) {
    if (typeof value !== "object") throw new TypeError("Object expected.");
    var dispose;
    if (async) {
        if (!Symbol.asyncDispose) throw new TypeError("Symbol.asyncDispose is not defined.");
        dispose = value[Symbol.asyncDispose];
    }
    if (dispose === void 0) {
        if (!Symbol.dispose) throw new TypeError("Symbol.dispose is not defined.");
        dispose = value[Symbol.dispose];
    }
    if (typeof dispose !== "function") throw new TypeError("Object not disposable.");
    env.stack.push({ value: value, dispose: dispose, async: async });
  }
  else if (async) {
    env.stack.push({ async: true });
  }
  return value;
}

var _SuppressedError = typeof SuppressedError === "function" ? SuppressedError : function (error, suppressed, message) {
  var e = new Error(message);
  return e.name = "SuppressedError", e.error = error, e.suppressed = suppressed, e;
};

function __disposeResources(env) {
  function fail(e) {
    env.error = env.hasError ? new _SuppressedError(e, env.error, "An error was suppressed during disposal.") : e;
    env.hasError = true;
  }
  function next() {
    while (env.stack.length) {
      var rec = env.stack.pop();
      try {
        var result = rec.dispose && rec.dispose.call(rec.value);
        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });
      }
      catch (e) {
          fail(e);
      }
    }
    if (env.hasError) throw env.error;
  }
  return next();
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  __extends,
  __assign,
  __rest,
  __decorate,
  __param,
  __metadata,
  __awaiter,
  __generator,
  __createBinding,
  __exportStar,
  __values,
  __read,
  __spread,
  __spreadArrays,
  __spreadArray,
  __await,
  __asyncGenerator,
  __asyncDelegator,
  __asyncValues,
  __makeTemplateObject,
  __importStar,
  __importDefault,
  __classPrivateFieldGet,
  __classPrivateFieldSet,
  __classPrivateFieldIn,
  __addDisposableResource,
  __disposeResources,
});


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/background.ts");
/******/ 	
/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7OztBQzlCQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwSEE7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLElBQUk7QUFDakQsNEZBQTRGLE9BQU87QUFDbkc7QUFDQTtBQUNBLHlFQUF5RSxTQUFTO0FBQ2xGLHdFQUF3RSxTQUFTO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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LENBQUMsOENBQThDOztBQUUvQzs7Ozs7Ozs7Ozs7Ozs7OztBQ3JDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMxQkE7QUFDQTtBQUMrQztBQUN4QztBQUNQO0FBQ0E7QUFDQSx3REFBd0QsdURBQWlCO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7O0FDbENBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7OztBQ0pBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7O0FDZEE7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3QkE7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdkJBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsb0NBQW9DO0FBQzlCO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQzREO0FBQ2tCO0FBQ0s7QUFDbkI7QUFDa0o7QUFDaEU7O0FBRWxKOzs7Ozs7Ozs7Ozs7Ozs7O0FDVEE7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzRUE7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsbUJBQW1CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQkFBMEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsMEJBQTBCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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TztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLG9DQUFvQzs7QUFFckM7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDeklBO0FBQ0E7QUFDQTtBQUNBO0FBQzZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ08sK0JBQStCLHNEQUFnQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGlFQUF5QjtBQUNyQyxZQUFZLGlFQUF5QjtBQUNyQyxZQUFZLHlFQUFpQyxpREFBaUQsSUFBSTtBQUNsRyxZQUFZLHdFQUFnQztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGdHQUE0QztBQUM5RCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtEQUFXO0FBQzlCO0FBQ0E7QUFDQSxRQUFRLHlFQUFpQztBQUN6QyxRQUFRLHlFQUFpQztBQUN6QztBQUNBLHFCQUFxQixpR0FBNkM7QUFDbEU7QUFDQTtBQUNBLGtCQUFrQix5R0FBcUQ7QUFDdkU7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQVEseUVBQWlDO0FBQ3pDLFFBQVEseUVBQWlDO0FBQ3pDO0FBQ0EscUJBQXFCLDhGQUEwQztBQUMvRDtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IseUdBQXFEO0FBQ3ZFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxRQUFRLHlFQUFpQztBQUN6QyxRQUFRLHlFQUFpQztBQUN6QztBQUNBLHFCQUFxQixtR0FBK0M7QUFDcEU7QUFDQTtBQUNBLGtCQUFrQix5R0FBcUQ7QUFDdkU7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQVEseUVBQWlDO0FBQ3pDLFFBQVEseUVBQWlDO0FBQ3pDO0FBQ0EscUJBQXFCLHVHQUFtRDtBQUN4RTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IseUdBQXFEO0FBQ3ZFLFNBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBUSx5RUFBaUM7QUFDekMsUUFBUSx5RUFBaUM7QUFDekM7QUFDQSxxQkFBcUIsOEdBQTBEO0FBQy9FO0FBQ0E7QUFDQSxrQkFBa0IseUdBQXFEO0FBQ3ZFO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxRQUFRLHlFQUFpQztBQUN6QyxRQUFRLHlFQUFpQztBQUN6QyxRQUFRLHlFQUFpQztBQUN6QztBQUNBLHFCQUFxQixxR0FBaUQ7QUFDdEU7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHlHQUFxRDtBQUN2RTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsUUFBUSx5RUFBaUM7QUFDekMsUUFBUSx5RUFBaUM7QUFDekMsUUFBUSx5RUFBaUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IscUdBQWlEO0FBQ25FLFNBQVM7QUFDVDtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7O0FDcC9CQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoQ0E7QUFDQTtBQUNBO0FBQzhDO0FBQ3ZDLDhDQUE4QyxzREFBZ0I7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ2ZBO0FBQ0E7QUFDQTtBQUM4QztBQUN2Qyx1REFBdUQsc0RBQWdCO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2xCQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ29FO0FBQ0g7QUFDeEI7QUFDK0I7QUFDakU7QUFDUDtBQUNBO0FBQ0E7QUFDQSxlQUFlLGFBQWE7QUFDNUI7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHdEQUFrQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBLFFBQVEsaUVBQXlCO0FBQ2pDLDJDQUEyQyxxRkFBK0M7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLG9CQUFvQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLCtEQUF5QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0EsMkNBQTJDLGlGQUEyQztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBLFFBQVEseUVBQWlDO0FBQ3pDLG9DQUFvQyxpRkFBMkM7QUFDL0U7QUFDQTtBQUNBLGVBQWUsY0FBYztBQUM3QjtBQUNBO0FBQ0E7QUFDQSxRQUFRLHdFQUFnQztBQUN4QztBQUNBO0FBQ0Esa0NBQWtDLHlFQUFxQjtBQUN2RCxRQUFRLHdFQUFnQztBQUN4QztBQUNBLFFBQVEsMEVBQXlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSwwRUFBeUIsdURBQXVELFNBQVM7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQXlCO0FBQ2pDLFFBQVEsMEVBQXlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ25LQTtBQUNBO0FBQ0E7QUFDeUU7QUFDbEUsdURBQXVELGlGQUF5QjtBQUN2Rjs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNQQTtBQUNBO0FBQ0E7QUFDa0Q7QUFDM0MsK0NBQStDLDBEQUFvQjtBQUMxRTtBQUNBO0FBQ0E7QUFDQSxlQUFlLCtCQUErQjtBQUM5QyxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLCtCQUErQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3pCQTtBQUNBO0FBQ0E7QUFDK0U7QUFDeEUsNENBQTRDLHVGQUE0QjtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN4QkE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDMkc7QUFDeUI7QUFDbkU7QUFDeEI7QUFDb0s7QUFDM0o7QUFDdUM7QUFDbEY7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0NBQWtDO0FBQ25DO0FBQ0EsZ0RBQWdELDJEQUFxQjtBQUNyRTtBQUNBLDZDQUE2Qyx5SUFBdUM7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3Qyw4RUFBd0MsQ0FBQyw4REFBd0IsU0FBUyx3RUFBa0M7QUFDcEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxxQ0FBcUMsd0RBQWtCO0FBQzlEO0FBQ0E7QUFDQSwwQkFBMEIsMkZBQXVDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHdEQUFrQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsaUZBQTZCLEtBQUs7QUFDL0c7QUFDQSx3Q0FBd0MsaUZBQTZCO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHdFQUFnQyxxREFBcUQsSUFBSTtBQUN6RyxnQkFBZ0IseUVBQWlDLGlEQUFpRCxJQUFJO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsb0dBQWdEO0FBQzNFO0FBQ0E7QUFDQSxtREFBbUQsK0VBQXdDO0FBQzNGLDhEQUE4RCw2REFBc0I7QUFDcEY7QUFDQSw2REFBNkQsaURBQVUsQ0FBQyxzRkFBK0M7QUFDdkgsNkRBQTZELGlEQUFVLENBQUMsNkVBQXNDO0FBQzlHO0FBQ0Esb0JBQW9CLDhFQUF1QztBQUMzRCxvQkFBb0IsNkVBQXNDO0FBQzFELG9CQUFvQixrRkFBMkM7QUFDL0Qsb0JBQW9CLHVGQUFnRDtBQUNwRSxvQkFBb0IsdUZBQWdEO0FBQ3BFLG9CQUFvQixtRkFBNEM7QUFDaEUsb0JBQW9CLHVGQUFnRDtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsaURBQVU7QUFDaEY7QUFDQTtBQUNBO0FBQ0EscUZBQXFGLGlGQUE2QixLQUFLO0FBQ3ZIO0FBQ0EsdUdBQXVHLCtFQUF3QztBQUMvSTtBQUNBO0FBQ0EsNENBQTRDLDREQUFnQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGdCQUFnQix3RUFBZ0MscURBQXFELElBQUk7QUFDekcsZ0JBQWdCLHlFQUFpQyxpREFBaUQsSUFBSTtBQUN0RztBQUNBLGdEQUFnRCw2RUFBc0M7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3RUFBZ0M7QUFDaEQsZ0JBQWdCLHdFQUFnQztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRixJQUFJO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMkVBQXlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0VBQWdDO0FBQzVDLFlBQVkseUVBQWlDLGdEQUFnRCxJQUFJO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMkVBQXlCO0FBQ2pDO0FBQ0EsZ0JBQWdCLHdFQUFnQztBQUNoRCxnQkFBZ0Isd0VBQWdDO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3RUFBZ0M7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMkVBQXlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDJFQUF5QjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsNkVBQXNDO0FBQ2pGO0FBQ0E7QUFDQSxpRUFBaUUsaURBQVUsQ0FBQyw2RUFBc0M7QUFDbEg7QUFDQSxpRUFBaUUsaURBQVUsQ0FBQyw2RUFBc0M7QUFDbEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1WUE7QUFDQTtBQUNBO0FBQ0E7QUFDZ0Q7QUFDekM7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLHdEQUFrQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7O0FDekRBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw0REFBNEQ7O0FBRTdEOzs7Ozs7Ozs7Ozs7Ozs7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxvQkFBb0I7QUFDbkMsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsOEJBQThCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDhCQUE4QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsb0JBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3hFQTtBQUNBO0FBQ2lEO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ08sOENBQThDLDBEQUFvQjtBQUN6RTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDhCQUE4QjtBQUM3QyxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDhCQUE4QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQy9CQTtBQUNBO0FBQ29EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ08sMkNBQTJDLDZEQUF1QjtBQUN6RTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGNBQWM7QUFDN0IsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsY0FBYztBQUM3QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxvQkFBb0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsY0FBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3Q0E7QUFDQTtBQUNBLGlCQUFpQixTQUFJLElBQUksU0FBSTtBQUM3Qiw0QkFBNEIsK0RBQStELGlCQUFpQjtBQUM1RztBQUNBLG9DQUFvQyxNQUFNLCtCQUErQixZQUFZO0FBQ3JGLG1DQUFtQyxNQUFNLG1DQUFtQyxZQUFZO0FBQ3hGLGdDQUFnQztBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUN5STtBQUMzRTtBQUNwQjtBQUNGO0FBQ1c7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDTyxvQ0FBb0MsZ0RBQVU7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5QkFBeUI7QUFDeEMsZUFBZSxhQUFhO0FBQzVCLGVBQWUsb0JBQW9CO0FBQ25DO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkRBQXFCO0FBQzdCLDJFQUEyRSxnRkFBNEI7QUFDdkc7QUFDQSx3Q0FBd0MseUZBQW1EO0FBQzNGLFlBQVkseUVBQWlDLDZCQUE2Qix5RkFBbUQsR0FBRyxnREFBVSxDQUFDLHlGQUFtRDtBQUM5TDtBQUNBLFFBQVEseUVBQWlDLDZCQUE2QiwrRkFBeUQsR0FBRyxnREFBVSxDQUFDLCtGQUF5RDtBQUN0TSxRQUFRLHlFQUFpQyw2QkFBNkIscUZBQStDLEdBQUcsZ0RBQVUsQ0FBQyxxRkFBK0M7QUFDbEw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHlCQUF5QjtBQUN4QyxlQUFlLGdDQUFnQztBQUMvQyxlQUFlLGFBQWE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQSxRQUFRLGlFQUF5QjtBQUNqQywyQ0FBMkMscUZBQStDO0FBQzFGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFVBQVU7QUFDM0I7QUFDQTtBQUNBLFFBQVEsaUVBQXlCO0FBQ2pDLDJDQUEyQywrRkFBeUQ7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBLFFBQVEsaUVBQXlCO0FBQ2pDLDJDQUEyQyx5RkFBbUQ7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLG9CQUFvQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0EsMkNBQTJDLGlGQUEyQztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBLG9DQUFvQyxpRkFBMkM7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQXlCO0FBQ2pDLFFBQVEsMEVBQXlCLDZCQUE2QixnRkFBNEI7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsMEVBQXlCLDBDQUEwQyxnRkFBNEI7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLDBFQUF5QjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsd0VBQWdDO0FBQ3hDLHdDQUF3QywrRkFBeUQ7QUFDakcsMERBQTBELCtGQUF5RDtBQUNuSDtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsK0ZBQXlEO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSx3RUFBZ0M7QUFDeEM7QUFDQSx3Q0FBd0MsK0ZBQXlEO0FBQ2pHLG9EQUFvRCwrRkFBeUQ7QUFDN0c7QUFDQTtBQUNBLDRDQUE0QywrRkFBeUQ7QUFDckc7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLCtGQUF5RDtBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBeUI7QUFDakMsUUFBUSwwRUFBeUI7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsbUJBQW1CLG9FQUFnQjtBQUNuQztBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsZ0ZBQTRCO0FBQy9DO0FBQ0E7QUFDQSxxQkFBcUIsa0VBQXlCO0FBQzlDO0FBQ0EsOEVBQThFLGVBQWU7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3JRQTtBQUNBO0FBQzZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ08sNENBQTRDLHNEQUFnQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRCQUE0QjtBQUMzQyxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsNEJBQTRCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGVBQWUsY0FBYztBQUM3QixlQUFlLGFBQWE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsYUFBYTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsY0FBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7OztBQ3hDQTtBQUNBO0FBQytDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsMkJBQTJCLHdEQUFrQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDakRBO0FBQ0E7QUFDK0Y7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0EsOEJBQThCLGdIQUFrQztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsS0FBSztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsS0FBSztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxvREFBb0Q7QUFDOUM7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnREFBZ0Q7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxrQkFBa0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsa0JBQWtCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQUksSUFBSSxTQUFJO0FBQzdCLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ21IO0FBQ2pFO0FBQ1Y7QUFDNkU7QUFDckg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLGlDQUFpQyxnREFBVTtBQUNsRDtBQUNBO0FBQ0E7QUFDQSxlQUFlLGNBQWM7QUFDN0I7QUFDQTtBQUNBLFFBQVEsd0VBQWdDO0FBQ3hDO0FBQ0EsUUFBUSw2REFBcUI7QUFDN0IsY0FBYywyRUFBMkIsQ0FBQyx1RUFBaUMsc0NBQXNDLGlGQUE2QjtBQUM5STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsb0JBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQSwyQ0FBMkMsaUZBQTJDO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0EsUUFBUSx5RUFBaUM7QUFDekMsb0NBQW9DLGlGQUEyQztBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsa0JBQWtCO0FBQ2pDLGVBQWUsUUFBUTtBQUN2QixnQkFBZ0IsdUJBQXVCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtEQUFZO0FBQ25DLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsY0FBYztBQUM3QixnQkFBZ0IsdUNBQXVDO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxrQkFBa0I7QUFDakMsZ0JBQWdCLHlDQUF5QztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLFFBQVEsa0NBQWtDO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtCQUFrQjtBQUNqQyxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGNBQWM7QUFDN0IsZUFBZSxhQUFhO0FBQzVCLGdCQUFnQix1Q0FBdUM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdFQUFnQztBQUM1QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGNBQWM7QUFDN0IsZ0JBQWdCLDZCQUE2QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsY0FBYztBQUM3QixnQkFBZ0IsNkJBQTZCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDBFQUFzQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLG1CQUFtQixvRUFBZ0I7QUFDbkM7QUFDQTtBQUNBLDZCQUE2Qix3REFBa0IsNkJBQTZCLDREQUFxQjtBQUNqRztBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDek5BO0FBQ0E7QUFDQTtBQUM2RTtBQUNvRDtBQUNqSTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLGtDQUFrQyx3REFBa0I7QUFDcEQsZ0NBQWdDLDJEQUFxQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0Msd0VBQWtDO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMscUZBQWlDLEVBQUUsMkRBQXFCLENBQUMsd0VBQWtDO0FBQ3ZJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3RUFBa0M7QUFDbEQsZ0JBQWdCLHVFQUFpQyxHQUFHLDJEQUFxQjtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3RUFBa0M7QUFDbEQsZ0JBQWdCLHVFQUFpQyxHQUFHLDJEQUFxQjtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sd0RBQXdELDZEQUF1QjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSw4QkFBOEI7QUFDN0MsaUJBQWlCLDJDQUEyQztBQUM1RDtBQUNBO0FBQ0EsdUJBQXVCLDhEQUF3QjtBQUMvQyx3QkFBd0IsbUVBQTZCO0FBQ3JEO0FBQ0Esd0JBQXdCLDJEQUFxQiwrQkFBK0IscUZBQWlDLEVBQUUsMkRBQXFCLENBQUMsbUVBQTZCLEtBQUs7QUFDdks7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZIQTtBQUNBO0FBQ3dDO0FBQ087QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDTyx1Q0FBdUMsd0RBQWtCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLFFBQVEsd0VBQWdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDMUJBO0FBQ0E7QUFDQTtBQUM2RTtBQUNyQztBQUN5RjtBQUNqSTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLGtDQUFrQyx3REFBa0I7QUFDcEQsdUJBQXVCLDJEQUFxQjtBQUM1QyxZQUFZLHdFQUFnQztBQUM1QztBQUNBLDRDQUE0QyxxRkFBaUMsRUFBRSwyREFBcUIsQ0FBQyx3RUFBa0M7QUFDdkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sOENBQThDLDZEQUF1QjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQkFBb0I7QUFDbkMsaUJBQWlCLGlDQUFpQztBQUNsRDtBQUNBO0FBQ0EsdUJBQXVCLDhEQUF3QjtBQUMvQyx3QkFBd0IsbUVBQTZCO0FBQ3JEO0FBQ0Esd0JBQXdCLDJEQUFxQiwrQkFBK0IscUZBQWlDLEVBQUUsMkRBQXFCLENBQUMsbUVBQTZCLEtBQUs7QUFDdks7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUN2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNENBQTRDOztBQUU3Qzs7Ozs7Ozs7Ozs7O0FDekJhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGNBQWM7QUFDZCxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3BDYTtBQUNiO0FBQ0EsNEJBQTRCLCtEQUErRCxpQkFBaUI7QUFDNUc7QUFDQSxvQ0FBb0MsTUFBTSwrQkFBK0IsWUFBWTtBQUNyRixtQ0FBbUMsTUFBTSxtQ0FBbUMsWUFBWTtBQUN4RixnQ0FBZ0M7QUFDaEM7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLDZDQUE2QztBQUM3QztBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxtQkFBbUI7QUFDbkIsZ0RBQWdELG1CQUFPLENBQUMsNEZBQXVCO0FBQy9FLGlCQUFpQixtQkFBTyxDQUFDLHlDQUFVO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQSxtQkFBbUI7Ozs7Ozs7Ozs7OztBQ2hDTjtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQ0FBb0M7QUFDbkQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMENBQTBDLDRCQUE0QjtBQUN0RSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsZ0RBQWdELG1CQUFPLENBQUMsNEZBQXVCO0FBQy9FLCtCQUErQixtQkFBTyxDQUFDLGtHQUE4QjtBQUNyRSw2QkFBNkIsbUJBQU8sQ0FBQywyRUFBb0I7QUFDekQsZUFBZSxtQkFBTyxDQUFDLDZCQUFRO0FBQy9CLHNCQUFzQixtQkFBTyxDQUFDLHVFQUFhO0FBQzNDLGVBQWUsbUJBQU8sQ0FBQyw2Q0FBZ0I7QUFDdkMsZUFBZSxtQkFBTyxDQUFDLDZCQUFRO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtDQUF5QjtBQUM1QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxrSUFBa0k7QUFDeks7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsdUNBQXVDLHlEQUF5RDtBQUNoRztBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MseUdBQXlHO0FBQ3hKO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELHNKQUFzSjtBQUNqTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGNBQWM7QUFDdEQsMkNBQTJDLGlDQUFpQztBQUM1RTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsdURBQXVEO0FBQzlHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyw2R0FBNkc7QUFDeEo7QUFDQSwwQ0FBMEMsMkdBQTJHO0FBQ3JKLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msc0RBQXNEO0FBQ3hGLDZDQUE2Qyw2Q0FBNEI7QUFDekU7QUFDQSxzQ0FBc0Msc0RBQXNEO0FBQzVGLG9DQUFvQyxrREFBa0Q7QUFDdEYsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDZDQUE0QjtBQUNuRCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDRDQUE0QyxnRUFBZ0U7QUFDNUc7QUFDQTtBQUNBLDhDQUE4QyxPQUFPO0FBQ3JEO0FBQ0EsZ0NBQWdDLGdGQUFnRjtBQUNoSCxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGdDQUFnQywwREFBMEQ7QUFDMUYsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsT0FBTztBQUMvQyx1Q0FBdUM7QUFDdkM7QUFDQSxnQkFBZ0IsTUFBTTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsWUFBWTtBQUN4RCwyQ0FBMkM7QUFDM0MsOEJBQThCLE1BQU07QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLCtCQUErQjtBQUN0RztBQUNBO0FBQ0Esb0RBQW9ELDZDQUE2Qyx1R0FBdUc7QUFDeE07QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELDZDQUE2QywySEFBMkgsdUJBQXVCO0FBQ25QO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQyxpQ0FBaUM7QUFDakM7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0Esb0NBQW9DLHlEQUF5RDtBQUM3RixhQUFhO0FBQ2IsU0FBUztBQUNULDJEQUEyRCwyQkFBMkI7QUFDdEYsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLE9BQU87QUFDckQ7QUFDQSxnQ0FBZ0Msa0ZBQWtGO0FBQ2xILFNBQVM7QUFDVDtBQUNBO0FBQ0EsZ0NBQWdDLDREQUE0RDtBQUM1RixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsbUNBQW1DO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0RUFBNEUsa0RBQWtEO0FBQzlIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsWUFBWTtBQUN6QztBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLGtCQUFrQjtBQUNsQixtREFBbUQsc0JBQXNCO0FBQ3pFLGtCQUFrQjtBQUNsQixnQkFBZ0I7QUFDaEI7QUFDQSxLQUFLO0FBQ0w7Ozs7Ozs7Ozs7OztBQzljYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxvQ0FBb0M7QUFDbkQ7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMENBQTBDLDRCQUE0QjtBQUN0RSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwrREFBK0QsaUJBQWlCO0FBQzVHO0FBQ0Esb0NBQW9DLE1BQU0sK0JBQStCLFlBQVk7QUFDckYsbUNBQW1DLE1BQU0sbUNBQW1DLFlBQVk7QUFDeEYsZ0NBQWdDO0FBQ2hDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsaUJBQWlCLEdBQUcsa0JBQWtCLEdBQUcsd0JBQXdCLEdBQUcsMEJBQTBCLEdBQUcsNEJBQTRCLEdBQUcsa0JBQWtCO0FBQ2xKLGdEQUFnRCxtQkFBTyxDQUFDLDRGQUF1QjtBQUMvRSxzQkFBc0IsbUJBQU8sQ0FBQyx1RUFBYTtBQUMzQyx5QkFBeUIsbUJBQU8sQ0FBQyw4SkFBd0M7QUFDekUsZUFBZSxtQkFBTyxDQUFDLGdFQUFNO0FBQzdCO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyx3REFBd0Q7QUFDM0YsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1QscUJBQXFCLCtHQUErRztBQUNwSSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLHNCQUFzQixvQ0FBb0M7QUFDMUQsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0EsMkRBQTJELGtDQUE2QixFQUFFLFFBQW1DO0FBQzdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxrQkFBa0I7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLGlCQUFpQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyS29COztBQUVyQztBQUNBO0FBQ0Esb0JBQW9CLHNCQUFzQjtBQUMxQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsY0FBYyx1QkFBdUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQixvQ0FBb0MsK0JBQStCO0FBQ3pGLEdBQUcsSUFBSTtBQUNQO0FBQ0E7QUFDQSxxRUFBcUUsYUFBYTtBQUNsRjtBQUNBOztBQUVBO0FBQ0E7QUFDQSx3RUFBd0UsZUFBZTtBQUN2RjtBQUNBOztBQUVBOztBQUVBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUNBQXlDLG1EQUFLO0FBQzlDO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHNCQUFzQjtBQUN0QjtBQUNBLDBCQUEwQjtBQUMxQixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0EsU0FBUztBQUNUO0FBQ0EsVUFBVSxJQUFJO0FBQ2Q7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHlDQUF5QztBQUN6QztBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHlDQUF5QztBQUN6QztBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHlDQUF5QztBQUN6QztBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSCxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNEJBQTRCOztBQUU3Qjs7QUFFQTtBQUNBO0FB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QUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsR0FBRztBQUNwQixtQkFBbUIsU0FBUztBQUM1Qjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQjtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsa0JBQWtCLEVBQUUsc0NBQXNDLE1BQU0sS0FBSyxVQUFVLFlBQVk7QUFDNUk7O0FBRUE7QUFDQSxnREFBZ0Qsa0JBQWtCLEVBQUUsc0NBQXNDLE1BQU0sS0FBSyxVQUFVLFlBQVk7QUFDM0k7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGdCQUFnQjtBQUNoQixnQ0FBZ0MsTUFBTTtBQUN0Qyx1Q0FBdUM7QUFDdkM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0EsaUJBQWlCLFVBQVU7QUFDM0I7QUFDQTtBQUNBLGlCQUFpQixVQUFVO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0EsaUJBQWlCLFFBQVEsY0FBYztBQUN2QztBQUNBO0FBQ0E7QUFDQSw2REFBNkQsZ0JBQWdCO0FBQzdFO0FBQ0EsaUJBQWlCLFFBQVEsY0FBYztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsbUJBQW1CO0FBQ25COztBQUVBLCtDQUErQyxlQUFlO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVzs7QUFFWDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7O0FBRUEsZUFBZTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7O0FBRUE7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQSxXQUFXOztBQUVYO0FBQ0E7QUFDQTs7QUFFQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixvQ0FBb0M7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7OztBQUdBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFFBQVE7QUFDM0I7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLEdBQUc7QUFDdEI7QUFDQSxtQkFBbUIsUUFBUTtBQUMzQjtBQUNBLG1CQUFtQixhQUFhO0FBQ2hDO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTs7QUFFQSwwRUFBMEU7QUFDMUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2YsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsYUFBYTtBQUNiO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQSxZQUFZOzs7QUFHWjtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0NBQStDLGtCQUFrQixFQUFFLHNDQUFzQyxNQUFNLEtBQUssVUFBVSxZQUFZO0FBQzFJOztBQUVBO0FBQ0EsOENBQThDLGtCQUFrQixFQUFFLHNDQUFzQyxNQUFNLEtBQUssVUFBVSxZQUFZO0FBQ3pJOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7OztBQUdBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7Ozs7O0FDcHZDQTs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7OztBQ0FBOzs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0FBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVMsZ0JBQWdCLHNDQUFzQyxrQkFBa0I7QUFDakYsd0JBQXdCO0FBQ3hCO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTs7QUFFTztBQUNQO0FBQ0EsK0NBQStDLE9BQU87QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxjQUFjO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTs7QUFFTztBQUNQLGtDQUFrQztBQUNsQzs7QUFFTztBQUNQLHVCQUF1Qix1RkFBdUY7QUFDOUc7QUFDQTtBQUNBLHlHQUF5RztBQUN6RztBQUNBLHNDQUFzQyxRQUFRO0FBQzlDO0FBQ0EsZ0VBQWdFO0FBQ2hFO0FBQ0EsOENBQThDLHlGQUF5RjtBQUN2SSw4REFBOEQsMkNBQTJDO0FBQ3pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQO0FBQ0Esa0JBQWtCLHlCQUF5QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQO0FBQ0E7O0FBRU87QUFDUDtBQUNBLDRDQUE0Qyx5RUFBeUU7QUFDckg7O0FBRU87QUFDUDtBQUNBOztBQUVPO0FBQ1AsMEJBQTBCLCtEQUErRCxpQkFBaUI7QUFDMUc7QUFDQSxrQ0FBa0MsTUFBTSwrQkFBK0IsWUFBWTtBQUNuRixpQ0FBaUMsTUFBTSxtQ0FBbUMsWUFBWTtBQUN0Riw4QkFBOEI7QUFDOUI7QUFDQSxHQUFHO0FBQ0g7O0FBRU87QUFDUCxZQUFZLDZCQUE2QiwwQkFBMEIsY0FBYyxxQkFBcUI7QUFDdEcsZUFBZSxvREFBb0QscUVBQXFFLGNBQWM7QUFDdEoscUJBQXFCLHNCQUFzQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEMsaUNBQWlDLFNBQVM7QUFDMUMsaUNBQWlDLFdBQVcsVUFBVTtBQUN0RCx3Q0FBd0MsY0FBYztBQUN0RDtBQUNBLDRHQUE0RyxPQUFPO0FBQ25ILCtFQUErRSxpQkFBaUI7QUFDaEcsdURBQXVELGdCQUFnQixRQUFRO0FBQy9FLDZDQUE2QyxnQkFBZ0IsZ0JBQWdCO0FBQzdFO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQSxRQUFRLFlBQVksYUFBYSxTQUFTLFVBQVU7QUFDcEQsa0NBQWtDLFNBQVM7QUFDM0M7QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGVBQWUsb0NBQW9DO0FBQ25EO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7O0FBRU07QUFDUDtBQUNBOztBQUVPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixNQUFNO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNPO0FBQ1AsMkJBQTJCLHNCQUFzQjtBQUNqRDtBQUNBO0FBQ0E7O0FBRUE7QUFDTztBQUNQLGdEQUFnRCxRQUFRO0FBQ3hELHVDQUF1QyxRQUFRO0FBQy9DLHVEQUF1RCxRQUFRO0FBQy9EO0FBQ0E7QUFDQTs7QUFFTztBQUNQLDJFQUEyRSxPQUFPO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQSxlQUFlLHVGQUF1RixjQUFjO0FBQ3BILHFCQUFxQixnQ0FBZ0MscUNBQXFDLDJDQUEyQztBQUNySSwwQkFBMEIsTUFBTSxpQkFBaUIsWUFBWTtBQUM3RCxxQkFBcUI7QUFDckIsNEJBQTRCO0FBQzVCLDJCQUEyQjtBQUMzQiwwQkFBMEI7QUFDMUI7O0FBRU87QUFDUDtBQUNBLGVBQWUsNkNBQTZDLFVBQVUsc0RBQXNELGNBQWM7QUFDMUksd0JBQXdCLDZCQUE2QixvQkFBb0IsdUNBQXVDLGtCQUFrQjtBQUNsSTs7QUFFTztBQUNQO0FBQ0E7QUFDQSx5R0FBeUcsdUZBQXVGLGNBQWM7QUFDOU0scUJBQXFCLDhCQUE4QixnREFBZ0Qsd0RBQXdEO0FBQzNKLDJDQUEyQyxzQ0FBc0MsVUFBVSxtQkFBbUIsSUFBSTtBQUNsSDs7QUFFTztBQUNQLCtCQUErQix1Q0FBdUMsWUFBWSxLQUFLLE9BQU87QUFDOUY7QUFDQTs7QUFFQTtBQUNBLHdDQUF3Qyw0QkFBNEI7QUFDcEUsQ0FBQztBQUNEO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUCwyQ0FBMkM7QUFDM0M7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsOENBQThDO0FBQ25FO0FBQ0E7QUFDQSxxQkFBcUIsYUFBYTtBQUNsQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRUFBK0UsU0FBUyxnQkFBZ0I7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlFQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFQUFDOzs7Ozs7O1VDalhGO1VBQ0E7O1VBRUE7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7O1VBRUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7Ozs7O1dDdEJBO1dBQ0E7V0FDQTtXQUNBO1dBQ0E7V0FDQSxpQ0FBaUMsV0FBVztXQUM1QztXQUNBOzs7OztXQ1BBO1dBQ0E7V0FDQTtXQUNBO1dBQ0EseUNBQXlDLHdDQUF3QztXQUNqRjtXQUNBO1dBQ0E7Ozs7O1dDUEE7V0FDQTtXQUNBO1dBQ0E7V0FDQSxHQUFHO1dBQ0g7V0FDQTtXQUNBLENBQUM7Ozs7O1dDUEQ7Ozs7O1dDQUE7V0FDQTtXQUNBO1dBQ0EsdURBQXVELGlCQUFpQjtXQUN4RTtXQUNBLGdEQUFnRCxhQUFhO1dBQzdEOzs7OztVRU5BO1VBQ0E7VUFDQTtVQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL2Jyb3dzZXItY2xpZW50LWZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL2Jyb3dzZXItY2xpZW50LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXIvbGliL2VzbS9jb25maWcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1icm93c2VyL2xpYi9lc20vY29va2llLW1pZ3JhdGlvbi9pbmRleC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1icm93c2VyL2xpYi9lc20vZGV0LW5vdGlmaWNhdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1icm93c2VyL2xpYi9lc20vaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL3BsdWdpbnMvY29udGV4dC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1icm93c2VyL2xpYi9lc20vcGx1Z2lucy9maWxlLWRvd25sb2FkLXRyYWNraW5nLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXIvbGliL2VzbS9wbHVnaW5zL2Zvcm0taW50ZXJhY3Rpb24tdHJhY2tpbmcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL3N0b3JhZ2UvYnJvd3Nlci1zdG9yYWdlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXIvbGliL2VzbS9zdG9yYWdlL2xvY2FsLXN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL3N0b3JhZ2Uvc2Vzc2lvbi1zdG9yYWdlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXIvbGliL2VzbS90cmFuc3BvcnRzL3NlbmQtYmVhY29uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXIvbGliL2VzbS90cmFuc3BvcnRzL3hoci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1icm93c2VyL2xpYi9lc20vdXRpbHMvc25pcHBldC1oZWxwZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci9saWIvZXNtL3ZlcnNpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtY2xpZW50LWNvbW1vbi9saWIvZXNtL2FuYWx5dGljcy1jb25uZWN0b3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtY2xpZW50LWNvbW1vbi9saWIvZXNtL2F0dHJpYnV0aW9uL2NhbXBhaWduLXBhcnNlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uL2xpYi9lc20vYXR0cmlidXRpb24vY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24vbGliL2VzbS9jb29raWUtbmFtZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uL2xpYi9lc20vZGVmYXVsdC10cmFja2luZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uL2xpYi9lc20vZ2xvYmFsLXNjb3BlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24vbGliL2VzbS9sYW5ndWFnZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uL2xpYi9lc20vcGx1Z2lucy9pZGVudGl0eS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uL2xpYi9lc20vcXVlcnktcGFyYW1zLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24vbGliL2VzbS9zdG9yYWdlL2Nvb2tpZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uL2xpYi9lc20vdHJhbnNwb3J0cy9mZXRjaC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb25uZWN0b3IvZGlzdC9hbmFseXRpY3MtY29ubmVjdG9yLmVzbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vY29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZS9saWIvZXNtL2NvcmUtY2xpZW50LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS9pZGVudGlmeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vbG9nZ2VyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS9tZXNzYWdlcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vcGx1Z2lucy9kZXN0aW5hdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vcmV2ZW51ZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vc3RvcmFnZS9tZW1vcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZS9saWIvZXNtL3RpbWVsaW5lLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS90cmFuc3BvcnRzL2Jhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZS9saWIvZXNtL3V0aWxzL2NodW5rLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS91dGlscy9kZWJ1Zy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vdXRpbHMvZXZlbnQtYnVpbGRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlL2xpYi9lc20vdXRpbHMvcmVzdWx0LWJ1aWxkZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZS9saWIvZXNtL3V0aWxzL3JldHVybi13cmFwcGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS91dGlscy91dWlkLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUvbGliL2VzbS91dGlscy92YWxpZC1wcm9wZXJ0aWVzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzL2xpYi9lc20vZXZlbnQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9hbmFseXRpY3MtdHlwZXMvbGliL2VzbS9pbmRleC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy10eXBlcy9saWIvZXNtL2xvZ2dlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9AYW1wbGl0dWRlL2FuYWx5dGljcy10eXBlcy9saWIvZXNtL3NlcnZlci16b25lLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzL2xpYi9lc20vc3RhdHVzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvcGx1Z2luLXBhZ2Utdmlldy10cmFja2luZy1icm93c2VyL2xpYi9lc20vcGFnZS12aWV3LXRyYWNraW5nLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvcGx1Z2luLXBhZ2Utdmlldy10cmFja2luZy1icm93c2VyL2xpYi9lc20vdXRpbHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvQGFtcGxpdHVkZS9wbHVnaW4td2ViLWF0dHJpYnV0aW9uLWJyb3dzZXIvbGliL2VzbS9oZWxwZXJzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL0BhbXBsaXR1ZGUvcGx1Z2luLXdlYi1hdHRyaWJ1dGlvbi1icm93c2VyL2xpYi9lc20vd2ViLWF0dHJpYnV0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL2JlbnQvc3JjL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvYmVudC9zcmMvY29yZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9jb250ZW50LXR5cGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvZXZlbnRzb3VyY2UtcGFyc2VyL2Rpc3QvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvbWljcm9zb2Z0LmNvZ25pdGl2ZXNlcnZpY2VzLnNwZWVjaC5zZGsuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL0NvbnNvbGVMb2dnaW5nTGlzdGVuZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL0ZpbGVBdWRpb1NvdXJjZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXIvTWljQXVkaW9Tb3VyY2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1BDTVJlY29yZGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uYnJvd3Nlci9Qcm94eUluZm8uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1JlcGxheWFibGVBdWRpb05vZGUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1Jlc3RDb25maWdCYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uYnJvd3Nlci9SZXN0TWVzc2FnZUFkYXB0ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1dlYnNvY2tldENvbm5lY3Rpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyL1dlYnNvY2tldE1lc3NhZ2VBZGFwdGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0FkZGVkTG1JbnRlbnQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQWdlbnRDb25maWcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQ29nbml0aXZlU3Vic2NyaXB0aW9uS2V5QXV0aGVudGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9Db25uZWN0aW9uRmFjdG9yeUJhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvQ29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvRGlhbG9nQ29ubmVjdG9yRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9EaWFsb2dTZXJ2aWNlQWRhcHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9EaWFsb2dTZXJ2aWNlVHVyblN0YXRlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0RpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0R5bmFtaWNHcmFtbWFyQnVpbGRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9EeW5hbWljR3JhbW1hckludGVyZmFjZXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvRW51bVRyYW5zbGF0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0V4cG9ydHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSGVhZGVyTmFtZXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSUF1dGhlbnRpY2F0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL0lDb25uZWN0aW9uRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9JU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSW50ZW50Q29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvSW50ZW50U2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvUXVlcnlQYXJhbWV0ZXJOYW1lcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9SZWNvZ25pdGlvbkV2ZW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9SZWNvZ25pemVyQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1JlcXVlc3RTZXNzaW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9BY3Rpdml0eVJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvRGV0YWlsZWRTcGVlY2hQaHJhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZU1lc3NhZ2VzL0VudW1zLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9JbnRlbnRSZXNwb25zZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvU2ltcGxlU3BlZWNoUGhyYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TcGVha2VyUmVzcG9uc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZU1lc3NhZ2VzL1NwZWVjaERldGVjdGVkLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TcGVlY2hIeXBvdGhlc2lzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TcGVlY2hLZXl3b3JkLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9TeW50aGVzaXNBdWRpb01ldGFkYXRhLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvbkh5cG90aGVzaXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZU1lc3NhZ2VzL1RyYW5zbGF0aW9uUGhyYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvblN5bnRoZXNpc0VuZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TZXJ2aWNlTWVzc2FnZXMvVHVyblN0YXR1c1BheWxvYWQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU2VydmljZVJlY29nbml6ZXJCYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5JbnRlcm5hbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TcGVha2VyUmVjb2duaXRpb25Db25maWcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlYWtlclNlcnZpY2VSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NwZWVjaENvbm5lY3Rpb25GYWN0b3J5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1NwZWVjaENvbnRleHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlZWNoU2VydmljZUludGVyZmFjZXMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlZWNoU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3BlZWNoU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzQWRhcHRlckJhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzQ29udGV4dC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TeW50aGVzaXNFdmVudHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzUmVzdEFkYXB0ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvU3ludGhlc2lzVHVybi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9TeW50aGVzaXplckNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25GYWN0b3J5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25NYW5hZ2VyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25TZXJ2aWNlQWRhcHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JDb25uZWN0aW9uRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdG9ySW50ZXJmYWNlcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL0V4cG9ydHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9TZXJ2aWNlTWVzc2FnZXMvQ29tbWFuZFJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL1NlcnZpY2VNZXNzYWdlcy9QYXJ0aWNpcGFudFJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvblJlc3BvbnNlUGF5bG9hZC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uL1RyYW5zY3JpYmVyUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2NyaXB0aW9uU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvVHJhbnNsYXRpb25Db25uZWN0aW9uRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLnNwZWVjaC9UcmFuc2xhdGlvblNlcnZpY2VSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1RyYW5zbGF0aW9uU3RhdHVzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uc3BlZWNoL1ZvaWNlU2VydmljZVJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5zcGVlY2gvV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0F1ZGlvU291cmNlRXZlbnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQmFja2dyb3VuZEVycm9yLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQ2h1bmtlZEFycmF5QnVmZmVyU3RyZWFtLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQ29ubmVjdGlvbkV2ZW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0Nvbm5lY3Rpb25NZXNzYWdlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vQ29ubmVjdGlvbk9wZW5SZXNwb25zZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0RlZmVycmFsTWFwLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vRGlhbG9nRXZlbnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vRXJyb3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9FdmVudFNvdXJjZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0V2ZW50cy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0d1aWQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9JQ29ubmVjdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL0xpc3QuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9QbGF0Zm9ybUV2ZW50LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vUHJvbWlzZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL1F1ZXVlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vUmF3V2Vic29ja2V0TWVzc2FnZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uL1JpZmZQY21FbmNvZGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vU3RyZWFtLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24vU3RyaW5nVXRpbHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi9UaW1lb3V0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL0F1ZGlvQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW8vQXVkaW9GaWxlV3JpdGVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW8vQXVkaW9JbnB1dFN0cmVhbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL0F1ZGlvT3V0cHV0Rm9ybWF0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW8vQXVkaW9PdXRwdXRTdHJlYW0uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9BdWRpby9BdWRpb1N0cmVhbUZvcm1hdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL0Jhc2VBdWRpb1BsYXllci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL1B1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2suanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9BdWRpby9QdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFjay5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0F1ZGlvL1NwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQm90RnJhbWV3b3JrQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ2FuY2VsbGF0aW9uRGV0YWlscy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0NhbmNlbGxhdGlvbkRldGFpbHNCYXNlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ2FuY2VsbGF0aW9uRXJyb3JDb2Rlcy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0NhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2UuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9DYW5jZWxsYXRpb25SZWFzb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Db25uZWN0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ29ubmVjdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0Nvbm5lY3Rpb25NZXNzYWdlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQ29ubmVjdGlvbk1lc3NhZ2VFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Db250cmFjdHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Db252ZXJzYXRpb25UcmFuc2NyaXB0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9DdXN0b21Db21tYW5kc0NvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0RpYWdub3N0aWNzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvRGlhbG9nU2VydmljZUNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0RpYWxvZ1NlcnZpY2VDb25uZWN0b3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9FeHBvcnRzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0ludGVudFJlY29nbml0aW9uRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvSW50ZW50UmVjb2duaXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9JbnRlbnRSZWNvZ25pemVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvS2V5d29yZFJlY29nbml0aW9uTW9kZWwuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9MYW5ndWFnZUlkTW9kZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL0xhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvTm9NYXRjaERldGFpbHMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Ob01hdGNoUmVhc29uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvT3V0cHV0Rm9ybWF0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvUGhyYXNlTGlzdEdyYW1tYXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Qcm9mYW5pdHlPcHRpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb3BlcnR5Q29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Byb3BlcnR5SWQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9SZWNvZ25pdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1JlY29nbml0aW9uUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1Jlc3VsdFJlYXNvbi5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NlcnZpY2VFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TZXJ2aWNlUHJvcGVydHlDaGFubmVsLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU2Vzc2lvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NvdXJjZUxhbmd1YWdlQ29uZmlnLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVha2VyUmVjb2duaXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVha2VyUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWFrZXJWZXJpZmljYXRpb25Nb2RlbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaENvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaFJlY29nbml0aW9uUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoUmVjb2duaXplci5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1NwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvU3BlZWNoU3ludGhlc2l6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9TcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1N5bnRoZXNpc1Jlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1N5bnRoZXNpc1ZvaWNlc1Jlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25Db21tb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvbkV4cGlyYXRpb25FdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblBhcnRpY2lwYW50c0NoYW5nZWRFdmVudEFyZ3MuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zY3JpYmVyLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zY3JpcHRpb24vQ29udmVyc2F0aW9uVHJhbnNsYXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0NvbnZlcnNhdGlvblRyYW5zbGF0b3IuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2NyaXB0aW9uL0lQYXJ0aWNpcGFudC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zY3JpcHRpb24vUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2xhdGlvblJlY29nbml6ZXIuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL3Nkay9UcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1RyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHJhbnNsYXRpb25zLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VJbmZvLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VQcm9maWxlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VQcm9maWxlQ2xpZW50LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1ZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1ZvaWNlUHJvZmlsZVJlc3VsdC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvc2RrL1ZvaWNlUHJvZmlsZVR5cGUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvT3B0aW9ucy9tb2RlbHMudHMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvT3B0aW9ucy91dGlsLnRzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vc3JjL2JhY2tncm91bmQudHMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9zcmMvdXRpbC50cyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91bnNwbGFzaC1qcy9kaXN0L3Vuc3BsYXNoLWpzLmVzbS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9pbmRleC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9tZDUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvbmF0aXZlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL25pbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9wYXJzZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9yZWdleC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9ybmcuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvc2hhMS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvY29tbW9uanMtYnJvd3Nlci9zdHJpbmdpZnkuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvdjEuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvdjMuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2NvbW1vbmpzLWJyb3dzZXIvdjM1LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3Y0LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3Y1LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3ZhbGlkYXRlLmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9jb21tb25qcy1icm93c2VyL3ZlcnNpb24uanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL25hdGl2ZS5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcmVnZXguanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JuZy5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc3RyaW5naWZ5LmpzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvdmFsaWRhdGUuanMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvd2ViZXh0ZW5zaW9uLXBvbHlmaWxsL2Rpc3QvYnJvd3Nlci1wb2x5ZmlsbC5qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci9pZ25vcmVkfC9Vc2Vycy9qaWFuZ3ppbG9uZy/lrabkuaAvbWlucGcvTGVhcm5pbmctRW5nbGlzaC9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyfGFnZW50LWJhc2UiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvaWdub3JlZHwvVXNlcnMvamlhbmd6aWxvbmcv5a2m5LmgL21pbnBnL0xlYXJuaW5nLUVuZ2xpc2gvbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9jb21tb24uYnJvd3NlcnxmcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci9pZ25vcmVkfC9Vc2Vycy9qaWFuZ3ppbG9uZy/lrabkuaAvbWlucGcvTGVhcm5pbmctRW5nbGlzaC9ub2RlX21vZHVsZXMvbWljcm9zb2Z0LWNvZ25pdGl2ZXNlcnZpY2VzLXNwZWVjaC1zZGsvZGlzdHJpYi9lczIwMTUvc3JjL2NvbW1vbi5icm93c2VyfGh0dHBzLXByb3h5LWFnZW50Iiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL2lnbm9yZWR8L1VzZXJzL2ppYW5nemlsb25nL+WtpuS5oC9taW5wZy9MZWFybmluZy1FbmdsaXNoL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXJ8bmV0Iiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL2lnbm9yZWR8L1VzZXJzL2ppYW5nemlsb25nL+WtpuS5oC9taW5wZy9MZWFybmluZy1FbmdsaXNoL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXJ8dGxzIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL2lnbm9yZWR8L1VzZXJzL2ppYW5nemlsb25nL+WtpuS5oC9taW5wZy9MZWFybmluZy1FbmdsaXNoL25vZGVfbW9kdWxlcy9taWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkay9kaXN0cmliL2VzMjAxNS9zcmMvY29tbW9uLmJyb3dzZXJ8d3MiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvaWdub3JlZHwvVXNlcnMvamlhbmd6aWxvbmcv5a2m5LmgL21pbnBnL0xlYXJuaW5nLUVuZ2xpc2gvbm9kZV9tb2R1bGVzL21pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrL2Rpc3RyaWIvZXMyMDE1L3NyYy9zZGsvQXVkaW98ZnMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvLi9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2Lm1qcyIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2Nocm9tZS1leHRlbnNpb24tdHlwZXNjcmlwdC1zdGFydGVyL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9iZWZvcmUtc3RhcnR1cCIsIndlYnBhY2s6Ly9jaHJvbWUtZXh0ZW5zaW9uLXR5cGVzY3JpcHQtc3RhcnRlci93ZWJwYWNrL3N0YXJ0dXAiLCJ3ZWJwYWNrOi8vY2hyb21lLWV4dGVuc2lvbi10eXBlc2NyaXB0LXN0YXJ0ZXIvd2VicGFjay9hZnRlci1zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlYnVnV3JhcHBlciwgZ2V0Q2xpZW50TG9nQ29uZmlnLCBnZXRDbGllbnRTdGF0ZXMgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlJztcbmltcG9ydCB7IEFtcGxpdHVkZUJyb3dzZXIgfSBmcm9tICcuL2Jyb3dzZXItY2xpZW50JztcbmV4cG9ydCB2YXIgY3JlYXRlSW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNsaWVudCA9IG5ldyBBbXBsaXR1ZGVCcm93c2VyKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdDogZGVidWdXcmFwcGVyKGNsaWVudC5pbml0LmJpbmQoY2xpZW50KSwgJ2luaXQnLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcnXSkpLFxuICAgICAgICBhZGQ6IGRlYnVnV3JhcHBlcihjbGllbnQuYWRkLmJpbmQoY2xpZW50KSwgJ2FkZCcsIGdldENsaWVudExvZ0NvbmZpZyhjbGllbnQpLCBnZXRDbGllbnRTdGF0ZXMoY2xpZW50LCBbJ2NvbmZpZy5hcGlLZXknLCAndGltZWxpbmUucGx1Z2lucyddKSksXG4gICAgICAgIHJlbW92ZTogZGVidWdXcmFwcGVyKGNsaWVudC5yZW1vdmUuYmluZChjbGllbnQpLCAncmVtb3ZlJywgZ2V0Q2xpZW50TG9nQ29uZmlnKGNsaWVudCksIGdldENsaWVudFN0YXRlcyhjbGllbnQsIFsnY29uZmlnLmFwaUtleScsICd0aW1lbGluZS5wbHVnaW5zJ10pKSxcbiAgICAgICAgdHJhY2s6IGRlYnVnV3JhcHBlcihjbGllbnQudHJhY2suYmluZChjbGllbnQpLCAndHJhY2snLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcuYXBpS2V5JywgJ3RpbWVsaW5lLnF1ZXVlLmxlbmd0aCddKSksXG4gICAgICAgIGxvZ0V2ZW50OiBkZWJ1Z1dyYXBwZXIoY2xpZW50LmxvZ0V2ZW50LmJpbmQoY2xpZW50KSwgJ2xvZ0V2ZW50JywgZ2V0Q2xpZW50TG9nQ29uZmlnKGNsaWVudCksIGdldENsaWVudFN0YXRlcyhjbGllbnQsIFsnY29uZmlnLmFwaUtleScsICd0aW1lbGluZS5xdWV1ZS5sZW5ndGgnXSkpLFxuICAgICAgICBpZGVudGlmeTogZGVidWdXcmFwcGVyKGNsaWVudC5pZGVudGlmeS5iaW5kKGNsaWVudCksICdpZGVudGlmeScsIGdldENsaWVudExvZ0NvbmZpZyhjbGllbnQpLCBnZXRDbGllbnRTdGF0ZXMoY2xpZW50LCBbJ2NvbmZpZy5hcGlLZXknLCAndGltZWxpbmUucXVldWUubGVuZ3RoJ10pKSxcbiAgICAgICAgZ3JvdXBJZGVudGlmeTogZGVidWdXcmFwcGVyKGNsaWVudC5ncm91cElkZW50aWZ5LmJpbmQoY2xpZW50KSwgJ2dyb3VwSWRlbnRpZnknLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcuYXBpS2V5JywgJ3RpbWVsaW5lLnF1ZXVlLmxlbmd0aCddKSksXG4gICAgICAgIHNldEdyb3VwOiBkZWJ1Z1dyYXBwZXIoY2xpZW50LnNldEdyb3VwLmJpbmQoY2xpZW50KSwgJ3NldEdyb3VwJywgZ2V0Q2xpZW50TG9nQ29uZmlnKGNsaWVudCksIGdldENsaWVudFN0YXRlcyhjbGllbnQsIFsnY29uZmlnLmFwaUtleScsICd0aW1lbGluZS5xdWV1ZS5sZW5ndGgnXSkpLFxuICAgICAgICByZXZlbnVlOiBkZWJ1Z1dyYXBwZXIoY2xpZW50LnJldmVudWUuYmluZChjbGllbnQpLCAncmV2ZW51ZScsIGdldENsaWVudExvZ0NvbmZpZyhjbGllbnQpLCBnZXRDbGllbnRTdGF0ZXMoY2xpZW50LCBbJ2NvbmZpZy5hcGlLZXknLCAndGltZWxpbmUucXVldWUubGVuZ3RoJ10pKSxcbiAgICAgICAgZmx1c2g6IGRlYnVnV3JhcHBlcihjbGllbnQuZmx1c2guYmluZChjbGllbnQpLCAnZmx1c2gnLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcuYXBpS2V5JywgJ3RpbWVsaW5lLnF1ZXVlLmxlbmd0aCddKSksXG4gICAgICAgIGdldFVzZXJJZDogZGVidWdXcmFwcGVyKGNsaWVudC5nZXRVc2VySWQuYmluZChjbGllbnQpLCAnZ2V0VXNlcklkJywgZ2V0Q2xpZW50TG9nQ29uZmlnKGNsaWVudCksIGdldENsaWVudFN0YXRlcyhjbGllbnQsIFsnY29uZmlnJywgJ2NvbmZpZy51c2VySWQnXSkpLFxuICAgICAgICBzZXRVc2VySWQ6IGRlYnVnV3JhcHBlcihjbGllbnQuc2V0VXNlcklkLmJpbmQoY2xpZW50KSwgJ3NldFVzZXJJZCcsIGdldENsaWVudExvZ0NvbmZpZyhjbGllbnQpLCBnZXRDbGllbnRTdGF0ZXMoY2xpZW50LCBbJ2NvbmZpZycsICdjb25maWcudXNlcklkJ10pKSxcbiAgICAgICAgZ2V0RGV2aWNlSWQ6IGRlYnVnV3JhcHBlcihjbGllbnQuZ2V0RGV2aWNlSWQuYmluZChjbGllbnQpLCAnZ2V0RGV2aWNlSWQnLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcnLCAnY29uZmlnLmRldmljZUlkJ10pKSxcbiAgICAgICAgc2V0RGV2aWNlSWQ6IGRlYnVnV3JhcHBlcihjbGllbnQuc2V0RGV2aWNlSWQuYmluZChjbGllbnQpLCAnc2V0RGV2aWNlSWQnLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcnLCAnY29uZmlnLmRldmljZUlkJ10pKSxcbiAgICAgICAgcmVzZXQ6IGRlYnVnV3JhcHBlcihjbGllbnQucmVzZXQuYmluZChjbGllbnQpLCAncmVzZXQnLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcnLCAnY29uZmlnLnVzZXJJZCcsICdjb25maWcuZGV2aWNlSWQnXSkpLFxuICAgICAgICBnZXRTZXNzaW9uSWQ6IGRlYnVnV3JhcHBlcihjbGllbnQuZ2V0U2Vzc2lvbklkLmJpbmQoY2xpZW50KSwgJ2dldFNlc3Npb25JZCcsIGdldENsaWVudExvZ0NvbmZpZyhjbGllbnQpLCBnZXRDbGllbnRTdGF0ZXMoY2xpZW50LCBbJ2NvbmZpZyddKSksXG4gICAgICAgIHNldFNlc3Npb25JZDogZGVidWdXcmFwcGVyKGNsaWVudC5zZXRTZXNzaW9uSWQuYmluZChjbGllbnQpLCAnc2V0U2Vzc2lvbklkJywgZ2V0Q2xpZW50TG9nQ29uZmlnKGNsaWVudCksIGdldENsaWVudFN0YXRlcyhjbGllbnQsIFsnY29uZmlnJ10pKSxcbiAgICAgICAgZXh0ZW5kU2Vzc2lvbjogZGVidWdXcmFwcGVyKGNsaWVudC5leHRlbmRTZXNzaW9uLmJpbmQoY2xpZW50KSwgJ2V4dGVuZFNlc3Npb24nLCBnZXRDbGllbnRMb2dDb25maWcoY2xpZW50KSwgZ2V0Q2xpZW50U3RhdGVzKGNsaWVudCwgWydjb25maWcnXSkpLFxuICAgICAgICBzZXRPcHRPdXQ6IGRlYnVnV3JhcHBlcihjbGllbnQuc2V0T3B0T3V0LmJpbmQoY2xpZW50KSwgJ3NldE9wdE91dCcsIGdldENsaWVudExvZ0NvbmZpZyhjbGllbnQpLCBnZXRDbGllbnRTdGF0ZXMoY2xpZW50LCBbJ2NvbmZpZyddKSksXG4gICAgICAgIHNldFRyYW5zcG9ydDogZGVidWdXcmFwcGVyKGNsaWVudC5zZXRUcmFuc3BvcnQuYmluZChjbGllbnQpLCAnc2V0VHJhbnNwb3J0JywgZ2V0Q2xpZW50TG9nQ29uZmlnKGNsaWVudCksIGdldENsaWVudFN0YXRlcyhjbGllbnQsIFsnY29uZmlnJ10pKSxcbiAgICB9O1xufTtcbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZUluc3RhbmNlKCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1icm93c2VyLWNsaWVudC1mYWN0b3J5LmpzLm1hcCIsImltcG9ydCB7IF9fYXNzaWduLCBfX2F3YWl0ZXIsIF9fZXh0ZW5kcywgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IEFtcGxpdHVkZUNvcmUsIERlc3RpbmF0aW9uLCBJZGVudGlmeSwgcmV0dXJuV3JhcHBlciwgUmV2ZW51ZSwgVVVJRCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUnO1xuaW1wb3J0IHsgZ2V0QW5hbHl0aWNzQ29ubmVjdG9yLCBnZXRBdHRyaWJ1dGlvblRyYWNraW5nQ29uZmlnLCBnZXRQYWdlVmlld1RyYWNraW5nQ29uZmlnLCBJZGVudGl0eUV2ZW50U2VuZGVyLCBpc0F0dHJpYnV0aW9uVHJhY2tpbmdFbmFibGVkLCBpc1Nlc3Npb25UcmFja2luZ0VuYWJsZWQsIGlzRmlsZURvd25sb2FkVHJhY2tpbmdFbmFibGVkLCBpc0Zvcm1JbnRlcmFjdGlvblRyYWNraW5nRW5hYmxlZCwgc2V0Q29ubmVjdG9yRGV2aWNlSWQsIHNldENvbm5lY3RvclVzZXJJZCwgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uJztcbmltcG9ydCB7IGNvbnZlcnRQcm94eU9iamVjdFRvUmVhbE9iamVjdCwgaXNJbnN0YW5jZVByb3h5IH0gZnJvbSAnLi91dGlscy9zbmlwcGV0LWhlbHBlcic7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSAnLi9wbHVnaW5zL2NvbnRleHQnO1xuaW1wb3J0IHsgdXNlQnJvd3NlckNvbmZpZywgY3JlYXRlVHJhbnNwb3J0IH0gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHsgd2ViQXR0cmlidXRpb25QbHVnaW4gfSBmcm9tICdAYW1wbGl0dWRlL3BsdWdpbi13ZWItYXR0cmlidXRpb24tYnJvd3Nlcic7XG5pbXBvcnQgeyBwYWdlVmlld1RyYWNraW5nUGx1Z2luIH0gZnJvbSAnQGFtcGxpdHVkZS9wbHVnaW4tcGFnZS12aWV3LXRyYWNraW5nLWJyb3dzZXInO1xuaW1wb3J0IHsgZm9ybUludGVyYWN0aW9uVHJhY2tpbmcgfSBmcm9tICcuL3BsdWdpbnMvZm9ybS1pbnRlcmFjdGlvbi10cmFja2luZyc7XG5pbXBvcnQgeyBmaWxlRG93bmxvYWRUcmFja2luZyB9IGZyb20gJy4vcGx1Z2lucy9maWxlLWRvd25sb2FkLXRyYWNraW5nJztcbmltcG9ydCB7IERFRkFVTFRfU0VTU0lPTl9FTkRfRVZFTlQsIERFRkFVTFRfU0VTU0lPTl9TVEFSVF9FVkVOVCB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IGRldE5vdGlmeSB9IGZyb20gJy4vZGV0LW5vdGlmaWNhdGlvbic7XG52YXIgQW1wbGl0dWRlQnJvd3NlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW1wbGl0dWRlQnJvd3NlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbXBsaXR1ZGVCcm93c2VyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoYXBpS2V5LCB1c2VySWRPck9wdGlvbnMsIG1heWJlT3B0aW9ucykge1xuICAgICAgICBpZiAoYXBpS2V5ID09PSB2b2lkIDApIHsgYXBpS2V5ID0gJyc7IH1cbiAgICAgICAgdmFyIHVzZXJJZDtcbiAgICAgICAgdmFyIG9wdGlvbnM7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgdXNlcklkID0gdXNlcklkT3JPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucyA9IG1heWJlT3B0aW9ucztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXNlcklkT3JPcHRpb25zID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHVzZXJJZCA9IHVzZXJJZE9yT3B0aW9ucztcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdXNlcklkID0gdXNlcklkT3JPcHRpb25zID09PSBudWxsIHx8IHVzZXJJZE9yT3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlcklkT3JPcHRpb25zLnVzZXJJZDtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gdXNlcklkT3JPcHRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXR1cm5XcmFwcGVyKHRoaXMuX2luaXQoX19hc3NpZ24oX19hc3NpZ24oe30sIG9wdGlvbnMpLCB7IHVzZXJJZDogdXNlcklkLCBhcGlLZXk6IGFwaUtleSB9KSkpO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQnJvd3Nlci5wcm90b3R5cGUuX2luaXQgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYnJvd3Nlck9wdGlvbnMsIGNvbm5lY3RvciwgYXR0cmlidXRpb25UcmFja2luZ09wdGlvbnMsIHdlYkF0dHJpYnV0aW9uO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0ZXAgMTogQmxvY2sgY29uY3VycmVudCBpbml0aWFsaXphdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGl6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXppbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdXNlQnJvd3NlckNvbmZpZyhvcHRpb25zLmFwaUtleSwgb3B0aW9ucywgdGhpcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBicm93c2VyT3B0aW9ucyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIF9zdXBlci5wcm90b3R5cGUuX2luaXQuY2FsbCh0aGlzLCBicm93c2VyT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTdGVwIDM6IFNldCBzZXNzaW9uIElEXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmlvcml0eSAxOiBgb3B0aW9ucy5zZXNzaW9uSWRgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmlvcml0eSAyOiBsYXN0IGtub3duIHNlc3Npb25JZCBmcm9tIHVzZXIgaWRlbnRpdHkgc3RvcmFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVmYXVsdDogYERhdGUubm93KClgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXNzaW9uIElEIGlzIGhhbmRsZWQgZGlmZmVyZW50bHkgdGhhbiBkZXZpY2UgSUQgYW5kIHVzZXIgSUQgZHVlIHRvIHNlc3Npb24gZXZlbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlc3Npb25JZCgoX2IgPSAoX2EgPSBvcHRpb25zLnNlc3Npb25JZCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdGhpcy5jb25maWcuc2Vzc2lvbklkKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBEYXRlLm5vdygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3RvciA9IGdldEFuYWx5dGljc0Nvbm5lY3RvcihvcHRpb25zLmluc3RhbmNlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0b3IuaWRlbnRpdHlTdG9yZS5zZXRJZGVudGl0eSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB0aGlzLmNvbmZpZy51c2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlSWQ6IHRoaXMuY29uZmlnLmRldmljZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTdGVwIDQ6IEluc3RhbGwgcGx1Z2luc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90IHRyYWNrIGFueSBldmVudHMgYmVmb3JlIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYWRkKG5ldyBEZXN0aW5hdGlvbigpKS5wcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RlcCA0OiBJbnN0YWxsIHBsdWdpbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdCB0cmFjayBhbnkgZXZlbnRzIGJlZm9yZSB0aGlzXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmFkZChuZXcgQ29udGV4dCgpKS5wcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5hZGQobmV3IElkZW50aXR5RXZlbnRTZW5kZXIoKSkucHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmeSBpZiBERVQgaXMgZW5hYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgZGV0Tm90aWZ5KHRoaXMuY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNGaWxlRG93bmxvYWRUcmFja2luZ0VuYWJsZWQodGhpcy5jb25maWcuZGVmYXVsdFRyYWNraW5nKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmFkZChmaWxlRG93bmxvYWRUcmFja2luZygpKS5wcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSA3O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRm9ybUludGVyYWN0aW9uVHJhY2tpbmdFbmFibGVkKHRoaXMuY29uZmlnLmRlZmF1bHRUcmFja2luZykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5hZGQoZm9ybUludGVyYWN0aW9uVHJhY2tpbmcoKSkucHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0F0dHJpYnV0aW9uVHJhY2tpbmdFbmFibGVkKHRoaXMuY29uZmlnLmRlZmF1bHRUcmFja2luZykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDExXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0aW9uVHJhY2tpbmdPcHRpb25zID0gZ2V0QXR0cmlidXRpb25UcmFja2luZ0NvbmZpZyh0aGlzLmNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWJBdHRyaWJ1dGlvbiA9IHdlYkF0dHJpYnV0aW9uUGx1Z2luKGF0dHJpYnV0aW9uVHJhY2tpbmdPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYWRkKHdlYkF0dHJpYnV0aW9uKS5wcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6IFxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgcGFnZSB2aWV3IHBsdWdpblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmFkZChwYWdlVmlld1RyYWNraW5nUGx1Z2luKGdldFBhZ2VWaWV3VHJhY2tpbmdDb25maWcodGhpcy5jb25maWcpKSkucHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgcGFnZSB2aWV3IHBsdWdpblxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXppbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0ZXAgNjogUnVuIHF1ZXVlZCBkaXNwYXRjaCBmdW5jdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucnVuUXVldWVkRnVuY3Rpb25zKCdkaXNwYXRjaFEnKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTdGVwIDY6IFJ1biBxdWV1ZWQgZGlzcGF0Y2ggZnVuY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTdGVwIDc6IEFkZCB0aGUgZXZlbnQgcmVjZWl2ZXIgYWZ0ZXIgcnVubmluZyByZW1haW5pbmcgcXVldWVkIGZ1bmN0aW9ucy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rvci5ldmVudEJyaWRnZS5zZXRFdmVudFJlY2VpdmVyKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgX3RoaXMudHJhY2soZXZlbnQuZXZlbnRUeXBlLCBldmVudC5ldmVudFByb3BlcnRpZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQnJvd3Nlci5wcm90b3R5cGUuZ2V0VXNlcklkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLmNvbmZpZykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnVzZXJJZDtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLnNldFVzZXJJZCA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5xLnB1c2godGhpcy5zZXRVc2VySWQuYmluZCh0aGlzLCB1c2VySWQpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXNlcklkICE9PSB0aGlzLmNvbmZpZy51c2VySWQgfHwgdXNlcklkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLnVzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgICAgIHNldENvbm5lY3RvclVzZXJJZCh1c2VySWQsIHRoaXMuY29uZmlnLmluc3RhbmNlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLmdldERldmljZUlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLmNvbmZpZykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRldmljZUlkO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQnJvd3Nlci5wcm90b3R5cGUuc2V0RGV2aWNlSWQgPSBmdW5jdGlvbiAoZGV2aWNlSWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5xLnB1c2godGhpcy5zZXREZXZpY2VJZC5iaW5kKHRoaXMsIGRldmljZUlkKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25maWcuZGV2aWNlSWQgPSBkZXZpY2VJZDtcbiAgICAgICAgc2V0Q29ubmVjdG9yRGV2aWNlSWQoZGV2aWNlSWQsIHRoaXMuY29uZmlnLmluc3RhbmNlTmFtZSk7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVCcm93c2VyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXREZXZpY2VJZChVVUlEKCkpO1xuICAgICAgICB0aGlzLnNldFVzZXJJZCh1bmRlZmluZWQpO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQnJvd3Nlci5wcm90b3R5cGUuZ2V0U2Vzc2lvbklkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiAoX2EgPSB0aGlzLmNvbmZpZykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlc3Npb25JZDtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLnNldFNlc3Npb25JZCA9IGZ1bmN0aW9uIChzZXNzaW9uSWQpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAoIXRoaXMuY29uZmlnKSB7XG4gICAgICAgICAgICB0aGlzLnEucHVzaCh0aGlzLnNldFNlc3Npb25JZC5iaW5kKHRoaXMsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIFByZXZlbnRzIHN0YXJ0aW5nIGEgbmV3IHNlc3Npb24gd2l0aCB0aGUgc2FtZSBzZXNzaW9uIElEXG4gICAgICAgIGlmIChzZXNzaW9uSWQgPT09IHRoaXMuY29uZmlnLnNlc3Npb25JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmV2aW91c1Nlc3Npb25JZCA9IHRoaXMuZ2V0U2Vzc2lvbklkKCk7XG4gICAgICAgIHZhciBsYXN0RXZlbnRUaW1lID0gdGhpcy5jb25maWcubGFzdEV2ZW50VGltZTtcbiAgICAgICAgdmFyIGxhc3RFdmVudElkID0gKF9hID0gdGhpcy5jb25maWcubGFzdEV2ZW50SWQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IC0xO1xuICAgICAgICB0aGlzLmNvbmZpZy5zZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XG4gICAgICAgIHRoaXMuY29uZmlnLmxhc3RFdmVudFRpbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChpc1Nlc3Npb25UcmFja2luZ0VuYWJsZWQodGhpcy5jb25maWcuZGVmYXVsdFRyYWNraW5nKSkge1xuICAgICAgICAgICAgaWYgKHByZXZpb3VzU2Vzc2lvbklkICYmIGxhc3RFdmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrKERFRkFVTFRfU0VTU0lPTl9FTkRfRVZFTlQsIHVuZGVmaW5lZCwge1xuICAgICAgICAgICAgICAgICAgICBkZXZpY2VfaWQ6IHRoaXMucHJldmlvdXNTZXNzaW9uRGV2aWNlSWQsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50X2lkOiArK2xhc3RFdmVudElkLFxuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uX2lkOiBwcmV2aW91c1Nlc3Npb25JZCxcbiAgICAgICAgICAgICAgICAgICAgdGltZTogbGFzdEV2ZW50VGltZSArIDEsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IHRoaXMucHJldmlvdXNTZXNzaW9uVXNlcklkLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jb25maWcubGFzdEV2ZW50VGltZSA9IHRoaXMuY29uZmlnLnNlc3Npb25JZDtcbiAgICAgICAgICAgIHRoaXMudHJhY2soREVGQVVMVF9TRVNTSU9OX1NUQVJUX0VWRU5ULCB1bmRlZmluZWQsIHtcbiAgICAgICAgICAgICAgICBldmVudF9pZDogKytsYXN0RXZlbnRJZCxcbiAgICAgICAgICAgICAgICBzZXNzaW9uX2lkOiB0aGlzLmNvbmZpZy5zZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgdGltZTogdGhpcy5jb25maWcubGFzdEV2ZW50VGltZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJldmlvdXNTZXNzaW9uRGV2aWNlSWQgPSB0aGlzLmNvbmZpZy5kZXZpY2VJZDtcbiAgICAgICAgdGhpcy5wcmV2aW91c1Nlc3Npb25Vc2VySWQgPSB0aGlzLmNvbmZpZy51c2VySWQ7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVCcm93c2VyLnByb3RvdHlwZS5leHRlbmRTZXNzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuY29uZmlnKSB7XG4gICAgICAgICAgICB0aGlzLnEucHVzaCh0aGlzLmV4dGVuZFNlc3Npb24uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25maWcubGFzdEV2ZW50VGltZSA9IERhdGUubm93KCk7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVCcm93c2VyLnByb3RvdHlwZS5zZXRUcmFuc3BvcnQgPSBmdW5jdGlvbiAodHJhbnNwb3J0KSB7XG4gICAgICAgIGlmICghdGhpcy5jb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMucS5wdXNoKHRoaXMuc2V0VHJhbnNwb3J0LmJpbmQodGhpcywgdHJhbnNwb3J0KSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25maWcudHJhbnNwb3J0UHJvdmlkZXIgPSBjcmVhdGVUcmFuc3BvcnQodHJhbnNwb3J0KTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLmlkZW50aWZ5ID0gZnVuY3Rpb24gKGlkZW50aWZ5LCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgaWYgKGlzSW5zdGFuY2VQcm94eShpZGVudGlmeSkpIHtcbiAgICAgICAgICAgIHZhciBxdWV1ZSA9IGlkZW50aWZ5Ll9xO1xuICAgICAgICAgICAgaWRlbnRpZnkuX3EgPSBbXTtcbiAgICAgICAgICAgIGlkZW50aWZ5ID0gY29udmVydFByb3h5T2JqZWN0VG9SZWFsT2JqZWN0KG5ldyBJZGVudGlmeSgpLCBxdWV1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50T3B0aW9ucyA9PT0gbnVsbCB8fCBldmVudE9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGV2ZW50T3B0aW9ucy51c2VyX2lkKSB7XG4gICAgICAgICAgICB0aGlzLnNldFVzZXJJZChldmVudE9wdGlvbnMudXNlcl9pZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50T3B0aW9ucyA9PT0gbnVsbCB8fCBldmVudE9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGV2ZW50T3B0aW9ucy5kZXZpY2VfaWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0RGV2aWNlSWQoZXZlbnRPcHRpb25zLmRldmljZV9pZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuaWRlbnRpZnkuY2FsbCh0aGlzLCBpZGVudGlmeSwgZXZlbnRPcHRpb25zKTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLmdyb3VwSWRlbnRpZnkgPSBmdW5jdGlvbiAoZ3JvdXBUeXBlLCBncm91cE5hbWUsIGlkZW50aWZ5LCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgaWYgKGlzSW5zdGFuY2VQcm94eShpZGVudGlmeSkpIHtcbiAgICAgICAgICAgIHZhciBxdWV1ZSA9IGlkZW50aWZ5Ll9xO1xuICAgICAgICAgICAgaWRlbnRpZnkuX3EgPSBbXTtcbiAgICAgICAgICAgIGlkZW50aWZ5ID0gY29udmVydFByb3h5T2JqZWN0VG9SZWFsT2JqZWN0KG5ldyBJZGVudGlmeSgpLCBxdWV1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuZ3JvdXBJZGVudGlmeS5jYWxsKHRoaXMsIGdyb3VwVHlwZSwgZ3JvdXBOYW1lLCBpZGVudGlmeSwgZXZlbnRPcHRpb25zKTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLnJldmVudWUgPSBmdW5jdGlvbiAocmV2ZW51ZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIGlmIChpc0luc3RhbmNlUHJveHkocmV2ZW51ZSkpIHtcbiAgICAgICAgICAgIHZhciBxdWV1ZSA9IHJldmVudWUuX3E7XG4gICAgICAgICAgICByZXZlbnVlLl9xID0gW107XG4gICAgICAgICAgICByZXZlbnVlID0gY29udmVydFByb3h5T2JqZWN0VG9SZWFsT2JqZWN0KG5ldyBSZXZlbnVlKCksIHF1ZXVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZXZlbnVlLmNhbGwodGhpcywgcmV2ZW51ZSwgZXZlbnRPcHRpb25zKTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUJyb3dzZXIucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lLCBsYXN0RXZlbnRUaW1lLCB0aW1lU2luY2VMYXN0RXZlbnQ7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgICAgIGxhc3RFdmVudFRpbWUgPSB0aGlzLmNvbmZpZy5sYXN0RXZlbnRUaW1lIHx8IERhdGUubm93KCk7XG4gICAgICAgICAgICAgICAgdGltZVNpbmNlTGFzdEV2ZW50ID0gY3VycmVudFRpbWUgLSBsYXN0RXZlbnRUaW1lO1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5ldmVudF90eXBlICE9PSBERUZBVUxUX1NFU1NJT05fU1RBUlRfRVZFTlQgJiZcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnRfdHlwZSAhPT0gREVGQVVMVF9TRVNTSU9OX0VORF9FVkVOVCAmJlxuICAgICAgICAgICAgICAgICAgICAoIWV2ZW50LnNlc3Npb25faWQgfHwgZXZlbnQuc2Vzc2lvbl9pZCA9PT0gdGhpcy5nZXRTZXNzaW9uSWQoKSkgJiZcbiAgICAgICAgICAgICAgICAgICAgdGltZVNpbmNlTGFzdEV2ZW50ID4gdGhpcy5jb25maWcuc2Vzc2lvblRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZXNzaW9uSWQoY3VycmVudFRpbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgX3N1cGVyLnByb3RvdHlwZS5wcm9jZXNzLmNhbGwodGhpcywgZXZlbnQpXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBBbXBsaXR1ZGVCcm93c2VyO1xufShBbXBsaXR1ZGVDb3JlKSk7XG5leHBvcnQgeyBBbXBsaXR1ZGVCcm93c2VyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1icm93c2VyLWNsaWVudC5qcy5tYXAiLCJpbXBvcnQgeyBfX2Fzc2lnbiwgX19hd2FpdGVyLCBfX2V4dGVuZHMsIF9fZ2VuZXJhdG9yIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBMb2dMZXZlbCwgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy10eXBlcyc7XG5pbXBvcnQgeyBDb25maWcsIExvZ2dlciwgTWVtb3J5U3RvcmFnZSwgVVVJRCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUnO1xuaW1wb3J0IHsgQ29va2llU3RvcmFnZSwgZ2V0Q29va2llTmFtZSwgRmV0Y2hUcmFuc3BvcnQsIGdldFF1ZXJ5UGFyYW1zIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY2xpZW50LWNvbW1vbic7XG5pbXBvcnQgeyBMb2NhbFN0b3JhZ2UgfSBmcm9tICcuL3N0b3JhZ2UvbG9jYWwtc3RvcmFnZSc7XG5pbXBvcnQgeyBTZXNzaW9uU3RvcmFnZSB9IGZyb20gJy4vc3RvcmFnZS9zZXNzaW9uLXN0b3JhZ2UnO1xuaW1wb3J0IHsgWEhSVHJhbnNwb3J0IH0gZnJvbSAnLi90cmFuc3BvcnRzL3hocic7XG5pbXBvcnQgeyBTZW5kQmVhY29uVHJhbnNwb3J0IH0gZnJvbSAnLi90cmFuc3BvcnRzL3NlbmQtYmVhY29uJztcbmltcG9ydCB7IHBhcnNlTGVnYWN5Q29va2llcyB9IGZyb20gJy4vY29va2llLW1pZ3JhdGlvbic7XG5pbXBvcnQgeyBERUZBVUxUX0lERU5USVRZX1NUT1JBR0UsIERFRkFVTFRfU0VSVkVSX1pPTkUgfSBmcm9tICcuL2NvbnN0YW50cyc7XG4vLyBFeHBvcnRlZCBmb3IgdGVzdGluZyBwdXJwb3NlcyBvbmx5LiBEbyBub3QgZXhwb3NlIHRvIHB1YmxpYyBpbnRlcmZhY2UuXG52YXIgQnJvd3NlckNvbmZpZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQnJvd3NlckNvbmZpZywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCcm93c2VyQ29uZmlnKGFwaUtleSwgYXBwVmVyc2lvbiwgY29va2llU3RvcmFnZSwgY29va2llT3B0aW9ucywgZGVmYXVsdFRyYWNraW5nLCBkZXZpY2VJZCwgZmx1c2hJbnRlcnZhbE1pbGxpcywgZmx1c2hNYXhSZXRyaWVzLCBmbHVzaFF1ZXVlU2l6ZSwgaWRlbnRpdHlTdG9yYWdlLCBpbmdlc3Rpb25NZXRhZGF0YSwgaW5zdGFuY2VOYW1lLCBsYXN0RXZlbnRJZCwgbGFzdEV2ZW50VGltZSwgbG9nZ2VyUHJvdmlkZXIsIGxvZ0xldmVsLCBtaW5JZExlbmd0aCwgb3B0T3V0LCBwYXJ0bmVySWQsIHBsYW4sIHNlcnZlclVybCwgc2VydmVyWm9uZSwgc2Vzc2lvbklkLCBzZXNzaW9uVGltZW91dCwgc3RvcmFnZVByb3ZpZGVyLCB0cmFja2luZ09wdGlvbnMsIHRyYW5zcG9ydCwgdXNlQmF0Y2gsIHVzZXJJZCkge1xuICAgICAgICBpZiAoY29va2llU3RvcmFnZSA9PT0gdm9pZCAwKSB7IGNvb2tpZVN0b3JhZ2UgPSBuZXcgTWVtb3J5U3RvcmFnZSgpOyB9XG4gICAgICAgIGlmIChjb29raWVPcHRpb25zID09PSB2b2lkIDApIHsgY29va2llT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGRvbWFpbjogJycsXG4gICAgICAgICAgICBleHBpcmF0aW9uOiAzNjUsXG4gICAgICAgICAgICBzYW1lU2l0ZTogJ0xheCcsXG4gICAgICAgICAgICBzZWN1cmU6IGZhbHNlLFxuICAgICAgICAgICAgdXBncmFkZTogdHJ1ZSxcbiAgICAgICAgfTsgfVxuICAgICAgICBpZiAoZGVmYXVsdFRyYWNraW5nID09PSB2b2lkIDApIHsgZGVmYXVsdFRyYWNraW5nID0gdHJ1ZTsgfVxuICAgICAgICBpZiAoZmx1c2hJbnRlcnZhbE1pbGxpcyA9PT0gdm9pZCAwKSB7IGZsdXNoSW50ZXJ2YWxNaWxsaXMgPSAxMDAwOyB9XG4gICAgICAgIGlmIChmbHVzaE1heFJldHJpZXMgPT09IHZvaWQgMCkgeyBmbHVzaE1heFJldHJpZXMgPSA1OyB9XG4gICAgICAgIGlmIChmbHVzaFF1ZXVlU2l6ZSA9PT0gdm9pZCAwKSB7IGZsdXNoUXVldWVTaXplID0gMzA7IH1cbiAgICAgICAgaWYgKGlkZW50aXR5U3RvcmFnZSA9PT0gdm9pZCAwKSB7IGlkZW50aXR5U3RvcmFnZSA9IERFRkFVTFRfSURFTlRJVFlfU1RPUkFHRTsgfVxuICAgICAgICBpZiAobG9nZ2VyUHJvdmlkZXIgPT09IHZvaWQgMCkgeyBsb2dnZXJQcm92aWRlciA9IG5ldyBMb2dnZXIoKTsgfVxuICAgICAgICBpZiAobG9nTGV2ZWwgPT09IHZvaWQgMCkgeyBsb2dMZXZlbCA9IExvZ0xldmVsLldhcm47IH1cbiAgICAgICAgaWYgKG9wdE91dCA9PT0gdm9pZCAwKSB7IG9wdE91dCA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChzZXJ2ZXJVcmwgPT09IHZvaWQgMCkgeyBzZXJ2ZXJVcmwgPSAnJzsgfVxuICAgICAgICBpZiAoc2VydmVyWm9uZSA9PT0gdm9pZCAwKSB7IHNlcnZlclpvbmUgPSBERUZBVUxUX1NFUlZFUl9aT05FOyB9XG4gICAgICAgIGlmIChzZXNzaW9uVGltZW91dCA9PT0gdm9pZCAwKSB7IHNlc3Npb25UaW1lb3V0ID0gMzAgKiA2MCAqIDEwMDA7IH1cbiAgICAgICAgaWYgKHN0b3JhZ2VQcm92aWRlciA9PT0gdm9pZCAwKSB7IHN0b3JhZ2VQcm92aWRlciA9IG5ldyBMb2NhbFN0b3JhZ2UoeyBsb2dnZXJQcm92aWRlcjogbG9nZ2VyUHJvdmlkZXIgfSk7IH1cbiAgICAgICAgaWYgKHRyYWNraW5nT3B0aW9ucyA9PT0gdm9pZCAwKSB7IHRyYWNraW5nT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGlwQWRkcmVzczogdHJ1ZSxcbiAgICAgICAgICAgIGxhbmd1YWdlOiB0cnVlLFxuICAgICAgICAgICAgcGxhdGZvcm06IHRydWUsXG4gICAgICAgIH07IH1cbiAgICAgICAgaWYgKHRyYW5zcG9ydCA9PT0gdm9pZCAwKSB7IHRyYW5zcG9ydCA9ICdmZXRjaCc7IH1cbiAgICAgICAgaWYgKHVzZUJhdGNoID09PSB2b2lkIDApIHsgdXNlQmF0Y2ggPSBmYWxzZTsgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB7IGFwaUtleTogYXBpS2V5LCBzdG9yYWdlUHJvdmlkZXI6IHN0b3JhZ2VQcm92aWRlciwgdHJhbnNwb3J0UHJvdmlkZXI6IGNyZWF0ZVRyYW5zcG9ydCh0cmFuc3BvcnQpIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICAgICAgX3RoaXMuYXBwVmVyc2lvbiA9IGFwcFZlcnNpb247XG4gICAgICAgIF90aGlzLmNvb2tpZU9wdGlvbnMgPSBjb29raWVPcHRpb25zO1xuICAgICAgICBfdGhpcy5kZWZhdWx0VHJhY2tpbmcgPSBkZWZhdWx0VHJhY2tpbmc7XG4gICAgICAgIF90aGlzLmZsdXNoSW50ZXJ2YWxNaWxsaXMgPSBmbHVzaEludGVydmFsTWlsbGlzO1xuICAgICAgICBfdGhpcy5mbHVzaE1heFJldHJpZXMgPSBmbHVzaE1heFJldHJpZXM7XG4gICAgICAgIF90aGlzLmZsdXNoUXVldWVTaXplID0gZmx1c2hRdWV1ZVNpemU7XG4gICAgICAgIF90aGlzLmlkZW50aXR5U3RvcmFnZSA9IGlkZW50aXR5U3RvcmFnZTtcbiAgICAgICAgX3RoaXMuaW5nZXN0aW9uTWV0YWRhdGEgPSBpbmdlc3Rpb25NZXRhZGF0YTtcbiAgICAgICAgX3RoaXMuaW5zdGFuY2VOYW1lID0gaW5zdGFuY2VOYW1lO1xuICAgICAgICBfdGhpcy5sb2dnZXJQcm92aWRlciA9IGxvZ2dlclByb3ZpZGVyO1xuICAgICAgICBfdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICBfdGhpcy5taW5JZExlbmd0aCA9IG1pbklkTGVuZ3RoO1xuICAgICAgICBfdGhpcy5wYXJ0bmVySWQgPSBwYXJ0bmVySWQ7XG4gICAgICAgIF90aGlzLnBsYW4gPSBwbGFuO1xuICAgICAgICBfdGhpcy5zZXJ2ZXJVcmwgPSBzZXJ2ZXJVcmw7XG4gICAgICAgIF90aGlzLnNlcnZlclpvbmUgPSBzZXJ2ZXJab25lO1xuICAgICAgICBfdGhpcy5zZXNzaW9uVGltZW91dCA9IHNlc3Npb25UaW1lb3V0O1xuICAgICAgICBfdGhpcy5zdG9yYWdlUHJvdmlkZXIgPSBzdG9yYWdlUHJvdmlkZXI7XG4gICAgICAgIF90aGlzLnRyYWNraW5nT3B0aW9ucyA9IHRyYWNraW5nT3B0aW9ucztcbiAgICAgICAgX3RoaXMudHJhbnNwb3J0ID0gdHJhbnNwb3J0O1xuICAgICAgICBfdGhpcy51c2VCYXRjaCA9IHVzZUJhdGNoO1xuICAgICAgICBfdGhpcy5fb3B0T3V0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9jb29raWVTdG9yYWdlID0gY29va2llU3RvcmFnZTtcbiAgICAgICAgX3RoaXMuZGV2aWNlSWQgPSBkZXZpY2VJZDtcbiAgICAgICAgX3RoaXMubGFzdEV2ZW50SWQgPSBsYXN0RXZlbnRJZDtcbiAgICAgICAgX3RoaXMubGFzdEV2ZW50VGltZSA9IGxhc3RFdmVudFRpbWU7XG4gICAgICAgIF90aGlzLm9wdE91dCA9IG9wdE91dDtcbiAgICAgICAgX3RoaXMuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgICAgICBfdGhpcy51c2VySWQgPSB1c2VySWQ7XG4gICAgICAgIF90aGlzLmxvZ2dlclByb3ZpZGVyLmVuYWJsZShfdGhpcy5sb2dMZXZlbCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJyb3dzZXJDb25maWcucHJvdG90eXBlLCBcImNvb2tpZVN0b3JhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb29raWVTdG9yYWdlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChjb29raWVTdG9yYWdlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29va2llU3RvcmFnZSAhPT0gY29va2llU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nvb2tpZVN0b3JhZ2UgPSBjb29raWVTdG9yYWdlO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RvcmFnZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJyb3dzZXJDb25maWcucHJvdG90eXBlLCBcImRldmljZUlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGV2aWNlSWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKGRldmljZUlkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZGV2aWNlSWQgIT09IGRldmljZUlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGV2aWNlSWQgPSBkZXZpY2VJZDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0b3JhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCcm93c2VyQ29uZmlnLnByb3RvdHlwZSwgXCJ1c2VySWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91c2VySWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3VzZXJJZCAhPT0gdXNlcklkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RvcmFnZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJyb3dzZXJDb25maWcucHJvdG90eXBlLCBcInNlc3Npb25JZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Nlc3Npb25JZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoc2Vzc2lvbklkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc2Vzc2lvbklkICE9PSBzZXNzaW9uSWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdG9yYWdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnJvd3NlckNvbmZpZy5wcm90b3R5cGUsIFwib3B0T3V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0T3V0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChvcHRPdXQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vcHRPdXQgIT09IG9wdE91dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdE91dCA9IG9wdE91dDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0b3JhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCcm93c2VyQ29uZmlnLnByb3RvdHlwZSwgXCJsYXN0RXZlbnRUaW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGFzdEV2ZW50VGltZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAobGFzdEV2ZW50VGltZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RFdmVudFRpbWUgIT09IGxhc3RFdmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0RXZlbnRUaW1lID0gbGFzdEV2ZW50VGltZTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0b3JhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCcm93c2VyQ29uZmlnLnByb3RvdHlwZSwgXCJsYXN0RXZlbnRJZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhc3RFdmVudElkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChsYXN0RXZlbnRJZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RFdmVudElkICE9PSBsYXN0RXZlbnRJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RFdmVudElkID0gbGFzdEV2ZW50SWQ7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdG9yYWdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCcm93c2VyQ29uZmlnLnByb3RvdHlwZS51cGRhdGVTdG9yYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2FjaGUgPSB7XG4gICAgICAgICAgICBkZXZpY2VJZDogdGhpcy5fZGV2aWNlSWQsXG4gICAgICAgICAgICB1c2VySWQ6IHRoaXMuX3VzZXJJZCxcbiAgICAgICAgICAgIHNlc3Npb25JZDogdGhpcy5fc2Vzc2lvbklkLFxuICAgICAgICAgICAgb3B0T3V0OiB0aGlzLl9vcHRPdXQsXG4gICAgICAgICAgICBsYXN0RXZlbnRUaW1lOiB0aGlzLl9sYXN0RXZlbnRUaW1lLFxuICAgICAgICAgICAgbGFzdEV2ZW50SWQ6IHRoaXMuX2xhc3RFdmVudElkLFxuICAgICAgICB9O1xuICAgICAgICB2b2lkIHRoaXMuY29va2llU3RvcmFnZS5zZXQoZ2V0Q29va2llTmFtZSh0aGlzLmFwaUtleSksIGNhY2hlKTtcbiAgICB9O1xuICAgIHJldHVybiBCcm93c2VyQ29uZmlnO1xufShDb25maWcpKTtcbmV4cG9ydCB7IEJyb3dzZXJDb25maWcgfTtcbmV4cG9ydCB2YXIgdXNlQnJvd3NlckNvbmZpZyA9IGZ1bmN0aW9uIChhcGlLZXksIG9wdGlvbnMsIGFtcGxpdHVkZUluc3RhbmNlKSB7XG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlkZW50aXR5U3RvcmFnZSwgY29va2llT3B0aW9ucywgX2EsIF9iLCBfYywgY29va2llU3RvcmFnZSwgbGVnYWN5Q29va2llcywgcHJldmlvdXNDb29raWVzLCBxdWVyeVBhcmFtcywgZGV2aWNlSWQsIGxhc3RFdmVudElkLCBsYXN0RXZlbnRUaW1lLCBvcHRPdXQsIHNlc3Npb25JZCwgdXNlcklkLCB0cmFja2luZ09wdGlvbnM7XG4gICAgICAgIHZhciBfZDtcbiAgICAgICAgdmFyIF9lLCBfZiwgX2csIF9oLCBfaiwgX2ssIF9sLCBfbSwgX28sIF9wLCBfcSwgX3IsIF9zLCBfdCwgX3UsIF92LCBfdywgX3gsIF95LCBfeiwgXzAsIF8xLCBfMjtcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfMykge1xuICAgICAgICAgICAgc3dpdGNoIChfMy5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHlTdG9yYWdlID0gb3B0aW9ucy5pZGVudGl0eVN0b3JhZ2UgfHwgREVGQVVMVF9JREVOVElUWV9TVE9SQUdFO1xuICAgICAgICAgICAgICAgICAgICBfYSA9IFtfX2Fzc2lnbih7fSwgb3B0aW9ucy5jb29raWVPcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIF9kID0ge307XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGlkZW50aXR5U3RvcmFnZSAhPT0gREVGQVVMVF9JREVOVElUWV9TVE9SQUdFKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgICAgIF9iID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoKF9mID0gKF9lID0gb3B0aW9ucy5jb29raWVPcHRpb25zKSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UuZG9tYWluKSAhPT0gbnVsbCAmJiBfZiAhPT0gdm9pZCAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgIF9jID0gX2Y7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgZ2V0VG9wTGV2ZWxEb21haW4oKV07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBfYyA9IChfMy5zZW50KCkpO1xuICAgICAgICAgICAgICAgICAgICBfMy5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBfYiA9IF9jO1xuICAgICAgICAgICAgICAgICAgICBfMy5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICBjb29raWVPcHRpb25zID0gX19hc3NpZ24uYXBwbHkodm9pZCAwLCBfYS5jb25jYXQoWyhfZC5kb21haW4gPSBfYiwgX2QuZXhwaXJhdGlvbiA9IDM2NSwgX2Quc2FtZVNpdGUgPSAnTGF4JywgX2Quc2VjdXJlID0gZmFsc2UsIF9kLnVwZ3JhZGUgPSB0cnVlLCBfZCldKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvb2tpZVN0b3JhZ2UgPSBjcmVhdGVDb29raWVTdG9yYWdlKG9wdGlvbnMuaWRlbnRpdHlTdG9yYWdlLCBjb29raWVPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGFyc2VMZWdhY3lDb29raWVzKGFwaUtleSwgY29va2llU3RvcmFnZSwgKF9oID0gKF9nID0gb3B0aW9ucy5jb29raWVPcHRpb25zKSA9PT0gbnVsbCB8fCBfZyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2cudXBncmFkZSkgIT09IG51bGwgJiYgX2ggIT09IHZvaWQgMCA/IF9oIDogdHJ1ZSldO1xuICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgbGVnYWN5Q29va2llcyA9IF8zLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY29va2llU3RvcmFnZS5nZXQoZ2V0Q29va2llTmFtZShhcGlLZXkpKV07XG4gICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c0Nvb2tpZXMgPSBfMy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zID0gZ2V0UXVlcnlQYXJhbXMoKTtcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlSWQgPSAoX20gPSAoX2wgPSAoX2sgPSAoX2ogPSBvcHRpb25zLmRldmljZUlkKSAhPT0gbnVsbCAmJiBfaiAhPT0gdm9pZCAwID8gX2ogOiBxdWVyeVBhcmFtcy5kZXZpY2VJZCkgIT09IG51bGwgJiYgX2sgIT09IHZvaWQgMCA/IF9rIDogcHJldmlvdXNDb29raWVzID09PSBudWxsIHx8IHByZXZpb3VzQ29va2llcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJldmlvdXNDb29raWVzLmRldmljZUlkKSAhPT0gbnVsbCAmJiBfbCAhPT0gdm9pZCAwID8gX2wgOiBsZWdhY3lDb29raWVzLmRldmljZUlkKSAhPT0gbnVsbCAmJiBfbSAhPT0gdm9pZCAwID8gX20gOiBVVUlEKCk7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RFdmVudElkID0gKF9vID0gcHJldmlvdXNDb29raWVzID09PSBudWxsIHx8IHByZXZpb3VzQ29va2llcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJldmlvdXNDb29raWVzLmxhc3RFdmVudElkKSAhPT0gbnVsbCAmJiBfbyAhPT0gdm9pZCAwID8gX28gOiBsZWdhY3lDb29raWVzLmxhc3RFdmVudElkO1xuICAgICAgICAgICAgICAgICAgICBsYXN0RXZlbnRUaW1lID0gKF9wID0gcHJldmlvdXNDb29raWVzID09PSBudWxsIHx8IHByZXZpb3VzQ29va2llcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJldmlvdXNDb29raWVzLmxhc3RFdmVudFRpbWUpICE9PSBudWxsICYmIF9wICE9PSB2b2lkIDAgPyBfcCA6IGxlZ2FjeUNvb2tpZXMubGFzdEV2ZW50VGltZTtcbiAgICAgICAgICAgICAgICAgICAgb3B0T3V0ID0gKF9yID0gKF9xID0gb3B0aW9ucy5vcHRPdXQpICE9PSBudWxsICYmIF9xICE9PSB2b2lkIDAgPyBfcSA6IHByZXZpb3VzQ29va2llcyA9PT0gbnVsbCB8fCBwcmV2aW91c0Nvb2tpZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByZXZpb3VzQ29va2llcy5vcHRPdXQpICE9PSBudWxsICYmIF9yICE9PSB2b2lkIDAgPyBfciA6IGxlZ2FjeUNvb2tpZXMub3B0T3V0O1xuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uSWQgPSAoX3MgPSBwcmV2aW91c0Nvb2tpZXMgPT09IG51bGwgfHwgcHJldmlvdXNDb29raWVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwcmV2aW91c0Nvb2tpZXMuc2Vzc2lvbklkKSAhPT0gbnVsbCAmJiBfcyAhPT0gdm9pZCAwID8gX3MgOiBsZWdhY3lDb29raWVzLnNlc3Npb25JZDtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkID0gKF91ID0gKF90ID0gb3B0aW9ucy51c2VySWQpICE9PSBudWxsICYmIF90ICE9PSB2b2lkIDAgPyBfdCA6IHByZXZpb3VzQ29va2llcyA9PT0gbnVsbCB8fCBwcmV2aW91c0Nvb2tpZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByZXZpb3VzQ29va2llcy51c2VySWQpICE9PSBudWxsICYmIF91ICE9PSB2b2lkIDAgPyBfdSA6IGxlZ2FjeUNvb2tpZXMudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGVJbnN0YW5jZS5wcmV2aW91c1Nlc3Npb25EZXZpY2VJZCA9IChfdiA9IHByZXZpb3VzQ29va2llcyA9PT0gbnVsbCB8fCBwcmV2aW91c0Nvb2tpZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByZXZpb3VzQ29va2llcy5kZXZpY2VJZCkgIT09IG51bGwgJiYgX3YgIT09IHZvaWQgMCA/IF92IDogbGVnYWN5Q29va2llcy5kZXZpY2VJZDtcbiAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlSW5zdGFuY2UucHJldmlvdXNTZXNzaW9uVXNlcklkID0gKF93ID0gcHJldmlvdXNDb29raWVzID09PSBudWxsIHx8IHByZXZpb3VzQ29va2llcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJldmlvdXNDb29raWVzLnVzZXJJZCkgIT09IG51bGwgJiYgX3cgIT09IHZvaWQgMCA/IF93IDogbGVnYWN5Q29va2llcy51c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNraW5nT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlwQWRkcmVzczogKF95ID0gKF94ID0gb3B0aW9ucy50cmFja2luZ09wdGlvbnMpID09PSBudWxsIHx8IF94ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfeC5pcEFkZHJlc3MpICE9PSBudWxsICYmIF95ICE9PSB2b2lkIDAgPyBfeSA6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZTogKF8wID0gKF96ID0gb3B0aW9ucy50cmFja2luZ09wdGlvbnMpID09PSBudWxsIHx8IF96ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfei5sYW5ndWFnZSkgIT09IG51bGwgJiYgXzAgIT09IHZvaWQgMCA/IF8wIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtOiAoXzIgPSAoXzEgPSBvcHRpb25zLnRyYWNraW5nT3B0aW9ucykgPT09IG51bGwgfHwgXzEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF8xLnBsYXRmb3JtKSAhPT0gbnVsbCAmJiBfMiAhPT0gdm9pZCAwID8gXzIgOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IEJyb3dzZXJDb25maWcoYXBpS2V5LCBvcHRpb25zLmFwcFZlcnNpb24sIGNvb2tpZVN0b3JhZ2UsIGNvb2tpZU9wdGlvbnMsIG9wdGlvbnMuZGVmYXVsdFRyYWNraW5nLCBkZXZpY2VJZCwgb3B0aW9ucy5mbHVzaEludGVydmFsTWlsbGlzLCBvcHRpb25zLmZsdXNoTWF4UmV0cmllcywgb3B0aW9ucy5mbHVzaFF1ZXVlU2l6ZSwgaWRlbnRpdHlTdG9yYWdlLCBvcHRpb25zLmluZ2VzdGlvbk1ldGFkYXRhLCBvcHRpb25zLmluc3RhbmNlTmFtZSwgbGFzdEV2ZW50SWQsIGxhc3RFdmVudFRpbWUsIG9wdGlvbnMubG9nZ2VyUHJvdmlkZXIsIG9wdGlvbnMubG9nTGV2ZWwsIG9wdGlvbnMubWluSWRMZW5ndGgsIG9wdE91dCwgb3B0aW9ucy5wYXJ0bmVySWQsIG9wdGlvbnMucGxhbiwgb3B0aW9ucy5zZXJ2ZXJVcmwsIG9wdGlvbnMuc2VydmVyWm9uZSwgc2Vzc2lvbklkLCBvcHRpb25zLnNlc3Npb25UaW1lb3V0LCBvcHRpb25zLnN0b3JhZ2VQcm92aWRlciwgdHJhY2tpbmdPcHRpb25zLCBvcHRpb25zLnRyYW5zcG9ydCwgb3B0aW9ucy51c2VCYXRjaCwgdXNlcklkKV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcbmV4cG9ydCB2YXIgY3JlYXRlQ29va2llU3RvcmFnZSA9IGZ1bmN0aW9uIChpZGVudGl0eVN0b3JhZ2UsIGNvb2tpZU9wdGlvbnMpIHtcbiAgICBpZiAoaWRlbnRpdHlTdG9yYWdlID09PSB2b2lkIDApIHsgaWRlbnRpdHlTdG9yYWdlID0gREVGQVVMVF9JREVOVElUWV9TVE9SQUdFOyB9XG4gICAgaWYgKGNvb2tpZU9wdGlvbnMgPT09IHZvaWQgMCkgeyBjb29raWVPcHRpb25zID0ge307IH1cbiAgICBzd2l0Y2ggKGlkZW50aXR5U3RvcmFnZSkge1xuICAgICAgICBjYXNlICdsb2NhbFN0b3JhZ2UnOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBMb2NhbFN0b3JhZ2UoKTtcbiAgICAgICAgY2FzZSAnc2Vzc2lvblN0b3JhZ2UnOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTZXNzaW9uU3RvcmFnZSgpO1xuICAgICAgICBjYXNlICdub25lJzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgTWVtb3J5U3RvcmFnZSgpO1xuICAgICAgICBjYXNlICdjb29raWUnOlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb29raWVTdG9yYWdlKF9fYXNzaWduKF9fYXNzaWduKHt9LCBjb29raWVPcHRpb25zKSwgeyBleHBpcmF0aW9uRGF5czogY29va2llT3B0aW9ucy5leHBpcmF0aW9uIH0pKTtcbiAgICB9XG59O1xuZXhwb3J0IHZhciBjcmVhdGVUcmFuc3BvcnQgPSBmdW5jdGlvbiAodHJhbnNwb3J0KSB7XG4gICAgaWYgKHRyYW5zcG9ydCA9PT0gJ3hocicpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBYSFJUcmFuc3BvcnQoKTtcbiAgICB9XG4gICAgaWYgKHRyYW5zcG9ydCA9PT0gJ2JlYWNvbicpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZW5kQmVhY29uVHJhbnNwb3J0KCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgRmV0Y2hUcmFuc3BvcnQoKTtcbn07XG5leHBvcnQgdmFyIGdldFRvcExldmVsRG9tYWluID0gZnVuY3Rpb24gKHVybCkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaG9zdCwgcGFydHMsIGxldmVscywgc3RvcmFnZUtleSwgaSwgaSwgZG9tYWluLCBvcHRpb25zLCBzdG9yYWdlLCB2YWx1ZTtcbiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgbmV3IENvb2tpZVN0b3JhZ2UoKS5pc0VuYWJsZWQoKV07XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgaWYgKCEoX2Euc2VudCgpKSB8fCAoIXVybCAmJiB0eXBlb2YgbG9jYXRpb24gPT09ICd1bmRlZmluZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgJyddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBob3N0ID0gdXJsICE9PSBudWxsICYmIHVybCAhPT0gdm9pZCAwID8gdXJsIDogbG9jYXRpb24uaG9zdG5hbWU7XG4gICAgICAgICAgICAgICAgcGFydHMgPSBob3N0LnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgbGV2ZWxzID0gW107XG4gICAgICAgICAgICAgICAgc3RvcmFnZUtleSA9ICdBTVBfVExEVEVTVCc7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gcGFydHMubGVuZ3RoIC0gMjsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWxzLnB1c2gocGFydHMuc2xpY2UoaSkuam9pbignLicpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGlmICghKGkgPCBsZXZlbHMubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgZG9tYWluID0gbGV2ZWxzW2ldO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7IGRvbWFpbjogJy4nICsgZG9tYWluIH07XG4gICAgICAgICAgICAgICAgc3RvcmFnZSA9IG5ldyBDb29raWVTdG9yYWdlKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHN0b3JhZ2Uuc2V0KHN0b3JhZ2VLZXksIDEpXTtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgc3RvcmFnZS5nZXQoc3RvcmFnZUtleSldO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHZhbHVlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHN0b3JhZ2UucmVtb3ZlKHN0b3JhZ2VLZXkpXTtcbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sICcuJyArIGRvbWFpbl07XG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgY2FzZSA3OiByZXR1cm4gWzIgLypyZXR1cm4qLywgJyddO1xuICAgICAgICB9XG4gICAgfSk7XG59KTsgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbmZpZy5qcy5tYXAiLCJleHBvcnQgdmFyIERFRkFVTFRfRVZFTlRfUFJFRklYID0gJ1tBbXBsaXR1ZGVdJztcbmV4cG9ydCB2YXIgREVGQVVMVF9QQUdFX1ZJRVdfRVZFTlQgPSBcIlwiLmNvbmNhdChERUZBVUxUX0VWRU5UX1BSRUZJWCwgXCIgUGFnZSBWaWV3ZWRcIik7XG5leHBvcnQgdmFyIERFRkFVTFRfRk9STV9TVEFSVF9FVkVOVCA9IFwiXCIuY29uY2F0KERFRkFVTFRfRVZFTlRfUFJFRklYLCBcIiBGb3JtIFN0YXJ0ZWRcIik7XG5leHBvcnQgdmFyIERFRkFVTFRfRk9STV9TVUJNSVRfRVZFTlQgPSBcIlwiLmNvbmNhdChERUZBVUxUX0VWRU5UX1BSRUZJWCwgXCIgRm9ybSBTdWJtaXR0ZWRcIik7XG5leHBvcnQgdmFyIERFRkFVTFRfRklMRV9ET1dOTE9BRF9FVkVOVCA9IFwiXCIuY29uY2F0KERFRkFVTFRfRVZFTlRfUFJFRklYLCBcIiBGaWxlIERvd25sb2FkZWRcIik7XG5leHBvcnQgdmFyIERFRkFVTFRfU0VTU0lPTl9TVEFSVF9FVkVOVCA9ICdzZXNzaW9uX3N0YXJ0JztcbmV4cG9ydCB2YXIgREVGQVVMVF9TRVNTSU9OX0VORF9FVkVOVCA9ICdzZXNzaW9uX2VuZCc7XG5leHBvcnQgdmFyIEZJTEVfRVhURU5TSU9OID0gXCJcIi5jb25jYXQoREVGQVVMVF9FVkVOVF9QUkVGSVgsIFwiIEZpbGUgRXh0ZW5zaW9uXCIpO1xuZXhwb3J0IHZhciBGSUxFX05BTUUgPSBcIlwiLmNvbmNhdChERUZBVUxUX0VWRU5UX1BSRUZJWCwgXCIgRmlsZSBOYW1lXCIpO1xuZXhwb3J0IHZhciBMSU5LX0lEID0gXCJcIi5jb25jYXQoREVGQVVMVF9FVkVOVF9QUkVGSVgsIFwiIExpbmsgSURcIik7XG5leHBvcnQgdmFyIExJTktfVEVYVCA9IFwiXCIuY29uY2F0KERFRkFVTFRfRVZFTlRfUFJFRklYLCBcIiBMaW5rIFRleHRcIik7XG5leHBvcnQgdmFyIExJTktfVVJMID0gXCJcIi5jb25jYXQoREVGQVVMVF9FVkVOVF9QUkVGSVgsIFwiIExpbmsgVVJMXCIpO1xuZXhwb3J0IHZhciBGT1JNX0lEID0gXCJcIi5jb25jYXQoREVGQVVMVF9FVkVOVF9QUkVGSVgsIFwiIEZvcm0gSURcIik7XG5leHBvcnQgdmFyIEZPUk1fTkFNRSA9IFwiXCIuY29uY2F0KERFRkFVTFRfRVZFTlRfUFJFRklYLCBcIiBGb3JtIE5hbWVcIik7XG5leHBvcnQgdmFyIEZPUk1fREVTVElOQVRJT04gPSBcIlwiLmNvbmNhdChERUZBVUxUX0VWRU5UX1BSRUZJWCwgXCIgRm9ybSBEZXN0aW5hdGlvblwiKTtcbmV4cG9ydCB2YXIgREVGQVVMVF9JREVOVElUWV9TVE9SQUdFID0gJ2Nvb2tpZSc7XG5leHBvcnQgdmFyIERFRkFVTFRfU0VSVkVSX1pPTkUgPSAnVVMnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uc3RhbnRzLmpzLm1hcCIsImltcG9ydCB7IF9fYXdhaXRlciwgX19nZW5lcmF0b3IsIF9fcmVhZCB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgZ2V0T2xkQ29va2llTmFtZSB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24nO1xuZXhwb3J0IHZhciBwYXJzZUxlZ2FjeUNvb2tpZXMgPSBmdW5jdGlvbiAoYXBpS2V5LCBjb29raWVTdG9yYWdlLCBkZWxldGVMZWdhY3lDb29raWVzKSB7XG4gICAgaWYgKGRlbGV0ZUxlZ2FjeUNvb2tpZXMgPT09IHZvaWQgMCkgeyBkZWxldGVMZWdhY3lDb29raWVzID0gdHJ1ZTsgfVxuICAgIHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29va2llTmFtZSwgY29va2llcywgX2EsIGRldmljZUlkLCB1c2VySWQsIG9wdE91dCwgc2Vzc2lvbklkLCBsYXN0RXZlbnRUaW1lLCBsYXN0RXZlbnRJZDtcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY29va2llTmFtZSA9IGdldE9sZENvb2tpZU5hbWUoYXBpS2V5KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY29va2llU3RvcmFnZS5nZXRSYXcoY29va2llTmFtZSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgY29va2llcyA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb29raWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRPdXQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghZGVsZXRlTGVnYWN5Q29va2llcykgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNvb2tpZVN0b3JhZ2UucmVtb3ZlKGNvb2tpZU5hbWUpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBfX3JlYWQoY29va2llcy5zcGxpdCgnLicpLCA2KSwgZGV2aWNlSWQgPSBfYVswXSwgdXNlcklkID0gX2FbMV0sIG9wdE91dCA9IF9hWzJdLCBzZXNzaW9uSWQgPSBfYVszXSwgbGFzdEV2ZW50VGltZSA9IF9hWzRdLCBsYXN0RXZlbnRJZCA9IF9hWzVdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZUlkOiBkZXZpY2VJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGRlY29kZSh1c2VySWQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlc3Npb25JZDogcGFyc2VUaW1lKHNlc3Npb25JZCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEV2ZW50SWQ6IHBhcnNlVGltZShsYXN0RXZlbnRJZCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEV2ZW50VGltZTogcGFyc2VUaW1lKGxhc3RFdmVudFRpbWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdE91dDogQm9vbGVhbihvcHRPdXQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcbmV4cG9ydCB2YXIgcGFyc2VUaW1lID0gZnVuY3Rpb24gKG51bSkge1xuICAgIHZhciBpbnRlZ2VyID0gcGFyc2VJbnQobnVtLCAzMik7XG4gICAgaWYgKGlzTmFOKGludGVnZXIpKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBpbnRlZ2VyO1xufTtcbmV4cG9ydCB2YXIgZGVjb2RlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgaWYgKCFhdG9iIHx8ICFlc2NhcGUgfHwgIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGF0b2IodmFsdWUpKSk7XG4gICAgfVxuICAgIGNhdGNoIChfYSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgeyBpc1Nlc3Npb25UcmFja2luZ0VuYWJsZWQsIGlzRmlsZURvd25sb2FkVHJhY2tpbmdFbmFibGVkLCBpc0Zvcm1JbnRlcmFjdGlvblRyYWNraW5nRW5hYmxlZCwgaXNQYWdlVmlld1RyYWNraW5nRW5hYmxlZCwgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uJztcbmltcG9ydCB7IExvZ0xldmVsIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtdHlwZXMnO1xudmFyIG5vdGlmaWVkID0gZmFsc2U7XG5leHBvcnQgdmFyIGRldE5vdGlmeSA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICBpZiAobm90aWZpZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgZW5hYmxlZFRyYWNraW5nID0gW1xuICAgICAgICBpc1BhZ2VWaWV3VHJhY2tpbmdFbmFibGVkKGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcpID8gJ1BhZ2UgVmlld3MnIDogJycsXG4gICAgICAgIGlzU2Vzc2lvblRyYWNraW5nRW5hYmxlZChjb25maWcuZGVmYXVsdFRyYWNraW5nKSA/ICdTZXNzaW9ucycgOiAnJyxcbiAgICAgICAgaXNGaWxlRG93bmxvYWRUcmFja2luZ0VuYWJsZWQoY29uZmlnLmRlZmF1bHRUcmFja2luZykgPyAnRmlsZSBEb3dubG9hZHMnIDogJycsXG4gICAgICAgIGlzRm9ybUludGVyYWN0aW9uVHJhY2tpbmdFbmFibGVkKGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcpID8gJ0Zvcm0gSW50ZXJhY3Rpb25zJyA6ICcnLFxuICAgIF0uZmlsdGVyKEJvb2xlYW4pO1xuICAgIHZhciBlbmFibGVkVHJhY2tpbmdTdHJpbmcgPSBlbmFibGVkVHJhY2tpbmcuam9pbignLCAnKTtcbiAgICBpZiAoZW5hYmxlZFRyYWNraW5nLmxlbmd0aCkge1xuICAgICAgICB2YXIgbWVzc2FnZSA9IFwiWW91ciBBbXBsaXR1ZGUgaW5zdGFuY2UgaXMgY29uZmlndXJlZCB0byB0cmFjayBcIi5jb25jYXQoZW5hYmxlZFRyYWNraW5nU3RyaW5nLCBcIi4gVmlzaXQgaHR0cHM6Ly93d3cuZG9jcy5kZXZlbG9wZXJzLmFtcGxpdHVkZS5jb20vZGF0YS9zZGtzL2Jyb3dzZXItMi8jdHJhY2tpbmctZGVmYXVsdC1ldmVudHMgZm9yIG1vcmUgZGV0YWlscy5cIik7XG4gICAgICAgIGNvbmZpZy5sb2dnZXJQcm92aWRlci5sb2cobWVzc2FnZSk7XG4gICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICBpZiAoY29uZmlnLmxvZ0xldmVsIDwgTG9nTGV2ZWwuVmVyYm9zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbm90aWZpZWQgPSB0cnVlO1xufTtcbi8qKlxuICogQHByaXZhdGVcbiAqIFRoaXMgZnVuY3Rpb24gaXMgbWVhbnQgZm9yIHRlc3RpbmcgcHVycG9zZXMgb25seVxuICovXG5leHBvcnQgdmFyIHJlc2V0Tm90aWZ5ID0gZnVuY3Rpb24gKCkge1xuICAgIG5vdGlmaWVkID0gZmFsc2U7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGV0LW5vdGlmaWNhdGlvbi5qcy5tYXAiLCIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2QgKi9cbmltcG9ydCBjbGllbnQgZnJvbSAnLi9icm93c2VyLWNsaWVudC1mYWN0b3J5JztcbmV4cG9ydCB7IGNyZWF0ZUluc3RhbmNlIH0gZnJvbSAnLi9icm93c2VyLWNsaWVudC1mYWN0b3J5JztcbmV4cG9ydCB2YXIgYWRkID0gY2xpZW50LmFkZCwgZXh0ZW5kU2Vzc2lvbiA9IGNsaWVudC5leHRlbmRTZXNzaW9uLCBmbHVzaCA9IGNsaWVudC5mbHVzaCwgZ2V0RGV2aWNlSWQgPSBjbGllbnQuZ2V0RGV2aWNlSWQsIGdldFNlc3Npb25JZCA9IGNsaWVudC5nZXRTZXNzaW9uSWQsIGdldFVzZXJJZCA9IGNsaWVudC5nZXRVc2VySWQsIGdyb3VwSWRlbnRpZnkgPSBjbGllbnQuZ3JvdXBJZGVudGlmeSwgaWRlbnRpZnkgPSBjbGllbnQuaWRlbnRpZnksIGluaXQgPSBjbGllbnQuaW5pdCwgbG9nRXZlbnQgPSBjbGllbnQubG9nRXZlbnQsIHJlbW92ZSA9IGNsaWVudC5yZW1vdmUsIHJlc2V0ID0gY2xpZW50LnJlc2V0LCByZXZlbnVlID0gY2xpZW50LnJldmVudWUsIHNldERldmljZUlkID0gY2xpZW50LnNldERldmljZUlkLCBzZXRHcm91cCA9IGNsaWVudC5zZXRHcm91cCwgc2V0T3B0T3V0ID0gY2xpZW50LnNldE9wdE91dCwgc2V0U2Vzc2lvbklkID0gY2xpZW50LnNldFNlc3Npb25JZCwgc2V0VHJhbnNwb3J0ID0gY2xpZW50LnNldFRyYW5zcG9ydCwgc2V0VXNlcklkID0gY2xpZW50LnNldFVzZXJJZCwgdHJhY2sgPSBjbGllbnQudHJhY2s7XG5leHBvcnQgeyBydW5RdWV1ZWRGdW5jdGlvbnMgfSBmcm9tICcuL3V0aWxzL3NuaXBwZXQtaGVscGVyJztcbmV4cG9ydCB7IFJldmVudWUsIElkZW50aWZ5IH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZSc7XG5pbXBvcnQgKiBhcyBUeXBlc18xIGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzJztcbmV4cG9ydCB7IFR5cGVzXzEgYXMgVHlwZXMgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImltcG9ydCB7IF9fYXNzaWduLCBfX2F3YWl0ZXIsIF9fZ2VuZXJhdG9yIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBVVUlEIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZSc7XG5pbXBvcnQgeyBnZXRMYW5ndWFnZSB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24nO1xuaW1wb3J0IHsgVkVSU0lPTiB9IGZyb20gJy4uL3ZlcnNpb24nO1xudmFyIEJST1dTRVJfUExBVEZPUk0gPSAnV2ViJztcbnZhciBJUF9BRERSRVNTID0gJyRyZW1vdGUnO1xudmFyIENvbnRleHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29udGV4dCgpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gJ0BhbXBsaXR1ZGUvcGx1Z2luLWNvbnRleHQtYnJvd3Nlcic7XG4gICAgICAgIHRoaXMudHlwZSA9ICdiZWZvcmUnO1xuICAgICAgICB0aGlzLmxpYnJhcnkgPSBcImFtcGxpdHVkZS10cy9cIi5jb25jYXQoVkVSU0lPTik7XG4gICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdGhpcy51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgICAgICB9XG4gICAgfVxuICAgIENvbnRleHQucHJvdG90eXBlLnNldHVwID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgIH07XG4gICAgQ29udGV4dC5wcm90b3R5cGUuZXhlY3V0ZSA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aW1lLCBsYXN0RXZlbnRJZCwgbmV4dEV2ZW50SWQsIGV2ZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICBsYXN0RXZlbnRJZCA9IChfYSA9IHRoaXMuY29uZmlnLmxhc3RFdmVudElkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAtMTtcbiAgICAgICAgICAgICAgICBuZXh0RXZlbnRJZCA9IChfYiA9IGNvbnRleHQuZXZlbnRfaWQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IGxhc3RFdmVudElkICsgMTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sYXN0RXZlbnRJZCA9IG5leHRFdmVudElkO1xuICAgICAgICAgICAgICAgIGlmICghY29udGV4dC50aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxhc3RFdmVudFRpbWUgPSB0aW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBldmVudCA9IF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKF9fYXNzaWduKHsgdXNlcl9pZDogdGhpcy5jb25maWcudXNlcklkLCBkZXZpY2VfaWQ6IHRoaXMuY29uZmlnLmRldmljZUlkLCBzZXNzaW9uX2lkOiB0aGlzLmNvbmZpZy5zZXNzaW9uSWQsIHRpbWU6IHRpbWUgfSwgKHRoaXMuY29uZmlnLmFwcFZlcnNpb24gJiYgeyBhcHBfdmVyc2lvbjogdGhpcy5jb25maWcuYXBwVmVyc2lvbiB9KSksICh0aGlzLmNvbmZpZy50cmFja2luZ09wdGlvbnMucGxhdGZvcm0gJiYgeyBwbGF0Zm9ybTogQlJPV1NFUl9QTEFURk9STSB9KSksICh0aGlzLmNvbmZpZy50cmFja2luZ09wdGlvbnMubGFuZ3VhZ2UgJiYgeyBsYW5ndWFnZTogZ2V0TGFuZ3VhZ2UoKSB9KSksICh0aGlzLmNvbmZpZy50cmFja2luZ09wdGlvbnMuaXBBZGRyZXNzICYmIHsgaXA6IElQX0FERFJFU1MgfSkpLCB7IGluc2VydF9pZDogVVVJRCgpLCBwYXJ0bmVyX2lkOiB0aGlzLmNvbmZpZy5wYXJ0bmVySWQsIHBsYW46IHRoaXMuY29uZmlnLnBsYW4gfSksICh0aGlzLmNvbmZpZy5pbmdlc3Rpb25NZXRhZGF0YSAmJiB7XG4gICAgICAgICAgICAgICAgICAgIGluZ2VzdGlvbl9tZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlX25hbWU6IHRoaXMuY29uZmlnLmluZ2VzdGlvbk1ldGFkYXRhLnNvdXJjZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfdmVyc2lvbjogdGhpcy5jb25maWcuaW5nZXN0aW9uTWV0YWRhdGEuc291cmNlVmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KSksIGNvbnRleHQpLCB7IGV2ZW50X2lkOiBuZXh0RXZlbnRJZCwgbGlicmFyeTogdGhpcy5saWJyYXJ5LCB1c2VyX2FnZW50OiB0aGlzLnVzZXJBZ2VudCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZXZlbnRdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIENvbnRleHQ7XG59KCkpO1xuZXhwb3J0IHsgQ29udGV4dCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udGV4dC5qcy5tYXAiLCJpbXBvcnQgeyBfX2F3YWl0ZXIsIF9fZ2VuZXJhdG9yIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBERUZBVUxUX0ZJTEVfRE9XTkxPQURfRVZFTlQsIEZJTEVfRVhURU5TSU9OLCBGSUxFX05BTUUsIExJTktfSUQsIExJTktfVEVYVCwgTElOS19VUkwgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuZXhwb3J0IHZhciBmaWxlRG93bmxvYWRUcmFja2luZyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb2JzZXJ2ZXI7XG4gICAgdmFyIGV2ZW50TGlzdGVuZXJzID0gW107XG4gICAgdmFyIGFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgdHlwZSwgaGFuZGxlcikge1xuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlcik7XG4gICAgICAgIGV2ZW50TGlzdGVuZXJzLnB1c2goe1xuICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICBoYW5kbGVyOiBoYW5kbGVyLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHZhciByZW1vdmVDbGlja0xpc3RlbmVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gX2EuZWxlbWVudCwgdHlwZSA9IF9hLnR5cGUsIGhhbmRsZXIgPSBfYS5oYW5kbGVyO1xuICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICAgICAgICAgIGVsZW1lbnQgPT09IG51bGwgfHwgZWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbiAgICB9O1xuICAgIHZhciBuYW1lID0gJ0BhbXBsaXR1ZGUvcGx1Z2luLWZpbGUtZG93bmxvYWQtdHJhY2tpbmctYnJvd3Nlcic7XG4gICAgdmFyIHR5cGUgPSAnZW5yaWNobWVudCc7XG4gICAgdmFyIHNldHVwID0gZnVuY3Rpb24gKGNvbmZpZywgYW1wbGl0dWRlKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYWRkRmlsZURvd25sb2FkTGlzdGVuZXIsIGV4dCwgbGlua3M7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICAgICAgaWYgKCFhbXBsaXR1ZGUpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBBZGQgcmVxdWlyZWQgbWluaW11bSB2ZXJzaW9uIG9mIEBhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXJcbiAgICAgICAgICAgICAgICBjb25maWcubG9nZ2VyUHJvdmlkZXIud2FybignRmlsZSBkb3dubG9hZCB0cmFja2luZyByZXF1aXJlcyBhIGxhdGVyIHZlcnNpb24gb2YgQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3Nlci4gRmlsZSBkb3dubG9hZCBldmVudHMgYXJlIG5vdCB0cmFja2VkLicpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRGaWxlRG93bmxvYWRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVybDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgICAgICAgICAgICAgICAgIHVybCA9IG5ldyBVUkwoYS5ocmVmLCB3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBleHQuZXhlYyh1cmwuaHJlZik7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGVFeHRlbnNpb24gPSByZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXN1bHRbMV07XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcihhLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUV4dGVuc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZS50cmFjayhERUZBVUxUX0ZJTEVfRE9XTkxPQURfRVZFTlQsIChfYSA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYVtGSUxFX0VYVEVOU0lPTl0gPSBmaWxlRXh0ZW5zaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYVtGSUxFX05BTUVdID0gdXJsLnBhdGhuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYVtMSU5LX0lEXSA9IGEuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hW0xJTktfVEVYVF0gPSBhLnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hW0xJTktfVVJMXSA9IGEuaHJlZixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGV4dCA9IC9cXC4ocGRmfHhsc3g/fGRvY3g/fHR4dHxydGZ8Y3N2fGV4ZXxrZXl8cHAoc3x0fHR4KXw3enxwa2d8cmFyfGd6fHppcHxhdml8bW92fG1wNHxtcGU/Z3x3bXZ8bWlkaT98bXAzfHdhdnx3bWEpJC87XG4gICAgICAgICAgICBsaW5rcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2EnKSk7XG4gICAgICAgICAgICBsaW5rcy5mb3JFYWNoKGFkZEZpbGVEb3dubG9hZExpc3RlbmVyKTtcbiAgICAgICAgICAgIC8vIEFkZHMgbGlzdGVuZXIgdG8gYW5jaG9yIHRhZ3MgYWRkZWQgYWZ0ZXIgaW5pdGlhbCBsb2FkXG4gICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBNdXRhdGlvbk9ic2VydmVyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5vZGVOYW1lID09PSAnQScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkRmlsZURvd25sb2FkTGlzdGVuZXIobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgncXVlcnlTZWxlY3RvckFsbCcgaW4gbm9kZSAmJiB0eXBlb2Ygbm9kZS5xdWVyeVNlbGVjdG9yQWxsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20obm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdhJykpLm1hcChhZGRGaWxlRG93bmxvYWRMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuICAgICAgICAgICAgICAgICAgICBzdWJ0cmVlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgIH0pO1xuICAgIH0pOyB9O1xuICAgIHZhciBleGVjdXRlID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBldmVudF07XG4gICAgfSk7IH0pOyB9O1xuICAgIHZhciB0ZWFyZG93biA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIG9ic2VydmVyID09PSBudWxsIHx8IG9ic2VydmVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICByZW1vdmVDbGlja0xpc3RlbmVycygpO1xuICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICB9KTtcbiAgICB9KTsgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICBzZXR1cDogc2V0dXAsXG4gICAgICAgIGV4ZWN1dGU6IGV4ZWN1dGUsXG4gICAgICAgIHRlYXJkb3duOiB0ZWFyZG93bixcbiAgICB9O1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpbGUtZG93bmxvYWQtdHJhY2tpbmcuanMubWFwIiwiaW1wb3J0IHsgX19hd2FpdGVyLCBfX2dlbmVyYXRvciB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgREVGQVVMVF9GT1JNX1NUQVJUX0VWRU5ULCBERUZBVUxUX0ZPUk1fU1VCTUlUX0VWRU5ULCBGT1JNX0lELCBGT1JNX05BTUUsIEZPUk1fREVTVElOQVRJT04sIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmV4cG9ydCB2YXIgZm9ybUludGVyYWN0aW9uVHJhY2tpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9ic2VydmVyO1xuICAgIHZhciBldmVudExpc3RlbmVycyA9IFtdO1xuICAgIHZhciBhZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGVsZW1lbnQsIHR5cGUsIGhhbmRsZXIpIHtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGhhbmRsZXIpO1xuICAgICAgICBldmVudExpc3RlbmVycy5wdXNoKHtcbiAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgaGFuZGxlcjogaGFuZGxlcixcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB2YXIgcmVtb3ZlQ2xpY2tMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGV2ZW50TGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IF9hLmVsZW1lbnQsIHR5cGUgPSBfYS50eXBlLCBoYW5kbGVyID0gX2EuaGFuZGxlcjtcbiAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICAgICAgICBlbGVtZW50ID09PSBudWxsIHx8IGVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50TGlzdGVuZXJzID0gW107XG4gICAgfTtcbiAgICB2YXIgbmFtZSA9ICdAYW1wbGl0dWRlL3BsdWdpbi1mb3JtLWludGVyYWN0aW9uLXRyYWNraW5nLWJyb3dzZXInO1xuICAgIHZhciB0eXBlID0gJ2VucmljaG1lbnQnO1xuICAgIHZhciBzZXR1cCA9IGZ1bmN0aW9uIChjb25maWcsIGFtcGxpdHVkZSkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFkZEZvcm1JbnRlcmFjdGlvbkxpc3RlbmVyLCBmb3JtcztcbiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICAgICAgICBpZiAoIWFtcGxpdHVkZSkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IEFkZCByZXF1aXJlZCBtaW5pbXVtIHZlcnNpb24gb2YgQGFtcGxpdHVkZS9hbmFseXRpY3MtYnJvd3NlclxuICAgICAgICAgICAgICAgIGNvbmZpZy5sb2dnZXJQcm92aWRlci53YXJuKCdGb3JtIGludGVyYWN0aW9uIHRyYWNraW5nIHJlcXVpcmVzIGEgbGF0ZXIgdmVyc2lvbiBvZiBAYW1wbGl0dWRlL2FuYWx5dGljcy1icm93c2VyLiBGb3JtIGludGVyYWN0aW9uIGV2ZW50cyBhcmUgbm90IHRyYWNrZWQuJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZEZvcm1JbnRlcmFjdGlvbkxpc3RlbmVyID0gZnVuY3Rpb24gKGZvcm0pIHtcbiAgICAgICAgICAgICAgICB2YXIgaGFzRm9ybUNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGZvcm0sICdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNGb3JtQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlLnRyYWNrKERFRkFVTFRfRk9STV9TVEFSVF9FVkVOVCwgKF9hID0ge30sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FbRk9STV9JRF0gPSBmb3JtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hW0ZPUk1fTkFNRV0gPSBmb3JtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FbRk9STV9ERVNUSU5BVElPTl0gPSBmb3JtLmFjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGhhc0Zvcm1DaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBhZGRFdmVudExpc3RlbmVyKGZvcm0sICdzdWJtaXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaGFzRm9ybUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZS50cmFjayhERUZBVUxUX0ZPUk1fU1RBUlRfRVZFTlQsIChfYSA9IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hW0ZPUk1fSURdID0gZm9ybS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYVtGT1JNX05BTUVdID0gZm9ybS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hW0ZPUk1fREVTVElOQVRJT05dID0gZm9ybS5hY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGUudHJhY2soREVGQVVMVF9GT1JNX1NVQk1JVF9FVkVOVCwgKF9iID0ge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBfYltGT1JNX0lEXSA9IGZvcm0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBfYltGT1JNX05BTUVdID0gZm9ybS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgX2JbRk9STV9ERVNUSU5BVElPTl0gPSBmb3JtLmFjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iKSk7XG4gICAgICAgICAgICAgICAgICAgIGhhc0Zvcm1DaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9ybXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdmb3JtJykpO1xuICAgICAgICAgICAgZm9ybXMuZm9yRWFjaChhZGRGb3JtSW50ZXJhY3Rpb25MaXN0ZW5lcik7XG4gICAgICAgICAgICAvLyBBZGRzIGxpc3RlbmVyIHRvIGFuY2hvciB0YWdzIGFkZGVkIGFmdGVyIGluaXRpYWwgbG9hZFxuICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgICAgICAgICAgIGlmICh0eXBlb2YgTXV0YXRpb25PYnNlcnZlciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG11dGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5ub2RlTmFtZSA9PT0gJ0ZPUk0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEZvcm1JbnRlcmFjdGlvbkxpc3RlbmVyKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ3F1ZXJ5U2VsZWN0b3JBbGwnIGluIG5vZGUgJiYgdHlwZW9mIG5vZGUucXVlcnlTZWxlY3RvckFsbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5mcm9tKG5vZGUucXVlcnlTZWxlY3RvckFsbCgnZm9ybScpKS5tYXAoYWRkRm9ybUludGVyYWN0aW9uTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcbiAgICAgICAgICAgICAgICAgICAgc3VidHJlZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICB9KTtcbiAgICB9KTsgfTtcbiAgICB2YXIgZXhlY3V0ZSA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZXZlbnRdO1xuICAgIH0pOyB9KTsgfTtcbiAgICB2YXIgdGVhcmRvd24gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBvYnNlcnZlciA9PT0gbnVsbCB8fCBvYnNlcnZlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgcmVtb3ZlQ2xpY2tMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgfSk7XG4gICAgfSk7IH07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgc2V0dXA6IHNldHVwLFxuICAgICAgICBleGVjdXRlOiBleGVjdXRlLFxuICAgICAgICB0ZWFyZG93bjogdGVhcmRvd24sXG4gICAgfTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mb3JtLWludGVyYWN0aW9uLXRyYWNraW5nLmpzLm1hcCIsImltcG9ydCB7IF9fYXdhaXRlciwgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbnZhciBCcm93c2VyU3RvcmFnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCcm93c2VyU3RvcmFnZShzdG9yYWdlKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgfVxuICAgIEJyb3dzZXJTdG9yYWdlLnByb3RvdHlwZS5pc0VuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByYW5kb20sIHRlc3RTdG9yYWdlLCB0ZXN0S2V5LCB2YWx1ZSwgX2E7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdG9yYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGZhbHNlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbSA9IFN0cmluZyhEYXRlLm5vdygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RTdG9yYWdlID0gbmV3IEJyb3dzZXJTdG9yYWdlKHRoaXMuc3RvcmFnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXN0S2V5ID0gJ0FNUF9URVNUJztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCA0LCA1LCA3XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0ZXN0U3RvcmFnZS5zZXQodGVzdEtleSwgcmFuZG9tKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRlc3RTdG9yYWdlLmdldCh0ZXN0S2V5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHZhbHVlID09PSByYW5kb21dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZmFsc2VdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRlc3RTdG9yYWdlLnJlbW92ZSh0ZXN0S2V5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEJyb3dzZXJTdG9yYWdlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSwgX2E7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50cnlzLnB1c2goWzAsIDIsICwgM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5nZXRSYXcoa2V5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB1bmRlZmluZWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgSlNPTi5wYXJzZSh2YWx1ZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJbQW1wbGl0dWRlXSBFcnJvcjogQ291bGQgbm90IGdldCB2YWx1ZSBmcm9tIHN0b3JhZ2VcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdW5kZWZpbmVkXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQnJvd3NlclN0b3JhZ2UucHJvdG90eXBlLmdldFJhdyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sICgoX2EgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRJdGVtKGtleSkpIHx8IHVuZGVmaW5lZF07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBCcm93c2VyU3RvcmFnZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgKF9hID0gdGhpcy5zdG9yYWdlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfYykge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBCcm93c2VyU3RvcmFnZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAoX2EgPSB0aGlzLnN0b3JhZ2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yZW1vdmVJdGVtKGtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfYykge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBCcm93c2VyU3RvcmFnZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIChfYSA9IHRoaXMuc3RvcmFnZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfYykge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQnJvd3NlclN0b3JhZ2U7XG59KCkpO1xuZXhwb3J0IHsgQnJvd3NlclN0b3JhZ2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJyb3dzZXItc3RvcmFnZS5qcy5tYXAiLCJpbXBvcnQgeyBfX2F3YWl0ZXIsIF9fZXh0ZW5kcywgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdldEdsb2JhbFNjb3BlIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY2xpZW50LWNvbW1vbic7XG5pbXBvcnQgeyBCcm93c2VyU3RvcmFnZSB9IGZyb20gJy4vYnJvd3Nlci1zdG9yYWdlJztcbnZhciBNQVhfQVJSQVlfTEVOR1RIID0gMTAwMDtcbnZhciBMb2NhbFN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExvY2FsU3RvcmFnZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMb2NhbFN0b3JhZ2UoY29uZmlnKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCAoX2EgPSBnZXRHbG9iYWxTY29wZSgpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubG9jYWxTdG9yYWdlKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5sb2dnZXJQcm92aWRlciA9IGNvbmZpZyA9PT0gbnVsbCB8fCBjb25maWcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbmZpZy5sb2dnZXJQcm92aWRlcjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBMb2NhbFN0b3JhZ2UucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRyb3BwZWRFdmVudHNDb3VudDtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA+IE1BWF9BUlJBWV9MRU5HVEgpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BwZWRFdmVudHNDb3VudCA9IHZhbHVlLmxlbmd0aCAtIE1BWF9BUlJBWV9MRU5HVEg7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBfc3VwZXIucHJvdG90eXBlLnNldC5jYWxsKHRoaXMsIGtleSwgdmFsdWUuc2xpY2UoMCwgTUFYX0FSUkFZX0xFTkdUSCkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgKF9hID0gdGhpcy5sb2dnZXJQcm92aWRlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVycm9yKFwiRmFpbGVkIHRvIHNhdmUgXCIuY29uY2F0KGRyb3BwZWRFdmVudHNDb3VudCwgXCIgZXZlbnRzIGJlY2F1c2UgdGhlIHF1ZXVlIGxlbmd0aCBleGNlZWRlZCBcIikuY29uY2F0KE1BWF9BUlJBWV9MRU5HVEgsIFwiLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzQgLyp5aWVsZCovLCBfc3VwZXIucHJvdG90eXBlLnNldC5jYWxsKHRoaXMsIGtleSwgdmFsdWUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gTG9jYWxTdG9yYWdlO1xufShCcm93c2VyU3RvcmFnZSkpO1xuZXhwb3J0IHsgTG9jYWxTdG9yYWdlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sb2NhbC1zdG9yYWdlLmpzLm1hcCIsImltcG9ydCB7IF9fZXh0ZW5kcyB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgZ2V0R2xvYmFsU2NvcGUgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uJztcbmltcG9ydCB7IEJyb3dzZXJTdG9yYWdlIH0gZnJvbSAnLi9icm93c2VyLXN0b3JhZ2UnO1xudmFyIFNlc3Npb25TdG9yYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZXNzaW9uU3RvcmFnZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZXNzaW9uU3RvcmFnZSgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgKF9hID0gZ2V0R2xvYmFsU2NvcGUoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlc3Npb25TdG9yYWdlKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gU2Vzc2lvblN0b3JhZ2U7XG59KEJyb3dzZXJTdG9yYWdlKSk7XG5leHBvcnQgeyBTZXNzaW9uU3RvcmFnZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2Vzc2lvbi1zdG9yYWdlLmpzLm1hcCIsImltcG9ydCB7IF9fYXdhaXRlciwgX19leHRlbmRzLCBfX2dlbmVyYXRvciB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgZ2V0R2xvYmFsU2NvcGUgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jbGllbnQtY29tbW9uJztcbmltcG9ydCB7IEJhc2VUcmFuc3BvcnQgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jb3JlJztcbnZhciBTZW5kQmVhY29uVHJhbnNwb3J0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZW5kQmVhY29uVHJhbnNwb3J0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlbmRCZWFjb25UcmFuc3BvcnQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2VuZEJlYWNvblRyYW5zcG9ydC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChzZXJ2ZXJVcmwsIHBheWxvYWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdsb2JhbFNjb3BlID0gZ2V0R2xvYmFsU2NvcGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZ2xvYmFsU2NvcGUgPT09IG51bGwgfHwgZ2xvYmFsU2NvcGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdsb2JhbFNjb3BlLm5hdmlnYXRvci5zZW5kQmVhY29uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2VuZEJlYWNvblRyYW5zcG9ydCBpcyBub3Qgc3VwcG9ydGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5zdHJpbmdpZnkocGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSBnbG9iYWxTY29wZS5uYXZpZ2F0b3Iuc2VuZEJlYWNvbihzZXJ2ZXJVcmwsIEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShfdGhpcy5idWlsZFJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50c19pbmdlc3RlZDogcGF5bG9hZC5ldmVudHMubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bG9hZF9zaXplX2J5dGVzOiBkYXRhLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlcl91cGxvYWRfdGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShfdGhpcy5idWlsZFJlc3BvbnNlKHsgY29kZTogNTAwIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU2VuZEJlYWNvblRyYW5zcG9ydDtcbn0oQmFzZVRyYW5zcG9ydCkpO1xuZXhwb3J0IHsgU2VuZEJlYWNvblRyYW5zcG9ydCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VuZC1iZWFjb24uanMubWFwIiwiaW1wb3J0IHsgX19hd2FpdGVyLCBfX2V4dGVuZHMsIF9fZ2VuZXJhdG9yIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBCYXNlVHJhbnNwb3J0IH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZSc7XG52YXIgWEhSVHJhbnNwb3J0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhYSFJUcmFuc3BvcnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gWEhSVHJhbnNwb3J0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBkb25lOiA0LFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFhIUlRyYW5zcG9ydC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChzZXJ2ZXJVcmwsIHBheWxvYWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ1hIUlRyYW5zcG9ydCBpcyBub3Qgc3VwcG9ydGVkLicpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vcGVuKCdQT1NUJywgc2VydmVyVXJsLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSBfdGhpcy5zdGF0ZS5kb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VQYXlsb2FkID0geGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJzZWRSZXNwb25zZVBheWxvYWQgPSBKU09OLnBhcnNlKHJlc3BvbnNlUGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gX3RoaXMuYnVpbGRSZXNwb25zZShwYXJzZWRSZXNwb25zZVBheWxvYWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJyovKicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNlbmQoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpO1xuICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gWEhSVHJhbnNwb3J0O1xufShCYXNlVHJhbnNwb3J0KSk7XG5leHBvcnQgeyBYSFJUcmFuc3BvcnQgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXhoci5qcy5tYXAiLCIvKipcbiAqIEFwcGxpZXMgdGhlIHByb3hpZWQgZnVuY3Rpb25zIG9uIHRoZSBwcm94aWVkIGFtcGxpdHVkZSBzbmlwcGV0IHRvIGFuIGluc3RhbmNlIG9mIHRoZSByZWFsIG9iamVjdC5cbiAqIEBpZ25vcmVcbiAqL1xuZXhwb3J0IHZhciBydW5RdWV1ZWRGdW5jdGlvbnMgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIHF1ZXVlKSB7XG4gICAgY29udmVydFByb3h5T2JqZWN0VG9SZWFsT2JqZWN0KGluc3RhbmNlLCBxdWV1ZSk7XG59O1xuLyoqXG4gKiBBcHBsaWVzIHRoZSBwcm94aWVkIGZ1bmN0aW9ucyBvbiB0aGUgcHJveGllZCBvYmplY3QgdG8gYW4gaW5zdGFuY2Ugb2YgdGhlIHJlYWwgb2JqZWN0LlxuICogVXNlZCB0byBjb252ZXJ0IHByb3hpZWQgSWRlbnRpZnkgYW5kIFJldmVudWUgb2JqZWN0cy5cbiAqL1xuZXhwb3J0IHZhciBjb252ZXJ0UHJveHlPYmplY3RUb1JlYWxPYmplY3QgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIHF1ZXVlKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgX2EgPSBxdWV1ZVtpXSwgbmFtZV8xID0gX2EubmFtZSwgYXJncyA9IF9hLmFyZ3MsIHJlc29sdmUgPSBfYS5yZXNvbHZlO1xuICAgICAgICB2YXIgZm4gPSBpbnN0YW5jZSAmJiBpbnN0YW5jZVtuYW1lXzFdO1xuICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gZm4uYXBwbHkoaW5zdGFuY2UsIGFyZ3MpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiByZXNvbHZlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXN1bHQucHJvbWlzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluc3RhbmNlO1xufTtcbi8qKlxuICogQ2hlY2sgaWYgdGhlIHBhcmFtIGlzIHNuaXBwZXQgcHJveHlcbiAqL1xuZXhwb3J0IHZhciBpc0luc3RhbmNlUHJveHkgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICB2YXIgaW5zdGFuY2VQcm94eSA9IGluc3RhbmNlO1xuICAgIHJldHVybiBpbnN0YW5jZVByb3h5ICYmIGluc3RhbmNlUHJveHkuX3EgIT09IHVuZGVmaW5lZDtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbmlwcGV0LWhlbHBlci5qcy5tYXAiLCJleHBvcnQgdmFyIFZFUlNJT04gPSAnMi4yLjAnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmVyc2lvbi5qcy5tYXAiLCJpbXBvcnQgeyBBbmFseXRpY3NDb25uZWN0b3IgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy1jb25uZWN0b3InO1xuZXhwb3J0IHZhciBnZXRBbmFseXRpY3NDb25uZWN0b3IgPSBmdW5jdGlvbiAoaW5zdGFuY2VOYW1lKSB7XG4gICAgaWYgKGluc3RhbmNlTmFtZSA9PT0gdm9pZCAwKSB7IGluc3RhbmNlTmFtZSA9ICckZGVmYXVsdF9pbnN0YW5jZSc7IH1cbiAgICByZXR1cm4gQW5hbHl0aWNzQ29ubmVjdG9yLmdldEluc3RhbmNlKGluc3RhbmNlTmFtZSk7XG59O1xuZXhwb3J0IHZhciBzZXRDb25uZWN0b3JVc2VySWQgPSBmdW5jdGlvbiAodXNlcklkLCBpbnN0YW5jZU5hbWUpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGdldEFuYWx5dGljc0Nvbm5lY3RvcihpbnN0YW5jZU5hbWUpLmlkZW50aXR5U3RvcmUuZWRpdElkZW50aXR5KCkuc2V0VXNlcklkKHVzZXJJZCkuY29tbWl0KCk7XG59O1xuZXhwb3J0IHZhciBzZXRDb25uZWN0b3JEZXZpY2VJZCA9IGZ1bmN0aW9uIChkZXZpY2VJZCwgaW5zdGFuY2VOYW1lKSB7XG4gICAgZ2V0QW5hbHl0aWNzQ29ubmVjdG9yKGluc3RhbmNlTmFtZSkuaWRlbnRpdHlTdG9yZS5lZGl0SWRlbnRpdHkoKS5zZXREZXZpY2VJZChkZXZpY2VJZCkuY29tbWl0KCk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5hbHl0aWNzLWNvbm5lY3Rvci5qcy5tYXAiLCJpbXBvcnQgeyBfX2Fzc2lnbiwgX19hd2FpdGVyLCBfX2dlbmVyYXRvciB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgZ2V0UXVlcnlQYXJhbXMgfSBmcm9tICcuLi9xdWVyeS1wYXJhbXMnO1xuaW1wb3J0IHsgVVRNX0NBTVBBSUdOLCBVVE1fQ09OVEVOVCwgVVRNX01FRElVTSwgVVRNX1NPVVJDRSwgVVRNX1RFUk0sIEdDTElELCBGQkNMSUQsIEJBU0VfQ0FNUEFJR04sIERDTElELCBNU0NMS0lELCBSRFRfQ0lELCBUV0NMSUQsIFRUQ0xJRCwgS09fQ0xJQ0tfSUQsIExJX0ZBVF9JRCwgR0JSQUlELCBXQlJBSUQsIFVUTV9JRCwgfSBmcm9tICcuL2NvbnN0YW50cyc7XG52YXIgQ2FtcGFpZ25QYXJzZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25QYXJzZXIoKSB7XG4gICAgfVxuICAgIENhbXBhaWduUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbihfX2Fzc2lnbih7fSwgQkFTRV9DQU1QQUlHTiksIHRoaXMuZ2V0VXRtUGFyYW0oKSksIHRoaXMuZ2V0UmVmZXJyZXIoKSksIHRoaXMuZ2V0Q2xpY2tJZHMoKSldO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ2FtcGFpZ25QYXJzZXIucHJvdG90eXBlLmdldFV0bVBhcmFtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyYW1zID0gZ2V0UXVlcnlQYXJhbXMoKTtcbiAgICAgICAgdmFyIHV0bUNhbXBhaWduID0gcGFyYW1zW1VUTV9DQU1QQUlHTl07XG4gICAgICAgIHZhciB1dG1Db250ZW50ID0gcGFyYW1zW1VUTV9DT05URU5UXTtcbiAgICAgICAgdmFyIHV0bUlkID0gcGFyYW1zW1VUTV9JRF07XG4gICAgICAgIHZhciB1dG1NZWRpdW0gPSBwYXJhbXNbVVRNX01FRElVTV07XG4gICAgICAgIHZhciB1dG1Tb3VyY2UgPSBwYXJhbXNbVVRNX1NPVVJDRV07XG4gICAgICAgIHZhciB1dG1UZXJtID0gcGFyYW1zW1VUTV9URVJNXTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHV0bV9jYW1wYWlnbjogdXRtQ2FtcGFpZ24sXG4gICAgICAgICAgICB1dG1fY29udGVudDogdXRtQ29udGVudCxcbiAgICAgICAgICAgIHV0bV9pZDogdXRtSWQsXG4gICAgICAgICAgICB1dG1fbWVkaXVtOiB1dG1NZWRpdW0sXG4gICAgICAgICAgICB1dG1fc291cmNlOiB1dG1Tb3VyY2UsXG4gICAgICAgICAgICB1dG1fdGVybTogdXRtVGVybSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIENhbXBhaWduUGFyc2VyLnByb3RvdHlwZS5nZXRSZWZlcnJlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICByZWZlcnJlcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgcmVmZXJyaW5nX2RvbWFpbjogdW5kZWZpbmVkLFxuICAgICAgICB9O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZGF0YS5yZWZlcnJlciA9IGRvY3VtZW50LnJlZmVycmVyIHx8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGRhdGEucmVmZXJyaW5nX2RvbWFpbiA9IChfYiA9IChfYSA9IGRhdGEucmVmZXJyZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zcGxpdCgnLycpWzJdKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKF9jKSB7XG4gICAgICAgICAgICAvLyBub3RoaW5nIHRvIHRyYWNrXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfTtcbiAgICBDYW1wYWlnblBhcnNlci5wcm90b3R5cGUuZ2V0Q2xpY2tJZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIHBhcmFtcyA9IGdldFF1ZXJ5UGFyYW1zKCk7XG4gICAgICAgIHJldHVybiBfYSA9IHt9LFxuICAgICAgICAgICAgX2FbRENMSURdID0gcGFyYW1zW0RDTElEXSxcbiAgICAgICAgICAgIF9hW0ZCQ0xJRF0gPSBwYXJhbXNbRkJDTElEXSxcbiAgICAgICAgICAgIF9hW0dCUkFJRF0gPSBwYXJhbXNbR0JSQUlEXSxcbiAgICAgICAgICAgIF9hW0dDTElEXSA9IHBhcmFtc1tHQ0xJRF0sXG4gICAgICAgICAgICBfYVtLT19DTElDS19JRF0gPSBwYXJhbXNbS09fQ0xJQ0tfSURdLFxuICAgICAgICAgICAgX2FbTElfRkFUX0lEXSA9IHBhcmFtc1tMSV9GQVRfSURdLFxuICAgICAgICAgICAgX2FbTVNDTEtJRF0gPSBwYXJhbXNbTVNDTEtJRF0sXG4gICAgICAgICAgICBfYVtSRFRfQ0lEXSA9IHBhcmFtc1tSRFRfQ0lEXSxcbiAgICAgICAgICAgIF9hW1RUQ0xJRF0gPSBwYXJhbXNbVFRDTElEXSxcbiAgICAgICAgICAgIF9hW1RXQ0xJRF0gPSBwYXJhbXNbVFdDTElEXSxcbiAgICAgICAgICAgIF9hW1dCUkFJRF0gPSBwYXJhbXNbV0JSQUlEXSxcbiAgICAgICAgICAgIF9hO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduUGFyc2VyO1xufSgpKTtcbmV4cG9ydCB7IENhbXBhaWduUGFyc2VyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYW1wYWlnbi1wYXJzZXIuanMubWFwIiwiZXhwb3J0IHZhciBVVE1fQ0FNUEFJR04gPSAndXRtX2NhbXBhaWduJztcbmV4cG9ydCB2YXIgVVRNX0NPTlRFTlQgPSAndXRtX2NvbnRlbnQnO1xuZXhwb3J0IHZhciBVVE1fSUQgPSAndXRtX2lkJztcbmV4cG9ydCB2YXIgVVRNX01FRElVTSA9ICd1dG1fbWVkaXVtJztcbmV4cG9ydCB2YXIgVVRNX1NPVVJDRSA9ICd1dG1fc291cmNlJztcbmV4cG9ydCB2YXIgVVRNX1RFUk0gPSAndXRtX3Rlcm0nO1xuZXhwb3J0IHZhciBEQ0xJRCA9ICdkY2xpZCc7XG5leHBvcnQgdmFyIEZCQ0xJRCA9ICdmYmNsaWQnO1xuZXhwb3J0IHZhciBHQlJBSUQgPSAnZ2JyYWlkJztcbmV4cG9ydCB2YXIgR0NMSUQgPSAnZ2NsaWQnO1xuZXhwb3J0IHZhciBLT19DTElDS19JRCA9ICdrb19jbGlja19pZCc7XG5leHBvcnQgdmFyIExJX0ZBVF9JRCA9ICdsaV9mYXRfaWQnO1xuZXhwb3J0IHZhciBNU0NMS0lEID0gJ21zY2xraWQnO1xuZXhwb3J0IHZhciBSRFRfQ0lEID0gJ3J0ZF9jaWQnO1xuZXhwb3J0IHZhciBUVENMSUQgPSAndHRjbGlkJztcbmV4cG9ydCB2YXIgVFdDTElEID0gJ3R3Y2xpZCc7XG5leHBvcnQgdmFyIFdCUkFJRCA9ICd3YnJhaWQnO1xuZXhwb3J0IHZhciBFTVBUWV9WQUxVRSA9ICdFTVBUWSc7XG5leHBvcnQgdmFyIEJBU0VfQ0FNUEFJR04gPSB7XG4gICAgdXRtX2NhbXBhaWduOiB1bmRlZmluZWQsXG4gICAgdXRtX2NvbnRlbnQ6IHVuZGVmaW5lZCxcbiAgICB1dG1faWQ6IHVuZGVmaW5lZCxcbiAgICB1dG1fbWVkaXVtOiB1bmRlZmluZWQsXG4gICAgdXRtX3NvdXJjZTogdW5kZWZpbmVkLFxuICAgIHV0bV90ZXJtOiB1bmRlZmluZWQsXG4gICAgcmVmZXJyZXI6IHVuZGVmaW5lZCxcbiAgICByZWZlcnJpbmdfZG9tYWluOiB1bmRlZmluZWQsXG4gICAgZGNsaWQ6IHVuZGVmaW5lZCxcbiAgICBnYnJhaWQ6IHVuZGVmaW5lZCxcbiAgICBnY2xpZDogdW5kZWZpbmVkLFxuICAgIGZiY2xpZDogdW5kZWZpbmVkLFxuICAgIGtvX2NsaWNrX2lkOiB1bmRlZmluZWQsXG4gICAgbGlfZmF0X2lkOiB1bmRlZmluZWQsXG4gICAgbXNjbGtpZDogdW5kZWZpbmVkLFxuICAgIHJ0ZF9jaWQ6IHVuZGVmaW5lZCxcbiAgICB0dGNsaWQ6IHVuZGVmaW5lZCxcbiAgICB0d2NsaWQ6IHVuZGVmaW5lZCxcbiAgICB3YnJhaWQ6IHVuZGVmaW5lZCxcbn07XG5leHBvcnQgdmFyIE1LVEcgPSAnTUtURyc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25zdGFudHMuanMubWFwIiwiaW1wb3J0IHsgQU1QTElUVURFX1BSRUZJWCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUnO1xuZXhwb3J0IHZhciBnZXRDb29raWVOYW1lID0gZnVuY3Rpb24gKGFwaUtleSwgcG9zdEtleSwgbGltaXQpIHtcbiAgICBpZiAocG9zdEtleSA9PT0gdm9pZCAwKSB7IHBvc3RLZXkgPSAnJzsgfVxuICAgIGlmIChsaW1pdCA9PT0gdm9pZCAwKSB7IGxpbWl0ID0gMTA7IH1cbiAgICByZXR1cm4gW0FNUExJVFVERV9QUkVGSVgsIHBvc3RLZXksIGFwaUtleS5zdWJzdHJpbmcoMCwgbGltaXQpXS5maWx0ZXIoQm9vbGVhbikuam9pbignXycpO1xufTtcbmV4cG9ydCB2YXIgZ2V0T2xkQ29va2llTmFtZSA9IGZ1bmN0aW9uIChhcGlLZXkpIHtcbiAgICByZXR1cm4gXCJcIi5jb25jYXQoQU1QTElUVURFX1BSRUZJWC50b0xvd2VyQ2FzZSgpLCBcIl9cIikuY29uY2F0KGFwaUtleS5zdWJzdHJpbmcoMCwgNikpO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvb2tpZS1uYW1lLmpzLm1hcCIsImltcG9ydCB7IF9fYXNzaWduIH0gZnJvbSBcInRzbGliXCI7XG4vKipcbiAqIFJldHVybnMgZmFsc2UgaWYgZGVmYXVsdFRyYWNraW5nID09PSBmYWxzZSBvciBpZiBkZWZhdWx0VHJhY2tpbmdbZXZlbnRdLFxuICogb3RoZXJ3aXNlIHJldHVybnMgdHJ1ZVxuICovXG52YXIgaXNUcmFja2luZ0VuYWJsZWQgPSBmdW5jdGlvbiAoZGVmYXVsdFRyYWNraW5nLCBldmVudCkge1xuICAgIGlmICh0eXBlb2YgZGVmYXVsdFRyYWNraW5nID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRUcmFja2luZztcbiAgICB9XG4gICAgaWYgKChkZWZhdWx0VHJhY2tpbmcgPT09IG51bGwgfHwgZGVmYXVsdFRyYWNraW5nID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZWZhdWx0VHJhY2tpbmdbZXZlbnRdKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5leHBvcnQgdmFyIGlzQXR0cmlidXRpb25UcmFja2luZ0VuYWJsZWQgPSBmdW5jdGlvbiAoZGVmYXVsdFRyYWNraW5nKSB7XG4gICAgcmV0dXJuIGlzVHJhY2tpbmdFbmFibGVkKGRlZmF1bHRUcmFja2luZywgJ2F0dHJpYnV0aW9uJyk7XG59O1xuZXhwb3J0IHZhciBpc0ZpbGVEb3dubG9hZFRyYWNraW5nRW5hYmxlZCA9IGZ1bmN0aW9uIChkZWZhdWx0VHJhY2tpbmcpIHtcbiAgICByZXR1cm4gaXNUcmFja2luZ0VuYWJsZWQoZGVmYXVsdFRyYWNraW5nLCAnZmlsZURvd25sb2FkcycpO1xufTtcbmV4cG9ydCB2YXIgaXNGb3JtSW50ZXJhY3Rpb25UcmFja2luZ0VuYWJsZWQgPSBmdW5jdGlvbiAoZGVmYXVsdFRyYWNraW5nKSB7XG4gICAgcmV0dXJuIGlzVHJhY2tpbmdFbmFibGVkKGRlZmF1bHRUcmFja2luZywgJ2Zvcm1JbnRlcmFjdGlvbnMnKTtcbn07XG5leHBvcnQgdmFyIGlzUGFnZVZpZXdUcmFja2luZ0VuYWJsZWQgPSBmdW5jdGlvbiAoZGVmYXVsdFRyYWNraW5nKSB7XG4gICAgcmV0dXJuIGlzVHJhY2tpbmdFbmFibGVkKGRlZmF1bHRUcmFja2luZywgJ3BhZ2VWaWV3cycpO1xufTtcbmV4cG9ydCB2YXIgaXNTZXNzaW9uVHJhY2tpbmdFbmFibGVkID0gZnVuY3Rpb24gKGRlZmF1bHRUcmFja2luZykge1xuICAgIHJldHVybiBpc1RyYWNraW5nRW5hYmxlZChkZWZhdWx0VHJhY2tpbmcsICdzZXNzaW9ucycpO1xufTtcbmV4cG9ydCB2YXIgZ2V0UGFnZVZpZXdUcmFja2luZ0NvbmZpZyA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICB2YXIgdHJhY2tPbiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgIHZhciB0cmFja0hpc3RvcnlDaGFuZ2VzID0gdW5kZWZpbmVkO1xuICAgIHZhciBldmVudFR5cGU7XG4gICAgdmFyIGlzRGVmYXVsdFBhZ2VWaWV3VHJhY2tpbmdFbmFibGVkID0gaXNQYWdlVmlld1RyYWNraW5nRW5hYmxlZChjb25maWcuZGVmYXVsdFRyYWNraW5nKTtcbiAgICBpZiAoaXNEZWZhdWx0UGFnZVZpZXdUcmFja2luZ0VuYWJsZWQpIHtcbiAgICAgICAgdHJhY2tPbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgZXZlbnRUeXBlID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoY29uZmlnLmRlZmF1bHRUcmFja2luZyAmJlxuICAgICAgICAgICAgdHlwZW9mIGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcgPT09ICdvYmplY3QnICYmXG4gICAgICAgICAgICBjb25maWcuZGVmYXVsdFRyYWNraW5nLnBhZ2VWaWV3cyAmJlxuICAgICAgICAgICAgdHlwZW9mIGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcucGFnZVZpZXdzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgaWYgKCd0cmFja09uJyBpbiBjb25maWcuZGVmYXVsdFRyYWNraW5nLnBhZ2VWaWV3cykge1xuICAgICAgICAgICAgICAgIHRyYWNrT24gPSBjb25maWcuZGVmYXVsdFRyYWNraW5nLnBhZ2VWaWV3cy50cmFja09uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCd0cmFja0hpc3RvcnlDaGFuZ2VzJyBpbiBjb25maWcuZGVmYXVsdFRyYWNraW5nLnBhZ2VWaWV3cykge1xuICAgICAgICAgICAgICAgIHRyYWNrSGlzdG9yeUNoYW5nZXMgPSBjb25maWcuZGVmYXVsdFRyYWNraW5nLnBhZ2VWaWV3cy50cmFja0hpc3RvcnlDaGFuZ2VzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCdldmVudFR5cGUnIGluIGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcucGFnZVZpZXdzICYmIGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcucGFnZVZpZXdzLmV2ZW50VHlwZSkge1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSA9IGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcucGFnZVZpZXdzLmV2ZW50VHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB0cmFja09uOiB0cmFja09uLFxuICAgICAgICB0cmFja0hpc3RvcnlDaGFuZ2VzOiB0cmFja0hpc3RvcnlDaGFuZ2VzLFxuICAgICAgICBldmVudFR5cGU6IGV2ZW50VHlwZSxcbiAgICB9O1xufTtcbmV4cG9ydCB2YXIgZ2V0QXR0cmlidXRpb25UcmFja2luZ0NvbmZpZyA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICBpZiAoaXNBdHRyaWJ1dGlvblRyYWNraW5nRW5hYmxlZChjb25maWcuZGVmYXVsdFRyYWNraW5nKSAmJlxuICAgICAgICBjb25maWcuZGVmYXVsdFRyYWNraW5nICYmXG4gICAgICAgIHR5cGVvZiBjb25maWcuZGVmYXVsdFRyYWNraW5nID09PSAnb2JqZWN0JyAmJlxuICAgICAgICBjb25maWcuZGVmYXVsdFRyYWNraW5nLmF0dHJpYnV0aW9uICYmXG4gICAgICAgIHR5cGVvZiBjb25maWcuZGVmYXVsdFRyYWNraW5nLmF0dHJpYnV0aW9uID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gX19hc3NpZ24oe30sIGNvbmZpZy5kZWZhdWx0VHJhY2tpbmcuYXR0cmlidXRpb24pO1xuICAgIH1cbiAgICByZXR1cm4ge307XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVmYXVsdC10cmFja2luZy5qcy5tYXAiLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qIE9ubHkgZmlsZSBhbGxvd2VkIHRvIGFjY2VzcyB0byBnbG9iYWxUaGlzLCB3aW5kb3csIHNlbGYgKi9cbmV4cG9ydCB2YXIgZ2V0R2xvYmFsU2NvcGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gZ2xvYmFsVGhpcztcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiB3aW5kb3c7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gZ2xvYmFsO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdsb2JhbC1zY29wZS5qcy5tYXAiLCJleHBvcnQgdmFyIGdldExhbmd1YWdlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgIHJldHVybiAnJztcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzXG4gICAgdmFyIHVzZXJMYW5ndWFnZSA9IG5hdmlnYXRvci51c2VyTGFuZ3VhZ2U7XG4gICAgcmV0dXJuIChfZCA9IChfYyA9IChfYiA9IChfYSA9IG5hdmlnYXRvci5sYW5ndWFnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVswXSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogbmF2aWdhdG9yLmxhbmd1YWdlKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiB1c2VyTGFuZ3VhZ2UpICE9PSBudWxsICYmIF9kICE9PSB2b2lkIDAgPyBfZCA6ICcnO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxhbmd1YWdlLmpzLm1hcCIsImltcG9ydCB7IF9fYXdhaXRlciwgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdldEFuYWx5dGljc0Nvbm5lY3RvciB9IGZyb20gJy4uL2FuYWx5dGljcy1jb25uZWN0b3InO1xudmFyIElkZW50aXR5RXZlbnRTZW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSWRlbnRpdHlFdmVudFNlbmRlcigpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gJ2lkZW50aXR5JztcbiAgICAgICAgdGhpcy50eXBlID0gJ2JlZm9yZSc7XG4gICAgICAgIHRoaXMuaWRlbnRpdHlTdG9yZSA9IGdldEFuYWx5dGljc0Nvbm5lY3RvcigpLmlkZW50aXR5U3RvcmU7XG4gICAgfVxuICAgIElkZW50aXR5RXZlbnRTZW5kZXIucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXNlclByb3BlcnRpZXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdXNlclByb3BlcnRpZXMgPSBjb250ZXh0LnVzZXJfcHJvcGVydGllcztcbiAgICAgICAgICAgICAgICBpZiAodXNlclByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pZGVudGl0eVN0b3JlLmVkaXRJZGVudGl0eSgpLnVwZGF0ZVVzZXJQcm9wZXJ0aWVzKHVzZXJQcm9wZXJ0aWVzKS5jb21taXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGNvbnRleHRdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSWRlbnRpdHlFdmVudFNlbmRlci5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmluc3RhbmNlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlkZW50aXR5U3RvcmUgPSBnZXRBbmFseXRpY3NDb25uZWN0b3IoY29uZmlnLmluc3RhbmNlTmFtZSkuaWRlbnRpdHlTdG9yZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIElkZW50aXR5RXZlbnRTZW5kZXI7XG59KCkpO1xuZXhwb3J0IHsgSWRlbnRpdHlFdmVudFNlbmRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aWRlbnRpdHkuanMubWFwIiwiaW1wb3J0IHsgZ2V0R2xvYmFsU2NvcGUgfSBmcm9tICcuL2dsb2JhbC1zY29wZSc7XG5leHBvcnQgdmFyIGdldFF1ZXJ5UGFyYW1zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYTtcbiAgICB2YXIgZ2xvYmFsU2NvcGUgPSBnZXRHbG9iYWxTY29wZSgpO1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgIGlmICghKChfYSA9IGdsb2JhbFNjb3BlID09PSBudWxsIHx8IGdsb2JhbFNjb3BlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBnbG9iYWxTY29wZS5sb2NhdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlYXJjaCkpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICB2YXIgcGFpcnMgPSBnbG9iYWxTY29wZS5sb2NhdGlvbi5zZWFyY2guc3Vic3RyaW5nKDEpLnNwbGl0KCcmJykuZmlsdGVyKEJvb2xlYW4pO1xuICAgIHZhciBwYXJhbXMgPSBwYWlycy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgY3Vycikge1xuICAgICAgICB2YXIgcXVlcnkgPSBjdXJyLnNwbGl0KCc9JywgMik7XG4gICAgICAgIHZhciBrZXkgPSB0cnlEZWNvZGVVUklDb21wb25lbnQocXVlcnlbMF0pO1xuICAgICAgICB2YXIgdmFsdWUgPSB0cnlEZWNvZGVVUklDb21wb25lbnQocXVlcnlbMV0pO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9XG4gICAgICAgIGFjY1trZXldID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuICAgIHJldHVybiBwYXJhbXM7XG59O1xuZXhwb3J0IHZhciB0cnlEZWNvZGVVUklDb21wb25lbnQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChfYSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXF1ZXJ5LXBhcmFtcy5qcy5tYXAiLCJpbXBvcnQgeyBfX2Fzc2lnbiwgX19hd2FpdGVyLCBfX2dlbmVyYXRvciB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgZ2V0R2xvYmFsU2NvcGUgfSBmcm9tICcuLi9nbG9iYWwtc2NvcGUnO1xudmFyIENvb2tpZVN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29va2llU3RvcmFnZShvcHRpb25zKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IF9fYXNzaWduKHt9LCBvcHRpb25zKTtcbiAgICB9XG4gICAgQ29va2llU3RvcmFnZS5wcm90b3R5cGUuaXNFbmFibGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGVzdFN0cm9yYWdlLCB0ZXN0S2V5LCB2YWx1ZSwgX2E7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZ2V0R2xvYmFsU2NvcGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBmYWxzZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBDb29raWVTdG9yYWdlLnRlc3RWYWx1ZSA9IFN0cmluZyhEYXRlLm5vdygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RTdHJvcmFnZSA9IG5ldyBDb29raWVTdG9yYWdlKHRoaXMub3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXN0S2V5ID0gJ0FNUF9URVNUJztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCA0LCA1LCA3XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0ZXN0U3Ryb3JhZ2Uuc2V0KHRlc3RLZXksIENvb2tpZVN0b3JhZ2UudGVzdFZhbHVlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRlc3RTdHJvcmFnZS5nZXQodGVzdEtleSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB2YWx1ZSA9PT0gQ29va2llU3RvcmFnZS50ZXN0VmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZmFsc2VdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRlc3RTdHJvcmFnZS5yZW1vdmUodGVzdEtleSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDb29raWVTdG9yYWdlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5nZXRSYXcoa2V5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB1bmRlZmluZWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChhdG9iKHZhbHVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChfYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YWx1ZSBub3QgZW5jb2RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1yZXR1cm5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgSlNPTi5wYXJzZSh2YWx1ZSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKF9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdW5kZWZpbmVkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDb29raWVTdG9yYWdlLnByb3RvdHlwZS5nZXRSYXcgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBnbG9iYWxTY29wZSwgY29va2llLCBtYXRjaDtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxTY29wZSA9IGdldEdsb2JhbFNjb3BlKCk7XG4gICAgICAgICAgICAgICAgY29va2llID0gKF9iID0gKF9hID0gZ2xvYmFsU2NvcGUgPT09IG51bGwgfHwgZ2xvYmFsU2NvcGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdsb2JhbFNjb3BlLmRvY3VtZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY29va2llLnNwbGl0KCc7ICcpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBbXTtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IGNvb2tpZS5maW5kKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjLmluZGV4T2Yoa2V5ICsgJz0nKSA9PT0gMDsgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdW5kZWZpbmVkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG1hdGNoLnN1YnN0cmluZyhrZXkubGVuZ3RoICsgMSldO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ29va2llU3RvcmFnZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZXhwaXJhdGlvbkRheXMsIGV4cGlyZXMsIGV4cGlyZURhdGUsIGRhdGUsIHN0ciwgZ2xvYmFsU2NvcGU7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJhdGlvbkRheXMgPSAoX2EgPSB0aGlzLm9wdGlvbnMuZXhwaXJhdGlvbkRheXMpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IDA7XG4gICAgICAgICAgICAgICAgICAgIGV4cGlyZXMgPSB2YWx1ZSAhPT0gbnVsbCA/IGV4cGlyYXRpb25EYXlzIDogLTE7XG4gICAgICAgICAgICAgICAgICAgIGV4cGlyZURhdGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHBpcmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIGV4cGlyZXMgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZURhdGUgPSBkYXRlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IFwiXCIuY29uY2F0KGtleSwgXCI9XCIpLmNvbmNhdChidG9hKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh2YWx1ZSkpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHBpcmVEYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gXCI7IGV4cGlyZXM9XCIuY29uY2F0KGV4cGlyZURhdGUudG9VVENTdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICc7IHBhdGg9Lyc7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZG9tYWluKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gXCI7IGRvbWFpbj1cIi5jb25jYXQodGhpcy5vcHRpb25zLmRvbWFpbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWN1cmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnOyBTZWN1cmUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2FtZVNpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSBcIjsgU2FtZVNpdGU9XCIuY29uY2F0KHRoaXMub3B0aW9ucy5zYW1lU2l0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2NvcGUgPSBnZXRHbG9iYWxTY29wZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsU2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNjb3BlLmRvY3VtZW50LmNvb2tpZSA9IHN0cjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoX2MpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ29va2llU3RvcmFnZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc2V0KGtleSwgbnVsbCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQ29va2llU3RvcmFnZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29va2llU3RvcmFnZTtcbn0oKSk7XG5leHBvcnQgeyBDb29raWVTdG9yYWdlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb29raWUuanMubWFwIiwiaW1wb3J0IHsgX19hd2FpdGVyLCBfX2V4dGVuZHMsIF9fZ2VuZXJhdG9yIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBCYXNlVHJhbnNwb3J0IH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY29yZSc7XG52YXIgRmV0Y2hUcmFuc3BvcnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZldGNoVHJhbnNwb3J0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZldGNoVHJhbnNwb3J0KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZldGNoVHJhbnNwb3J0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKHNlcnZlclVybCwgcGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucywgcmVzcG9uc2UsIHJlc3BvbnNlUGF5bG9hZDtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmZXRjaCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZldGNoVHJhbnNwb3J0IGlzIG5vdCBzdXBwb3J0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBY2NlcHQ6ICcqLyonLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2goc2VydmVyVXJsLCBvcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzcG9uc2UuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VQYXlsb2FkID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuYnVpbGRSZXNwb25zZShyZXNwb25zZVBheWxvYWQpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gRmV0Y2hUcmFuc3BvcnQ7XG59KEJhc2VUcmFuc3BvcnQpKTtcbmV4cG9ydCB7IEZldGNoVHJhbnNwb3J0IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mZXRjaC5qcy5tYXAiLCJ2YXIgQXBwbGljYXRpb25Db250ZXh0UHJvdmlkZXJJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uQ29udGV4dFByb3ZpZGVySW1wbCgpIHtcbiAgICB9XG4gICAgQXBwbGljYXRpb25Db250ZXh0UHJvdmlkZXJJbXBsLnByb3RvdHlwZS5nZXRBcHBsaWNhdGlvbkNvbnRleHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2ZXJzaW9uTmFtZTogdGhpcy52ZXJzaW9uTmFtZSxcbiAgICAgICAgICAgIGxhbmd1YWdlOiBnZXRMYW5ndWFnZSgpLFxuICAgICAgICAgICAgcGxhdGZvcm06ICdXZWInLFxuICAgICAgICAgICAgb3M6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGRldmljZU1vZGVsOiB1bmRlZmluZWQsXG4gICAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gQXBwbGljYXRpb25Db250ZXh0UHJvdmlkZXJJbXBsO1xufSgpKTtcbnZhciBnZXRMYW5ndWFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKCh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAoKG5hdmlnYXRvci5sYW5ndWFnZXMgJiYgbmF2aWdhdG9yLmxhbmd1YWdlc1swXSkgfHxcbiAgICAgICAgICAgIG5hdmlnYXRvci5sYW5ndWFnZSkpIHx8XG4gICAgICAgICcnKTtcbn07XG5cbnZhciBFdmVudEJyaWRnZUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRXZlbnRCcmlkZ2VJbXBsKCkge1xuICAgICAgICB0aGlzLnF1ZXVlID0gW107XG4gICAgfVxuICAgIEV2ZW50QnJpZGdlSW1wbC5wcm90b3R5cGUubG9nRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnJlY2VpdmVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5xdWV1ZS5sZW5ndGggPCA1MTIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXVlLnB1c2goZXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZWNlaXZlcihldmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEV2ZW50QnJpZGdlSW1wbC5wcm90b3R5cGUuc2V0RXZlbnRSZWNlaXZlciA9IGZ1bmN0aW9uIChyZWNlaXZlcikge1xuICAgICAgICB0aGlzLnJlY2VpdmVyID0gcmVjZWl2ZXI7XG4gICAgICAgIGlmICh0aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucXVldWUuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICByZWNlaXZlcihldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucXVldWUgPSBbXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEV2ZW50QnJpZGdlSW1wbDtcbn0oKSk7XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xudmFyIF9fYXNzaWduID0gZnVuY3Rpb24gKCkge1xuICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xuICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcbiAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XG4gICAgfVxuICAgIHJldHVybiB0O1xuICB9O1xuICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG52YXIgaXNFcXVhbCA9IGZ1bmN0aW9uIChvYmoxLCBvYmoyKSB7XG4gICAgdmFyIHByaW1pdGl2ZSA9IFsnc3RyaW5nJywgJ251bWJlcicsICdib29sZWFuJywgJ3VuZGVmaW5lZCddO1xuICAgIHZhciB0eXBlQSA9IHR5cGVvZiBvYmoxO1xuICAgIHZhciB0eXBlQiA9IHR5cGVvZiBvYmoyO1xuICAgIGlmICh0eXBlQSAhPT0gdHlwZUIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKHZhciBfaSA9IDAsIHByaW1pdGl2ZV8xID0gcHJpbWl0aXZlOyBfaSA8IHByaW1pdGl2ZV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcCA9IHByaW1pdGl2ZV8xW19pXTtcbiAgICAgICAgaWYgKHAgPT09IHR5cGVBKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqMSA9PT0gb2JqMjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBjaGVjayBudWxsXG4gICAgaWYgKG9iajEgPT0gbnVsbCAmJiBvYmoyID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKG9iajEgPT0gbnVsbCB8fCBvYmoyID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvLyBpZiBnb3QgaGVyZSAtIG9iamVjdHNcbiAgICBpZiAob2JqMS5sZW5ndGggIT09IG9iajIubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9jaGVjayBpZiBhcnJheXNcbiAgICB2YXIgaXNBcnJheUEgPSBBcnJheS5pc0FycmF5KG9iajEpO1xuICAgIHZhciBpc0FycmF5QiA9IEFycmF5LmlzQXJyYXkob2JqMik7XG4gICAgaWYgKGlzQXJyYXlBICE9PSBpc0FycmF5Qikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChpc0FycmF5QSAmJiBpc0FycmF5Qikge1xuICAgICAgICAvL2FycmF5c1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9iajEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghaXNFcXVhbChvYmoxW2ldLCBvYmoyW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgLy9vYmplY3RzXG4gICAgICAgIHZhciBzb3J0ZWQxID0gT2JqZWN0LmtleXMob2JqMSkuc29ydCgpO1xuICAgICAgICB2YXIgc29ydGVkMiA9IE9iamVjdC5rZXlzKG9iajIpLnNvcnQoKTtcbiAgICAgICAgaWYgKCFpc0VxdWFsKHNvcnRlZDEsIHNvcnRlZDIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy9jb21wYXJlIG9iamVjdCB2YWx1ZXNcbiAgICAgICAgdmFyIHJlc3VsdF8xID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmtleXMob2JqMSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICBpZiAoIWlzRXF1YWwob2JqMVtrZXldLCBvYmoyW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0XzEgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHRfMTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG52YXIgSURfT1BfU0VUID0gJyRzZXQnO1xudmFyIElEX09QX1VOU0VUID0gJyR1bnNldCc7XG52YXIgSURfT1BfQ0xFQVJfQUxMID0gJyRjbGVhckFsbCc7XG4vLyBQb2x5ZmlsbCBmb3IgT2JqZWN0LmVudHJpZXNcbmlmICghT2JqZWN0LmVudHJpZXMpIHtcbiAgICBPYmplY3QuZW50cmllcyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgdmFyIG93blByb3BzID0gT2JqZWN0LmtleXMob2JqKTtcbiAgICAgICAgdmFyIGkgPSBvd25Qcm9wcy5sZW5ndGg7XG4gICAgICAgIHZhciByZXNBcnJheSA9IG5ldyBBcnJheShpKTtcbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgICAgcmVzQXJyYXlbaV0gPSBbb3duUHJvcHNbaV0sIG9ialtvd25Qcm9wc1tpXV1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNBcnJheTtcbiAgICB9O1xufVxudmFyIElkZW50aXR5U3RvcmVJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIElkZW50aXR5U3RvcmVJbXBsKCkge1xuICAgICAgICB0aGlzLmlkZW50aXR5ID0geyB1c2VyUHJvcGVydGllczoge30gfTtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBuZXcgU2V0KCk7XG4gICAgfVxuICAgIElkZW50aXR5U3RvcmVJbXBsLnByb3RvdHlwZS5lZGl0SWRlbnRpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhc1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBhY3RpbmdVc2VyUHJvcGVydGllcyA9IF9fYXNzaWduKHt9LCB0aGlzLmlkZW50aXR5LnVzZXJQcm9wZXJ0aWVzKTtcbiAgICAgICAgdmFyIGFjdGluZ0lkZW50aXR5ID0gX19hc3NpZ24oX19hc3NpZ24oe30sIHRoaXMuaWRlbnRpdHkpLCB7IHVzZXJQcm9wZXJ0aWVzOiBhY3RpbmdVc2VyUHJvcGVydGllcyB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNldFVzZXJJZDogZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICAgICAgICAgIGFjdGluZ0lkZW50aXR5LnVzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXREZXZpY2VJZDogZnVuY3Rpb24gKGRldmljZUlkKSB7XG4gICAgICAgICAgICAgICAgYWN0aW5nSWRlbnRpdHkuZGV2aWNlSWQgPSBkZXZpY2VJZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXRVc2VyUHJvcGVydGllczogZnVuY3Rpb24gKHVzZXJQcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICAgICAgYWN0aW5nSWRlbnRpdHkudXNlclByb3BlcnRpZXMgPSB1c2VyUHJvcGVydGllcztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1cGRhdGVVc2VyUHJvcGVydGllczogZnVuY3Rpb24gKGFjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW5nUHJvcGVydGllcyA9IGFjdGluZ0lkZW50aXR5LnVzZXJQcm9wZXJ0aWVzIHx8IHt9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBPYmplY3QuZW50cmllcyhhY3Rpb25zKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBhY3Rpb24gPSBfYlswXSwgcHJvcGVydGllcyA9IF9iWzFdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBJRF9PUF9TRVQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSAwLCBfZCA9IE9iamVjdC5lbnRyaWVzKHByb3BlcnRpZXMpOyBfYyA8IF9kLmxlbmd0aDsgX2MrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2UgPSBfZFtfY10sIGtleSA9IF9lWzBdLCB2YWx1ZSA9IF9lWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpbmdQcm9wZXJ0aWVzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIElEX09QX1VOU0VUOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9mID0gMCwgX2cgPSBPYmplY3Qua2V5cyhwcm9wZXJ0aWVzKTsgX2YgPCBfZy5sZW5ndGg7IF9mKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IF9nW19mXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGFjdGluZ1Byb3BlcnRpZXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIElEX09QX0NMRUFSX0FMTDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpbmdQcm9wZXJ0aWVzID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWN0aW5nSWRlbnRpdHkudXNlclByb3BlcnRpZXMgPSBhY3RpbmdQcm9wZXJ0aWVzO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbW1pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2V0SWRlbnRpdHkoYWN0aW5nSWRlbnRpdHkpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIElkZW50aXR5U3RvcmVJbXBsLnByb3RvdHlwZS5nZXRJZGVudGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXNzaWduKHt9LCB0aGlzLmlkZW50aXR5KTtcbiAgICB9O1xuICAgIElkZW50aXR5U3RvcmVJbXBsLnByb3RvdHlwZS5zZXRJZGVudGl0eSA9IGZ1bmN0aW9uIChpZGVudGl0eSkge1xuICAgICAgICB2YXIgb3JpZ2luYWxJZGVudGl0eSA9IF9fYXNzaWduKHt9LCB0aGlzLmlkZW50aXR5KTtcbiAgICAgICAgdGhpcy5pZGVudGl0eSA9IF9fYXNzaWduKHt9LCBpZGVudGl0eSk7XG4gICAgICAgIGlmICghaXNFcXVhbChvcmlnaW5hbElkZW50aXR5LCB0aGlzLmlkZW50aXR5KSkge1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcihpZGVudGl0eSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSWRlbnRpdHlTdG9yZUltcGwucHJvdG90eXBlLmFkZElkZW50aXR5TGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTtcbiAgICB9O1xuICAgIElkZW50aXR5U3RvcmVJbXBsLnByb3RvdHlwZS5yZW1vdmVJZGVudGl0eUxpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XG4gICAgfTtcbiAgICByZXR1cm4gSWRlbnRpdHlTdG9yZUltcGw7XG59KCkpO1xuXG52YXIgc2FmZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJ1xuICAgID8gZ2xvYmFsVGhpc1xuICAgIDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBnbG9iYWxcbiAgICAgICAgOiBzZWxmO1xuXG52YXIgQW5hbHl0aWNzQ29ubmVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFuYWx5dGljc0Nvbm5lY3RvcigpIHtcbiAgICAgICAgdGhpcy5pZGVudGl0eVN0b3JlID0gbmV3IElkZW50aXR5U3RvcmVJbXBsKCk7XG4gICAgICAgIHRoaXMuZXZlbnRCcmlkZ2UgPSBuZXcgRXZlbnRCcmlkZ2VJbXBsKCk7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb25Db250ZXh0UHJvdmlkZXIgPSBuZXcgQXBwbGljYXRpb25Db250ZXh0UHJvdmlkZXJJbXBsKCk7XG4gICAgfVxuICAgIEFuYWx5dGljc0Nvbm5lY3Rvci5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uIChpbnN0YW5jZU5hbWUpIHtcbiAgICAgICAgaWYgKCFzYWZlR2xvYmFsWydhbmFseXRpY3NDb25uZWN0b3JJbnN0YW5jZXMnXSkge1xuICAgICAgICAgICAgc2FmZUdsb2JhbFsnYW5hbHl0aWNzQ29ubmVjdG9ySW5zdGFuY2VzJ10gPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNhZmVHbG9iYWxbJ2FuYWx5dGljc0Nvbm5lY3Rvckluc3RhbmNlcyddW2luc3RhbmNlTmFtZV0pIHtcbiAgICAgICAgICAgIHNhZmVHbG9iYWxbJ2FuYWx5dGljc0Nvbm5lY3Rvckluc3RhbmNlcyddW2luc3RhbmNlTmFtZV0gPVxuICAgICAgICAgICAgICAgIG5ldyBBbmFseXRpY3NDb25uZWN0b3IoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2FmZUdsb2JhbFsnYW5hbHl0aWNzQ29ubmVjdG9ySW5zdGFuY2VzJ11baW5zdGFuY2VOYW1lXTtcbiAgICB9O1xuICAgIHJldHVybiBBbmFseXRpY3NDb25uZWN0b3I7XG59KCkpO1xuXG5leHBvcnQgeyBBbmFseXRpY3NDb25uZWN0b3IgfTtcbiIsImltcG9ydCB7IExvZ0xldmVsLCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzJztcbmltcG9ydCB7IEFNUExJVFVERV9TRVJWRVJfVVJMLCBBTVBMSVRVREVfQkFUQ0hfU0VSVkVSX1VSTCwgRVVfQU1QTElUVURFX1NFUlZFUl9VUkwsIEVVX0FNUExJVFVERV9CQVRDSF9TRVJWRVJfVVJMLCB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4vbG9nZ2VyJztcbmV4cG9ydCB2YXIgZ2V0RGVmYXVsdENvbmZpZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgZmx1c2hNYXhSZXRyaWVzOiAxMixcbiAgICBmbHVzaFF1ZXVlU2l6ZTogMjAwLFxuICAgIGZsdXNoSW50ZXJ2YWxNaWxsaXM6IDEwMDAwLFxuICAgIGluc3RhbmNlTmFtZTogJyRkZWZhdWx0X2luc3RhbmNlJyxcbiAgICBsb2dMZXZlbDogTG9nTGV2ZWwuV2FybixcbiAgICBsb2dnZXJQcm92aWRlcjogbmV3IExvZ2dlcigpLFxuICAgIG9wdE91dDogZmFsc2UsXG4gICAgc2VydmVyVXJsOiBBTVBMSVRVREVfU0VSVkVSX1VSTCxcbiAgICBzZXJ2ZXJab25lOiAnVVMnLFxuICAgIHVzZUJhdGNoOiBmYWxzZSxcbn0pOyB9O1xudmFyIENvbmZpZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb25maWcob3B0aW9ucykge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIHRoaXMuX29wdE91dCA9IGZhbHNlO1xuICAgICAgICB2YXIgZGVmYXVsdENvbmZpZyA9IGdldERlZmF1bHRDb25maWcoKTtcbiAgICAgICAgdGhpcy5hcGlLZXkgPSBvcHRpb25zLmFwaUtleTtcbiAgICAgICAgdGhpcy5mbHVzaEludGVydmFsTWlsbGlzID0gKF9hID0gb3B0aW9ucy5mbHVzaEludGVydmFsTWlsbGlzKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBkZWZhdWx0Q29uZmlnLmZsdXNoSW50ZXJ2YWxNaWxsaXM7XG4gICAgICAgIHRoaXMuZmx1c2hNYXhSZXRyaWVzID0gb3B0aW9ucy5mbHVzaE1heFJldHJpZXMgfHwgZGVmYXVsdENvbmZpZy5mbHVzaE1heFJldHJpZXM7XG4gICAgICAgIHRoaXMuZmx1c2hRdWV1ZVNpemUgPSBvcHRpb25zLmZsdXNoUXVldWVTaXplIHx8IGRlZmF1bHRDb25maWcuZmx1c2hRdWV1ZVNpemU7XG4gICAgICAgIHRoaXMuaW5zdGFuY2VOYW1lID0gb3B0aW9ucy5pbnN0YW5jZU5hbWUgfHwgZGVmYXVsdENvbmZpZy5pbnN0YW5jZU5hbWU7XG4gICAgICAgIHRoaXMubG9nZ2VyUHJvdmlkZXIgPSBvcHRpb25zLmxvZ2dlclByb3ZpZGVyIHx8IGRlZmF1bHRDb25maWcubG9nZ2VyUHJvdmlkZXI7XG4gICAgICAgIHRoaXMubG9nTGV2ZWwgPSAoX2IgPSBvcHRpb25zLmxvZ0xldmVsKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBkZWZhdWx0Q29uZmlnLmxvZ0xldmVsO1xuICAgICAgICB0aGlzLm1pbklkTGVuZ3RoID0gb3B0aW9ucy5taW5JZExlbmd0aDtcbiAgICAgICAgdGhpcy5wbGFuID0gb3B0aW9ucy5wbGFuO1xuICAgICAgICB0aGlzLmluZ2VzdGlvbk1ldGFkYXRhID0gb3B0aW9ucy5pbmdlc3Rpb25NZXRhZGF0YTtcbiAgICAgICAgdGhpcy5vcHRPdXQgPSAoX2MgPSBvcHRpb25zLm9wdE91dCkgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogZGVmYXVsdENvbmZpZy5vcHRPdXQ7XG4gICAgICAgIHRoaXMuc2VydmVyVXJsID0gb3B0aW9ucy5zZXJ2ZXJVcmw7XG4gICAgICAgIHRoaXMuc2VydmVyWm9uZSA9IG9wdGlvbnMuc2VydmVyWm9uZSB8fCBkZWZhdWx0Q29uZmlnLnNlcnZlclpvbmU7XG4gICAgICAgIHRoaXMuc3RvcmFnZVByb3ZpZGVyID0gb3B0aW9ucy5zdG9yYWdlUHJvdmlkZXI7XG4gICAgICAgIHRoaXMudHJhbnNwb3J0UHJvdmlkZXIgPSBvcHRpb25zLnRyYW5zcG9ydFByb3ZpZGVyO1xuICAgICAgICB0aGlzLnVzZUJhdGNoID0gKF9kID0gb3B0aW9ucy51c2VCYXRjaCkgIT09IG51bGwgJiYgX2QgIT09IHZvaWQgMCA/IF9kIDogZGVmYXVsdENvbmZpZy51c2VCYXRjaDtcbiAgICAgICAgdGhpcy5sb2dnZXJQcm92aWRlci5lbmFibGUodGhpcy5sb2dMZXZlbCk7XG4gICAgICAgIHZhciBzZXJ2ZXJDb25maWcgPSBjcmVhdGVTZXJ2ZXJDb25maWcob3B0aW9ucy5zZXJ2ZXJVcmwsIG9wdGlvbnMuc2VydmVyWm9uZSwgb3B0aW9ucy51c2VCYXRjaCk7XG4gICAgICAgIHRoaXMuc2VydmVyWm9uZSA9IHNlcnZlckNvbmZpZy5zZXJ2ZXJab25lO1xuICAgICAgICB0aGlzLnNlcnZlclVybCA9IHNlcnZlckNvbmZpZy5zZXJ2ZXJVcmw7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb25maWcucHJvdG90eXBlLCBcIm9wdE91dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29wdE91dDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAob3B0T3V0KSB7XG4gICAgICAgICAgICB0aGlzLl9vcHRPdXQgPSBvcHRPdXQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gQ29uZmlnO1xufSgpKTtcbmV4cG9ydCB7IENvbmZpZyB9O1xuZXhwb3J0IHZhciBnZXRTZXJ2ZXJVcmwgPSBmdW5jdGlvbiAoc2VydmVyWm9uZSwgdXNlQmF0Y2gpIHtcbiAgICBpZiAoc2VydmVyWm9uZSA9PT0gJ0VVJykge1xuICAgICAgICByZXR1cm4gdXNlQmF0Y2ggPyBFVV9BTVBMSVRVREVfQkFUQ0hfU0VSVkVSX1VSTCA6IEVVX0FNUExJVFVERV9TRVJWRVJfVVJMO1xuICAgIH1cbiAgICByZXR1cm4gdXNlQmF0Y2ggPyBBTVBMSVRVREVfQkFUQ0hfU0VSVkVSX1VSTCA6IEFNUExJVFVERV9TRVJWRVJfVVJMO1xufTtcbmV4cG9ydCB2YXIgY3JlYXRlU2VydmVyQ29uZmlnID0gZnVuY3Rpb24gKHNlcnZlclVybCwgc2VydmVyWm9uZSwgdXNlQmF0Y2gpIHtcbiAgICBpZiAoc2VydmVyVXJsID09PSB2b2lkIDApIHsgc2VydmVyVXJsID0gJyc7IH1cbiAgICBpZiAoc2VydmVyWm9uZSA9PT0gdm9pZCAwKSB7IHNlcnZlclpvbmUgPSBnZXREZWZhdWx0Q29uZmlnKCkuc2VydmVyWm9uZTsgfVxuICAgIGlmICh1c2VCYXRjaCA9PT0gdm9pZCAwKSB7IHVzZUJhdGNoID0gZ2V0RGVmYXVsdENvbmZpZygpLnVzZUJhdGNoOyB9XG4gICAgaWYgKHNlcnZlclVybCkge1xuICAgICAgICByZXR1cm4geyBzZXJ2ZXJVcmw6IHNlcnZlclVybCwgc2VydmVyWm9uZTogdW5kZWZpbmVkIH07XG4gICAgfVxuICAgIHZhciBfc2VydmVyWm9uZSA9IFsnVVMnLCAnRVUnXS5pbmNsdWRlcyhzZXJ2ZXJab25lKSA/IHNlcnZlclpvbmUgOiBnZXREZWZhdWx0Q29uZmlnKCkuc2VydmVyWm9uZTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzZXJ2ZXJab25lOiBfc2VydmVyWm9uZSxcbiAgICAgICAgc2VydmVyVXJsOiBnZXRTZXJ2ZXJVcmwoX3NlcnZlclpvbmUsIHVzZUJhdGNoKSxcbiAgICB9O1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbmZpZy5qcy5tYXAiLCJleHBvcnQgdmFyIFVOU0VUX1ZBTFVFID0gJy0nO1xuZXhwb3J0IHZhciBBTVBMSVRVREVfUFJFRklYID0gJ0FNUCc7XG5leHBvcnQgdmFyIFNUT1JBR0VfUFJFRklYID0gXCJcIi5jb25jYXQoQU1QTElUVURFX1BSRUZJWCwgXCJfdW5zZW50XCIpO1xuZXhwb3J0IHZhciBBTVBMSVRVREVfU0VSVkVSX1VSTCA9ICdodHRwczovL2FwaTIuYW1wbGl0dWRlLmNvbS8yL2h0dHBhcGknO1xuZXhwb3J0IHZhciBFVV9BTVBMSVRVREVfU0VSVkVSX1VSTCA9ICdodHRwczovL2FwaS5ldS5hbXBsaXR1ZGUuY29tLzIvaHR0cGFwaSc7XG5leHBvcnQgdmFyIEFNUExJVFVERV9CQVRDSF9TRVJWRVJfVVJMID0gJ2h0dHBzOi8vYXBpMi5hbXBsaXR1ZGUuY29tL2JhdGNoJztcbmV4cG9ydCB2YXIgRVVfQU1QTElUVURFX0JBVENIX1NFUlZFUl9VUkwgPSAnaHR0cHM6Ly9hcGkuZXUuYW1wbGl0dWRlLmNvbS9iYXRjaCc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25zdGFudHMuanMubWFwIiwiaW1wb3J0IHsgX19hd2FpdGVyLCBfX2dlbmVyYXRvciwgX192YWx1ZXMgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGNyZWF0ZUdyb3VwSWRlbnRpZnlFdmVudCwgY3JlYXRlSWRlbnRpZnlFdmVudCwgY3JlYXRlVHJhY2tFdmVudCwgY3JlYXRlUmV2ZW51ZUV2ZW50LCBjcmVhdGVHcm91cEV2ZW50LCB9IGZyb20gJy4vdXRpbHMvZXZlbnQtYnVpbGRlcic7XG5pbXBvcnQgeyBUaW1lbGluZSB9IGZyb20gJy4vdGltZWxpbmUnO1xuaW1wb3J0IHsgYnVpbGRSZXN1bHQgfSBmcm9tICcuL3V0aWxzL3Jlc3VsdC1idWlsZGVyJztcbmltcG9ydCB7IENMSUVOVF9OT1RfSU5JVElBTElaRUQsIE9QVF9PVVRfTUVTU0FHRSB9IGZyb20gJy4vbWVzc2FnZXMnO1xuaW1wb3J0IHsgcmV0dXJuV3JhcHBlciB9IGZyb20gJy4vdXRpbHMvcmV0dXJuLXdyYXBwZXInO1xudmFyIEFtcGxpdHVkZUNvcmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQW1wbGl0dWRlQ29yZShuYW1lKSB7XG4gICAgICAgIGlmIChuYW1lID09PSB2b2lkIDApIHsgbmFtZSA9ICckZGVmYXVsdCc7IH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXppbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5xID0gW107XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hRID0gW107XG4gICAgICAgIHRoaXMubG9nRXZlbnQgPSB0aGlzLnRyYWNrLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMudGltZWxpbmUgPSBuZXcgVGltZWxpbmUodGhpcyk7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgfVxuICAgIEFtcGxpdHVkZUNvcmUucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZWxpbmUucmVzZXQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJ1blF1ZXVlZEZ1bmN0aW9ucygncScpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUNvcmUucHJvdG90eXBlLnJ1blF1ZXVlZEZ1bmN0aW9ucyA9IGZ1bmN0aW9uIChxdWV1ZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHF1ZXVlZEZ1bmN0aW9ucywgcXVldWVkRnVuY3Rpb25zXzEsIHF1ZXVlZEZ1bmN0aW9uc18xXzEsIHF1ZXVlZEZ1bmN0aW9uLCBlXzFfMTtcbiAgICAgICAgICAgIHZhciBlXzEsIF9hO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcXVldWVkRnVuY3Rpb25zID0gdGhpc1txdWV1ZU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1txdWV1ZU5hbWVdID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgNiwgNywgOF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVldWVkRnVuY3Rpb25zXzEgPSBfX3ZhbHVlcyhxdWV1ZWRGdW5jdGlvbnMpLCBxdWV1ZWRGdW5jdGlvbnNfMV8xID0gcXVldWVkRnVuY3Rpb25zXzEubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFxdWV1ZWRGdW5jdGlvbnNfMV8xLmRvbmUpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVldWVkRnVuY3Rpb24gPSBxdWV1ZWRGdW5jdGlvbnNfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcXVldWVkRnVuY3Rpb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcXVldWVkRnVuY3Rpb25zXzFfMSA9IHF1ZXVlZEZ1bmN0aW9uc18xLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzFfMSA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVldWVkRnVuY3Rpb25zXzFfMSAmJiAhcXVldWVkRnVuY3Rpb25zXzFfMS5kb25lICYmIChfYSA9IHF1ZXVlZEZ1bmN0aW9uc18xLnJldHVybikpIF9hLmNhbGwocXVldWVkRnVuY3Rpb25zXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQ29yZS5wcm90b3R5cGUudHJhY2sgPSBmdW5jdGlvbiAoZXZlbnRJbnB1dCwgZXZlbnRQcm9wZXJ0aWVzLCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGV2ZW50ID0gY3JlYXRlVHJhY2tFdmVudChldmVudElucHV0LCBldmVudFByb3BlcnRpZXMsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIHJldHVybiByZXR1cm5XcmFwcGVyKHRoaXMuZGlzcGF0Y2goZXZlbnQpKTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUNvcmUucHJvdG90eXBlLmlkZW50aWZ5ID0gZnVuY3Rpb24gKGlkZW50aWZ5LCBldmVudE9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGV2ZW50ID0gY3JlYXRlSWRlbnRpZnlFdmVudChpZGVudGlmeSwgZXZlbnRPcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIHJldHVybldyYXBwZXIodGhpcy5kaXNwYXRjaChldmVudCkpO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQ29yZS5wcm90b3R5cGUuZ3JvdXBJZGVudGlmeSA9IGZ1bmN0aW9uIChncm91cFR5cGUsIGdyb3VwTmFtZSwgaWRlbnRpZnksIGV2ZW50T3B0aW9ucykge1xuICAgICAgICB2YXIgZXZlbnQgPSBjcmVhdGVHcm91cElkZW50aWZ5RXZlbnQoZ3JvdXBUeXBlLCBncm91cE5hbWUsIGlkZW50aWZ5LCBldmVudE9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gcmV0dXJuV3JhcHBlcih0aGlzLmRpc3BhdGNoKGV2ZW50KSk7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVDb3JlLnByb3RvdHlwZS5zZXRHcm91cCA9IGZ1bmN0aW9uIChncm91cFR5cGUsIGdyb3VwTmFtZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIHZhciBldmVudCA9IGNyZWF0ZUdyb3VwRXZlbnQoZ3JvdXBUeXBlLCBncm91cE5hbWUsIGV2ZW50T3B0aW9ucyk7XG4gICAgICAgIHJldHVybiByZXR1cm5XcmFwcGVyKHRoaXMuZGlzcGF0Y2goZXZlbnQpKTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUNvcmUucHJvdG90eXBlLnJldmVudWUgPSBmdW5jdGlvbiAocmV2ZW51ZSwgZXZlbnRPcHRpb25zKSB7XG4gICAgICAgIHZhciBldmVudCA9IGNyZWF0ZVJldmVudWVFdmVudChyZXZlbnVlLCBldmVudE9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gcmV0dXJuV3JhcHBlcih0aGlzLmRpc3BhdGNoKGV2ZW50KSk7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVDb3JlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgICAgIGlmICghdGhpcy5jb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMucS5wdXNoKHRoaXMuYWRkLmJpbmQodGhpcywgcGx1Z2luKSk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuV3JhcHBlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXR1cm5XcmFwcGVyKHRoaXMudGltZWxpbmUucmVnaXN0ZXIocGx1Z2luLCB0aGlzLmNvbmZpZykpO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQ29yZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHBsdWdpbk5hbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZykge1xuICAgICAgICAgICAgdGhpcy5xLnB1c2godGhpcy5yZW1vdmUuYmluZCh0aGlzLCBwbHVnaW5OYW1lKSk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuV3JhcHBlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXR1cm5XcmFwcGVyKHRoaXMudGltZWxpbmUuZGVyZWdpc3RlcihwbHVnaW5OYW1lKSk7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVDb3JlLnByb3RvdHlwZS5kaXNwYXRjaFdpdGhDYWxsYmFjayA9IGZ1bmN0aW9uIChldmVudCwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZykge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGJ1aWxkUmVzdWx0KGV2ZW50LCAwLCBDTElFTlRfTk9UX0lOSVRJQUxJWkVEKSk7XG4gICAgICAgIH1cbiAgICAgICAgdm9pZCB0aGlzLnByb2Nlc3MoZXZlbnQpLnRoZW4oY2FsbGJhY2spO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQ29yZS5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoUS5wdXNoKF90aGlzLmRpc3BhdGNoV2l0aENhbGxiYWNrLmJpbmQoX3RoaXMsIGV2ZW50LCByZXNvbHZlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnByb2Nlc3MoZXZlbnQpXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFtcGxpdHVkZUNvcmUucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCwgZV8yLCBtZXNzYWdlLCByZXN1bHQ7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDIsICwgM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2tpcCBldmVudCBwcm9jZXNzaW5nIGlmIG9wdCBvdXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5vcHRPdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgYnVpbGRSZXN1bHQoZXZlbnQsIDAsIE9QVF9PVVRfTUVTU0FHRSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy50aW1lbGluZS5wdXNoKGV2ZW50KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jb2RlID09PSAyMDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuY29uZmlnLmxvZ2dlclByb3ZpZGVyLmxvZyhyZXN1bHQubWVzc2FnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMuY29uZmlnLmxvZ2dlclByb3ZpZGVyLmVycm9yKHJlc3VsdC5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXN1bHRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gU3RyaW5nKGVfMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb2dnZXJQcm92aWRlci5lcnJvcihtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGJ1aWxkUmVzdWx0KGV2ZW50LCAwLCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZXN1bHRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBbXBsaXR1ZGVDb3JlLnByb3RvdHlwZS5zZXRPcHRPdXQgPSBmdW5jdGlvbiAob3B0T3V0KSB7XG4gICAgICAgIGlmICghdGhpcy5jb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMucS5wdXNoKHRoaXMuc2V0T3B0T3V0LmJpbmQodGhpcywgQm9vbGVhbihvcHRPdXQpKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25maWcub3B0T3V0ID0gQm9vbGVhbihvcHRPdXQpO1xuICAgIH07XG4gICAgQW1wbGl0dWRlQ29yZS5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiByZXR1cm5XcmFwcGVyKHRoaXMudGltZWxpbmUuZmx1c2goKSk7XG4gICAgfTtcbiAgICByZXR1cm4gQW1wbGl0dWRlQ29yZTtcbn0oKSk7XG5leHBvcnQgeyBBbXBsaXR1ZGVDb3JlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb3JlLWNsaWVudC5qcy5tYXAiLCJpbXBvcnQgeyBfX2Fzc2lnbiB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgSWRlbnRpZnlPcGVyYXRpb24sIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtdHlwZXMnO1xuaW1wb3J0IHsgVU5TRVRfVkFMVUUgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBpc1ZhbGlkUHJvcGVydGllcyB9IGZyb20gJy4vdXRpbHMvdmFsaWQtcHJvcGVydGllcyc7XG52YXIgSWRlbnRpZnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSWRlbnRpZnkoKSB7XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5U2V0ID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0aWVzID0ge307XG4gICAgfVxuICAgIElkZW50aWZ5LnByb3RvdHlwZS5nZXRVc2VyUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXNzaWduKHt9LCB0aGlzLl9wcm9wZXJ0aWVzKTtcbiAgICB9O1xuICAgIElkZW50aWZ5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAocHJvcGVydHksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NhZmVTZXQoSWRlbnRpZnlPcGVyYXRpb24uU0VULCBwcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIElkZW50aWZ5LnByb3RvdHlwZS5zZXRPbmNlID0gZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zYWZlU2V0KElkZW50aWZ5T3BlcmF0aW9uLlNFVF9PTkNFLCBwcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIElkZW50aWZ5LnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAocHJvcGVydHksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NhZmVTZXQoSWRlbnRpZnlPcGVyYXRpb24uQVBQRU5ELCBwcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIElkZW50aWZ5LnByb3RvdHlwZS5wcmVwZW5kID0gZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zYWZlU2V0KElkZW50aWZ5T3BlcmF0aW9uLlBSRVBFTkQsIHByb3BlcnR5LCB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgSWRlbnRpZnkucHJvdG90eXBlLnBvc3RJbnNlcnQgPSBmdW5jdGlvbiAocHJvcGVydHksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NhZmVTZXQoSWRlbnRpZnlPcGVyYXRpb24uUE9TVElOU0VSVCwgcHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBJZGVudGlmeS5wcm90b3R5cGUucHJlSW5zZXJ0ID0gZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zYWZlU2V0KElkZW50aWZ5T3BlcmF0aW9uLlBSRUlOU0VSVCwgcHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBJZGVudGlmeS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zYWZlU2V0KElkZW50aWZ5T3BlcmF0aW9uLlJFTU9WRSwgcHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBJZGVudGlmeS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHByb3BlcnR5LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zYWZlU2V0KElkZW50aWZ5T3BlcmF0aW9uLkFERCwgcHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBJZGVudGlmeS5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgICAgdGhpcy5fc2FmZVNldChJZGVudGlmeU9wZXJhdGlvbi5VTlNFVCwgcHJvcGVydHksIFVOU0VUX1ZBTFVFKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBJZGVudGlmeS5wcm90b3R5cGUuY2xlYXJBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIFdoZW4gY2xlYXIgYWxsIGhhcHBlbnMsIGFsbCBwcm9wZXJ0aWVzIGFyZSB1bnNldC4gUmVzZXQgdGhlIGVudGlyZSBvYmplY3QuXG4gICAgICAgIHRoaXMuX3Byb3BlcnRpZXMgPSB7fTtcbiAgICAgICAgdGhpcy5fcHJvcGVydGllc1tJZGVudGlmeU9wZXJhdGlvbi5DTEVBUl9BTExdID0gVU5TRVRfVkFMVUU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgLy8gUmV0dXJucyB3aGV0aGVyIG9yIG5vdCB0aGlzIHNldCBhY3R1YWxseSB3b3JrZWQuXG4gICAgSWRlbnRpZnkucHJvdG90eXBlLl9zYWZlU2V0ID0gZnVuY3Rpb24gKG9wZXJhdGlvbiwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLl92YWxpZGF0ZShvcGVyYXRpb24sIHByb3BlcnR5LCB2YWx1ZSkpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcbiAgICAgICAgICAgIHZhciB1c2VyUHJvcGVydHlNYXAgPSB0aGlzLl9wcm9wZXJ0aWVzW29wZXJhdGlvbl07XG4gICAgICAgICAgICBpZiAodXNlclByb3BlcnR5TWFwID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB1c2VyUHJvcGVydHlNYXAgPSB7fTtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvcGVydGllc1tvcGVyYXRpb25dID0gdXNlclByb3BlcnR5TWFwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuICAgICAgICAgICAgdXNlclByb3BlcnR5TWFwW3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fcHJvcGVydHlTZXQuYWRkKHByb3BlcnR5KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIElkZW50aWZ5LnByb3RvdHlwZS5fdmFsaWRhdGUgPSBmdW5jdGlvbiAob3BlcmF0aW9uLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Byb3BlcnRpZXNbSWRlbnRpZnlPcGVyYXRpb24uQ0xFQVJfQUxMXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBjbGVhciBhbGwgYWxyZWFkeSBzZXQuIFNraXBwaW5nIG9wZXJhdGlvbjtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fcHJvcGVydHlTZXQuaGFzKHByb3BlcnR5KSkge1xuICAgICAgICAgICAgLy8gUHJvcGVydHkgYWxyZWFkeSB1c2VkLiBTa2lwcGluZyBvcGVyYXRpb25cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3BlcmF0aW9uID09PSBJZGVudGlmeU9wZXJhdGlvbi5BREQpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcGVyYXRpb24gIT09IElkZW50aWZ5T3BlcmF0aW9uLlVOU0VUICYmIG9wZXJhdGlvbiAhPT0gSWRlbnRpZnlPcGVyYXRpb24uUkVNT1ZFKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNWYWxpZFByb3BlcnRpZXMocHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBJZGVudGlmeTtcbn0oKSk7XG5leHBvcnQgeyBJZGVudGlmeSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aWRlbnRpZnkuanMubWFwIiwiaW1wb3J0IHsgTG9nTGV2ZWwgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy10eXBlcyc7XG52YXIgUFJFRklYID0gJ0FtcGxpdHVkZSBMb2dnZXIgJztcbnZhciBMb2dnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTG9nZ2VyKCkge1xuICAgICAgICB0aGlzLmxvZ0xldmVsID0gTG9nTGV2ZWwuTm9uZTtcbiAgICB9XG4gICAgTG9nZ2VyLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxvZ0xldmVsID0gTG9nTGV2ZWwuTm9uZTtcbiAgICB9O1xuICAgIExvZ2dlci5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gKGxvZ0xldmVsKSB7XG4gICAgICAgIGlmIChsb2dMZXZlbCA9PT0gdm9pZCAwKSB7IGxvZ0xldmVsID0gTG9nTGV2ZWwuV2FybjsgfVxuICAgICAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7XG4gICAgfTtcbiAgICBMb2dnZXIucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2dMZXZlbCA8IExvZ0xldmVsLlZlcmJvc2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhcIlwiLmNvbmNhdChQUkVGSVgsIFwiW0xvZ106IFwiKS5jb25jYXQoYXJncy5qb2luKCcgJykpKTtcbiAgICB9O1xuICAgIExvZ2dlci5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2dMZXZlbCA8IExvZ0xldmVsLldhcm4pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLndhcm4oXCJcIi5jb25jYXQoUFJFRklYLCBcIltXYXJuXTogXCIpLmNvbmNhdChhcmdzLmpvaW4oJyAnKSkpO1xuICAgIH07XG4gICAgTG9nZ2VyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2dMZXZlbCA8IExvZ0xldmVsLkVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5lcnJvcihcIlwiLmNvbmNhdChQUkVGSVgsIFwiW0Vycm9yXTogXCIpLmNvbmNhdChhcmdzLmpvaW4oJyAnKSkpO1xuICAgIH07XG4gICAgTG9nZ2VyLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2dMZXZlbCA8IExvZ0xldmVsLkRlYnVnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZyBvdXRwdXQgaXMgaGlkZGVuIGJ5IGRlZmF1bHQgaW4gY2hyb21lXG4gICAgICAgIGNvbnNvbGUubG9nKFwiXCIuY29uY2F0KFBSRUZJWCwgXCJbRGVidWddOiBcIikuY29uY2F0KGFyZ3Muam9pbignICcpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gTG9nZ2VyO1xufSgpKTtcbmV4cG9ydCB7IExvZ2dlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9nZ2VyLmpzLm1hcCIsImV4cG9ydCB2YXIgU1VDQ0VTU19NRVNTQUdFID0gJ0V2ZW50IHRyYWNrZWQgc3VjY2Vzc2Z1bGx5JztcbmV4cG9ydCB2YXIgVU5FWFBFQ1RFRF9FUlJPUl9NRVNTQUdFID0gJ1VuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnO1xuZXhwb3J0IHZhciBNQVhfUkVUUklFU19FWENFRURFRF9NRVNTQUdFID0gJ0V2ZW50IHJlamVjdGVkIGR1ZSB0byBleGNlZWRlZCByZXRyeSBjb3VudCc7XG5leHBvcnQgdmFyIE9QVF9PVVRfTUVTU0FHRSA9ICdFdmVudCBza2lwcGVkIGR1ZSB0byBvcHRPdXQgY29uZmlnJztcbmV4cG9ydCB2YXIgTUlTU0lOR19BUElfS0VZX01FU1NBR0UgPSAnRXZlbnQgcmVqZWN0ZWQgZHVlIHRvIG1pc3NpbmcgQVBJIGtleSc7XG5leHBvcnQgdmFyIElOVkFMSURfQVBJX0tFWSA9ICdJbnZhbGlkIEFQSSBrZXknO1xuZXhwb3J0IHZhciBDTElFTlRfTk9UX0lOSVRJQUxJWkVEID0gJ0NsaWVudCBub3QgaW5pdGlhbGl6ZWQnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVzc2FnZXMuanMubWFwIiwiaW1wb3J0IHsgX19hd2FpdGVyLCBfX2dlbmVyYXRvciwgX19yZWFkLCBfX3Jlc3QsIF9fc3ByZWFkQXJyYXkgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN0YXR1cywgfSBmcm9tICdAYW1wbGl0dWRlL2FuYWx5dGljcy10eXBlcyc7XG5pbXBvcnQgeyBJTlZBTElEX0FQSV9LRVksIE1BWF9SRVRSSUVTX0VYQ0VFREVEX01FU1NBR0UsIE1JU1NJTkdfQVBJX0tFWV9NRVNTQUdFLCBTVUNDRVNTX01FU1NBR0UsIFVORVhQRUNURURfRVJST1JfTUVTU0FHRSwgfSBmcm9tICcuLi9tZXNzYWdlcyc7XG5pbXBvcnQgeyBTVE9SQUdFX1BSRUZJWCB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBjaHVuayB9IGZyb20gJy4uL3V0aWxzL2NodW5rJztcbmltcG9ydCB7IGJ1aWxkUmVzdWx0IH0gZnJvbSAnLi4vdXRpbHMvcmVzdWx0LWJ1aWxkZXInO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ29uZmlnIH0gZnJvbSAnLi4vY29uZmlnJztcbmZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZShlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKVxuICAgICAgICByZXR1cm4gZXJyb3IubWVzc2FnZTtcbiAgICByZXR1cm4gU3RyaW5nKGVycm9yKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXNwb25zZUJvZHlTdHJpbmcocmVzKSB7XG4gICAgdmFyIHJlc3BvbnNlQm9keVN0cmluZyA9ICcnO1xuICAgIHRyeSB7XG4gICAgICAgIGlmICgnYm9keScgaW4gcmVzKSB7XG4gICAgICAgICAgICByZXNwb25zZUJvZHlTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShyZXMuYm9keSwgbnVsbCwgMik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgIC8vIHRvIGF2b2lkIGNyYXNoLCBidXQgZG9uJ3QgY2FyZSBhYm91dCB0aGUgZXJyb3IsIGFkZCBjb21tZW50IHRvIGF2b2lkIGVtcHR5IGJsb2NrIGxpbnQgZXJyb3JcbiAgICB9XG4gICAgcmV0dXJuIHJlc3BvbnNlQm9keVN0cmluZztcbn1cbnZhciBEZXN0aW5hdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEZXN0aW5hdGlvbigpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gJ2FtcGxpdHVkZSc7XG4gICAgICAgIHRoaXMudHlwZSA9ICdkZXN0aW5hdGlvbic7XG4gICAgICAgIHRoaXMucmV0cnlUaW1lb3V0ID0gMTAwMDtcbiAgICAgICAgdGhpcy50aHJvdHRsZVRpbWVvdXQgPSAzMDAwMDtcbiAgICAgICAgdGhpcy5zdG9yYWdlS2V5ID0gJyc7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVkID0gbnVsbDtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH1cbiAgICBEZXN0aW5hdGlvbi5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHVuc2VudDtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZUtleSA9IFwiXCIuY29uY2F0KFNUT1JBR0VfUFJFRklYLCBcIl9cIikuY29uY2F0KHRoaXMuY29uZmlnLmFwaUtleS5zdWJzdHJpbmcoMCwgMTApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sICgoX2EgPSB0aGlzLmNvbmZpZy5zdG9yYWdlUHJvdmlkZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXQodGhpcy5zdG9yYWdlS2V5KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICB1bnNlbnQgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVFdmVudHMoKTsgLy8gc2V0cyBzdG9yYWdlIHRvICdbXSdcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1bnNlbnQgJiYgdW5zZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIFByb21pc2UuYWxsKHVuc2VudC5tYXAoZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5leGVjdXRlKGV2ZW50KTsgfSkpLmNhdGNoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERlc3RpbmF0aW9uLnByb3RvdHlwZS5leGVjdXRlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB7XG4gICAgICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgICAgIGF0dGVtcHRzOiAwLFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiAocmVzdWx0KSB7IHJldHVybiByZXNvbHZlKHJlc3VsdCk7IH0sXG4gICAgICAgICAgICAgICAgdGltZW91dDogMCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2b2lkIF90aGlzLmFkZFRvUXVldWUoY29udGV4dCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLmFkZFRvUXVldWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBsaXN0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBsaXN0W19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRyeWFibGUgPSBsaXN0LmZpbHRlcihmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKGNvbnRleHQuYXR0ZW1wdHMgPCBfdGhpcy5jb25maWcuZmx1c2hNYXhSZXRyaWVzKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dC5hdHRlbXB0cyArPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdm9pZCBfdGhpcy5mdWxmaWxsUmVxdWVzdChbY29udGV4dF0sIDUwMCwgTUFYX1JFVFJJRVNfRVhDRUVERURfTUVTU0FHRSk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgICB0cnlhYmxlLmZvckVhY2goZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgICAgIF90aGlzLnF1ZXVlID0gX3RoaXMucXVldWUuY29uY2F0KGNvbnRleHQpO1xuICAgICAgICAgICAgaWYgKGNvbnRleHQudGltZW91dCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIF90aGlzLnNjaGVkdWxlKF90aGlzLmNvbmZpZy5mbHVzaEludGVydmFsTWlsbGlzKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnRpbWVvdXQgPSAwO1xuICAgICAgICAgICAgICAgIF90aGlzLnNjaGVkdWxlKDApO1xuICAgICAgICAgICAgfSwgY29udGV4dC50aW1lb3V0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2F2ZUV2ZW50cygpO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHRpbWVvdXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuc2NoZWR1bGVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLnNjaGVkdWxlZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdm9pZCBfdGhpcy5mbHVzaCh0cnVlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMucXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zY2hlZHVsZSh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgdGltZW91dCk7XG4gICAgfTtcbiAgICBEZXN0aW5hdGlvbi5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAodXNlUmV0cnkpIHtcbiAgICAgICAgaWYgKHVzZVJldHJ5ID09PSB2b2lkIDApIHsgdXNlUmV0cnkgPSBmYWxzZTsgfVxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCwgbGF0ZXIsIGJhdGNoZXM7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXIgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVldWUuZm9yRWFjaChmdW5jdGlvbiAoY29udGV4dCkgeyByZXR1cm4gKGNvbnRleHQudGltZW91dCA9PT0gMCA/IGxpc3QucHVzaChjb250ZXh0KSA6IGxhdGVyLnB1c2goY29udGV4dCkpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVldWUgPSBsYXRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNjaGVkdWxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNjaGVkdWxlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2hlcyA9IGNodW5rKGxpc3QsIHRoaXMuY29uZmlnLmZsdXNoUXVldWVTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFByb21pc2UuYWxsKGJhdGNoZXMubWFwKGZ1bmN0aW9uIChiYXRjaCkgeyByZXR1cm4gX3RoaXMuc2VuZChiYXRjaCwgdXNlUmV0cnkpOyB9KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAobGlzdCwgdXNlUmV0cnkpIHtcbiAgICAgICAgaWYgKHVzZVJldHJ5ID09PSB2b2lkIDApIHsgdXNlUmV0cnkgPSB0cnVlOyB9XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwYXlsb2FkLCBzZXJ2ZXJVcmwsIHJlcywgZV8xLCBlcnJvck1lc3NhZ2U7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmZ1bGZpbGxSZXF1ZXN0KGxpc3QsIDQwMCwgTUlTU0lOR19BUElfS0VZX01FU1NBR0UpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpX2tleTogdGhpcy5jb25maWcuYXBpS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50czogbGlzdC5tYXAoZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2EgPSBjb250ZXh0LmV2ZW50LCBleHRyYSA9IF9hLmV4dHJhLCBldmVudFdpdGhvdXRFeHRyYSA9IF9fcmVzdChfYSwgW1wiZXh0cmFcIl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnRXaXRob3V0RXh0cmE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5faWRfbGVuZ3RoOiB0aGlzLmNvbmZpZy5taW5JZExlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlclVybCA9IGNyZWF0ZVNlcnZlckNvbmZpZyh0aGlzLmNvbmZpZy5zZXJ2ZXJVcmwsIHRoaXMuY29uZmlnLnNlcnZlclpvbmUsIHRoaXMuY29uZmlnLnVzZUJhdGNoKS5zZXJ2ZXJVcmw7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNvbmZpZy50cmFuc3BvcnRQcm92aWRlci5zZW5kKHNlcnZlclVybCwgcGF5bG9hZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdWxmaWxsUmVxdWVzdChsaXN0LCAwLCBVTkVYUEVDVEVEX0VSUk9SX01FU1NBR0UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdXNlUmV0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2JvZHknIGluIHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bGZpbGxSZXF1ZXN0KGxpc3QsIHJlcy5zdGF0dXNDb2RlLCBcIlwiLmNvbmNhdChyZXMuc3RhdHVzLCBcIjogXCIpLmNvbmNhdChnZXRSZXNwb25zZUJvZHlTdHJpbmcocmVzKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdWxmaWxsUmVxdWVzdChsaXN0LCByZXMuc3RhdHVzQ29kZSwgcmVzLnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVzcG9uc2UocmVzLCBsaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBnZXRFcnJvck1lc3NhZ2UoZV8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvZ2dlclByb3ZpZGVyLmVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bGZpbGxSZXF1ZXN0KGxpc3QsIDAsIGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLmhhbmRsZVJlc3BvbnNlID0gZnVuY3Rpb24gKHJlcywgbGlzdCkge1xuICAgICAgICB2YXIgc3RhdHVzID0gcmVzLnN0YXR1cztcbiAgICAgICAgc3dpdGNoIChzdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgU3RhdHVzLlN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVN1Y2Nlc3NSZXNwb25zZShyZXMsIGxpc3QpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBTdGF0dXMuSW52YWxpZDoge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlSW52YWxpZFJlc3BvbnNlKHJlcywgbGlzdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFN0YXR1cy5QYXlsb2FkVG9vTGFyZ2U6IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVBheWxvYWRUb29MYXJnZVJlc3BvbnNlKHJlcywgbGlzdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFN0YXR1cy5SYXRlTGltaXQ6IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVJhdGVMaW1pdFJlc3BvbnNlKHJlcywgbGlzdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OiB7XG4gICAgICAgICAgICAgICAgLy8gbG9nIGludGVybWVkaWF0ZSBldmVudCBzdGF0dXMgYmVmb3JlIHJldHJ5XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9nZ2VyUHJvdmlkZXIud2FybihcIntjb2RlOiAwLCBlcnJvcjogXFxcIlN0YXR1cyAnXCIuY29uY2F0KHN0YXR1cywgXCInIHByb3ZpZGVkIGZvciBcIikuY29uY2F0KGxpc3QubGVuZ3RoLCBcIiBldmVudHNcXFwifVwiKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVPdGhlclJlc3BvbnNlKGxpc3QpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBEZXN0aW5hdGlvbi5wcm90b3R5cGUuaGFuZGxlU3VjY2Vzc1Jlc3BvbnNlID0gZnVuY3Rpb24gKHJlcywgbGlzdCkge1xuICAgICAgICB0aGlzLmZ1bGZpbGxSZXF1ZXN0KGxpc3QsIHJlcy5zdGF0dXNDb2RlLCBTVUNDRVNTX01FU1NBR0UpO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLmhhbmRsZUludmFsaWRSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXMsIGxpc3QpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHJlcy5ib2R5Lm1pc3NpbmdGaWVsZCB8fCByZXMuYm9keS5lcnJvci5zdGFydHNXaXRoKElOVkFMSURfQVBJX0tFWSkpIHtcbiAgICAgICAgICAgIHRoaXMuZnVsZmlsbFJlcXVlc3QobGlzdCwgcmVzLnN0YXR1c0NvZGUsIHJlcy5ib2R5LmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZHJvcEluZGV4ID0gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgX19yZWFkKE9iamVjdC52YWx1ZXMocmVzLmJvZHkuZXZlbnRzV2l0aEludmFsaWRGaWVsZHMpKSwgZmFsc2UpLCBfX3JlYWQoT2JqZWN0LnZhbHVlcyhyZXMuYm9keS5ldmVudHNXaXRoTWlzc2luZ0ZpZWxkcykpLCBmYWxzZSksIF9fcmVhZChPYmplY3QudmFsdWVzKHJlcy5ib2R5LmV2ZW50c1dpdGhJbnZhbGlkSWRMZW5ndGhzKSksIGZhbHNlKSwgX19yZWFkKHJlcy5ib2R5LnNpbGVuY2VkRXZlbnRzKSwgZmFsc2UpLmZsYXQoKTtcbiAgICAgICAgdmFyIGRyb3BJbmRleFNldCA9IG5ldyBTZXQoZHJvcEluZGV4KTtcbiAgICAgICAgdmFyIHJldHJ5ID0gbGlzdC5maWx0ZXIoZnVuY3Rpb24gKGNvbnRleHQsIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoZHJvcEluZGV4U2V0LmhhcyhpbmRleCkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5mdWxmaWxsUmVxdWVzdChbY29udGV4dF0sIHJlcy5zdGF0dXNDb2RlLCByZXMuYm9keS5lcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAocmV0cnkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gbG9nIGludGVybWVkaWF0ZSBldmVudCBzdGF0dXMgYmVmb3JlIHJldHJ5XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5sb2dnZXJQcm92aWRlci53YXJuKGdldFJlc3BvbnNlQm9keVN0cmluZyhyZXMpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFkZFRvUXVldWUuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKHJldHJ5KSwgZmFsc2UpKTtcbiAgICB9O1xuICAgIERlc3RpbmF0aW9uLnByb3RvdHlwZS5oYW5kbGVQYXlsb2FkVG9vTGFyZ2VSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXMsIGxpc3QpIHtcbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLmZ1bGZpbGxSZXF1ZXN0KGxpc3QsIHJlcy5zdGF0dXNDb2RlLCByZXMuYm9keS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gbG9nIGludGVybWVkaWF0ZSBldmVudCBzdGF0dXMgYmVmb3JlIHJldHJ5XG4gICAgICAgIHRoaXMuY29uZmlnLmxvZ2dlclByb3ZpZGVyLndhcm4oZ2V0UmVzcG9uc2VCb2R5U3RyaW5nKHJlcykpO1xuICAgICAgICB0aGlzLmNvbmZpZy5mbHVzaFF1ZXVlU2l6ZSAvPSAyO1xuICAgICAgICB0aGlzLmFkZFRvUXVldWUuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGxpc3QpLCBmYWxzZSkpO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLmhhbmRsZVJhdGVMaW1pdFJlc3BvbnNlID0gZnVuY3Rpb24gKHJlcywgbGlzdCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZHJvcFVzZXJJZHMgPSBPYmplY3Qua2V5cyhyZXMuYm9keS5leGNlZWRlZERhaWx5UXVvdGFVc2Vycyk7XG4gICAgICAgIHZhciBkcm9wRGV2aWNlSWRzID0gT2JqZWN0LmtleXMocmVzLmJvZHkuZXhjZWVkZWREYWlseVF1b3RhRGV2aWNlcyk7XG4gICAgICAgIHZhciB0aHJvdHRsZWRJbmRleCA9IHJlcy5ib2R5LnRocm90dGxlZEV2ZW50cztcbiAgICAgICAgdmFyIGRyb3BVc2VySWRzU2V0ID0gbmV3IFNldChkcm9wVXNlcklkcyk7XG4gICAgICAgIHZhciBkcm9wRGV2aWNlSWRzU2V0ID0gbmV3IFNldChkcm9wRGV2aWNlSWRzKTtcbiAgICAgICAgdmFyIHRocm90dGxlZEluZGV4U2V0ID0gbmV3IFNldCh0aHJvdHRsZWRJbmRleCk7XG4gICAgICAgIHZhciByZXRyeSA9IGxpc3QuZmlsdGVyKGZ1bmN0aW9uIChjb250ZXh0LCBpbmRleCkge1xuICAgICAgICAgICAgaWYgKChjb250ZXh0LmV2ZW50LnVzZXJfaWQgJiYgZHJvcFVzZXJJZHNTZXQuaGFzKGNvbnRleHQuZXZlbnQudXNlcl9pZCkpIHx8XG4gICAgICAgICAgICAgICAgKGNvbnRleHQuZXZlbnQuZGV2aWNlX2lkICYmIGRyb3BEZXZpY2VJZHNTZXQuaGFzKGNvbnRleHQuZXZlbnQuZGV2aWNlX2lkKSkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5mdWxmaWxsUmVxdWVzdChbY29udGV4dF0sIHJlcy5zdGF0dXNDb2RlLCByZXMuYm9keS5lcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRocm90dGxlZEluZGV4U2V0LmhhcyhpbmRleCkpIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LnRpbWVvdXQgPSBfdGhpcy50aHJvdHRsZVRpbWVvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChyZXRyeS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBsb2cgaW50ZXJtZWRpYXRlIGV2ZW50IHN0YXR1cyBiZWZvcmUgcmV0cnlcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvZ2dlclByb3ZpZGVyLndhcm4oZ2V0UmVzcG9uc2VCb2R5U3RyaW5nKHJlcykpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWRkVG9RdWV1ZS5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQocmV0cnkpLCBmYWxzZSkpO1xuICAgIH07XG4gICAgRGVzdGluYXRpb24ucHJvdG90eXBlLmhhbmRsZU90aGVyUmVzcG9uc2UgPSBmdW5jdGlvbiAobGlzdCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmFkZFRvUXVldWUuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbXSwgX19yZWFkKGxpc3QubWFwKGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICBjb250ZXh0LnRpbWVvdXQgPSBjb250ZXh0LmF0dGVtcHRzICogX3RoaXMucmV0cnlUaW1lb3V0O1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgICAgIH0pKSwgZmFsc2UpKTtcbiAgICB9O1xuICAgIERlc3RpbmF0aW9uLnByb3RvdHlwZS5mdWxmaWxsUmVxdWVzdCA9IGZ1bmN0aW9uIChsaXN0LCBjb2RlLCBtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMuc2F2ZUV2ZW50cygpO1xuICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24gKGNvbnRleHQpIHsgcmV0dXJuIGNvbnRleHQuY2FsbGJhY2soYnVpbGRSZXN1bHQoY29udGV4dC5ldmVudCwgY29kZSwgbWVzc2FnZSkpOyB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFNhdmVzIGV2ZW50cyB0byBzdG9yYWdlXG4gICAgICogVGhpcyBpcyBjYWxsZWQgb25cbiAgICAgKiAxKSBuZXcgZXZlbnRzIGFyZSBhZGRlZCB0byBxdWV1ZTsgb3JcbiAgICAgKiAyKSByZXNwb25zZSBjb21lcyBiYWNrIGZvciBhIHJlcXVlc3RcbiAgICAgKi9cbiAgICBEZXN0aW5hdGlvbi5wcm90b3R5cGUuc2F2ZUV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5zdG9yYWdlUHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXZlbnRzID0gQXJyYXkuZnJvbSh0aGlzLnF1ZXVlLm1hcChmdW5jdGlvbiAoY29udGV4dCkgeyByZXR1cm4gY29udGV4dC5ldmVudDsgfSkpO1xuICAgICAgICB2b2lkIHRoaXMuY29uZmlnLnN0b3JhZ2VQcm92aWRlci5zZXQodGhpcy5zdG9yYWdlS2V5LCBldmVudHMpO1xuICAgIH07XG4gICAgcmV0dXJuIERlc3RpbmF0aW9uO1xufSgpKTtcbmV4cG9ydCB7IERlc3RpbmF0aW9uIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZXN0aW5hdGlvbi5qcy5tYXAiLCJpbXBvcnQgeyBfX2Fzc2lnbiB9IGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgUmV2ZW51ZVByb3BlcnR5LCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzJztcbmltcG9ydCB7IGlzVmFsaWRPYmplY3QgfSBmcm9tICcuL3V0aWxzL3ZhbGlkLXByb3BlcnRpZXMnO1xudmFyIFJldmVudWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmV2ZW51ZSgpIHtcbiAgICAgICAgdGhpcy5wcm9kdWN0SWQgPSAnJztcbiAgICAgICAgdGhpcy5xdWFudGl0eSA9IDE7XG4gICAgICAgIHRoaXMucHJpY2UgPSAwLjA7XG4gICAgfVxuICAgIFJldmVudWUucHJvdG90eXBlLnNldFByb2R1Y3RJZCA9IGZ1bmN0aW9uIChwcm9kdWN0SWQpIHtcbiAgICAgICAgdGhpcy5wcm9kdWN0SWQgPSBwcm9kdWN0SWQ7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgUmV2ZW51ZS5wcm90b3R5cGUuc2V0UXVhbnRpdHkgPSBmdW5jdGlvbiAocXVhbnRpdHkpIHtcbiAgICAgICAgaWYgKHF1YW50aXR5ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5xdWFudGl0eSA9IHF1YW50aXR5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgUmV2ZW51ZS5wcm90b3R5cGUuc2V0UHJpY2UgPSBmdW5jdGlvbiAocHJpY2UpIHtcbiAgICAgICAgdGhpcy5wcmljZSA9IHByaWNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIFJldmVudWUucHJvdG90eXBlLnNldFJldmVudWVUeXBlID0gZnVuY3Rpb24gKHJldmVudWVUeXBlKSB7XG4gICAgICAgIHRoaXMucmV2ZW51ZVR5cGUgPSByZXZlbnVlVHlwZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBSZXZlbnVlLnByb3RvdHlwZS5zZXRSZXZlbnVlID0gZnVuY3Rpb24gKHJldmVudWUpIHtcbiAgICAgICAgdGhpcy5yZXZlbnVlID0gcmV2ZW51ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBSZXZlbnVlLnByb3RvdHlwZS5zZXRFdmVudFByb3BlcnRpZXMgPSBmdW5jdGlvbiAocHJvcGVydGllcykge1xuICAgICAgICBpZiAoaXNWYWxpZE9iamVjdChwcm9wZXJ0aWVzKSkge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIFJldmVudWUucHJvdG90eXBlLmdldEV2ZW50UHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGV2ZW50UHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllcyA/IF9fYXNzaWduKHt9LCB0aGlzLnByb3BlcnRpZXMpIDoge307XG4gICAgICAgIGV2ZW50UHJvcGVydGllc1tSZXZlbnVlUHJvcGVydHkuUkVWRU5VRV9QUk9EVUNUX0lEXSA9IHRoaXMucHJvZHVjdElkO1xuICAgICAgICBldmVudFByb3BlcnRpZXNbUmV2ZW51ZVByb3BlcnR5LlJFVkVOVUVfUVVBTlRJVFldID0gdGhpcy5xdWFudGl0eTtcbiAgICAgICAgZXZlbnRQcm9wZXJ0aWVzW1JldmVudWVQcm9wZXJ0eS5SRVZFTlVFX1BSSUNFXSA9IHRoaXMucHJpY2U7XG4gICAgICAgIGV2ZW50UHJvcGVydGllc1tSZXZlbnVlUHJvcGVydHkuUkVWRU5VRV9UWVBFXSA9IHRoaXMucmV2ZW51ZVR5cGU7XG4gICAgICAgIGV2ZW50UHJvcGVydGllc1tSZXZlbnVlUHJvcGVydHkuUkVWRU5VRV0gPSB0aGlzLnJldmVudWU7XG4gICAgICAgIHJldHVybiBldmVudFByb3BlcnRpZXM7XG4gICAgfTtcbiAgICByZXR1cm4gUmV2ZW51ZTtcbn0oKSk7XG5leHBvcnQgeyBSZXZlbnVlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXZlbnVlLmpzLm1hcCIsImltcG9ydCB7IF9fYXdhaXRlciwgX19nZW5lcmF0b3IgfSBmcm9tIFwidHNsaWJcIjtcbnZhciBNZW1vcnlTdG9yYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lbW9yeVN0b3JhZ2UoKSB7XG4gICAgICAgIHRoaXMubWVtb3J5U3RvcmFnZSA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgTWVtb3J5U3RvcmFnZS5wcm90b3R5cGUuaXNFbmFibGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRydWVdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTWVtb3J5U3RvcmFnZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMubWVtb3J5U3RvcmFnZS5nZXQoa2V5KV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNZW1vcnlTdG9yYWdlLnByb3RvdHlwZS5nZXRSYXcgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5nZXQoa2V5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHZhbHVlID8gSlNPTi5zdHJpbmdpZnkodmFsdWUpIDogdW5kZWZpbmVkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNZW1vcnlTdG9yYWdlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tZW1vcnlTdG9yYWdlLnNldChrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNZW1vcnlTdG9yYWdlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeVN0b3JhZ2UuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTWVtb3J5U3RvcmFnZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeVN0b3JhZ2UuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gTWVtb3J5U3RvcmFnZTtcbn0oKSk7XG5leHBvcnQgeyBNZW1vcnlTdG9yYWdlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZW1vcnkuanMubWFwIiwiaW1wb3J0IHsgX19hc3NpZ24sIF9fYXdhaXRlciwgX19nZW5lcmF0b3IsIF9fcmVhZCwgX192YWx1ZXMgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGJ1aWxkUmVzdWx0IH0gZnJvbSAnLi91dGlscy9yZXN1bHQtYnVpbGRlcic7XG5pbXBvcnQgeyBVVUlEIH0gZnJvbSAnLi91dGlscy91dWlkJztcbnZhciBUaW1lbGluZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUaW1lbGluZShjbGllbnQpIHtcbiAgICAgICAgdGhpcy5jbGllbnQgPSBjbGllbnQ7XG4gICAgICAgIHRoaXMucXVldWUgPSBbXTtcbiAgICAgICAgLy8gRmxhZyB0byBndWFyYW50ZWUgb25lIHNjaGVkdWxlIGFwcGx5IGlzIHJ1bm5pbmdcbiAgICAgICAgdGhpcy5hcHBseWluZyA9IGZhbHNlO1xuICAgICAgICAvLyBGbGFnIGluZGljYXRlcyB3aGV0aGVyIHRpbWVsaW5lIGlzIHJlYWR5IHRvIHByb2Nlc3MgZXZlbnRcbiAgICAgICAgLy8gRXZlbnRzIGNvbGxlY3RlZCBiZWZvcmUgdGltZWxpbmUgaXMgcmVhZHkgd2lsbCBzdGF5IGluIHRoZSBxdWV1ZSB0byBiZSBwcm9jZXNzZWQgbGF0ZXJcbiAgICAgICAgdGhpcy5wbHVnaW5zID0gW107XG4gICAgfVxuICAgIFRpbWVsaW5lLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChwbHVnaW4sIGNvbmZpZykge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZCkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2QubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLm5hbWUgPSAoX2EgPSBwbHVnaW4ubmFtZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogVVVJRCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLnR5cGUgPSAoX2IgPSBwbHVnaW4udHlwZSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogJ2VucmljaG1lbnQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKChfYyA9IHBsdWdpbi5zZXR1cCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmNhbGwocGx1Z2luLCBjb25maWcsIHRoaXMuY2xpZW50KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbnMucHVzaChwbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFRpbWVsaW5lLnByb3RvdHlwZS5kZXJlZ2lzdGVyID0gZnVuY3Rpb24gKHBsdWdpbk5hbWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXgsIHBsdWdpbjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5wbHVnaW5zLmZpbmRJbmRleChmdW5jdGlvbiAocGx1Z2luKSB7IHJldHVybiBwbHVnaW4ubmFtZSA9PT0gcGx1Z2luTmFtZTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4gPSB0aGlzLnBsdWdpbnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW5zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoKF9hID0gcGx1Z2luLnRlYXJkb3duKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbChwbHVnaW4pKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBUaW1lbGluZS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoY2xpZW50KSB7XG4gICAgICAgIHRoaXMuYXBwbHlpbmcgPSBmYWxzZTtcbiAgICAgICAgdmFyIHBsdWdpbnMgPSB0aGlzLnBsdWdpbnM7XG4gICAgICAgIHBsdWdpbnMubWFwKGZ1bmN0aW9uIChwbHVnaW4pIHsgdmFyIF9hOyByZXR1cm4gKF9hID0gcGx1Z2luLnRlYXJkb3duKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbChwbHVnaW4pOyB9KTtcbiAgICAgICAgdGhpcy5wbHVnaW5zID0gW107XG4gICAgICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuICAgIH07XG4gICAgVGltZWxpbmUucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICBfdGhpcy5xdWV1ZS5wdXNoKFtldmVudCwgcmVzb2x2ZV0pO1xuICAgICAgICAgICAgX3RoaXMuc2NoZWR1bGVBcHBseSgwKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBUaW1lbGluZS5wcm90b3R5cGUuc2NoZWR1bGVBcHBseSA9IGZ1bmN0aW9uICh0aW1lb3V0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmFwcGx5aW5nKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLmFwcGx5aW5nID0gdHJ1ZTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2b2lkIF90aGlzLmFwcGx5KF90aGlzLnF1ZXVlLnNoaWZ0KCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFwcGx5aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2NoZWR1bGVBcHBseSgwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgdGltZW91dCk7XG4gICAgfTtcbiAgICBUaW1lbGluZS5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2EsIGV2ZW50LCBfYiwgcmVzb2x2ZSwgYmVmb3JlLCBiZWZvcmVfMSwgYmVmb3JlXzFfMSwgcGx1Z2luLCBlLCBlXzFfMSwgZW5yaWNobWVudCwgZW5yaWNobWVudF8xLCBlbnJpY2htZW50XzFfMSwgcGx1Z2luLCBlLCBlXzJfMSwgZGVzdGluYXRpb24sIGV4ZWN1dGVEZXN0aW5hdGlvbnM7XG4gICAgICAgICAgICB2YXIgZV8xLCBfYywgZV8yLCBfZDtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gX19yZWFkKGl0ZW0sIDEpLCBldmVudCA9IF9hWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBfX3JlYWQoaXRlbSwgMiksIHJlc29sdmUgPSBfYlsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZSA9IHRoaXMucGx1Z2lucy5maWx0ZXIoZnVuY3Rpb24gKHBsdWdpbikgeyByZXR1cm4gcGx1Z2luLnR5cGUgPT09ICdiZWZvcmUnOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2UudHJ5cy5wdXNoKFsxLCA2LCA3LCA4XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVfMSA9IF9fdmFsdWVzKGJlZm9yZSksIGJlZm9yZV8xXzEgPSBiZWZvcmVfMS5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWJlZm9yZV8xXzEuZG9uZSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4gPSBiZWZvcmVfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBsdWdpbi5leGVjdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmV4ZWN1dGUoX19hc3NpZ24oe30sIGV2ZW50KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHsgZXZlbnQ6IGV2ZW50LCBjb2RlOiAwLCBtZXNzYWdlOiAnJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZV8xXzEgPSBiZWZvcmVfMS5uZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xXzEgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSB7IGVycm9yOiBlXzFfMSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJlZm9yZV8xXzEgJiYgIWJlZm9yZV8xXzEuZG9uZSAmJiAoX2MgPSBiZWZvcmVfMS5yZXR1cm4pKSBfYy5jYWxsKGJlZm9yZV8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVucmljaG1lbnQgPSB0aGlzLnBsdWdpbnMuZmlsdGVyKGZ1bmN0aW9uIChwbHVnaW4pIHsgcmV0dXJuIHBsdWdpbi50eXBlID09PSAnZW5yaWNobWVudCcgfHwgcGx1Z2luLnR5cGUgPT09IHVuZGVmaW5lZDsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLnRyeXMucHVzaChbOSwgMTQsIDE1LCAxNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5yaWNobWVudF8xID0gX192YWx1ZXMoZW5yaWNobWVudCksIGVucmljaG1lbnRfMV8xID0gZW5yaWNobWVudF8xLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMTA7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFlbnJpY2htZW50XzFfMS5kb25lKSByZXR1cm4gWzMgLypicmVhayovLCAxM107XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4gPSBlbnJpY2htZW50XzFfMS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwbHVnaW4uZXhlY3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxMl07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBwbHVnaW4uZXhlY3V0ZShfX2Fzc2lnbih7fSwgZXZlbnQpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHsgZXZlbnQ6IGV2ZW50LCBjb2RlOiAwLCBtZXNzYWdlOiAnJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDEyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgICAgICAgICAgZW5yaWNobWVudF8xXzEgPSBlbnJpY2htZW50XzEubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOiByZXR1cm4gWzMgLypicmVhayovLCAxNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzJfMSA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMiA9IHsgZXJyb3I6IGVfMl8xIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnJpY2htZW50XzFfMSAmJiAhZW5yaWNobWVudF8xXzEuZG9uZSAmJiAoX2QgPSBlbnJpY2htZW50XzEucmV0dXJuKSkgX2QuY2FsbChlbnJpY2htZW50XzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uID0gdGhpcy5wbHVnaW5zLmZpbHRlcihmdW5jdGlvbiAocGx1Z2luKSB7IHJldHVybiBwbHVnaW4udHlwZSA9PT0gJ2Rlc3RpbmF0aW9uJzsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGVjdXRlRGVzdGluYXRpb25zID0gZGVzdGluYXRpb24ubWFwKGZ1bmN0aW9uIChwbHVnaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRDbG9uZSA9IF9fYXNzaWduKHt9LCBldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsdWdpbi5leGVjdXRlKGV2ZW50Q2xvbmUpLmNhdGNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBidWlsZFJlc3VsdChldmVudENsb25lLCAwLCBTdHJpbmcoZSkpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCBQcm9taXNlLmFsbChleGVjdXRlRGVzdGluYXRpb25zKS50aGVuKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMSksIHJlc3VsdCA9IF9iWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFRpbWVsaW5lLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHF1ZXVlLCBkZXN0aW5hdGlvbiwgZXhlY3V0ZURlc3RpbmF0aW9ucztcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZSA9IHRoaXMucXVldWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXVlID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbChxdWV1ZS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIF90aGlzLmFwcGx5KGl0ZW0pOyB9KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbiA9IHRoaXMucGx1Z2lucy5maWx0ZXIoZnVuY3Rpb24gKHBsdWdpbikgeyByZXR1cm4gcGx1Z2luLnR5cGUgPT09ICdkZXN0aW5hdGlvbic7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZURlc3RpbmF0aW9ucyA9IGRlc3RpbmF0aW9uLm1hcChmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsdWdpbi5mbHVzaCAmJiBwbHVnaW4uZmx1c2goKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwoZXhlY3V0ZURlc3RpbmF0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFRpbWVsaW5lO1xufSgpKTtcbmV4cG9ydCB7IFRpbWVsaW5lIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lbGluZS5qcy5tYXAiLCIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnQgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtY2FsbCAqL1xuaW1wb3J0IHsgU3RhdHVzIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtdHlwZXMnO1xudmFyIEJhc2VUcmFuc3BvcnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmFzZVRyYW5zcG9ydCgpIHtcbiAgICB9XG4gICAgQmFzZVRyYW5zcG9ydC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChfc2VydmVyVXJsLCBfcGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH07XG4gICAgQmFzZVRyYW5zcG9ydC5wcm90b3R5cGUuYnVpbGRSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXNwb25zZUpTT04pIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaCwgX2osIF9rLCBfbCwgX20sIF9vLCBfcCwgX3EsIF9yLCBfcywgX3QsIF91LCBfdiwgX3csIF94O1xuICAgICAgICBpZiAodHlwZW9mIHJlc3BvbnNlSlNPTiAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGF0dXNDb2RlID0gcmVzcG9uc2VKU09OLmNvZGUgfHwgMDtcbiAgICAgICAgdmFyIHN0YXR1cyA9IHRoaXMuYnVpbGRTdGF0dXMoc3RhdHVzQ29kZSk7XG4gICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7XG4gICAgICAgICAgICBjYXNlIFN0YXR1cy5TdWNjZXNzOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudHNJbmdlc3RlZDogKF9hID0gcmVzcG9uc2VKU09OLmV2ZW50c19pbmdlc3RlZCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWRTaXplQnl0ZXM6IChfYiA9IHJlc3BvbnNlSlNPTi5wYXlsb2FkX3NpemVfYnl0ZXMpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXJVcGxvYWRUaW1lOiAoX2MgPSByZXNwb25zZUpTT04uc2VydmVyX3VwbG9hZF90aW1lKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiAwLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjYXNlIFN0YXR1cy5JbnZhbGlkOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogKF9kID0gcmVzcG9uc2VKU09OLmVycm9yKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pc3NpbmdGaWVsZDogKF9lID0gcmVzcG9uc2VKU09OLm1pc3NpbmdfZmllbGQpICE9PSBudWxsICYmIF9lICE9PSB2b2lkIDAgPyBfZSA6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRzV2l0aEludmFsaWRGaWVsZHM6IChfZiA9IHJlc3BvbnNlSlNPTi5ldmVudHNfd2l0aF9pbnZhbGlkX2ZpZWxkcykgIT09IG51bGwgJiYgX2YgIT09IHZvaWQgMCA/IF9mIDoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudHNXaXRoTWlzc2luZ0ZpZWxkczogKF9nID0gcmVzcG9uc2VKU09OLmV2ZW50c193aXRoX21pc3NpbmdfZmllbGRzKSAhPT0gbnVsbCAmJiBfZyAhPT0gdm9pZCAwID8gX2cgOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50c1dpdGhJbnZhbGlkSWRMZW5ndGhzOiAoX2ggPSByZXNwb25zZUpTT04uZXZlbnRzX3dpdGhfaW52YWxpZF9pZF9sZW5ndGhzKSAhPT0gbnVsbCAmJiBfaCAhPT0gdm9pZCAwID8gX2ggOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVwc1RocmVzaG9sZDogKF9qID0gcmVzcG9uc2VKU09OLmVwc190aHJlc2hvbGQpICE9PSBudWxsICYmIF9qICE9PSB2b2lkIDAgPyBfaiA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBleGNlZWRlZERhaWx5UXVvdGFEZXZpY2VzOiAoX2sgPSByZXNwb25zZUpTT04uZXhjZWVkZWRfZGFpbHlfcXVvdGFfZGV2aWNlcykgIT09IG51bGwgJiYgX2sgIT09IHZvaWQgMCA/IF9rIDoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWxlbmNlZERldmljZXM6IChfbCA9IHJlc3BvbnNlSlNPTi5zaWxlbmNlZF9kZXZpY2VzKSAhPT0gbnVsbCAmJiBfbCAhPT0gdm9pZCAwID8gX2wgOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpbGVuY2VkRXZlbnRzOiAoX20gPSByZXNwb25zZUpTT04uc2lsZW5jZWRfZXZlbnRzKSAhPT0gbnVsbCAmJiBfbSAhPT0gdm9pZCAwID8gX20gOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm90dGxlZERldmljZXM6IChfbyA9IHJlc3BvbnNlSlNPTi50aHJvdHRsZWRfZGV2aWNlcykgIT09IG51bGwgJiYgX28gIT09IHZvaWQgMCA/IF9vIDoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdHRsZWRFdmVudHM6IChfcCA9IHJlc3BvbnNlSlNPTi50aHJvdHRsZWRfZXZlbnRzKSAhPT0gbnVsbCAmJiBfcCAhPT0gdm9pZCAwID8gX3AgOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBTdGF0dXMuUGF5bG9hZFRvb0xhcmdlOlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogKF9xID0gcmVzcG9uc2VKU09OLmVycm9yKSAhPT0gbnVsbCAmJiBfcSAhPT0gdm9pZCAwID8gX3EgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBTdGF0dXMuUmF0ZUxpbWl0OlxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogKF9yID0gcmVzcG9uc2VKU09OLmVycm9yKSAhPT0gbnVsbCAmJiBfciAhPT0gdm9pZCAwID8gX3IgOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVwc1RocmVzaG9sZDogKF9zID0gcmVzcG9uc2VKU09OLmVwc190aHJlc2hvbGQpICE9PSBudWxsICYmIF9zICE9PSB2b2lkIDAgPyBfcyA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdHRsZWREZXZpY2VzOiAoX3QgPSByZXNwb25zZUpTT04udGhyb3R0bGVkX2RldmljZXMpICE9PSBudWxsICYmIF90ICE9PSB2b2lkIDAgPyBfdCA6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3R0bGVkVXNlcnM6IChfdSA9IHJlc3BvbnNlSlNPTi50aHJvdHRsZWRfdXNlcnMpICE9PSBudWxsICYmIF91ICE9PSB2b2lkIDAgPyBfdSA6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhjZWVkZWREYWlseVF1b3RhRGV2aWNlczogKF92ID0gcmVzcG9uc2VKU09OLmV4Y2VlZGVkX2RhaWx5X3F1b3RhX2RldmljZXMpICE9PSBudWxsICYmIF92ICE9PSB2b2lkIDAgPyBfdiA6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhjZWVkZWREYWlseVF1b3RhVXNlcnM6IChfdyA9IHJlc3BvbnNlSlNPTi5leGNlZWRlZF9kYWlseV9xdW90YV91c2VycykgIT09IG51bGwgJiYgX3cgIT09IHZvaWQgMCA/IF93IDoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdHRsZWRFdmVudHM6IChfeCA9IHJlc3BvbnNlSlNPTi50aHJvdHRsZWRfZXZlbnRzKSAhPT0gbnVsbCAmJiBfeCAhPT0gdm9pZCAwID8gX3ggOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgY2FzZSBTdGF0dXMuVGltZW91dDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmFzZVRyYW5zcG9ydC5wcm90b3R5cGUuYnVpbGRTdGF0dXMgPSBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICBpZiAoY29kZSA+PSAyMDAgJiYgY29kZSA8IDMwMCkge1xuICAgICAgICAgICAgcmV0dXJuIFN0YXR1cy5TdWNjZXNzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2RlID09PSA0MjkpIHtcbiAgICAgICAgICAgIHJldHVybiBTdGF0dXMuUmF0ZUxpbWl0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2RlID09PSA0MTMpIHtcbiAgICAgICAgICAgIHJldHVybiBTdGF0dXMuUGF5bG9hZFRvb0xhcmdlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2RlID09PSA0MDgpIHtcbiAgICAgICAgICAgIHJldHVybiBTdGF0dXMuVGltZW91dDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29kZSA+PSA0MDAgJiYgY29kZSA8IDUwMCkge1xuICAgICAgICAgICAgcmV0dXJuIFN0YXR1cy5JbnZhbGlkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2RlID49IDUwMCkge1xuICAgICAgICAgICAgcmV0dXJuIFN0YXR1cy5GYWlsZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN0YXR1cy5Vbmtub3duO1xuICAgIH07XG4gICAgcmV0dXJuIEJhc2VUcmFuc3BvcnQ7XG59KCkpO1xuZXhwb3J0IHsgQmFzZVRyYW5zcG9ydCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFzZS5qcy5tYXAiLCIvLyBDcmVhdGVzIGFuIGFycmF5IG9mIGVsZW1lbnRzIHNwbGl0IGludG8gZ3JvdXBzIHRoZSBsZW5ndGggb2Ygc2l6ZS5cbi8vIElmIGFycmF5IGNhbid0IGJlIHNwbGl0IGV2ZW5seSwgdGhlIGZpbmFsIGNodW5rIHdpbGwgYmUgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cbi8vIFdvcmtzIHNpbWlsYXJ5IGFzIGh0dHBzOi8vbG9kYXNoLmNvbS9kb2NzLzQuMTcuMTUjY2h1bmtcbmV4cG9ydCB2YXIgY2h1bmsgPSBmdW5jdGlvbiAoYXJyLCBzaXplKSB7XG4gICAgdmFyIGNodW5rU2l6ZSA9IE1hdGgubWF4KHNpemUsIDEpO1xuICAgIHJldHVybiBhcnIucmVkdWNlKGZ1bmN0aW9uIChjaHVua3MsIGVsZW1lbnQsIGluZGV4KSB7XG4gICAgICAgIHZhciBjaHVua0luZGV4ID0gTWF0aC5mbG9vcihpbmRleCAvIGNodW5rU2l6ZSk7XG4gICAgICAgIGlmICghY2h1bmtzW2NodW5rSW5kZXhdKSB7XG4gICAgICAgICAgICBjaHVua3NbY2h1bmtJbmRleF0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBjaHVua3NbY2h1bmtJbmRleF0ucHVzaChlbGVtZW50KTtcbiAgICAgICAgcmV0dXJuIGNodW5rcztcbiAgICB9LCBbXSk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2h1bmsuanMubWFwIiwiaW1wb3J0IHsgX19hc3NpZ24sIF9fdmFsdWVzIH0gZnJvbSBcInRzbGliXCI7XG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnQgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2VzcyAqL1xuLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1jYWxsICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uICovXG5pbXBvcnQgeyBMb2dMZXZlbCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzJztcbmV4cG9ydCB2YXIgZ2V0U3RhY2t0cmFjZSA9IGZ1bmN0aW9uIChpZ25vcmVEZXB0aCkge1xuICAgIGlmIChpZ25vcmVEZXB0aCA9PT0gdm9pZCAwKSB7IGlnbm9yZURlcHRoID0gMDsgfVxuICAgIHZhciB0cmFjZSA9IG5ldyBFcnJvcigpLnN0YWNrIHx8ICcnO1xuICAgIHJldHVybiB0cmFjZVxuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5zbGljZSgyICsgaWdub3JlRGVwdGgpXG4gICAgICAgIC5tYXAoZnVuY3Rpb24gKHRleHQpIHsgcmV0dXJuIHRleHQudHJpbSgpOyB9KTtcbn07XG4vLyBUaGlzIGhvb2sgbWFrZXMgc3VyZSB3ZSBhbHdheXMgZ2V0IHRoZSBsYXRlc3QgbG9nZ2VyIGFuZCBsb2dMZXZlbC5cbmV4cG9ydCB2YXIgZ2V0Q2xpZW50TG9nQ29uZmlnID0gZnVuY3Rpb24gKGNsaWVudCkgeyByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHZhciBfYSA9IF9fYXNzaWduKHt9LCBjbGllbnQuY29uZmlnKSwgbG9nZ2VyID0gX2EubG9nZ2VyUHJvdmlkZXIsIGxvZ0xldmVsID0gX2EubG9nTGV2ZWw7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbG9nZ2VyOiBsb2dnZXIsXG4gICAgICAgIGxvZ0xldmVsOiBsb2dMZXZlbCxcbiAgICB9O1xufTsgfTtcbi8vIFRoaXMgaXMgYSBjb252ZW5pZW50IGZ1bmN0aW9uIHRvIGdldCB0aGUgYXR0cmlidXRlIGZyb20gb2JqZWN0IHdpdGggc3RyaW5nIHBhdGgsIHNpbWlsYXIgdG8gbG9kYXNoICcjZ2V0Jy5cbmV4cG9ydCB2YXIgZ2V0VmFsdWVCeVN0cmluZ1BhdGggPSBmdW5jdGlvbiAob2JqLCBwYXRoKSB7XG4gICAgdmFyIGVfMSwgX2E7XG4gICAgcGF0aCA9IHBhdGgucmVwbGFjZSgvXFxbKFxcdyspXFxdL2csICcuJDEnKTsgLy8gY29udmVydCBpbmRleGVzIHRvIHByb3BlcnRpZXNcbiAgICBwYXRoID0gcGF0aC5yZXBsYWNlKC9eXFwuLywgJycpOyAvLyBzdHJpcCBhIGxlYWRpbmcgZG90XG4gICAgdHJ5IHtcbiAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyhwYXRoLnNwbGl0KCcuJykpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7XG4gICAgICAgICAgICB2YXIgYXR0ciA9IF9jLnZhbHVlO1xuICAgICAgICAgICAgaWYgKGF0dHIgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgb2JqID0gb2JqW2F0dHJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfVxuICAgIH1cbiAgICByZXR1cm4gb2JqO1xufTtcbmV4cG9ydCB2YXIgZ2V0Q2xpZW50U3RhdGVzID0gZnVuY3Rpb24gKGNsaWVudCwgcGF0aHMpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZV8yLCBfYTtcbiAgICB2YXIgcmVzID0ge307XG4gICAgdHJ5IHtcbiAgICAgICAgZm9yICh2YXIgcGF0aHNfMSA9IF9fdmFsdWVzKHBhdGhzKSwgcGF0aHNfMV8xID0gcGF0aHNfMS5uZXh0KCk7ICFwYXRoc18xXzEuZG9uZTsgcGF0aHNfMV8xID0gcGF0aHNfMS5uZXh0KCkpIHtcbiAgICAgICAgICAgIHZhciBwYXRoID0gcGF0aHNfMV8xLnZhbHVlO1xuICAgICAgICAgICAgcmVzW3BhdGhdID0gZ2V0VmFsdWVCeVN0cmluZ1BhdGgoY2xpZW50LCBwYXRoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHBhdGhzXzFfMSAmJiAhcGF0aHNfMV8xLmRvbmUgJiYgKF9hID0gcGF0aHNfMS5yZXR1cm4pKSBfYS5jYWxsKHBhdGhzXzEpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn07IH07XG5leHBvcnQgdmFyIGRlYnVnV3JhcHBlciA9IGZ1bmN0aW9uIChmbiwgZm5OYW1lLCBnZXRMb2dDb25maWcsIGdldFN0YXRlcywgZm5Db250ZXh0KSB7XG4gICAgaWYgKGZuQ29udGV4dCA9PT0gdm9pZCAwKSB7IGZuQ29udGV4dCA9IG51bGw7IH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfYSA9IGdldExvZ0NvbmZpZygpLCBsb2dnZXIgPSBfYS5sb2dnZXIsIGxvZ0xldmVsID0gX2EubG9nTGV2ZWw7XG4gICAgICAgIC8vIHJldHVybiBlYXJseSBpZiBwb3NzaWJsZSB0byByZWR1Y2Ugb3ZlcmhlYWRcbiAgICAgICAgaWYgKChsb2dMZXZlbCAmJiBsb2dMZXZlbCA8IExvZ0xldmVsLkRlYnVnKSB8fCAhbG9nTGV2ZWwgfHwgIWxvZ2dlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KGZuQ29udGV4dCwgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlYnVnQ29udGV4dCA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdpbnZva2UgcHVibGljIG1ldGhvZCcsXG4gICAgICAgICAgICBuYW1lOiBmbk5hbWUsXG4gICAgICAgICAgICBhcmdzOiBhcmdzLFxuICAgICAgICAgICAgc3RhY2t0cmFjZTogZ2V0U3RhY2t0cmFjZSgxKSxcbiAgICAgICAgICAgIHRpbWU6IHtcbiAgICAgICAgICAgICAgICBzdGFydDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN0YXRlczoge30sXG4gICAgICAgIH07XG4gICAgICAgIGlmIChnZXRTdGF0ZXMgJiYgZGVidWdDb250ZXh0LnN0YXRlcykge1xuICAgICAgICAgICAgZGVidWdDb250ZXh0LnN0YXRlcy5iZWZvcmUgPSBnZXRTdGF0ZXMoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gZm4uYXBwbHkoZm5Db250ZXh0LCBhcmdzKTtcbiAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQucHJvbWlzZSkge1xuICAgICAgICAgICAgLy8gaWYgcmVzdWx0IGlzIGEgcHJvbWlzZSwgYWRkIHRoZSBjYWxsYmFja1xuICAgICAgICAgICAgcmVzdWx0LnByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdldFN0YXRlcyAmJiBkZWJ1Z0NvbnRleHQuc3RhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlYnVnQ29udGV4dC5zdGF0ZXMuYWZ0ZXIgPSBnZXRTdGF0ZXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGRlYnVnQ29udGV4dC50aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlYnVnQ29udGV4dC50aW1lLmVuZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKEpTT04uc3RyaW5naWZ5KGRlYnVnQ29udGV4dCwgbnVsbCwgMikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZ2V0U3RhdGVzICYmIGRlYnVnQ29udGV4dC5zdGF0ZXMpIHtcbiAgICAgICAgICAgICAgICBkZWJ1Z0NvbnRleHQuc3RhdGVzLmFmdGVyID0gZ2V0U3RhdGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGVidWdDb250ZXh0LnRpbWUpIHtcbiAgICAgICAgICAgICAgICBkZWJ1Z0NvbnRleHQudGltZS5lbmQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoSlNPTi5zdHJpbmdpZnkoZGVidWdDb250ZXh0LCBudWxsLCAyKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlYnVnLmpzLm1hcCIsImltcG9ydCB7IF9fYXNzaWduIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBTcGVjaWFsRXZlbnRUeXBlLCB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLXR5cGVzJztcbmltcG9ydCB7IElkZW50aWZ5IH0gZnJvbSAnLi4vaWRlbnRpZnknO1xuZXhwb3J0IHZhciBjcmVhdGVUcmFja0V2ZW50ID0gZnVuY3Rpb24gKGV2ZW50SW5wdXQsIGV2ZW50UHJvcGVydGllcywgZXZlbnRPcHRpb25zKSB7XG4gICAgdmFyIGJhc2VFdmVudCA9IHR5cGVvZiBldmVudElucHV0ID09PSAnc3RyaW5nJyA/IHsgZXZlbnRfdHlwZTogZXZlbnRJbnB1dCB9IDogZXZlbnRJbnB1dDtcbiAgICByZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oX19hc3NpZ24oe30sIGJhc2VFdmVudCksIGV2ZW50T3B0aW9ucyksIChldmVudFByb3BlcnRpZXMgJiYgeyBldmVudF9wcm9wZXJ0aWVzOiBldmVudFByb3BlcnRpZXMgfSkpO1xufTtcbmV4cG9ydCB2YXIgY3JlYXRlSWRlbnRpZnlFdmVudCA9IGZ1bmN0aW9uIChpZGVudGlmeSwgZXZlbnRPcHRpb25zKSB7XG4gICAgdmFyIGlkZW50aWZ5RXZlbnQgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZXZlbnRPcHRpb25zKSwgeyBldmVudF90eXBlOiBTcGVjaWFsRXZlbnRUeXBlLklERU5USUZZLCB1c2VyX3Byb3BlcnRpZXM6IGlkZW50aWZ5LmdldFVzZXJQcm9wZXJ0aWVzKCkgfSk7XG4gICAgcmV0dXJuIGlkZW50aWZ5RXZlbnQ7XG59O1xuZXhwb3J0IHZhciBjcmVhdGVHcm91cElkZW50aWZ5RXZlbnQgPSBmdW5jdGlvbiAoZ3JvdXBUeXBlLCBncm91cE5hbWUsIGlkZW50aWZ5LCBldmVudE9wdGlvbnMpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIGdyb3VwSWRlbnRpZnkgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZXZlbnRPcHRpb25zKSwgeyBldmVudF90eXBlOiBTcGVjaWFsRXZlbnRUeXBlLkdST1VQX0lERU5USUZZLCBncm91cF9wcm9wZXJ0aWVzOiBpZGVudGlmeS5nZXRVc2VyUHJvcGVydGllcygpLCBncm91cHM6IChfYSA9IHt9LFxuICAgICAgICAgICAgX2FbZ3JvdXBUeXBlXSA9IGdyb3VwTmFtZSxcbiAgICAgICAgICAgIF9hKSB9KTtcbiAgICByZXR1cm4gZ3JvdXBJZGVudGlmeTtcbn07XG5leHBvcnQgdmFyIGNyZWF0ZUdyb3VwRXZlbnQgPSBmdW5jdGlvbiAoZ3JvdXBUeXBlLCBncm91cE5hbWUsIGV2ZW50T3B0aW9ucykge1xuICAgIHZhciBfYTtcbiAgICB2YXIgaWRlbnRpZnkgPSBuZXcgSWRlbnRpZnkoKTtcbiAgICBpZGVudGlmeS5zZXQoZ3JvdXBUeXBlLCBncm91cE5hbWUpO1xuICAgIHZhciBncm91cEV2ZW50ID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGV2ZW50T3B0aW9ucyksIHsgZXZlbnRfdHlwZTogU3BlY2lhbEV2ZW50VHlwZS5JREVOVElGWSwgdXNlcl9wcm9wZXJ0aWVzOiBpZGVudGlmeS5nZXRVc2VyUHJvcGVydGllcygpLCBncm91cHM6IChfYSA9IHt9LFxuICAgICAgICAgICAgX2FbZ3JvdXBUeXBlXSA9IGdyb3VwTmFtZSxcbiAgICAgICAgICAgIF9hKSB9KTtcbiAgICByZXR1cm4gZ3JvdXBFdmVudDtcbn07XG5leHBvcnQgdmFyIGNyZWF0ZVJldmVudWVFdmVudCA9IGZ1bmN0aW9uIChyZXZlbnVlLCBldmVudE9wdGlvbnMpIHtcbiAgICByZXR1cm4gX19hc3NpZ24oX19hc3NpZ24oe30sIGV2ZW50T3B0aW9ucyksIHsgZXZlbnRfdHlwZTogU3BlY2lhbEV2ZW50VHlwZS5SRVZFTlVFLCBldmVudF9wcm9wZXJ0aWVzOiByZXZlbnVlLmdldEV2ZW50UHJvcGVydGllcygpIH0pO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWV2ZW50LWJ1aWxkZXIuanMubWFwIiwiaW1wb3J0IHsgU3RhdHVzIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtdHlwZXMnO1xuZXhwb3J0IHZhciBidWlsZFJlc3VsdCA9IGZ1bmN0aW9uIChldmVudCwgY29kZSwgbWVzc2FnZSkge1xuICAgIGlmIChjb2RlID09PSB2b2lkIDApIHsgY29kZSA9IDA7IH1cbiAgICBpZiAobWVzc2FnZSA9PT0gdm9pZCAwKSB7IG1lc3NhZ2UgPSBTdGF0dXMuVW5rbm93bjsgfVxuICAgIHJldHVybiB7IGV2ZW50OiBldmVudCwgY29kZTogY29kZSwgbWVzc2FnZTogbWVzc2FnZSB9O1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlc3VsdC1idWlsZGVyLmpzLm1hcCIsImV4cG9ydCB2YXIgcmV0dXJuV3JhcHBlciA9IGZ1bmN0aW9uIChhd2FpdGFibGUpIHsgcmV0dXJuICh7XG4gICAgcHJvbWlzZTogYXdhaXRhYmxlIHx8IFByb21pc2UucmVzb2x2ZSgpLFxufSk7IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXR1cm4td3JhcHBlci5qcy5tYXAiLCIvKipcbiAqIFNvdXJjZTogW2plZCdzIGdpc3Rde0BsaW5rIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tLzk4Mjg4M30uXG4gKiBSZXR1cm5zIGEgcmFuZG9tIHY0IFVVSUQgb2YgdGhlIGZvcm0geHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4LFxuICogd2hlcmUgZWFjaCB4IGlzIHJlcGxhY2VkIHdpdGggYSByYW5kb20gaGV4YWRlY2ltYWwgZGlnaXQgZnJvbSAwIHRvIGYsIGFuZFxuICogeSBpcyByZXBsYWNlZCB3aXRoIGEgcmFuZG9tIGhleGFkZWNpbWFsIGRpZ2l0IGZyb20gOCB0byBiLlxuICogVXNlZCB0byBnZW5lcmF0ZSBVVUlEcyBmb3IgZGV2aWNlSWRzLlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IHZhciBVVUlEID0gZnVuY3Rpb24gKGEpIHtcbiAgICByZXR1cm4gYSAvLyBpZiB0aGUgcGxhY2Vob2xkZXIgd2FzIHBhc3NlZCwgcmV0dXJuXG4gICAgICAgID8gLy8gYSByYW5kb20gbnVtYmVyIGZyb20gMCB0byAxNVxuICAgICAgICAgICAgKGEgXiAvLyB1bmxlc3MgYiBpcyA4LFxuICAgICAgICAgICAgICAgICgoTWF0aC5yYW5kb20oKSAqIC8vIGluIHdoaWNoIGNhc2VcbiAgICAgICAgICAgICAgICAgICAgMTYpID4+IC8vIGEgcmFuZG9tIG51bWJlciBmcm9tXG4gICAgICAgICAgICAgICAgICAgIChhIC8gNCkpKSAvLyA4IHRvIDExXG4gICAgICAgICAgICAgICAgLnRvU3RyaW5nKDE2KSAvLyBpbiBoZXhhZGVjaW1hbFxuICAgICAgICA6IC8vIG9yIG90aGVyd2lzZSBhIGNvbmNhdGVuYXRlZCBzdHJpbmc6XG4gICAgICAgICAgICAoU3RyaW5nKDFlNykgKyAvLyAxMDAwMDAwMCArXG4gICAgICAgICAgICAgICAgU3RyaW5nKC0xZTMpICsgLy8gLTEwMDAgK1xuICAgICAgICAgICAgICAgIFN0cmluZygtNGUzKSArIC8vIC00MDAwICtcbiAgICAgICAgICAgICAgICBTdHJpbmcoLThlMykgKyAvLyAtODAwMDAwMDAgK1xuICAgICAgICAgICAgICAgIFN0cmluZygtMWUxMSkpIC8vIC0xMDAwMDAwMDAwMDAsXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXG4gICAgICAgICAgICAvLyByZXBsYWNpbmdcbiAgICAgICAgICAgIC9bMDE4XS9nLCAvLyB6ZXJvZXMsIG9uZXMsIGFuZCBlaWdodHMgd2l0aFxuICAgICAgICAgICAgVVVJRCk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXVpZC5qcy5tYXAiLCJpbXBvcnQgeyBfX3ZhbHVlcyB9IGZyb20gXCJ0c2xpYlwiO1xudmFyIE1BWF9QUk9QRVJUWV9LRVlTID0gMTAwMDtcbmV4cG9ydCB2YXIgaXNWYWxpZE9iamVjdCA9IGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7XG4gICAgaWYgKE9iamVjdC5rZXlzKHByb3BlcnRpZXMpLmxlbmd0aCA+IE1BWF9QUk9QRVJUWV9LRVlTKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZm9yICh2YXIga2V5IGluIHByb3BlcnRpZXMpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxuICAgICAgICB2YXIgdmFsdWUgPSBwcm9wZXJ0aWVzW2tleV07XG4gICAgICAgIGlmICghaXNWYWxpZFByb3BlcnRpZXMoa2V5LCB2YWx1ZSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcbmV4cG9ydCB2YXIgaXNWYWxpZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAocHJvcGVydHksIHZhbHVlKSB7XG4gICAgdmFyIGVfMSwgX2E7XG4gICAgaWYgKHR5cGVvZiBwcm9wZXJ0eSAhPT0gJ3N0cmluZycpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgdmFyIGlzVmFsaWQgPSB0cnVlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgdmFsdWVfMSA9IF9fdmFsdWVzKHZhbHVlKSwgdmFsdWVfMV8xID0gdmFsdWVfMS5uZXh0KCk7ICF2YWx1ZV8xXzEuZG9uZTsgdmFsdWVfMV8xID0gdmFsdWVfMS5uZXh0KCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVFbGVtZW50ID0gdmFsdWVfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWVFbGVtZW50ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBpc1ZhbGlkT2JqZWN0KHZhbHVlRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFbJ251bWJlcicsICdzdHJpbmcnXS5pbmNsdWRlcyh0eXBlb2YgdmFsdWVFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVfMV8xICYmICF2YWx1ZV8xXzEuZG9uZSAmJiAoX2EgPSB2YWx1ZV8xLnJldHVybikpIF9hLmNhbGwodmFsdWVfMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXJndW1lbnRcbiAgICAgICAgcmV0dXJuIGlzVmFsaWRPYmplY3QodmFsdWUpO1xuICAgIH1cbiAgICBlbHNlIGlmICghWydudW1iZXInLCAnc3RyaW5nJywgJ2Jvb2xlYW4nXS5pbmNsdWRlcyh0eXBlb2YgdmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmFsaWQtcHJvcGVydGllcy5qcy5tYXAiLCJleHBvcnQgdmFyIElkZW50aWZ5T3BlcmF0aW9uO1xuKGZ1bmN0aW9uIChJZGVudGlmeU9wZXJhdGlvbikge1xuICAgIC8vIEJhc2UgT3BlcmF0aW9ucyB0byBzZXQgdmFsdWVzXG4gICAgSWRlbnRpZnlPcGVyYXRpb25bXCJTRVRcIl0gPSBcIiRzZXRcIjtcbiAgICBJZGVudGlmeU9wZXJhdGlvbltcIlNFVF9PTkNFXCJdID0gXCIkc2V0T25jZVwiO1xuICAgIC8vIE9wZXJhdGlvbnMgYXJvdW5kIG1vZGlmeWluZyBleGlzdGluZyB2YWx1ZXNcbiAgICBJZGVudGlmeU9wZXJhdGlvbltcIkFERFwiXSA9IFwiJGFkZFwiO1xuICAgIElkZW50aWZ5T3BlcmF0aW9uW1wiQVBQRU5EXCJdID0gXCIkYXBwZW5kXCI7XG4gICAgSWRlbnRpZnlPcGVyYXRpb25bXCJQUkVQRU5EXCJdID0gXCIkcHJlcGVuZFwiO1xuICAgIElkZW50aWZ5T3BlcmF0aW9uW1wiUkVNT1ZFXCJdID0gXCIkcmVtb3ZlXCI7XG4gICAgLy8gT3BlcmF0aW9ucyBhcm91bmQgYXBwZW5kaW5nIHZhbHVlcyAqaWYqIHRoZXkgYXJlbid0IHByZXNlbnRcbiAgICBJZGVudGlmeU9wZXJhdGlvbltcIlBSRUlOU0VSVFwiXSA9IFwiJHByZUluc2VydFwiO1xuICAgIElkZW50aWZ5T3BlcmF0aW9uW1wiUE9TVElOU0VSVFwiXSA9IFwiJHBvc3RJbnNlcnRcIjtcbiAgICAvLyBPcGVyYXRpb25zIGFyb3VuZCByZW1vdmluZyBwcm9wZXJ0aWVzL3ZhbHVlc1xuICAgIElkZW50aWZ5T3BlcmF0aW9uW1wiVU5TRVRcIl0gPSBcIiR1bnNldFwiO1xuICAgIElkZW50aWZ5T3BlcmF0aW9uW1wiQ0xFQVJfQUxMXCJdID0gXCIkY2xlYXJBbGxcIjtcbn0pKElkZW50aWZ5T3BlcmF0aW9uIHx8IChJZGVudGlmeU9wZXJhdGlvbiA9IHt9KSk7XG5leHBvcnQgdmFyIFJldmVudWVQcm9wZXJ0eTtcbihmdW5jdGlvbiAoUmV2ZW51ZVByb3BlcnR5KSB7XG4gICAgUmV2ZW51ZVByb3BlcnR5W1wiUkVWRU5VRV9QUk9EVUNUX0lEXCJdID0gXCIkcHJvZHVjdElkXCI7XG4gICAgUmV2ZW51ZVByb3BlcnR5W1wiUkVWRU5VRV9RVUFOVElUWVwiXSA9IFwiJHF1YW50aXR5XCI7XG4gICAgUmV2ZW51ZVByb3BlcnR5W1wiUkVWRU5VRV9QUklDRVwiXSA9IFwiJHByaWNlXCI7XG4gICAgUmV2ZW51ZVByb3BlcnR5W1wiUkVWRU5VRV9UWVBFXCJdID0gXCIkcmV2ZW51ZVR5cGVcIjtcbiAgICBSZXZlbnVlUHJvcGVydHlbXCJSRVZFTlVFXCJdID0gXCIkcmV2ZW51ZVwiO1xufSkoUmV2ZW51ZVByb3BlcnR5IHx8IChSZXZlbnVlUHJvcGVydHkgPSB7fSkpO1xuLyoqXG4gKiBTdHJpbmdzIHRoYXQgaGF2ZSBzcGVjaWFsIG1lYW5pbmcgd2hlbiB1c2VkIGFzIGFuIGV2ZW50J3MgdHlwZVxuICogYW5kIGhhdmUgZGlmZmVyZW50IHNwZWNpZmljYXRpb25zLlxuICovXG5leHBvcnQgdmFyIFNwZWNpYWxFdmVudFR5cGU7XG4oZnVuY3Rpb24gKFNwZWNpYWxFdmVudFR5cGUpIHtcbiAgICBTcGVjaWFsRXZlbnRUeXBlW1wiSURFTlRJRllcIl0gPSBcIiRpZGVudGlmeVwiO1xuICAgIFNwZWNpYWxFdmVudFR5cGVbXCJHUk9VUF9JREVOVElGWVwiXSA9IFwiJGdyb3VwaWRlbnRpZnlcIjtcbiAgICBTcGVjaWFsRXZlbnRUeXBlW1wiUkVWRU5VRVwiXSA9IFwicmV2ZW51ZV9hbW91bnRcIjtcbn0pKFNwZWNpYWxFdmVudFR5cGUgfHwgKFNwZWNpYWxFdmVudFR5cGUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZXZlbnQuanMubWFwIiwiZXhwb3J0IHsgU3BlY2lhbEV2ZW50VHlwZSwgSWRlbnRpZnlPcGVyYXRpb24sIFJldmVudWVQcm9wZXJ0eSwgfSBmcm9tICcuL2V2ZW50JztcbmV4cG9ydCB7IExvZ0xldmVsIH0gZnJvbSAnLi9sb2dnZXInO1xuZXhwb3J0IHsgU2VydmVyWm9uZSB9IGZyb20gJy4vc2VydmVyLXpvbmUnO1xuZXhwb3J0IHsgU3RhdHVzIH0gZnJvbSAnLi9zdGF0dXMnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiZXhwb3J0IHZhciBMb2dMZXZlbDtcbihmdW5jdGlvbiAoTG9nTGV2ZWwpIHtcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIk5vbmVcIl0gPSAwXSA9IFwiTm9uZVwiO1xuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiRXJyb3JcIl0gPSAxXSA9IFwiRXJyb3JcIjtcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIldhcm5cIl0gPSAyXSA9IFwiV2FyblwiO1xuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiVmVyYm9zZVwiXSA9IDNdID0gXCJWZXJib3NlXCI7XG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJEZWJ1Z1wiXSA9IDRdID0gXCJEZWJ1Z1wiO1xufSkoTG9nTGV2ZWwgfHwgKExvZ0xldmVsID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvZ2dlci5qcy5tYXAiLCIvKipcbiAqIEBkZXByZWNhdGVkIHVzZSBTZXJ2ZXJab25lVHlwZSBpbnN0ZWFkXG4gKi9cbmV4cG9ydCB2YXIgU2VydmVyWm9uZTtcbihmdW5jdGlvbiAoU2VydmVyWm9uZSkge1xuICAgIFNlcnZlclpvbmVbXCJVU1wiXSA9IFwiVVNcIjtcbiAgICBTZXJ2ZXJab25lW1wiRVVcIl0gPSBcIkVVXCI7XG59KShTZXJ2ZXJab25lIHx8IChTZXJ2ZXJab25lID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlcnZlci16b25lLmpzLm1hcCIsIi8qKiBUaGUgc3RhdHVzIG9mIGFuIGV2ZW50LiAqL1xuZXhwb3J0IHZhciBTdGF0dXM7XG4oZnVuY3Rpb24gKFN0YXR1cykge1xuICAgIC8qKiBUaGUgc3RhdHVzIGNvdWxkIG5vdCBiZSBkZXRlcm1pbmVkLiAqL1xuICAgIFN0YXR1c1tcIlVua25vd25cIl0gPSBcInVua25vd25cIjtcbiAgICAvKiogVGhlIGV2ZW50IHdhcyBza2lwcGVkIGR1ZSB0byBjb25maWd1cmF0aW9uIG9yIGNhbGxiYWNrcy4gKi9cbiAgICBTdGF0dXNbXCJTa2lwcGVkXCJdID0gXCJza2lwcGVkXCI7XG4gICAgLyoqIFRoZSBldmVudCB3YXMgc2VudCBzdWNjZXNzZnVsbHkuICovXG4gICAgU3RhdHVzW1wiU3VjY2Vzc1wiXSA9IFwic3VjY2Vzc1wiO1xuICAgIC8qKiBBIHVzZXIgb3IgZGV2aWNlIGluIHRoZSBwYXlsb2FkIGlzIGN1cnJlbnRseSByYXRlIGxpbWl0ZWQgYW5kIHNob3VsZCB0cnkgYWdhaW4gbGF0ZXIuICovXG4gICAgU3RhdHVzW1wiUmF0ZUxpbWl0XCJdID0gXCJyYXRlX2xpbWl0XCI7XG4gICAgLyoqIFRoZSBzZW50IHBheWxvYWQgd2FzIHRvbyBsYXJnZSB0byBiZSBwcm9jZXNzZWQuICovXG4gICAgU3RhdHVzW1wiUGF5bG9hZFRvb0xhcmdlXCJdID0gXCJwYXlsb2FkX3Rvb19sYXJnZVwiO1xuICAgIC8qKiBUaGUgZXZlbnQgY291bGQgbm90IGJlIHByb2Nlc3NlZC4gKi9cbiAgICBTdGF0dXNbXCJJbnZhbGlkXCJdID0gXCJpbnZhbGlkXCI7XG4gICAgLyoqIEEgc2VydmVyLXNpZGUgZXJyb3Igb2N1cnJlZCBkdXJpbmcgc3VibWlzc2lvbi4gKi9cbiAgICBTdGF0dXNbXCJGYWlsZWRcIl0gPSBcImZhaWxlZFwiO1xuICAgIC8qKiBhIHNlcnZlciBvciBjbGllbnQgc2lkZSBlcnJvciBvY2N1cmluZyB3aGVuIGEgcmVxdWVzdCB0YWtlcyB0b28gbG9uZyBhbmQgaXMgY2FuY2VsbGVkICovXG4gICAgU3RhdHVzW1wiVGltZW91dFwiXSA9IFwiVGltZW91dFwiO1xuICAgIC8qKiBOb2RlSlMgcnVudGltZSBlbnZpcm9ubWVudCBlcnJvci4uIEUuZy4gZGlzY29ubmVjdGVkIGZyb20gbmV0d29yayAqL1xuICAgIFN0YXR1c1tcIlN5c3RlbUVycm9yXCJdID0gXCJTeXN0ZW1FcnJvclwiO1xufSkoU3RhdHVzIHx8IChTdGF0dXMgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RhdHVzLmpzLm1hcCIsImltcG9ydCB7IF9fYXNzaWduLCBfX2F3YWl0ZXIsIF9fZ2VuZXJhdG9yLCBfX3JlYWQsIF9fc3ByZWFkQXJyYXkgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IENhbXBhaWduUGFyc2VyLCBnZXRHbG9iYWxTY29wZSB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24nO1xuaW1wb3J0IHsgSWRlbnRpZnlPcGVyYXRpb24sIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtdHlwZXMnO1xuaW1wb3J0IHsgQkFTRV9DQU1QQUlHTiB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24nO1xuaW1wb3J0IHsgb21pdFVuZGVmaW5lZCB9IGZyb20gJy4vdXRpbHMnO1xuZXhwb3J0IHZhciBwYWdlVmlld1RyYWNraW5nUGx1Z2luID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSB7IG9wdGlvbnMgPSB7fTsgfVxuICAgIHZhciBhbXBsaXR1ZGU7XG4gICAgdmFyIGdsb2JhbFNjb3BlID0gZ2V0R2xvYmFsU2NvcGUoKTtcbiAgICB2YXIgbG9nZ2VyUHJvdmlkZXIgPSB1bmRlZmluZWQ7XG4gICAgdmFyIHB1c2hTdGF0ZTtcbiAgICB2YXIgY3JlYXRlUGFnZVZpZXdFdmVudCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIF9iO1xuICAgICAgICB2YXIgX2M7XG4gICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2QpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2QubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIF9iID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRfdHlwZTogKF9jID0gb3B0aW9ucy5ldmVudFR5cGUpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6ICdbQW1wbGl0dWRlXSBQYWdlIFZpZXdlZCdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBbe31dO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBnZXRDYW1wYWlnblBhcmFtcygpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbMiAvKnJldHVybiovLCAoX2IuZXZlbnRfcHJvcGVydGllcyA9IF9fYXNzaWduLmFwcGx5KHZvaWQgMCwgW19fYXNzaWduLmFwcGx5KHZvaWQgMCwgX2EuY29uY2F0KFsoX2Quc2VudCgpKV0pKSwgeyAnW0FtcGxpdHVkZV0gUGFnZSBEb21haW4nOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAodHlwZW9mIGxvY2F0aW9uICE9PSAndW5kZWZpbmVkJyAmJiBsb2NhdGlvbi5ob3N0bmFtZSkgfHwgJycsICdbQW1wbGl0dWRlXSBQYWdlIExvY2F0aW9uJzogXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHR5cGVvZiBsb2NhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiYgbG9jYXRpb24uaHJlZikgfHwgJycsICdbQW1wbGl0dWRlXSBQYWdlIFBhdGgnOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAodHlwZW9mIGxvY2F0aW9uICE9PSAndW5kZWZpbmVkJyAmJiBsb2NhdGlvbi5wYXRobmFtZSkgfHwgJycsICdbQW1wbGl0dWRlXSBQYWdlIFRpdGxlJzogLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8gKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQudGl0bGUpIHx8ICcnLCAnW0FtcGxpdHVkZV0gUGFnZSBVUkwnOiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLyAodHlwZW9mIGxvY2F0aW9uICE9PSAndW5kZWZpbmVkJyAmJiBsb2NhdGlvbi5ocmVmLnNwbGl0KCc/JylbMF0pIHx8ICcnIH1dKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iKV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyB9O1xuICAgIHZhciBzaG91bGRUcmFja09uUGFnZUxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb3B0aW9ucy50cmFja09uID09PSAndW5kZWZpbmVkJyB8fCAodHlwZW9mIG9wdGlvbnMudHJhY2tPbiA9PT0gJ2Z1bmN0aW9uJyAmJiBvcHRpb25zLnRyYWNrT24oKSk7XG4gICAgfTtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgIHZhciBwcmV2aW91c1VSTCA9IHR5cGVvZiBsb2NhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBsb2NhdGlvbi5ocmVmIDogbnVsbDtcbiAgICB2YXIgdHJhY2tIaXN0b3J5UGFnZVZpZXcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmV3VVJMLCBzaG91bGRUcmFja1BhZ2VWaWV3LCBfYSwgX2IsIF9jO1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9kKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9kLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBuZXdVUkwgPSBsb2NhdGlvbi5ocmVmO1xuICAgICAgICAgICAgICAgICAgICBzaG91bGRUcmFja1BhZ2VWaWV3ID0gc2hvdWxkVHJhY2tIaXN0b3J5UGFnZVZpZXcob3B0aW9ucy50cmFja0hpc3RvcnlDaGFuZ2VzLCBuZXdVUkwsIHByZXZpb3VzVVJMIHx8ICcnKSAmJiBzaG91bGRUcmFja09uUGFnZUxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogVXBkYXRlIGBwcmV2aW91c1VSTGAgaW4gdGhlIHNhbWUgY2xvY2sgdGljayBhcyBgc2hvdWxkVHJhY2tIaXN0b3J5UGFnZVZpZXcoKWBcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3YXMgcHJldmlvdXNseSBkb25lIGFmdGVyIGBhbXBsaXR1ZGU/LnRyYWNrKGF3YWl0IGNyZWF0ZVBhZ2VWaWV3RXZlbnQoKSk7YCBhbmRcbiAgICAgICAgICAgICAgICAgICAgLy8gY2F1c2VzIGEgY29uY3VycmVuY3kgaXNzdWUgd2hlcmUgYXBwIHRyaWdnZXJzIGBwdXNoU3RhdGVgIHR3aWNlIHdpdGggdGhlIHNhbWUgVVJMIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICAvLyBidXQgYHByZXZpb3VzVVJMYCBpcyBvbmx5IHVwZGF0ZWQgYWZ0ZXIgdGhlIHNlY29uZCBgcHVzaFN0YXRlYCBwcm9kdWNpbmcgdHdvIHBhZ2Ugdmlld2VkIGV2ZW50c1xuICAgICAgICAgICAgICAgICAgICBwcmV2aW91c1VSTCA9IG5ld1VSTDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaG91bGRUcmFja1BhZ2VWaWV3KSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyUHJvdmlkZXIgPT09IG51bGwgfHwgbG9nZ2VyUHJvdmlkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvZ2dlclByb3ZpZGVyLmxvZygnVHJhY2tpbmcgcGFnZSB2aWV3IGV2ZW50Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGFtcGxpdHVkZSA9PT0gbnVsbCB8fCBhbXBsaXR1ZGUgPT09IHZvaWQgMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICBfYSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBfYyA9IChfYiA9IGFtcGxpdHVkZSkudHJhY2s7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNyZWF0ZVBhZ2VWaWV3RXZlbnQoKV07XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBfYSA9IF9jLmFwcGx5KF9iLCBbX2Quc2VudCgpXSk7XG4gICAgICAgICAgICAgICAgICAgIF9kLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIF9hO1xuICAgICAgICAgICAgICAgICAgICBfZC5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyB9O1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgdmFyIHRyYWNrSGlzdG9yeVBhZ2VWaWV3V3JhcHBlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdm9pZCB0cmFja0hpc3RvcnlQYWdlVmlldygpO1xuICAgIH07XG4gICAgdmFyIHBsdWdpbiA9IHtcbiAgICAgICAgbmFtZTogJ0BhbXBsaXR1ZGUvcGx1Z2luLXBhZ2Utdmlldy10cmFja2luZy1icm93c2VyJyxcbiAgICAgICAgdHlwZTogJ2VucmljaG1lbnQnLFxuICAgICAgICBzZXR1cDogZnVuY3Rpb24gKGNvbmZpZywgY2xpZW50KSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGFtcGxpdHVkZSA9IGNsaWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlclByb3ZpZGVyID0gY29uZmlnLmxvZ2dlclByb3ZpZGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyUHJvdmlkZXIubG9nKCdJbnN0YWxsaW5nIEBhbXBsaXR1ZGUvcGx1Z2luLXBhZ2Utdmlldy10cmFja2luZy1icm93c2VyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2xvYmFsU2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTY29wZS5hZGRFdmVudExpc3RlbmVyKCdwb3BzdGF0ZScsIHRyYWNrSGlzdG9yeVBhZ2VWaWV3V3JhcHBlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSByZWZlcmVuY2UgdG8gb3JpZ2luYWwgcHVzaCBzdGF0ZSwgdG8gYmUgdXNlZCBpbiB0ZWFyZG93blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoU3RhdGUgPSBnbG9iYWxTY29wZS5oaXN0b3J5LnB1c2hTdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGdsb2JhbCBicm93c2VyIGxpc3RlbmVyIGZvciBjaGFuZ2VzIHRvIGhpc3RvcnksIHNvIHdlIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBtb2RpZnkgcHVzaFN0YXRlIGRpcmVjdGx5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS82NDkyNzYzOVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTY29wZS5oaXN0b3J5LnB1c2hTdGF0ZSA9IG5ldyBQcm94eShnbG9iYWxTY29wZS5oaXN0b3J5LnB1c2hTdGF0ZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBseTogZnVuY3Rpb24gKHRhcmdldCwgdGhpc0FyZywgX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYiA9IF9fcmVhZChfYSwgMyksIHN0YXRlID0gX2JbMF0sIHVudXNlZCA9IF9iWzFdLCB1cmwgPSBfYlsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5hcHBseSh0aGlzQXJnLCBbc3RhdGUsIHVudXNlZCwgdXJsXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIHRyYWNrSGlzdG9yeVBhZ2VWaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNob3VsZFRyYWNrT25QYWdlTG9hZCgpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlclByb3ZpZGVyLmxvZygnVHJhY2tpbmcgcGFnZSB2aWV3IGV2ZW50Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IChfYSA9IGFtcGxpdHVkZSkudHJhY2s7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjcmVhdGVQYWdlVmlld0V2ZW50KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5hcHBseShfYSwgW19jLnNlbnQoKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH0sXG4gICAgICAgIGV4ZWN1dGU6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwYWdlVmlld0V2ZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEob3B0aW9ucy50cmFja09uID09PSAnYXR0cmlidXRpb24nICYmIGlzQ2FtcGFpZ25FdmVudChldmVudCkpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovIC8vIGxvZ2dlclByb3ZpZGVyIHNob3VsZCBiZSBkZWZpbmVkIGJ5IHRoZSB0aW1lIGV4ZWN1dGUgaXMgaW52b2tlZFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyUHJvdmlkZXIgPT09IG51bGwgfHwgbG9nZ2VyUHJvdmlkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxvZ2dlclByb3ZpZGVyLmxvZygnRW5yaWNoaW5nIGNhbXBhaWduIGV2ZW50IHRvIHBhZ2UgdmlldyBldmVudCB3aXRoIGNhbXBhaWduIHBhcmFtZXRlcnMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNyZWF0ZVBhZ2VWaWV3RXZlbnQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VWaWV3RXZlbnQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5ldmVudF90eXBlID0gcGFnZVZpZXdFdmVudC5ldmVudF90eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZXZlbnRfcHJvcGVydGllcyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBldmVudC5ldmVudF9wcm9wZXJ0aWVzKSwgcGFnZVZpZXdFdmVudC5ldmVudF9wcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qLywgZXZlbnRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfSxcbiAgICAgICAgdGVhcmRvd246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdsb2JhbFNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbFNjb3BlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgdHJhY2tIaXN0b3J5UGFnZVZpZXdXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHB1c2hTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2NvcGUuaGlzdG9yeS5wdXNoU3RhdGUgPSBwdXNoU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9LFxuICAgIH07XG4gICAgcmV0dXJuIHBsdWdpbjtcbn07XG52YXIgZ2V0Q2FtcGFpZ25QYXJhbXMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgeyB2YXIgX2E7IHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIF9hID0gb21pdFVuZGVmaW5lZDtcbiAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIG5ldyBDYW1wYWlnblBhcnNlcigpLnBhcnNlKCldO1xuICAgICAgICBjYXNlIDE6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5hcHBseSh2b2lkIDAsIFtfYi5zZW50KCldKV07XG4gICAgfVxufSk7IH0pOyB9O1xudmFyIGlzQ2FtcGFpZ25FdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgIGlmIChldmVudC5ldmVudF90eXBlID09PSAnJGlkZW50aWZ5JyAmJiBldmVudC51c2VyX3Byb3BlcnRpZXMpIHtcbiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBldmVudC51c2VyX3Byb3BlcnRpZXM7XG4gICAgICAgIHZhciAkc2V0ID0gcHJvcGVydGllc1tJZGVudGlmeU9wZXJhdGlvbi5TRVRdIHx8IHt9O1xuICAgICAgICB2YXIgJHVuc2V0ID0gcHJvcGVydGllc1tJZGVudGlmeU9wZXJhdGlvbi5VTlNFVF0gfHwge307XG4gICAgICAgIHZhciB1c2VyUHJvcGVydGllc18xID0gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQoT2JqZWN0LmtleXMoJHNldCkpLCBmYWxzZSksIF9fcmVhZChPYmplY3Qua2V5cygkdW5zZXQpKSwgZmFsc2UpO1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoQkFTRV9DQU1QQUlHTikuZXZlcnkoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB1c2VyUHJvcGVydGllc18xLmluY2x1ZGVzKHZhbHVlKTsgfSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5leHBvcnQgdmFyIHNob3VsZFRyYWNrSGlzdG9yeVBhZ2VWaWV3ID0gZnVuY3Rpb24gKHRyYWNraW5nT3B0aW9uLCBuZXdVUkwsIG9sZFVSTCkge1xuICAgIHN3aXRjaCAodHJhY2tpbmdPcHRpb24pIHtcbiAgICAgICAgY2FzZSAncGF0aE9ubHknOlxuICAgICAgICAgICAgcmV0dXJuIG5ld1VSTC5zcGxpdCgnPycpWzBdICE9PSBvbGRVUkwuc3BsaXQoJz8nKVswXTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBuZXdVUkwgIT09IG9sZFVSTDtcbiAgICB9XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZS12aWV3LXRyYWNraW5nLmpzLm1hcCIsImV4cG9ydCB2YXIgb21pdFVuZGVmaW5lZCA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIHZhciBvYmogPSB7fTtcbiAgICBmb3IgKHZhciBrZXkgaW4gaW5wdXQpIHtcbiAgICAgICAgdmFyIHZhbCA9IGlucHV0W2tleV07XG4gICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICAgIG9ialtrZXldID0gdmFsO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIiwiaW1wb3J0IHsgX19hc3NpZ24sIF9fcmVhZCwgX19yZXN0IH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBCQVNFX0NBTVBBSUdOIH0gZnJvbSAnQGFtcGxpdHVkZS9hbmFseXRpY3MtY2xpZW50LWNvbW1vbic7XG5pbXBvcnQgeyBBTVBMSVRVREVfUFJFRklYLCBjcmVhdGVJZGVudGlmeUV2ZW50LCBJZGVudGlmeSB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNvcmUnO1xuZXhwb3J0IHZhciBnZXRTdG9yYWdlS2V5ID0gZnVuY3Rpb24gKGFwaUtleSwgcG9zdEtleSwgbGltaXQpIHtcbiAgICBpZiAocG9zdEtleSA9PT0gdm9pZCAwKSB7IHBvc3RLZXkgPSAnJzsgfVxuICAgIGlmIChsaW1pdCA9PT0gdm9pZCAwKSB7IGxpbWl0ID0gMTA7IH1cbiAgICByZXR1cm4gW0FNUExJVFVERV9QUkVGSVgsIHBvc3RLZXksIGFwaUtleS5zdWJzdHJpbmcoMCwgbGltaXQpXS5maWx0ZXIoQm9vbGVhbikuam9pbignXycpO1xufTtcbnZhciBkb21haW5XaXRob3V0U3ViZG9tYWluID0gZnVuY3Rpb24gKGRvbWFpbikge1xuICAgIHZhciBwYXJ0cyA9IGRvbWFpbi5zcGxpdCgnLicpO1xuICAgIGlmIChwYXJ0cy5sZW5ndGggPD0gMikge1xuICAgICAgICByZXR1cm4gZG9tYWluO1xuICAgIH1cbiAgICByZXR1cm4gcGFydHMuc2xpY2UocGFydHMubGVuZ3RoIC0gMiwgcGFydHMubGVuZ3RoKS5qb2luKCcuJyk7XG59O1xuZXhwb3J0IHZhciBpc05ld0NhbXBhaWduID0gZnVuY3Rpb24gKGN1cnJlbnQsIHByZXZpb3VzLCBvcHRpb25zKSB7XG4gICAgdmFyIHJlZmVycmVyID0gY3VycmVudC5yZWZlcnJlciwgcmVmZXJyaW5nX2RvbWFpbiA9IGN1cnJlbnQucmVmZXJyaW5nX2RvbWFpbiwgY3VycmVudENhbXBhaWduID0gX19yZXN0KGN1cnJlbnQsIFtcInJlZmVycmVyXCIsIFwicmVmZXJyaW5nX2RvbWFpblwiXSk7XG4gICAgdmFyIF9hID0gcHJldmlvdXMgfHwge30sIF9wcmV2aW91c19yZWZlcnJlciA9IF9hLnJlZmVycmVyLCBwcmV2UmVmZXJyaW5nRG9tYWluID0gX2EucmVmZXJyaW5nX2RvbWFpbiwgcHJldmlvdXNDYW1wYWlnbiA9IF9fcmVzdChfYSwgW1wicmVmZXJyZXJcIiwgXCJyZWZlcnJpbmdfZG9tYWluXCJdKTtcbiAgICBpZiAoaXNFeGNsdWRlZFJlZmVycmVyKG9wdGlvbnMuZXhjbHVkZVJlZmVycmVycywgY3VycmVudC5yZWZlcnJpbmdfZG9tYWluKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBoYXNOZXdDYW1wYWlnbiA9IEpTT04uc3RyaW5naWZ5KGN1cnJlbnRDYW1wYWlnbikgIT09IEpTT04uc3RyaW5naWZ5KHByZXZpb3VzQ2FtcGFpZ24pO1xuICAgIHZhciBoYXNOZXdEb21haW4gPSBkb21haW5XaXRob3V0U3ViZG9tYWluKHJlZmVycmluZ19kb21haW4gfHwgJycpICE9PSBkb21haW5XaXRob3V0U3ViZG9tYWluKHByZXZSZWZlcnJpbmdEb21haW4gfHwgJycpO1xuICAgIHJldHVybiAhcHJldmlvdXMgfHwgaGFzTmV3Q2FtcGFpZ24gfHwgaGFzTmV3RG9tYWluO1xufTtcbmV4cG9ydCB2YXIgaXNFeGNsdWRlZFJlZmVycmVyID0gZnVuY3Rpb24gKGV4Y2x1ZGVSZWZlcnJlcnMsIHJlZmVycmluZ0RvbWFpbikge1xuICAgIGlmIChleGNsdWRlUmVmZXJyZXJzID09PSB2b2lkIDApIHsgZXhjbHVkZVJlZmVycmVycyA9IFtdOyB9XG4gICAgaWYgKHJlZmVycmluZ0RvbWFpbiA9PT0gdm9pZCAwKSB7IHJlZmVycmluZ0RvbWFpbiA9ICcnOyB9XG4gICAgcmV0dXJuIGV4Y2x1ZGVSZWZlcnJlcnMuc29tZShmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUmVnRXhwID8gdmFsdWUudGVzdChyZWZlcnJpbmdEb21haW4pIDogdmFsdWUgPT09IHJlZmVycmluZ0RvbWFpbjtcbiAgICB9KTtcbn07XG5leHBvcnQgdmFyIGNyZWF0ZUNhbXBhaWduRXZlbnQgPSBmdW5jdGlvbiAoY2FtcGFpZ24sIG9wdGlvbnMpIHtcbiAgICB2YXIgY2FtcGFpZ25QYXJhbWV0ZXJzID0gX19hc3NpZ24oX19hc3NpZ24oe30sIEJBU0VfQ0FNUEFJR04pLCBjYW1wYWlnbik7XG4gICAgdmFyIGlkZW50aWZ5RXZlbnQgPSBPYmplY3QuZW50cmllcyhjYW1wYWlnblBhcmFtZXRlcnMpLnJlZHVjZShmdW5jdGlvbiAoaWRlbnRpZnksIF9hKSB7XG4gICAgICAgIHZhciBfYjtcbiAgICAgICAgdmFyIF9jID0gX19yZWFkKF9hLCAyKSwga2V5ID0gX2NbMF0sIHZhbHVlID0gX2NbMV07XG4gICAgICAgIGlkZW50aWZ5LnNldE9uY2UoXCJpbml0aWFsX1wiLmNvbmNhdChrZXkpLCAoX2IgPSB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdm9pZCAwID8gdmFsdWUgOiBvcHRpb25zLmluaXRpYWxFbXB0eVZhbHVlKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAnRU1QVFknKTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gaWRlbnRpZnkuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpZGVudGlmeS51bnNldChrZXkpO1xuICAgIH0sIG5ldyBJZGVudGlmeSgpKTtcbiAgICByZXR1cm4gY3JlYXRlSWRlbnRpZnlFdmVudChpZGVudGlmeUV2ZW50KTtcbn07XG5leHBvcnQgdmFyIGdldERlZmF1bHRFeGNsdWRlZFJlZmVycmVycyA9IGZ1bmN0aW9uIChjb29raWVEb21haW4pIHtcbiAgICB2YXIgZG9tYWluID0gY29va2llRG9tYWluO1xuICAgIGlmIChkb21haW4pIHtcbiAgICAgICAgaWYgKGRvbWFpbi5zdGFydHNXaXRoKCcuJykpIHtcbiAgICAgICAgICAgIGRvbWFpbiA9IGRvbWFpbi5zdWJzdHJpbmcoMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtuZXcgUmVnRXhwKFwiXCIuY29uY2F0KGRvbWFpbi5yZXBsYWNlKCcuJywgJ1xcXFwuJyksIFwiJFwiKSldO1xuICAgIH1cbiAgICByZXR1cm4gW107XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aGVscGVycy5qcy5tYXAiLCJpbXBvcnQgeyBfX2Fzc2lnbiwgX19hd2FpdGVyLCBfX2dlbmVyYXRvciwgX19yZWFkIH0gZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBDYW1wYWlnblBhcnNlciB9IGZyb20gJ0BhbXBsaXR1ZGUvYW5hbHl0aWNzLWNsaWVudC1jb21tb24nO1xuaW1wb3J0IHsgY3JlYXRlQ2FtcGFpZ25FdmVudCwgZ2V0RGVmYXVsdEV4Y2x1ZGVkUmVmZXJyZXJzLCBnZXRTdG9yYWdlS2V5LCBpc05ld0NhbXBhaWduIH0gZnJvbSAnLi9oZWxwZXJzJztcbmV4cG9ydCB2YXIgd2ViQXR0cmlidXRpb25QbHVnaW4gPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0ge307IH1cbiAgICB2YXIgcGx1Z2luID0ge1xuICAgICAgICBuYW1lOiAnQGFtcGxpdHVkZS9wbHVnaW4td2ViLWF0dHJpYnV0aW9uLWJyb3dzZXInLFxuICAgICAgICB0eXBlOiAnYmVmb3JlJyxcbiAgICAgICAgc2V0dXA6IGZ1bmN0aW9uIChjb25maWcsIGFtcGxpdHVkZSkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbHVnaW5Db25maWcsIHN0b3JhZ2UsIHN0b3JhZ2VLZXksIF9iLCBjdXJyZW50Q2FtcGFpZ24sIHByZXZpb3VzQ2FtcGFpZ24sIGNhbXBhaWduRXZlbnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luQ29uZmlnID0gX19hc3NpZ24oeyBpbml0aWFsRW1wdHlWYWx1ZTogJ0VNUFRZJywgcmVzZXRTZXNzaW9uT25OZXdDYW1wYWlnbjogZmFsc2UsIGV4Y2x1ZGVSZWZlcnJlcnM6IGdldERlZmF1bHRFeGNsdWRlZFJlZmVycmVycygoX2EgPSBjb25maWcuY29va2llT3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRvbWFpbikgfSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmxvZ2dlclByb3ZpZGVyLmxvZygnSW5zdGFsbGluZyBAYW1wbGl0dWRlL3BsdWdpbi13ZWItYXR0cmlidXRpb24tYnJvd3Nlci4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9yYWdlID0gY29uZmlnLmNvb2tpZVN0b3JhZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZUtleSA9IGdldFN0b3JhZ2VLZXkoY29uZmlnLmFwaUtleSwgJ01LVEcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQ2FtcGFpZ25QYXJzZXIoKS5wYXJzZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZS5nZXQoc3RvcmFnZUtleSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYiA9IF9fcmVhZC5hcHBseSh2b2lkIDAsIFtfYy5zZW50KCksIDJdKSwgY3VycmVudENhbXBhaWduID0gX2JbMF0sIHByZXZpb3VzQ2FtcGFpZ24gPSBfYlsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOZXdDYW1wYWlnbihjdXJyZW50Q2FtcGFpZ24sIHByZXZpb3VzQ2FtcGFpZ24sIHBsdWdpbkNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsdWdpbkNvbmZpZy5yZXNldFNlc3Npb25Pbk5ld0NhbXBhaWduKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBsaXR1ZGUuc2V0U2Vzc2lvbklkKERhdGUubm93KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmxvZ2dlclByb3ZpZGVyLmxvZygnQ3JlYXRlZCBhIG5ldyBzZXNzaW9uIGZvciBuZXcgY2FtcGFpZ24uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmxvZ2dlclByb3ZpZGVyLmxvZygnVHJhY2tpbmcgYXR0cmlidXRpb24uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbXBhaWduRXZlbnQgPSBjcmVhdGVDYW1wYWlnbkV2ZW50KGN1cnJlbnRDYW1wYWlnbiwgcGx1Z2luQ29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wbGl0dWRlLnRyYWNrKGNhbXBhaWduRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIHN0b3JhZ2Uuc2V0KHN0b3JhZ2VLZXksIGN1cnJlbnRDYW1wYWlnbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGV4ZWN1dGU6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZXZlbnRdO1xuICAgICAgICB9KTsgfSk7IH0sXG4gICAgfTtcbiAgICByZXR1cm4gcGx1Z2luO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdlYi1hdHRyaWJ1dGlvbi5qcy5tYXAiLCIndXNlIHN0cmljdCdcbi8qIGdsb2JhbCBmZXRjaCwgYnRvYSwgSGVhZGVycyAqL1xuY29uc3QgY29yZSA9IHJlcXVpcmUoJy4vY29yZScpXG5cbmNsYXNzIFN0YXR1c0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvciAocmVzLCAuLi5wYXJhbXMpIHtcbiAgICBzdXBlciguLi5wYXJhbXMpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIFN0YXR1c0Vycm9yKVxuICAgIH1cblxuICAgIHRoaXMubmFtZSA9ICdTdGF0dXNFcnJvcidcbiAgICB0aGlzLm1lc3NhZ2UgPSByZXMuc3RhdHVzTWVzc2FnZVxuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHJlcy5zdGF0dXNcbiAgICB0aGlzLnJlcyA9IHJlc1xuICAgIHRoaXMuanNvbiA9IHJlcy5qc29uLmJpbmQocmVzKVxuICAgIHRoaXMudGV4dCA9IHJlcy50ZXh0LmJpbmQocmVzKVxuICAgIHRoaXMuYXJyYXlCdWZmZXIgPSByZXMuYXJyYXlCdWZmZXIuYmluZChyZXMpXG4gICAgbGV0IGJ1ZmZlclxuICAgIGNvbnN0IGdldCA9ICgpID0+IHtcbiAgICAgIGlmICghYnVmZmVyKSBidWZmZXIgPSB0aGlzLmFycmF5QnVmZmVyKClcbiAgICAgIHJldHVybiBidWZmZXJcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdyZXNwb25zZUJvZHknLCB7IGdldCB9KVxuICAgIC8vIG1hdGNoIE5vZGUuanMgaGVhZGVycyBvYmplY3RcbiAgICB0aGlzLmhlYWRlcnMgPSB7fVxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIHJlcy5oZWFkZXJzLmVudHJpZXMoKSkge1xuICAgICAgdGhpcy5oZWFkZXJzW2tleS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlXG4gICAgfVxuICB9XG59XG5cbmNvbnN0IG1rcmVxdWVzdCA9IChzdGF0dXNDb2RlcywgbWV0aG9kLCBlbmNvZGluZywgaGVhZGVycywgYmFzZXVybCkgPT4gYXN5bmMgKF91cmwsIGJvZHksIF9oZWFkZXJzID0ge30pID0+IHtcbiAgX3VybCA9IGJhc2V1cmwgKyAoX3VybCB8fCAnJylcbiAgbGV0IHBhcnNlZCA9IG5ldyBVUkwoX3VybClcblxuICBpZiAoIWhlYWRlcnMpIGhlYWRlcnMgPSB7fVxuICBpZiAocGFyc2VkLnVzZXJuYW1lKSB7XG4gICAgaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0Jhc2ljICcgKyBidG9hKHBhcnNlZC51c2VybmFtZSArICc6JyArIHBhcnNlZC5wYXNzd29yZClcbiAgICBwYXJzZWQgPSBuZXcgVVJMKHBhcnNlZC5wcm90b2NvbCArICcvLycgKyBwYXJzZWQuaG9zdCArIHBhcnNlZC5wYXRobmFtZSArIHBhcnNlZC5zZWFyY2gpXG4gIH1cbiAgaWYgKHBhcnNlZC5wcm90b2NvbCAhPT0gJ2h0dHBzOicgJiYgcGFyc2VkLnByb3RvY29sICE9PSAnaHR0cDonKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHByb3RvY29sLCAke3BhcnNlZC5wcm90b2NvbH1gKVxuICB9XG5cbiAgaWYgKGJvZHkpIHtcbiAgICBpZiAoYm9keSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8XG4gICAgICBBcnJheUJ1ZmZlci5pc1ZpZXcoYm9keSkgfHxcbiAgICAgIHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJ1xuICAgICkge1xuICAgICAgLy8gbm9vcFxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGJvZHkgPT09ICdvYmplY3QnKSB7XG4gICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoYm9keSlcbiAgICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBib2R5IHR5cGUuJylcbiAgICB9XG4gIH1cblxuICBfaGVhZGVycyA9IG5ldyBIZWFkZXJzKHsgLi4uKGhlYWRlcnMgfHwge30pLCAuLi5faGVhZGVycyB9KVxuXG4gIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChwYXJzZWQsIHsgbWV0aG9kLCBoZWFkZXJzOiBfaGVhZGVycywgYm9keSB9KVxuICByZXNwLnN0YXR1c0NvZGUgPSByZXNwLnN0YXR1c1xuXG4gIGlmICghc3RhdHVzQ29kZXMuaGFzKHJlc3Auc3RhdHVzKSkge1xuICAgIHRocm93IG5ldyBTdGF0dXNFcnJvcihyZXNwKVxuICB9XG5cbiAgaWYgKGVuY29kaW5nID09PSAnanNvbicpIHJldHVybiByZXNwLmpzb24oKVxuICBlbHNlIGlmIChlbmNvZGluZyA9PT0gJ2J1ZmZlcicpIHJldHVybiByZXNwLmFycmF5QnVmZmVyKClcbiAgZWxzZSBpZiAoZW5jb2RpbmcgPT09ICdzdHJpbmcnKSByZXR1cm4gcmVzcC50ZXh0KClcbiAgZWxzZSByZXR1cm4gcmVzcFxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNvcmUobWtyZXF1ZXN0KVxuIiwiJ3VzZSBzdHJpY3QnXG5jb25zdCBlbmNvZGluZ3MgPSBuZXcgU2V0KFsnanNvbicsICdidWZmZXInLCAnc3RyaW5nJ10pXG5cbm1vZHVsZS5leHBvcnRzID0gbWtyZXF1ZXN0ID0+ICguLi5hcmdzKSA9PiB7XG4gIGNvbnN0IHN0YXR1c0NvZGVzID0gbmV3IFNldCgpXG4gIGxldCBtZXRob2RcbiAgbGV0IGVuY29kaW5nXG4gIGxldCBoZWFkZXJzXG4gIGxldCBiYXNldXJsID0gJydcblxuICBhcmdzLmZvckVhY2goYXJnID0+IHtcbiAgICBpZiAodHlwZW9mIGFyZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGlmIChhcmcudG9VcHBlckNhc2UoKSA9PT0gYXJnKSB7XG4gICAgICAgIGlmIChtZXRob2QpIHtcbiAgICAgICAgICBjb25zdCBtc2cgPSBgQ2FuJ3Qgc2V0IG1ldGhvZCB0byAke2FyZ30sIGFscmVhZHkgc2V0IHRvICR7bWV0aG9kfS5gXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZXRob2QgPSBhcmdcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChhcmcuc3RhcnRzV2l0aCgnaHR0cDonKSB8fCBhcmcuc3RhcnRzV2l0aCgnaHR0cHM6JykpIHtcbiAgICAgICAgYmFzZXVybCA9IGFyZ1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGVuY29kaW5ncy5oYXMoYXJnKSkge1xuICAgICAgICAgIGVuY29kaW5nID0gYXJnXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGVuY29kaW5nLCAke2FyZ31gKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJykge1xuICAgICAgc3RhdHVzQ29kZXMuYWRkKGFyZylcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShhcmcpIHx8IGFyZyBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICBhcmcuZm9yRWFjaChjb2RlID0+IHN0YXR1c0NvZGVzLmFkZChjb2RlKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3Qgc2V0IGhlYWRlcnMgdHdpY2UuJylcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzID0gYXJnXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB0eXBlOiAke3R5cGVvZiBhcmd9YClcbiAgICB9XG4gIH0pXG5cbiAgaWYgKCFtZXRob2QpIG1ldGhvZCA9ICdHRVQnXG4gIGlmIChzdGF0dXNDb2Rlcy5zaXplID09PSAwKSB7XG4gICAgc3RhdHVzQ29kZXMuYWRkKDIwMClcbiAgfVxuXG4gIHJldHVybiBta3JlcXVlc3Qoc3RhdHVzQ29kZXMsIG1ldGhvZCwgZW5jb2RpbmcsIGhlYWRlcnMsIGJhc2V1cmwpXG59XG4iLCIvKiFcbiAqIGNvbnRlbnQtdHlwZVxuICogQ29weXJpZ2h0KGMpIDIwMTUgRG91Z2xhcyBDaHJpc3RvcGhlciBXaWxzb25cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbid1c2Ugc3RyaWN0J1xuXG4vKipcbiAqIFJlZ0V4cCB0byBtYXRjaCAqKCBcIjtcIiBwYXJhbWV0ZXIgKSBpbiBSRkMgNzIzMSBzZWMgMy4xLjEuMVxuICpcbiAqIHBhcmFtZXRlciAgICAgPSB0b2tlbiBcIj1cIiAoIHRva2VuIC8gcXVvdGVkLXN0cmluZyApXG4gKiB0b2tlbiAgICAgICAgID0gMSp0Y2hhclxuICogdGNoYXIgICAgICAgICA9IFwiIVwiIC8gXCIjXCIgLyBcIiRcIiAvIFwiJVwiIC8gXCImXCIgLyBcIidcIiAvIFwiKlwiXG4gKiAgICAgICAgICAgICAgIC8gXCIrXCIgLyBcIi1cIiAvIFwiLlwiIC8gXCJeXCIgLyBcIl9cIiAvIFwiYFwiIC8gXCJ8XCIgLyBcIn5cIlxuICogICAgICAgICAgICAgICAvIERJR0lUIC8gQUxQSEFcbiAqICAgICAgICAgICAgICAgOyBhbnkgVkNIQVIsIGV4Y2VwdCBkZWxpbWl0ZXJzXG4gKiBxdW90ZWQtc3RyaW5nID0gRFFVT1RFICooIHFkdGV4dCAvIHF1b3RlZC1wYWlyICkgRFFVT1RFXG4gKiBxZHRleHQgICAgICAgID0gSFRBQiAvIFNQIC8gJXgyMSAvICV4MjMtNUIgLyAleDVELTdFIC8gb2JzLXRleHRcbiAqIG9icy10ZXh0ICAgICAgPSAleDgwLUZGXG4gKiBxdW90ZWQtcGFpciAgID0gXCJcXFwiICggSFRBQiAvIFNQIC8gVkNIQVIgLyBvYnMtdGV4dCApXG4gKi9cbnZhciBQQVJBTV9SRUdFWFAgPSAvOyAqKFshIyQlJicqKy5eX2B8fjAtOUEtWmEtei1dKykgKj0gKihcIig/OltcXHUwMDBiXFx1MDAyMFxcdTAwMjFcXHUwMDIzLVxcdTAwNWJcXHUwMDVkLVxcdTAwN2VcXHUwMDgwLVxcdTAwZmZdfFxcXFxbXFx1MDAwYlxcdTAwMjAtXFx1MDBmZl0pKlwifFshIyQlJicqKy5eX2B8fjAtOUEtWmEtei1dKykgKi9nIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29udHJvbC1yZWdleFxudmFyIFRFWFRfUkVHRVhQID0gL15bXFx1MDAwYlxcdTAwMjAtXFx1MDA3ZVxcdTAwODAtXFx1MDBmZl0rJC8gLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb250cm9sLXJlZ2V4XG52YXIgVE9LRU5fUkVHRVhQID0gL15bISMkJSYnKisuXl9gfH4wLTlBLVphLXotXSskL1xuXG4vKipcbiAqIFJlZ0V4cCB0byBtYXRjaCBxdW90ZWQtcGFpciBpbiBSRkMgNzIzMCBzZWMgMy4yLjZcbiAqXG4gKiBxdW90ZWQtcGFpciA9IFwiXFxcIiAoIEhUQUIgLyBTUCAvIFZDSEFSIC8gb2JzLXRleHQgKVxuICogb2JzLXRleHQgICAgPSAleDgwLUZGXG4gKi9cbnZhciBRRVNDX1JFR0VYUCA9IC9cXFxcKFtcXHUwMDBiXFx1MDAyMC1cXHUwMGZmXSkvZyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnRyb2wtcmVnZXhcblxuLyoqXG4gKiBSZWdFeHAgdG8gbWF0Y2ggY2hhcnMgdGhhdCBtdXN0IGJlIHF1b3RlZC1wYWlyIGluIFJGQyA3MjMwIHNlYyAzLjIuNlxuICovXG52YXIgUVVPVEVfUkVHRVhQID0gLyhbXFxcXFwiXSkvZ1xuXG4vKipcbiAqIFJlZ0V4cCB0byBtYXRjaCB0eXBlIGluIFJGQyA3MjMxIHNlYyAzLjEuMS4xXG4gKlxuICogbWVkaWEtdHlwZSA9IHR5cGUgXCIvXCIgc3VidHlwZVxuICogdHlwZSAgICAgICA9IHRva2VuXG4gKiBzdWJ0eXBlICAgID0gdG9rZW5cbiAqL1xudmFyIFRZUEVfUkVHRVhQID0gL15bISMkJSYnKisuXl9gfH4wLTlBLVphLXotXStcXC9bISMkJSYnKisuXl9gfH4wLTlBLVphLXotXSskL1xuXG4vKipcbiAqIE1vZHVsZSBleHBvcnRzLlxuICogQHB1YmxpY1xuICovXG5cbmV4cG9ydHMuZm9ybWF0ID0gZm9ybWF0XG5leHBvcnRzLnBhcnNlID0gcGFyc2VcblxuLyoqXG4gKiBGb3JtYXQgb2JqZWN0IHRvIG1lZGlhIHR5cGUuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IG9ialxuICogQHJldHVybiB7c3RyaW5nfVxuICogQHB1YmxpY1xuICovXG5cbmZ1bmN0aW9uIGZvcm1hdCAob2JqKSB7XG4gIGlmICghb2JqIHx8IHR5cGVvZiBvYmogIT09ICdvYmplY3QnKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignYXJndW1lbnQgb2JqIGlzIHJlcXVpcmVkJylcbiAgfVxuXG4gIHZhciBwYXJhbWV0ZXJzID0gb2JqLnBhcmFtZXRlcnNcbiAgdmFyIHR5cGUgPSBvYmoudHlwZVxuXG4gIGlmICghdHlwZSB8fCAhVFlQRV9SRUdFWFAudGVzdCh0eXBlKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgdHlwZScpXG4gIH1cblxuICB2YXIgc3RyaW5nID0gdHlwZVxuXG4gIC8vIGFwcGVuZCBwYXJhbWV0ZXJzXG4gIGlmIChwYXJhbWV0ZXJzICYmIHR5cGVvZiBwYXJhbWV0ZXJzID09PSAnb2JqZWN0Jykge1xuICAgIHZhciBwYXJhbVxuICAgIHZhciBwYXJhbXMgPSBPYmplY3Qua2V5cyhwYXJhbWV0ZXJzKS5zb3J0KClcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBwYXJhbSA9IHBhcmFtc1tpXVxuXG4gICAgICBpZiAoIVRPS0VOX1JFR0VYUC50ZXN0KHBhcmFtKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIHBhcmFtZXRlciBuYW1lJylcbiAgICAgIH1cblxuICAgICAgc3RyaW5nICs9ICc7ICcgKyBwYXJhbSArICc9JyArIHFzdHJpbmcocGFyYW1ldGVyc1twYXJhbV0pXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN0cmluZ1xufVxuXG4vKipcbiAqIFBhcnNlIG1lZGlhIHR5cGUgdG8gb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gc3RyaW5nXG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKiBAcHVibGljXG4gKi9cblxuZnVuY3Rpb24gcGFyc2UgKHN0cmluZykge1xuICBpZiAoIXN0cmluZykge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2FyZ3VtZW50IHN0cmluZyBpcyByZXF1aXJlZCcpXG4gIH1cblxuICAvLyBzdXBwb3J0IHJlcS9yZXMtbGlrZSBvYmplY3RzIGFzIGFyZ3VtZW50XG4gIHZhciBoZWFkZXIgPSB0eXBlb2Ygc3RyaW5nID09PSAnb2JqZWN0J1xuICAgID8gZ2V0Y29udGVudHR5cGUoc3RyaW5nKVxuICAgIDogc3RyaW5nXG5cbiAgaWYgKHR5cGVvZiBoZWFkZXIgIT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignYXJndW1lbnQgc3RyaW5nIGlzIHJlcXVpcmVkIHRvIGJlIGEgc3RyaW5nJylcbiAgfVxuXG4gIHZhciBpbmRleCA9IGhlYWRlci5pbmRleE9mKCc7JylcbiAgdmFyIHR5cGUgPSBpbmRleCAhPT0gLTFcbiAgICA/IGhlYWRlci5zbGljZSgwLCBpbmRleCkudHJpbSgpXG4gICAgOiBoZWFkZXIudHJpbSgpXG5cbiAgaWYgKCFUWVBFX1JFR0VYUC50ZXN0KHR5cGUpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBtZWRpYSB0eXBlJylcbiAgfVxuXG4gIHZhciBvYmogPSBuZXcgQ29udGVudFR5cGUodHlwZS50b0xvd2VyQ2FzZSgpKVxuXG4gIC8vIHBhcnNlIHBhcmFtZXRlcnNcbiAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgIHZhciBrZXlcbiAgICB2YXIgbWF0Y2hcbiAgICB2YXIgdmFsdWVcblxuICAgIFBBUkFNX1JFR0VYUC5sYXN0SW5kZXggPSBpbmRleFxuXG4gICAgd2hpbGUgKChtYXRjaCA9IFBBUkFNX1JFR0VYUC5leGVjKGhlYWRlcikpKSB7XG4gICAgICBpZiAobWF0Y2guaW5kZXggIT09IGluZGV4KSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgcGFyYW1ldGVyIGZvcm1hdCcpXG4gICAgICB9XG5cbiAgICAgIGluZGV4ICs9IG1hdGNoWzBdLmxlbmd0aFxuICAgICAga2V5ID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKVxuICAgICAgdmFsdWUgPSBtYXRjaFsyXVxuXG4gICAgICBpZiAodmFsdWUuY2hhckNvZGVBdCgwKSA9PT0gMHgyMiAvKiBcIiAqLykge1xuICAgICAgICAvLyByZW1vdmUgcXVvdGVzXG4gICAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoMSwgLTEpXG5cbiAgICAgICAgLy8gcmVtb3ZlIGVzY2FwZXNcbiAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YoJ1xcXFwnKSAhPT0gLTEpIHtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoUUVTQ19SRUdFWFAsICckMScpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgb2JqLnBhcmFtZXRlcnNba2V5XSA9IHZhbHVlXG4gICAgfVxuXG4gICAgaWYgKGluZGV4ICE9PSBoZWFkZXIubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIHBhcmFtZXRlciBmb3JtYXQnKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmpcbn1cblxuLyoqXG4gKiBHZXQgY29udGVudC10eXBlIGZyb20gcmVxL3JlcyBvYmplY3RzLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fVxuICogQHJldHVybiB7T2JqZWN0fVxuICogQHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBnZXRjb250ZW50dHlwZSAob2JqKSB7XG4gIHZhciBoZWFkZXJcblxuICBpZiAodHlwZW9mIG9iai5nZXRIZWFkZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAvLyByZXMtbGlrZVxuICAgIGhlYWRlciA9IG9iai5nZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScpXG4gIH0gZWxzZSBpZiAodHlwZW9mIG9iai5oZWFkZXJzID09PSAnb2JqZWN0Jykge1xuICAgIC8vIHJlcS1saWtlXG4gICAgaGVhZGVyID0gb2JqLmhlYWRlcnMgJiYgb2JqLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddXG4gIH1cblxuICBpZiAodHlwZW9mIGhlYWRlciAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdjb250ZW50LXR5cGUgaGVhZGVyIGlzIG1pc3NpbmcgZnJvbSBvYmplY3QnKVxuICB9XG5cbiAgcmV0dXJuIGhlYWRlclxufVxuXG4vKipcbiAqIFF1b3RlIGEgc3RyaW5nIGlmIG5lY2Vzc2FyeS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsXG4gKiBAcmV0dXJuIHtzdHJpbmd9XG4gKiBAcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIHFzdHJpbmcgKHZhbCkge1xuICB2YXIgc3RyID0gU3RyaW5nKHZhbClcblxuICAvLyBubyBuZWVkIHRvIHF1b3RlIHRva2Vuc1xuICBpZiAoVE9LRU5fUkVHRVhQLnRlc3Qoc3RyKSkge1xuICAgIHJldHVybiBzdHJcbiAgfVxuXG4gIGlmIChzdHIubGVuZ3RoID4gMCAmJiAhVEVYVF9SRUdFWFAudGVzdChzdHIpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignaW52YWxpZCBwYXJhbWV0ZXIgdmFsdWUnKVxuICB9XG5cbiAgcmV0dXJuICdcIicgKyBzdHIucmVwbGFjZShRVU9URV9SRUdFWFAsICdcXFxcJDEnKSArICdcIidcbn1cblxuLyoqXG4gKiBDbGFzcyB0byByZXByZXNlbnQgYSBjb250ZW50IHR5cGUuXG4gKiBAcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBDb250ZW50VHlwZSAodHlwZSkge1xuICB0aGlzLnBhcmFtZXRlcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpXG4gIHRoaXMudHlwZSA9IHR5cGVcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5mdW5jdGlvbiBjcmVhdGVQYXJzZXIob25QYXJzZSkge1xuICBsZXQgaXNGaXJzdENodW5rO1xuICBsZXQgYnVmZmVyO1xuICBsZXQgc3RhcnRpbmdQb3NpdGlvbjtcbiAgbGV0IHN0YXJ0aW5nRmllbGRMZW5ndGg7XG4gIGxldCBldmVudElkO1xuICBsZXQgZXZlbnROYW1lO1xuICBsZXQgZGF0YTtcbiAgcmVzZXQoKTtcbiAgcmV0dXJuIHtcbiAgICBmZWVkLFxuICAgIHJlc2V0XG4gIH07XG4gIGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgIGlzRmlyc3RDaHVuayA9IHRydWU7XG4gICAgYnVmZmVyID0gXCJcIjtcbiAgICBzdGFydGluZ1Bvc2l0aW9uID0gMDtcbiAgICBzdGFydGluZ0ZpZWxkTGVuZ3RoID0gLTE7XG4gICAgZXZlbnRJZCA9IHZvaWQgMDtcbiAgICBldmVudE5hbWUgPSB2b2lkIDA7XG4gICAgZGF0YSA9IFwiXCI7XG4gIH1cbiAgZnVuY3Rpb24gZmVlZChjaHVuaykge1xuICAgIGJ1ZmZlciA9IGJ1ZmZlciA/IGJ1ZmZlciArIGNodW5rIDogY2h1bms7XG4gICAgaWYgKGlzRmlyc3RDaHVuayAmJiBoYXNCb20oYnVmZmVyKSkge1xuICAgICAgYnVmZmVyID0gYnVmZmVyLnNsaWNlKEJPTS5sZW5ndGgpO1xuICAgIH1cbiAgICBpc0ZpcnN0Q2h1bmsgPSBmYWxzZTtcbiAgICBjb25zdCBsZW5ndGggPSBidWZmZXIubGVuZ3RoO1xuICAgIGxldCBwb3NpdGlvbiA9IDA7XG4gICAgbGV0IGRpc2NhcmRUcmFpbGluZ05ld2xpbmUgPSBmYWxzZTtcbiAgICB3aGlsZSAocG9zaXRpb24gPCBsZW5ndGgpIHtcbiAgICAgIGlmIChkaXNjYXJkVHJhaWxpbmdOZXdsaW5lKSB7XG4gICAgICAgIGlmIChidWZmZXJbcG9zaXRpb25dID09PSBcIlxcblwiKSB7XG4gICAgICAgICAgKytwb3NpdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBkaXNjYXJkVHJhaWxpbmdOZXdsaW5lID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBsZXQgbGluZUxlbmd0aCA9IC0xO1xuICAgICAgbGV0IGZpZWxkTGVuZ3RoID0gc3RhcnRpbmdGaWVsZExlbmd0aDtcbiAgICAgIGxldCBjaGFyYWN0ZXI7XG4gICAgICBmb3IgKGxldCBpbmRleCA9IHN0YXJ0aW5nUG9zaXRpb247IGxpbmVMZW5ndGggPCAwICYmIGluZGV4IDwgbGVuZ3RoOyArK2luZGV4KSB7XG4gICAgICAgIGNoYXJhY3RlciA9IGJ1ZmZlcltpbmRleF07XG4gICAgICAgIGlmIChjaGFyYWN0ZXIgPT09IFwiOlwiICYmIGZpZWxkTGVuZ3RoIDwgMCkge1xuICAgICAgICAgIGZpZWxkTGVuZ3RoID0gaW5kZXggLSBwb3NpdGlvbjtcbiAgICAgICAgfSBlbHNlIGlmIChjaGFyYWN0ZXIgPT09IFwiXFxyXCIpIHtcbiAgICAgICAgICBkaXNjYXJkVHJhaWxpbmdOZXdsaW5lID0gdHJ1ZTtcbiAgICAgICAgICBsaW5lTGVuZ3RoID0gaW5kZXggLSBwb3NpdGlvbjtcbiAgICAgICAgfSBlbHNlIGlmIChjaGFyYWN0ZXIgPT09IFwiXFxuXCIpIHtcbiAgICAgICAgICBsaW5lTGVuZ3RoID0gaW5kZXggLSBwb3NpdGlvbjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGxpbmVMZW5ndGggPCAwKSB7XG4gICAgICAgIHN0YXJ0aW5nUG9zaXRpb24gPSBsZW5ndGggLSBwb3NpdGlvbjtcbiAgICAgICAgc3RhcnRpbmdGaWVsZExlbmd0aCA9IGZpZWxkTGVuZ3RoO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YXJ0aW5nUG9zaXRpb24gPSAwO1xuICAgICAgICBzdGFydGluZ0ZpZWxkTGVuZ3RoID0gLTE7XG4gICAgICB9XG4gICAgICBwYXJzZUV2ZW50U3RyZWFtTGluZShidWZmZXIsIHBvc2l0aW9uLCBmaWVsZExlbmd0aCwgbGluZUxlbmd0aCk7XG4gICAgICBwb3NpdGlvbiArPSBsaW5lTGVuZ3RoICsgMTtcbiAgICB9XG4gICAgaWYgKHBvc2l0aW9uID09PSBsZW5ndGgpIHtcbiAgICAgIGJ1ZmZlciA9IFwiXCI7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA+IDApIHtcbiAgICAgIGJ1ZmZlciA9IGJ1ZmZlci5zbGljZShwb3NpdGlvbik7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIHBhcnNlRXZlbnRTdHJlYW1MaW5lKGxpbmVCdWZmZXIsIGluZGV4LCBmaWVsZExlbmd0aCwgbGluZUxlbmd0aCkge1xuICAgIGlmIChsaW5lTGVuZ3RoID09PSAwKSB7XG4gICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgIG9uUGFyc2Uoe1xuICAgICAgICAgIHR5cGU6IFwiZXZlbnRcIixcbiAgICAgICAgICBpZDogZXZlbnRJZCxcbiAgICAgICAgICBldmVudDogZXZlbnROYW1lIHx8IHZvaWQgMCxcbiAgICAgICAgICBkYXRhOiBkYXRhLnNsaWNlKDAsIC0xKVxuICAgICAgICAgIC8vIHJlbW92ZSB0cmFpbGluZyBuZXdsaW5lXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRhdGEgPSBcIlwiO1xuICAgICAgICBldmVudElkID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgZXZlbnROYW1lID0gdm9pZCAwO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBub1ZhbHVlID0gZmllbGRMZW5ndGggPCAwO1xuICAgIGNvbnN0IGZpZWxkID0gbGluZUJ1ZmZlci5zbGljZShpbmRleCwgaW5kZXggKyAobm9WYWx1ZSA/IGxpbmVMZW5ndGggOiBmaWVsZExlbmd0aCkpO1xuICAgIGxldCBzdGVwID0gMDtcbiAgICBpZiAobm9WYWx1ZSkge1xuICAgICAgc3RlcCA9IGxpbmVMZW5ndGg7XG4gICAgfSBlbHNlIGlmIChsaW5lQnVmZmVyW2luZGV4ICsgZmllbGRMZW5ndGggKyAxXSA9PT0gXCIgXCIpIHtcbiAgICAgIHN0ZXAgPSBmaWVsZExlbmd0aCArIDI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0ZXAgPSBmaWVsZExlbmd0aCArIDE7XG4gICAgfVxuICAgIGNvbnN0IHBvc2l0aW9uID0gaW5kZXggKyBzdGVwO1xuICAgIGNvbnN0IHZhbHVlTGVuZ3RoID0gbGluZUxlbmd0aCAtIHN0ZXA7XG4gICAgY29uc3QgdmFsdWUgPSBsaW5lQnVmZmVyLnNsaWNlKHBvc2l0aW9uLCBwb3NpdGlvbiArIHZhbHVlTGVuZ3RoKS50b1N0cmluZygpO1xuICAgIGlmIChmaWVsZCA9PT0gXCJkYXRhXCIpIHtcbiAgICAgIGRhdGEgKz0gdmFsdWUgPyBcIlwiLmNvbmNhdCh2YWx1ZSwgXCJcXG5cIikgOiBcIlxcblwiO1xuICAgIH0gZWxzZSBpZiAoZmllbGQgPT09IFwiZXZlbnRcIikge1xuICAgICAgZXZlbnROYW1lID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmIChmaWVsZCA9PT0gXCJpZFwiICYmICF2YWx1ZS5pbmNsdWRlcyhcIlxcMFwiKSkge1xuICAgICAgZXZlbnRJZCA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAoZmllbGQgPT09IFwicmV0cnlcIikge1xuICAgICAgY29uc3QgcmV0cnkgPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgaWYgKCFOdW1iZXIuaXNOYU4ocmV0cnkpKSB7XG4gICAgICAgIG9uUGFyc2Uoe1xuICAgICAgICAgIHR5cGU6IFwicmVjb25uZWN0LWludGVydmFsXCIsXG4gICAgICAgICAgdmFsdWU6IHJldHJ5XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuY29uc3QgQk9NID0gWzIzOSwgMTg3LCAxOTFdO1xuZnVuY3Rpb24gaGFzQm9tKGJ1ZmZlcikge1xuICByZXR1cm4gQk9NLmV2ZXJ5KChjaGFyQ29kZSwgaW5kZXgpID0+IGJ1ZmZlci5jaGFyQ29kZUF0KGluZGV4KSA9PT0gY2hhckNvZGUpO1xufVxuZXhwb3J0cy5jcmVhdGVQYXJzZXIgPSBjcmVhdGVQYXJzZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29uc29sZUxvZ2dpbmdMaXN0ZW5lciB9IGZyb20gXCIuL3NyYy9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBFdmVudHMgfSBmcm9tIFwiLi9zcmMvY29tbW9uL0V4cG9ydHNcIjtcbi8vIENvbW1vbi5TdG9yYWdlLlNldExvY2FsU3RvcmFnZShuZXcgQ29tbW9uLkJyb3dzZXIuTG9jYWxTdG9yYWdlKCkpO1xuLy8gQ29tbW9uLlN0b3JhZ2UuU2V0U2Vzc2lvblN0b3JhZ2UobmV3IENvbW1vbi5Ccm93c2VyLlNlc3Npb25TdG9yYWdlKCkpO1xuRXZlbnRzLmluc3RhbmNlLmF0dGFjaENvbnNvbGVMaXN0ZW5lcihuZXcgQ29uc29sZUxvZ2dpbmdMaXN0ZW5lcigpKTtcbi8vIFNwZWVjaCBTREsgQVBJXG5leHBvcnQgKiBmcm9tIFwiLi9zcmMvc2RrL0V4cG9ydHNcIjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWljcm9zb2Z0LmNvZ25pdGl2ZXNlcnZpY2VzLnNwZWVjaC5zZGsuanMubWFwXG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnQgKi9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0ICogYXMgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgeyBMb2dMZXZlbCB9IGZyb20gXCIuLi9zZGsvTG9nTGV2ZWxcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi9zZGsvQ29udHJhY3RzXCI7XG5leHBvcnQgY2xhc3MgQ29uc29sZUxvZ2dpbmdMaXN0ZW5lciB7XG4gICAgY29uc3RydWN0b3IobG9nTGV2ZWxGaWx0ZXIgPSBMb2dMZXZlbC5Ob25lKSB7XG4gICAgICAgIHRoaXMucHJpdkxvZ1BhdGggPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdkVuYWJsZUNvbnNvbGVPdXRwdXQgPSB0cnVlO1xuICAgICAgICB0aGlzLnByaXZMb2dMZXZlbEZpbHRlciA9IGxvZ0xldmVsRmlsdGVyO1xuICAgIH1cbiAgICBzZXQgbG9nUGF0aChwYXRoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGZzLm9wZW5TeW5jLCBcIlxcbkZpbGUgU3lzdGVtIGFjY2VzcyBub3QgYXZhaWxhYmxlXCIpO1xuICAgICAgICB0aGlzLnByaXZMb2dQYXRoID0gcGF0aDtcbiAgICB9XG4gICAgc2V0IGVuYWJsZUNvbnNvbGVPdXRwdXQoZW5hYmxlT3V0cHV0KSB7XG4gICAgICAgIHRoaXMucHJpdkVuYWJsZUNvbnNvbGVPdXRwdXQgPSBlbmFibGVPdXRwdXQ7XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LmV2ZW50VHlwZSA+PSB0aGlzLnByaXZMb2dMZXZlbEZpbHRlcikge1xuICAgICAgICAgICAgY29uc3QgbG9nID0gdGhpcy50b1N0cmluZyhldmVudCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZMb2dQYXRoKSB7XG4gICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYyh0aGlzLnByaXZMb2dQYXRoLCBsb2cgKyBcIlxcblwiLCB7IGZsYWc6IFwiYStcIiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZFbmFibGVDb25zb2xlT3V0cHV0KSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChldmVudC5ldmVudFR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb2dMZXZlbC5EZWJ1ZzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKGxvZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb2dMZXZlbC5JbmZvOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhsb2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9nTGV2ZWwuV2FybmluZzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4obG9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvZ0xldmVsLkVycm9yOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IobG9nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGxvZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9TdHJpbmcoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgbG9nRnJhZ21lbnRzID0gW1xuICAgICAgICAgICAgYCR7ZXZlbnQuZXZlbnRUaW1lfWAsXG4gICAgICAgICAgICBgJHtldmVudC5uYW1lfWAsXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IGUgPSBldmVudDtcbiAgICAgICAgZm9yIChjb25zdCBwcm9wIGluIGUpIHtcbiAgICAgICAgICAgIGlmIChwcm9wICYmIGV2ZW50Lmhhc093blByb3BlcnR5KHByb3ApICYmXG4gICAgICAgICAgICAgICAgcHJvcCAhPT0gXCJldmVudFRpbWVcIiAmJiBwcm9wICE9PSBcImV2ZW50VHlwZVwiICYmXG4gICAgICAgICAgICAgICAgcHJvcCAhPT0gXCJldmVudElkXCIgJiYgcHJvcCAhPT0gXCJuYW1lXCIgJiZcbiAgICAgICAgICAgICAgICBwcm9wICE9PSBcImNvbnN0cnVjdG9yXCIpIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBlW3Byb3BdO1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZVRvTG9nID0gXCI8TlVMTD5cIjtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mICh2YWx1ZSkgPT09IFwibnVtYmVyXCIgfHwgdHlwZW9mICh2YWx1ZSkgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlVG9Mb2cgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVUb0xvZyA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsb2dGcmFnbWVudHMucHVzaChgJHtwcm9wfTogJHt2YWx1ZVRvTG9nfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2dGcmFnbWVudHMuam9pbihcIiB8IFwiKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnNvbGVMb2dnaW5nTGlzdGVuZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgY29ubmVjdGl2aXR5LCB0eXBlLCB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IEF1ZGlvU291cmNlRXJyb3JFdmVudCwgQXVkaW9Tb3VyY2VJbml0aWFsaXppbmdFdmVudCwgQXVkaW9Tb3VyY2VPZmZFdmVudCwgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50LCBBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50LCBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCwgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCwgQXVkaW9TdHJlYW1Ob2RlRXJyb3JFdmVudCwgQ2h1bmtlZEFycmF5QnVmZmVyU3RyZWFtLCBjcmVhdGVOb0Rhc2hHdWlkLCBEZWZlcnJlZCwgRXZlbnRzLCBFdmVudFNvdXJjZSwgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IEF1ZGlvU3RyZWFtRm9ybWF0IH0gZnJvbSBcIi4uL3Nkay9BdWRpby9BdWRpb1N0cmVhbUZvcm1hdFwiO1xuZXhwb3J0IGNsYXNzIEZpbGVBdWRpb1NvdXJjZSB7XG4gICAgY29uc3RydWN0b3IoZmlsZSwgZmlsZW5hbWUsIGF1ZGlvU291cmNlSWQpIHtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtcyA9IHt9O1xuICAgICAgICB0aGlzLnByaXZIZWFkZXJFbmQgPSA0NDtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBhdWRpb1NvdXJjZUlkID8gYXVkaW9Tb3VyY2VJZCA6IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRzID0gbmV3IEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdlNvdXJjZSA9IGZpbGU7XG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBCbG9iICE9PSBcInVuZGVmaW5lZFwiICYmIHRoaXMucHJpdlNvdXJjZSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkZpbGVuYW1lID0gZmlsZS5uYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcml2RmlsZW5hbWUgPSBmaWxlbmFtZSB8fCBcInVua25vd24ud2F2XCI7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVhZCB0aGUgaGVhZGVyLlxuICAgICAgICB0aGlzLnByaXZBdWRpb0Zvcm1hdFByb21pc2UgPSB0aGlzLnJlYWRIZWFkZXIoKTtcbiAgICB9XG4gICAgZ2V0IGZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvRm9ybWF0UHJvbWlzZTtcbiAgICB9XG4gICAgdHVybk9uKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2RmlsZW5hbWUubGFzdEluZGV4T2YoXCIud2F2XCIpICE9PSB0aGlzLnByaXZGaWxlbmFtZS5sZW5ndGggLSA0KSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IHRoaXMucHJpdkZpbGVuYW1lICsgXCIgaXMgbm90IHN1cHBvcnRlZC4gT25seSBXQVZFIGZpbGVzIGFyZSBhbGxvd2VkIGF0IHRoZSBtb21lbnQuXCI7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlRXJyb3JFdmVudChlcnJvck1zZywgXCJcIikpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yTXNnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQodGhpcy5wcml2SWQpKTsgLy8gbm8gc3RyZWFtIGlkXG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50KHRoaXMucHJpdklkKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgYXR0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGluZ0V2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0geWllbGQgdGhpcy51cGxvYWQoYXVkaW9Ob2RlSWQpO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS5yZWFkRW5kZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudHVybk9mZigpO1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGlkOiAoKSA9PiBhdWRpb05vZGVJZCxcbiAgICAgICAgICAgICAgICByZWFkOiAoKSA9PiBzdHJlYW0ucmVhZCgpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgaWYgKGF1ZGlvTm9kZUlkICYmIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXS5jbG9zZSgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHR1cm5PZmYoKSB7XG4gICAgICAgIGZvciAoY29uc3Qgc3RyZWFtSWQgaW4gdGhpcy5wcml2U3RyZWFtcykge1xuICAgICAgICAgICAgaWYgKHN0cmVhbUlkKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcml2U3RyZWFtc1tzdHJlYW1JZF07XG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbSAmJiAhc3RyZWFtLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlT2ZmRXZlbnQodGhpcy5wcml2SWQpKTsgLy8gbm8gc3RyZWFtIG5vd1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldCBldmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFdmVudHM7XG4gICAgfVxuICAgIGdldCBkZXZpY2VJbmZvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Gb3JtYXRQcm9taXNlLnRoZW4oKHJlc3VsdCkgPT4gKFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBiaXRzcGVyc2FtcGxlOiByZXN1bHQuYml0c1BlclNhbXBsZSxcbiAgICAgICAgICAgIGNoYW5uZWxjb3VudDogcmVzdWx0LmNoYW5uZWxzLFxuICAgICAgICAgICAgY29ubmVjdGl2aXR5OiBjb25uZWN0aXZpdHkuVW5rbm93bixcbiAgICAgICAgICAgIG1hbnVmYWN0dXJlcjogXCJTcGVlY2ggU0RLXCIsXG4gICAgICAgICAgICBtb2RlbDogXCJGaWxlXCIsXG4gICAgICAgICAgICBzYW1wbGVyYXRlOiByZXN1bHQuc2FtcGxlc1BlclNlYyxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUuRmlsZSxcbiAgICAgICAgfSkpKTtcbiAgICB9XG4gICAgcmVhZEhlYWRlcigpIHtcbiAgICAgICAgLy8gUmVhZCB0aGUgd2F2ZSBoZWFkZXIuXG4gICAgICAgIGNvbnN0IG1heEhlYWRlclNpemUgPSA0Mjk2O1xuICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLnByaXZTb3VyY2Uuc2xpY2UoMCwgbWF4SGVhZGVyU2l6ZSk7XG4gICAgICAgIGNvbnN0IGhlYWRlclJlc3VsdCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBjb25zdCBwcm9jZXNzSGVhZGVyID0gKGhlYWRlcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IG5ldyBEYXRhVmlldyhoZWFkZXIpO1xuICAgICAgICAgICAgY29uc3QgZ2V0V29yZCA9IChpbmRleCkgPT4gU3RyaW5nLmZyb21DaGFyQ29kZSh2aWV3LmdldFVpbnQ4KGluZGV4KSwgdmlldy5nZXRVaW50OChpbmRleCArIDEpLCB2aWV3LmdldFVpbnQ4KGluZGV4ICsgMiksIHZpZXcuZ2V0VWludDgoaW5kZXggKyAzKSk7XG4gICAgICAgICAgICAvLyBSSUZGIDQgYnl0ZXMuXG4gICAgICAgICAgICBpZiAoXCJSSUZGXCIgIT09IGdldFdvcmQoMCkpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJSZXN1bHQucmVqZWN0KFwiSW52YWxpZCBXQVYgaGVhZGVyIGluIGZpbGUsIFJJRkYgd2FzIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBsZW5ndGgsIDQgYnl0ZXNcbiAgICAgICAgICAgIC8vIFJJRkYgVHlwZSAmIGZtdCA4IGJ5dGVzXG4gICAgICAgICAgICBpZiAoXCJXQVZFXCIgIT09IGdldFdvcmQoOCkgfHwgXCJmbXQgXCIgIT09IGdldFdvcmQoMTIpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyUmVzdWx0LnJlamVjdChcIkludmFsaWQgV0FWIGhlYWRlciBpbiBmaWxlLCBXQVZFZm10IHdhcyBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZm9ybWF0U2l6ZSA9IHZpZXcuZ2V0SW50MzIoMTYsIHRydWUpO1xuICAgICAgICAgICAgY29uc3QgY2hhbm5lbENvdW50ID0gdmlldy5nZXRVaW50MTYoMjIsIHRydWUpO1xuICAgICAgICAgICAgY29uc3Qgc2FtcGxlUmF0ZSA9IHZpZXcuZ2V0VWludDMyKDI0LCB0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IGJpdHNQZXJTYW1wbGUgPSB2aWV3LmdldFVpbnQxNigzNCwgdHJ1ZSk7XG4gICAgICAgICAgICAvLyBDb25maXJtIGlmIGhlYWRlciBpcyA0NCBieXRlcyBsb25nLlxuICAgICAgICAgICAgbGV0IHBvcyA9IDM2ICsgTWF0aC5tYXgoZm9ybWF0U2l6ZSAtIDE2LCAwKTtcbiAgICAgICAgICAgIGZvciAoOyBnZXRXb3JkKHBvcykgIT09IFwiZGF0YVwiOyBwb3MgKz0gMikge1xuICAgICAgICAgICAgICAgIGlmIChwb3MgPiBtYXhIZWFkZXJTaXplIC0gOCkge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJSZXN1bHQucmVqZWN0KFwiSW52YWxpZCBXQVYgaGVhZGVyIGluIGZpbGUsIGRhdGEgYmxvY2sgd2FzIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkhlYWRlckVuZCA9IHBvcyArIDg7XG4gICAgICAgICAgICBoZWFkZXJSZXN1bHQucmVzb2x2ZShBdWRpb1N0cmVhbUZvcm1hdC5nZXRXYXZlRm9ybWF0UENNKHNhbXBsZVJhdGUsIGJpdHNQZXJTYW1wbGUsIGNoYW5uZWxDb3VudCkpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgQmxvYiAhPT0gXCJ1bmRlZmluZWRcIiAmJiBoZWFkZXIgaW5zdGFuY2VvZiBCbG9iKSB7XG4gICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc0hlYWRlcihoZWFkZXIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihoZWFkZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaCA9IGhlYWRlcjtcbiAgICAgICAgICAgIHByb2Nlc3NIZWFkZXIoaC5idWZmZXIuc2xpY2UoaC5ieXRlT2Zmc2V0LCBoLmJ5dGVPZmZzZXQgKyBoLmJ5dGVMZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGVhZGVyUmVzdWx0LnByb21pc2U7XG4gICAgfVxuICAgIHVwbG9hZChhdWRpb05vZGVJZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3Qgb25lcnJvciA9IChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yTXNnID0gYEVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgJyR7dGhpcy5wcml2RmlsZW5hbWV9Jy4gJHtlcnJvcn1gO1xuICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRXJyb3JFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQsIGVycm9yTXNnKSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTXNnKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMudHVybk9uKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0geWllbGQgdGhpcy5wcml2QXVkaW9Gb3JtYXRQcm9taXNlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBDaHVua2VkQXJyYXlCdWZmZXJTdHJlYW0oZm9ybWF0LmF2Z0J5dGVzUGVyU2VjIC8gMTAsIGF1ZGlvTm9kZUlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXSA9IHN0cmVhbTtcbiAgICAgICAgICAgICAgICBjb25zdCBjaHVuayA9IHRoaXMucHJpdlNvdXJjZS5zbGljZSh0aGlzLnByaXZIZWFkZXJFbmQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NGaWxlID0gKGJ1ZmYpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmVhbS5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBvdXRwdXQgc3RyZWFtIHdhcyBjbG9zZWQgKHNvbWVib2R5IGNhbGxlZCBUdXJuT2ZmKS4gV2UncmUgZG9uZSBoZXJlLlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZmZlcjogYnVmZixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRW5kOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIEJsb2IgIT09IFwidW5kZWZpbmVkXCIgJiYgY2h1bmsgaW5zdGFuY2VvZiBCbG9iKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gKGV2KSA9PiBvbmVycm9yKGV2LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQnVmZmVyID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NGaWxlKGZpbGVCdWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoY2h1bmspO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IGNodW5rO1xuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzRmlsZShjLmJ1ZmZlci5zbGljZShjLmJ5dGVPZmZzZXQsIGMuYnl0ZU9mZnNldCArIGMuYnl0ZUxlbmd0aCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyZWFtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBvbmVycm9yKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICB0aGlzLnByaXZFdmVudHMub25FdmVudChldmVudCk7XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KGV2ZW50KTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUZpbGVBdWRpb1NvdXJjZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBjb25uZWN0aXZpdHksIHR5cGUgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb1NvdXJjZUVycm9yRXZlbnQsIEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQsIEF1ZGlvU291cmNlT2ZmRXZlbnQsIEF1ZGlvU291cmNlUmVhZHlFdmVudCwgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCwgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnQsIENodW5rZWRBcnJheUJ1ZmZlclN0cmVhbSwgY3JlYXRlTm9EYXNoR3VpZCwgRGVmZXJyZWQsIEV2ZW50cywgRXZlbnRTb3VyY2UsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb1N0cmVhbUZvcm1hdCwgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsLCB9IGZyb20gXCIuLi9zZGsvQXVkaW8vQXVkaW9TdHJlYW1Gb3JtYXRcIjtcbmV4cG9ydCBjb25zdCBBdWRpb1dvcmtsZXRTb3VyY2VVUkxQcm9wZXJ0eU5hbWUgPSBcIk1JQ1JPUEhPTkUtV29ya2xldFNvdXJjZVVybFwiO1xuZXhwb3J0IGNsYXNzIE1pY0F1ZGlvU291cmNlIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2UmVjb3JkZXIsIGRldmljZUlkLCBhdWRpb1NvdXJjZUlkLCBtZWRpYVN0cmVhbSkge1xuICAgICAgICB0aGlzLnByaXZSZWNvcmRlciA9IHByaXZSZWNvcmRlcjtcbiAgICAgICAgdGhpcy5kZXZpY2VJZCA9IGRldmljZUlkO1xuICAgICAgICB0aGlzLnByaXZTdHJlYW1zID0ge307XG4gICAgICAgIHRoaXMucHJpdk91dHB1dENodW5rU2l6ZSA9IE1pY0F1ZGlvU291cmNlLkFVRElPRk9STUFULmF2Z0J5dGVzUGVyU2VjIC8gMTA7XG4gICAgICAgIHRoaXMucHJpdklkID0gYXVkaW9Tb3VyY2VJZCA/IGF1ZGlvU291cmNlSWQgOiBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50cyA9IG5ldyBFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZNZWRpYVN0cmVhbSA9IG1lZGlhU3RyZWFtIHx8IG51bGw7XG4gICAgICAgIHRoaXMucHJpdklzQ2xvc2luZyA9IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgZm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKE1pY0F1ZGlvU291cmNlLkFVRElPRk9STUFUKTtcbiAgICB9XG4gICAgdHVybk9uKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUF1ZGlvQ29udGV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlZEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnJlamVjdCh0eXBlZEVycm9yLm5hbWUgKyBcIjogXCIgKyB0eXBlZEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnByb21pc2U7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbmF2ID0gd2luZG93Lm5hdmlnYXRvcjtcbiAgICAgICAgbGV0IGdldFVzZXJNZWRpYSA9IChcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgIG5hdi5nZXRVc2VyTWVkaWEgfHxcbiAgICAgICAgICAgIG5hdi53ZWJraXRHZXRVc2VyTWVkaWEgfHxcbiAgICAgICAgICAgIG5hdi5tb3pHZXRVc2VyTWVkaWEgfHxcbiAgICAgICAgICAgIG5hdi5tc0dldFVzZXJNZWRpYSk7XG4gICAgICAgIGlmICghIW5hdi5tZWRpYURldmljZXMpIHtcbiAgICAgICAgICAgIGdldFVzZXJNZWRpYSA9IChjb25zdHJhaW50cywgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICAgICAgbmF2Lm1lZGlhRGV2aWNlc1xuICAgICAgICAgICAgICAgICAgICAuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihzdWNjZXNzQ2FsbGJhY2spXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFnZXRVc2VyTWVkaWEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTXNnID0gXCJCcm93c2VyIGRvZXMgbm90IHN1cHBvcnQgZ2V0VXNlck1lZGlhLlwiO1xuICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnJlamVjdChlcnJvck1zZyk7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlRXJyb3JFdmVudChlcnJvck1zZywgXCJcIikpOyAvLyBtaWMgaW5pdGlhbGl6ZWQgZXJyb3IgLSBubyBzdHJlYW1pZCBhdCB0aGlzIHBvaW50XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VJbml0aWFsaXppbmdFdmVudCh0aGlzLnByaXZJZCkpOyAvLyBubyBzdHJlYW0gaWRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2TWVkaWFTdHJlYW0gJiYgdGhpcy5wcml2TWVkaWFTdHJlYW0uYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50KHRoaXMucHJpdklkKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBnZXRVc2VyTWVkaWEoeyBhdWRpbzogdGhpcy5kZXZpY2VJZCA/IHsgZGV2aWNlSWQ6IHRoaXMuZGV2aWNlSWQgfSA6IHRydWUsIHZpZGVvOiBmYWxzZSB9LCAobWVkaWFTdHJlYW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhU3RyZWFtID0gbWVkaWFTdHJlYW07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlUmVhZHlFdmVudCh0aGlzLnByaXZJZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1zZyA9IGBFcnJvciBvY2N1cnJlZCBkdXJpbmcgbWljcm9waG9uZSBpbml0aWFsaXphdGlvbjogJHtlcnJvcn1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnJlamVjdChlcnJvck1zZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU291cmNlRXJyb3JFdmVudCh0aGlzLnByaXZJZCwgZXJyb3JNc2cpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb250ZXh0LnN0YXRlID09PSBcInN1c3BlbmRlZFwiKSB7XG4gICAgICAgICAgICAgICAgLy8gTk9URTogT24gaU9TLCB0aGUgV2ViIEF1ZGlvIEFQSSByZXF1aXJlcyBzb3VuZHMgdG8gYmUgdHJpZ2dlcmVkIGZyb20gYW4gZXhwbGljaXQgdXNlciBhY3Rpb24uXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1dlYkF1ZGlvL3dlYi1hdWRpby1hcGkvaXNzdWVzLzc5MFxuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnRleHQucmVzdW1lKClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4obmV4dClcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SW5pdGlhbGl6ZURlZmVycmFsLnJlamVjdChgRmFpbGVkIHRvIGluaXRpYWxpemUgYXVkaW8gY29udGV4dDogJHtyZWFzb259YCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICBhdHRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuKGF1ZGlvTm9kZUlkKS50aGVuKChzdHJlYW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbS5yZWFkRW5kZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBpZDogKCkgPT4gYXVkaW9Ob2RlSWQsXG4gICAgICAgICAgICAgICAgcmVhZDogKCkgPT4gc3RyZWFtLnJlYWQoKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgaWYgKGF1ZGlvTm9kZUlkICYmIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTdHJlYW1zW2F1ZGlvTm9kZUlkXS5jbG9zZSgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHR1cm5PZmYoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHN0cmVhbUlkIGluIHRoaXMucHJpdlN0cmVhbXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcml2U3RyZWFtc1tzdHJlYW1JZF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdHJlYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmVhbS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZU9mZkV2ZW50KHRoaXMucHJpdklkKSk7IC8vIG5vIHN0cmVhbSBub3dcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZJbml0aWFsaXplRGVmZXJyYWwpIHtcbiAgICAgICAgICAgICAgICAvLyBDb3JyZWN0bHkgaGFuZGxlIHdoZW4gYnJvd3NlciBmb3JjZXMgbWljIG9mZiBiZWZvcmUgdHVybk9uKCkgY29tcGxldGVzXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9hd2FpdC10aGVuYWJsZVxuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkluaXRpYWxpemVEZWZlcnJhbDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJbml0aWFsaXplRGVmZXJyYWwgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgdGhpcy5kZXN0cm95QXVkaW9Db250ZXh0KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXZlbnRzO1xuICAgIH1cbiAgICBnZXQgZGV2aWNlSW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWljcm9waG9uZUxhYmVsKCkudGhlbigobGFiZWwpID0+ICh7XG4gICAgICAgICAgICBiaXRzcGVyc2FtcGxlOiBNaWNBdWRpb1NvdXJjZS5BVURJT0ZPUk1BVC5iaXRzUGVyU2FtcGxlLFxuICAgICAgICAgICAgY2hhbm5lbGNvdW50OiBNaWNBdWRpb1NvdXJjZS5BVURJT0ZPUk1BVC5jaGFubmVscyxcbiAgICAgICAgICAgIGNvbm5lY3Rpdml0eTogY29ubmVjdGl2aXR5LlVua25vd24sXG4gICAgICAgICAgICBtYW51ZmFjdHVyZXI6IFwiU3BlZWNoIFNES1wiLFxuICAgICAgICAgICAgbW9kZWw6IGxhYmVsLFxuICAgICAgICAgICAgc2FtcGxlcmF0ZTogTWljQXVkaW9Tb3VyY2UuQVVESU9GT1JNQVQuc2FtcGxlc1BlclNlYyxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUuTWljcm9waG9uZXMsXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IEF1ZGlvV29ya2xldFNvdXJjZVVSTFByb3BlcnR5TmFtZSkge1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjb3JkZXIuc2V0V29ya2xldFVybCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSAnXCIgKyBuYW1lICsgXCInIGlzIG5vdCBzdXBwb3J0ZWQgb24gTWljcm9waG9uZS5cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0TWljcm9waG9uZUxhYmVsKCkge1xuICAgICAgICBjb25zdCBkZWZhdWx0TWljcm9waG9uZU5hbWUgPSBcIm1pY3JvcGhvbmVcIjtcbiAgICAgICAgLy8gSWYgd2UgZGlkIHRoaXMgYWxyZWFkeSwgcmV0dXJuIHRoZSB2YWx1ZS5cbiAgICAgICAgaWYgKHRoaXMucHJpdk1pY3JvcGhvbmVMYWJlbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucHJpdk1pY3JvcGhvbmVMYWJlbCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgdGhlIHN0cmVhbSBpc24ndCBjdXJyZW50bHkgcnVubmluZywgd2UgY2FuJ3QgcXVlcnkgZGV2aWNlcyBiZWNhdXNlIHNlY3VyaXR5LlxuICAgICAgICBpZiAodGhpcy5wcml2TWVkaWFTdHJlYW0gPT09IHVuZGVmaW5lZCB8fCAhdGhpcy5wcml2TWVkaWFTdHJlYW0uYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGRlZmF1bHRNaWNyb3Bob25lTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0dXAgYSBkZWZhdWx0XG4gICAgICAgIHRoaXMucHJpdk1pY3JvcGhvbmVMYWJlbCA9IGRlZmF1bHRNaWNyb3Bob25lTmFtZTtcbiAgICAgICAgLy8gR2V0IHRoZSBpZCBvZiB0aGUgZGV2aWNlIHJ1bm5pbmcgdGhlIGF1ZGlvIHRyYWNrLlxuICAgICAgICBjb25zdCBtaWNyb3Bob25lRGV2aWNlSWQgPSB0aGlzLnByaXZNZWRpYVN0cmVhbS5nZXRUcmFja3MoKVswXS5nZXRTZXR0aW5ncygpLmRldmljZUlkO1xuICAgICAgICAvLyBJZiB0aGUgYnJvd3NlciBkb2Vzbid0IHN1cHBvcnQgZ2V0dGluZyB0aGUgZGV2aWNlIElELCBzZXQgYSBkZWZhdWx0IGFuZCByZXR1cm4uXG4gICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1pY3JvcGhvbmVEZXZpY2VJZCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIC8vIEVudW1lcmF0ZSB0aGUgbWVkaWEgZGV2aWNlcy5cbiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkudGhlbigoZGV2aWNlcykgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBkZXZpY2Ugb2YgZGV2aWNlcykge1xuICAgICAgICAgICAgICAgIGlmIChkZXZpY2UuZGV2aWNlSWQgPT09IG1pY3JvcGhvbmVEZXZpY2VJZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGb3VuZCB0aGUgZGV2aWNlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk1pY3JvcGhvbmVMYWJlbCA9IGRldmljZS5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh0aGlzLnByaXZNaWNyb3Bob25lTGFiZWwpO1xuICAgICAgICB9LCAoKSA9PiBkZWZlcnJlZC5yZXNvbHZlKHRoaXMucHJpdk1pY3JvcGhvbmVMYWJlbCkpO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG4gICAgbGlzdGVuKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gbmV3IENodW5rZWRBcnJheUJ1ZmZlclN0cmVhbSh0aGlzLnByaXZPdXRwdXRDaHVua1NpemUsIGF1ZGlvTm9kZUlkKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlN0cmVhbXNbYXVkaW9Ob2RlSWRdID0gc3RyZWFtO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvcmRlci5yZWNvcmQodGhpcy5wcml2Q29udGV4dCwgdGhpcy5wcml2TWVkaWFTdHJlYW0sIHN0cmVhbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IEF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkLCBlcnJvcikpO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gc3RyZWFtO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRzLm9uRXZlbnQoZXZlbnQpO1xuICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChldmVudCk7XG4gICAgfVxuICAgIGNyZWF0ZUF1ZGlvQ29udGV4dCgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHQgPSBBdWRpb1N0cmVhbUZvcm1hdEltcGwuZ2V0QXVkaW9Db250ZXh0KE1pY0F1ZGlvU291cmNlLkFVRElPRk9STUFULnNhbXBsZXNQZXJTZWMpO1xuICAgIH1cbiAgICBkZXN0cm95QXVkaW9Db250ZXh0KCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2UmVjb3JkZXIucmVsZWFzZU1lZGlhUmVzb3VyY2VzKHRoaXMucHJpdkNvbnRleHQpO1xuICAgICAgICAgICAgLy8gVGhpcyBwYXR0ZXJuIGJyb3VnaHQgdG8geW91IGJ5IGEgYnVnIGluIHRoZSBUeXBlU2NyaXB0IGNvbXBpbGVyIHdoZXJlIGl0XG4gICAgICAgICAgICAvLyBjb25mdXNlcyB0aGUgKFwiY2xvc2VcIiBpbiB0aGlzLnByaXZDb250ZXh0KSB3aXRoIHRoaXMucHJpdkNvbnRleHQgYWx3YXlzIGJlaW5nIG51bGwgYXMgdGhlIGFsdGVybmF0ZS5cbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvMTE0OThcbiAgICAgICAgICAgIGxldCBoYXNDbG9zZSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKFwiY2xvc2VcIiBpbiB0aGlzLnByaXZDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgaGFzQ2xvc2UgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhc0Nsb3NlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0Nsb3NpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGF1ZGlvIGNvbnRleHQgY2xvc2UgbWF5IHRha2UgZW5vdWdoIHRpbWUgdGhhdCB0aGUgY2xvc2UgaXMgY2FsbGVkIHR3aWNlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdklzQ2xvc2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkNvbnRleHQuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udGV4dCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdklzQ2xvc2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG51bGwgIT09IHRoaXMucHJpdkNvbnRleHQgJiYgdGhpcy5wcml2Q29udGV4dC5zdGF0ZSA9PT0gXCJydW5uaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAvLyBTdXNwZW5kIGFjdHVhbGx5IHRha2VzIGEgY2FsbGJhY2ssIGJ1dCBhbmFsb2dvdXMgdG8gdGhlXG4gICAgICAgICAgICAgICAgLy8gcmVzdW1lIG1ldGhvZCwgaXQnbGwgYmUgb25seSBmaXJlZCBpZiBzdXNwZW5kIGlzIGNhbGxlZFxuICAgICAgICAgICAgICAgIC8vIGluIGEgZGlyZWN0IHJlc3BvbnNlIHRvIGEgdXNlciBhY3Rpb24uIFRoZSBsYXRlciBpcyBub3QgYWx3YXlzXG4gICAgICAgICAgICAgICAgLy8gdGhlIGNhc2UsIGFzIFR1cm5PZmYgaXMgYWxzbyBjYWxsZWQsIHdoZW4gd2UgcmVjZWl2ZSBhblxuICAgICAgICAgICAgICAgIC8vIGVuZC1vZi1zcGVlY2ggbWVzc2FnZSBmcm9tIHRoZSBzZXJ2aWNlLiBTbywgZG9pbmcgYSBiZXN0IGVmZm9ydFxuICAgICAgICAgICAgICAgIC8vIGZpcmUtYW5kLWZvcmdldCBoZXJlLlxuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkNvbnRleHQuc3VzcGVuZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5NaWNBdWRpb1NvdXJjZS5BVURJT0ZPUk1BVCA9IEF1ZGlvU3RyZWFtRm9ybWF0LmdldERlZmF1bHRJbnB1dEZvcm1hdCgpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1NaWNBdWRpb1NvdXJjZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUmlmZlBjbUVuY29kZXIgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBQY21SZWNvcmRlciB7XG4gICAgY29uc3RydWN0b3Ioc3RvcElucHV0T25SZWxlYXNlKSB7XG4gICAgICAgIHRoaXMucHJpdlN0b3BJbnB1dE9uUmVsZWFzZSA9IHN0b3BJbnB1dE9uUmVsZWFzZTtcbiAgICB9XG4gICAgcmVjb3JkKGNvbnRleHQsIG1lZGlhU3RyZWFtLCBvdXRwdXRTdHJlYW0pIHtcbiAgICAgICAgY29uc3QgZGVzaXJlZFNhbXBsZVJhdGUgPSAxNjAwMDtcbiAgICAgICAgY29uc3Qgd2F2ZVN0cmVhbUVuY29kZXIgPSBuZXcgUmlmZlBjbUVuY29kZXIoY29udGV4dC5zYW1wbGVSYXRlLCBkZXNpcmVkU2FtcGxlUmF0ZSk7XG4gICAgICAgIGNvbnN0IG1pY0lucHV0ID0gY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShtZWRpYVN0cmVhbSk7XG4gICAgICAgIGNvbnN0IGF0dGFjaFNjcmlwdFByb2Nlc3NvciA9ICgpID0+IHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtZnVuY3Rpb24tcmV0dXJuLXR5cGVcbiAgICAgICAgICAgIGNvbnN0IHNjcmlwdE5vZGUgPSAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBidWZmZXJTaXplID0gMDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC5jcmVhdGVTY3JpcHRQcm9jZXNzb3IoYnVmZmVyU2l6ZSwgMSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZWJraXQgKDw9IHZlcnNpb24gMzEpIHJlcXVpcmVzIGEgdmFsaWQgYnVmZmVyU2l6ZS5cbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyU2l6ZSA9IDIwNDg7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhdWRpb1NhbXBsZVJhdGUgPSBjb250ZXh0LnNhbXBsZVJhdGU7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChidWZmZXJTaXplIDwgMTYzODQgJiYgYXVkaW9TYW1wbGVSYXRlID49ICgyICogZGVzaXJlZFNhbXBsZVJhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWZmZXJTaXplIDw8PSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXVkaW9TYW1wbGVSYXRlID4+PSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0LmNyZWF0ZVNjcmlwdFByb2Nlc3NvcihidWZmZXJTaXplLCAxLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgc2NyaXB0Tm9kZS5vbmF1ZGlvcHJvY2VzcyA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0RnJhbWUgPSBldmVudC5pbnB1dEJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKTtcbiAgICAgICAgICAgICAgICBpZiAob3V0cHV0U3RyZWFtICYmICFvdXRwdXRTdHJlYW0uaXNDbG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2F2ZUZyYW1lID0gd2F2ZVN0cmVhbUVuY29kZXIuZW5jb2RlKGlucHV0RnJhbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF3YXZlRnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFN0cmVhbS53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWZmZXI6IHdhdmVGcmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0VuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZVJlY2VpdmVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbWljSW5wdXQuY29ubmVjdChzY3JpcHROb2RlKTtcbiAgICAgICAgICAgIHNjcmlwdE5vZGUuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzID0ge1xuICAgICAgICAgICAgICAgIHNjcmlwdFByb2Nlc3Nvck5vZGU6IHNjcmlwdE5vZGUsXG4gICAgICAgICAgICAgICAgc291cmNlOiBtaWNJbnB1dCxcbiAgICAgICAgICAgICAgICBzdHJlYW06IG1lZGlhU3RyZWFtLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gaHR0cHM6Ly93ZWJhdWRpby5naXRodWIuaW8vd2ViLWF1ZGlvLWFwaS8jYXVkaW93b3JrbGV0XG4gICAgICAgIC8vIFVzaW5nIEF1ZGlvV29ya2xldCB0byBpbXByb3ZlIGF1ZGlvIHF1YWxpdHkgYW5kIGF2b2lkIGF1ZGlvIGdsaXRjaGVzIGR1ZSB0byBibG9ja2luZyB0aGUgVUkgdGhyZWFkXG4gICAgICAgIGlmICghIWNvbnRleHQuYXVkaW9Xb3JrbGV0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdlNwZWVjaFByb2Nlc3NvclNjcmlwdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtsZXRTY3JpcHQgPSBgY2xhc3MgU1AgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3Ige1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHN1cGVyKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzKGlucHV0cywgb3V0cHV0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBpbnB1dHNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgaW5wdXQubGVuZ3RoOyBjaGFubmVsICs9IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0W2NoYW5uZWxdID0gaW5wdXRbY2hhbm5lbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcnQucG9zdE1lc3NhZ2Uob3V0cHV0WzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICByZWdpc3RlclByb2Nlc3Nvcignc3BlZWNoLXByb2Nlc3NvcicsIFNQKTtgO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbd29ya2xldFNjcmlwdF0sIHsgdHlwZTogXCJhcHBsaWNhdGlvbi9qYXZhc2NyaXB0OyBjaGFyc2V0PXV0Zi04XCIgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvY2Vzc29yU2NyaXB0ID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQuYXVkaW9Xb3JrbGV0XG4gICAgICAgICAgICAgICAgLmFkZE1vZHVsZSh0aGlzLnByaXZTcGVlY2hQcm9jZXNzb3JTY3JpcHQpXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtsZXROb2RlID0gbmV3IEF1ZGlvV29ya2xldE5vZGUoY29udGV4dCwgXCJzcGVlY2gtcHJvY2Vzc29yXCIpO1xuICAgICAgICAgICAgICAgIHdvcmtsZXROb2RlLnBvcnQub25tZXNzYWdlID0gKGV2KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0RnJhbWUgPSBldi5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3V0cHV0U3RyZWFtICYmICFvdXRwdXRTdHJlYW0uaXNDbG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdhdmVGcmFtZSA9IHdhdmVTdHJlYW1FbmNvZGVyLmVuY29kZShpbnB1dEZyYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXdhdmVGcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFN0cmVhbS53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiB3YXZlRnJhbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRW5kOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZVJlY2VpdmVkOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBtaWNJbnB1dC5jb25uZWN0KHdvcmtsZXROb2RlKTtcbiAgICAgICAgICAgICAgICB3b3JrbGV0Tm9kZS5jb25uZWN0KGNvbnRleHQuZGVzdGluYXRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzID0ge1xuICAgICAgICAgICAgICAgICAgICBzY3JpcHRQcm9jZXNzb3JOb2RlOiB3b3JrbGV0Tm9kZSxcbiAgICAgICAgICAgICAgICAgICAgc291cmNlOiBtaWNJbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtOiBtZWRpYVN0cmVhbSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF0dGFjaFNjcmlwdFByb2Nlc3NvcigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF0dGFjaFNjcmlwdFByb2Nlc3NvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5hYmxlIHRvIHN0YXJ0IGF1ZGlvIHdvcmtsZXQgbm9kZSBmb3IgUENNUmVjb3JkZXI6ICR7ZXJyfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlbGVhc2VNZWRpYVJlc291cmNlcyhjb250ZXh0KSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZNZWRpYVJlc291cmNlcykge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzLnNjcmlwdFByb2Nlc3Nvck5vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVJlc291cmNlcy5zY3JpcHRQcm9jZXNzb3JOb2RlLmRpc2Nvbm5lY3QoY29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFSZXNvdXJjZXMuc2NyaXB0UHJvY2Vzc29yTm9kZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2TWVkaWFSZXNvdXJjZXMuc291cmNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFSZXNvdXJjZXMuc291cmNlLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2U3RvcElucHV0T25SZWxlYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhUmVzb3VyY2VzLnN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKCh0cmFjaykgPT4gdHJhY2suc3RvcCgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFSZXNvdXJjZXMuc291cmNlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRXb3JrbGV0VXJsKHVybCkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9jZXNzb3JTY3JpcHQgPSB1cmw7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1QQ01SZWNvcmRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIFByb3h5SW5mbyB7XG4gICAgY29uc3RydWN0b3IocHJveHlIb3N0TmFtZSwgcHJveHlQb3J0LCBwcm94eVVzZXJOYW1lLCBwcm94eVBhc3N3b3JkKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3h5SG9zdE5hbWUgPSBwcm94eUhvc3ROYW1lO1xuICAgICAgICB0aGlzLnByaXZQcm94eVBvcnQgPSBwcm94eVBvcnQ7XG4gICAgICAgIHRoaXMucHJpdlByb3h5VXNlck5hbWUgPSBwcm94eVVzZXJOYW1lO1xuICAgICAgICB0aGlzLnByaXZQcm94eVBhc3N3b3JkID0gcHJveHlQYXNzd29yZDtcbiAgICB9XG4gICAgc3RhdGljIGZyb21QYXJhbWV0ZXJzKHBhcmFtZXRlcnMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm94eUluZm8ocGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5SG9zdE5hbWUpLCBwYXJzZUludChwYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQb3J0KSwgMTApLCBwYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlVc2VyTmFtZSksIHBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBhc3N3b3JkKSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZnJvbVBhcmFtZXRlcnMoY29uZmlnLnBhcmFtZXRlcnMpO1xuICAgIH1cbiAgICBnZXQgSG9zdE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm94eUhvc3ROYW1lO1xuICAgIH1cbiAgICBnZXQgUG9ydCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3h5UG9ydDtcbiAgICB9XG4gICAgZ2V0IFVzZXJOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJveHlVc2VyTmFtZTtcbiAgICB9XG4gICAgZ2V0IFBhc3N3b3JkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJveHlQYXNzd29yZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb3h5SW5mby5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFJlcGxheWFibGVBdWRpb05vZGUge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvU291cmNlLCBieXRlc1BlclNlY29uZCkge1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJzID0gW107XG4gICAgICAgIHRoaXMucHJpdlJlcGxheU9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdkxhc3RTaHJpbmtPZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJTdGFydE9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdkJ1ZmZlclNlcmlhbCA9IDA7XG4gICAgICAgIHRoaXMucHJpdkJ1ZmZlcmVkQnl0ZXMgPSAwO1xuICAgICAgICB0aGlzLnByaXZSZXBsYXkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2TGFzdENodW5rQWNxdWlyZWRUaW1lID0gMDtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlID0gYXVkaW9Tb3VyY2U7XG4gICAgICAgIHRoaXMucHJpdkJ5dGVzUGVyU2Vjb25kID0gYnl0ZXNQZXJTZWNvbmQ7XG4gICAgfVxuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Ob2RlLmlkKCk7XG4gICAgfVxuICAgIC8vIFJlYWRzIGFuZCByZXR1cm5zIHRoZSBuZXh0IGNodW5rIG9mIGF1ZGlvIGJ1ZmZlci5cbiAgICAvLyBJZiByZXBsYXkgb2YgZXhpc3RpbmcgYnVmZmVycyBhcmUgbmVlZGVkLCByZWFkKCkgd2lsbCBmaXJzdCBzZWVrIGFuZCByZXBsYXlcbiAgICAvLyBleGlzdGluZyBjb250ZW50LCBhbmQgdXBvaW4gY29tcGxldGlvbiBpdCB3aWxsIHJlYWQgbmV3IGNvbnRlbnQgZnJvbSB0aGUgdW5kZXJseWluZ1xuICAgIC8vIGF1ZGlvIG5vZGUsIHNhdmluZyB0aGF0IGNvbnRlbnQgaW50byB0aGUgcmVwbGF5YWJsZSBidWZmZXJzLlxuICAgIHJlYWQoKSB7XG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgcmVwbGF5IHJlcXVlc3QgdG8gaG9ub3IuXG4gICAgICAgIGlmICghIXRoaXMucHJpdlJlcGxheSAmJiB0aGlzLnByaXZCdWZmZXJzLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgc3RhcnQgcG9pbnQgaW4gdGhlIGJ1ZmZlcnMuXG4gICAgICAgICAgICAvLyBPZmZzZXRzIGFyZSBpbiAxMDBucyBpbmNyZW1lbnRzLlxuICAgICAgICAgICAgLy8gU28gaG93IG1hbnkgYnl0ZXMgZG8gd2UgbmVlZCB0byBzZWVrIHRvIGdldCB0aGUgcmlnaHQgb2Zmc2V0P1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0VG9TZWVrID0gdGhpcy5wcml2UmVwbGF5T2Zmc2V0IC0gdGhpcy5wcml2QnVmZmVyU3RhcnRPZmZzZXQ7XG4gICAgICAgICAgICBsZXQgYnl0ZXNUb1NlZWsgPSBNYXRoLnJvdW5kKG9mZnNldFRvU2VlayAqIHRoaXMucHJpdkJ5dGVzUGVyU2Vjb25kICogMWUtNyk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gKGJ5dGVzVG9TZWVrICUgMikpIHtcbiAgICAgICAgICAgICAgICBieXRlc1RvU2VlaysrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGkgPCB0aGlzLnByaXZCdWZmZXJzLmxlbmd0aCAmJiBieXRlc1RvU2VlayA+PSB0aGlzLnByaXZCdWZmZXJzW2ldLmNodW5rLmJ1ZmZlci5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgYnl0ZXNUb1NlZWsgLT0gdGhpcy5wcml2QnVmZmVyc1tpKytdLmNodW5rLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGkgPCB0aGlzLnByaXZCdWZmZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJldFZhbCA9IHRoaXMucHJpdkJ1ZmZlcnNbaV0uY2h1bmsuYnVmZmVyLnNsaWNlKGJ5dGVzVG9TZWVrKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXBsYXlPZmZzZXQgKz0gKHJldFZhbC5ieXRlTGVuZ3RoIC8gdGhpcy5wcml2Qnl0ZXNQZXJTZWNvbmQpICogMWUrNztcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSByZWFjaGVkIHRoZSBlbmQgb2YgdGhlIGJ1ZmZlcnMsIHN0b3AgcmVwbGF5aW5nLlxuICAgICAgICAgICAgICAgIGlmIChpID09PSB0aGlzLnByaXZCdWZmZXJzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVwbGF5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICBidWZmZXI6IHJldFZhbCxcbiAgICAgICAgICAgICAgICAgICAgaXNFbmQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0aW1lUmVjZWl2ZWQ6IHRoaXMucHJpdkJ1ZmZlcnNbaV0uY2h1bmsudGltZVJlY2VpdmVkLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb05vZGUucmVhZCgpXG4gICAgICAgICAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5idWZmZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZCdWZmZXJzLnB1c2gobmV3IEJ1ZmZlckVudHJ5KHJlc3VsdCwgdGhpcy5wcml2QnVmZmVyU2VyaWFsKyssIHRoaXMucHJpdkJ1ZmZlcmVkQnl0ZXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZCdWZmZXJlZEJ5dGVzICs9IHJlc3VsdC5idWZmZXIuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHRoaXMucHJpdkJ1ZmZlcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb05vZGUuZGV0YWNoKCk7XG4gICAgfVxuICAgIHJlcGxheSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkJ1ZmZlcnMgJiYgMCAhPT0gdGhpcy5wcml2QnVmZmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcGxheSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXBsYXlPZmZzZXQgPSB0aGlzLnByaXZMYXN0U2hyaW5rT2Zmc2V0O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIFNocmlua3MgdGhlIGV4aXN0aW5nIGF1ZGlvIGJ1ZmZlcnMgdG8gc3RhcnQgYXQgdGhlIG5ldyBvZmZzZXQsIG9yIGF0IHRoZVxuICAgIC8vIGJlZ2lubmluZyBvZiB0aGUgYnVmZmVyIGNsb3Nlc3QgdG8gdGhlIHJlcXVlc3RlZCBvZmZzZXQuXG4gICAgLy8gQSByZXBsYXkgcmVxdWVzdCB3aWxsIHN0YXJ0IGZyb20gdGhlIGxhc3Qgc2hyaW5rIHBvaW50LlxuICAgIHNocmlua0J1ZmZlcnMob2Zmc2V0KSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZCdWZmZXJzID09PSB1bmRlZmluZWQgfHwgdGhpcy5wcml2QnVmZmVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZMYXN0U2hyaW5rT2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgICAvLyBGaW5kIHRoZSBzdGFydCBwb2ludCBpbiB0aGUgYnVmZmVycy5cbiAgICAgICAgLy8gT2Zmc2V0cyBhcmUgaW4gMTAwbnMgaW5jcmVtZW50cy5cbiAgICAgICAgLy8gU28gaG93IG1hbnkgYnl0ZXMgZG8gd2UgbmVlZCB0byBzZWVrIHRvIGdldCB0aGUgcmlnaHQgb2Zmc2V0P1xuICAgICAgICBjb25zdCBvZmZzZXRUb1NlZWsgPSBvZmZzZXQgLSB0aGlzLnByaXZCdWZmZXJTdGFydE9mZnNldDtcbiAgICAgICAgbGV0IGJ5dGVzVG9TZWVrID0gTWF0aC5yb3VuZChvZmZzZXRUb1NlZWsgKiB0aGlzLnByaXZCeXRlc1BlclNlY29uZCAqIDFlLTcpO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHdoaWxlIChpIDwgdGhpcy5wcml2QnVmZmVycy5sZW5ndGggJiYgYnl0ZXNUb1NlZWsgPj0gdGhpcy5wcml2QnVmZmVyc1tpXS5jaHVuay5idWZmZXIuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgYnl0ZXNUb1NlZWsgLT0gdGhpcy5wcml2QnVmZmVyc1tpKytdLmNodW5rLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkJ1ZmZlclN0YXJ0T2Zmc2V0ID0gTWF0aC5yb3VuZChvZmZzZXQgLSAoKGJ5dGVzVG9TZWVrIC8gdGhpcy5wcml2Qnl0ZXNQZXJTZWNvbmQpICogMWUrNykpO1xuICAgICAgICB0aGlzLnByaXZCdWZmZXJzID0gdGhpcy5wcml2QnVmZmVycy5zbGljZShpKTtcbiAgICB9XG4gICAgLy8gRmluZHMgdGhlIHRpbWUgYSBidWZmZXIgb2YgYXVkaW8gd2FzIGZpcnN0IHNlZW4gYnkgb2Zmc2V0LlxuICAgIGZpbmRUaW1lQXRPZmZzZXQob2Zmc2V0KSB7XG4gICAgICAgIGlmIChvZmZzZXQgPCB0aGlzLnByaXZCdWZmZXJTdGFydE9mZnNldCB8fCB0aGlzLnByaXZCdWZmZXJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdmFsdWUgb2YgdGhpcy5wcml2QnVmZmVycykge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnRPZmZzZXQgPSAodmFsdWUuYnl0ZU9mZnNldCAvIHRoaXMucHJpdkJ5dGVzUGVyU2Vjb25kKSAqIDFlNztcbiAgICAgICAgICAgIGNvbnN0IGVuZE9mZnNldCA9IHN0YXJ0T2Zmc2V0ICsgKCh2YWx1ZS5jaHVuay5idWZmZXIuYnl0ZUxlbmd0aCAvIHRoaXMucHJpdkJ5dGVzUGVyU2Vjb25kKSAqIDFlNyk7XG4gICAgICAgICAgICBpZiAob2Zmc2V0ID49IHN0YXJ0T2Zmc2V0ICYmIG9mZnNldCA8PSBlbmRPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUuY2h1bmsudGltZVJlY2VpdmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn1cbi8vIFByaW1hcnkgdXNlIG9mIHRoaXMgY2xhc3MgaXMgdG8gaGVscCBkZWJ1Z2dpbmcgcHJvYmxlbXMgd2l0aCB0aGUgcmVwbGF5XG4vLyBjb2RlLiBJZiB0aGUgbWVtb3J5IGNvc3Qgb2YgYWxsb2MgLyBkZWFsbG9jIGdldHMgdG9vIG11Y2gsIGRyb3AgaXQgYW5kIGp1c3QgdXNlXG4vLyB0aGUgQXJyYXlCdWZmZXIgZGlyZWN0bHkuXG5jbGFzcyBCdWZmZXJFbnRyeSB7XG4gICAgY29uc3RydWN0b3IoY2h1bmssIHNlcmlhbCwgYnl0ZU9mZnNldCkge1xuICAgICAgICB0aGlzLmNodW5rID0gY2h1bms7XG4gICAgICAgIHRoaXMuc2VyaWFsID0gc2VyaWFsO1xuICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVwbGF5YWJsZUF1ZGlvTm9kZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFJlc3RDb25maWdCYXNlIHtcbiAgICBzdGF0aWMgZ2V0IHJlcXVlc3RPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4gUmVzdENvbmZpZ0Jhc2UucHJpdkRlZmF1bHRSZXF1ZXN0T3B0aW9ucztcbiAgICB9XG4gICAgc3RhdGljIGdldCBjb25maWdQYXJhbXMoKSB7XG4gICAgICAgIHJldHVybiBSZXN0Q29uZmlnQmFzZS5wcml2RGVmYXVsdFBhcmFtcztcbiAgICB9XG4gICAgc3RhdGljIGdldCByZXN0RXJyb3JzKCkge1xuICAgICAgICByZXR1cm4gUmVzdENvbmZpZ0Jhc2UucHJpdlJlc3RFcnJvcnM7XG4gICAgfVxufVxuUmVzdENvbmZpZ0Jhc2UucHJpdkRlZmF1bHRSZXF1ZXN0T3B0aW9ucyA9IHtcbiAgICBoZWFkZXJzOiB7XG4gICAgICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgfSxcbiAgICBpZ25vcmVDYWNoZTogZmFsc2UsXG4gICAgdGltZW91dDogMTAwMDAsXG59O1xuUmVzdENvbmZpZ0Jhc2UucHJpdlJlc3RFcnJvcnMgPSB7XG4gICAgYXV0aEludmFsaWRTdWJzY3JpcHRpb25LZXk6IFwiWW91IG11c3Qgc3BlY2lmeSBlaXRoZXIgYW4gYXV0aGVudGljYXRpb24gdG9rZW4gdG8gdXNlLCBvciBhIENvZ25pdGl2ZSBTcGVlY2ggc3Vic2NyaXB0aW9uIGtleS5cIixcbiAgICBhdXRoSW52YWxpZFN1YnNjcmlwdGlvblJlZ2lvbjogXCJZb3UgbXVzdCBzcGVjaWZ5IHRoZSBDb2duaXRpdmUgU3BlZWNoIHJlZ2lvbiB0byB1c2UuXCIsXG4gICAgaW52YWxpZEFyZ3M6IFwiUmVxdWlyZWQgaW5wdXQgbm90IGZvdW5kOiB7YXJnfS5cIixcbiAgICBpbnZhbGlkQ3JlYXRlSm9pbkNvbnZlcnNhdGlvblJlc3BvbnNlOiBcIkNyZWF0aW5nL0pvaW5pbmcgY29udmVyc2F0aW9uIGZhaWxlZCB3aXRoIEhUVFAge3N0YXR1c30uXCIsXG4gICAgaW52YWxpZFBhcnRpY2lwYW50UmVxdWVzdDogXCJUaGUgcmVxdWVzdGVkIHBhcnRpY2lwYW50IHdhcyBub3QgZm91bmQuXCIsXG4gICAgcGVybWlzc2lvbkRlbmllZENvbm5lY3Q6IFwiUmVxdWlyZWQgY3JlZGVudGlhbHMgbm90IGZvdW5kLlwiLFxuICAgIHBlcm1pc3Npb25EZW5pZWRDb252ZXJzYXRpb246IFwiSW52YWxpZCBvcGVyYXRpb246IG9ubHkgdGhlIGhvc3QgY2FuIHtjb21tYW5kfSB0aGUgY29udmVyc2F0aW9uLlwiLFxuICAgIHBlcm1pc3Npb25EZW5pZWRQYXJ0aWNpcGFudDogXCJJbnZhbGlkIG9wZXJhdGlvbjogb25seSB0aGUgaG9zdCBjYW4ge2NvbW1hbmR9IGEgcGFydGljaXBhbnQuXCIsXG4gICAgcGVybWlzc2lvbkRlbmllZFNlbmQ6IFwiSW52YWxpZCBvcGVyYXRpb246IHRoZSBjb252ZXJzYXRpb24gaXMgbm90IGluIGEgY29ubmVjdGVkIHN0YXRlLlwiLFxuICAgIHBlcm1pc3Npb25EZW5pZWRTdGFydDogXCJJbnZhbGlkIG9wZXJhdGlvbjogdGhlcmUgaXMgYWxyZWFkeSBhbiBhY3RpdmUgY29udmVyc2F0aW9uLlwiLFxufTtcblJlc3RDb25maWdCYXNlLnByaXZEZWZhdWx0UGFyYW1zID0ge1xuICAgIGFwaVZlcnNpb246IFwiYXBpLXZlcnNpb25cIixcbiAgICBhdXRob3JpemF0aW9uOiBcIkF1dGhvcml6YXRpb25cIixcbiAgICBjbGllbnRBcHBJZDogXCJYLUNsaWVudEFwcElkXCIsXG4gICAgY29udGVudFR5cGVLZXk6IFwiQ29udGVudC1UeXBlXCIsXG4gICAgY29ycmVsYXRpb25JZDogXCJYLUNvcnJlbGF0aW9uSWRcIixcbiAgICBsYW5ndWFnZUNvZGU6IFwibGFuZ3VhZ2VcIixcbiAgICBuaWNrbmFtZTogXCJuaWNrbmFtZVwiLFxuICAgIHByb2Zhbml0eTogXCJwcm9mYW5pdHlcIixcbiAgICByZXF1ZXN0SWQ6IFwiWC1SZXF1ZXN0SWRcIixcbiAgICByb29tSWQ6IFwicm9vbWlkXCIsXG4gICAgc2Vzc2lvblRva2VuOiBcInRva2VuXCIsXG4gICAgc3Vic2NyaXB0aW9uS2V5OiBcIk9jcC1BcGltLVN1YnNjcmlwdGlvbi1LZXlcIixcbiAgICBzdWJzY3JpcHRpb25SZWdpb246IFwiT2NwLUFwaW0tU3Vic2NyaXB0aW9uLVJlZ2lvblwiLFxuICAgIHRva2VuOiBcIlgtQ2FwaXRvVG9rZW5cIixcbn07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlc3RDb25maWdCYXNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCBiZW50IGZyb20gXCJiZW50XCI7XG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciwgRGVmZXJyZWQgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmV4cG9ydCB2YXIgUmVzdFJlcXVlc3RUeXBlO1xuKGZ1bmN0aW9uIChSZXN0UmVxdWVzdFR5cGUpIHtcbiAgICBSZXN0UmVxdWVzdFR5cGVbXCJHZXRcIl0gPSBcIkdFVFwiO1xuICAgIFJlc3RSZXF1ZXN0VHlwZVtcIlBvc3RcIl0gPSBcIlBPU1RcIjtcbiAgICBSZXN0UmVxdWVzdFR5cGVbXCJEZWxldGVcIl0gPSBcIkRFTEVURVwiO1xuICAgIFJlc3RSZXF1ZXN0VHlwZVtcIkZpbGVcIl0gPSBcImZpbGVcIjtcbn0pKFJlc3RSZXF1ZXN0VHlwZSB8fCAoUmVzdFJlcXVlc3RUeXBlID0ge30pKTtcbi8vIGFjY2VwdCByZXN0IG9wZXJhdGlvbnMgdmlhIHJlcXVlc3QgbWV0aG9kIGFuZCByZXR1cm4gYWJzdHJhY3RlZCBvYmplY3RzIGZyb20gc2VydmVyIHJlc3BvbnNlXG5leHBvcnQgY2xhc3MgUmVzdE1lc3NhZ2VBZGFwdGVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWdQYXJhbXMpIHtcbiAgICAgICAgaWYgKCFjb25maWdQYXJhbXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcImNvbmZpZ1BhcmFtc1wiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZIZWFkZXJzID0gY29uZmlnUGFyYW1zLmhlYWRlcnM7XG4gICAgICAgIHRoaXMucHJpdklnbm9yZUNhY2hlID0gY29uZmlnUGFyYW1zLmlnbm9yZUNhY2hlO1xuICAgIH1cbiAgICBzdGF0aWMgZXh0cmFjdEhlYWRlclZhbHVlKGhlYWRlcktleSwgaGVhZGVycykge1xuICAgICAgICBsZXQgaGVhZGVyVmFsdWUgPSBcIlwiO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgYXJyID0gaGVhZGVycy50cmltKCkuc3BsaXQoL1tcXHJcXG5dKy8pO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVyTWFwID0ge307XG4gICAgICAgICAgICBhcnIuZm9yRWFjaCgobGluZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gbGluZS5zcGxpdChcIjogXCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IHBhcnRzLnNoaWZ0KCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHBhcnRzLmpvaW4oXCI6IFwiKTtcbiAgICAgICAgICAgICAgICBoZWFkZXJNYXBbaGVhZGVyXSA9IHZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoZWFkZXJWYWx1ZSA9IGhlYWRlck1hcFtoZWFkZXJLZXkudG9Mb3dlckNhc2UoKV07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIGlnbm9yZSB0aGUgZXJyb3JcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGVhZGVyVmFsdWU7XG4gICAgfVxuICAgIHNldCBvcHRpb25zKGNvbmZpZ1BhcmFtcykge1xuICAgICAgICB0aGlzLnByaXZIZWFkZXJzID0gY29uZmlnUGFyYW1zLmhlYWRlcnM7XG4gICAgICAgIHRoaXMucHJpdklnbm9yZUNhY2hlID0gY29uZmlnUGFyYW1zLmlnbm9yZUNhY2hlO1xuICAgIH1cbiAgICBzZXRIZWFkZXJzKGtleSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVyc1trZXldID0gdmFsdWU7XG4gICAgfVxuICAgIHJlcXVlc3QobWV0aG9kLCB1cmksIHF1ZXJ5UGFyYW1zID0ge30sIGJvZHkgPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlUmVjZWl2ZWREZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBjb25zdCByZXF1ZXN0Q29tbWFuZCA9IG1ldGhvZCA9PT0gUmVzdFJlcXVlc3RUeXBlLkZpbGUgPyBcIlBPU1RcIiA6IG1ldGhvZDtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzdFJlc3BvbnNlID0gKGRhdGEsIGogPSB7fSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZCA9IGRhdGE7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGopLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IEpTT04uc3RyaW5naWZ5KGRhdGEuaGVhZGVycyksXG4gICAgICAgICAgICAgICAganNvbjogaixcbiAgICAgICAgICAgICAgICBvazogZGF0YS5zdGF0dXNDb2RlID49IDIwMCAmJiBkYXRhLnN0YXR1c0NvZGUgPCAzMDAsXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBkYXRhLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogai5lcnJvciA/IGouZXJyb3IubWVzc2FnZSA6IGQuc3RhdHVzVGV4dCA/IGQuc3RhdHVzVGV4dCA6IGQuc3RhdHVzTWVzc2FnZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc2VuZCA9IChwb3N0RGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2VuZFJlcXVlc3QgPSBiZW50KHVyaSwgcmVxdWVzdENvbW1hbmQsIHRoaXMucHJpdkhlYWRlcnMsIDIwMCwgMjAxLCAyMDIsIDIwNCwgNDAwLCA0MDEsIDQwMiwgNDAzLCA0MDQpO1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zID0gdGhpcy5xdWVyeVBhcmFtcyhxdWVyeVBhcmFtcykgPT09IFwiXCIgPyBcIlwiIDogYD8ke3RoaXMucXVlcnlQYXJhbXMocXVlcnlQYXJhbXMpfWA7XG4gICAgICAgICAgICBzZW5kUmVxdWVzdChwYXJhbXMsIHBvc3REYXRhKS50aGVuKChkYXRhKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ldGhvZCA9PT0gUmVzdFJlcXVlc3RUeXBlLkRlbGV0ZSB8fCBkYXRhLnN0YXR1c0NvZGUgPT09IDIwNCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBObyBKU09OIGZyb20gRGVsZXRlIGFuZCByZXNldCAoMjA0KSBvcGVyYXRpb25zXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlUmVjZWl2ZWREZWZlcnJhbC5yZXNvbHZlKGhhbmRsZVJlc3RSZXNwb25zZShkYXRhKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaiA9IHlpZWxkIGRhdGEuanNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VSZWNlaXZlZERlZmVycmFsLnJlc29sdmUoaGFuZGxlUmVzdFJlc3BvbnNlKGRhdGEsIGopKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlUmVjZWl2ZWREZWZlcnJhbC5yZXNvbHZlKGhhbmRsZVJlc3RSZXNwb25zZShkYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VSZWNlaXZlZERlZmVycmFsLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMucHJpdklnbm9yZUNhY2hlKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZIZWFkZXJzW1wiQ2FjaGUtQ29udHJvbFwiXSA9IFwibm8tY2FjaGVcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWV0aG9kID09PSBSZXN0UmVxdWVzdFR5cGUuUG9zdCAmJiBib2R5KSB7XG4gICAgICAgICAgICB0aGlzLnByaXZIZWFkZXJzW1wiY29udGVudC10eXBlXCJdID0gXCJhcHBsaWNhdGlvbi9qc29uXCI7XG4gICAgICAgICAgICB0aGlzLnByaXZIZWFkZXJzW1wiQ29udGVudC1UeXBlXCJdID0gXCJhcHBsaWNhdGlvbi9qc29uXCI7XG4gICAgICAgIH1cbiAgICAgICAgc2VuZChib2R5KTtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlUmVjZWl2ZWREZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBxdWVyeVBhcmFtcyhwYXJhbXMgPSB7fSkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKVxuICAgICAgICAgICAgLm1hcCgoaykgPT4gZW5jb2RlVVJJQ29tcG9uZW50KGspICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2tdKSlcbiAgICAgICAgICAgIC5qb2luKFwiJlwiKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlc3RNZXNzYWdlQWRhcHRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciwgY3JlYXRlTm9EYXNoR3VpZCwgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IFdlYnNvY2tldE1lc3NhZ2VBZGFwdGVyIH0gZnJvbSBcIi4vV2Vic29ja2V0TWVzc2FnZUFkYXB0ZXJcIjtcbmV4cG9ydCBjbGFzcyBXZWJzb2NrZXRDb25uZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih1cmksIHF1ZXJ5UGFyYW1ldGVycywgaGVhZGVycywgbWVzc2FnZUZvcm1hdHRlciwgcHJveHlJbmZvLCBlbmFibGVDb21wcmVzc2lvbiA9IGZhbHNlLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoIXVyaSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwidXJpXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbWVzc2FnZUZvcm1hdHRlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwibWVzc2FnZUZvcm1hdHRlclwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZNZXNzYWdlRm9ybWF0dGVyID0gbWVzc2FnZUZvcm1hdHRlcjtcbiAgICAgICAgbGV0IHF1ZXJ5UGFyYW1zID0gXCJcIjtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBpZiAocXVlcnlQYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhcmFtTmFtZSBpbiBxdWVyeVBhcmFtZXRlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1OYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zICs9ICgoaSA9PT0gMCkgJiYgKHVyaS5pbmRleE9mKFwiP1wiKSA9PT0gLTEpKSA/IFwiP1wiIDogXCImXCI7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IGVuY29kZVVSSUNvbXBvbmVudChwYXJhbU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcyArPSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB2YWwgPSBxdWVyeVBhcmFtZXRlcnNbcGFyYW1OYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gZW5jb2RlVVJJQ29tcG9uZW50KHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcyArPSBgPSR7dmFsfWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaGVhZGVycykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXJOYW1lIGluIGhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVhZGVyTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcyArPSAoKGkgPT09IDApICYmICh1cmkuaW5kZXhPZihcIj9cIikgPT09IC0xKSkgPyBcIj9cIiA6IFwiJlwiO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBlbmNvZGVVUklDb21wb25lbnQoaGVhZGVyc1toZWFkZXJOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zICs9IGAke2hlYWRlck5hbWV9PSR7dmFsfWA7XG4gICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2VXJpID0gdXJpICsgcXVlcnlQYXJhbXM7XG4gICAgICAgIHRoaXMucHJpdklkID0gY29ubmVjdGlvbklkID8gY29ubmVjdGlvbklkIDogY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZUFkYXB0ZXIgPSBuZXcgV2Vic29ja2V0TWVzc2FnZUFkYXB0ZXIodGhpcy5wcml2VXJpLCB0aGlzLmlkLCB0aGlzLnByaXZNZXNzYWdlRm9ybWF0dGVyLCBwcm94eUluZm8sIGhlYWRlcnMsIGVuYWJsZUNvbXByZXNzaW9uKTtcbiAgICB9XG4gICAgZGlzcG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlQWRhcHRlcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlQWRhcHRlci5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICBnZXQgdXJpKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VXJpO1xuICAgIH1cbiAgICBzdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlQWRhcHRlci5zdGF0ZTtcbiAgICB9XG4gICAgb3BlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlQWRhcHRlci5vcGVuKCk7XG4gICAgfVxuICAgIHNlbmQobWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2VBZGFwdGVyLnNlbmQobWVzc2FnZSk7XG4gICAgfVxuICAgIHJlYWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZUFkYXB0ZXIucmVhZCgpO1xuICAgIH1cbiAgICBnZXQgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2VBZGFwdGVyLmV2ZW50cztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVdlYnNvY2tldENvbm5lY3Rpb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0ICogYXMgbmV0IGZyb20gXCJuZXRcIjtcbmltcG9ydCAqIGFzIHRscyBmcm9tIFwidGxzXCI7XG5pbXBvcnQgQWdlbnQgZnJvbSBcImFnZW50LWJhc2VcIjtcbmltcG9ydCBIdHRwc1Byb3h5QWdlbnQgZnJvbSBcImh0dHBzLXByb3h5LWFnZW50XCI7XG5pbXBvcnQgd3MgZnJvbSBcIndzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciwgQmFja2dyb3VuZEV2ZW50LCBDb25uZWN0aW9uQ2xvc2VkRXZlbnQsIENvbm5lY3Rpb25FcnJvckV2ZW50LCBDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudCwgQ29ubmVjdGlvbk1lc3NhZ2VSZWNlaXZlZEV2ZW50LCBDb25uZWN0aW9uTWVzc2FnZVNlbnRFdmVudCwgQ29ubmVjdGlvbk9wZW5SZXNwb25zZSwgQ29ubmVjdGlvblN0YXJ0RXZlbnQsIENvbm5lY3Rpb25TdGF0ZSwgRGVmZXJyZWQsIEV2ZW50cywgRXZlbnRTb3VyY2UsIE1lc3NhZ2VUeXBlLCBRdWV1ZSwgUmF3V2Vic29ja2V0TWVzc2FnZSwgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBXZWJzb2NrZXRNZXNzYWdlQWRhcHRlciB7XG4gICAgY29uc3RydWN0b3IodXJpLCBjb25uZWN0aW9uSWQsIG1lc3NhZ2VGb3JtYXR0ZXIsIHByb3h5SW5mbywgaGVhZGVycywgZW5hYmxlQ29tcHJlc3Npb24pIHtcbiAgICAgICAgaWYgKCF1cmkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcInVyaVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1lc3NhZ2VGb3JtYXR0ZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcIm1lc3NhZ2VGb3JtYXR0ZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm94eUluZm8gPSBwcm94eUluZm87XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gY29ubmVjdGlvbklkO1xuICAgICAgICB0aGlzLnByaXZNZXNzYWdlRm9ybWF0dGVyID0gbWVzc2FnZUZvcm1hdHRlcjtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLk5vbmU7XG4gICAgICAgIHRoaXMucHJpdlVyaSA9IHVyaTtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVycyA9IGhlYWRlcnM7XG4gICAgICAgIHRoaXMucHJpdkVuYWJsZUNvbXByZXNzaW9uID0gZW5hYmxlQ29tcHJlc3Npb247XG4gICAgICAgIC8vIEFkZCB0aGUgY29ubmVjdGlvbiBJRCB0byB0aGUgaGVhZGVyc1xuICAgICAgICB0aGlzLnByaXZIZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSB0aGlzLnByaXZDb25uZWN0aW9uSWQ7XG4gICAgICAgIHRoaXMucHJpdkxhc3RFcnJvclJlY2VpdmVkID0gXCJcIjtcbiAgICB9XG4gICAgZ2V0IHN0YXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlO1xuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID09PSBDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYENhbm5vdCBvcGVuIGEgY29ubmVjdGlvbiB0aGF0IGlzIGluICR7dGhpcy5wcml2Q29ubmVjdGlvblN0YXRlfSBzdGF0ZWApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdGhpcy5wcml2Q2VydGlmaWNhdGVWYWxpZGF0ZWREZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uU3RhdGUgPSBDb25uZWN0aW9uU3RhdGUuQ29ubmVjdGluZztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgV2ViU29ja2V0ICE9PSBcInVuZGVmaW5lZFwiICYmICFXZWJzb2NrZXRNZXNzYWdlQWRhcHRlci5mb3JjZU5wbVdlYlNvY2tldCkge1xuICAgICAgICAgICAgICAgIC8vIEJyb3dzZXIgaGFuZGxlcyBjZXJ0IGNoZWNrcy5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDZXJ0aWZpY2F0ZVZhbGlkYXRlZERlZmVycmFsLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQgPSBuZXcgV2ViU29ja2V0KHRoaXMucHJpdlVyaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0geyBoZWFkZXJzOiB0aGlzLnByaXZIZWFkZXJzLCBwZXJNZXNzYWdlRGVmbGF0ZTogdGhpcy5wcml2RW5hYmxlQ29tcHJlc3Npb24gfTtcbiAgICAgICAgICAgICAgICAvLyBUaGUgb2NzcCBsaWJyYXJ5IHdpbGwgaGFuZGxlIHZhbGlkYXRpb24gZm9yIHVzIGFuZCBmYWlsIHRoZSBjb25uZWN0aW9uIGlmIG5lZWRlZC5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDZXJ0aWZpY2F0ZVZhbGlkYXRlZERlZmVycmFsLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBvcHRpb25zLmFnZW50ID0gdGhpcy5nZXRBZ2VudCgpO1xuICAgICAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvY29nbml0aXZlLXNlcnZpY2VzLXNwZWVjaC1zZGstanMvaXNzdWVzLzQ2NVxuICAgICAgICAgICAgICAgIC8vIFdoaWNoIGlzIHJvb3QgY2F1c2VkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9Ub29UYWxsTmF0ZS9ub2RlLWFnZW50LWJhc2UvaXNzdWVzLzYxXG4gICAgICAgICAgICAgICAgY29uc3QgdXJpID0gbmV3IFVSTCh0aGlzLnByaXZVcmkpO1xuICAgICAgICAgICAgICAgIGxldCBwcm90b2NvbCA9IHVyaS5wcm90b2NvbDtcbiAgICAgICAgICAgICAgICBpZiAoKHByb3RvY29sID09PSBudWxsIHx8IHByb3RvY29sID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwcm90b2NvbC50b0xvY2FsZUxvd2VyQ2FzZSgpKSA9PT0gXCJ3c3M6XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2wgPSBcImh0dHBzOlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICgocHJvdG9jb2wgPT09IG51bGwgfHwgcHJvdG9jb2wgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb3RvY29sLnRvTG9jYWxlTG93ZXJDYXNlKCkpID09PSBcIndzOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCJodHRwOlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5hZ2VudC5wcm90b2NvbCA9IHByb3RvY29sO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudCA9IG5ldyB3cyh0aGlzLnByaXZVcmksIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50LmJpbmFyeVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNlaXZpbmdNZXNzYWdlUXVldWUgPSBuZXcgUXVldWUoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkRpc2Nvbm5lY3REZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2U2VuZE1lc3NhZ2VRdWV1ZSA9IG5ldyBRdWV1ZSgpO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzU2VuZFF1ZXVlKCkuY2F0Y2goKHJlYXNvbikgPT4ge1xuICAgICAgICAgICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KG5ldyBCYWNrZ3JvdW5kRXZlbnQocmVhc29uKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hEZWZlcnJhbC5yZXNvbHZlKG5ldyBDb25uZWN0aW9uT3BlblJlc3BvbnNlKDUwMCwgZXJyb3IpKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwucHJvbWlzZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IENvbm5lY3Rpb25TdGFydEV2ZW50KHRoaXMucHJpdkNvbm5lY3Rpb25JZCwgdGhpcy5wcml2VXJpKSk7XG4gICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5vbm9wZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZDZXJ0aWZpY2F0ZVZhbGlkYXRlZERlZmVycmFsLnByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkNvbm5lY3RlZDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IENvbm5lY3Rpb25Fc3RhYmxpc2hlZEV2ZW50KHRoaXMucHJpdkNvbm5lY3Rpb25JZCkpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hEZWZlcnJhbC5yZXNvbHZlKG5ldyBDb25uZWN0aW9uT3BlblJlc3BvbnNlKDIwMCwgXCJcIikpO1xuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaERlZmVycmFsLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50Lm9uZXJyb3IgPSAoZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW9uRXJyb3JFdmVudCh0aGlzLnByaXZDb25uZWN0aW9uSWQsIGUubWVzc2FnZSwgZS50eXBlKSk7XG4gICAgICAgICAgICB0aGlzLnByaXZMYXN0RXJyb3JSZWNlaXZlZCA9IGUubWVzc2FnZTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50Lm9uY2xvc2UgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSA9PT0gQ29ubmVjdGlvblN0YXRlLkNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uU3RhdGUgPSBDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkO1xuICAgICAgICAgICAgICAgIC8vIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGlvbkVzdGFibGlzaEVycm9yRXZlbnQodGhpcy5jb25uZWN0aW9uSWQsIGUuY29kZSwgZS5yZWFzb24pKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoRGVmZXJyYWwucmVzb2x2ZShuZXcgQ29ubmVjdGlvbk9wZW5SZXNwb25zZShlLmNvZGUsIGUucmVhc29uICsgXCIgXCIgKyB0aGlzLnByaXZMYXN0RXJyb3JSZWNlaXZlZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQ29ubmVjdGlvbkNsb3NlZEV2ZW50KHRoaXMucHJpdkNvbm5lY3Rpb25JZCwgZS5jb2RlLCBlLnJlYXNvbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbkNsb3NlKGUuY29kZSwgZS5yZWFzb24pLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChuZXcgQmFja2dyb3VuZEV2ZW50KHJlYXNvbikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5vbm1lc3NhZ2UgPSAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV0d29ya1JlY2VpdmVkVGltZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uU3RhdGUgPT09IENvbm5lY3Rpb25TdGF0ZS5Db25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgICAgIC8vIGxldCBpZCA9ICsrdGhpcy5pZENvdW50ZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2aW5nTWVzc2FnZVF1ZXVlLmVucXVldWVGcm9tUHJvbWlzZShkZWZlcnJlZC5wcm9taXNlKTtcbiAgICAgICAgICAgICAgICBpZiAoZS5kYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmF3TWVzc2FnZSA9IG5ldyBSYXdXZWJzb2NrZXRNZXNzYWdlKE1lc3NhZ2VUeXBlLkJpbmFyeSwgZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TWVzc2FnZUZvcm1hdHRlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQ29ubmVjdGlvbk1lc3NhZ2UocmF3TWVzc2FnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChjb25uZWN0aW9uTWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW9uTWVzc2FnZVJlY2VpdmVkRXZlbnQodGhpcy5wcml2Q29ubmVjdGlvbklkLCBuZXR3b3JrUmVjZWl2ZWRUaW1lLCBjb25uZWN0aW9uTWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb25uZWN0aW9uTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogRXZlbnRzIGZvciB0aGVzZSA/XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoYEludmFsaWQgYmluYXJ5IG1lc3NhZ2UgZm9ybWF0LiBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByYXdNZXNzYWdlID0gbmV3IFJhd1dlYnNvY2tldE1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TWVzc2FnZUZvcm1hdHRlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRvQ29ubmVjdGlvbk1lc3NhZ2UocmF3TWVzc2FnZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChjb25uZWN0aW9uTWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW9uTWVzc2FnZVJlY2VpdmVkRXZlbnQodGhpcy5wcml2Q29ubmVjdGlvbklkLCBuZXR3b3JrUmVjZWl2ZWRUaW1lLCBjb25uZWN0aW9uTWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShjb25uZWN0aW9uTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogRXZlbnRzIGZvciB0aGVzZSA/XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoYEludmFsaWQgdGV4dCBtZXNzYWdlIGZvcm1hdC4gRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hEZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBzZW5kKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSAhPT0gQ29ubmVjdGlvblN0YXRlLkNvbm5lY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBDYW5ub3Qgc2VuZCBvbiBjb25uZWN0aW9uIHRoYXQgaXMgaW4gJHtDb25uZWN0aW9uU3RhdGVbdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlXX0gc3RhdGVgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtZXNzYWdlU2VuZFN0YXR1c0RlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VTZW5kRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgdGhpcy5wcml2U2VuZE1lc3NhZ2VRdWV1ZS5lbnF1ZXVlRnJvbVByb21pc2UobWVzc2FnZVNlbmREZWZlcnJhbC5wcm9taXNlKTtcbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZUZvcm1hdHRlclxuICAgICAgICAgICAgLmZyb21Db25uZWN0aW9uTWVzc2FnZShtZXNzYWdlKVxuICAgICAgICAgICAgLnRoZW4oKHJhd01lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIG1lc3NhZ2VTZW5kRGVmZXJyYWwucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgTWVzc2FnZTogbWVzc2FnZSxcbiAgICAgICAgICAgICAgICBSYXdXZWJzb2NrZXRNZXNzYWdlOiByYXdNZXNzYWdlLFxuICAgICAgICAgICAgICAgIHNlbmRTdGF0dXNEZWZlcnJhbDogbWVzc2FnZVNlbmRTdGF0dXNEZWZlcnJhbCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIG1lc3NhZ2VTZW5kRGVmZXJyYWwucmVqZWN0KGBFcnJvciBmb3JtYXR0aW5nIHRoZSBtZXNzYWdlLiAke2Vycm9yfWApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2VTZW5kU3RhdHVzRGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgcmVhZCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25TdGF0ZSAhPT0gQ29ubmVjdGlvblN0YXRlLkNvbm5lY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBDYW5ub3QgcmVhZCBvbiBjb25uZWN0aW9uIHRoYXQgaXMgaW4gJHt0aGlzLnByaXZDb25uZWN0aW9uU3RhdGV9IHN0YXRlYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY2VpdmluZ01lc3NhZ2VRdWV1ZS5kZXF1ZXVlKCk7XG4gICAgfVxuICAgIGNsb3NlKHJlYXNvbikge1xuICAgICAgICBpZiAodGhpcy5wcml2V2Vic29ja2V0Q2xpZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvblN0YXRlICE9PSBDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50LmNsb3NlKDEwMDAsIHJlYXNvbiA/IHJlYXNvbiA6IFwiTm9ybWFsIGNsb3N1cmUgYnkgY2xpZW50XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEaXNjb25uZWN0RGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgZ2V0IGV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHM7XG4gICAgfVxuICAgIHNlbmRSYXdNZXNzYWdlKHNlbmRJdGVtKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBpbmRpY2F0ZXMgd2UgYXJlIGRyYWluaW5nIHRoZSBxdWV1ZSBhbmQgaXQgY2FtZSB3aXRoIG5vIG1lc3NhZ2U7XG4gICAgICAgICAgICBpZiAoIXNlbmRJdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW9uTWVzc2FnZVNlbnRFdmVudCh0aGlzLnByaXZDb25uZWN0aW9uSWQsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgc2VuZEl0ZW0uTWVzc2FnZSkpO1xuICAgICAgICAgICAgLy8gYWRkIGEgY2hlY2sgZm9yIHRoZSB3cyByZWFkeXN0YXRlIGluIG9yZGVyIHRvIHN0b3AgdGhlIHJlZCBjb25zb2xlIGVycm9yICdXZWJTb2NrZXQgaXMgYWxyZWFkeSBpbiBDTE9TSU5HIG9yIENMT1NFRCBzdGF0ZScgYXBwZWFyaW5nXG4gICAgICAgICAgICBpZiAodGhpcy5pc1dlYnNvY2tldE9wZW4pIHtcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgICAgIHRoaXMucHJpdldlYnNvY2tldENsaWVudC5zZW5kKHNlbmRJdGVtLlJhd1dlYnNvY2tldE1lc3NhZ2UucGF5bG9hZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJ3ZWJzb2NrZXQgc2VuZCBlcnJvcjogV2Vic29ja2V0IG5vdCByZWFkeSBcIiArIHRoaXMucHJpdkNvbm5lY3Rpb25JZCArIFwiIFwiICsgc2VuZEl0ZW0uTWVzc2FnZS5pZCArIFwiIFwiICsgbmV3IEVycm9yKCkuc3RhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYHdlYnNvY2tldCBzZW5kIGVycm9yOiAke2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25DbG9zZShjb2RlLCByZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsb3NlUmVhc29uID0gYENvbm5lY3Rpb24gY2xvc2VkLiAke2NvZGV9OiAke3JlYXNvbn1gO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkRpc2Nvbm5lY3REZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNlaXZpbmdNZXNzYWdlUXVldWUuZHJhaW5BbmREaXNwb3NlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBFdmVudHMgZm9yIHRoZXNlID9cbiAgICAgICAgICAgICAgICAvLyBMb2dnZXIuaW5zdGFuY2Uub25FdmVudChuZXcgTG9nZ2luZ0V2ZW50KExvZ1R5cGUuV2FybmluZywgbnVsbCwgYEZhaWxlZCB0byBwcm9jZXNzIHJlY2VpdmVkIG1lc3NhZ2UuIFJlYXNvbjogJHtjbG9zZVJlYXNvbn0sIE1lc3NhZ2U6ICR7SlNPTi5zdHJpbmdpZnkocGVuZGluZ1JlY2VpdmVJdGVtKX1gKSk7XG4gICAgICAgICAgICB9LCBjbG9zZVJlYXNvbik7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZTZW5kTWVzc2FnZVF1ZXVlLmRyYWluQW5kRGlzcG9zZSgocGVuZGluZ1NlbmRJdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgcGVuZGluZ1NlbmRJdGVtLnNlbmRTdGF0dXNEZWZlcnJhbC5yZWplY3QoY2xvc2VSZWFzb24pO1xuICAgICAgICAgICAgfSwgY2xvc2VSZWFzb24pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcHJvY2Vzc1NlbmRRdWV1ZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbVRvU2VuZCA9IHRoaXMucHJpdlNlbmRNZXNzYWdlUXVldWUuZGVxdWV1ZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbmRJdGVtID0geWllbGQgaXRlbVRvU2VuZDtcbiAgICAgICAgICAgICAgICAvLyBpbmRpY2F0ZXMgd2UgYXJlIGRyYWluaW5nIHRoZSBxdWV1ZSBhbmQgaXQgY2FtZSB3aXRoIG5vIG1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKCFzZW5kSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFJhd01lc3NhZ2Uoc2VuZEl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICBzZW5kSXRlbS5zZW5kU3RhdHVzRGVmZXJyYWwucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoc2VuZEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbmRJdGVtLnNlbmRTdGF0dXNEZWZlcnJhbC5yZWplY3Qoc2VuZEVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHMub25FdmVudChldmVudCk7XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIGdldEFnZW50KCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3VuYm91bmQtbWV0aG9kXG4gICAgICAgIGNvbnN0IGFnZW50ID0gbmV3IEFnZW50LkFnZW50KHRoaXMuY3JlYXRlQ29ubmVjdGlvbik7XG4gICAgICAgIGlmICh0aGlzLnByb3h5SW5mbyAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICB0aGlzLnByb3h5SW5mby5Ib3N0TmFtZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICB0aGlzLnByb3h5SW5mby5Qb3J0ID4gMCkge1xuICAgICAgICAgICAgYWdlbnQucHJveHlJbmZvID0gdGhpcy5wcm94eUluZm87XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFnZW50O1xuICAgIH1cbiAgICBzdGF0aWMgR2V0UHJveHlBZ2VudChwcm94eUluZm8pIHtcbiAgICAgICAgY29uc3QgaHR0cFByb3h5T3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGhvc3Q6IHByb3h5SW5mby5Ib3N0TmFtZSxcbiAgICAgICAgICAgIHBvcnQ6IHByb3h5SW5mby5Qb3J0LFxuICAgICAgICB9O1xuICAgICAgICBpZiAoISFwcm94eUluZm8uVXNlck5hbWUpIHtcbiAgICAgICAgICAgIGh0dHBQcm94eU9wdGlvbnMuaGVhZGVycyA9IHtcbiAgICAgICAgICAgICAgICBcIlByb3h5LUF1dGhlbnRpY2F0aW9uXCI6IFwiQmFzaWMgXCIgKyBuZXcgQnVmZmVyKGAke3Byb3h5SW5mby5Vc2VyTmFtZX06JHsocHJveHlJbmZvLlBhc3N3b3JkID09PSB1bmRlZmluZWQpID8gXCJcIiA6IHByb3h5SW5mby5QYXNzd29yZH1gKS50b1N0cmluZyhcImJhc2U2NFwiKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBodHRwUHJveHlPcHRpb25zLmhlYWRlcnMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBodHRwUHJveHlPcHRpb25zLmhlYWRlcnMucmVxdWVzdE9DU1AgPSBcInRydWVcIjtcbiAgICAgICAgY29uc3QgaHR0cFByb3h5QWdlbnQgPSBuZXcgSHR0cHNQcm94eUFnZW50KGh0dHBQcm94eU9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gaHR0cFByb3h5QWdlbnQ7XG4gICAgfVxuICAgIGNyZWF0ZUNvbm5lY3Rpb24ocmVxdWVzdCwgb3B0aW9ucykge1xuICAgICAgICBsZXQgc29ja2V0UHJvbWlzZTtcbiAgICAgICAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucyksIHtcbiAgICAgICAgICAgIHJlcXVlc3RPQ1NQOiB0cnVlLFxuICAgICAgICAgICAgc2VydmVybmFtZTogb3B0aW9ucy5ob3N0XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoISF0aGlzLnByb3h5SW5mbykge1xuICAgICAgICAgICAgY29uc3QgaHR0cFByb3h5QWdlbnQgPSBXZWJzb2NrZXRNZXNzYWdlQWRhcHRlci5HZXRQcm94eUFnZW50KHRoaXMucHJveHlJbmZvKTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2VBZ2VudCA9IGh0dHBQcm94eUFnZW50O1xuICAgICAgICAgICAgc29ja2V0UHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBiYXNlQWdlbnQuY2FsbGJhY2socmVxdWVzdCwgb3B0aW9ucywgKGVycm9yLCBzb2NrZXQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNvY2tldCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCEhb3B0aW9ucy5zZWN1cmVFbmRwb2ludCkge1xuICAgICAgICAgICAgICAgIHNvY2tldFByb21pc2UgPSBQcm9taXNlLnJlc29sdmUodGxzLmNvbm5lY3Qob3B0aW9ucykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc29ja2V0UHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShuZXQuY29ubmVjdChvcHRpb25zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvY2tldFByb21pc2U7XG4gICAgfVxuICAgIGdldCBpc1dlYnNvY2tldE9wZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZXZWJzb2NrZXRDbGllbnQgJiYgdGhpcy5wcml2V2Vic29ja2V0Q2xpZW50LnJlYWR5U3RhdGUgPT09IHRoaXMucHJpdldlYnNvY2tldENsaWVudC5PUEVOO1xuICAgIH1cbn1cbldlYnNvY2tldE1lc3NhZ2VBZGFwdGVyLmZvcmNlTnBtV2ViU29ja2V0ID0gZmFsc2U7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVdlYnNvY2tldE1lc3NhZ2VBZGFwdGVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIEBjbGFzcyBBZGRlZExtSW50ZW50XG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIEFkZGVkTG1JbnRlbnQge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIG1vZGVsSW1wbCAtIFRoZSBtb2RlbC5cbiAgICAgKiBAcGFyYW0gaW50ZW50TmFtZSAtIFRoZSBpbnRlbnQgbmFtZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihtb2RlbEltcGwsIGludGVudE5hbWUpIHtcbiAgICAgICAgdGhpcy5tb2RlbEltcGwgPSBtb2RlbEltcGw7XG4gICAgICAgIHRoaXMuaW50ZW50TmFtZSA9IGludGVudE5hbWU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BZGRlZExtSW50ZW50LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIEpTT04gdXNlZCBpbiB0aGUgYWdlbnQuY29uZmlnIG1lc3NhZ2Ugc2VudCB0byB0aGUgc3BlZWNoIHNlcnZpY2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBBZ2VudENvbmZpZyB7XG4gICAgdG9Kc29uU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5pUHJpdkNvbmZpZyk7XG4gICAgfVxuICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaVByaXZDb25maWc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHRlciBmb3IgdGhlIGFnZW50LmNvbmZpZyBvYmplY3QuXG4gICAgICogQHBhcmFtIHZhbHVlIGEgSlNPTiBzZXJpYWxpemFibGUgb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCh2YWx1ZSkge1xuICAgICAgICB0aGlzLmlQcml2Q29uZmlnID0gdmFsdWU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BZ2VudENvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBBdXRoSW5mbyB9IGZyb20gXCIuL0lBdXRoZW50aWNhdGlvblwiO1xuLyoqXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIENvZ25pdGl2ZVN1YnNjcmlwdGlvbktleUF1dGhlbnRpY2F0aW9uIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGUgQ29nbml0aXZlU3Vic2NyaXB0aW9uS2V5QXV0aGVudGljYXRpb24gY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5XG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgIGlmICghc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJzdWJzY3JpcHRpb25LZXlcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2QXV0aEluZm8gPSBuZXcgQXV0aEluZm8oSGVhZGVyTmFtZXMuQXV0aEtleSwgc3Vic2NyaXB0aW9uS2V5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmV0Y2hlcyB0aGUgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBAbWVtYmVyXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdXRoRmV0Y2hFdmVudElkIC0gVGhlIGlkIHRvIGZldGNoLlxuICAgICAqL1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBmZXRjaChhdXRoRmV0Y2hFdmVudElkKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5wcml2QXV0aEluZm8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGZXRjaGVzIHRoZSBzdWJzY3JpcHRpb24ga2V5LlxuICAgICAqIEBtZW1iZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF1dGhGZXRjaEV2ZW50SWQgLSBUaGUgaWQgdG8gZmV0Y2guXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIGZldGNoT25FeHBpcnkoYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucHJpdkF1dGhJbmZvKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvZ25pdGl2ZVN1YnNjcmlwdGlvbktleUF1dGhlbnRpY2F0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXV0aEluZm8gfSBmcm9tIFwiLi9JQXV0aGVudGljYXRpb25cIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihmZXRjaENhbGxiYWNrLCBmZXRjaE9uRXhwaXJ5Q2FsbGJhY2spIHtcbiAgICAgICAgaWYgKCFmZXRjaENhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJmZXRjaENhbGxiYWNrXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZmV0Y2hPbkV4cGlyeUNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJmZXRjaE9uRXhwaXJ5Q2FsbGJhY2tcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2RmV0Y2hDYWxsYmFjayA9IGZldGNoQ2FsbGJhY2s7XG4gICAgICAgIHRoaXMucHJpdkZldGNoT25FeHBpcnlDYWxsYmFjayA9IGZldGNoT25FeHBpcnlDYWxsYmFjaztcbiAgICB9XG4gICAgZmV0Y2goYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RmV0Y2hDYWxsYmFjayhhdXRoRmV0Y2hFdmVudElkKS50aGVuKCh0b2tlbikgPT4gbmV3IEF1dGhJbmZvKEhlYWRlck5hbWVzLkF1dGhvcml6YXRpb24sIHRva2VuID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uLnByaXZUb2tlblByZWZpeCArIHRva2VuKSk7XG4gICAgfVxuICAgIGZldGNoT25FeHBpcnkoYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RmV0Y2hPbkV4cGlyeUNhbGxiYWNrKGF1dGhGZXRjaEV2ZW50SWQpLnRoZW4oKHRva2VuKSA9PiBuZXcgQXV0aEluZm8oSGVhZGVyTmFtZXMuQXV0aG9yaXphdGlvbiwgdG9rZW4gPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IENvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb24ucHJpdlRva2VuUHJlZml4ICsgdG9rZW4pKTtcbiAgICB9XG59XG5Db2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uLnByaXZUb2tlblByZWZpeCA9IFwiYmVhcmVyIFwiO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBTZXJ2aWNlUHJvcGVydGllc1Byb3BlcnR5TmFtZSwgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBRdWVyeVBhcmFtZXRlck5hbWVzIH0gZnJvbSBcIi4vUXVlcnlQYXJhbWV0ZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgc3RhdGljIGdldEhvc3RTdWZmaXgocmVnaW9uKSB7XG4gICAgICAgIGlmICghIXJlZ2lvbikge1xuICAgICAgICAgICAgaWYgKHJlZ2lvbi50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoXCJjaGluYVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIi5henVyZS5jblwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlZ2lvbi50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoXCJ1c2dvdlwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIi5henVyZS51c1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIi5taWNyb3NvZnQuY29tXCI7XG4gICAgfVxuICAgIHNldENvbW1vblVybFBhcmFtcyhjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludCkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0eUlkVG9QYXJhbWV0ZXJNYXAgPSBuZXcgTWFwKFtcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaF9TZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zLCBRdWVyeVBhcmFtZXRlck5hbWVzLlNlZ21lbnRhdGlvblNpbGVuY2VUaW1lb3V0TXNdLFxuICAgICAgICAgICAgW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5hYmxlQXVkaW9Mb2dnaW5nLCBRdWVyeVBhcmFtZXRlck5hbWVzLkVuYWJsZUF1ZGlvTG9nZ2luZ10sXG4gICAgICAgICAgICBbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRTaWxlbmNlVGltZW91dE1zLCBRdWVyeVBhcmFtZXRlck5hbWVzLkVuZFNpbGVuY2VUaW1lb3V0TXNdLFxuICAgICAgICAgICAgW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSW5pdGlhbFNpbGVuY2VUaW1lb3V0TXMsIFF1ZXJ5UGFyYW1ldGVyTmFtZXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0TXNdLFxuICAgICAgICAgICAgW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1Bvc3RQcm9jZXNzaW5nT3B0aW9uLCBRdWVyeVBhcmFtZXRlck5hbWVzLlBvc3Rwcm9jZXNzaW5nXSxcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qcm9mYW5pdHlPcHRpb24sIFF1ZXJ5UGFyYW1ldGVyTmFtZXMuUHJvZmFuaXR5XSxcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0V29yZExldmVsVGltZXN0YW1wcywgUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmFibGVXb3JkTGV2ZWxUaW1lc3RhbXBzXSxcbiAgICAgICAgICAgIFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9TdGFibGVQYXJ0aWFsUmVzdWx0VGhyZXNob2xkLCBRdWVyeVBhcmFtZXRlck5hbWVzLlN0YWJsZUludGVybWVkaWF0ZVRocmVzaG9sZF0sXG4gICAgICAgIF0pO1xuICAgICAgICBwcm9wZXJ0eUlkVG9QYXJhbWV0ZXJNYXAuZm9yRWFjaCgocGFyYW1ldGVyTmFtZSwgcHJvcGVydHlJZCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRVcmxQYXJhbWV0ZXIocHJvcGVydHlJZCwgcGFyYW1ldGVyTmFtZSwgY29uZmlnLCBxdWVyeVBhcmFtcywgZW5kcG9pbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2VydmljZVByb3BlcnRpZXMgPSBKU09OLnBhcnNlKGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCBcInt9XCIpKTtcbiAgICAgICAgT2JqZWN0LmtleXMoc2VydmljZVByb3BlcnRpZXMpLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1t2YWx1ZV0gPSBzZXJ2aWNlUHJvcGVydGllc1t2YWx1ZV07XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXRVcmxQYXJhbWV0ZXIocHJvcElkLCBwYXJhbWV0ZXJOYW1lLCBjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludCkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KHByb3BJZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgLy8gRklYTUU6IFRoZSAuc2VhcmNoKCkgY2hlY2sgd2lsbCBpbmNvcnJlY3RseSBtYXRjaCBwYXJhbWV0ZXIgbmFtZSBhbnl3aGVyZSBpbiB0aGUgc3RyaW5nXG4gICAgICAgIC8vICAgICAgICBpbmNsdWRpbmcgZS5nLiB0aGUgcGF0aCBwb3J0aW9uLCBvciBldmVuIGFzIGEgc3Vic3RyaW5nIG9mIG90aGVyIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICAgICAgaWYgKHZhbHVlICYmICghZW5kcG9pbnQgfHwgZW5kcG9pbnQuc2VhcmNoKHBhcmFtZXRlck5hbWUpID09PSAtMSkpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW3BhcmFtZXRlck5hbWVdID0gdmFsdWUudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbkZhY3RvcnlCYXNlLmpzLm1hcFxuIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBPdXRwdXRGb3JtYXQsIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgUmVzdWx0UmVhc29uLCBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRGV0YWlsZWRTcGVlY2hQaHJhc2UsIEVudW1UcmFuc2xhdGlvbiwgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBSZWNvZ25pdGlvblN0YXR1cywgU2VydmljZVJlY29nbml6ZXJCYXNlLCBTaW1wbGVTcGVlY2hQaHJhc2UsIFNwZWVjaEh5cG90aGVzaXMgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXIgZXh0ZW5kcyBTZXJ2aWNlUmVjb2duaXplckJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpIHtcbiAgICAgICAgc3VwZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgcmVjb2duaXplcik7XG4gICAgICAgIHRoaXMuaGFuZGxlU3BlZWNoUGhyYXNlTWVzc2FnZSA9ICh0ZXh0Qm9keSkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgeyByZXR1cm4gdGhpcy5oYW5kbGVTcGVlY2hQaHJhc2UodGV4dEJvZHkpOyB9KTtcbiAgICAgICAgdGhpcy5oYW5kbGVTcGVlY2hIeXBvdGhlc2lzTWVzc2FnZSA9ICh0ZXh0Qm9keSkgPT4gdGhpcy5oYW5kbGVTcGVlY2hIeXBvdGhlc2lzKHRleHRCb2R5KTtcbiAgICB9XG4gICAgcHJvY2Vzc1R5cGVTcGVjaWZpY01lc3NhZ2VzKGNvbm5lY3Rpb25NZXNzYWdlKSB7XG4gICAgICAgIHZvaWQgY29ubmVjdGlvbk1lc3NhZ2U7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaGFuZGxlUmVjb2duaXplZENhbGxiYWNrKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgdm9pZCByZXN1bHQ7XG4gICAgICAgIHZvaWQgb2Zmc2V0O1xuICAgICAgICB2b2lkIHNlc3Npb25JZDtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBoYW5kbGVSZWNvZ25pemluZ0NhbGxiYWNrKHJlc3VsdCwgZHVyYXRpb24sIHNlc3Npb25JZCkge1xuICAgICAgICB2b2lkIHJlc3VsdDtcbiAgICAgICAgdm9pZCBkdXJhdGlvbjtcbiAgICAgICAgdm9pZCBzZXNzaW9uSWQ7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcHJvY2Vzc1NwZWVjaE1lc3NhZ2VzKGNvbm5lY3Rpb25NZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBsZXQgcHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzcGVlY2guaHlwb3RoZXNpc1wiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJzcGVlY2guZnJhZ21lbnRcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5oYW5kbGVTcGVlY2hIeXBvdGhlc2lzTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTcGVlY2hIeXBvdGhlc2lzTWVzc2FnZShjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5waHJhc2VcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5oYW5kbGVTcGVlY2hQaHJhc2VNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmhhbmRsZVNwZWVjaFBocmFzZU1lc3NhZ2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NlZDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgLy8gSW1wbGVtZW50aW5nIHRvIGFsbG93IGluaGVyaXRhbmNlXG4gICAgICAgIHZvaWQgc2Vzc2lvbklkO1xuICAgICAgICB2b2lkIHJlcXVlc3RJZDtcbiAgICAgICAgdm9pZCBjYW5jZWxsYXRpb25SZWFzb247XG4gICAgICAgIHZvaWQgZXJyb3JDb2RlO1xuICAgICAgICB2b2lkIGVycm9yO1xuICAgIH1cbiAgICBoYW5kbGVTcGVlY2hQaHJhc2UodGV4dEJvZHkpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNpbXBsZSA9IFNpbXBsZVNwZWVjaFBocmFzZS5mcm9tSlNPTih0ZXh0Qm9keSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHRSZWFzb24gPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZVJlY29nbml0aW9uUmVzdWx0KHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0UHJvcHMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICByZXN1bHRQcm9wcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0LCB0ZXh0Qm9keSk7XG4gICAgICAgICAgICBjb25zdCBzaW1wbGVPZmZzZXQgPSBzaW1wbGUuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldDtcbiAgICAgICAgICAgIGxldCBvZmZzZXQgPSBzaW1wbGVPZmZzZXQ7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblBocmFzZVJlY29nbml6ZWQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCArIHNpbXBsZS5PZmZzZXQgKyBzaW1wbGUuRHVyYXRpb24pO1xuICAgICAgICAgICAgaWYgKFJlc3VsdFJlYXNvbi5DYW5jZWxlZCA9PT0gcmVzdWx0UmVhc29uKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FuY2VsUmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVDYW5jZWxSZXN1bHQoc2ltcGxlLlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxsYXRpb25FcnJvckNvZGUgPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZUNhbmNlbEVycm9yQ29kZShzaW1wbGUuUmVjb2duaXRpb25TdGF0dXMpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb25Mb2NhbChjYW5jZWxSZWFzb24sIGNhbmNlbGxhdGlvbkVycm9yQ29kZSwgRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVFcnJvckRldGFpbHMoY2FuY2VsbGF0aW9uRXJyb3JDb2RlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1NwZWVjaEVuZGVkICYmIHJlc3VsdFJlYXNvbiA9PT0gUmVzdWx0UmVhc29uLk5vTWF0Y2ggJiYgc2ltcGxlLlJlY29nbml0aW9uU3RhdHVzICE9PSBSZWNvZ25pdGlvblN0YXR1cy5Jbml0aWFsU2lsZW5jZVRpbWVvdXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lKSA9PT0gT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCByZXN1bHRSZWFzb24sIHNpbXBsZS5EaXNwbGF5VGV4dCwgc2ltcGxlLkR1cmF0aW9uLCBzaW1wbGVPZmZzZXQsIHNpbXBsZS5MYW5ndWFnZSwgc2ltcGxlLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgc2ltcGxlLlNwZWFrZXJJZCwgdW5kZWZpbmVkLCB0ZXh0Qm9keSwgcmVzdWx0UHJvcHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGV0YWlsZWQgPSBEZXRhaWxlZFNwZWVjaFBocmFzZS5mcm9tSlNPTih0ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b3RhbE9mZnNldCA9IGRldGFpbGVkLk9mZnNldCArIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXRDb3JyZWN0ZWRKc29uID0gZGV0YWlsZWQuZ2V0SnNvbldpdGhDb3JyZWN0ZWRPZmZzZXRzKHRvdGFsT2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIHJlc3VsdFJlYXNvbiwgZGV0YWlsZWQuVGV4dCwgZGV0YWlsZWQuRHVyYXRpb24sIHRvdGFsT2Zmc2V0LCBkZXRhaWxlZC5MYW5ndWFnZSwgZGV0YWlsZWQuTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCBkZXRhaWxlZC5TcGVha2VySWQsIHVuZGVmaW5lZCwgb2Zmc2V0Q29ycmVjdGVkSnNvbiwgcmVzdWx0UHJvcHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gcmVzdWx0Lm9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVJlY29nbml6ZWRDYWxsYmFjayhyZXN1bHQsIG9mZnNldCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBoYW5kbGVTcGVlY2hIeXBvdGhlc2lzKHRleHRCb2R5KSB7XG4gICAgICAgIGNvbnN0IGh5cG90aGVzaXMgPSBTcGVlY2hIeXBvdGhlc2lzLmZyb21KU09OKHRleHRCb2R5KTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gaHlwb3RoZXNpcy5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICBjb25zdCByZXN1bHRQcm9wcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgcmVzdWx0UHJvcHMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgdGV4dEJvZHkpO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBSZXN1bHRSZWFzb24uUmVjb2duaXppbmdTcGVlY2gsIGh5cG90aGVzaXMuVGV4dCwgaHlwb3RoZXNpcy5EdXJhdGlvbiwgb2Zmc2V0LCBoeXBvdGhlc2lzLkxhbmd1YWdlLCBoeXBvdGhlc2lzLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgaHlwb3RoZXNpcy5TcGVha2VySWQsIHVuZGVmaW5lZCwgdGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25IeXBvdGhlc2lzKG9mZnNldCk7XG4gICAgICAgIHRoaXMuaGFuZGxlUmVjb2duaXppbmdDYWxsYmFjayhyZXN1bHQsIGh5cG90aGVzaXMuRHVyYXRpb24sIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25TZXJ2aWNlUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IFByb3h5SW5mbywgV2Vic29ja2V0Q29ubmVjdGlvbiwgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRGlhbG9nU2VydmljZUNvbmZpZywgT3V0cHV0Rm9ybWF0LCBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBRdWVyeVBhcmFtZXRlck5hbWVzIH0gZnJvbSBcIi4vUXVlcnlQYXJhbWV0ZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIERpYWxvZ0Nvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIGNvbnN0IGFwcGxpY2F0aW9uSWQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkLCBcIlwiKTtcbiAgICAgICAgY29uc3QgZGlhbG9nVHlwZSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGUpO1xuICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbik7XG4gICAgICAgIGNvbnN0IGxhbmd1YWdlID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UsIFwiZW4tVVNcIik7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RUdXJuU3RhdHVzID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fUmVxdWVzdF9Cb3RfU3RhdHVzX01lc3NhZ2VzLCBcInRydWVcIik7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAgIHF1ZXJ5UGFyYW1zW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIHF1ZXJ5UGFyYW1zW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuRm9ybWF0XSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkxhbmd1YWdlXSA9IGxhbmd1YWdlO1xuICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLlJlcXVlc3RCb3RTdGF0dXNNZXNzYWdlc10gPSByZXF1ZXN0VHVyblN0YXR1cztcbiAgICAgICAgaWYgKGFwcGxpY2F0aW9uSWQpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuQm90SWRdID0gYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgIGlmIChkaWFsb2dUeXBlID09PSBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkN1c3RvbUNvbW1hbmRzKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXNbSGVhZGVyTmFtZXMuQ3VzdG9tQ29tbWFuZHNBcHBJZF0gPSBhcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc291cmNlSW5maXggPSBkaWFsb2dUeXBlID09PSBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkN1c3RvbUNvbW1hbmRzID8gXCJjb21tYW5kcy9cIlxuICAgICAgICAgICAgOiBcIlwiO1xuICAgICAgICBjb25zdCB2ZXJzaW9uID0gZGlhbG9nVHlwZSA9PT0gRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5DdXN0b21Db21tYW5kcyA/IFwidjFcIlxuICAgICAgICAgICAgOiBkaWFsb2dUeXBlID09PSBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkJvdEZyYW1ld29yayA/IFwidjNcIlxuICAgICAgICAgICAgICAgIDogXCJ2MFwiO1xuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGlmIChhdXRoSW5mby50b2tlbiAhPSBudWxsICYmIGF1dGhJbmZvLnRva2VuICE9PSBcIlwiKSB7XG4gICAgICAgICAgICBoZWFkZXJzW2F1dGhJbmZvLmhlYWRlck5hbWVdID0gYXV0aEluZm8udG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIFVSTCB1c2VkIGZvciBjb25uZWN0aW9uIGlzIGNob3NlbiBpbiBhIHByaW9yaXR5IG9yZGVyIG9mIHNwZWNpZmljYXRpb246XG4gICAgICAgIC8vICAxLiBJZiBhIGN1c3RvbSBlbmRwb2ludCBpcyBwcm92aWRlZCwgdGhhdCBVUkwgaXMgdXNlZCB2ZXJiYXRpbS5cbiAgICAgICAgLy8gIDIuIElmIGEgY3VzdG9tIGhvc3QgaXMgcHJvdmlkZWQgKGUuZy4gXCJ3c3M6Ly9teS5jdXN0b20uZW5kcG9pbnQuY29tOjExMjNcIiksIGEgVVJMIGlzIGNvbnN0cnVjdGVkIGZyb20gaXQuXG4gICAgICAgIC8vICAzLiBJZiBubyBjdXN0b20gY29ubmVjdGlvbiBkZXRhaWxzIGFyZSBwcm92aWRlZCwgYSBVUkwgaXMgY29uc3RydWN0ZWQgZnJvbSBkZWZhdWx0IHZhbHVlcy5cbiAgICAgICAgbGV0IGVuZHBvaW50ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCwgXCJcIik7XG4gICAgICAgIGlmICghZW5kcG9pbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGhvc3RTdWZmaXggPSBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pO1xuICAgICAgICAgICAgY29uc3QgaG9zdCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdCwgYHdzczovLyR7cmVnaW9ufS4ke0RpYWxvZ0Nvbm5lY3Rpb25GYWN0b3J5LkJhc2VVcmx9JHtob3N0U3VmZml4fWApO1xuICAgICAgICAgICAgY29uc3Qgc3RhbmRhcmRpemVkSG9zdCA9IGhvc3QuZW5kc1dpdGgoXCIvXCIpID8gaG9zdCA6IGhvc3QgKyBcIi9cIjtcbiAgICAgICAgICAgIGVuZHBvaW50ID0gYCR7c3RhbmRhcmRpemVkSG9zdH0ke3Jlc291cmNlSW5maXh9JHtEaWFsb2dDb25uZWN0aW9uRmFjdG9yeS5BcGlLZXl9LyR7dmVyc2lvbn1gO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0Q29tbW9uVXJsUGFyYW1zKGNvbmZpZywgcXVlcnlQYXJhbXMsIGVuZHBvaW50KTtcbiAgICAgICAgY29uc3QgZW5hYmxlQ29tcHJlc3Npb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1FbmFibGVXZWJzb2NrZXRDb21wcmVzc2lvblwiLCBcImZhbHNlXCIpID09PSBcInRydWVcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJzb2NrZXRDb25uZWN0aW9uKGVuZHBvaW50LCBxdWVyeVBhcmFtcywgaGVhZGVycywgbmV3IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIoKSwgUHJveHlJbmZvLmZyb21SZWNvZ25pemVyQ29uZmlnKGNvbmZpZyksIGVuYWJsZUNvbXByZXNzaW9uLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cbkRpYWxvZ0Nvbm5lY3Rpb25GYWN0b3J5LkFwaUtleSA9IFwiYXBpXCI7XG5EaWFsb2dDb25uZWN0aW9uRmFjdG9yeS5CYXNlVXJsID0gXCJjb252YWkuc3BlZWNoXCI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWxvZ0Nvbm5lY3RvckZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgUmVwbGF5YWJsZUF1ZGlvTm9kZSB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBTZW5kaW5nQWdlbnRDb250ZXh0TWVzc2FnZUV2ZW50IH0gZnJvbSBcIi4uL2NvbW1vbi9EaWFsb2dFdmVudHNcIjtcbmltcG9ydCB7IEJhY2tncm91bmRFdmVudCwgY3JlYXRlR3VpZCwgY3JlYXRlTm9EYXNoR3VpZCwgRGVmZXJyZWQsIEV2ZW50cywgRXZlbnRTb3VyY2UsIE1lc3NhZ2VUeXBlLCBTZXJ2aWNlRXZlbnQsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb091dHB1dEZvcm1hdEltcGwgfSBmcm9tIFwiLi4vc2RrL0F1ZGlvL0F1ZGlvT3V0cHV0Rm9ybWF0XCI7XG5pbXBvcnQgeyBBY3Rpdml0eVJlY2VpdmVkRXZlbnRBcmdzLCBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgRGlhbG9nU2VydmljZUNvbmZpZywgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZWNvZ25pdGlvbkV2ZW50QXJncywgUmVzdWx0UmVhc29uLCBTZXNzaW9uRXZlbnRBcmdzLCBTcGVlY2hSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLCBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncywgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQsIFR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJncywgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IERpYWxvZ1NlcnZpY2VUdXJuU3RhdGVNYW5hZ2VyIH0gZnJvbSBcIi4vRGlhbG9nU2VydmljZVR1cm5TdGF0ZU1hbmFnZXJcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgRW51bVRyYW5zbGF0aW9uLCBSZWNvZ25pdGlvblN0YXR1cywgU2VydmljZVJlY29nbml6ZXJCYXNlLCBTaW1wbGVTcGVlY2hQaHJhc2UsIFNwZWVjaERldGVjdGVkLCBTcGVlY2hIeXBvdGhlc2lzLCBTcGVlY2hLZXl3b3JkLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IEFjdGl2aXR5UGF5bG9hZFJlc3BvbnNlIH0gZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL0FjdGl2aXR5UmVzcG9uc2VQYXlsb2FkXCI7XG5pbXBvcnQgeyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuL1NwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsXCI7XG5leHBvcnQgY2xhc3MgRGlhbG9nU2VydmljZUFkYXB0ZXIgZXh0ZW5kcyBTZXJ2aWNlUmVjb2duaXplckJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIGRpYWxvZ1NlcnZpY2VDb25uZWN0b3IpIHtcbiAgICAgICAgc3VwZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgZGlhbG9nU2VydmljZUNvbm5lY3Rvcik7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50cyA9IG5ldyBFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yID0gZGlhbG9nU2VydmljZUNvbm5lY3RvcjtcbiAgICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZU92ZXJyaWRlID0gKCkgPT4gdGhpcy5yZWNlaXZlRGlhbG9nTWVzc2FnZU92ZXJyaWRlKCk7XG4gICAgICAgIHRoaXMucHJpdlR1cm5TdGF0ZU1hbmFnZXIgPSBuZXcgRGlhbG9nU2VydmljZVR1cm5TdGF0ZU1hbmFnZXIoKTtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVPdmVycmlkZSA9XG4gICAgICAgICAgICAocmVjb01vZGUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgPT4gdGhpcy5saXN0ZW5PbmNlKHJlY29Nb2RlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spO1xuICAgICAgICB0aGlzLnBvc3RDb25uZWN0SW1wbE92ZXJyaWRlID0gKGNvbm5lY3Rpb24pID0+IHRoaXMuZGlhbG9nQ29ubmVjdEltcGwoY29ubmVjdGlvbik7XG4gICAgICAgIHRoaXMuY29uZmlnQ29ubmVjdGlvbk92ZXJyaWRlID0gKGNvbm5lY3Rpb24pID0+IHRoaXMuY29uZmlnQ29ubmVjdGlvbihjb25uZWN0aW9uKTtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0T3ZlcnJpZGUgPSAoKSA9PiB0aGlzLnByaXZEaXNjb25uZWN0KCk7XG4gICAgICAgIHRoaXMucHJpdkRpYWxvZ0F1ZGlvU291cmNlID0gYXVkaW9Tb3VyY2U7XG4gICAgICAgIHRoaXMuYWdlbnRDb25maWdTZW50ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkxhc3RSZXN1bHQgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbm5lY3Rpb25FdmVudHMuYXR0YWNoKChjb25uZWN0aW9uRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uRXZlbnQubmFtZSA9PT0gXCJDb25uZWN0aW9uQ2xvc2VkRXZlbnRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3AgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZE1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25HdWlkID0gY3JlYXRlR3VpZCgpO1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICAgICAgY29uc3QgYWdlbnRNZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25JZDogaW50ZXJhY3Rpb25HdWlkXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XG4gICAgICAgICAgICAgICAgbWVzc2FnZVBheWxvYWQ6IEpTT04ucGFyc2UobWVzc2FnZSksXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogMC41XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgYWdlbnRNZXNzYWdlSnNvbiA9IEpTT04uc3RyaW5naWZ5KGFnZW50TWVzc2FnZSk7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHlpZWxkIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJhZ2VudFwiLCByZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvblwiLCBhZ2VudE1lc3NhZ2VKc29uKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwcml2RGlzY29ubmVjdCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsUmVjb2duaXRpb24odGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3IsIFwiRGlzY29ubmVjdGluZ1wiKTtcbiAgICAgICAgICAgIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3AgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5hZ2VudENvbmZpZ1NlbnQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICBjb25zdCByZXN1bHRQcm9wcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgaWYgKGNvbm5lY3Rpb25NZXNzYWdlLm1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0KSB7XG4gICAgICAgICAgICByZXN1bHRQcm9wcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0LCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgbGV0IHByb2Nlc3NlZDtcbiAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJzcGVlY2gucGhyYXNlXCI6XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoUGhyYXNlID0gU2ltcGxlU3BlZWNoUGhyYXNlLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblBocmFzZVJlY29nbml6ZWQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCArIHNwZWVjaFBocmFzZS5PZmZzZXQgKyBzcGVlY2hQaHJhc2UuRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIGlmIChzcGVlY2hQaHJhc2UuUmVjb2duaXRpb25TdGF0dXMgIT09IFJlY29nbml0aW9uU3RhdHVzLlRvb01hbnlSZXF1ZXN0cyAmJiBzcGVlY2hQaHJhc2UuUmVjb2duaXRpb25TdGF0dXMgIT09IFJlY29nbml0aW9uU3RhdHVzLkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSB0aGlzLmZpcmVFdmVudEZvclJlc3VsdChzcGVlY2hQaHJhc2UsIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGFzdFJlc3VsdCA9IGFyZ3MucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnJlY29nbml6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5yZWNvZ25pemVkKHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3BlZWNoLmh5cG90aGVzaXNcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBoeXBvdGhlc2lzID0gU3BlZWNoSHlwb3RoZXNpcy5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gaHlwb3RoZXNpcy5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFJlc3VsdFJlYXNvbi5SZWNvZ25pemluZ1NwZWVjaCwgaHlwb3RoZXNpcy5UZXh0LCBoeXBvdGhlc2lzLkR1cmF0aW9uLCBvZmZzZXQsIGh5cG90aGVzaXMuTGFuZ3VhZ2UsIGh5cG90aGVzaXMuTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vbkh5cG90aGVzaXMob2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBldiA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIGh5cG90aGVzaXMuRHVyYXRpb24sIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5yZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5yZWNvZ25pemluZyh0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLCBldik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3BlZWNoLmtleXdvcmRcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBrZXl3b3JkID0gU3BlZWNoS2V5d29yZC5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwga2V5d29yZC5TdGF0dXMgPT09IFwiQWNjZXB0ZWRcIiA/IFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkS2V5d29yZCA6IFJlc3VsdFJlYXNvbi5Ob01hdGNoLCBrZXl3b3JkLlRleHQsIGtleXdvcmQuRHVyYXRpb24sIGtleXdvcmQuT2Zmc2V0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgaWYgKGtleXdvcmQuU3RhdHVzICE9PSBcIkFjY2VwdGVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGFzdFJlc3VsdCA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCByZXN1bHQuZHVyYXRpb24sIHJlc3VsdC5yZXN1bHRJZCk7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5yZWNvZ25pemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnJlY29nbml6ZWQodGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3RvciwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvXCI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdWRpb1JlcXVlc3RJZCA9IGNvbm5lY3Rpb25NZXNzYWdlLnJlcXVlc3RJZC50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0dXJuID0gdGhpcy5wcml2VHVyblN0YXRlTWFuYWdlci5HZXRUdXJuKGF1ZGlvUmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVtcHR5IGJpbmFyeSBtZXNzYWdlIHNpZ25hbHMgZW5kIG9mIHN0cmVhbS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29ubmVjdGlvbk1lc3NhZ2UuYmluYXJ5Qm9keSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR1cm4uZW5kQXVkaW9TdHJlYW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR1cm4uYXVkaW9TdHJlYW0ud3JpdGUoY29ubmVjdGlvbk1lc3NhZ2UuYmluYXJ5Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyZXNwb25zZVwiOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVSZXNwb25zZU1lc3NhZ2UoY29ubmVjdGlvbk1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkZWZmZXJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBkZWZmZXJhbC5yZXNvbHZlKHByb2Nlc3NlZCk7XG4gICAgICAgIHJldHVybiBkZWZmZXJhbC5wcm9taXNlO1xuICAgIH1cbiAgICAvLyBDYW5jZWxzIHJlY29nbml0aW9uLlxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3AgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3RvcFJlY29nbml6aW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2Vycm9yQ29kZV0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbmNlbEV2ZW50ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MoY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvciwgZXJyb3JDb2RlLCB1bmRlZmluZWQsIHNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5jYW5jZWxlZCh0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCh1bmRlZmluZWQsIC8vIFJlc3VsdElkXG4gICAgICAgICAgICAgICAgICAgIFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgdW5kZWZpbmVkLCAvLyBUZXh0XG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gRHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBPZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZVxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsIC8vIExhbmd1YWdlIERldGVjdGlvbiBDb25maWRlbmNlXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gU3BlYWtlciBJZFxuICAgICAgICAgICAgICAgICAgICBlcnJvciwgdW5kZWZpbmVkLCAvLyBKc29uXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChfYikgeyB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgbGlzdGVuT25jZShyZWNvTW9kZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnJlY29nbml0aW9uTW9kZSA9IHJlY29Nb2RlO1xuICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrID0gc3VjY2Vzc0NhbGxiYWNrO1xuICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IGVycm9yQ2FsbGJhY2s7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zdGFydE5ld1JlY29nbml0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5saXN0ZW5Gb3JTZXJ2aWNlVGVsZW1ldHJ5KHRoaXMucHJpdkRpYWxvZ0F1ZGlvU291cmNlLmV2ZW50cyk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hfU2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZpY2UuIFRoZSBwcm9taXNlIHRoaXMgd2lsbCBjcmVhdGUgaXMgc3RvcmVkIGFuZCB3aWxsIGJlIHVzZWQgYnkgY29uZmlndXJlQ29ubmVjdGlvbigpLlxuICAgICAgICAgICAgY29uc3QgY29uUHJvbWlzZSA9IHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIGNvbnN0IHByZUF1ZGlvUHJvbWlzZSA9IHRoaXMuc2VuZFByZUF1ZGlvTWVzc2FnZXMoKTtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSB5aWVsZCB0aGlzLnByaXZEaWFsb2dBdWRpb1NvdXJjZS5hdHRhY2godGhpcy5wcml2UmVxdWVzdFNlc3Npb24uYXVkaW9Ob2RlSWQpO1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0geWllbGQgdGhpcy5wcml2RGlhbG9nQXVkaW9Tb3VyY2UuZm9ybWF0O1xuICAgICAgICAgICAgY29uc3QgZGV2aWNlSW5mbyA9IHlpZWxkIHRoaXMucHJpdkRpYWxvZ0F1ZGlvU291cmNlLmRldmljZUluZm87XG4gICAgICAgICAgICBjb25zdCBhdWRpb05vZGUgPSBuZXcgUmVwbGF5YWJsZUF1ZGlvTm9kZShub2RlLCBmb3JtYXQuYXZnQnl0ZXNQZXJTZWMpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25BdWRpb1NvdXJjZUF0dGFjaENvbXBsZXRlZChhdWRpb05vZGUsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcuU3BlZWNoU2VydmljZUNvbmZpZy5Db250ZXh0LmF1ZGlvID0geyBzb3VyY2U6IGRldmljZUluZm8gfTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeWllbGQgY29uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCBwcmVBdWRpb1Byb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25TdGFydEV2ZW50QXJncyA9IG5ldyBTZXNzaW9uRXZlbnRBcmdzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RhcnRlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzZXNzaW9uU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgYXVkaW9TZW5kUHJvbWlzZSA9IHRoaXMuc2VuZEF1ZGlvKGF1ZGlvTm9kZSk7XG4gICAgICAgICAgICAvLyAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgYXVkaW9TZW5kUHJvbWlzZS50aGVuKCgpID0+IHsgfSwgKGVycm9yKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuUnVudGltZUVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBFc3RhYmxpc2hlcyBhIHdlYnNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBlbmQgcG9pbnQuXG4gICAgZGlhbG9nQ29ubmVjdEltcGwoY29ubmVjdGlvbikge1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uTG9vcCA9IHRoaXMuc3RhcnRNZXNzYWdlTG9vcCgpO1xuICAgICAgICByZXR1cm4gY29ubmVjdGlvbjtcbiAgICB9XG4gICAgcmVjZWl2ZURpYWxvZ01lc3NhZ2VPdmVycmlkZSgpIHtcbiAgICAgICAgLy8gd2Ugd29uJ3QgcmVseSBvbiB0aGUgY2FzY2FkaW5nIHByb21pc2VzIG9mIHRoZSBjb25uZWN0aW9uIHNpbmNlIHdlIHdhbnQgdG8gY29udGludWFsbHkgYmUgYXZhaWxhYmxlIHRvIHJlY2VpdmUgbWVzc2FnZXNcbiAgICAgICAgY29uc3QgY29tbXVuaWNhdGlvbkN1c3RvZGlhbiA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBjb25zdCBsb29wID0gKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc0Rpc3Bvc2VkID0gdGhpcy5pc0Rpc3Bvc2VkKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgdGVybWluYXRlTWVzc2FnZUxvb3AgPSAoIXRoaXMuaXNEaXNwb3NlZCgpICYmIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3ApO1xuICAgICAgICAgICAgICAgIGlmIChpc0Rpc3Bvc2VkIHx8IHRlcm1pbmF0ZU1lc3NhZ2VMb29wKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlJ3JlIGRvbmUuXG4gICAgICAgICAgICAgICAgICAgIGNvbW11bmljYXRpb25DdXN0b2RpYW4ucmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB5aWVsZCBjb25uZWN0aW9uLnJlYWQoKTtcbiAgICAgICAgICAgICAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvb3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbk1lc3NhZ2UgPSBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZS5mcm9tQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInR1cm4uc3RhcnRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0dXJuUmVxdWVzdElkID0gY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW9TZXNzaW9uUmVxSWQgPSB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0dXJuIHN0YXJ0ZWQgYnkgdGhlIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHVyblJlcXVlc3RJZCAhPT0gYXVkaW9TZXNzaW9uUmVxSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2VHVyblN0YXRlTWFuYWdlci5TdGFydFR1cm4odHVyblJlcXVlc3RJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNlcnZpY2VUdXJuU3RhcnRSZXNwb25zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLnN0YXJ0ZGV0ZWN0ZWRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0YXJ0RGV0ZWN0ZWQgPSBTcGVlY2hEZXRlY3RlZC5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hTdGFydEV2ZW50QXJncyA9IG5ldyBSZWNvZ25pdGlvbkV2ZW50QXJncyhzcGVlY2hTdGFydERldGVjdGVkLk9mZnNldCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIuc3BlZWNoU3RhcnREZXRlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc3BlZWNoU3RhcnREZXRlY3RlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzcGVlY2hTdGFydEV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5lbmRkZXRlY3RlZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGpzb247XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSByZXF1ZXN0IHdhcyBlbXB0eSwgdGhlIEpTT04gcmV0dXJuZWQgaXMgZW1wdHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbiA9IFwieyBPZmZzZXQ6IDAgfVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoU3RvcERldGVjdGVkID0gU3BlZWNoRGV0ZWN0ZWQuZnJvbUpTT04oanNvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNlcnZpY2VSZWNvZ25pemVkKHNwZWVjaFN0b3BEZXRlY3RlZC5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0b3BFdmVudEFyZ3MgPSBuZXcgUmVjb2duaXRpb25FdmVudEFyZ3Moc3BlZWNoU3RvcERldGVjdGVkLk9mZnNldCArIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNwZWVjaEVuZERldGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zcGVlY2hFbmREZXRlY3RlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzcGVlY2hTdG9wRXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidHVybi5lbmRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0dXJuRW5kUmVxdWVzdElkID0gY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW9TZXNzaW9uUmVxSWQgPSB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0dXJuIHN0YXJ0ZWQgYnkgdGhlIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHVybkVuZFJlcXVlc3RJZCAhPT0gYXVkaW9TZXNzaW9uUmVxSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2VHVyblN0YXRlTWFuYWdlci5Db21wbGV0ZVR1cm4odHVybkVuZFJlcXVlc3RJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBdWRpbyBzZXNzaW9uIHR1cm5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2Vzc2lvblN0b3BFdmVudEFyZ3MgPSBuZXcgU2Vzc2lvbkV2ZW50QXJncyh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdlJlY29nbml6ZXJDb25maWcuaXNDb250aW51b3VzUmVjb2duaXRpb24gfHwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNTcGVlY2hFbmRlZCB8fCAhdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0b3BwZWQodGhpcy5wcml2UmVjb2duaXplciwgc2Vzc2lvblN0b3BFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcG9ydCByZXN1bHQgdG8gcHJvbWlzZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrICYmIHRoaXMucHJpdkxhc3RSZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKHRoaXMucHJpdkxhc3RSZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RSZXN1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZFcnJvckNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2soZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBpbnZva2UgdGhlIGNhbGwgYmFjayBvbmNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGlmIGl0J3Mgc3VjY2Vzc2Z1bCBkb24ndCBpbnZva2UgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlcnJvciBhZnRlciB0aGF0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9jZXNzZWQgPSB5aWVsZCB0aGlzLnByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9jZXNzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5zZXJ2aWNlRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2VFdmVudHMub25FdmVudChuZXcgU2VydmljZUV2ZW50KGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgcmV0ID0gbG9vcCgpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb21tdW5pY2F0aW9uQ3VzdG9kaWFuLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGxvb3AoKS5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChuZXcgQmFja2dyb3VuZEV2ZW50KHJlYXNvbikpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbW11bmljYXRpb25DdXN0b2RpYW4ucHJvbWlzZTtcbiAgICB9XG4gICAgc3RhcnRNZXNzYWdlTG9vcCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3AgPSBmYWxzZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5yZWNlaXZlRGlhbG9nTWVzc2FnZU92ZXJyaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5SdW50aW1lRXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFRha2VzIGFuIGVzdGFibGlzaGVkIHdlYnNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBlbmRwb2ludCBhbmQgc2VuZHMgc3BlZWNoIGNvbmZpZ3VyYXRpb24gaW5mb3JtYXRpb24uXG4gICAgY29uZmlnQ29ubmVjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50ZXJtaW5hdGVNZXNzYWdlTG9vcCkge1xuICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3AgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoXCJDb25uZWN0aW9uIHRvIHNlcnZpY2UgdGVybWluYXRlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTcGVlY2hTZXJ2aWNlQ29uZmlnKGNvbm5lY3Rpb24sIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLCB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLlNwZWVjaFNlcnZpY2VDb25maWcuc2VyaWFsaXplKCkpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kQWdlbnRDb25maWcoY29ubmVjdGlvbik7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRQcmVBdWRpb01lc3NhZ2VzKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmFkZEtleXdvcmRDb250ZXh0RGF0YSgpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3BlZWNoQ29udGV4dChjb25uZWN0aW9uLCB0cnVlKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZEFnZW50Q29udGV4dChjb25uZWN0aW9uKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFdhdmVIZWFkZXIoY29ubmVjdGlvbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kQWdlbnRDb25maWcoY29ubmVjdGlvbikge1xuICAgICAgICBpZiAodGhpcy5hZ2VudENvbmZpZyAmJiAhdGhpcy5hZ2VudENvbmZpZ1NlbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnXG4gICAgICAgICAgICAgICAgLnBhcmFtZXRlcnNcbiAgICAgICAgICAgICAgICAuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZSkgPT09IERpYWxvZ1NlcnZpY2VDb25maWcuRGlhbG9nVHlwZXMuQ3VzdG9tQ29tbWFuZHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSB0aGlzLmFnZW50Q29uZmlnLmdldCgpO1xuICAgICAgICAgICAgICAgIGNvbmZpZy5ib3RJbmZvLmNvbW1hbmRzQ3VsdHVyZSA9IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgXCJlbi11c1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFnZW50Q29uZmlnLnNldChjb25maWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBTZW5kaW5nQWdlbnRDb250ZXh0TWVzc2FnZUV2ZW50KHRoaXMuYWdlbnRDb25maWcpKTtcbiAgICAgICAgICAgIGNvbnN0IGFnZW50Q29uZmlnSnNvbiA9IHRoaXMuYWdlbnRDb25maWcudG9Kc29uU3RyaW5nKCk7XG4gICAgICAgICAgICAvLyBndWFyZCBhZ2FpbnN0IHNlbmRpbmcgdGhpcyBtdWx0aXBsZSB0aW1lcyBvbiBvbmUgY29ubmVjdGlvblxuICAgICAgICAgICAgdGhpcy5hZ2VudENvbmZpZ1NlbnQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJhZ2VudC5jb25maWdcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgYWdlbnRDb25maWdKc29uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZW5kQWdlbnRDb250ZXh0KGNvbm5lY3Rpb24pIHtcbiAgICAgICAgY29uc3QgZ3VpZCA9IGNyZWF0ZUd1aWQoKTtcbiAgICAgICAgY29uc3Qgc3BlZWNoQWN0aXZpdHlUZW1wbGF0ZSA9IHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9TcGVlY2hfQWN0aXZpdHlfVGVtcGxhdGUpO1xuICAgICAgICBjb25zdCBhZ2VudENvbnRleHQgPSB7XG4gICAgICAgICAgICBjaGFubmVsRGF0YTogXCJcIixcbiAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICBpbnRlcmFjdGlvbklkOiBndWlkXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWVzc2FnZVBheWxvYWQ6IHR5cGVvZiBzcGVlY2hBY3Rpdml0eVRlbXBsYXRlID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBzcGVlY2hBY3Rpdml0eVRlbXBsYXRlLFxuICAgICAgICAgICAgdmVyc2lvbjogMC41XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGFnZW50Q29udGV4dEpzb24gPSBKU09OLnN0cmluZ2lmeShhZ2VudENvbnRleHQpO1xuICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInNwZWVjaC5hZ2VudC5jb250ZXh0XCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uXCIsIGFnZW50Q29udGV4dEpzb24pKTtcbiAgICB9XG4gICAgZmlyZUV2ZW50Rm9yUmVzdWx0KHNlcnZpY2VSZXN1bHQsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0UmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVSZWNvZ25pdGlvblJlc3VsdChzZXJ2aWNlUmVzdWx0LlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2VydmljZVJlc3VsdC5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCByZXN1bHRSZWFzb24sIHNlcnZpY2VSZXN1bHQuRGlzcGxheVRleHQsIHNlcnZpY2VSZXN1bHQuRHVyYXRpb24sIG9mZnNldCwgc2VydmljZVJlc3VsdC5MYW5ndWFnZSwgc2VydmljZVJlc3VsdC5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBKU09OLnN0cmluZ2lmeShzZXJ2aWNlUmVzdWx0KSwgcHJvcGVydGllcyk7XG4gICAgICAgIGNvbnN0IGV2ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzKHJlc3VsdCwgb2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICByZXR1cm4gZXY7XG4gICAgfVxuICAgIGhhbmRsZVJlc3BvbnNlTWVzc2FnZShyZXNwb25zZU1lc3NhZ2UpIHtcbiAgICAgICAgLy8gXCJyZXNwb25zZVwiIG1lc3NhZ2VzIGNhbiBjb250YWluIGVpdGhlciBcIm1lc3NhZ2VcIiAoYWN0aXZpdHkpIG9yIFwiTWVzc2FnZVN0YXR1c1wiIGRhdGEuIEZpcmUgdGhlIGFwcHJvcHJpYXRlXG4gICAgICAgIC8vIGV2ZW50IGFjY29yZGluZyB0byB0aGUgbWVzc2FnZSB0eXBlIHRoYXQncyBzcGVjaWZpZWQuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlUGF5bG9hZCA9IEpTT04ucGFyc2UocmVzcG9uc2VNZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgc3dpdGNoIChyZXNwb25zZVBheWxvYWQubWVzc2FnZVR5cGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcIm1lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZVJlcXVlc3RJZCA9IHJlc3BvbnNlTWVzc2FnZS5yZXF1ZXN0SWQudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eVBheWxvYWQgPSBBY3Rpdml0eVBheWxvYWRSZXNwb25zZS5mcm9tSlNPTihyZXNwb25zZU1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHR1cm4gPSB0aGlzLnByaXZUdXJuU3RhdGVNYW5hZ2VyLkdldFR1cm4ocmVzcG9uc2VSZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB0aGUgY29udmVyc2F0aW9uIElkXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2aXR5UGF5bG9hZC5jb252ZXJzYXRpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVBZ2VudENvbmZpZyA9IHRoaXMuYWdlbnRDb25maWcuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUFnZW50Q29uZmlnLmJvdEluZm8uY29udmVyc2F0aW9uSWQgPSBhY3Rpdml0eVBheWxvYWQuY29udmVyc2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWdlbnRDb25maWcuc2V0KHVwZGF0ZUFnZW50Q29uZmlnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgcHVsbEF1ZGlvT3V0cHV0U3RyZWFtID0gdHVybi5wcm9jZXNzQWN0aXZpdHlQYXlsb2FkKGFjdGl2aXR5UGF5bG9hZCwgQXVkaW9PdXRwdXRGb3JtYXRJbXBsLmZyb21TcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcodGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXQsIHVuZGVmaW5lZCkpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3Rpdml0eSA9IG5ldyBBY3Rpdml0eVJlY2VpdmVkRXZlbnRBcmdzKGFjdGl2aXR5UGF5bG9hZC5tZXNzYWdlUGF5bG9hZCwgcHVsbEF1ZGlvT3V0cHV0U3RyZWFtKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLmFjdGl2aXR5UmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IuYWN0aXZpdHlSZWNlaXZlZCh0aGlzLnByaXZEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLCBhY3Rpdml0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJtZXNzYWdlc3RhdHVzXCI6XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RGlhbG9nU2VydmljZUNvbm5lY3Rvci50dXJuU3RhdHVzUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IudHVyblN0YXR1c1JlY2VpdmVkKHRoaXMucHJpdkRpYWxvZ1NlcnZpY2VDb25uZWN0b3IsIG5ldyBUdXJuU3RhdHVzUmVjZWl2ZWRFdmVudEFyZ3MocmVzcG9uc2VNZXNzYWdlLnRleHRCb2R5KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChgVW5leHBlY3RlZCByZXNwb25zZSBvZiB0eXBlICR7cmVzcG9uc2VQYXlsb2FkLm1lc3NhZ2VUeXBlfS4gSWdub3JpbmcuYCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRzLm9uRXZlbnQoZXZlbnQpO1xuICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChldmVudCk7XG4gICAgfVxuICAgIGFkZEtleXdvcmRDb250ZXh0RGF0YSgpIHtcbiAgICAgICAgY29uc3Qga2V5d29yZFByb3BlcnR5VmFsdWUgPSB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtS2V5d29yZHNUb0RldGVjdFwiKTtcbiAgICAgICAgaWYgKGtleXdvcmRQcm9wZXJ0eVZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXl3b3JkT2Zmc2V0UHJvcGVydHlWYWx1ZSA9IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVyc1xuICAgICAgICAgICAgLmdldFByb3BlcnR5KFwiU1BFRUNILUtleXdvcmRzVG9EZXRlY3QtT2Zmc2V0c1wiKTtcbiAgICAgICAgY29uc3Qga2V5d29yZER1cmF0aW9uUHJvcGVydHlWYWx1ZSA9IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVyc1xuICAgICAgICAgICAgLmdldFByb3BlcnR5KFwiU1BFRUNILUtleXdvcmRzVG9EZXRlY3QtRHVyYXRpb25zXCIpO1xuICAgICAgICBjb25zdCBrZXl3b3JkcyA9IGtleXdvcmRQcm9wZXJ0eVZhbHVlLnNwbGl0KFwiO1wiKTtcbiAgICAgICAgY29uc3Qga2V5d29yZE9mZnNldHMgPSBrZXl3b3JkT2Zmc2V0UHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkID8gW10gOiBrZXl3b3JkT2Zmc2V0UHJvcGVydHlWYWx1ZS5zcGxpdChcIjtcIik7XG4gICAgICAgIGNvbnN0IGtleXdvcmREdXJhdGlvbnMgPSBrZXl3b3JkRHVyYXRpb25Qcm9wZXJ0eVZhbHVlID09PSB1bmRlZmluZWQgPyBbXSA6IGtleXdvcmREdXJhdGlvblByb3BlcnR5VmFsdWUuc3BsaXQoXCI7XCIpO1xuICAgICAgICBjb25zdCBrZXl3b3JkRGVmaW5pdGlvbkFycmF5ID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5d29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGRlZmluaXRpb24gPSB7fTtcbiAgICAgICAgICAgIGRlZmluaXRpb24udGV4dCA9IGtleXdvcmRzW2ldO1xuICAgICAgICAgICAgaWYgKGkgPCBrZXl3b3JkT2Zmc2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBkZWZpbml0aW9uLm9mZnNldCA9IE51bWJlcihrZXl3b3JkT2Zmc2V0c1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaSA8IGtleXdvcmREdXJhdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZGVmaW5pdGlvbi5kdXJhdGlvbiA9IE51bWJlcihrZXl3b3JkRHVyYXRpb25zW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleXdvcmREZWZpbml0aW9uQXJyYXkucHVzaChkZWZpbml0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcImludm9jYXRpb25Tb3VyY2VcIiwgXCJWb2ljZUFjdGl2YXRpb25XaXRoS2V5d29yZFwiKTtcbiAgICAgICAgdGhpcy5zcGVlY2hDb250ZXh0LnNldFNlY3Rpb24oXCJrZXl3b3JkRGV0ZWN0aW9uXCIsIFt7XG4gICAgICAgICAgICAgICAgY2xpZW50RGV0ZWN0ZWRLZXl3b3Jkczoga2V5d29yZERlZmluaXRpb25BcnJheSxcbiAgICAgICAgICAgICAgICBvblJlamVjdDogeyBhY3Rpb246IFwiRW5kT2ZUdXJuXCIgfSxcbiAgICAgICAgICAgICAgICB0eXBlOiBcInN0YXJ0VHJpZ2dlclwiXG4gICAgICAgICAgICB9XSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EaWFsb2dTZXJ2aWNlQWRhcHRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQXVkaW9PdXRwdXRGb3JtYXRJbXBsIH0gZnJvbSBcIi4uL3Nkay9BdWRpby9BdWRpb091dHB1dEZvcm1hdFwiO1xuaW1wb3J0IHsgQXVkaW9PdXRwdXRTdHJlYW0gfSBmcm9tIFwiLi4vc2RrL0F1ZGlvL0F1ZGlvT3V0cHV0U3RyZWFtXCI7XG5pbXBvcnQgeyBNZXNzYWdlRGF0YVN0cmVhbVR5cGUgfSBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvQWN0aXZpdHlSZXNwb25zZVBheWxvYWRcIjtcbmV4cG9ydCBjbGFzcyBEaWFsb2dTZXJ2aWNlVHVyblN0YXRlIHtcbiAgICBjb25zdHJ1Y3RvcihtYW5hZ2VyLCByZXF1ZXN0SWQpIHtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICB0aGlzLnByaXZJc0NvbXBsZXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZBdWRpb1N0cmVhbSA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdlR1cm5NYW5hZ2VyID0gbWFuYWdlcjtcbiAgICAgICAgdGhpcy5yZXNldFR1cm5FbmRUaW1lb3V0KCk7XG4gICAgfVxuICAgIGdldCBhdWRpb1N0cmVhbSgpIHtcbiAgICAgICAgLy8gQ2FsbGVkIHdoZW4gaXMgbmVlZGVkIHRvIHN0cmVhbS5cbiAgICAgICAgdGhpcy5yZXNldFR1cm5FbmRUaW1lb3V0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1N0cmVhbTtcbiAgICB9XG4gICAgcHJvY2Vzc0FjdGl2aXR5UGF5bG9hZChwYXlsb2FkLCBhdWRpb0Zvcm1hdCkge1xuICAgICAgICBpZiAocGF5bG9hZC5tZXNzYWdlRGF0YVN0cmVhbVR5cGUgPT09IE1lc3NhZ2VEYXRhU3RyZWFtVHlwZS5UZXh0VG9TcGVlY2hBdWRpbykge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9TdHJlYW0gPSBBdWRpb091dHB1dFN0cmVhbS5jcmVhdGVQdWxsU3RyZWFtKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpb1N0cmVhbS5mb3JtYXQgPSAoYXVkaW9Gb3JtYXQgIT09IHVuZGVmaW5lZCkgPyBhdWRpb0Zvcm1hdCA6IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5nZXREZWZhdWx0T3V0cHV0Rm9ybWF0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU3RyZWFtO1xuICAgIH1cbiAgICBlbmRBdWRpb1N0cmVhbSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkF1ZGlvU3RyZWFtICE9PSBudWxsICYmICF0aGlzLnByaXZBdWRpb1N0cmVhbS5pc0Nsb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9TdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb21wbGV0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdlRpbWVvdXRUb2tlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hcmd1bWVudFxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucHJpdlRpbWVvdXRUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbmRBdWRpb1N0cmVhbSgpO1xuICAgIH1cbiAgICByZXNldFR1cm5FbmRUaW1lb3V0KCkge1xuICAgICAgICBpZiAodGhpcy5wcml2VGltZW91dFRva2VuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5wcml2VGltZW91dFRva2VuKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZUaW1lb3V0VG9rZW4gPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdlR1cm5NYW5hZ2VyLkNvbXBsZXRlVHVybih0aGlzLnByaXZSZXF1ZXN0SWQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9LCAyMDAwKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWxvZ1NlcnZpY2VUdXJuU3RhdGUuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEludmFsaWRPcGVyYXRpb25FcnJvciB9IGZyb20gXCIuLi9jb21tb24vRXJyb3JcIjtcbmltcG9ydCB7IERpYWxvZ1NlcnZpY2VUdXJuU3RhdGUgfSBmcm9tIFwiLi9EaWFsb2dTZXJ2aWNlVHVyblN0YXRlXCI7XG5leHBvcnQgY2xhc3MgRGlhbG9nU2VydmljZVR1cm5TdGF0ZU1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByaXZUdXJuTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFN0YXJ0VHVybihpZCkge1xuICAgICAgICBpZiAodGhpcy5wcml2VHVybk1hcC5oYXMoaWQpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiU2VydmljZSBlcnJvcjogVGhlcmUgaXMgYWxyZWFkeSBhIHR1cm4gd2l0aCBpZDpcIiArIGlkKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0dXJuU3RhdGUgPSBuZXcgRGlhbG9nU2VydmljZVR1cm5TdGF0ZSh0aGlzLCBpZCk7XG4gICAgICAgIHRoaXMucHJpdlR1cm5NYXAuc2V0KGlkLCB0dXJuU3RhdGUpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHVybk1hcC5nZXQoaWQpO1xuICAgIH1cbiAgICBHZXRUdXJuKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUdXJuTWFwLmdldChpZCk7XG4gICAgfVxuICAgIENvbXBsZXRlVHVybihpZCkge1xuICAgICAgICBpZiAoIXRoaXMucHJpdlR1cm5NYXAuaGFzKGlkKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIlNlcnZpY2UgZXJyb3I6IFJlY2VpdmVkIHR1cm4gZW5kIGZvciBhbiB1bmtub3duIHR1cm4gaWQ6XCIgKyBpZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdHVyblN0YXRlID0gdGhpcy5wcml2VHVybk1hcC5nZXQoaWQpO1xuICAgICAgICB0dXJuU3RhdGUuY29tcGxldGUoKTtcbiAgICAgICAgdGhpcy5wcml2VHVybk1hcC5kZWxldGUoaWQpO1xuICAgICAgICByZXR1cm4gdHVyblN0YXRlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RGlhbG9nU2VydmljZVR1cm5TdGF0ZU1hbmFnZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogUmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nIHRoZSBvYmplY3QgdG8gYmUgc2VudCB0byB0aGUgc3BlZWNoIHNlcnZpY2UgdG8gc3VwcG9ydCBkeW5hbWljIGdyYW1tYXJzLlxuICogQGNsYXNzIER5bmFtaWNHcmFtbWFyQnVpbGRlclxuICovXG5leHBvcnQgY2xhc3MgRHluYW1pY0dyYW1tYXJCdWlsZGVyIHtcbiAgICAvLyBBZGRzIG9uZSBtb3JlIHJlZmVyZW5jZSBwaHJhc2VzIHRvIHRoZSBkeW5hbWljIGdyYW1tYXIgdG8gc2VuZC5cbiAgICAvLyBBbGwgYWRkZWQgcGhyYXNlcyBhcmUgZ2VuZXJpYyBwaHJhc2VzLlxuICAgIGFkZFBocmFzZShwaHJhc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZQaHJhc2VzKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZQaHJhc2VzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBocmFzZSBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICB0aGlzLnByaXZQaHJhc2VzID0gdGhpcy5wcml2UGhyYXNlcy5jb25jYXQocGhyYXNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlBocmFzZXMucHVzaChwaHJhc2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIENsZWFycyBhbGwgcGhyYXNlcyBzdG9yZWQgaW4gdGhlIGN1cnJlbnQgb2JqZWN0LlxuICAgIGNsZWFyUGhyYXNlcygpIHtcbiAgICAgICAgdGhpcy5wcml2UGhyYXNlcyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLy8gQWRkcyBvbmUgb3IgbW9yZSByZWZlcmVuY2UgZ3JhbW1hcnMgdG8gdGhlIGN1cnJlbnQgZ3JhbW1hci5cbiAgICBhZGRSZWZlcmVuY2VHcmFtbWFyKGdyYW1tYXIpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZHcmFtbWFycykge1xuICAgICAgICAgICAgdGhpcy5wcml2R3JhbW1hcnMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ3JhbW1hciBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICB0aGlzLnByaXZHcmFtbWFycyA9IHRoaXMucHJpdkdyYW1tYXJzLmNvbmNhdChncmFtbWFyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkdyYW1tYXJzLnB1c2goZ3JhbW1hcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gY2xlYXJzIGFsbCBncmFtbWFycyBzdG9yZWQgb24gdGhlIHJlY29nbml6ZXIuXG4gICAgY2xlYXJHcmFtbWFycygpIHtcbiAgICAgICAgdGhpcy5wcml2R3JhbW1hcnMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8vIEdlbmVyYXRlcyBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSBkeW5hbWljIGdyYW1tYXIgdXNlZCBieSB0aGUgU3BlZWNoIFNlcnZpY2UuXG4gICAgLy8gVGhpcyBpcyBkb25lIGJ5IGJ1aWxkaW5nIGFuIG9iamVjdCB3aXRoIHRoZSBjb3JyZWN0IGxheW91dCBiYXNlZCBvbiB0aGUgcGhyYXNlcyBhbmQgcmVmZXJlbmNlIGdyYW1tYXJzIGFkZGVkIHRvIHRoaXMgaW5zdGFuY2VcbiAgICAvLyBvZiBhIER5bmFtaWNHcmFtbWFyQnVpbGRlclxuICAgIGdlbmVyYXRlR3JhbW1hck9iamVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkdyYW1tYXJzID09PSB1bmRlZmluZWQgJiYgdGhpcy5wcml2UGhyYXNlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJldE9iaiA9IHt9O1xuICAgICAgICByZXRPYmouUmVmZXJlbmNlR3JhbW1hcnMgPSB0aGlzLnByaXZHcmFtbWFycztcbiAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gdGhpcy5wcml2UGhyYXNlcyAmJiAwICE9PSB0aGlzLnByaXZQaHJhc2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcmV0UGhyYXNlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5wcml2UGhyYXNlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldFBocmFzZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIFRleHQ6IHZhbHVlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXRPYmouR3JvdXBzID0gW3sgVHlwZTogXCJHZW5lcmljXCIsIEl0ZW1zOiByZXRQaHJhc2VzIH1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXRPYmo7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EeW5hbWljR3JhbW1hckJ1aWxkZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RHluYW1pY0dyYW1tYXJJbnRlcmZhY2VzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUmVzdWx0UmVhc29uIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBSZWNvZ25pdGlvblN0YXR1cyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBFbnVtVHJhbnNsYXRpb24ge1xuICAgIHN0YXRpYyBpbXBsVHJhbnNsYXRlUmVjb2duaXRpb25SZXN1bHQocmVjb2duaXRpb25TdGF0dXMpIHtcbiAgICAgICAgbGV0IHJlYXNvbiA9IFJlc3VsdFJlYXNvbi5DYW5jZWxlZDtcbiAgICAgICAgc3dpdGNoIChyZWNvZ25pdGlvblN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5TdWNjZXNzOlxuICAgICAgICAgICAgICAgIHJlYXNvbiA9IFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkU3BlZWNoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5Ob01hdGNoOlxuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5Jbml0aWFsU2lsZW5jZVRpbWVvdXQ6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkJhYmJsZVRpbWVvdXQ6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkVuZE9mRGljdGF0aW9uOlxuICAgICAgICAgICAgICAgIHJlYXNvbiA9IFJlc3VsdFJlYXNvbi5Ob01hdGNoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5FcnJvcjpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuQmFkUmVxdWVzdDpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuRm9yYmlkZGVuOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBSZXN1bHRSZWFzb24uQ2FuY2VsZWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlYXNvbjtcbiAgICB9XG4gICAgc3RhdGljIGltcGxUcmFuc2xhdGVDYW5jZWxSZXN1bHQocmVjb2duaXRpb25TdGF0dXMpIHtcbiAgICAgICAgbGV0IHJlYXNvbiA9IENhbmNlbGxhdGlvblJlYXNvbi5FbmRPZlN0cmVhbTtcbiAgICAgICAgc3dpdGNoIChyZWNvZ25pdGlvblN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5TdWNjZXNzOlxuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5FbmRPZkRpY3RhdGlvbjpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuTm9NYXRjaDpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBDYW5jZWxsYXRpb25SZWFzb24uRW5kT2ZTdHJlYW07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkluaXRpYWxTaWxlbmNlVGltZW91dDpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuQmFiYmxlVGltZW91dDpcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuRXJyb3I6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkJhZFJlcXVlc3Q6XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkZvcmJpZGRlbjpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWFzb247XG4gICAgfVxuICAgIHN0YXRpYyBpbXBsVHJhbnNsYXRlQ2FuY2VsRXJyb3JDb2RlKHJlY29nbml0aW9uU3RhdHVzKSB7XG4gICAgICAgIGxldCByZWFzb24gPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcjtcbiAgICAgICAgc3dpdGNoIChyZWNvZ25pdGlvblN0YXR1cykge1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5FcnJvcjpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuU2VydmljZUVycm9yO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvblN0YXR1cy5Ub29NYW55UmVxdWVzdHM6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlRvb01hbnlSZXF1ZXN0cztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuQmFkUmVxdWVzdDpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuQmFkUmVxdWVzdFBhcmFtZXRlcnM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkZvcmJpZGRlbjpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuRm9yYmlkZGVuO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVhc29uO1xuICAgIH1cbiAgICBzdGF0aWMgaW1wbFRyYW5zbGF0ZUVycm9yRGV0YWlscyhjYW5jZWxsYXRpb25FcnJvckNvZGUpIHtcbiAgICAgICAgbGV0IGVycm9yRGV0YWlscyA9IFwiVGhlIHNwZWVjaCBzZXJ2aWNlIGVuY291bnRlcmVkIGFuIGludGVybmFsIGVycm9yIGFuZCBjb3VsZCBub3QgY29udGludWUuXCI7XG4gICAgICAgIHN3aXRjaCAoY2FuY2VsbGF0aW9uRXJyb3JDb2RlKSB7XG4gICAgICAgICAgICBjYXNlIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Gb3JiaWRkZW46XG4gICAgICAgICAgICAgICAgZXJyb3JEZXRhaWxzID0gXCJUaGUgcmVjb2duaXplciBpcyB1c2luZyBhIGZyZWUgc3Vic2NyaXB0aW9uIHRoYXQgcmFuIG91dCBvZiBxdW90YS5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkJhZFJlcXVlc3RQYXJhbWV0ZXJzOlxuICAgICAgICAgICAgICAgIGVycm9yRGV0YWlscyA9IFwiSW52YWxpZCBwYXJhbWV0ZXIgb3IgdW5zdXBwb3J0ZWQgYXVkaW8gZm9ybWF0IGluIHRoZSByZXF1ZXN0LlwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBDYW5jZWxsYXRpb25FcnJvckNvZGUuVG9vTWFueVJlcXVlc3RzOlxuICAgICAgICAgICAgICAgIGVycm9yRGV0YWlscyA9IFwiVGhlIG51bWJlciBvZiBwYXJhbGxlbCByZXF1ZXN0cyBleGNlZWRlZCB0aGUgbnVtYmVyIG9mIGFsbG93ZWQgY29uY3VycmVudCB0cmFuc2NyaXB0aW9ucy5cIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVycm9yRGV0YWlscztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUVudW1UcmFuc2xhdGlvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTWFrZSBzdXJlIG5vdCB0byBleHBvcnQgaW50ZXJuYWwgbW9kdWxlcy5cbi8vXG5leHBvcnQgKiBmcm9tIFwiLi9Db2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vSUF1dGhlbnRpY2F0aW9uXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9JQ29ubmVjdGlvbkZhY3RvcnlcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0lTeW50aGVzaXNDb25uZWN0aW9uRmFjdG9yeVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vSW50ZW50Q29ubmVjdGlvbkZhY3RvcnlcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NwZWFrZXJSZWNvZ25pdGlvbkNvbm5lY3Rpb25GYWN0b3J5XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9SZWNvZ25pdGlvbkV2ZW50c1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZVJlY29nbml6ZXJCYXNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9Db252ZXJzYXRpb25TZXJ2aWNlUmVjb2duaXplclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vUmVjb2duaXplckNvbmZpZ1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3BlZWNoU2VydmljZUludGVyZmFjZXNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1dlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NwZWVjaENvbm5lY3Rpb25GYWN0b3J5XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9UcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9UcmFuc2xhdGlvbkNvbm5lY3Rpb25GYWN0b3J5XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TcGVlY2hTeW50aGVzaXNDb25uZWN0aW9uRmFjdG9yeVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vRW51bVRyYW5zbGF0aW9uXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvRW51bXNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9UcmFuc2xhdGlvblN5bnRoZXNpc0VuZFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1RyYW5zbGF0aW9uSHlwb3RoZXNpc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1RyYW5zbGF0aW9uUGhyYXNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9UcmFuc2xhdGlvblNlcnZpY2VSZWNvZ25pemVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvU3BlZWNoRGV0ZWN0ZWRcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9TcGVlY2hIeXBvdGhlc2lzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvU3BlZWNoS2V5d29yZFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3BlZWNoU2VydmljZVJlY29nbml6ZXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1RyYW5zY3JpcHRpb25TZXJ2aWNlUmVjb2duaXplclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL0RldGFpbGVkU3BlZWNoUGhyYXNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvU2ltcGxlU3BlZWNoUGhyYXNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9BZGRlZExtSW50ZW50XCI7XG5leHBvcnQgKiBmcm9tIFwiLi9JbnRlbnRTZXJ2aWNlUmVjb2duaXplclwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL0ludGVudFJlc3BvbnNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvU3BlYWtlclJlc3BvbnNlXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9SZXF1ZXN0U2Vzc2lvblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3BlZWNoQ29udGV4dFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vRHluYW1pY0dyYW1tYXJCdWlsZGVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9EeW5hbWljR3JhbW1hckludGVyZmFjZXNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL0RpYWxvZ1NlcnZpY2VBZGFwdGVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9BZ2VudENvbmZpZ1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vVHJhbnNjcmlwdGlvbi9FeHBvcnRzXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TZXJ2aWNlTWVzc2FnZXMvU3ludGhlc2lzQXVkaW9NZXRhZGF0YVwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3ludGhlc2lzVHVyblwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3ludGhlc2lzQWRhcHRlckJhc2VcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1N5bnRoZXNpc1Jlc3RBZGFwdGVyXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TeW50aGVzaXplckNvbmZpZ1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3ludGhlc2lzQ29udGV4dFwiO1xuZXhwb3J0ICogZnJvbSBcIi4vU3BlYWtlclJlY29nbml0aW9uQ29uZmlnXCI7XG5leHBvcnQgKiBmcm9tIFwiLi9TcGVha2VyU2VydmljZVJlY29nbml6ZXJcIjtcbmV4cG9ydCAqIGZyb20gXCIuL1ZvaWNlU2VydmljZVJlY29nbml6ZXJcIjtcbmV4cG9ydCBjb25zdCBPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUgPSBcIk91dHB1dEZvcm1hdFwiO1xuZXhwb3J0IGNvbnN0IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSA9IFwiQ2FuY2VsbGF0aW9uRXJyb3JDb2RlXCI7XG5leHBvcnQgY29uc3QgU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUgPSBcIlNlcnZpY2VQcm9wZXJ0aWVzXCI7XG5leHBvcnQgY29uc3QgRm9yY2VEaWN0YXRpb25Qcm9wZXJ0eU5hbWUgPSBcIkZvcmNlRGljdGF0aW9uXCI7XG5leHBvcnQgY29uc3QgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlc09wZW5SYW5nZU9wdGlvbk5hbWUgPSBcIk9wZW5SYW5nZVwiO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FeHBvcnRzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgSGVhZGVyTmFtZXMge1xufVxuSGVhZGVyTmFtZXMuQXV0aEtleSA9IFwiT2NwLUFwaW0tU3Vic2NyaXB0aW9uLUtleVwiO1xuSGVhZGVyTmFtZXMuQXV0aG9yaXphdGlvbiA9IFwiQXV0aG9yaXphdGlvblwiO1xuSGVhZGVyTmFtZXMuU3BJREF1dGhLZXkgPSBcIkFwaW0tU3Vic2NyaXB0aW9uLUlkXCI7XG5IZWFkZXJOYW1lcy5Db25uZWN0aW9uSWQgPSBcIlgtQ29ubmVjdGlvbklkXCI7XG5IZWFkZXJOYW1lcy5Db250ZW50VHlwZSA9IFwiQ29udGVudC1UeXBlXCI7XG5IZWFkZXJOYW1lcy5DdXN0b21Db21tYW5kc0FwcElkID0gXCJYLUNvbW1hbmRzQXBwSWRcIjtcbkhlYWRlck5hbWVzLlBhdGggPSBcIlBhdGhcIjtcbkhlYWRlck5hbWVzLlJlcXVlc3RJZCA9IFwiWC1SZXF1ZXN0SWRcIjtcbkhlYWRlck5hbWVzLlJlcXVlc3RTdHJlYW1JZCA9IFwiWC1TdHJlYW1JZFwiO1xuSGVhZGVyTmFtZXMuUmVxdWVzdFRpbWVzdGFtcCA9IFwiWC1UaW1lc3RhbXBcIjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SGVhZGVyTmFtZXMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBBdXRoSW5mbyB7XG4gICAgY29uc3RydWN0b3IoaGVhZGVyTmFtZSwgdG9rZW4pIHtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVyTmFtZSA9IGhlYWRlck5hbWU7XG4gICAgICAgIHRoaXMucHJpdlRva2VuID0gdG9rZW47XG4gICAgfVxuICAgIGdldCBoZWFkZXJOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SGVhZGVyTmFtZTtcbiAgICB9XG4gICAgZ2V0IHRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VG9rZW47XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1JQXV0aGVudGljYXRpb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SUNvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUlTeW50aGVzaXNDb25uZWN0aW9uRmFjdG9yeS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uLCB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIEludGVudENvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIGxldCBlbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQpO1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0ludGVudFJlZ2lvbik7XG4gICAgICAgICAgICBjb25zdCBob3N0U3VmZml4ID0gQ29ubmVjdGlvbkZhY3RvcnlCYXNlLmdldEhvc3RTdWZmaXgocmVnaW9uKTtcbiAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIFwid3NzOi8vXCIgKyByZWdpb24gKyBcIi5zci5zcGVlY2hcIiArIGhvc3RTdWZmaXgpO1xuICAgICAgICAgICAgZW5kcG9pbnQgPSBob3N0ICsgXCIvc3BlZWNoL3JlY29nbml0aW9uL2ludGVyYWN0aXZlL2NvZ25pdGl2ZXNlcnZpY2VzL3YxXCI7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7XG4gICAgICAgICAgICBmb3JtYXQ6IFwic2ltcGxlXCIsXG4gICAgICAgICAgICBsYW5ndWFnZTogY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UpLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNldENvbW1vblVybFBhcmFtcyhjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuICE9PSB1bmRlZmluZWQgJiYgYXV0aEluZm8udG9rZW4gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbYXV0aEluZm8uaGVhZGVyTmFtZV0gPSBhdXRoSW5mby50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIGNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG4gICAgZ2V0U3BlZWNoUmVnaW9uRnJvbUludGVudFJlZ2lvbihpbnRlbnRSZWdpb24pIHtcbiAgICAgICAgc3dpdGNoIChpbnRlbnRSZWdpb24pIHtcbiAgICAgICAgICAgIGNhc2UgXCJXZXN0IFVTXCI6XG4gICAgICAgICAgICBjYXNlIFwiVVMgV2VzdFwiOlxuICAgICAgICAgICAgY2FzZSBcIndlc3R1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInVzd2VzdFwiO1xuICAgICAgICAgICAgY2FzZSBcIldlc3QgVVMgMlwiOlxuICAgICAgICAgICAgY2FzZSBcIlVTIFdlc3QgMlwiOlxuICAgICAgICAgICAgY2FzZSBcIndlc3R1czJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1c3dlc3QyXCI7XG4gICAgICAgICAgICBjYXNlIFwiU291dGggQ2VudHJhbCBVU1wiOlxuICAgICAgICAgICAgY2FzZSBcIlVTIFNvdXRoIENlbnRyYWxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJzb3V0aGNlbnRyYWx1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInVzc291dGhjZW50cmFsXCI7XG4gICAgICAgICAgICBjYXNlIFwiV2VzdCBDZW50cmFsIFVTXCI6XG4gICAgICAgICAgICBjYXNlIFwiVVMgV2VzdCBDZW50cmFsXCI6XG4gICAgICAgICAgICBjYXNlIFwid2VzdGNlbnRyYWx1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInVzd2VzdGNlbnRyYWxcIjtcbiAgICAgICAgICAgIGNhc2UgXCJFYXN0IFVTXCI6XG4gICAgICAgICAgICBjYXNlIFwiVVMgRWFzdFwiOlxuICAgICAgICAgICAgY2FzZSBcImVhc3R1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInVzZWFzdFwiO1xuICAgICAgICAgICAgY2FzZSBcIkVhc3QgVVMgMlwiOlxuICAgICAgICAgICAgY2FzZSBcIlVTIEVhc3QgMlwiOlxuICAgICAgICAgICAgY2FzZSBcImVhc3R1czJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1c2Vhc3QyXCI7XG4gICAgICAgICAgICBjYXNlIFwiV2VzdCBFdXJvcGVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJFdXJvcGUgV2VzdFwiOlxuICAgICAgICAgICAgY2FzZSBcIndlc3RldXJvcGVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJldXJvcGV3ZXN0XCI7XG4gICAgICAgICAgICBjYXNlIFwiTm9ydGggRXVyb3BlXCI6XG4gICAgICAgICAgICBjYXNlIFwiRXVyb3BlIE5vcnRoXCI6XG4gICAgICAgICAgICBjYXNlIFwibm9ydGhldXJvcGVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJldXJvcGVub3J0aFwiO1xuICAgICAgICAgICAgY2FzZSBcIkJyYXppbCBTb3V0aFwiOlxuICAgICAgICAgICAgY2FzZSBcIlNvdXRoIEJyYXppbFwiOlxuICAgICAgICAgICAgY2FzZSBcInNvdXRoYnJhemlsXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYnJhemlsc291dGhcIjtcbiAgICAgICAgICAgIGNhc2UgXCJBdXN0cmFsaWEgRWFzdFwiOlxuICAgICAgICAgICAgY2FzZSBcIkVhc3QgQXVzdHJhbGlhXCI6XG4gICAgICAgICAgICBjYXNlIFwiZWFzdGF1c3RyYWxpYVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImF1c3RyYWxpYWVhc3RcIjtcbiAgICAgICAgICAgIGNhc2UgXCJTb3V0aGVhc3QgQXNpYVwiOlxuICAgICAgICAgICAgY2FzZSBcIkFzaWEgU291dGhlYXN0XCI6XG4gICAgICAgICAgICBjYXNlIFwic291dGhlYXN0YXNpYVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFzaWFzb3V0aGVhc3RcIjtcbiAgICAgICAgICAgIGNhc2UgXCJFYXN0IEFzaWFcIjpcbiAgICAgICAgICAgIGNhc2UgXCJBc2lhIEVhc3RcIjpcbiAgICAgICAgICAgIGNhc2UgXCJlYXN0YXNpYVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFzaWFlYXN0XCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBpbnRlbnRSZWdpb247XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudENvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBEZWZlcnJlZCwgTWVzc2FnZVR5cGUsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIEludGVudFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MsIEludGVudFJlY29nbml0aW9uRXZlbnRBcmdzLCBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdCwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIEVudW1UcmFuc2xhdGlvbiwgSW50ZW50UmVzcG9uc2UsIFNlcnZpY2VSZWNvZ25pemVyQmFzZSwgU2ltcGxlU3BlZWNoUGhyYXNlLCBTcGVlY2hIeXBvdGhlc2lzLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIEludGVudFNlcnZpY2VSZWNvZ25pemVyIGV4dGVuZHMgU2VydmljZVJlY29nbml6ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCByZWNvZ25pemVyKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpO1xuICAgICAgICB0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyID0gcmVjb2duaXplcjtcbiAgICAgICAgdGhpcy5wcml2SW50ZW50RGF0YVNlbnQgPSBmYWxzZTtcbiAgICB9XG4gICAgc2V0SW50ZW50cyhhZGRlZEludGVudHMsIHVtYnJlbGxhSW50ZW50KSB7XG4gICAgICAgIHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzID0gYWRkZWRJbnRlbnRzO1xuICAgICAgICB0aGlzLnByaXZVbWJyZWxsYUludGVudCA9IHVtYnJlbGxhSW50ZW50O1xuICAgICAgICB0aGlzLnByaXZJbnRlbnREYXRhU2VudCA9IHRydWU7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICBsZXQgZXY7XG4gICAgICAgIGxldCBwcm9jZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgcmVzdWx0UHJvcHMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIGlmIChjb25uZWN0aW9uTWVzc2FnZS5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCkge1xuICAgICAgICAgICAgcmVzdWx0UHJvcHMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoY29ubmVjdGlvbk1lc3NhZ2UucGF0aC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwic3BlZWNoLmh5cG90aGVzaXNcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hIeXBvdGhlc2lzID0gU3BlZWNoSHlwb3RoZXNpcy5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IEludGVudFJlY29nbml0aW9uUmVzdWx0KHVuZGVmaW5lZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBSZXN1bHRSZWFzb24uUmVjb2duaXppbmdJbnRlbnQsIHNwZWVjaEh5cG90aGVzaXMuVGV4dCwgc3BlZWNoSHlwb3RoZXNpcy5EdXJhdGlvbiwgc3BlZWNoSHlwb3RoZXNpcy5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0LCBzcGVlY2hIeXBvdGhlc2lzLkxhbmd1YWdlLCBzcGVlY2hIeXBvdGhlc2lzLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgdW5kZWZpbmVkLCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSwgcmVzdWx0UHJvcHMpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uSHlwb3RoZXNpcyhyZXN1bHQub2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBldiA9IG5ldyBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIHNwZWVjaEh5cG90aGVzaXMuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLnJlY29nbml6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLnJlY29nbml6aW5nKHRoaXMucHJpdkludGVudFJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzcGVlY2gucGhyYXNlXCI6XG4gICAgICAgICAgICAgICAgY29uc3Qgc2ltcGxlID0gU2ltcGxlU3BlZWNoUGhyYXNlLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgSW50ZW50UmVjb2duaXRpb25SZXN1bHQodW5kZWZpbmVkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlUmVjb2duaXRpb25SZXN1bHQoc2ltcGxlLlJlY29nbml0aW9uU3RhdHVzKSwgc2ltcGxlLkRpc3BsYXlUZXh0LCBzaW1wbGUuRHVyYXRpb24sIHNpbXBsZS5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0LCBzaW1wbGUuTGFuZ3VhZ2UsIHNpbXBsZS5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICBldiA9IG5ldyBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIHJlc3VsdC5vZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VuZEV2ZW50ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLnJlY29nbml6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SW50ZW50UmVjb2duaXplci5yZWNvZ25pemVkKHRoaXMucHJpdkludGVudFJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyByZXBvcnQgcmVzdWx0IHRvIHByb21pc2UuXG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpZiBpdCdzIHN1Y2Nlc3NmdWwgZG9uJ3QgaW52b2tlIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3IgYWZ0ZXIgdGhhdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8vIElmIGludGVudCBkYXRhIHdhcyBzZW50LCB0aGUgdGVybWluYWwgcmVzdWx0IGZvciB0aGlzIHJlY29nbml6ZXIgaXMgYW4gaW50ZW50IGJlaW5nIGZvdW5kLlxuICAgICAgICAgICAgICAgIC8vIElmIG5vIGludGVudCBkYXRhIHdhcyBzZW50LCB0aGUgdGVybWluYWwgZXZlbnQgaXMgc3BlZWNoIHJlY29nbml0aW9uIGJlaW5nIHN1Y2Nlc3NmdWwuXG4gICAgICAgICAgICAgICAgaWYgKGZhbHNlID09PSB0aGlzLnByaXZJbnRlbnREYXRhU2VudCB8fCBSZXN1bHRSZWFzb24uTm9NYXRjaCA9PT0gZXYucmVzdWx0LnJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICAvLyBBZHZhbmNlIHRoZSBidWZmZXJzLlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblBocmFzZVJlY29nbml6ZWQoZXYub2Zmc2V0ICsgZXYucmVzdWx0LmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgc2VuZEV2ZW50KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBTcXVpcnJlbCBhd2F5IHRoZSBhcmdzLCB3aGVuIHRoZSByZXNwb25zZSBldmVudCBhcnJpdmVzIGl0IHdpbGwgYnVpbGQgdXBvbiB0aGVtXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCB0aGVuIHJldHVyblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZQZW5kaW5nSW50ZW50QXJncyA9IGV2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJlc3BvbnNlXCI6XG4gICAgICAgICAgICAgICAgLy8gUmVzcG9uc2UgZnJvbSBMVUlTXG4gICAgICAgICAgICAgICAgZXYgPSB0aGlzLnByaXZQZW5kaW5nSW50ZW50QXJncztcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZQZW5kaW5nSW50ZW50QXJncyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAodW5kZWZpbmVkID09PSBldikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXCJcIiA9PT0gY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgY29uZGl0aW9uIGhhcHBlbnMgaWYgdGhlcmUgaXMgbm90aGluZyBidXQgc2lsZW5jZSBpbiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF1ZGlvIHNlbnQgdG8gdGhlIHNlcnZpY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gT2RkLi4uIE5vdCBzdXJlIHRoaXMgY2FuIGhhcHBlblxuICAgICAgICAgICAgICAgICAgICBldiA9IG5ldyBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncyhuZXcgSW50ZW50UmVjb2duaXRpb25SZXN1bHQoKSwgMCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgaW50ZW50UmVzcG9uc2UgPSBJbnRlbnRSZXNwb25zZS5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgLy8gSWYgTFVJUyBkaWRuJ3QgcmV0dXJuIGFueXRoaW5nLCBzZW5kIHRoZSBleGlzdGluZyBldmVudCwgZWxzZVxuICAgICAgICAgICAgICAgIC8vIG1vZGlmeSBpdCB0byBzaG93IHRoZSBtYXRjaC5cbiAgICAgICAgICAgICAgICAvLyBTZWUgaWYgdGhlIGludGVudCBmb3VuZCBpcyBpbiB0aGUgbGlzdCBvZiBpbnRlbnRzIGFza2VkIGZvci5cbiAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gaW50ZW50UmVzcG9uc2UgJiYgISFpbnRlbnRSZXNwb25zZS50b3BTY29yaW5nSW50ZW50ICYmICEhaW50ZW50UmVzcG9uc2UudG9wU2NvcmluZ0ludGVudC5pbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFkZGVkSW50ZW50ID0gdGhpcy5wcml2QWRkZWRMbUludGVudHNbaW50ZW50UmVzcG9uc2UudG9wU2NvcmluZ0ludGVudC5pbnRlbnRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2VW1icmVsbGFJbnRlbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWRJbnRlbnQgPSB0aGlzLnByaXZVbWJyZWxsYUludGVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoISFhZGRlZEludGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW50ZW50SWQgPSBhZGRlZEludGVudCA9PT0gdW5kZWZpbmVkIHx8IGFkZGVkSW50ZW50LmludGVudE5hbWUgPT09IHVuZGVmaW5lZCA/IGludGVudFJlc3BvbnNlLnRvcFNjb3JpbmdJbnRlbnQuaW50ZW50IDogYWRkZWRJbnRlbnQuaW50ZW50TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZWFzb24gPSBldi5yZXN1bHQucmVhc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gaW50ZW50SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb24gPSBSZXN1bHRSZWFzb24uUmVjb2duaXplZEludGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSwgcHJvcGVydGllcyBpcyBzZXQuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gKHVuZGVmaW5lZCAhPT0gZXYucmVzdWx0LnByb3BlcnRpZXMpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5yZXN1bHQucHJvcGVydGllcyA6IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5MYW5ndWFnZVVuZGVyc3RhbmRpbmdTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXYgPSBuZXcgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MobmV3IEludGVudFJlY29nbml0aW9uUmVzdWx0KGludGVudElkLCBldi5yZXN1bHQucmVzdWx0SWQsIHJlYXNvbiwgZXYucmVzdWx0LnRleHQsIGV2LnJlc3VsdC5kdXJhdGlvbiwgZXYucmVzdWx0Lm9mZnNldCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGV2LnJlc3VsdC5lcnJvckRldGFpbHMsIGV2LnJlc3VsdC5qc29uLCBwcm9wZXJ0aWVzKSwgZXYub2Zmc2V0LCBldi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uUGhyYXNlUmVjb2duaXplZChldi5vZmZzZXQgKyBldi5yZXN1bHQuZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkludGVudFJlY29nbml6ZXIucmVjb2duaXplZCkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SW50ZW50UmVjb2duaXplci5yZWNvZ25pemVkKHRoaXMucHJpdkludGVudFJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gcmVwb3J0IHJlc3VsdCB0byBwcm9taXNlLlxuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKGV2LnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gYW5kIGlmIGl0J3Mgc3VjY2Vzc2Z1bCBkb24ndCBpbnZva2UgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGVycm9yIGFmdGVyIHRoYXQuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGVmZmVyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgZGVmZmVyYWwucmVzb2x2ZShwcm9jZXNzZWQpO1xuICAgICAgICByZXR1cm4gZGVmZmVyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgLy8gQ2FuY2VscyByZWNvZ25pdGlvbi5cbiAgICBjYW5jZWxSZWNvZ25pdGlvbihzZXNzaW9uSWQsIHJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbZXJyb3JDb2RlXSk7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkludGVudFJlY29nbml6ZXIuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEV2ZW50ID0gbmV3IEludGVudFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MoY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvciwgZXJyb3JDb2RlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SW50ZW50UmVjb2duaXplci5jYW5jZWxlZCh0aGlzLnByaXZJbnRlbnRSZWNvZ25pemVyLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgSW50ZW50UmVjb2duaXRpb25SZXN1bHQodW5kZWZpbmVkLCAvLyBJbnRlbnQgSWRcbiAgICAgICAgICAgIHJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLkNhbmNlbGVkLCB1bmRlZmluZWQsIC8vIFRleHRcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gRHVyYXRpb25cbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gT2Zmc2V0XG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIExhbmd1YWdlXG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIExhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZVxuICAgICAgICAgICAgZXJyb3IsIHVuZGVmaW5lZCwgLy8gSnNvblxuICAgICAgICAgICAgcHJvcGVydGllcyk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9iKSB7IH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW50ZW50U2VydmljZVJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBRdWVyeVBhcmFtZXRlck5hbWVzIHtcbn1cblF1ZXJ5UGFyYW1ldGVyTmFtZXMuQm90SWQgPSBcImJvdGlkXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkN1c3RvbVNwZWVjaERlcGxveW1lbnRJZCA9IFwiY2lkXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkN1c3RvbVZvaWNlRGVwbG95bWVudElkID0gXCJkZXBsb3ltZW50SWRcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuRW5hYmxlQXVkaW9Mb2dnaW5nID0gXCJzdG9yZUF1ZGlvXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkVuYWJsZUxhbmd1YWdlSWQgPSBcImxpZEVuYWJsZWRcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuRW5hYmxlV29yZExldmVsVGltZXN0YW1wcyA9IFwid29yZExldmVsVGltZXN0YW1wc1wiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5FbmRTaWxlbmNlVGltZW91dE1zID0gXCJlbmRTaWxlbmNlVGltZW91dE1zXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLlNlZ21lbnRhdGlvblNpbGVuY2VUaW1lb3V0TXMgPSBcInNlZ21lbnRhdGlvblNpbGVuY2VUaW1lb3V0TXNcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuRm9ybWF0ID0gXCJmb3JtYXRcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0TXMgPSBcImluaXRpYWxTaWxlbmNlVGltZW91dE1zXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLkxhbmd1YWdlID0gXCJsYW5ndWFnZVwiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5Qcm9mYW5pdHkgPSBcInByb2Zhbml0eVwiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5SZXF1ZXN0Qm90U3RhdHVzTWVzc2FnZXMgPSBcImVuYWJsZUJvdE1lc3NhZ2VTdGF0dXNcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuU3RhYmxlSW50ZXJtZWRpYXRlVGhyZXNob2xkID0gXCJzdGFibGVJbnRlcm1lZGlhdGVUaHJlc2hvbGRcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuU3RhYmxlVHJhbnNsYXRpb24gPSBcInN0YWJsZVRyYW5zbGF0aW9uXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLlRlc3RIb29rcyA9IFwidGVzdGhvb2tzXCI7XG5RdWVyeVBhcmFtZXRlck5hbWVzLlBvc3Rwcm9jZXNzaW5nID0gXCJwb3N0cHJvY2Vzc2luZ1wiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNNZWV0aW5nSWQgPSBcIm1lZXRpbmdJZFwiO1xuUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNEZXZpY2VJZCA9IFwiZGV2aWNlSWRcIjtcblF1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3RzSXNQYXJ0aWNpcGFudCA9IFwiaXNQYXJ0aWNpcGFudFwiO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1RdWVyeVBhcmFtZXRlck5hbWVzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgRXZlbnRUeXBlLCBQbGF0Zm9ybUV2ZW50IH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgU3BlZWNoUmVjb2duaXRpb25FdmVudCBleHRlbmRzIFBsYXRmb3JtRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgcmVxdWVzdElkLCBzZXNzaW9uSWQsIGV2ZW50VHlwZSA9IEV2ZW50VHlwZS5JbmZvKSB7XG4gICAgICAgIHN1cGVyKGV2ZW50TmFtZSwgZXZlbnRUeXBlKTtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICB0aGlzLnByaXZTZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XG4gICAgfVxuICAgIGdldCByZXF1ZXN0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXF1ZXN0SWQ7XG4gICAgfVxuICAgIGdldCBzZXNzaW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXNzaW9uSWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFJlY29nbml0aW9uVHJpZ2dlcmVkRXZlbnQgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIHNlc3Npb25JZCwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgc3VwZXIoXCJSZWNvZ25pdGlvblRyaWdnZXJlZEV2ZW50XCIsIHJlcXVlc3RJZCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCA9IGF1ZGlvU291cmNlSWQ7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZUlkID0gYXVkaW9Ob2RlSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb1NvdXJjZUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Tb3VyY2VJZDtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvTm9kZUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Ob2RlSWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIExpc3RlbmluZ1N0YXJ0ZWRFdmVudCBleHRlbmRzIFNwZWVjaFJlY29nbml0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgc2Vzc2lvbklkLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCkge1xuICAgICAgICBzdXBlcihcIkxpc3RlbmluZ1N0YXJ0ZWRFdmVudFwiLCByZXF1ZXN0SWQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvU291cmNlSWQgPSBhdWRpb1NvdXJjZUlkO1xuICAgICAgICB0aGlzLnByaXZBdWRpb05vZGVJZCA9IGF1ZGlvTm9kZUlkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Tb3VyY2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU291cmNlSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb05vZGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZUlkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW5nVG9TZXJ2aWNlRXZlbnQgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIGF1dGhGZXRjaEV2ZW50aWQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihcIkNvbm5lY3RpbmdUb1NlcnZpY2VFdmVudFwiLCByZXF1ZXN0SWQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50aWQgPSBhdXRoRmV0Y2hFdmVudGlkO1xuICAgIH1cbiAgICBnZXQgYXV0aEZldGNoRXZlbnRpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50aWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFJlY29nbml0aW9uU3RhcnRlZEV2ZW50IGV4dGVuZHMgU3BlZWNoUmVjb2duaXRpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCwgYXV0aEZldGNoRXZlbnRJZCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKFwiUmVjb2duaXRpb25TdGFydGVkRXZlbnRcIiwgcmVxdWVzdElkLCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb1NvdXJjZUlkID0gYXVkaW9Tb3VyY2VJZDtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlSWQgPSBhdWRpb05vZGVJZDtcbiAgICAgICAgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCA9IGF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb1NvdXJjZUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Tb3VyY2VJZDtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvTm9kZUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9Ob2RlSWQ7XG4gICAgfVxuICAgIGdldCBhdXRoRmV0Y2hFdmVudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZDtcbiAgICB9XG59XG5leHBvcnQgdmFyIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1cztcbihmdW5jdGlvbiAoUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzKSB7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIlN1Y2Nlc3NcIl0gPSAwXSA9IFwiU3VjY2Vzc1wiO1xuICAgIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbXCJBdWRpb1NvdXJjZUVycm9yXCJdID0gMV0gPSBcIkF1ZGlvU291cmNlRXJyb3JcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiQXVkaW9Tb3VyY2VUaW1lb3V0XCJdID0gMl0gPSBcIkF1ZGlvU291cmNlVGltZW91dFwiO1xuICAgIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbXCJBdXRoVG9rZW5GZXRjaEVycm9yXCJdID0gM10gPSBcIkF1dGhUb2tlbkZldGNoRXJyb3JcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiQXV0aFRva2VuRmV0Y2hUaW1lb3V0XCJdID0gNF0gPSBcIkF1dGhUb2tlbkZldGNoVGltZW91dFwiO1xuICAgIFJlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbXCJVbkF1dGhvcml6ZWRcIl0gPSA1XSA9IFwiVW5BdXRob3JpemVkXCI7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIkNvbm5lY3RUaW1lb3V0XCJdID0gNl0gPSBcIkNvbm5lY3RUaW1lb3V0XCI7XG4gICAgUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1JlY29nbml0aW9uQ29tcGxldGlvblN0YXR1c1tcIkNvbm5lY3RFcnJvclwiXSA9IDddID0gXCJDb25uZWN0RXJyb3JcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiQ2xpZW50UmVjb2duaXRpb25BY3Rpdml0eVRpbWVvdXRcIl0gPSA4XSA9IFwiQ2xpZW50UmVjb2duaXRpb25BY3Rpdml0eVRpbWVvdXRcIjtcbiAgICBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXNbUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzW1wiVW5rbm93bkVycm9yXCJdID0gOV0gPSBcIlVua25vd25FcnJvclwiO1xufSkoUmVjb2duaXRpb25Db21wbGV0aW9uU3RhdHVzIHx8IChSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXMgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIFJlY29nbml0aW9uRW5kZWRFdmVudCBleHRlbmRzIFNwZWVjaFJlY29nbml0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQsIGF1dGhGZXRjaEV2ZW50SWQsIHNlc3Npb25JZCwgc2VydmljZVRhZywgc3RhdHVzLCBlcnJvcikge1xuICAgICAgICBzdXBlcihcIlJlY29nbml0aW9uRW5kZWRFdmVudFwiLCByZXF1ZXN0SWQsIHNlc3Npb25JZCwgc3RhdHVzID09PSBSZWNvZ25pdGlvbkNvbXBsZXRpb25TdGF0dXMuU3VjY2VzcyA/IEV2ZW50VHlwZS5JbmZvIDogRXZlbnRUeXBlLkVycm9yKTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCA9IGF1ZGlvU291cmNlSWQ7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZUlkID0gYXVkaW9Ob2RlSWQ7XG4gICAgICAgIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQgPSBhdXRoRmV0Y2hFdmVudElkO1xuICAgICAgICB0aGlzLnByaXZTdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgIHRoaXMucHJpdkVycm9yID0gZXJyb3I7XG4gICAgICAgIHRoaXMucHJpdlNlcnZpY2VUYWcgPSBzZXJ2aWNlVGFnO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Tb3VyY2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU291cmNlSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb05vZGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZUlkO1xuICAgIH1cbiAgICBnZXQgYXV0aEZldGNoRXZlbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgfVxuICAgIGdldCBzZXJ2aWNlVGFnKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2VydmljZVRhZztcbiAgICB9XG4gICAgZ2V0IHN0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0YXR1cztcbiAgICB9XG4gICAgZ2V0IGVycm9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3I7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWNvZ25pdGlvbkV2ZW50cy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmV4cG9ydCB2YXIgUmVjb2duaXRpb25Nb2RlO1xuKGZ1bmN0aW9uIChSZWNvZ25pdGlvbk1vZGUpIHtcbiAgICBSZWNvZ25pdGlvbk1vZGVbUmVjb2duaXRpb25Nb2RlW1wiSW50ZXJhY3RpdmVcIl0gPSAwXSA9IFwiSW50ZXJhY3RpdmVcIjtcbiAgICBSZWNvZ25pdGlvbk1vZGVbUmVjb2duaXRpb25Nb2RlW1wiQ29udmVyc2F0aW9uXCJdID0gMV0gPSBcIkNvbnZlcnNhdGlvblwiO1xuICAgIFJlY29nbml0aW9uTW9kZVtSZWNvZ25pdGlvbk1vZGVbXCJEaWN0YXRpb25cIl0gPSAyXSA9IFwiRGljdGF0aW9uXCI7XG59KShSZWNvZ25pdGlvbk1vZGUgfHwgKFJlY29nbml0aW9uTW9kZSA9IHt9KSk7XG5leHBvcnQgdmFyIFNwZWVjaFJlc3VsdEZvcm1hdDtcbihmdW5jdGlvbiAoU3BlZWNoUmVzdWx0Rm9ybWF0KSB7XG4gICAgU3BlZWNoUmVzdWx0Rm9ybWF0W1NwZWVjaFJlc3VsdEZvcm1hdFtcIlNpbXBsZVwiXSA9IDBdID0gXCJTaW1wbGVcIjtcbiAgICBTcGVlY2hSZXN1bHRGb3JtYXRbU3BlZWNoUmVzdWx0Rm9ybWF0W1wiRGV0YWlsZWRcIl0gPSAxXSA9IFwiRGV0YWlsZWRcIjtcbn0pKFNwZWVjaFJlc3VsdEZvcm1hdCB8fCAoU3BlZWNoUmVzdWx0Rm9ybWF0ID0ge30pKTtcbmV4cG9ydCBjbGFzcyBSZWNvZ25pemVyQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hTZXJ2aWNlQ29uZmlnLCBwYXJhbWV0ZXJzKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFNlcnZpY2VDb25maWcgPSBzcGVlY2hTZXJ2aWNlQ29uZmlnID8gc3BlZWNoU2VydmljZUNvbmZpZyA6IG5ldyBTcGVlY2hTZXJ2aWNlQ29uZmlnKG5ldyBDb250ZXh0KG51bGwpKTtcbiAgICAgICAgdGhpcy5wcml2UGFyYW1ldGVycyA9IHBhcmFtZXRlcnM7XG4gICAgICAgIHRoaXMucHJpdk1heFJldHJ5Q291bnQgPSBwYXJzZUludChwYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUVycm9yLU1heFJldHJ5Q291bnRcIiwgXCI0XCIpLCAxMCk7XG4gICAgICAgIHRoaXMucHJpdkxhbmd1YWdlSWRNb2RlID0gcGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0xhbmd1YWdlSWRNb2RlLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBnZXQgcGFyYW1ldGVycygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGdldCByZWNvZ25pdGlvbk1vZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNvZ25pdGlvbk1vZGU7XG4gICAgfVxuICAgIHNldCByZWNvZ25pdGlvbk1vZGUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXRpb25Nb2RlID0gdmFsdWU7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml0aW9uQWN0aXZpdHlUaW1lb3V0ID0gdmFsdWUgPT09IFJlY29nbml0aW9uTW9kZS5JbnRlcmFjdGl2ZSA/IDgwMDAgOiAyNTAwMDtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoU2VydmljZUNvbmZpZy5SZWNvZ25pdGlvbiA9IFJlY29nbml0aW9uTW9kZVt2YWx1ZV07XG4gICAgfVxuICAgIGdldCBTcGVlY2hTZXJ2aWNlQ29uZmlnKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoU2VydmljZUNvbmZpZztcbiAgICB9XG4gICAgZ2V0IHJlY29nbml0aW9uQWN0aXZpdHlUaW1lb3V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVjb2duaXRpb25BY3Rpdml0eVRpbWVvdXQ7XG4gICAgfVxuICAgIGdldCBpc0NvbnRpbnVvdXNSZWNvZ25pdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY29nbml0aW9uTW9kZSAhPT0gUmVjb2duaXRpb25Nb2RlLkludGVyYWN0aXZlO1xuICAgIH1cbiAgICBnZXQgbGFuZ3VhZ2VJZE1vZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMYW5ndWFnZUlkTW9kZTtcbiAgICB9XG4gICAgZ2V0IGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzLCB1bmRlZmluZWQpO1xuICAgIH1cbiAgICBnZXQgcmVjb2duaXRpb25FbmRwb2ludFZlcnNpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbiwgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgZ2V0IHNvdXJjZUxhbmd1YWdlTW9kZWxzKCkge1xuICAgICAgICBjb25zdCBtb2RlbHMgPSBbXTtcbiAgICAgICAgbGV0IG1vZGVsc0V4aXN0ID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBsYW5ndWFnZSBvZiB0aGlzLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMuc3BsaXQoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VzdG9tUHJvcGVydHkgPSBsYW5ndWFnZSArIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVsSWQgPSB0aGlzLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoY3VzdG9tUHJvcGVydHksIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsSWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbHMucHVzaCh7IGxhbmd1YWdlLCBlbmRwb2ludDogbW9kZWxJZCB9KTtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxzRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxzLnB1c2goeyBsYW5ndWFnZSwgZW5kcG9pbnQ6IFwiXCIgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtb2RlbHNFeGlzdCA/IG1vZGVscyA6IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgZ2V0IG1heFJldHJ5Q291bnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNYXhSZXRyeUNvdW50O1xuICAgIH1cbn1cbi8vIFRoZSBjb25maWcgaXMgc2VyaWFsaXplZCBhbmQgc2VudCBhcyB0aGUgU3BlZWNoLkNvbmZpZ1xuZXhwb3J0IGNsYXNzIFNwZWVjaFNlcnZpY2VDb25maWcge1xuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICB9XG4gICAgc2VyaWFsaXplKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcywgKGtleSwgdmFsdWUpID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgayBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodmFsdWUsIGspKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1hc3NpZ25tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudFtrICYmIGsuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyBrLnN1YnN0cmluZygxKV0gPSB2YWx1ZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgQ29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dDtcbiAgICB9XG4gICAgZ2V0IFJlY29nbml0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWNvZ25pdGlvbjtcbiAgICB9XG4gICAgc2V0IFJlY29nbml0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMucmVjb2duaXRpb24gPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb250ZXh0IHtcbiAgICBjb25zdHJ1Y3Rvcihvcykge1xuICAgICAgICB0aGlzLnN5c3RlbSA9IG5ldyBTeXN0ZW0oKTtcbiAgICAgICAgdGhpcy5vcyA9IG9zO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBTeXN0ZW0ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBOb3RlOiBiZWxvdyB3aWxsIGJlIHBhdGNoZWQgZm9yIG9mZmljaWFsIGJ1aWxkcy5cbiAgICAgICAgY29uc3QgU1BFRUNIU0RLX0NMSUVOVFNES19WRVJTSU9OID0gXCIxLjMwLjFcIjtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJTcGVlY2hTREtcIjtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gU1BFRUNIU0RLX0NMSUVOVFNES19WRVJTSU9OO1xuICAgICAgICB0aGlzLmJ1aWxkID0gXCJKYXZhU2NyaXB0XCI7XG4gICAgICAgIHRoaXMubGFuZyA9IFwiSmF2YVNjcmlwdFwiO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBPUyB7XG4gICAgY29uc3RydWN0b3IocGxhdGZvcm0sIG5hbWUsIHZlcnNpb24pIHtcbiAgICAgICAgdGhpcy5wbGF0Zm9ybSA9IHBsYXRmb3JtO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBEZXZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKG1hbnVmYWN0dXJlciwgbW9kZWwsIHZlcnNpb24pIHtcbiAgICAgICAgdGhpcy5tYW51ZmFjdHVyZXIgPSBtYW51ZmFjdHVyZXI7XG4gICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICAgICAgdGhpcy52ZXJzaW9uID0gdmVyc2lvbjtcbiAgICB9XG59XG5leHBvcnQgdmFyIGNvbm5lY3Rpdml0eTtcbihmdW5jdGlvbiAoY29ubmVjdGl2aXR5KSB7XG4gICAgY29ubmVjdGl2aXR5W1wiQmx1ZXRvb3RoXCJdID0gXCJCbHVldG9vdGhcIjtcbiAgICBjb25uZWN0aXZpdHlbXCJXaXJlZFwiXSA9IFwiV2lyZWRcIjtcbiAgICBjb25uZWN0aXZpdHlbXCJXaUZpXCJdID0gXCJXaUZpXCI7XG4gICAgY29ubmVjdGl2aXR5W1wiQ2VsbHVsYXJcIl0gPSBcIkNlbGx1bGFyXCI7XG4gICAgY29ubmVjdGl2aXR5W1wiSW5CdWlsdFwiXSA9IFwiSW5CdWlsdFwiO1xuICAgIGNvbm5lY3Rpdml0eVtcIlVua25vd25cIl0gPSBcIlVua25vd25cIjtcbn0pKGNvbm5lY3Rpdml0eSB8fCAoY29ubmVjdGl2aXR5ID0ge30pKTtcbmV4cG9ydCB2YXIgdHlwZTtcbihmdW5jdGlvbiAodHlwZSkge1xuICAgIHR5cGVbXCJQaG9uZVwiXSA9IFwiUGhvbmVcIjtcbiAgICB0eXBlW1wiU3BlYWtlclwiXSA9IFwiU3BlYWtlclwiO1xuICAgIHR5cGVbXCJDYXJcIl0gPSBcIkNhclwiO1xuICAgIHR5cGVbXCJIZWFkc2V0XCJdID0gXCJIZWFkc2V0XCI7XG4gICAgdHlwZVtcIlRoZXJtb3N0YXRcIl0gPSBcIlRoZXJtb3N0YXRcIjtcbiAgICB0eXBlW1wiTWljcm9waG9uZXNcIl0gPSBcIk1pY3JvcGhvbmVzXCI7XG4gICAgdHlwZVtcIkRlc2twaG9uZVwiXSA9IFwiRGVza3Bob25lXCI7XG4gICAgdHlwZVtcIlJlbW90ZUNvbnRyb2xcIl0gPSBcIlJlbW90ZUNvbnRyb2xcIjtcbiAgICB0eXBlW1wiVW5rbm93blwiXSA9IFwiVW5rbm93blwiO1xuICAgIHR5cGVbXCJGaWxlXCJdID0gXCJGaWxlXCI7XG4gICAgdHlwZVtcIlN0cmVhbVwiXSA9IFwiU3RyZWFtXCI7XG59KSh0eXBlIHx8ICh0eXBlID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVjb2duaXplckNvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkLCBEZWZlcnJlZCwgRXZlbnRzIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW5nVG9TZXJ2aWNlRXZlbnQsIExpc3RlbmluZ1N0YXJ0ZWRFdmVudCwgUmVjb2duaXRpb25TdGFydGVkRXZlbnQsIFJlY29nbml0aW9uVHJpZ2dlcmVkRXZlbnQsIH0gZnJvbSBcIi4vUmVjb2duaXRpb25FdmVudHNcIjtcbmltcG9ydCB7IFNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lciB9IGZyb20gXCIuL1NlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5JbnRlcm5hbFwiO1xuZXhwb3J0IGNsYXNzIFJlcXVlc3RTZXNzaW9uIHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkKSB7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2RGV0YWNoYWJsZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5wcml2SXNBdWRpb05vZGVEZXRhY2hlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1JlY29nbml6aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzU3BlZWNoRW5kZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2VHVyblN0YXJ0QXVkaW9PZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZMYXN0UmVjb09mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdkh5cG90aGVzaXNSZWNlaXZlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZCeXRlc1NlbnQgPSAwO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ051bWJlciA9IDA7XG4gICAgICAgIHRoaXMucHJpdkluVHVybiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQXR0ZW1wdHMgPSAwO1xuICAgICAgICB0aGlzLnByaXZBdWRpb1NvdXJjZUlkID0gYXVkaW9Tb3VyY2VJZDtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZBdWRpb05vZGVJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIC8vIFdlJ3JlIG5vdCBpbiBhIHR1cm4sIHNvIHJlc29sdmUuXG4gICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldCBzZXNzaW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXNzaW9uSWQ7XG4gICAgfVxuICAgIGdldCByZXF1ZXN0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXF1ZXN0SWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb05vZGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZUlkO1xuICAgIH1cbiAgICBnZXQgdHVybkNvbXBsZXRpb25Qcm9taXNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHVybkRlZmVycmFsLnByb21pc2U7XG4gICAgfVxuICAgIGdldCBpc1NwZWVjaEVuZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNTcGVlY2hFbmRlZDtcbiAgICB9XG4gICAgZ2V0IGlzUmVjb2duaXppbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc1JlY29nbml6aW5nO1xuICAgIH1cbiAgICBnZXQgY3VycmVudFR1cm5BdWRpb09mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5TdGFydEF1ZGlvT2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgcmVjb2dOdW1iZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNvZ051bWJlcjtcbiAgICB9XG4gICAgZ2V0IG51bUNvbm5lY3Rpb25BdHRlbXB0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25BdHRlbXB0cztcbiAgICB9XG4gICAgLy8gVGhlIG51bWJlciBvZiBieXRlcyBzZW50IGZvciB0aGUgY3VycmVudCBjb25uZWN0aW9uLlxuICAgIC8vIENvdW50ZXIgaXMgcmVzZXQgdG8gMCBlYWNoIHRpbWUgYSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkLlxuICAgIGdldCBieXRlc1NlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZCeXRlc1NlbnQ7XG4gICAgfVxuICAgIGxpc3RlbkZvclNlcnZpY2VUZWxlbWV0cnkoZXZlbnRTb3VyY2UpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZEZXRhY2hhYmxlcy5wdXNoKGV2ZW50U291cmNlLmF0dGFjaExpc3RlbmVyKHRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lcikpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXJ0TmV3UmVjb2duaXRpb24oKSB7XG4gICAgICAgIHRoaXMucHJpdklzU3BlZWNoRW5kZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNSZWNvZ25pemluZyA9IHRydWU7XG4gICAgICAgIHRoaXMucHJpdlR1cm5TdGFydEF1ZGlvT2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5wcml2TGFzdFJlY29PZmZzZXQgPSAwO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ051bWJlcisrO1xuICAgICAgICB0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIgPSBuZXcgU2VydmljZVRlbGVtZXRyeUxpc3RlbmVyKHRoaXMucHJpdlJlcXVlc3RJZCwgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCwgdGhpcy5wcml2QXVkaW9Ob2RlSWQpO1xuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IFJlY29nbml0aW9uVHJpZ2dlcmVkRXZlbnQodGhpcy5yZXF1ZXN0SWQsIHRoaXMucHJpdlNlc3Npb25JZCwgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCwgdGhpcy5wcml2QXVkaW9Ob2RlSWQpKTtcbiAgICB9XG4gICAgb25BdWRpb1NvdXJjZUF0dGFjaENvbXBsZXRlZChhdWRpb05vZGUsIGlzRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZSA9IGF1ZGlvTm9kZTtcbiAgICAgICAgICAgIHRoaXMucHJpdklzQXVkaW9Ob2RlRGV0YWNoZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChpc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IExpc3RlbmluZ1N0YXJ0ZWRFdmVudCh0aGlzLnByaXZSZXF1ZXN0SWQsIHRoaXMucHJpdlNlc3Npb25JZCwgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCwgdGhpcy5wcml2QXVkaW9Ob2RlSWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uUHJlQ29ubmVjdGlvblN0YXJ0KGF1dGhGZXRjaEV2ZW50SWQsIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkID0gYXV0aEZldGNoRXZlbnRJZDtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbklkID0gY29ubmVjdGlvbklkO1xuICAgICAgICB0aGlzLm9uRXZlbnQobmV3IENvbm5lY3RpbmdUb1NlcnZpY2VFdmVudCh0aGlzLnByaXZSZXF1ZXN0SWQsIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQsIHRoaXMucHJpdlNlc3Npb25JZCkpO1xuICAgIH1cbiAgICBvbkF1dGhDb21wbGV0ZWQoaXNFcnJvcikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKGlzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBvbkNvbm5lY3Rpb25Fc3RhYmxpc2hDb21wbGV0ZWQoc3RhdHVzQ29kZSwgcmVhc29uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBSZWNvZ25pdGlvblN0YXJ0ZWRFdmVudCh0aGlzLnJlcXVlc3RJZCwgdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCwgdGhpcy5wcml2QXVkaW9Ob2RlSWQsIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQsIHRoaXMucHJpdlNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkF1ZGlvTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb05vZGUucmVwbGF5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlR1cm5TdGFydEF1ZGlvT2Zmc2V0ID0gdGhpcy5wcml2TGFzdFJlY29PZmZzZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Qnl0ZXNTZW50ID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdGF0dXNDb2RlID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uU2VydmljZVR1cm5FbmRSZXNwb25zZShjb250aW51b3VzUmVjb2duaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgICAgICBpZiAoIWNvbnRpbnVvdXNSZWNvZ25pdGlvbiB8fCB0aGlzLmlzU3BlZWNoRW5kZWQpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJblR1cm4gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFN0YXJ0IGEgbmV3IHJlcXVlc3Qgc2V0LlxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlR1cm5TdGFydEF1ZGlvT2Zmc2V0ID0gdGhpcy5wcml2TGFzdFJlY29PZmZzZXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlLnJlcGxheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25TcGVlY2hDb250ZXh0KCkge1xuICAgICAgICB0aGlzLnByaXZSZXF1ZXN0SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgfVxuICAgIG9uU2VydmljZVR1cm5TdGFydFJlc3BvbnNlKCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZUdXJuRGVmZXJyYWwgJiYgISF0aGlzLnByaXZJblR1cm4pIHtcbiAgICAgICAgICAgIC8vIFdoYXQ/IEhvdyBhcmUgd2Ugc3RhcnRpbmcgYSB0dXJuIHdpdGggYW5vdGhlciBub3QgZG9uZT9cbiAgICAgICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5yZWplY3QoXCJBbm90aGVyIHR1cm4gc3RhcnRlZCBiZWZvcmUgY3VycmVudCBjb21wbGV0ZWQuXCIpO1xuICAgICAgICAgICAgLy8gQXZvaWQgVW5oYW5kbGVkUHJvbWlzZVJlamVjdGlvbiBpZiBwcml2VHVybkRlZmVycmFsIGlzIG5vdCBiZWluZyBhd2FpdGVkXG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwucHJvbWlzZS50aGVuKCkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZJblR1cm4gPSB0cnVlO1xuICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICB9XG4gICAgb25IeXBvdGhlc2lzKG9mZnNldCkge1xuICAgICAgICBpZiAoIXRoaXMucHJpdkh5cG90aGVzaXNSZWNlaXZlZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2SHlwb3RoZXNpc1JlY2VpdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5oeXBvdGhlc2lzUmVjZWl2ZWQodGhpcy5wcml2QXVkaW9Ob2RlLmZpbmRUaW1lQXRPZmZzZXQob2Zmc2V0KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25QaHJhc2VSZWNvZ25pemVkKG9mZnNldCkge1xuICAgICAgICB0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIucGhyYXNlUmVjZWl2ZWQodGhpcy5wcml2QXVkaW9Ob2RlLmZpbmRUaW1lQXRPZmZzZXQob2Zmc2V0KSk7XG4gICAgICAgIHRoaXMub25TZXJ2aWNlUmVjb2duaXplZChvZmZzZXQpO1xuICAgIH1cbiAgICBvblNlcnZpY2VSZWNvZ25pemVkKG9mZnNldCkge1xuICAgICAgICB0aGlzLnByaXZMYXN0UmVjb09mZnNldCA9IG9mZnNldDtcbiAgICAgICAgdGhpcy5wcml2SHlwb3RoZXNpc1JlY2VpdmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZS5zaHJpbmtCdWZmZXJzKG9mZnNldCk7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25BdHRlbXB0cyA9IDA7XG4gICAgfVxuICAgIG9uQXVkaW9TZW50KGJ5dGVzU2VudCkge1xuICAgICAgICB0aGlzLnByaXZCeXRlc1NlbnQgKz0gYnl0ZXNTZW50O1xuICAgIH1cbiAgICBvblJldHJ5Q29ubmVjdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkF0dGVtcHRzKys7XG4gICAgfVxuICAgIGRpc3Bvc2UoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICAvLyB3ZSBzaG91bGQgaGF2ZSBjb21wbGV0ZWQgYnkgbm93LiBJZiB3ZSBkaWQgbm90IGl0cyBhbiB1bmtub3duIGVycm9yLlxuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZGV0YWNoYWJsZSBvZiB0aGlzLnByaXZEZXRhY2hhYmxlcykge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCBkZXRhY2hhYmxlLmRldGFjaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTZXJ2aWNlVGVsZW1ldHJ5TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNSZWNvZ25pemluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0VGVsZW1ldHJ5KCkge1xuICAgICAgICBpZiAodGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyLmhhc1RlbGVtZXRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lci5nZXRUZWxlbWV0cnkoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uU3RvcFJlY29nbml6aW5nKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBTaG91bGQgYmUgY2FsbGVkIHdpdGggdGhlIGF1ZGlvTm9kZSBmb3IgdGhpcyBzZXNzaW9uIGhhcyBpbmRpY2F0ZWQgdGhhdCBpdCBpcyBvdXQgb2Ygc3BlZWNoLlxuICAgIG9uU3BlZWNoRW5kZWQoKSB7XG4gICAgICAgIHRoaXMucHJpdklzU3BlZWNoRW5kZWQgPSB0cnVlO1xuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdlNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5wcml2U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyLm9uRXZlbnQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICAgb25Db21wbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdklzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc1JlY29nbml6aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5kZXRhY2hBdWRpb05vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGRldGFjaEF1ZGlvTm9kZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2SXNBdWRpb05vZGVEZXRhY2hlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzQXVkaW9Ob2RlRGV0YWNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZBdWRpb05vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2QXVkaW9Ob2RlLmRldGFjaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZXF1ZXN0U2Vzc2lvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gcmVzcG9uc2VcbmV4cG9ydCBjbGFzcyBBY3Rpdml0eVBheWxvYWRSZXNwb25zZSB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZBY3Rpdml0eVJlc3BvbnNlID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBY3Rpdml0eVBheWxvYWRSZXNwb25zZShqc29uKTtcbiAgICB9XG4gICAgZ2V0IGNvbnZlcnNhdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QWN0aXZpdHlSZXNwb25zZS5jb252ZXJzYXRpb25JZDtcbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2VEYXRhU3RyZWFtVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFjdGl2aXR5UmVzcG9uc2UubWVzc2FnZURhdGFTdHJlYW1UeXBlO1xuICAgIH1cbiAgICBnZXQgbWVzc2FnZVBheWxvYWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBY3Rpdml0eVJlc3BvbnNlLm1lc3NhZ2VQYXlsb2FkO1xuICAgIH1cbiAgICBnZXQgdmVyc2lvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFjdGl2aXR5UmVzcG9uc2UudmVyc2lvbjtcbiAgICB9XG59XG5leHBvcnQgdmFyIE1lc3NhZ2VEYXRhU3RyZWFtVHlwZTtcbihmdW5jdGlvbiAoTWVzc2FnZURhdGFTdHJlYW1UeXBlKSB7XG4gICAgTWVzc2FnZURhdGFTdHJlYW1UeXBlW01lc3NhZ2VEYXRhU3RyZWFtVHlwZVtcIk5vbmVcIl0gPSAwXSA9IFwiTm9uZVwiO1xuICAgIE1lc3NhZ2VEYXRhU3RyZWFtVHlwZVtNZXNzYWdlRGF0YVN0cmVhbVR5cGVbXCJUZXh0VG9TcGVlY2hBdWRpb1wiXSA9IDFdID0gXCJUZXh0VG9TcGVlY2hBdWRpb1wiO1xufSkoTWVzc2FnZURhdGFTdHJlYW1UeXBlIHx8IChNZXNzYWdlRGF0YVN0cmVhbVR5cGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BY3Rpdml0eVJlc3BvbnNlUGF5bG9hZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUmVjb2duaXRpb25TdGF0dXMgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIERldGFpbGVkU3BlZWNoUGhyYXNlIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuUmVjb2duaXRpb25TdGF0dXMgPSBSZWNvZ25pdGlvblN0YXR1c1t0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5SZWNvZ25pdGlvblN0YXR1c107XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGV0YWlsZWRTcGVlY2hQaHJhc2UoanNvbik7XG4gICAgfVxuICAgIGdldEpzb25XaXRoQ29ycmVjdGVkT2Zmc2V0cyhiYXNlT2Zmc2V0KSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLk5CZXN0KSB7XG4gICAgICAgICAgICBsZXQgZmlyc3RXb3JkT2Zmc2V0O1xuICAgICAgICAgICAgZm9yIChjb25zdCBwaHJhc2Ugb2YgdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuTkJlc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoISFwaHJhc2UuV29yZHMgJiYgISFwaHJhc2UuV29yZHNbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RXb3JkT2Zmc2V0ID0gcGhyYXNlLldvcmRzWzBdLk9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhZmlyc3RXb3JkT2Zmc2V0ICYmIGZpcnN0V29yZE9mZnNldCA8IGJhc2VPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBiYXNlT2Zmc2V0IC0gZmlyc3RXb3JkT2Zmc2V0O1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZGV0YWlscyBvZiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5OQmVzdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISFkZXRhaWxzLldvcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHdvcmQgb2YgZGV0YWlscy5Xb3Jkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmQuT2Zmc2V0ICs9IG9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoISFkZXRhaWxzLkRpc3BsYXlXb3Jkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB3b3JkIG9mIGRldGFpbHMuRGlzcGxheVdvcmRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29yZC5PZmZzZXQgKz0gb2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZSk7XG4gICAgfVxuICAgIGdldCBSZWNvZ25pdGlvblN0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzO1xuICAgIH1cbiAgICBnZXQgTkJlc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5OQmVzdDtcbiAgICB9XG4gICAgZ2V0IER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuRHVyYXRpb247XG4gICAgfVxuICAgIGdldCBPZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5PZmZzZXQ7XG4gICAgfVxuICAgIGdldCBMYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuUHJpbWFyeUxhbmd1YWdlLkxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuUHJpbWFyeUxhbmd1YWdlID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5QcmltYXJ5TGFuZ3VhZ2UuQ29uZmlkZW5jZTtcbiAgICB9XG4gICAgZ2V0IFRleHQoKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLk5CZXN0ICYmIHRoaXMucHJpdkRldGFpbGVkU3BlZWNoUGhyYXNlLk5CZXN0WzBdKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuTkJlc3RbMF0uRGlzcGxheSB8fCB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5OQmVzdFswXS5EaXNwbGF5VGV4dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlsZWRTcGVlY2hQaHJhc2UuRGlzcGxheVRleHQ7XG4gICAgfVxuICAgIGdldCBTcGVha2VySWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxlZFNwZWVjaFBocmFzZS5TcGVha2VySWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1EZXRhaWxlZFNwZWVjaFBocmFzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBAY2xhc3MgU3ludGhlc2lzU3RhdHVzXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgdmFyIFN5bnRoZXNpc1N0YXR1cztcbihmdW5jdGlvbiAoU3ludGhlc2lzU3RhdHVzKSB7XG4gICAgLyoqXG4gICAgICogVGhlIHJlc3BvbnNlIGNvbnRhaW5zIHZhbGlkIGF1ZGlvIGRhdGEuXG4gICAgICogQG1lbWJlciBTeW50aGVzaXNTdGF0dXMuU3VjY2Vzc1xuICAgICAqL1xuICAgIFN5bnRoZXNpc1N0YXR1c1tTeW50aGVzaXNTdGF0dXNbXCJTdWNjZXNzXCJdID0gMF0gPSBcIlN1Y2Nlc3NcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGVuZCBvZiBhdWRpbyBkYXRhLiBObyB2YWxpZCBhdWRpbyBkYXRhIGlzIGluY2x1ZGVkIGluIHRoZSBtZXNzYWdlLlxuICAgICAqIEBtZW1iZXIgU3ludGhlc2lzU3RhdHVzLlN5bnRoZXNpc0VuZFxuICAgICAqL1xuICAgIFN5bnRoZXNpc1N0YXR1c1tTeW50aGVzaXNTdGF0dXNbXCJTeW50aGVzaXNFbmRcIl0gPSAxXSA9IFwiU3ludGhlc2lzRW5kXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGFuIGVycm9yIG9jY3VycmVkIGR1cmluZyBzeW50aGVzaXMgZGF0YSBwcm9jZXNzaW5nLlxuICAgICAqIEBtZW1iZXIgU3ludGhlc2lzU3RhdHVzLkVycm9yXG4gICAgICovXG4gICAgU3ludGhlc2lzU3RhdHVzW1N5bnRoZXNpc1N0YXR1c1tcIkVycm9yXCJdID0gMl0gPSBcIkVycm9yXCI7XG59KShTeW50aGVzaXNTdGF0dXMgfHwgKFN5bnRoZXNpc1N0YXR1cyA9IHt9KSk7XG5leHBvcnQgdmFyIFJlY29nbml0aW9uU3RhdHVzO1xuKGZ1bmN0aW9uIChSZWNvZ25pdGlvblN0YXR1cykge1xuICAgIFJlY29nbml0aW9uU3RhdHVzW1JlY29nbml0aW9uU3RhdHVzW1wiU3VjY2Vzc1wiXSA9IDBdID0gXCJTdWNjZXNzXCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJOb01hdGNoXCJdID0gMV0gPSBcIk5vTWF0Y2hcIjtcbiAgICBSZWNvZ25pdGlvblN0YXR1c1tSZWNvZ25pdGlvblN0YXR1c1tcIkluaXRpYWxTaWxlbmNlVGltZW91dFwiXSA9IDJdID0gXCJJbml0aWFsU2lsZW5jZVRpbWVvdXRcIjtcbiAgICBSZWNvZ25pdGlvblN0YXR1c1tSZWNvZ25pdGlvblN0YXR1c1tcIkJhYmJsZVRpbWVvdXRcIl0gPSAzXSA9IFwiQmFiYmxlVGltZW91dFwiO1xuICAgIFJlY29nbml0aW9uU3RhdHVzW1JlY29nbml0aW9uU3RhdHVzW1wiRXJyb3JcIl0gPSA0XSA9IFwiRXJyb3JcIjtcbiAgICBSZWNvZ25pdGlvblN0YXR1c1tSZWNvZ25pdGlvblN0YXR1c1tcIkVuZE9mRGljdGF0aW9uXCJdID0gNV0gPSBcIkVuZE9mRGljdGF0aW9uXCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJUb29NYW55UmVxdWVzdHNcIl0gPSA2XSA9IFwiVG9vTWFueVJlcXVlc3RzXCI7XG4gICAgUmVjb2duaXRpb25TdGF0dXNbUmVjb2duaXRpb25TdGF0dXNbXCJCYWRSZXF1ZXN0XCJdID0gN10gPSBcIkJhZFJlcXVlc3RcIjtcbiAgICBSZWNvZ25pdGlvblN0YXR1c1tSZWNvZ25pdGlvblN0YXR1c1tcIkZvcmJpZGRlblwiXSA9IDhdID0gXCJGb3JiaWRkZW5cIjtcbn0pKFJlY29nbml0aW9uU3RhdHVzIHx8IChSZWNvZ25pdGlvblN0YXR1cyA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUVudW1zLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vLyByZXNwb25zZVxuZXhwb3J0IGNsYXNzIEludGVudFJlc3BvbnNlIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIGlmIChqc29uID09PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJbnRlbnRSZXNwb25zZSA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcml2SW50ZW50UmVzcG9uc2UgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW50ZW50UmVzcG9uc2UoanNvbik7XG4gICAgfVxuICAgIGdldCBxdWVyeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkludGVudFJlc3BvbnNlLnF1ZXJ5O1xuICAgIH1cbiAgICBnZXQgdG9wU2NvcmluZ0ludGVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkludGVudFJlc3BvbnNlLnRvcFNjb3JpbmdJbnRlbnQ7XG4gICAgfVxuICAgIGdldCBlbnRpdGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkludGVudFJlc3BvbnNlLmVudGl0aWVzO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW50ZW50UmVzcG9uc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlY29nbml0aW9uU3RhdHVzIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBTaW1wbGVTcGVlY2hQaHJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzID0gUmVjb2duaXRpb25TdGF0dXNbdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzXTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVTcGVlY2hQaHJhc2UoanNvbik7XG4gICAgfVxuICAgIGdldCBSZWNvZ25pdGlvblN0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNpbXBsZVNwZWVjaFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cztcbiAgICB9XG4gICAgZ2V0IERpc3BsYXlUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLkRpc3BsYXlUZXh0O1xuICAgIH1cbiAgICBnZXQgT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLk9mZnNldDtcbiAgICB9XG4gICAgZ2V0IER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLkR1cmF0aW9uO1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTaW1wbGVTcGVlY2hQaHJhc2UuUHJpbWFyeUxhbmd1YWdlID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiB0aGlzLnByaXZTaW1wbGVTcGVlY2hQaHJhc2UuUHJpbWFyeUxhbmd1YWdlLkxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlByaW1hcnlMYW5ndWFnZS5Db25maWRlbmNlO1xuICAgIH1cbiAgICBnZXQgU3BlYWtlcklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2ltcGxlU3BlZWNoUGhyYXNlLlNwZWFrZXJJZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNpbXBsZVNwZWVjaFBocmFzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclJlc3BvbnNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgU3BlZWNoRGV0ZWN0ZWQge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhcnREZXRlY3RlZCA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3BlZWNoRGV0ZWN0ZWQoanNvbik7XG4gICAgfVxuICAgIGdldCBPZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hTdGFydERldGVjdGVkLk9mZnNldDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaERldGVjdGVkLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgU3BlZWNoSHlwb3RoZXNpcyB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTcGVlY2hIeXBvdGhlc2lzKGpzb24pO1xuICAgIH1cbiAgICBnZXQgVGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaEh5cG90aGVzaXMuVGV4dDtcbiAgICB9XG4gICAgZ2V0IE9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaEh5cG90aGVzaXMuT2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgRHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzLkR1cmF0aW9uO1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzLlByaW1hcnlMYW5ndWFnZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogdGhpcy5wcml2U3BlZWNoSHlwb3RoZXNpcy5QcmltYXJ5TGFuZ3VhZ2UuTGFuZ3VhZ2U7XG4gICAgfVxuICAgIGdldCBMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hIeXBvdGhlc2lzLlByaW1hcnlMYW5ndWFnZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogdGhpcy5wcml2U3BlZWNoSHlwb3RoZXNpcy5QcmltYXJ5TGFuZ3VhZ2UuQ29uZmlkZW5jZTtcbiAgICB9XG4gICAgZ2V0IFNwZWFrZXJJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaEh5cG90aGVzaXMuU3BlYWtlcklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoSHlwb3RoZXNpcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFNwZWVjaEtleXdvcmQge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoS2V5d29yZCA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3BlZWNoS2V5d29yZChqc29uKTtcbiAgICB9XG4gICAgZ2V0IFN0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaEtleXdvcmQuU3RhdHVzO1xuICAgIH1cbiAgICBnZXQgVGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaEtleXdvcmQuVGV4dDtcbiAgICB9XG4gICAgZ2V0IE9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaEtleXdvcmQuT2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgRHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hLZXl3b3JkLkR1cmF0aW9uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoS2V5d29yZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IHZhciBNZXRhZGF0YVR5cGU7XG4oZnVuY3Rpb24gKE1ldGFkYXRhVHlwZSkge1xuICAgIE1ldGFkYXRhVHlwZVtcIldvcmRCb3VuZGFyeVwiXSA9IFwiV29yZEJvdW5kYXJ5XCI7XG4gICAgTWV0YWRhdGFUeXBlW1wiQm9va21hcmtcIl0gPSBcIkJvb2ttYXJrXCI7XG4gICAgTWV0YWRhdGFUeXBlW1wiVmlzZW1lXCJdID0gXCJWaXNlbWVcIjtcbiAgICBNZXRhZGF0YVR5cGVbXCJTZW50ZW5jZUJvdW5kYXJ5XCJdID0gXCJTZW50ZW5jZUJvdW5kYXJ5XCI7XG4gICAgTWV0YWRhdGFUeXBlW1wiU2Vzc2lvbkVuZFwiXSA9IFwiU2Vzc2lvbkVuZFwiO1xufSkoTWV0YWRhdGFUeXBlIHx8IChNZXRhZGF0YVR5cGUgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc0F1ZGlvTWV0YWRhdGEge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzQXVkaW9NZXRhZGF0YSA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3ludGhlc2lzQXVkaW9NZXRhZGF0YShqc29uKTtcbiAgICB9XG4gICAgZ2V0IE1ldGFkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3ludGhlc2lzQXVkaW9NZXRhZGF0YS5NZXRhZGF0YTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bnRoZXNpc0F1ZGlvTWV0YWRhdGEuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFRyYW5zbGF0aW9uU3RhdHVzIH0gZnJvbSBcIi4uL1RyYW5zbGF0aW9uU3RhdHVzXCI7XG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25IeXBvdGhlc2lzIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uSHlwb3RoZXNpcyA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uSHlwb3RoZXNpcy5UcmFuc2xhdGlvbi5UcmFuc2xhdGlvblN0YXR1cyA9IFRyYW5zbGF0aW9uU3RhdHVzW3RoaXMucHJpdlRyYW5zbGF0aW9uSHlwb3RoZXNpcy5UcmFuc2xhdGlvbi5UcmFuc2xhdGlvblN0YXR1c107XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRpb25IeXBvdGhlc2lzKGpzb24pO1xuICAgIH1cbiAgICBnZXQgRHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMuRHVyYXRpb247XG4gICAgfVxuICAgIGdldCBPZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMuT2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgVGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zbGF0aW9uSHlwb3RoZXNpcy5UZXh0O1xuICAgIH1cbiAgICBnZXQgVHJhbnNsYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvbkh5cG90aGVzaXMuVHJhbnNsYXRpb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvbkh5cG90aGVzaXMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi8uLi9zZGsvQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBSZWNvZ25pdGlvblN0YXR1cyB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBUcmFuc2xhdGlvblN0YXR1cyB9IGZyb20gXCIuLi9UcmFuc2xhdGlvblN0YXR1c1wiO1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uUGhyYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihwaHJhc2UpIHtcbiAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UgPSBwaHJhc2U7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzID0gUmVjb2duaXRpb25TdGF0dXNbdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuUmVjb2duaXRpb25TdGF0dXNdO1xuICAgICAgICBpZiAodGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuVHJhbnNsYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuVHJhbnNsYXRpb24uVHJhbnNsYXRpb25TdGF0dXMgPSBUcmFuc2xhdGlvblN0YXR1c1t0aGlzLnByaXZUcmFuc2xhdGlvblBocmFzZS5UcmFuc2xhdGlvbi5UcmFuc2xhdGlvblN0YXR1c107XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGlvblBocmFzZShKU09OLnBhcnNlKGpzb24pKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21UcmFuc2xhdGlvblJlc3BvbnNlKHRyYW5zbGF0aW9uUmVzcG9uc2UpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodHJhbnNsYXRpb25SZXNwb25zZSwgXCJ0cmFuc2xhdGlvblJlc3BvbnNlXCIpO1xuICAgICAgICBjb25zdCBwaHJhc2UgPSB0cmFuc2xhdGlvblJlc3BvbnNlLlNwZWVjaFBocmFzZTtcbiAgICAgICAgdHJhbnNsYXRpb25SZXNwb25zZS5TcGVlY2hQaHJhc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIHBocmFzZS5UcmFuc2xhdGlvbiA9IHRyYW5zbGF0aW9uUmVzcG9uc2U7XG4gICAgICAgIHBocmFzZS5UZXh0ID0gcGhyYXNlLkRpc3BsYXlUZXh0O1xuICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW9uUGhyYXNlKHBocmFzZSk7XG4gICAgfVxuICAgIGdldCBSZWNvZ25pdGlvblN0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzO1xuICAgIH1cbiAgICBnZXQgT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuT2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgRHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvblBocmFzZS5EdXJhdGlvbjtcbiAgICB9XG4gICAgZ2V0IFRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUcmFuc2xhdGlvblBocmFzZS5UZXh0O1xuICAgIH1cbiAgICBnZXQgTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMucHJpdlRyYW5zbGF0aW9uUGhyYXNlLlByaW1hcnlMYW5ndWFnZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLkxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgQ29uZmlkZW5jZSgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gKF9hID0gdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuUHJpbWFyeUxhbmd1YWdlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuQ29uZmlkZW5jZTtcbiAgICB9XG4gICAgZ2V0IFRyYW5zbGF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25QaHJhc2UuVHJhbnNsYXRpb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblBocmFzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU3ludGhlc2lzU3RhdHVzIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblN5bnRoZXNpc0VuZCB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNFbmQgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZTeW50aGVzaXNFbmQuU3ludGhlc2lzU3RhdHVzKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNFbmQuU3ludGhlc2lzU3RhdHVzID0gU3ludGhlc2lzU3RhdHVzW3RoaXMucHJpdlN5bnRoZXNpc0VuZC5TeW50aGVzaXNTdGF0dXNdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghIXRoaXMucHJpdlN5bnRoZXNpc0VuZC5TdGF0dXMpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc0VuZC5TeW50aGVzaXNTdGF0dXMgPSBTeW50aGVzaXNTdGF0dXNbdGhpcy5wcml2U3ludGhlc2lzRW5kLlN0YXR1c107XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGlvblN5bnRoZXNpc0VuZChqc29uKTtcbiAgICB9XG4gICAgZ2V0IFN5bnRoZXNpc1N0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN5bnRoZXNpc0VuZC5TeW50aGVzaXNTdGF0dXM7XG4gICAgfVxuICAgIGdldCBGYWlsdXJlUmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3ludGhlc2lzRW5kLkZhaWx1cmVSZWFzb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblN5bnRoZXNpc0VuZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIFR1cm5TdGF0dXNSZXNwb25zZVBheWxvYWQge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZVN0YXR1c1Jlc3BvbnNlID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUdXJuU3RhdHVzUmVzcG9uc2VQYXlsb2FkKGpzb24pO1xuICAgIH1cbiAgICBnZXQgaW50ZXJhY3Rpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1lc3NhZ2VTdGF0dXNSZXNwb25zZS5pbnRlcmFjdGlvbklkO1xuICAgIH1cbiAgICBnZXQgY29udmVyc2F0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXNzYWdlU3RhdHVzUmVzcG9uc2UuY29udmVyc2F0aW9uSWQ7XG4gICAgfVxuICAgIGdldCBzdGF0dXNDb2RlKCkge1xuICAgICAgICAvLyBQYXlsb2FkcyBtYXkgY29udGFpbiBhIGxpbWl0ZWQgc2V0IG9mIHRleHR1YWwgcmVwcmVzZW50YXRpb25zIG9yIGEgbnVtZXJpYyBzdGF0dXNcbiAgICAgICAgLy8gY29kZS4gVGhlIHRleHR1YWwgdmFsdWVzIGFyZSBoZXJlIGNvbnZlcnRlZCBpbnRvIG51bWVyaWMgb25lcy5cbiAgICAgICAgc3dpdGNoICh0aGlzLnByaXZNZXNzYWdlU3RhdHVzUmVzcG9uc2Uuc3RhdHVzQ29kZSkge1xuICAgICAgICAgICAgY2FzZSBcIlN1Y2Nlc3NcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMjAwO1xuICAgICAgICAgICAgY2FzZSBcIkZhaWxlZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiA0MDA7XG4gICAgICAgICAgICBjYXNlIFwiVGltZWRPdXRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gNDI5O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1yZXR1cm5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2TWVzc2FnZVN0YXR1c1Jlc3BvbnNlLnN0YXR1c0NvZGU7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVR1cm5TdGF0dXNQYXlsb2FkLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFJlcGxheWFibGVBdWRpb05vZGUgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIENvbm5lY3Rpb25TdGF0ZSwgY3JlYXRlTm9EYXNoR3VpZCwgRXZlbnRTb3VyY2UsIE1lc3NhZ2VUeXBlLCBTZXJ2aWNlRXZlbnQsIFRpbWVvdXQgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBQcm9wZXJ0eUlkLCBSZWNvZ25pdGlvbkV2ZW50QXJncywgU2Vzc2lvbkV2ZW50QXJncywgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IEFnZW50Q29uZmlnLCBEeW5hbWljR3JhbW1hckJ1aWxkZXIsIFJlY29nbml0aW9uTW9kZSwgUmVxdWVzdFNlc3Npb24sIFNwZWVjaENvbnRleHQsIFNwZWVjaERldGVjdGVkLCB0eXBlIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UgfSBmcm9tIFwiLi9TcGVlY2hDb25uZWN0aW9uTWVzc2FnZS5JbnRlcm5hbFwiO1xuZXhwb3J0IGNsYXNzIFNlcnZpY2VSZWNvZ25pemVyQmFzZSB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgcmVjb2duaXplcikge1xuICAgICAgICAvLyBBIHByb21pc2UgZm9yIGEgY29uZmlndXJlZCBjb25uZWN0aW9uLlxuICAgICAgICAvLyBEbyBub3QgY29uc3VtZSBkaXJlY3RseSwgY2FsbCBmZXRjaENvbm5lY3Rpb24gaW5zdGVhZC5cbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICAvLyBBIHByb21pc2UgZm9yIGEgY29ubmVjdGlvbiwgYnV0IG9uZSB0aGF0IGhhcyBub3QgaGFkIHRoZSBzcGVlY2ggY29udGV4dCBzZW50IHlldC5cbiAgICAgICAgLy8gRG8gbm90IGNvbnN1bWUgZGlyZWN0bHksIGNhbGwgZmV0Y2hDb25uZWN0aW9uIGluc3RlYWQuXG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByaXZTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgdGhpcy5wcml2SXNMaXZlQXVkaW8gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVPdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVTcGVha2VyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZU92ZXJyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTk92ZXJyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBvc3RDb25uZWN0SW1wbE92ZXJyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5oYW5kbGVTcGVlY2hQaHJhc2VNZXNzYWdlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmhhbmRsZVNwZWVjaEh5cG90aGVzaXNNZXNzYWdlID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIWF1dGhlbnRpY2F0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJhdXRoZW50aWNhdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNvbm5lY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJjb25uZWN0aW9uRmFjdG9yeVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWF1ZGlvU291cmNlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJhdWRpb1NvdXJjZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcInJlY29nbml6ZXJDb25maWdcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2TXVzdFJlcG9ydEVuZE9mU3RyZWFtID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkF1dGhlbnRpY2F0aW9uID0gYXV0aGVudGljYXRpb247XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25GYWN0b3J5ID0gY29ubmVjdGlvbkZhY3Rvcnk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvU291cmNlID0gYXVkaW9Tb3VyY2U7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcgPSByZWNvZ25pemVyQ29uZmlnO1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIgPSByZWNvZ25pemVyO1xuICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbiA9IG5ldyBSZXF1ZXN0U2Vzc2lvbih0aGlzLnByaXZBdWRpb1NvdXJjZS5pZCgpKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkV2ZW50cyA9IG5ldyBFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZTZXJ2aWNlRXZlbnRzID0gbmV3IEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdkR5bmFtaWNHcmFtbWFyID0gbmV3IER5bmFtaWNHcmFtbWFyQnVpbGRlcigpO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hDb250ZXh0ID0gbmV3IFNwZWVjaENvbnRleHQodGhpcy5wcml2RHluYW1pY0dyYW1tYXIpO1xuICAgICAgICB0aGlzLnByaXZBZ2VudENvbmZpZyA9IG5ldyBBZ2VudENvbmZpZygpO1xuICAgICAgICBpZiAodHlwZW9mIChCbG9iKSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgKFdvcmtlcikgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlNldFRpbWVvdXQgPSBUaW1lb3V0LnNldFRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb25uZWN0aW9uRXZlbnRzLmF0dGFjaCgoY29ubmVjdGlvbkV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbkNsb3NlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uQ2xvc2VkRXZlbnQgPSBjb25uZWN0aW9uRXZlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlID09PSAxMDAzIHx8XG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlID09PSAxMDA3IHx8XG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlID09PSAxMDAyIHx8XG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlID09PSA0MDAwIHx8XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm51bUNvbm5lY3Rpb25BdHRlbXB0cyA+IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcubWF4UmV0cnlDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICB2b2lkIHRoaXMuY2FuY2VsUmVjb2duaXRpb25Mb2NhbChDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlID09PSAxMDA3ID8gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkJhZFJlcXVlc3RQYXJhbWV0ZXJzIDogQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkNvbm5lY3Rpb25GYWlsdXJlLCBgJHtjb25uZWN0aW9uQ2xvc2VkRXZlbnQucmVhc29ufSB3ZWJzb2NrZXQgZXJyb3IgY29kZTogJHtjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwaHJhc2VEZXRlY3Rpb24gPSB7fTtcbiAgICAgICAgaWYgKHJlY29nbml6ZXJDb25maWcuYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBzb3VyY2VMYW5ndWFnZXMgPSByZWNvZ25pemVyQ29uZmlnLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgbGV0IHNwZWVjaENvbnRleHRMaWRNb2RlO1xuICAgICAgICAgICAgaWYgKHJlY29nbml6ZXJDb25maWcubGFuZ3VhZ2VJZE1vZGUgPT09IFwiQ29udGludW91c1wiKSB7XG4gICAgICAgICAgICAgICAgc3BlZWNoQ29udGV4dExpZE1vZGUgPSBcIkRldGVjdENvbnRpbnVvdXNcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgeyAvLyByZWNvZ25pemVyQ29uZmlnLmxhbmd1YWdlSWRNb2RlID09PSBcIkF0U3RhcnRcIlxuICAgICAgICAgICAgICAgIHNwZWVjaENvbnRleHRMaWRNb2RlID0gXCJEZXRlY3RBdEF1ZGlvU3RhcnRcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcImxhbmd1YWdlSWRcIiwge1xuICAgICAgICAgICAgICAgIFByaW9yaXR5OiBcIlByaW9yaXRpemVMYXRlbmN5XCIsXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VzOiBzb3VyY2VMYW5ndWFnZXMsXG4gICAgICAgICAgICAgICAgbW9kZTogc3BlZWNoQ29udGV4dExpZE1vZGUsXG4gICAgICAgICAgICAgICAgb25TdWNjZXNzOiB7IGFjdGlvbjogXCJSZWNvZ25pemVcIiB9LFxuICAgICAgICAgICAgICAgIG9uVW5rbm93bjogeyBhY3Rpb246IFwiTm9uZVwiIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29udGV4dC5zZXRTZWN0aW9uKFwicGhyYXNlT3V0cHV0XCIsIHtcbiAgICAgICAgICAgICAgICBpbnRlcmltUmVzdWx0czoge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRUeXBlOiBcIkF1dG9cIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGhyYXNlUmVzdWx0czoge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRUeXBlOiBcIkFsd2F5c1wiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjdXN0b21Nb2RlbHMgPSByZWNvZ25pemVyQ29uZmlnLnNvdXJjZUxhbmd1YWdlTW9kZWxzO1xuICAgICAgICAgICAgaWYgKGN1c3RvbU1vZGVscyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcGhyYXNlRGV0ZWN0aW9uLmN1c3RvbU1vZGVscyA9IGN1c3RvbU1vZGVscztcbiAgICAgICAgICAgICAgICBwaHJhc2VEZXRlY3Rpb24ub25JbnRlcmltID0geyBhY3Rpb246IFwiTm9uZVwiIH07XG4gICAgICAgICAgICAgICAgcGhyYXNlRGV0ZWN0aW9uLm9uU3VjY2VzcyA9IHsgYWN0aW9uOiBcIk5vbmVcIiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGlzRW1wdHkgPSAob2JqKSA9PiB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZ3VhcmQtZm9yLWluLCBicmFjZS1zdHlsZVxuICAgICAgICAgICAgZm9yIChjb25zdCB4IGluIG9iaikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoIWlzRW1wdHkocGhyYXNlRGV0ZWN0aW9uKSkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29udGV4dC5zZXRTZWN0aW9uKFwicGhyYXNlRGV0ZWN0aW9uXCIsIHBocmFzZURldGVjdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0U3BlZWNoU2VnbWVudGF0aW9uVGltZW91dCgpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoU2VnbWVudGF0aW9uVGltZW91dCA9IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaF9TZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zLCB1bmRlZmluZWQpO1xuICAgICAgICBpZiAoc3BlZWNoU2VnbWVudGF0aW9uVGltZW91dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBtb2RlID0gdGhpcy5yZWNvZ25pdGlvbk1vZGUgPT09IFJlY29nbml0aW9uTW9kZS5Db252ZXJzYXRpb24gPyBcIkNPTlZFUlNBVElPTlwiIDpcbiAgICAgICAgICAgICAgICB0aGlzLnJlY29nbml0aW9uTW9kZSA9PT0gUmVjb2duaXRpb25Nb2RlLkRpY3RhdGlvbiA/IFwiRElDVEFUSU9OXCIgOiBcIklOVEVSQUNUSVZFXCI7XG4gICAgICAgICAgICBjb25zdCBzZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zID0gcGFyc2VJbnQoc3BlZWNoU2VnbWVudGF0aW9uVGltZW91dCwgMTApO1xuICAgICAgICAgICAgY29uc3QgcGhyYXNlRGV0ZWN0aW9uID0gdGhpcy5wcml2U3BlZWNoQ29udGV4dC5nZXRTZWN0aW9uKFwicGhyYXNlRGV0ZWN0aW9uXCIpO1xuICAgICAgICAgICAgcGhyYXNlRGV0ZWN0aW9uLm1vZGUgPSBtb2RlO1xuICAgICAgICAgICAgcGhyYXNlRGV0ZWN0aW9uW21vZGVdID0ge1xuICAgICAgICAgICAgICAgIHNlZ21lbnRhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBtb2RlOiBcIkN1c3RvbVwiLFxuICAgICAgICAgICAgICAgICAgICBzZWdtZW50YXRpb25TaWxlbmNlVGltZW91dE1zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcInBocmFzZURldGVjdGlvblwiLCBwaHJhc2VEZXRlY3Rpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBhdWRpb1NvdXJjZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU291cmNlO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoQ29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaENvbnRleHQ7XG4gICAgfVxuICAgIGdldCBkeW5hbWljR3JhbW1hcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkR5bmFtaWNHcmFtbWFyO1xuICAgIH1cbiAgICBnZXQgYWdlbnRDb25maWcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBZ2VudENvbmZpZztcbiAgICB9XG4gICAgc2V0IGNvbnZlcnNhdGlvblRyYW5zbGF0b3JUb2tlbih0b2tlbikge1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX1Rva2VuLCB0b2tlbik7XG4gICAgfVxuICAgIHNldCB2b2ljZVByb2ZpbGVUeXBlKHR5cGUpIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3BlYWtlcklkTW9kZSwgdHlwZSk7XG4gICAgfVxuICAgIHNldCBhdXRoZW50aWNhdGlvbihhdXRoKSB7XG4gICAgICAgIHRoaXMucHJpdkF1dGhlbnRpY2F0aW9uID0gdGhpcy5hdXRoZW50aWNhdGlvbjtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGRpc3Bvc2UocmVhc29uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2U7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGNvbm5lY3Rpb24uZGlzcG9zZShyZWFzb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGNvbm5lY3Rpb24gaXMgaW4gYSBiYWQgc3RhdGUuIEJ1dCB3ZSdyZSB0cnlpbmcgdG8ga2lsbCBpdCwgc28uLi5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCBjb25uZWN0aW9uRXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbkV2ZW50cztcbiAgICB9XG4gICAgZ2V0IHNlcnZpY2VFdmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXJ2aWNlRXZlbnRzO1xuICAgIH1cbiAgICBnZXQgcmVjb2duaXRpb25Nb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5yZWNvZ25pdGlvbk1vZGU7XG4gICAgfVxuICAgIHJlY29nbml6ZShyZWNvTW9kZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxCYWNrKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWNvZ25pemVPdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5yZWNvZ25pemVPdmVycmlkZShyZWNvTW9kZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxCYWNrKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDbGVhciB0aGUgZXhpc3RpbmcgY29uZmlndXJhdGlvbiBwcm9taXNlIHRvIGZvcmNlIGEgcmUtdHJhbnNtaXNzaW9uIG9mIGNvbmZpZyBhbmQgY29udGV4dC5cbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucmVjb2duaXRpb25Nb2RlID0gcmVjb01vZGU7XG4gICAgICAgICAgICB0aGlzLnNldFNwZWVjaFNlZ21lbnRhdGlvblRpbWVvdXQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHN1Y2Nlc3NDYWxsYmFjaztcbiAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2sgPSBlcnJvckNhbGxCYWNrO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc3RhcnROZXdSZWNvZ25pdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ubGlzdGVuRm9yU2VydmljZVRlbGVtZXRyeSh0aGlzLnByaXZBdWRpb1NvdXJjZS5ldmVudHMpO1xuICAgICAgICAgICAgLy8gU3RhcnQgdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHNlcnZpY2UuIFRoZSBwcm9taXNlIHRoaXMgd2lsbCBjcmVhdGUgaXMgc3RvcmVkIGFuZCB3aWxsIGJlIHVzZWQgYnkgY29uZmlndXJlQ29ubmVjdGlvbigpLlxuICAgICAgICAgICAgY29uc3QgY29uUHJvbWlzZSA9IHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIGxldCBhdWRpb05vZGU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvU3RyZWFtTm9kZSA9IHlpZWxkIHRoaXMuYXVkaW9Tb3VyY2UuYXR0YWNoKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmF1ZGlvTm9kZUlkKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSB5aWVsZCB0aGlzLmF1ZGlvU291cmNlLmZvcm1hdDtcbiAgICAgICAgICAgICAgICBjb25zdCBkZXZpY2VJbmZvID0geWllbGQgdGhpcy5hdWRpb1NvdXJjZS5kZXZpY2VJbmZvO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzTGl2ZUF1ZGlvID0gZGV2aWNlSW5mby50eXBlICYmIGRldmljZUluZm8udHlwZSA9PT0gdHlwZS5NaWNyb3Bob25lcztcbiAgICAgICAgICAgICAgICBhdWRpb05vZGUgPSBuZXcgUmVwbGF5YWJsZUF1ZGlvTm9kZShhdWRpb1N0cmVhbU5vZGUsIGZvcm1hdC5hdmdCeXRlc1BlclNlYyk7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25BdWRpb1NvdXJjZUF0dGFjaENvbXBsZXRlZChhdWRpb05vZGUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLlNwZWVjaFNlcnZpY2VDb25maWcuQ29udGV4dC5hdWRpbyA9IHsgc291cmNlOiBkZXZpY2VJbmZvIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblN0b3BSZWNvZ25pemluZygpO1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB5aWVsZCBjb25Qcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbkxvY2FsKENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkNvbm5lY3Rpb25GYWlsdXJlLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvblN0YXJ0RXZlbnRBcmdzID0gbmV3IFNlc3Npb25FdmVudEFyZ3ModGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdGFydGVkKHRoaXMucHJpdlJlY29nbml6ZXIsIHNlc3Npb25TdGFydEV2ZW50QXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2b2lkIHRoaXMucmVjZWl2ZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvU2VuZFByb21pc2UgPSB0aGlzLnNlbmRBdWRpbyhhdWRpb05vZGUpO1xuICAgICAgICAgICAgYXVkaW9TZW5kUHJvbWlzZS5jYXRjaCgoZXJyb3IpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uTG9jYWwoQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuUnVudGltZUVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdG9wUmVjb2duaXppbmcoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuYXVkaW9Tb3VyY2UudHVybk9mZigpO1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRGaW5hbEF1ZGlvKCk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3RvcFJlY29nbml6aW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnR1cm5Db21wbGV0aW9uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25uZWN0KCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29ubmVjdEFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0SW1wbCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIChyZWFzb24pID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihyZWFzb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkaXNjb25uZWN0KCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbkxvY2FsKENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3IsIFwiRGlzY29ubmVjdGluZ1wiKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRpc2Nvbm5lY3RPdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5kaXNjb25uZWN0T3ZlcnJpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgKHlpZWxkIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlKS5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIHNlbmRNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzZW5kTmV0d29ya01lc3NhZ2UocGF0aCwgcGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiBwYXlsb2FkID09PSBcInN0cmluZ1wiID8gTWVzc2FnZVR5cGUuVGV4dCA6IE1lc3NhZ2VUeXBlLkJpbmFyeTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gdHlwZW9mIHBheWxvYWQgPT09IFwic3RyaW5nXCIgPyBcImFwcGxpY2F0aW9uL2pzb25cIiA6IFwiXCI7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKHR5cGUsIHBhdGgsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgY29udGVudFR5cGUsIHBheWxvYWQpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNldCBhY3Rpdml0eVRlbXBsYXRlKG1lc3NhZ2VQYXlsb2FkKSB7XG4gICAgICAgIHRoaXMucHJpdkFjdGl2aXR5VGVtcGxhdGUgPSBtZXNzYWdlUGF5bG9hZDtcbiAgICB9XG4gICAgZ2V0IGFjdGl2aXR5VGVtcGxhdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBY3Rpdml0eVRlbXBsYXRlO1xuICAgIH1cbiAgICBzZW5kVGVsZW1ldHJ5RGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbGVtZXRyeURhdGEgPSB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5nZXRUZWxlbWV0cnkoKTtcbiAgICAgICAgICAgIGlmIChTZXJ2aWNlUmVjb2duaXplckJhc2UudGVsZW1ldHJ5RGF0YUVuYWJsZWQgIT09IHRydWUgfHxcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkIHx8XG4gICAgICAgICAgICAgICAgbnVsbCA9PT0gdGVsZW1ldHJ5RGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIVNlcnZpY2VSZWNvZ25pemVyQmFzZS50ZWxlbWV0cnlEYXRhKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgU2VydmljZVJlY29nbml6ZXJCYXNlLnRlbGVtZXRyeURhdGEodGVsZW1ldHJ5RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHlpZWxkIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJ0ZWxlbWV0cnlcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgdGVsZW1ldHJ5RGF0YSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gQ2FuY2VscyByZWNvZ25pdGlvbi5cbiAgICBjYW5jZWxSZWNvZ25pdGlvbkxvY2FsKGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3RvcFJlY29nbml6aW5nKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJlY2VpdmVNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2SXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSdyZSBkb25lLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0geWllbGQgY29ubmVjdGlvbi5yZWFkKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVjZWl2ZU1lc3NhZ2VPdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlY2VpdmVNZXNzYWdlT3ZlcnJpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gaW5kaWNhdGVzIHdlIGFyZSBkcmFpbmluZyB0aGUgcXVldWUgYW5kIGl0IGNhbWUgd2l0aCBubyBtZXNzYWdlO1xuICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U2VydmljZUhhc1NlbnRNZXNzYWdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uTWVzc2FnZSA9IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlLmZyb21Db25uZWN0aW9uTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkLnRvTG93ZXJDYXNlKCkgPT09IHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY29ubmVjdGlvbk1lc3NhZ2UucGF0aC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidHVybi5zdGFydFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk11c3RSZXBvcnRFbmRPZlN0cmVhbSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TZXJ2aWNlVHVyblN0YXJ0UmVzcG9uc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzcGVlY2guc3RhcnRkZXRlY3RlZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNwZWVjaFN0YXJ0RGV0ZWN0ZWQgPSBTcGVlY2hEZXRlY3RlZC5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoU3RhcnRFdmVudEFyZ3MgPSBuZXcgUmVjb2duaXRpb25FdmVudEFyZ3Moc3BlZWNoU3RhcnREZXRlY3RlZC5PZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zcGVlY2hTdGFydERldGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc3BlZWNoU3RhcnREZXRlY3RlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzcGVlY2hTdGFydEV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNwZWVjaC5lbmRkZXRlY3RlZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBqc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSByZXF1ZXN0IHdhcyBlbXB0eSwgdGhlIEpTT04gcmV0dXJuZWQgaXMgZW1wdHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBcInsgT2Zmc2V0OiAwIH1cIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoU3RvcERldGVjdGVkID0gU3BlZWNoRGV0ZWN0ZWQuZnJvbUpTT04oanNvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3BlZWNoU3RvcEV2ZW50QXJncyA9IG5ldyBSZWNvZ25pdGlvbkV2ZW50QXJncyhzcGVlY2hTdG9wRGV0ZWN0ZWQuT2Zmc2V0ICsgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNwZWVjaEVuZERldGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuc3BlZWNoRW5kRGV0ZWN0ZWQodGhpcy5wcml2UmVjb2duaXplciwgc3BlZWNoU3RvcEV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInR1cm4uZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kVGVsZW1ldHJ5RGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1NwZWVjaEVuZGVkICYmIHRoaXMucHJpdk11c3RSZXBvcnRFbmRPZlN0cmVhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNdXN0UmVwb3J0RW5kT2ZTdHJlYW0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbkxvY2FsKENhbmNlbGxhdGlvblJlYXNvbi5FbmRPZlN0cmVhbSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3IsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlc3Npb25TdG9wRXZlbnRBcmdzID0gbmV3IFNlc3Npb25FdmVudEFyZ3ModGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UodGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5pc0NvbnRpbnVvdXNSZWNvZ25pdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLmlzQ29udGludW91c1JlY29nbml0aW9uIHx8IHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzU3BlZWNoRW5kZWQgfHwgIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzUmVjb2duaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RvcHBlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzZXNzaW9uU3RvcEV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFByZVBheWxvYWRKU09OKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoeWllbGQgdGhpcy5wcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoZXJlIGFyZSBzb21lIG1lc3NhZ2VzIHRoYXQgdGhlIGRlcml2ZWQgY2xhc3MgaGFzIG5vdCBwcm9jZXNzZWQsIGRpc3BhdGNoIHRoZW0gdG8gY29ubmVjdCBjbGFzc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTZXJ2aWNlRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2VFdmVudHMub25FdmVudChuZXcgU2VydmljZUV2ZW50KGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kU3BlZWNoQ29udGV4dChjb25uZWN0aW9uLCBnZW5lcmF0ZU5ld1JlcXVlc3RJZCkge1xuICAgICAgICBjb25zdCBzcGVlY2hDb250ZXh0SnNvbiA9IHRoaXMuc3BlZWNoQ29udGV4dC50b0pTT04oKTtcbiAgICAgICAgaWYgKGdlbmVyYXRlTmV3UmVxdWVzdElkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNwZWVjaENvbnRleHQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3BlZWNoQ29udGV4dEpzb24pIHtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwic3BlZWNoLmNvbnRleHRcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgc3BlZWNoQ29udGV4dEpzb24pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIG5vT3AoKSB7XG4gICAgICAgIC8vIG9wZXJhdGlvbiBub3Qgc3VwcG9ydGVkXG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gRW5jYXBzdWxhdGVkIGZvciBkZXJpdmVkIHNlcnZpY2UgcmVjb2duaXplcnMgdGhhdCBuZWVkIHRvIHNlbmQgYWRkaXRpb25hbCBKU09OXG4gICAgc2VuZFByZVBheWxvYWRKU09OKGNvbm5lY3Rpb24sIGdlbmVyYXRlTmV3UmVxdWVzdElkID0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VuZFByZVBheWxvYWRKU09OT3ZlcnJpZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTk92ZXJyaWRlKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3BlZWNoQ29udGV4dChjb25uZWN0aW9uLCBnZW5lcmF0ZU5ld1JlcXVlc3RJZCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRXYXZlSGVhZGVyKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFdhdmVIZWFkZXIoY29ubmVjdGlvbikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0geWllbGQgdGhpcy5hdWRpb1NvdXJjZS5mb3JtYXQ7XG4gICAgICAgICAgICAvLyB0aGlzLndyaXRlQnVmZmVyVG9Db25zb2xlKGZvcm1hdC5oZWFkZXIpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuQmluYXJ5LCBcImF1ZGlvXCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhdWRpby94LXdhdlwiLCBmb3JtYXQuaGVhZGVyKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBFc3RhYmxpc2hlcyBhIHdlYnNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBlbmQgcG9pbnQuXG4gICAgY29ubmVjdEltcGwoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UudGhlbigoY29ubmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLnN0YXRlKCkgPT09IENvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VIYXNTZW50TWVzc2FnZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2U7XG4gICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTZXJ2aWNlSGFzU2VudE1lc3NhZ2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2UgPSB0aGlzLnJldHJ5YWJsZUNvbm5lY3QoKTtcbiAgICAgICAgLy8gQXR0YWNoIGFuIGVtcHR5IGhhbmRsZXIgdG8gYWxsb3cgdGhlIHByb21pc2UgdG8gcnVuIGluIHRoZSBiYWNrZ3JvdW5kIHdoaWxlXG4gICAgICAgIC8vIG90aGVyIHN0YXJ0dXAgZXZlbnRzIGhhcHBlbi4gSXQnbGwgZXZlbnR1YWxseSBiZSBhd2FpdGVkIG9uLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgIGlmICh0aGlzLnBvc3RDb25uZWN0SW1wbE92ZXJyaWRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBvc3RDb25uZWN0SW1wbE92ZXJyaWRlKHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvblByb21pc2U7XG4gICAgfVxuICAgIHNlbmRTcGVlY2hTZXJ2aWNlQ29uZmlnKGNvbm5lY3Rpb24sIHJlcXVlc3RTZXNzaW9uLCBTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbikge1xuICAgICAgICByZXF1ZXN0U2Vzc2lvbi5vblNwZWVjaENvbnRleHQoKTtcbiAgICAgICAgLy8gZmlsdGVyIG91dCBhbnl0aGluZyB0aGF0IGlzIG5vdCByZXF1aXJlZCBmb3IgdGhlIHNlcnZpY2UgdG8gd29yay5cbiAgICAgICAgaWYgKFNlcnZpY2VSZWNvZ25pemVyQmFzZS50ZWxlbWV0cnlEYXRhRW5hYmxlZCAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgY29uc3Qgd2l0aFRlbGVtZXRyeSA9IEpTT04ucGFyc2UoU3BlZWNoU2VydmljZUNvbmZpZ0pzb24pO1xuICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSB7XG4gICAgICAgICAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgICAgICAgICAgICBzeXN0ZW06IHdpdGhUZWxlbWV0cnkuY29udGV4dC5zeXN0ZW0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbiA9IEpTT04uc3RyaW5naWZ5KHJlcGxhY2VtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiZjBmNWRlYmMtZjhjOS00ODkyLWFjNGItOTBhN2FiMzU5ZmQyXCIsIFwiZmFsc2VcIikudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKFNwZWVjaFNlcnZpY2VDb25maWdKc29uKTtcbiAgICAgICAgICAgIGpzb24uY29udGV4dC5EaXNhYmxlUmVmZXJlbmNlQ2hhbm5lbCA9IFwiVHJ1ZVwiO1xuICAgICAgICAgICAganNvbi5jb250ZXh0Lk1pY1NwZWMgPSBcIjFfMF8wXCI7XG4gICAgICAgICAgICBTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbiA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzcGVlY2guY29uZmlnXCIsIHJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uXCIsIFNwZWVjaFNlcnZpY2VDb25maWdKc29uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmZXRjaENvbm5lY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlLnRoZW4oKGNvbm5lY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3RhdGUoKSA9PT0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNlcnZpY2VIYXNTZW50TWVzc2FnZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U2VydmljZUhhc1NlbnRNZXNzYWdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlID0gdGhpcy5jb25maWd1cmVDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZEF1ZGlvKGF1ZGlvU3RyZWFtTm9kZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgYXVkaW9Gb3JtYXQgPSB5aWVsZCB0aGlzLmF1ZGlvU291cmNlLmZvcm1hdDtcbiAgICAgICAgICAgIC8vIFRoZSB0aW1lIHdlIGxhc3Qgc2VudCBkYXRhIHRvIHRoZSBzZXJ2aWNlLlxuICAgICAgICAgICAgbGV0IG5leHRTZW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICAvLyBNYXggYW1vdW50IHRvIHNlbmQgYmVmb3JlIHdlIHN0YXJ0IHRvIHRocm90dGxlXG4gICAgICAgICAgICBjb25zdCBmYXN0TGFuZVNpemVNcyA9IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1UcmFuc21pdExlbmd0aEJlZm9yVGhyb3R0bGVNc1wiLCBcIjUwMDBcIik7XG4gICAgICAgICAgICBjb25zdCBtYXhTZW5kVW50aHJvdHRsZWRCeXRlcyA9IGF1ZGlvRm9ybWF0LmF2Z0J5dGVzUGVyU2VjIC8gMTAwMCAqIHBhcnNlSW50KGZhc3RMYW5lU2l6ZU1zLCAxMCk7XG4gICAgICAgICAgICBjb25zdCBzdGFydFJlY29nTnVtYmVyID0gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVjb2dOdW1iZXI7XG4gICAgICAgICAgICBjb25zdCByZWFkQW5kVXBsb2FkQ3ljbGUgPSAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgc3BlZWNoIGlzIGRvbmUsIHN0b3Agc2VuZGluZyBhdWRpby5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzRGlzcG9zZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgIXRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzU3BlZWNoRW5kZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZyAmJlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZWNvZ051bWJlciA9PT0gc3RhcnRSZWNvZ051bWJlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW9TdHJlYW1DaHVuayA9IHlpZWxkIGF1ZGlvU3RyZWFtTm9kZS5yZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIGhhdmUgYSBuZXcgYXVkaW8gY2h1bmsgdG8gdXBsb2FkLlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNTcGVlY2hFbmRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc2VydmljZSBhbHJlYWR5IHJlY29nbml6ZWQgYXVkaW8gZW5kIHRoZW4gZG9uJ3Qgc2VuZCBhbnkgbW9yZSBhdWRpb1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXlsb2FkO1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2VuZERlbGF5O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWF1ZGlvU3RyZWFtQ2h1bmsgfHwgYXVkaW9TdHJlYW1DaHVuay5pc0VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kRGVsYXkgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF5bG9hZCA9IGF1ZGlvU3RyZWFtQ2h1bmsuYnVmZmVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25BdWRpb1NlbnQocGF5bG9hZC5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXhTZW5kVW50aHJvdHRsZWRCeXRlcyA+PSB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5ieXRlc1NlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kRGVsYXkgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VuZERlbGF5ID0gTWF0aC5tYXgoMCwgbmV4dFNlbmRUaW1lIC0gRGF0ZS5ub3coKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT09IHNlbmREZWxheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5kZWxheShzZW5kRGVsYXkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0U2VuZFRpbWUgPSBEYXRlLm5vdygpICsgKHBheWxvYWQuYnl0ZUxlbmd0aCAqIDEwMDAgLyAoYXVkaW9Gb3JtYXQuYXZnQnl0ZXNQZXJTZWMgKiAyKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gQXJlIHdlIHN0aWxsIGFsaXZlP1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzRGlzcG9zZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICF0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1NwZWVjaEVuZGVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5pc1JlY29nbml6aW5nICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZWNvZ051bWJlciA9PT0gc3RhcnRSZWNvZ051bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5CaW5hcnksIFwiYXVkaW9cIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBudWxsLCBwYXlsb2FkKSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UodGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5pc0NvbnRpbnVvdXNSZWNvZ25pdGlvbikuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoYXVkaW9TdHJlYW1DaHVuayA9PT0gbnVsbCB8fCBhdWRpb1N0cmVhbUNodW5rID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhdWRpb1N0cmVhbUNodW5rLmlzRW5kKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMud3JpdGVCdWZmZXJUb0NvbnNvbGUocGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVnYXJkbGVzcyBvZiBzdWNjZXNzIG9yIGZhaWx1cmUsIHNjaGVkdWxlIHRoZSBuZXh0IHVwbG9hZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgdW5kZXJseWluZyBjb25uZWN0aW9uIHdhcyBicm9rZW4sIHRoZSBuZXh0IGN5Y2xlIHdpbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgYSBuZXcgY29ubmVjdGlvbiBhbmQgcmUtdHJhbnNtaXQgbWlzc2luZyBhdWRpbyBhdXRvbWF0aWNhbGx5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWFkQW5kVXBsb2FkQ3ljbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBhdWRpbyBzdHJlYW0gaGFzIGJlZW4gY2xvc2VkLCBubyBuZWVkIHRvIHNjaGVkdWxlIG5leHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWFkLXVwbG9hZCBjeWNsZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzTGl2ZUF1ZGlvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3BlZWNoRW5kZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZWFkQW5kVXBsb2FkQ3ljbGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHJ5YWJsZUNvbm5lY3QoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBsZXQgaXNVbkF1dGhvcml6ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uSWQgPSB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSAoc2Vzc2lvbklkICE9PSB1bmRlZmluZWQpID8gc2Vzc2lvbklkIDogY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25QcmVDb25uZWN0aW9uU3RhcnQodGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCwgdGhpcy5wcml2Q29ubmVjdGlvbklkKTtcbiAgICAgICAgICAgIGxldCBsYXN0U3RhdHVzQ29kZSA9IDA7XG4gICAgICAgICAgICBsZXQgbGFzdFJlYXNvbiA9IFwiXCI7XG4gICAgICAgICAgICB3aGlsZSAodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ubnVtQ29ubmVjdGlvbkF0dGVtcHRzIDw9IHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcubWF4UmV0cnlDb3VudCkge1xuICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgYXV0aCBpbmZvcm1hdGlvbiBmb3IgdGhlIGNvbm5lY3Rpb24uIFRoaXMgaXMgYSBiaXQgb2Ygb3ZlcmtpbGwgZm9yIHRoZSBjdXJyZW50IEFQSSBzdXJmYWNlLCBidXQgbGVhdmluZyB0aGUgcGx1bWJpbmcgaW4gcGxhY2UgdG8gYmUgYWJsZSB0byByYWlzZSBhIGRldmVsb3Blci1jdXN0b21lclxuICAgICAgICAgICAgICAgIC8vIGZhY2luZyBldmVudCB3aGVuIGEgY29ubmVjdGlvbiBmYWlscyB0byBsZXQgdGhlbSB0cnkgYW5kIHByb3ZpZGUgbmV3IGF1dGggaW5mb3JtYXRpb24uXG4gICAgICAgICAgICAgICAgY29uc3QgYXV0aFByb21pc2UgPSBpc1VuQXV0aG9yaXplZCA/IHRoaXMucHJpdkF1dGhlbnRpY2F0aW9uLmZldGNoT25FeHBpcnkodGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCkgOiB0aGlzLnByaXZBdXRoZW50aWNhdGlvbi5mZXRjaCh0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhdXRoID0geWllbGQgYXV0aFByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25BdXRoQ29tcGxldGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGNvbm5lY3Rpb25cbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0gdGhpcy5wcml2Q29ubmVjdGlvbkZhY3RvcnkuY3JlYXRlKHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcsIGF1dGgsIHRoaXMucHJpdkNvbm5lY3Rpb25JZCk7XG4gICAgICAgICAgICAgICAgLy8gQXR0YWNoIHRoZSB0ZWxlbWV0cnkgaGFuZGxlcnMuXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ubGlzdGVuRm9yU2VydmljZVRlbGVtZXRyeShjb25uZWN0aW9uLmV2ZW50cyk7XG4gICAgICAgICAgICAgICAgLy8gQXR0YWNoIHRvIHRoZSB1bmRlcmx5aW5nIGV2ZW50LiBObyBuZWVkIHRvIGhvbGQgb250byB0aGUgZGV0YWNoIHBvaW50ZXJzIGFzIGluIHRoZSBldmVudCB0aGUgY29ubmVjdGlvbiBnb2VzIGF3YXksXG4gICAgICAgICAgICAgICAgLy8gaXQnbGwgc3RvcCBzZW5kaW5nIGV2ZW50cy5cbiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLmV2ZW50cy5hdHRhY2goKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkV2ZW50cy5vbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IHlpZWxkIGNvbm5lY3Rpb24ub3BlbigpO1xuICAgICAgICAgICAgICAgIC8vIDIwMCA9PSBldmVyeXRoaW5nIGlzIGZpbmUuXG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vbkNvbm5lY3Rpb25Fc3RhYmxpc2hDb21wbGV0ZWQocmVzcG9uc2Uuc3RhdHVzQ29kZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY29ubmVjdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPT09IDEwMDYpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNVbkF1dGhvcml6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsYXN0U3RhdHVzQ29kZSA9IHJlc3BvbnNlLnN0YXR1c0NvZGU7XG4gICAgICAgICAgICAgICAgbGFzdFJlYXNvbiA9IHJlc3BvbnNlLnJlYXNvbjtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblJldHJ5Q29ubmVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25Db25uZWN0aW9uRXN0YWJsaXNoQ29tcGxldGVkKGxhc3RTdGF0dXNDb2RlLCBsYXN0UmVhc29uKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgVW5hYmxlIHRvIGNvbnRhY3Qgc2VydmVyLiBTdGF0dXNDb2RlOiAke2xhc3RTdGF0dXNDb2RlfSwgJHt0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCl9IFJlYXNvbjogJHtsYXN0UmVhc29ufWApO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGVsYXkoZGVsYXlNcykge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHRoaXMucHJpdlNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXlNcykpO1xuICAgIH1cbiAgICB3cml0ZUJ1ZmZlclRvQ29uc29sZShidWZmZXIpIHtcbiAgICAgICAgbGV0IG91dCA9IFwiQnVmZmVyIFNpemU6IFwiO1xuICAgICAgICBpZiAobnVsbCA9PT0gYnVmZmVyKSB7XG4gICAgICAgICAgICBvdXQgKz0gXCJudWxsXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByZWFkVmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgICAgICAgICBvdXQgKz0gYCR7YnVmZmVyLmJ5dGVMZW5ndGh9XFxyXFxuYDtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnVmZmVyLmJ5dGVMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCArPSByZWFkVmlld1tpXS50b1N0cmluZygxNikucGFkU3RhcnQoMiwgXCIwXCIpICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgaWYgKCgoaSArIDEpICUgMTYpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhvdXQpO1xuICAgICAgICAgICAgICAgICAgICBvdXQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICBjb25zb2xlLmluZm8ob3V0KTtcbiAgICB9XG4gICAgc2VuZEZpbmFsQXVkaW8oKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHlpZWxkIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuQmluYXJ5LCBcImF1ZGlvXCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgbnVsbCwgbnVsbCkpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gVGFrZXMgYW4gZXN0YWJsaXNoZWQgd2Vic29ja2V0IGNvbm5lY3Rpb24gdG8gdGhlIGVuZHBvaW50IGFuZCBzZW5kcyBzcGVlY2ggY29uZmlndXJhdGlvbiBpbmZvcm1hdGlvbi5cbiAgICBjb25maWd1cmVDb25uZWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZ0Nvbm5lY3Rpb25PdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnQ29ubmVjdGlvbk92ZXJyaWRlKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3BlZWNoU2VydmljZUNvbmZpZyhjb25uZWN0aW9uLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbiwgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5TcGVlY2hTZXJ2aWNlQ29uZmlnLnNlcmlhbGl6ZSgpKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFByZVBheWxvYWRKU09OKGNvbm5lY3Rpb24sIGZhbHNlKTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5TZXJ2aWNlUmVjb2duaXplckJhc2UudGVsZW1ldHJ5RGF0YUVuYWJsZWQgPSB0cnVlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TZXJ2aWNlUmVjb2duaXplckJhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBBdWRpb1NvdXJjZUVycm9yRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGVkRXZlbnQsIEF1ZGlvU3RyZWFtTm9kZUF0dGFjaGluZ0V2ZW50LCBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50LCBBdWRpb1N0cmVhbU5vZGVFcnJvckV2ZW50LCBDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudCwgQ29ubmVjdGlvbkVzdGFibGlzaEVycm9yRXZlbnQsIENvbm5lY3Rpb25NZXNzYWdlUmVjZWl2ZWRFdmVudCwgQ29ubmVjdGlvblN0YXJ0RXZlbnQsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW5nVG9TZXJ2aWNlRXZlbnQsIFJlY29nbml0aW9uVHJpZ2dlcmVkRXZlbnQgfSBmcm9tIFwiLi9SZWNvZ25pdGlvbkV2ZW50c1wiO1xuZXhwb3J0IGNsYXNzIFNlcnZpY2VUZWxlbWV0cnlMaXN0ZW5lciB7XG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCkge1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkxpc3RlbmluZ1RyaWdnZXJNZXRyaWMgPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZNaWNNZXRyaWMgPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoTWV0cmljID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICB0aGlzLnByaXZBdWRpb1NvdXJjZUlkID0gYXVkaW9Tb3VyY2VJZDtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Ob2RlSWQgPSBhdWRpb05vZGVJZDtcbiAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlcyA9IHt9O1xuICAgICAgICB0aGlzLnByaXZQaHJhc2VMYXRlbmNpZXMgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2SHlwb3RoZXNpc0xhdGVuY2llcyA9IFtdO1xuICAgIH1cbiAgICBwaHJhc2VSZWNlaXZlZChhdWRpb1JlY2VpdmVkVGltZSkge1xuICAgICAgICBpZiAoYXVkaW9SZWNlaXZlZFRpbWUgPiAwKSB7IC8vIDAgaW5kaWNhdGVzIHRoZSB0aW1lIGlzIHVua25vd24uIERyb3AgaXQuXG4gICAgICAgICAgICB0aGlzLnByaXZQaHJhc2VMYXRlbmNpZXMucHVzaChEYXRlLm5vdygpIC0gYXVkaW9SZWNlaXZlZFRpbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGh5cG90aGVzaXNSZWNlaXZlZChhdWRpb1JlY2VpdmVkVGltZSkge1xuICAgICAgICBpZiAoYXVkaW9SZWNlaXZlZFRpbWUgPiAwKSB7IC8vIDAgaW5kaWNhdGVzIHRoZSB0aW1lIGlzIHVua25vd24uIERyb3AgaXQuXG4gICAgICAgICAgICB0aGlzLnByaXZIeXBvdGhlc2lzTGF0ZW5jaWVzLnB1c2goRGF0ZS5ub3coKSAtIGF1ZGlvUmVjZWl2ZWRUaW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkV2ZW50KGUpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFJlY29nbml0aW9uVHJpZ2dlcmVkRXZlbnQgJiYgZS5yZXF1ZXN0SWQgPT09IHRoaXMucHJpdlJlcXVlc3RJZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2TGlzdGVuaW5nVHJpZ2dlck1ldHJpYyA9IHtcbiAgICAgICAgICAgICAgICBFbmQ6IGUuZXZlbnRUaW1lLFxuICAgICAgICAgICAgICAgIE5hbWU6IFwiTGlzdGVuaW5nVHJpZ2dlclwiLFxuICAgICAgICAgICAgICAgIFN0YXJ0OiBlLmV2ZW50VGltZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCAmJiBlLmF1ZGlvU291cmNlSWQgPT09IHRoaXMucHJpdkF1ZGlvU291cmNlSWQgJiYgZS5hdWRpb05vZGVJZCA9PT0gdGhpcy5wcml2QXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdk1pY1N0YXJ0VGltZSA9IGUuZXZlbnRUaW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCAmJiBlLmF1ZGlvU291cmNlSWQgPT09IHRoaXMucHJpdkF1ZGlvU291cmNlSWQgJiYgZS5hdWRpb05vZGVJZCA9PT0gdGhpcy5wcml2QXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdk1pY1N0YXJ0VGltZSA9IGUuZXZlbnRUaW1lO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQXVkaW9Tb3VyY2VFcnJvckV2ZW50ICYmIGUuYXVkaW9Tb3VyY2VJZCA9PT0gdGhpcy5wcml2QXVkaW9Tb3VyY2VJZCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZNaWNNZXRyaWMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZNaWNNZXRyaWMgPSB7XG4gICAgICAgICAgICAgICAgICAgIEVuZDogZS5ldmVudFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIEVycm9yOiBlLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICBOYW1lOiBcIk1pY3JvcGhvbmVcIixcbiAgICAgICAgICAgICAgICAgICAgU3RhcnQ6IHRoaXMucHJpdk1pY1N0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQXVkaW9TdHJlYW1Ob2RlRXJyb3JFdmVudCAmJiBlLmF1ZGlvU291cmNlSWQgPT09IHRoaXMucHJpdkF1ZGlvU291cmNlSWQgJiYgZS5hdWRpb05vZGVJZCA9PT0gdGhpcy5wcml2QXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2TWljTWV0cmljKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWljTWV0cmljID0ge1xuICAgICAgICAgICAgICAgICAgICBFbmQ6IGUuZXZlbnRUaW1lLFxuICAgICAgICAgICAgICAgICAgICBFcnJvcjogZS5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgTmFtZTogXCJNaWNyb3Bob25lXCIsXG4gICAgICAgICAgICAgICAgICAgIFN0YXJ0OiB0aGlzLnByaXZNaWNTdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEF1ZGlvU3RyZWFtTm9kZURldGFjaGVkRXZlbnQgJiYgZS5hdWRpb1NvdXJjZUlkID09PSB0aGlzLnByaXZBdWRpb1NvdXJjZUlkICYmIGUuYXVkaW9Ob2RlSWQgPT09IHRoaXMucHJpdkF1ZGlvTm9kZUlkKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdk1pY01ldHJpYykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk1pY01ldHJpYyA9IHtcbiAgICAgICAgICAgICAgICAgICAgRW5kOiBlLmV2ZW50VGltZSxcbiAgICAgICAgICAgICAgICAgICAgTmFtZTogXCJNaWNyb3Bob25lXCIsXG4gICAgICAgICAgICAgICAgICAgIFN0YXJ0OiB0aGlzLnByaXZNaWNTdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIENvbm5lY3RpbmdUb1NlcnZpY2VFdmVudCAmJiBlLnJlcXVlc3RJZCA9PT0gdGhpcy5wcml2UmVxdWVzdElkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBlLnNlc3Npb25JZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIENvbm5lY3Rpb25TdGFydEV2ZW50ICYmIGUuY29ubmVjdGlvbklkID09PSB0aGlzLnByaXZDb25uZWN0aW9uSWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25TdGFydFRpbWUgPSBlLmV2ZW50VGltZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIENvbm5lY3Rpb25Fc3RhYmxpc2hlZEV2ZW50ICYmIGUuY29ubmVjdGlvbklkID09PSB0aGlzLnByaXZDb25uZWN0aW9uSWQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Fc3RhYmxpc2hNZXRyaWMgPSB7XG4gICAgICAgICAgICAgICAgICAgIEVuZDogZS5ldmVudFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIElkOiB0aGlzLnByaXZDb25uZWN0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgIE5hbWU6IFwiQ29ubmVjdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICBTdGFydDogdGhpcy5wcml2Q29ubmVjdGlvblN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQ29ubmVjdGlvbkVzdGFibGlzaEVycm9yRXZlbnQgJiYgZS5jb25uZWN0aW9uSWQgPT09IHRoaXMucHJpdkNvbm5lY3Rpb25JZCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoTWV0cmljKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYyA9IHtcbiAgICAgICAgICAgICAgICAgICAgRW5kOiBlLmV2ZW50VGltZSxcbiAgICAgICAgICAgICAgICAgICAgRXJyb3I6IHRoaXMuZ2V0Q29ubmVjdGlvbkVycm9yKGUuc3RhdHVzQ29kZSksXG4gICAgICAgICAgICAgICAgICAgIElkOiB0aGlzLnByaXZDb25uZWN0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgIE5hbWU6IFwiQ29ubmVjdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICBTdGFydDogdGhpcy5wcml2Q29ubmVjdGlvblN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQ29ubmVjdGlvbk1lc3NhZ2VSZWNlaXZlZEV2ZW50ICYmIGUuY29ubmVjdGlvbklkID09PSB0aGlzLnByaXZDb25uZWN0aW9uSWQpIHtcbiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UgJiYgZS5tZXNzYWdlLmhlYWRlcnMgJiYgZS5tZXNzYWdlLmhlYWRlcnMucGF0aCkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlc1tlLm1lc3NhZ2UuaGVhZGVycy5wYXRoXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNlaXZlZE1lc3NhZ2VzW2UubWVzc2FnZS5oZWFkZXJzLnBhdGhdID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG1heE1lc3NhZ2VzVG9TZW5kID0gNTA7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlJlY2VpdmVkTWVzc2FnZXNbZS5tZXNzYWdlLmhlYWRlcnMucGF0aF0ubGVuZ3RoIDwgbWF4TWVzc2FnZXNUb1NlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlc1tlLm1lc3NhZ2UuaGVhZGVycy5wYXRoXS5wdXNoKGUubmV0d29ya1JlY2VpdmVkVGltZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGdldFRlbGVtZXRyeSgpIHtcbiAgICAgICAgY29uc3QgbWV0cmljcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBpZiAodGhpcy5wcml2TGlzdGVuaW5nVHJpZ2dlck1ldHJpYykge1xuICAgICAgICAgICAgbWV0cmljcy5wdXNoKHRoaXMucHJpdkxpc3RlbmluZ1RyaWdnZXJNZXRyaWMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZNaWNNZXRyaWMpIHtcbiAgICAgICAgICAgIG1ldHJpY3MucHVzaCh0aGlzLnByaXZNaWNNZXRyaWMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoTWV0cmljKSB7XG4gICAgICAgICAgICBtZXRyaWNzLnB1c2godGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdlBocmFzZUxhdGVuY2llcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBtZXRyaWNzLnB1c2goe1xuICAgICAgICAgICAgICAgIFBocmFzZUxhdGVuY3lNczogdGhpcy5wcml2UGhyYXNlTGF0ZW5jaWVzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdkh5cG90aGVzaXNMYXRlbmNpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWV0cmljcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBGaXJzdEh5cG90aGVzaXNMYXRlbmN5TXM6IHRoaXMucHJpdkh5cG90aGVzaXNMYXRlbmNpZXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0ZWxlbWV0cnkgPSB7XG4gICAgICAgICAgICBNZXRyaWNzOiBtZXRyaWNzLFxuICAgICAgICAgICAgUmVjZWl2ZWRNZXNzYWdlczogdGhpcy5wcml2UmVjZWl2ZWRNZXNzYWdlcyxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KHRlbGVtZXRyeSk7XG4gICAgICAgIC8vIFdlIGRvbnQgd2FudCB0byBzZW5kIHRoZSBzYW1lIHRlbGVtZXRyeSBhZ2Fpbi4gU28gY2xlYW4gdGhvc2Ugb3V0LlxuICAgICAgICB0aGlzLnByaXZSZWNlaXZlZE1lc3NhZ2VzID0ge307XG4gICAgICAgIHRoaXMucHJpdkxpc3RlbmluZ1RyaWdnZXJNZXRyaWMgPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZNaWNNZXRyaWMgPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRXN0YWJsaXNoTWV0cmljID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2UGhyYXNlTGF0ZW5jaWVzID0gW107XG4gICAgICAgIHRoaXMucHJpdkh5cG90aGVzaXNMYXRlbmNpZXMgPSBbXTtcbiAgICAgICAgcmV0dXJuIGpzb247XG4gICAgfVxuICAgIC8vIERldGVybWluZXMgaWYgdGhlcmUgYXJlIGFueSB0ZWxlbWV0cnkgZXZlbnRzIHRvIHNlbmQgdG8gdGhlIHNlcnZpY2UuXG4gICAgZ2V0IGhhc1RlbGVtZXRyeSgpIHtcbiAgICAgICAgcmV0dXJuIChPYmplY3Qua2V5cyh0aGlzLnByaXZSZWNlaXZlZE1lc3NhZ2VzKS5sZW5ndGggIT09IDAgfHxcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3RlbmluZ1RyaWdnZXJNZXRyaWMgIT09IG51bGwgfHxcbiAgICAgICAgICAgIHRoaXMucHJpdk1pY01ldHJpYyAhPT0gbnVsbCB8fFxuICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkVzdGFibGlzaE1ldHJpYyAhPT0gbnVsbCB8fFxuICAgICAgICAgICAgdGhpcy5wcml2UGhyYXNlTGF0ZW5jaWVzLmxlbmd0aCAhPT0gMCB8fFxuICAgICAgICAgICAgdGhpcy5wcml2SHlwb3RoZXNpc0xhdGVuY2llcy5sZW5ndGggIT09IDApO1xuICAgIH1cbiAgICBkaXNwb3NlKCkge1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICB9XG4gICAgZ2V0Q29ubmVjdGlvbkVycm9yKHN0YXR1c0NvZGUpIHtcbiAgICAgICAgLypcbiAgICAgICAgLS0gV2Vic29ja2V0IHN0YXR1cyBjb2RlcyAtLVxuICAgICAgICBOb3JtYWxDbG9zdXJlID0gMTAwMCxcbiAgICAgICAgRW5kcG9pbnRVbmF2YWlsYWJsZSA9IDEwMDEsXG4gICAgICAgIFByb3RvY29sRXJyb3IgPSAxMDAyLFxuICAgICAgICBJbnZhbGlkTWVzc2FnZVR5cGUgPSAxMDAzLFxuICAgICAgICBFbXB0eSA9IDEwMDUsXG4gICAgICAgIEludmFsaWRQYXlsb2FkRGF0YSA9IDEwMDcsXG4gICAgICAgIFBvbGljeVZpb2xhdGlvbiA9IDEwMDgsXG4gICAgICAgIE1lc3NhZ2VUb29CaWcgPSAxMDA5LFxuICAgICAgICBNYW5kYXRvcnlFeHRlbnNpb24gPSAxMDEwLFxuICAgICAgICBJbnRlcm5hbFNlcnZlckVycm9yID0gMTAxMVxuICAgICAgICAqL1xuICAgICAgICBzd2l0Y2ggKHN0YXR1c0NvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgNDAwOlxuICAgICAgICAgICAgY2FzZSAxMDAyOlxuICAgICAgICAgICAgY2FzZSAxMDAzOlxuICAgICAgICAgICAgY2FzZSAxMDA1OlxuICAgICAgICAgICAgY2FzZSAxMDA3OlxuICAgICAgICAgICAgY2FzZSAxMDA4OlxuICAgICAgICAgICAgY2FzZSAxMDA5OiByZXR1cm4gXCJCYWRSZXF1ZXN0XCI7XG4gICAgICAgICAgICBjYXNlIDQwMTogcmV0dXJuIFwiVW5hdXRob3JpemVkXCI7XG4gICAgICAgICAgICBjYXNlIDQwMzogcmV0dXJuIFwiRm9yYmlkZGVuXCI7XG4gICAgICAgICAgICBjYXNlIDUwMzpcbiAgICAgICAgICAgIGNhc2UgMTAwMTogcmV0dXJuIFwiU2VydmVyVW5hdmFpbGFibGVcIjtcbiAgICAgICAgICAgIGNhc2UgNTAwOlxuICAgICAgICAgICAgY2FzZSAxMDExOiByZXR1cm4gXCJTZXJ2ZXJFcnJvclwiO1xuICAgICAgICAgICAgY2FzZSA0MDg6XG4gICAgICAgICAgICBjYXNlIDUwNDogcmV0dXJuIFwiVGltZW91dFwiO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIFwic3RhdHVzY29kZTpcIiArIHN0YXR1c0NvZGUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2VydmljZVRlbGVtZXRyeUxpc3RlbmVyLkludGVybmFsLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIFNwZWFrZXJSZWNvZ25pdGlvbkNvbmZpZyB7XG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgcGFyYW1ldGVycykge1xuICAgICAgICB0aGlzLnByaXZDb250ZXh0ID0gY29udGV4dCA/IGNvbnRleHQgOiBuZXcgQ29udGV4dChudWxsKTtcbiAgICAgICAgdGhpcy5wcml2UGFyYW1ldGVycyA9IHBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGdldCBwYXJhbWV0ZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFyYW1ldGVycztcbiAgICB9XG4gICAgZ2V0IENvbnRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb250ZXh0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclJlY29nbml0aW9uQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uLCB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuY2xhc3MgU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnlCYXNlIGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgZW5kcG9pbnRQYXRoLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgbGV0IGVuZHBvaW50ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCk7XG4gICAgICAgIGlmICghZW5kcG9pbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uKTtcbiAgICAgICAgICAgIGNvbnN0IGhvc3RTdWZmaXggPSBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pO1xuICAgICAgICAgICAgY29uc3QgaG9zdCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdCwgYHdzczovLyR7cmVnaW9ufS5zcHItZnJvbnRlbmQuc3BlZWNoJHtob3N0U3VmZml4fWApO1xuICAgICAgICAgICAgY29uc3Qgc2NlbmFyaW8gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1NwZWFrZXJJZE1vZGUsIFwiVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb25cIik7XG4gICAgICAgICAgICBlbmRwb2ludCA9IGAke2hvc3R9L3NwZWFrZXIvd3MvJHt0aGlzLnNjZW5hcmlvVG9QYXRoKHNjZW5hcmlvKX0vJHtlbmRwb2ludFBhdGh9YDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHtcbiAgICAgICAgICAgIGZvcm1hdDogXCJzaW1wbGVcIixcbiAgICAgICAgICAgIGxhbmd1YWdlOiBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSksXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2V0Q29tbW9uVXJsUGFyYW1zKGNvbmZpZywgcXVlcnlQYXJhbXMsIGVuZHBvaW50KTtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAoYXV0aEluZm8udG9rZW4gIT09IHVuZGVmaW5lZCAmJiBhdXRoSW5mby50b2tlbiAhPT0gXCJcIikge1xuICAgICAgICAgICAgaGVhZGVyc1thdXRoSW5mby5oZWFkZXJOYW1lXSA9IGF1dGhJbmZvLnRva2VuO1xuICAgICAgICB9XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuQ29ubmVjdGlvbklkXSA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5TcElEQXV0aEtleV0gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSk7XG4gICAgICAgIGNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG4gICAgc2NlbmFyaW9Ub1BhdGgobW9kZSkge1xuICAgICAgICBzd2l0Y2ggKG1vZGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJUZXh0SW5kZXBlbmRlbnRWZXJpZmljYXRpb25cIjpcbiAgICAgICAgICAgIGNhc2UgXCIyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidmVyaWZpY2F0aW9uL3RleHQtaW5kZXBlbmRlbnRcIjtcbiAgICAgICAgICAgIGNhc2UgXCJUZXh0RGVwZW5kZW50VmVyaWZpY2F0aW9uXCI6XG4gICAgICAgICAgICBjYXNlIFwiMVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInZlcmlmaWNhdGlvbi90ZXh0LWRlcGVuZGVudFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJpZGVudGlmaWNhdGlvbi90ZXh0LWluZGVwZW5kZW50XCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnQgY2xhc3MgU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnkgZXh0ZW5kcyBTcGVha2VyUmVjb2duaXRpb25Db25uZWN0aW9uRmFjdG9yeUJhc2Uge1xuICAgIGNyZWF0ZShjb25maWcsIGF1dGhJbmZvLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNyZWF0ZShjb25maWcsIGF1dGhJbmZvLCBcInJlY29nbml0aW9uXCIsIGNvbm5lY3Rpb25JZCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZUNvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgU3BlYWtlclJlY29nbml0aW9uQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5jcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgXCJwcm9maWxlXCIsIGNvbm5lY3Rpb25JZCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVha2VyUmVjb2duaXRpb25Db25uZWN0aW9uRmFjdG9yeS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBSZXBsYXlhYmxlQXVkaW9Ob2RlIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IERlZmVycmVkLCBNZXNzYWdlVHlwZSwgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBTcGVha2VyUmVjb2duaXRpb25SZXN1bHQsIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgUmVzdWx0UmVhc29uLCBTZXNzaW9uRXZlbnRBcmdzLCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBTZXJ2aWNlUmVjb2duaXplckJhc2UsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UgfSBmcm9tIFwiLi9TcGVlY2hDb25uZWN0aW9uTWVzc2FnZS5JbnRlcm5hbFwiO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5leHBvcnQgY2xhc3MgU3BlYWtlclNlcnZpY2VSZWNvZ25pemVyIGV4dGVuZHMgU2VydmljZVJlY29nbml6ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCByZWNvZ25pemVyKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpO1xuICAgICAgICB0aGlzLnByaXZTcGVha2VyUmVjb2duaXplciA9IHJlY29nbml6ZXI7XG4gICAgICAgIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZSA9IGF1ZGlvU291cmNlO1xuICAgICAgICB0aGlzLnJlY29nbml6ZVNwZWFrZXIgPSAobW9kZWwpID0+IHRoaXMucmVjb2duaXplU3BlYWtlck9uY2UobW9kZWwpO1xuICAgICAgICB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTk92ZXJyaWRlID0gKCkgPT4gdGhpcy5ub09wKCk7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICBsZXQgcHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHJlc3VsdFByb3BzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgIHJlc3VsdFByb3BzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgY2FzZSBcInNwZWFrZXIucmVzcG9uc2VcIjpcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cy5zdGF0dXNDb2RlLnRvTG93ZXJDYXNlKCkgIT09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBTcGVha2VyUmVjb2duaXRpb25SZXN1bHQocmVzcG9uc2UsIFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlNlcnZpY2VFcnJvciwgcmVzcG9uc2Uuc3RhdHVzLnJlYXNvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0KHJlc3BvbnNlLCBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWFrZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZXN1bHREZWZlcnJhbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXN1bHREZWZlcnJhbC5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlZmZlcmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIGRlZmZlcmFsLnJlc29sdmUocHJvY2Vzc2VkKTtcbiAgICAgICAgcmV0dXJuIGRlZmZlcmFsLnByb21pc2U7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb24oc2Vzc2lvbklkLCByZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2Vycm9yQ29kZV0pO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZSZXN1bHREZWZlcnJhbCkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdCh7XG4gICAgICAgICAgICAgICAgc2NlbmFyaW86IHRoaXMucHJpdlNwZWFrZXJNb2RlbC5zY2VuYXJpbyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHsgc3RhdHVzQ29kZTogZXJyb3IsIHJlYXNvbjogZXJyb3IgfVxuICAgICAgICAgICAgfSwgUmVzdWx0UmVhc29uLkNhbmNlbGVkLCBlcnJvckNvZGUsIGVycm9yKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZWNvZ25pemVTcGVha2VyT25jZShtb2RlbCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlYWtlck1vZGVsID0gbW9kZWw7XG4gICAgICAgICAgICB0aGlzLnZvaWNlUHJvZmlsZVR5cGUgPSBtb2RlbC5zY2VuYXJpbztcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2UmVzdWx0RGVmZXJyYWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXN1bHREZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc3RhcnROZXdSZWNvZ25pdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ubGlzdGVuRm9yU2VydmljZVRlbGVtZXRyeSh0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UuZXZlbnRzKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXJDb25maWcucGFyYW1ldGVycy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaF9TZXNzaW9uSWQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAvLyBTdGFydCB0aGUgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS4gVGhlIHByb21pc2UgdGhpcyB3aWxsIGNyZWF0ZSBpcyBzdG9yZWQgYW5kIHdpbGwgYmUgdXNlZCBieSBjb25maWd1cmVDb25uZWN0aW9uKCkuXG4gICAgICAgICAgICBjb25zdCBjb25Qcm9taXNlID0gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgY29uc3QgcHJlQXVkaW9Qcm9taXNlID0gdGhpcy5zZW5kUHJlQXVkaW9NZXNzYWdlcyh0aGlzLmV4dHJhY3RTcGVha2VyQ29udGV4dChtb2RlbCkpO1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHlpZWxkIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZS5hdHRhY2godGhpcy5wcml2UmVxdWVzdFNlc3Npb24uYXVkaW9Ob2RlSWQpO1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0geWllbGQgdGhpcy5wcml2U3BlYWtlckF1ZGlvU291cmNlLmZvcm1hdDtcbiAgICAgICAgICAgIGNvbnN0IGRldmljZUluZm8gPSB5aWVsZCB0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UuZGV2aWNlSW5mbztcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvTm9kZSA9IG5ldyBSZXBsYXlhYmxlQXVkaW9Ob2RlKG5vZGUsIGZvcm1hdC5hdmdCeXRlc1BlclNlYyk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vbkF1ZGlvU291cmNlQXR0YWNoQ29tcGxldGVkKGF1ZGlvTm9kZSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5TcGVlY2hTZXJ2aWNlQ29uZmlnLkNvbnRleHQuYXVkaW8gPSB7IHNvdXJjZTogZGV2aWNlSW5mbyB9O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB5aWVsZCBjb25Qcm9taXNlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHByZUF1ZGlvUHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb25TdGFydEV2ZW50QXJncyA9IG5ldyBTZXNzaW9uRXZlbnRBcmdzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5zZXNzaW9uU3RhcnRlZCh0aGlzLnByaXZSZWNvZ25pemVyLCBzZXNzaW9uU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdm9pZCB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICBjb25zdCBhdWRpb1NlbmRQcm9taXNlID0gdGhpcy5zZW5kQXVkaW8oYXVkaW9Ob2RlKTtcbiAgICAgICAgICAgIC8vIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICBhdWRpb1NlbmRQcm9taXNlLnRoZW4oKCkgPT4geyB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5SdW50aW1lRXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdERlZmVycmFsLnByb21pc2U7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kUHJlQXVkaW9NZXNzYWdlcyhjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFNwZWFrZXJSZWNvZ25pdGlvbihjb25uZWN0aW9uLCBjb250ZXh0KTtcbiAgICAgICAgICAgIC8vIGF3YWl0IHRoaXMuc2VuZFdhdmVIZWFkZXIoY29ubmVjdGlvbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kU3BlYWtlclJlY29nbml0aW9uKGNvbm5lY3Rpb24sIGNvbnRleHQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNwZWFrZXJDb250ZXh0SnNvbiA9IEpTT04uc3RyaW5naWZ5KGNvbnRleHQpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzcGVha2VyLmNvbnRleHRcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLThcIiwgc3BlYWtlckNvbnRleHRKc29uKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBleHRyYWN0U3BlYWtlckNvbnRleHQobW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZlYXR1cmVzOiB7XG4gICAgICAgICAgICAgICAgaW50ZXJpbVJlc3VsdDogXCJlbmFibGVkXCIsXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3NpdmVEZXRlY3Rpb246IFwiZGlzYWJsZWRcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9maWxlSWRzOiBtb2RlbC5wcm9maWxlSWRzLFxuICAgICAgICAgICAgc2NlbmFyaW86IG1vZGVsLnNjZW5hcmlvLFxuICAgICAgICB9O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclNlcnZpY2VSZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBQcm94eUluZm8sIFdlYnNvY2tldENvbm5lY3Rpb24sIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IEZvcmNlRGljdGF0aW9uUHJvcGVydHlOYW1lLCBPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IFJlY29nbml0aW9uTW9kZSwgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmltcG9ydCB7IFF1ZXJ5UGFyYW1ldGVyTmFtZXMgfSBmcm9tIFwiLi9RdWVyeVBhcmFtZXRlck5hbWVzXCI7XG5leHBvcnQgY2xhc3MgU3BlZWNoQ29ubmVjdGlvbkZhY3RvcnkgZXh0ZW5kcyBDb25uZWN0aW9uRmFjdG9yeUJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgICB0aGlzLmludGVyYWN0aXZlUmVsYXRpdmVVcmkgPSBcIi9zcGVlY2gvcmVjb2duaXRpb24vaW50ZXJhY3RpdmUvY29nbml0aXZlc2VydmljZXMvdjFcIjtcbiAgICAgICAgdGhpcy5jb252ZXJzYXRpb25SZWxhdGl2ZVVyaSA9IFwiL3NwZWVjaC9yZWNvZ25pdGlvbi9jb252ZXJzYXRpb24vY29nbml0aXZlc2VydmljZXMvdjFcIjtcbiAgICAgICAgdGhpcy5kaWN0YXRpb25SZWxhdGl2ZVVyaSA9IFwiL3NwZWVjaC9yZWNvZ25pdGlvbi9kaWN0YXRpb24vY29nbml0aXZlc2VydmljZXMvdjFcIjtcbiAgICAgICAgdGhpcy51bml2ZXJzYWxVcmkgPSBcIi9zcGVlY2gvdW5pdmVyc2FsL3ZcIjtcbiAgICB9XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBsZXQgZW5kcG9pbnQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCB1bmRlZmluZWQpO1xuICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgaG9zdFN1ZmZpeCA9IENvbm5lY3Rpb25GYWN0b3J5QmFzZS5nZXRIb3N0U3VmZml4KHJlZ2lvbik7XG4gICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIFwid3NzOi8vXCIgKyByZWdpb24gKyBcIi5zdHQuc3BlZWNoXCIgKyBob3N0U3VmZml4KTtcbiAgICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSB7fTtcbiAgICAgICAgY29uc3QgZW5kcG9pbnRJZCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2UgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKGVuZHBvaW50SWQpIHtcbiAgICAgICAgICAgIGlmICghZW5kcG9pbnQgfHwgZW5kcG9pbnQuc2VhcmNoKFF1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3VzdG9tU3BlZWNoRGVwbG95bWVudElkKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN1c3RvbVNwZWVjaERlcGxveW1lbnRJZF0gPSBlbmRwb2ludElkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxhbmd1YWdlKSB7XG4gICAgICAgICAgICBpZiAoIWVuZHBvaW50IHx8IGVuZHBvaW50LnNlYXJjaChRdWVyeVBhcmFtZXRlck5hbWVzLkxhbmd1YWdlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkxhbmd1YWdlXSA9IGxhbmd1YWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghZW5kcG9pbnQgfHwgZW5kcG9pbnQuc2VhcmNoKFF1ZXJ5UGFyYW1ldGVyTmFtZXMuRm9ybWF0KSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuRm9ybWF0XSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb25maWcuYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkVuYWJsZUxhbmd1YWdlSWRdID0gXCJ0cnVlXCI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRDb21tb25VcmxQYXJhbXMoY29uZmlnLCBxdWVyeVBhcmFtcywgZW5kcG9pbnQpO1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbmZpZy5yZWNvZ25pdGlvbk1vZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uTW9kZS5Db252ZXJzYXRpb246XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShGb3JjZURpY3RhdGlvblByb3BlcnR5TmFtZSwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50ID0gaG9zdCArIHRoaXMuZGljdGF0aW9uUmVsYXRpdmVVcmk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnJlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uICE9PSB1bmRlZmluZWQgJiYgcGFyc2VJbnQoY29uZmlnLnJlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uLCAxMCkgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQgPSBgJHtob3N0fSR7dGhpcy51bml2ZXJzYWxVcml9JHtjb25maWcucmVjb2duaXRpb25FbmRwb2ludFZlcnNpb259YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZHBvaW50ID0gaG9zdCArIHRoaXMuY29udmVyc2F0aW9uUmVsYXRpdmVVcmk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBSZWNvZ25pdGlvbk1vZGUuRGljdGF0aW9uOlxuICAgICAgICAgICAgICAgICAgICBlbmRwb2ludCA9IGhvc3QgKyB0aGlzLmRpY3RhdGlvblJlbGF0aXZlVXJpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLnJlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uICE9PSB1bmRlZmluZWQgJiYgcGFyc2VJbnQoY29uZmlnLnJlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uLCAxMCkgPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRwb2ludCA9IGAke2hvc3R9JHt0aGlzLnVuaXZlcnNhbFVyaX0ke2NvbmZpZy5yZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvbn1gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kcG9pbnQgPSBob3N0ICsgdGhpcy5pbnRlcmFjdGl2ZVJlbGF0aXZlVXJpOyAvLyBkZWZhdWx0IGlzIGludGVyYWN0aXZlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAoYXV0aEluZm8udG9rZW4gIT09IHVuZGVmaW5lZCAmJiBhdXRoSW5mby50b2tlbiAhPT0gXCJcIikge1xuICAgICAgICAgICAgaGVhZGVyc1thdXRoSW5mby5oZWFkZXJOYW1lXSA9IGF1dGhJbmZvLnRva2VuO1xuICAgICAgICB9XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuQ29ubmVjdGlvbklkXSA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgY29uc3QgZW5hYmxlQ29tcHJlc3Npb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1FbmFibGVXZWJzb2NrZXRDb21wcmVzc2lvblwiLCBcImZhbHNlXCIpID09PSBcInRydWVcIjtcbiAgICAgICAgY29uc3Qgd2ViU29ja2V0Q29ubmVjdGlvbiA9IG5ldyBXZWJzb2NrZXRDb25uZWN0aW9uKGVuZHBvaW50LCBxdWVyeVBhcmFtcywgaGVhZGVycywgbmV3IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIoKSwgUHJveHlJbmZvLmZyb21SZWNvZ25pemVyQ29uZmlnKGNvbmZpZyksIGVuYWJsZUNvbXByZXNzaW9uLCBjb25uZWN0aW9uSWQpO1xuICAgICAgICAvLyBTZXQgdGhlIHZhbHVlIG9mIFNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1VybCB0byB3ZWJTb2NrZXRDb25uZWN0aW9uLnVyaSAoYW5kIG5vdCB0byBgZW5kcG9pbnRgKSwgc2luY2UgdGhpcyB2YWx1ZSBpcyB0aGUgZmluYWxcbiAgICAgICAgLy8gVVJJIHRoYXQgd2FzIHVzZWQgdG8gbWFrZSB0aGUgY29ubmVjdGlvbiAoaW5jbHVkaW5nIHF1ZXJ5IHBhcmFtZXRlcnMpLlxuICAgICAgICBjb25zdCB1cmkgPSB3ZWJTb2NrZXRDb25uZWN0aW9uLnVyaTtcbiAgICAgICAgY29uZmlnLnBhcmFtZXRlcnMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9VcmwsIHVyaSk7XG4gICAgICAgIHJldHVybiB3ZWJTb2NrZXRDb25uZWN0aW9uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoQ29ubmVjdGlvbkZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEFyZ3VtZW50TnVsbEVycm9yLCBDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlIGV4dGVuZHMgQ29ubmVjdGlvbk1lc3NhZ2Uge1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2VUeXBlLCBwYXRoLCByZXF1ZXN0SWQsIGNvbnRlbnRUeXBlLCBib2R5LCBzdHJlYW1JZCwgYWRkaXRpb25hbEhlYWRlcnMsIGlkKSB7XG4gICAgICAgIGlmICghcGF0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwicGF0aFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlcXVlc3RJZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50TnVsbEVycm9yKFwicmVxdWVzdElkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5QYXRoXSA9IHBhdGg7XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuUmVxdWVzdElkXSA9IHJlcXVlc3RJZDtcbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5SZXF1ZXN0VGltZXN0YW1wXSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgaWYgKGNvbnRlbnRUeXBlKSB7XG4gICAgICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbnRlbnRUeXBlXSA9IGNvbnRlbnRUeXBlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdHJlYW1JZCkge1xuICAgICAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5SZXF1ZXN0U3RyZWFtSWRdID0gc3RyZWFtSWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFkZGl0aW9uYWxIZWFkZXJzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGhlYWRlck5hbWUgaW4gYWRkaXRpb25hbEhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVhZGVyTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW2hlYWRlck5hbWVdID0gYWRkaXRpb25hbEhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgc3VwZXIobWVzc2FnZVR5cGUsIGJvZHksIGhlYWRlcnMsIGlkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN1cGVyKG1lc3NhZ2VUeXBlLCBib2R5LCBoZWFkZXJzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZQYXRoID0gcGF0aDtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICB0aGlzLnByaXZDb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlO1xuICAgICAgICB0aGlzLnByaXZTdHJlYW1JZCA9IHN0cmVhbUlkO1xuICAgICAgICB0aGlzLnByaXZBZGRpdGlvbmFsSGVhZGVycyA9IGFkZGl0aW9uYWxIZWFkZXJzO1xuICAgIH1cbiAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhdGg7XG4gICAgfVxuICAgIGdldCByZXF1ZXN0SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXF1ZXN0SWQ7XG4gICAgfVxuICAgIGdldCBjb250ZW50VHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbnRlbnRUeXBlO1xuICAgIH1cbiAgICBnZXQgc3RyZWFtSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTdHJlYW1JZDtcbiAgICB9XG4gICAgZ2V0IGFkZGl0aW9uYWxIZWFkZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QWRkaXRpb25hbEhlYWRlcnM7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBsZXQgcGF0aCA9IG51bGw7XG4gICAgICAgIGxldCByZXF1ZXN0SWQgPSBudWxsO1xuICAgICAgICBsZXQgY29udGVudFR5cGUgPSBudWxsO1xuICAgICAgICAvLyBsZXQgcmVxdWVzdFRpbWVzdGFtcCA9IG51bGw7XG4gICAgICAgIGxldCBzdHJlYW1JZCA9IG51bGw7XG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxIZWFkZXJzID0ge307XG4gICAgICAgIGlmIChtZXNzYWdlLmhlYWRlcnMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaGVhZGVyTmFtZSBpbiBtZXNzYWdlLmhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGVhZGVyTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVyTmFtZS50b0xvd2VyQ2FzZSgpID09PSBIZWFkZXJOYW1lcy5QYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBtZXNzYWdlLmhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaGVhZGVyTmFtZS50b0xvd2VyQ2FzZSgpID09PSBIZWFkZXJOYW1lcy5SZXF1ZXN0SWQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdElkID0gbWVzc2FnZS5oZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChoZWFkZXJOYW1lLnRvTG93ZXJDYXNlKCkgPT09IEhlYWRlck5hbWVzLlJlcXVlc3RUaW1lc3RhbXAudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gIHJlcXVlc3RUaW1lc3RhbXAgPSBtZXNzYWdlLmhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaGVhZGVyTmFtZS50b0xvd2VyQ2FzZSgpID09PSBIZWFkZXJOYW1lcy5Db250ZW50VHlwZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZSA9IG1lc3NhZ2UuaGVhZGVyc1toZWFkZXJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChoZWFkZXJOYW1lLnRvTG93ZXJDYXNlKCkgPT09IEhlYWRlck5hbWVzLlJlcXVlc3RTdHJlYW1JZC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW1JZCA9IG1lc3NhZ2UuaGVhZGVyc1toZWFkZXJOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxIZWFkZXJzW2hlYWRlck5hbWVdID0gbWVzc2FnZS5oZWFkZXJzW2hlYWRlck5hbWVdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZS5tZXNzYWdlVHlwZSwgcGF0aCwgcmVxdWVzdElkLCBjb250ZW50VHlwZSwgbWVzc2FnZS5ib2R5LCBzdHJlYW1JZCwgYWRkaXRpb25hbEhlYWRlcnMsIG1lc3NhZ2UuaWQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuSW50ZXJuYWwuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgSlNPTiB1c2VkIGluIHRoZSBzcGVlY2guY29udGV4dCBtZXNzYWdlIHNlbnQgdG8gdGhlIHNwZWVjaCBzZXJ2aWNlLlxuICogVGhlIGR5bmFtaWMgZ3JhbW1hciBpcyBhbHdheXMgcmVmcmVzaGVkIGZyb20gdGhlIGVuY2Fwc3VsYXRlZCBkeW5hbWljIGdyYW1tYXIgb2JqZWN0LlxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoQ29udGV4dCB7XG4gICAgY29uc3RydWN0b3IoZHluYW1pY0dyYW1tYXIpIHtcbiAgICAgICAgdGhpcy5wcml2Q29udGV4dCA9IHt9O1xuICAgICAgICB0aGlzLnByaXZEeW5hbWljR3JhbW1hciA9IGR5bmFtaWNHcmFtbWFyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgc2VjdGlvbiBvZiB0aGUgc3BlZWNoLmNvbnRleHQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSBzZWN0aW9uTmFtZSBOYW1lIG9mIHRoZSBzZWN0aW9uIHRvIGdldC5cbiAgICAgKiBAcmV0dXJuIHN0cmluZyBvciBDb250ZXh0IEpTT04gc2VyaWFsaXphYmxlIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgdGhlIHZhbHVlLlxuICAgICAqL1xuICAgIGdldFNlY3Rpb24oc2VjdGlvbk5hbWUpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnByaXZDb250ZXh0W3NlY3Rpb25OYW1lXSB8fCB7fSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBzZWN0aW9uIHRvIHRoZSBzcGVlY2guY29udGV4dCBvYmplY3QuXG4gICAgICogQHBhcmFtIHNlY3Rpb25OYW1lIE5hbWUgb2YgdGhlIHNlY3Rpb24gdG8gYWRkLlxuICAgICAqIEBwYXJhbSB2YWx1ZSBKU09OIHNlcmlhbGl6YWJsZSBvYmplY3QgdGhhdCByZXByZXNlbnRzIHRoZSB2YWx1ZS5cbiAgICAgKi9cbiAgICBzZXRTZWN0aW9uKHNlY3Rpb25OYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZDb250ZXh0W3NlY3Rpb25OYW1lXSA9IHZhbHVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBASW50ZXJuYWxcbiAgICAgKiBUaGlzIGlzIG9ubHkgdXNlZCBieSBwcm9udW5jaWF0aW9uIGFzc2Vzc21lbnQgY29uZmlnLlxuICAgICAqIERvIG5vdCB1c2UgZXh0ZXJuYWxseSwgb2JqZWN0IHJldHVybmVkIHdpbGwgY2hhbmdlIHdpdGhvdXQgd2FybmluZyBvciBub3RpY2UuXG4gICAgICovXG4gICAgc2V0UHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRQYXJhbXMocGFyYW1zKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZDb250ZXh0LnBocmFzZURldGVjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb250ZXh0LnBocmFzZURldGVjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBlbnJpY2htZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIHByb251bmNpYXRpb25Bc3Nlc3NtZW50OiB7fVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VEZXRlY3Rpb24uZW5yaWNobWVudC5wcm9udW5jaWF0aW9uQXNzZXNzbWVudCA9IEpTT04ucGFyc2UocGFyYW1zKTtcbiAgICAgICAgdGhpcy5zZXRXb3JkTGV2ZWxUaW1pbmdzKCk7XG4gICAgICAgIHRoaXMucHJpdkNvbnRleHQucGhyYXNlT3V0cHV0LmRldGFpbGVkLm9wdGlvbnMucHVzaChcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50XCIpO1xuICAgICAgICBpZiAodGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZGV0YWlsZWQub3B0aW9ucy5pbmRleE9mKFwiU05SXCIpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZGV0YWlsZWQub3B0aW9ucy5wdXNoKFwiU05SXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldFdvcmRMZXZlbFRpbWluZ3MoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZDb250ZXh0LnBocmFzZU91dHB1dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb250ZXh0LnBocmFzZU91dHB1dCA9IHtcbiAgICAgICAgICAgICAgICBkZXRhaWxlZDoge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBbXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZm9ybWF0OiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZGV0YWlsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZGV0YWlsZWQgPSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uczogW11cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZm9ybWF0ID0gXCJEZXRhaWxlZFwiO1xuICAgICAgICBpZiAodGhpcy5wcml2Q29udGV4dC5waHJhc2VPdXRwdXQuZGV0YWlsZWQub3B0aW9ucy5pbmRleE9mKFwiV29yZFRpbWluZ3NcIikgPT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDb250ZXh0LnBocmFzZU91dHB1dC5kZXRhaWxlZC5vcHRpb25zLnB1c2goXCJXb3JkVGltaW5nc1wiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIGNvbnN0IGRnaSA9IHRoaXMucHJpdkR5bmFtaWNHcmFtbWFyLmdlbmVyYXRlR3JhbW1hck9iamVjdCgpO1xuICAgICAgICB0aGlzLnNldFNlY3Rpb24oXCJkZ2lcIiwgZGdpKTtcbiAgICAgICAgY29uc3QgcmV0ID0gSlNPTi5zdHJpbmdpZnkodGhpcy5wcml2Q29udGV4dCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hDb250ZXh0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFNlcnZpY2VJbnRlcmZhY2VzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSwgT3V0cHV0Rm9ybWF0LCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgU3BlZWNoUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncywgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MsIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0LCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBEZXRhaWxlZFNwZWVjaFBocmFzZSwgRW51bVRyYW5zbGF0aW9uLCBPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIFJlY29nbml0aW9uU3RhdHVzLCBTZXJ2aWNlUmVjb2duaXplckJhc2UsIFNpbXBsZVNwZWVjaFBocmFzZSwgU3BlZWNoSHlwb3RoZXNpcywgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmV4cG9ydCBjbGFzcyBTcGVlY2hTZXJ2aWNlUmVjb2duaXplciBleHRlbmRzIFNlcnZpY2VSZWNvZ25pemVyQmFzZSB7XG4gICAgY29uc3RydWN0b3IoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgc3BlZWNoUmVjb2duaXplcikge1xuICAgICAgICBzdXBlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCBzcGVlY2hSZWNvZ25pemVyKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUmVjb2duaXplciA9IHNwZWVjaFJlY29nbml6ZXI7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdFByb3BzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICAgICAgcmVzdWx0UHJvcHMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgbGV0IHByb2Nlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgICAgc3dpdGNoIChjb25uZWN0aW9uTWVzc2FnZS5wYXRoLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLmh5cG90aGVzaXNcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLmZyYWdtZW50XCI6XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGh5cG90aGVzaXMgPSBTcGVlY2hIeXBvdGhlc2lzLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gaHlwb3RoZXNpcy5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBSZXN1bHRSZWFzb24uUmVjb2duaXppbmdTcGVlY2gsIGh5cG90aGVzaXMuVGV4dCwgaHlwb3RoZXNpcy5EdXJhdGlvbiwgb2Zmc2V0LCBoeXBvdGhlc2lzLkxhbmd1YWdlLCBoeXBvdGhlc2lzLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgdW5kZWZpbmVkLCAvLyBTcGVha2VyIElkXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25IeXBvdGhlc2lzKG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzKHJlc3VsdCwgaHlwb3RoZXNpcy5EdXJhdGlvbiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoUmVjb2duaXplci5yZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hSZWNvZ25pemVyLnJlY29nbml6aW5nKHRoaXMucHJpdlNwZWVjaFJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwic3BlZWNoLnBocmFzZVwiOlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzaW1wbGUgPSBTaW1wbGVTcGVlY2hQaHJhc2UuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRSZWFzb24gPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZVJlY29nbml0aW9uUmVzdWx0KHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uUGhyYXNlUmVjb2duaXplZCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0ICsgc2ltcGxlLk9mZnNldCArIHNpbXBsZS5EdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChSZXN1bHRSZWFzb24uQ2FuY2VsZWQgPT09IHJlc3VsdFJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FuY2VsUmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVDYW5jZWxSZXN1bHQoc2ltcGxlLlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbmNlbGxhdGlvbkVycm9yQ29kZSA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlQ2FuY2VsRXJyb3JDb2RlKHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNhbmNlbFJlY29nbml0aW9uTG9jYWwoY2FuY2VsUmVhc29uLCBjYW5jZWxsYXRpb25FcnJvckNvZGUsIEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlRXJyb3JEZXRhaWxzKGNhbmNlbGxhdGlvbkVycm9yQ29kZSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNTcGVlY2hFbmRlZCAmJiByZXN1bHRSZWFzb24gPT09IFJlc3VsdFJlYXNvbi5Ob01hdGNoICYmIHNpbXBsZS5SZWNvZ25pdGlvblN0YXR1cyAhPT0gUmVjb2duaXRpb25TdGF0dXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lKSA9PT0gT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIHJlc3VsdFJlYXNvbiwgc2ltcGxlLkRpc3BsYXlUZXh0LCBzaW1wbGUuRHVyYXRpb24sIHNpbXBsZS5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0LCBzaW1wbGUuTGFuZ3VhZ2UsIHNpbXBsZS5MYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgLy8gU3BlYWtlciBJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5LCByZXN1bHRQcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXRhaWxlZCA9IERldGFpbGVkU3BlZWNoUGhyYXNlLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG90YWxPZmZzZXQgPSBkZXRhaWxlZC5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvZmZzZXRDb3JyZWN0ZWRKc29uID0gZGV0YWlsZWQuZ2V0SnNvbldpdGhDb3JyZWN0ZWRPZmZzZXRzKHRvdGFsT2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgcmVzdWx0UmVhc29uLCBkZXRhaWxlZC5SZWNvZ25pdGlvblN0YXR1cyA9PT0gUmVjb2duaXRpb25TdGF0dXMuU3VjY2VzcyA/IGRldGFpbGVkLk5CZXN0WzBdLkRpc3BsYXkgOiB1bmRlZmluZWQsIGRldGFpbGVkLkR1cmF0aW9uLCB0b3RhbE9mZnNldCwgZGV0YWlsZWQuTGFuZ3VhZ2UsIGRldGFpbGVkLkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgdW5kZWZpbmVkLCAvLyBTcGVha2VyIElkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCwgb2Zmc2V0Q29ycmVjdGVkSnNvbiwgcmVzdWx0UHJvcHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBldmVudCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIHJlc3VsdC5vZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoUmVjb2duaXplci5yZWNvZ25pemVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hSZWNvZ25pemVyLnJlY29nbml6ZWQodGhpcy5wcml2U3BlZWNoUmVjb2duaXplciwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZFcnJvckNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWYgaXQncyBzdWNjZXNzZnVsIGRvbid0IGludm9rZSB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlcnJvciBhZnRlciB0aGF0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NlZDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb24oc2Vzc2lvbklkLCByZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBwcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2Vycm9yQ29kZV0pO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZTcGVlY2hSZWNvZ25pemVyLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICBjb25zdCBjYW5jZWxFdmVudCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzKGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3IsIGVycm9yQ29kZSwgdW5kZWZpbmVkLCBzZXNzaW9uSWQpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hSZWNvZ25pemVyLmNhbmNlbGVkKHRoaXMucHJpdlNwZWVjaFJlY29nbml6ZXIsIGNhbmNlbEV2ZW50KTtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9hKSB7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdChyZXF1ZXN0SWQsIFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgdW5kZWZpbmVkLCAvLyBUZXh0XG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIER1cmF0aW9uXG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIE9mZnNldFxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZVxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZSBEZXRlY3Rpb24gQ29uZmlkZW5jZVxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBTcGVha2VyIElkXG4gICAgICAgICAgICBlcnJvciwgdW5kZWZpbmVkLCAvLyBKc29uXG4gICAgICAgICAgICBwcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoX2IpIHsgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTZXJ2aWNlUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25GYWN0b3J5QmFzZSB9IGZyb20gXCIuL0Nvbm5lY3Rpb25GYWN0b3J5QmFzZVwiO1xuaW1wb3J0IHsgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbmltcG9ydCB7IFF1ZXJ5UGFyYW1ldGVyTmFtZXMgfSBmcm9tIFwiLi9RdWVyeVBhcmFtZXRlck5hbWVzXCI7XG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2lzQ29ubmVjdGlvbkZhY3Rvcnkge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnN5bnRoZXNpc1VyaSA9IFwiL2NvZ25pdGl2ZXNlcnZpY2VzL3dlYnNvY2tldC92MVwiO1xuICAgIH1cbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIGxldCBlbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQsIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IHJlZ2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCB1bmRlZmluZWQpO1xuICAgICAgICBjb25zdCBob3N0U3VmZml4ID0gQ29ubmVjdGlvbkZhY3RvcnlCYXNlLmdldEhvc3RTdWZmaXgocmVnaW9uKTtcbiAgICAgICAgY29uc3QgZW5kcG9pbnRJZCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgaG9zdFByZWZpeCA9IChlbmRwb2ludElkID09PSB1bmRlZmluZWQpID8gXCJ0dHNcIiA6IFwidm9pY2VcIjtcbiAgICAgICAgY29uc3QgaG9zdCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdCwgXCJ3c3M6Ly9cIiArIHJlZ2lvbiArIFwiLlwiICsgaG9zdFByZWZpeCArIFwiLnNwZWVjaFwiICsgaG9zdFN1ZmZpeCk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAgIGlmICghZW5kcG9pbnQpIHtcbiAgICAgICAgICAgIGVuZHBvaW50ID0gaG9zdCArIHRoaXMuc3ludGhlc2lzVXJpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuICE9PSB1bmRlZmluZWQgJiYgYXV0aEluZm8udG9rZW4gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbYXV0aEluZm8uaGVhZGVyTmFtZV0gPSBhdXRoSW5mby50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIGlmIChlbmRwb2ludElkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdXN0b21Wb2ljZURlcGxveW1lbnRJZF0gPSBlbmRwb2ludElkO1xuICAgICAgICB9XG4gICAgICAgIGNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUGFyYW1ldGVycyhjb25maWcucGFyYW1ldGVycyksIGVuYWJsZUNvbXByZXNzaW9uLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgQXJndW1lbnROdWxsRXJyb3IsIENvbm5lY3Rpb25TdGF0ZSwgY3JlYXRlTm9EYXNoR3VpZCwgRXZlbnRTb3VyY2UsIE1lc3NhZ2VUeXBlLCBTZXJ2aWNlRXZlbnQsIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkLCBSZXN1bHRSZWFzb24sIFNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzLCBTcGVlY2hTeW50aGVzaXNFdmVudEFyZ3MsIFNwZWVjaFN5bnRoZXNpc1Jlc3VsdCwgU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzLCBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MsIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBZ2VudENvbmZpZywgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBNZXRhZGF0YVR5cGUsIFN5bnRoZXNpc0F1ZGlvTWV0YWRhdGEsIFN5bnRoZXNpc0NvbnRleHQsIFN5bnRoZXNpc1R1cm4gfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZSB9IGZyb20gXCIuL1NwZWVjaENvbm5lY3Rpb25NZXNzYWdlLkludGVybmFsXCI7XG5leHBvcnQgY2xhc3MgU3ludGhlc2lzQWRhcHRlckJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgc3ludGhlc2l6ZXJDb25maWcsIHNwZWVjaFN5bnRoZXNpemVyLCBhdWRpb0Rlc3RpbmF0aW9uKSB7XG4gICAgICAgIHRoaXMuc3BlYWtPdmVycmlkZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZWNlaXZlTWVzc2FnZU92ZXJyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNvbm5lY3RJbXBsT3ZlcnJpZGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuY29uZmlnQ29ubmVjdGlvbk92ZXJyaWRlID0gdW5kZWZpbmVkO1xuICAgICAgICAvLyBBIHByb21pc2UgZm9yIGEgY29uZmlndXJlZCBjb25uZWN0aW9uLlxuICAgICAgICAvLyBEbyBub3QgY29uc3VtZSBkaXJlY3RseSwgY2FsbCBmZXRjaENvbm5lY3Rpb24gaW5zdGVhZC5cbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIWF1dGhlbnRpY2F0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJhdXRoZW50aWNhdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNvbm5lY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJjb25uZWN0aW9uRmFjdG9yeVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN5bnRoZXNpemVyQ29uZmlnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJzeW50aGVzaXplckNvbmZpZ1wiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZBdXRoZW50aWNhdGlvbiA9IGF1dGhlbnRpY2F0aW9uO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uRmFjdG9yeSA9IGNvbm5lY3Rpb25GYWN0b3J5O1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXplckNvbmZpZyA9IHN5bnRoZXNpemVyQ29uZmlnO1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyID0gc3BlZWNoU3ludGhlc2l6ZXI7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uID0gYXVkaW9EZXN0aW5hdGlvbjtcbiAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybiA9IG5ldyBTeW50aGVzaXNUdXJuKCk7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2U2VydmljZUV2ZW50cyA9IG5ldyBFdmVudFNvdXJjZSgpO1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNDb250ZXh0ID0gbmV3IFN5bnRoZXNpc0NvbnRleHQodGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIpO1xuICAgICAgICB0aGlzLnByaXZBZ2VudENvbmZpZyA9IG5ldyBBZ2VudENvbmZpZygpO1xuICAgICAgICB0aGlzLmNvbm5lY3Rpb25FdmVudHMuYXR0YWNoKChjb25uZWN0aW9uRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uRXZlbnQubmFtZSA9PT0gXCJDb25uZWN0aW9uQ2xvc2VkRXZlbnRcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb25DbG9zZWRFdmVudCA9IGNvbm5lY3Rpb25FdmVudDtcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbkNsb3NlZEV2ZW50LnN0YXR1c0NvZGUgIT09IDEwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxTeW50aGVzaXNMb2NhbChDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIGNvbm5lY3Rpb25DbG9zZWRFdmVudC5zdGF0dXNDb2RlID09PSAxMDA3ID8gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkJhZFJlcXVlc3RQYXJhbWV0ZXJzIDogQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkNvbm5lY3Rpb25GYWlsdXJlLCBgJHtjb25uZWN0aW9uQ2xvc2VkRXZlbnQucmVhc29ufSB3ZWJzb2NrZXQgZXJyb3IgY29kZTogJHtjb25uZWN0aW9uQ2xvc2VkRXZlbnQuc3RhdHVzQ29kZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgc3ludGhlc2lzQ29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN5bnRoZXNpc0NvbnRleHQ7XG4gICAgfVxuICAgIGdldCBhZ2VudENvbmZpZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFnZW50Q29uZmlnO1xuICAgIH1cbiAgICBnZXQgY29ubmVjdGlvbkV2ZW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25FdmVudHM7XG4gICAgfVxuICAgIGdldCBzZXJ2aWNlRXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2VydmljZUV2ZW50cztcbiAgICB9XG4gICAgc2V0IGFjdGl2aXR5VGVtcGxhdGUobWVzc2FnZVBheWxvYWQpIHtcbiAgICAgICAgdGhpcy5wcml2QWN0aXZpdHlUZW1wbGF0ZSA9IG1lc3NhZ2VQYXlsb2FkO1xuICAgIH1cbiAgICBnZXQgYWN0aXZpdHlUZW1wbGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFjdGl2aXR5VGVtcGxhdGU7XG4gICAgfVxuICAgIHNldCBhdWRpb091dHB1dEZvcm1hdChmb3JtYXQpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uYXVkaW9PdXRwdXRGb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgIGlmICh0aGlzLnByaXZTZXNzaW9uQXVkaW9EZXN0aW5hdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTZXNzaW9uQXVkaW9EZXN0aW5hdGlvbi5mb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3ludGhlc2lzQ29udGV4dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnN5bnRoZXNpc0NvbnRleHQuYXVkaW9PdXRwdXRGb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIGFkZEhlYWRlcihhdWRpbywgZm9ybWF0KSB7XG4gICAgICAgIGlmICghZm9ybWF0Lmhhc0hlYWRlcikge1xuICAgICAgICAgICAgcmV0dXJuIGF1ZGlvO1xuICAgICAgICB9XG4gICAgICAgIGZvcm1hdC51cGRhdGVIZWFkZXIoYXVkaW8uYnl0ZUxlbmd0aCk7XG4gICAgICAgIGNvbnN0IHRtcCA9IG5ldyBVaW50OEFycmF5KGF1ZGlvLmJ5dGVMZW5ndGggKyBmb3JtYXQuaGVhZGVyLmJ5dGVMZW5ndGgpO1xuICAgICAgICB0bXAuc2V0KG5ldyBVaW50OEFycmF5KGZvcm1hdC5oZWFkZXIpLCAwKTtcbiAgICAgICAgdG1wLnNldChuZXcgVWludDhBcnJheShhdWRpbyksIGZvcm1hdC5oZWFkZXIuYnl0ZUxlbmd0aCk7XG4gICAgICAgIHJldHVybiB0bXAuYnVmZmVyO1xuICAgIH1cbiAgICBpc0Rpc3Bvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNEaXNwb3NlZDtcbiAgICB9XG4gICAgZGlzcG9zZShyZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdlNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTZXNzaW9uQXVkaW9EZXN0aW5hdGlvbi5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLmRpc3Bvc2UocmVhc29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbm5lY3QoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kTmV0d29ya01lc3NhZ2UocGF0aCwgcGF5bG9hZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHR5cGVvZiBwYXlsb2FkID09PSBcInN0cmluZ1wiID8gTWVzc2FnZVR5cGUuVGV4dCA6IE1lc3NhZ2VUeXBlLkJpbmFyeTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gdHlwZW9mIHBheWxvYWQgPT09IFwic3RyaW5nXCIgPyBcImFwcGxpY2F0aW9uL2pzb25cIiA6IFwiXCI7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKHR5cGUsIHBhdGgsIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLCBjb250ZW50VHlwZSwgcGF5bG9hZCkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgU3BlYWsodGV4dCwgaXNTU01MLCByZXF1ZXN0SWQsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsQmFjaywgYXVkaW9EZXN0aW5hdGlvbikge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgbGV0IHNzbWw7XG4gICAgICAgICAgICBpZiAoaXNTU01MKSB7XG4gICAgICAgICAgICAgICAgc3NtbCA9IHRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzc21sID0gdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuYnVpbGRTc21sKHRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc3BlYWtPdmVycmlkZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3BlYWtPdmVycmlkZShzc21sLCByZXF1ZXN0SWQsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsQmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2sgPSBzdWNjZXNzQ2FsbGJhY2s7XG4gICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gZXJyb3JDYWxsQmFjaztcbiAgICAgICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uc3RhcnROZXdTeW50aGVzaXMocmVxdWVzdElkLCB0ZXh0LCBpc1NTTUwsIGF1ZGlvRGVzdGluYXRpb24pO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kU3ludGhlc2lzQ29udGV4dChjb25uZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTc21sTWVzc2FnZShjb25uZWN0aW9uLCBzc21sLCByZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHN5bnRoZXNpc1N0YXJ0RXZlbnRBcmdzID0gbmV3IFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncyhuZXcgU3BlZWNoU3ludGhlc2lzUmVzdWx0KHJlcXVlc3RJZCwgUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvU3RhcnRlZCkpO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnN5bnRoZXNpc1N0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuc3ludGhlc2lzU3RhcnRlZCh0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciwgc3ludGhlc2lzU3RhcnRFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMucmVjZWl2ZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxTeW50aGVzaXNMb2NhbChDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5Db25uZWN0aW9uRmFpbHVyZSwgZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gQ2FuY2VscyBzeW50aGVzaXMuXG4gICAgY2FuY2VsU3ludGhlc2lzKHJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbZXJyb3JDb2RlXSk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBTcGVlY2hTeW50aGVzaXNSZXN1bHQocmVxdWVzdElkLCBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIHVuZGVmaW5lZCwgZXJyb3IsIHByb3BlcnRpZXMpO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5TeW50aGVzaXNDYW5jZWxlZCkge1xuICAgICAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBuZXcgU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzKHJlc3VsdCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLlN5bnRoZXNpc0NhbmNlbGVkKHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoX2IpIHsgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIENhbmNlbHMgc3ludGhlc2lzLlxuICAgIGNhbmNlbFN5bnRoZXNpc0xvY2FsKGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZTeW50aGVzaXNUdXJuLmlzU3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uU3RvcFN5bnRoZXNpemluZygpO1xuICAgICAgICAgICAgdGhpcy5jYW5jZWxTeW50aGVzaXModGhpcy5wcml2U3ludGhlc2lzVHVybi5yZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmVjZWl2ZU1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB5aWVsZCBjb25uZWN0aW9uLnJlYWQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZWNlaXZlTWVzc2FnZU92ZXJyaWRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVjZWl2ZU1lc3NhZ2VPdmVycmlkZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2SXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSdyZSBkb25lLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGluZGljYXRlcyB3ZSBhcmUgZHJhaW5pbmcgdGhlIHF1ZXVlIGFuZCBpdCBjYW1lIHdpdGggbm8gbWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZTeW50aGVzaXNUdXJuLmlzU3ludGhlc2l6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb25NZXNzYWdlID0gU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuZnJvbUNvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQudG9Mb3dlckNhc2UoKSA9PT0gdGhpcy5wcml2U3ludGhlc2lzVHVybi5yZXF1ZXN0SWQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInR1cm4uc3RhcnRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uU2VydmljZVR1cm5TdGFydFJlc3BvbnNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicmVzcG9uc2VcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uU2VydmljZVJlc3BvbnNlTWVzc2FnZShjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXVkaW9cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2U3ludGhlc2lzVHVybi5zdHJlYW1JZC50b0xvd2VyQ2FzZSgpID09PSBjb25uZWN0aW9uTWVzc2FnZS5zdHJlYW1JZC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICEhY29ubmVjdGlvbk1lc3NhZ2UuYmluYXJ5Qm9keSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uQXVkaW9DaHVua1JlY2VpdmVkKGNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5zeW50aGVzaXppbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW9XaXRoSGVhZGVyID0gU3ludGhlc2lzQWRhcHRlckJhc2UuYWRkSGVhZGVyKGNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHksIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uYXVkaW9PdXRwdXRGb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncyhuZXcgU3BlZWNoU3ludGhlc2lzUmVzdWx0KHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLCBSZXN1bHRSZWFzb24uU3ludGhlc2l6aW5nQXVkaW8sIGF1ZGlvV2l0aEhlYWRlcikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnN5bnRoZXNpemluZyh0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2U2Vzc2lvbkF1ZGlvRGVzdGluYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U2Vzc2lvbkF1ZGlvRGVzdGluYXRpb24ud3JpdGUoY29ubmVjdGlvbk1lc3NhZ2UuYmluYXJ5Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXVkaW8ubWV0YWRhdGFcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXRhZGF0YUxpc3QgPSBTeW50aGVzaXNBdWRpb01ldGFkYXRhLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KS5NZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1ldGFkYXRhIG9mIG1ldGFkYXRhTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1ldGFkYXRhLlR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTWV0YWRhdGFUeXBlLldvcmRCb3VuZGFyeTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTWV0YWRhdGFUeXBlLlNlbnRlbmNlQm91bmRhcnk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblRleHRCb3VuZGFyeUV2ZW50KG1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3b3JkQm91bmRhcnlFdmVudEFyZ3MgPSBuZXcgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzKG1ldGFkYXRhLkRhdGEuT2Zmc2V0LCBtZXRhZGF0YS5EYXRhLkR1cmF0aW9uLCBtZXRhZGF0YS5EYXRhLnRleHQuVGV4dCwgbWV0YWRhdGEuRGF0YS50ZXh0Lkxlbmd0aCwgbWV0YWRhdGEuVHlwZSA9PT0gTWV0YWRhdGFUeXBlLldvcmRCb3VuZGFyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uY3VycmVudFRleHRPZmZzZXQgOiB0aGlzLnByaXZTeW50aGVzaXNUdXJuLmN1cnJlbnRTZW50ZW5jZU9mZnNldCwgbWV0YWRhdGEuRGF0YS50ZXh0LkJvdW5kYXJ5VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIud29yZEJvdW5kYXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci53b3JkQm91bmRhcnkodGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIsIHdvcmRCb3VuZGFyeUV2ZW50QXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1ldGFkYXRhVHlwZS5Cb29rbWFyazpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBib29rbWFya0V2ZW50QXJncyA9IG5ldyBTcGVlY2hTeW50aGVzaXNCb29rbWFya0V2ZW50QXJncyhtZXRhZGF0YS5EYXRhLk9mZnNldCwgbWV0YWRhdGEuRGF0YS5Cb29rbWFyayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuYm9va21hcmtSZWFjaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5ib29rbWFya1JlYWNoZWQodGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIsIGJvb2ttYXJrRXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTWV0YWRhdGFUeXBlLlZpc2VtZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uVmlzZW1lTWV0YWRhdGFSZWNlaXZlZChtZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhLkRhdGEuSXNMYXN0QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpc2VtZUV2ZW50QXJncyA9IG5ldyBTcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3MobWV0YWRhdGEuRGF0YS5PZmZzZXQsIG1ldGFkYXRhLkRhdGEuVmlzZW1lSWQsIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4uZ2V0QW5kQ2xlYXJWaXNlbWVBbmltYXRpb24oKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnZpc2VtZVJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnZpc2VtZVJlY2VpdmVkKHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLCB2aXNlbWVFdmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTWV0YWRhdGFUeXBlLlNlc3Npb25FbmQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblNlc3Npb25FbmQobWV0YWRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInR1cm4uZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvQnVmZmVyID0geWllbGQgdGhpcy5wcml2U3ludGhlc2lzVHVybi5nZXRBbGxSZWNlaXZlZEF1ZGlvV2l0aEhlYWRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBuZXcgU3BlZWNoU3ludGhlc2lzUmVzdWx0KHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLCBSZXN1bHRSZWFzb24uU3ludGhlc2l6aW5nQXVkaW9Db21wbGV0ZWQsIGF1ZGlvQnVmZmVyLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdGhpcy5wcml2U3ludGhlc2lzVHVybi5hdWRpb0R1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JDYWxsYmFjayhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnN5bnRoZXNpc0NvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuc3ludGhlc2lzQ29tcGxldGVkKHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLCBuZXcgU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzKHJlc3VsdCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5wcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhlcmUgYXJlIHNvbWUgbWVzc2FnZXMgdGhhdCB0aGUgZGVyaXZlZCBjbGFzcyBoYXMgbm90IHByb2Nlc3NlZCwgZGlzcGF0Y2ggdGhlbSB0byBjb25uZWN0IGNsYXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlNlcnZpY2VFdmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VydmljZUV2ZW50cy5vbkV2ZW50KG5ldyBTZXJ2aWNlRXZlbnQoY29ubmVjdGlvbk1lc3NhZ2UucGF0aC50b0xvd2VyQ2FzZSgpLCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IFdoYXQgZ29lcyBoZXJlP1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFN5bnRoZXNpc0NvbnRleHQoY29ubmVjdGlvbikge1xuICAgICAgICBjb25zdCBzeW50aGVzaXNDb250ZXh0SnNvbiA9IHRoaXMuc3ludGhlc2lzQ29udGV4dC50b0pTT04oKTtcbiAgICAgICAgaWYgKHN5bnRoZXNpc0NvbnRleHRKc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInN5bnRoZXNpcy5jb250ZXh0XCIsIHRoaXMucHJpdlN5bnRoZXNpc1R1cm4ucmVxdWVzdElkLCBcImFwcGxpY2F0aW9uL2pzb25cIiwgc3ludGhlc2lzQ29udGV4dEpzb24pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbm5lY3RJbXBsKGlzVW5BdXRob3JpemVkID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZS50aGVuKChjb25uZWN0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb24uc3RhdGUoKSA9PT0gQ29ubmVjdGlvblN0YXRlLkRpc2Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZTtcbiAgICAgICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uUHJlQ29ubmVjdGlvblN0YXJ0KHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQpO1xuICAgICAgICBjb25zdCBhdXRoUHJvbWlzZSA9IGlzVW5BdXRob3JpemVkID8gdGhpcy5wcml2QXV0aGVudGljYXRpb24uZmV0Y2hPbkV4cGlyeSh0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkKSA6IHRoaXMucHJpdkF1dGhlbnRpY2F0aW9uLmZldGNoKHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZSA9IGF1dGhQcm9taXNlLnRoZW4oKHJlc3VsdCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vbkF1dGhDb21wbGV0ZWQoZmFsc2UpO1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHRoaXMucHJpdkNvbm5lY3Rpb25GYWN0b3J5LmNyZWF0ZSh0aGlzLnByaXZTeW50aGVzaXplckNvbmZpZywgcmVzdWx0LCB0aGlzLnByaXZDb25uZWN0aW9uSWQpO1xuICAgICAgICAgICAgLy8gQXR0YWNoIHRvIHRoZSB1bmRlcmx5aW5nIGV2ZW50LiBObyBuZWVkIHRvIGhvbGQgb250byB0aGUgZGV0YWNoIHBvaW50ZXJzIGFzIGluIHRoZSBldmVudCB0aGUgY29ubmVjdGlvbiBnb2VzIGF3YXksXG4gICAgICAgICAgICAvLyBpdCdsbCBzdG9wIHNlbmRpbmcgZXZlbnRzLlxuICAgICAgICAgICAgY29ubmVjdGlvbi5ldmVudHMuYXR0YWNoKChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkV2ZW50cy5vbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBjb25uZWN0aW9uLm9wZW4oKTtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNUdXJuLm9uQ29ubmVjdGlvbkVzdGFibGlzaENvbXBsZXRlZChyZXNwb25zZS5zdGF0dXNDb2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gNDAzICYmICFpc1VuQXV0aG9yaXplZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbm5lY3RJbXBsKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vbkNvbm5lY3Rpb25Fc3RhYmxpc2hDb21wbGV0ZWQocmVzcG9uc2Uuc3RhdHVzQ29kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBVbmFibGUgdG8gY29udGFjdCBzZXJ2ZXIuIFN0YXR1c0NvZGU6ICR7cmVzcG9uc2Uuc3RhdHVzQ29kZX0sICR7dGhpcy5wcml2U3ludGhlc2l6ZXJDb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50KX0gUmVhc29uOiAke3Jlc3BvbnNlLnJlYXNvbn1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2U3ludGhlc2lzVHVybi5vbkF1dGhDb21wbGV0ZWQodHJ1ZSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gQXR0YWNoIGFuIGVtcHR5IGhhbmRsZXIgdG8gYWxsb3cgdGhlIHByb21pc2UgdG8gcnVuIGluIHRoZSBiYWNrZ3JvdW5kIHdoaWxlXG4gICAgICAgIC8vIG90aGVyIHN0YXJ0dXAgZXZlbnRzIGhhcHBlbi4gSXQnbGwgZXZlbnR1YWxseSBiZSBhd2FpdGVkIG9uLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Qcm9taXNlLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uUHJvbWlzZTtcbiAgICB9XG4gICAgc2VuZFNwZWVjaFNlcnZpY2VDb25maWcoY29ubmVjdGlvbiwgU3BlZWNoU2VydmljZUNvbmZpZ0pzb24pIHtcbiAgICAgICAgaWYgKFNwZWVjaFNlcnZpY2VDb25maWdKc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInNwZWVjaC5jb25maWdcIiwgdGhpcy5wcml2U3ludGhlc2lzVHVybi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvblwiLCBTcGVlY2hTZXJ2aWNlQ29uZmlnSnNvbikpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbmRTc21sTWVzc2FnZShjb25uZWN0aW9uLCBzc21sLCByZXF1ZXN0SWQpIHtcbiAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgXCJzc21sXCIsIHJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9zc21sK3htbFwiLCBzc21sKSk7XG4gICAgfVxuICAgIGZldGNoQ29ubmVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UudGhlbigoY29ubmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbi5zdGF0ZSgpID09PSBDb25uZWN0aW9uU3RhdGUuRGlzY29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ3VyYXRpb25Qcm9taXNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWd1cmF0aW9uUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2UgPSB0aGlzLmNvbmZpZ3VyZUNvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiB5aWVsZCB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlndXJhdGlvblByb21pc2U7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBUYWtlcyBhbiBlc3RhYmxpc2hlZCB3ZWJzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgZW5kcG9pbnQgYW5kIHNlbmRzIHNwZWVjaCBjb25maWd1cmF0aW9uIGluZm9ybWF0aW9uLlxuICAgIGNvbmZpZ3VyZUNvbm5lY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5jb25uZWN0SW1wbCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnQ29ubmVjdGlvbk92ZXJyaWRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWdDb25uZWN0aW9uT3ZlcnJpZGUoY29ubmVjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTcGVlY2hTZXJ2aWNlQ29uZmlnKGNvbm5lY3Rpb24sIHRoaXMucHJpdlN5bnRoZXNpemVyQ29uZmlnLlNwZWVjaFNlcnZpY2VDb25maWcuc2VyaWFsaXplKCkpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb247XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblN5bnRoZXNpc0FkYXB0ZXJCYXNlLnRlbGVtZXRyeURhdGFFbmFibGVkID0gdHJ1ZTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3ludGhlc2lzQWRhcHRlckJhc2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgSlNPTiB1c2VkIGluIHRoZSBzeW50aGVzaXMuY29udGV4dCBtZXNzYWdlIHNlbnQgdG8gdGhlIHNwZWVjaCBzZXJ2aWNlLlxuICogVGhlIGR5bmFtaWMgZ3JhbW1hciBpcyBhbHdheXMgcmVmcmVzaGVkIGZyb20gdGhlIGVuY2Fwc3VsYXRlZCBkeW5hbWljIGdyYW1tYXIgb2JqZWN0LlxuICovXG5leHBvcnQgY2xhc3MgU3ludGhlc2lzQ29udGV4dCB7XG4gICAgY29uc3RydWN0b3Ioc3BlZWNoU3ludGhlc2l6ZXIpIHtcbiAgICAgICAgdGhpcy5wcml2Q29udGV4dCA9IHt9O1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplciA9IHNwZWVjaFN5bnRoZXNpemVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgc2VjdGlvbiB0byB0aGUgc3ludGhlc2lzLmNvbnRleHQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSBzZWN0aW9uTmFtZSBOYW1lIG9mIHRoZSBzZWN0aW9uIHRvIGFkZC5cbiAgICAgKiBAcGFyYW0gdmFsdWUgSlNPTiBzZXJpYWxpemFibGUgb2JqZWN0IHRoYXQgcmVwcmVzZW50cyB0aGUgdmFsdWUuXG4gICAgICovXG4gICAgc2V0U2VjdGlvbihzZWN0aW9uTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2Q29udGV4dFtzZWN0aW9uTmFtZV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYXVkaW8gb3V0cHV0IGZvcm1hdCBmb3Igc3ludGhlc2lzIGNvbnRleHQgZ2VuZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0gZm9ybWF0IHtBdWRpb091dHB1dEZvcm1hdEltcGx9IHRoZSBvdXRwdXQgZm9ybWF0XG4gICAgICovXG4gICAgc2V0IGF1ZGlvT3V0cHV0Rm9ybWF0KGZvcm1hdCkge1xuICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dEZvcm1hdCA9IGZvcm1hdDtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICBjb25zdCBzeW50aGVzaXNTZWN0aW9uID0gdGhpcy5idWlsZFN5bnRoZXNpc0NvbnRleHQoKTtcbiAgICAgICAgdGhpcy5zZXRTZWN0aW9uKFwic3ludGhlc2lzXCIsIHN5bnRoZXNpc1NlY3Rpb24pO1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5wcml2Q29udGV4dCk7XG4gICAgfVxuICAgIGJ1aWxkU3ludGhlc2lzQ29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGF1ZGlvOiB7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGFPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgIGJvb2ttYXJrRW5hYmxlZDogKCEhdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIuYm9va21hcmtSZWFjaGVkKSxcbiAgICAgICAgICAgICAgICAgICAgcHVuY3R1YXRpb25Cb3VuZGFyeUVuYWJsZWQ6IHRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFB1bmN0dWF0aW9uQm91bmRhcnksICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLndvcmRCb3VuZGFyeSkpLFxuICAgICAgICAgICAgICAgICAgICBzZW50ZW5jZUJvdW5kYXJ5RW5hYmxlZDogdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0U2VudGVuY2VCb3VuZGFyeSwgZmFsc2UpLFxuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uRW5kRW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdmlzZW1lRW5hYmxlZDogKCEhdGhpcy5wcml2U3BlZWNoU3ludGhlc2l6ZXIudmlzZW1lUmVjZWl2ZWQpLFxuICAgICAgICAgICAgICAgICAgICB3b3JkQm91bmRhcnlFbmFibGVkOiB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkQm91bmRhcnksICghIXRoaXMucHJpdlNwZWVjaFN5bnRoZXNpemVyLndvcmRCb3VuZGFyeSkpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb3V0cHV0Rm9ybWF0OiB0aGlzLnByaXZBdWRpb091dHB1dEZvcm1hdC5yZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGFuZ3VhZ2U6IHtcbiAgICAgICAgICAgICAgICBhdXRvRGV0ZWN0aW9uOiB0aGlzLnByaXZTcGVlY2hTeW50aGVzaXplci5hdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bnRoZXNpc0NvbnRleHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBFdmVudFR5cGUsIFBsYXRmb3JtRXZlbnQgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBTcGVlY2hTeW50aGVzaXNFdmVudCBleHRlbmRzIFBsYXRmb3JtRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgcmVxdWVzdElkLCBldmVudFR5cGUgPSBFdmVudFR5cGUuSW5mbykge1xuICAgICAgICBzdXBlcihldmVudE5hbWUsIGV2ZW50VHlwZSk7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IHJlcXVlc3RJZDtcbiAgICB9XG4gICAgZ2V0IHJlcXVlc3RJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlcXVlc3RJZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgU3ludGhlc2lzVHJpZ2dlcmVkRXZlbnQgZXh0ZW5kcyBTcGVlY2hTeW50aGVzaXNFdmVudCB7XG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBzZXNzaW9uQXVkaW9EZXN0aW5hdGlvbklkLCB0dXJuQXVkaW9EZXN0aW5hdGlvbklkKSB7XG4gICAgICAgIHN1cGVyKFwiU3ludGhlc2lzVHJpZ2dlcmVkRXZlbnRcIiwgcmVxdWVzdElkKTtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbkF1ZGlvRGVzdGluYXRpb25JZCA9IHNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uSWQ7XG4gICAgICAgIHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uSWQgPSB0dXJuQXVkaW9EZXN0aW5hdGlvbklkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9TZXNzaW9uRGVzdGluYXRpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlc3Npb25BdWRpb0Rlc3RpbmF0aW9uSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb1R1cm5EZXN0aW5hdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb25JZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGluZ1RvU3ludGhlc2lzU2VydmljZUV2ZW50IGV4dGVuZHMgU3BlZWNoU3ludGhlc2lzRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICBzdXBlcihcIkNvbm5lY3RpbmdUb1N5bnRoZXNpc1NlcnZpY2VFdmVudFwiLCByZXF1ZXN0SWQpO1xuICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkID0gYXV0aEZldGNoRXZlbnRJZDtcbiAgICB9XG4gICAgZ2V0IGF1dGhGZXRjaEV2ZW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNTdGFydGVkRXZlbnQgZXh0ZW5kcyBTcGVlY2hTeW50aGVzaXNFdmVudCB7XG4gICAgY29uc3RydWN0b3IocmVxdWVzdElkLCBhdXRoRmV0Y2hFdmVudElkKSB7XG4gICAgICAgIHN1cGVyKFwiU3ludGhlc2lzU3RhcnRlZEV2ZW50XCIsIHJlcXVlc3RJZCk7XG4gICAgICAgIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQgPSBhdXRoRmV0Y2hFdmVudElkO1xuICAgIH1cbiAgICBnZXQgYXV0aEZldGNoRXZlbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1dGhGZXRjaEV2ZW50SWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXNFdmVudHMuanMubWFwXG4iLCJpbXBvcnQgeyBSZXN0Q29uZmlnQmFzZSwgUmVzdE1lc3NhZ2VBZGFwdGVyLCBSZXN0UmVxdWVzdFR5cGUsIH0gZnJvbSBcIi4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQsIH0gZnJvbSBcIi4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uRmFjdG9yeUJhc2UgfSBmcm9tIFwiLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4vSGVhZGVyTmFtZXNcIjtcbi8qKlxuICogSW1wbGVtZW50cyBtZXRob2RzIGZvciBzcGVha2VyIHJlY29nbml0aW9uIGNsYXNzZXMsIHNlbmRpbmcgcmVxdWVzdHMgdG8gZW5kcG9pbnRcbiAqIGFuZCBwYXJzaW5nIHJlc3BvbnNlIGludG8gZXhwZWN0ZWQgZm9ybWF0XG4gKiBAY2xhc3MgU3ludGhlc2lzUmVzdEFkYXB0ZXJcbiAqL1xuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc1Jlc3RBZGFwdGVyIHtcbiAgICBjb25zdHJ1Y3Rvcihjb25maWcsIGF1dGhlbnRpY2F0aW9uKSB7XG4gICAgICAgIGxldCBlbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQsIHVuZGVmaW5lZCk7XG4gICAgICAgIGlmICghZW5kcG9pbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCBcIndlc3R1c1wiKTtcbiAgICAgICAgICAgIGNvbnN0IGhvc3RTdWZmaXggPSBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pO1xuICAgICAgICAgICAgZW5kcG9pbnQgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIGBodHRwczovLyR7cmVnaW9ufS50dHMuc3BlZWNoJHtob3N0U3VmZml4fWApO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlVyaSA9IGAke2VuZHBvaW50fS9jb2duaXRpdmVzZXJ2aWNlcy92b2ljZXMvbGlzdGA7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBSZXN0Q29uZmlnQmFzZS5yZXF1ZXN0T3B0aW9ucztcbiAgICAgICAgdGhpcy5wcml2UmVzdEFkYXB0ZXIgPSBuZXcgUmVzdE1lc3NhZ2VBZGFwdGVyKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnByaXZBdXRoZW50aWNhdGlvbiA9IGF1dGhlbnRpY2F0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kcyBsaXN0IHZvaWNlcyByZXF1ZXN0IHRvIGVuZHBvaW50LlxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY29ubmVjdGlvbklkIC0gZ3VpZCBmb3IgY29ubmVjdGlvbklkXG4gICAgICogQHJldHVybnMge1Byb21pc2U8SVJlc3RSZXNwb25zZT59IHJlc3QgcmVzcG9uc2UgdG8gc3RhdHVzIHJlcXVlc3RcbiAgICAgKi9cbiAgICBnZXRWb2ljZXNMaXN0KGNvbm5lY3Rpb25JZCkge1xuICAgICAgICB0aGlzLnByaXZSZXN0QWRhcHRlci5zZXRIZWFkZXJzKEhlYWRlck5hbWVzLkNvbm5lY3Rpb25JZCwgY29ubmVjdGlvbklkKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1dGhlbnRpY2F0aW9uLmZldGNoKGNvbm5lY3Rpb25JZCkudGhlbigoYXV0aEluZm8pID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlc3RBZGFwdGVyLnNldEhlYWRlcnMoYXV0aEluZm8uaGVhZGVyTmFtZSwgYXV0aEluZm8udG9rZW4pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3RBZGFwdGVyLnJlcXVlc3QoUmVzdFJlcXVlc3RUeXBlLkdldCwgdGhpcy5wcml2VXJpKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXNSZXN0QWRhcHRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkLCBEZWZlcnJlZCwgRXZlbnRzIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsIH0gZnJvbSBcIi4uL3Nkay9BdWRpby9BdWRpb091dHB1dFN0cmVhbVwiO1xuaW1wb3J0IHsgTWV0YWRhdGFUeXBlIH0gZnJvbSBcIi4vU2VydmljZU1lc3NhZ2VzL1N5bnRoZXNpc0F1ZGlvTWV0YWRhdGFcIjtcbmltcG9ydCB7IFN5bnRoZXNpc0FkYXB0ZXJCYXNlIH0gZnJvbSBcIi4vU3ludGhlc2lzQWRhcHRlckJhc2VcIjtcbmltcG9ydCB7IENvbm5lY3RpbmdUb1N5bnRoZXNpc1NlcnZpY2VFdmVudCwgU3ludGhlc2lzU3RhcnRlZEV2ZW50LCBTeW50aGVzaXNUcmlnZ2VyZWRFdmVudCwgfSBmcm9tIFwiLi9TeW50aGVzaXNFdmVudHNcIjtcbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNUdXJuIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1N5bnRoZXNpemluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQgPSAwO1xuICAgICAgICB0aGlzLnByaXZJblR1cm4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2VGV4dE9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdk5leHRTZWFyY2hUZXh0SW5kZXggPSAwO1xuICAgICAgICB0aGlzLnByaXZTZW50ZW5jZU9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMucHJpdk5leHRTZWFyY2hTZW50ZW5jZUluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwgPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgLy8gV2UncmUgbm90IGluIGEgdHVybiwgc28gcmVzb2x2ZS5cbiAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0IHJlcXVlc3RJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlcXVlc3RJZDtcbiAgICB9XG4gICAgZ2V0IHN0cmVhbUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3RyZWFtSWQ7XG4gICAgfVxuICAgIHNldCBzdHJlYW1JZCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZTdHJlYW1JZCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgYXVkaW9PdXRwdXRGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb091dHB1dEZvcm1hdDtcbiAgICB9XG4gICAgc2V0IGF1ZGlvT3V0cHV0Rm9ybWF0KGZvcm1hdCkge1xuICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dEZvcm1hdCA9IGZvcm1hdDtcbiAgICB9XG4gICAgZ2V0IHR1cm5Db21wbGV0aW9uUHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBnZXQgaXNTeW50aGVzaXNFbmRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzU3ludGhlc2lzRW5kZWQ7XG4gICAgfVxuICAgIGdldCBpc1N5bnRoZXNpemluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzU3ludGhlc2l6aW5nO1xuICAgIH1cbiAgICBnZXQgY3VycmVudFRleHRPZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0T2Zmc2V0O1xuICAgIH1cbiAgICBnZXQgY3VycmVudFNlbnRlbmNlT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2VudGVuY2VPZmZzZXQ7XG4gICAgfVxuICAgIC8vIFRoZSBudW1iZXIgb2YgYnl0ZXMgcmVjZWl2ZWQgZm9yIGN1cnJlbnQgdHVyblxuICAgIGdldCBieXRlc1JlY2VpdmVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Qnl0ZXNSZWNlaXZlZDtcbiAgICB9XG4gICAgZ2V0IGF1ZGlvRHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb0R1cmF0aW9uO1xuICAgIH1cbiAgICBnZXRBbGxSZWNlaXZlZEF1ZGlvKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjZWl2ZWRBdWRpbykge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5wcml2UmVjZWl2ZWRBdWRpbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzU3ludGhlc2lzRW5kZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHRoaXMucmVhZEFsbEF1ZGlvRnJvbVN0cmVhbSgpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnByaXZSZWNlaXZlZEF1ZGlvKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldEFsbFJlY2VpdmVkQXVkaW9XaXRoSGVhZGVyKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVjZWl2ZWRBdWRpb1dpdGhIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVjZWl2ZWRBdWRpb1dpdGhIZWFkZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzU3ludGhlc2lzRW5kZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmF1ZGlvT3V0cHV0Rm9ybWF0Lmhhc0hlYWRlcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1ZGlvID0geWllbGQgdGhpcy5nZXRBbGxSZWNlaXZlZEF1ZGlvKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRBdWRpb1dpdGhIZWFkZXIgPSBTeW50aGVzaXNBZGFwdGVyQmFzZS5hZGRIZWFkZXIoYXVkaW8sIHRoaXMuYXVkaW9PdXRwdXRGb3JtYXQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZSZWNlaXZlZEF1ZGlvV2l0aEhlYWRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEFsbFJlY2VpdmVkQXVkaW8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXJ0TmV3U3ludGhlc2lzKHJlcXVlc3RJZCwgcmF3VGV4dCwgaXNTU01MLCBhdWRpb0Rlc3RpbmF0aW9uKSB7XG4gICAgICAgIHRoaXMucHJpdklzU3ludGhlc2lzRW5kZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNTeW50aGVzaXppbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnByaXZSZXF1ZXN0SWQgPSByZXF1ZXN0SWQ7XG4gICAgICAgIHRoaXMucHJpdlJhd1RleHQgPSByYXdUZXh0O1xuICAgICAgICB0aGlzLnByaXZJc1NTTUwgPSBpc1NTTUw7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtID0gbmV3IFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwoKTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9PdXRwdXRTdHJlYW0uZm9ybWF0ID0gdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQ7XG4gICAgICAgIHRoaXMucHJpdlJlY2VpdmVkQXVkaW8gPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZSZWNlaXZlZEF1ZGlvV2l0aEhlYWRlciA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQgPSAwO1xuICAgICAgICB0aGlzLnByaXZUZXh0T2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5wcml2TmV4dFNlYXJjaFRleHRJbmRleCA9IDA7XG4gICAgICAgIHRoaXMucHJpdlNlbnRlbmNlT2Zmc2V0ID0gMDtcbiAgICAgICAgdGhpcy5wcml2TmV4dFNlYXJjaFNlbnRlbmNlSW5kZXggPSAwO1xuICAgICAgICB0aGlzLnByaXZQYXJ0aWFsVmlzZW1lQW5pbWF0aW9uID0gXCJcIjtcbiAgICAgICAgaWYgKGF1ZGlvRGVzdGluYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb24gPSBhdWRpb0Rlc3RpbmF0aW9uO1xuICAgICAgICAgICAgdGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb24uZm9ybWF0ID0gdGhpcy5wcml2QXVkaW9PdXRwdXRGb3JtYXQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBTeW50aGVzaXNUcmlnZ2VyZWRFdmVudCh0aGlzLnJlcXVlc3RJZCwgdW5kZWZpbmVkLCBhdWRpb0Rlc3RpbmF0aW9uID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBhdWRpb0Rlc3RpbmF0aW9uLmlkKCkpKTtcbiAgICB9XG4gICAgb25QcmVDb25uZWN0aW9uU3RhcnQoYXV0aEZldGNoRXZlbnRJZCkge1xuICAgICAgICB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkID0gYXV0aEZldGNoRXZlbnRJZDtcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBDb25uZWN0aW5nVG9TeW50aGVzaXNTZXJ2aWNlRXZlbnQodGhpcy5wcml2UmVxdWVzdElkLCB0aGlzLnByaXZBdXRoRmV0Y2hFdmVudElkKSk7XG4gICAgfVxuICAgIG9uQXV0aENvbXBsZXRlZChpc0Vycm9yKSB7XG4gICAgICAgIGlmIChpc0Vycm9yKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkNvbm5lY3Rpb25Fc3RhYmxpc2hDb21wbGV0ZWQoc3RhdHVzQ29kZSkge1xuICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICB0aGlzLm9uRXZlbnQobmV3IFN5bnRoZXNpc1N0YXJ0ZWRFdmVudCh0aGlzLnJlcXVlc3RJZCwgdGhpcy5wcml2QXV0aEZldGNoRXZlbnRJZCkpO1xuICAgICAgICAgICAgdGhpcy5wcml2Qnl0ZXNSZWNlaXZlZCA9IDA7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PT0gNDAzKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblNlcnZpY2VSZXNwb25zZU1lc3NhZ2UocmVzcG9uc2VKc29uKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZUpzb24pO1xuICAgICAgICB0aGlzLnN0cmVhbUlkID0gcmVzcG9uc2UuYXVkaW8uc3RyZWFtSWQ7XG4gICAgfVxuICAgIG9uU2VydmljZVR1cm5FbmRSZXNwb25zZSgpIHtcbiAgICAgICAgdGhpcy5wcml2SW5UdXJuID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlR1cm5EZWZlcnJhbC5yZXNvbHZlKCk7XG4gICAgICAgIHRoaXMub25Db21wbGV0ZSgpO1xuICAgIH1cbiAgICBvblNlcnZpY2VUdXJuU3RhcnRSZXNwb25zZSgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2VHVybkRlZmVycmFsICYmICEhdGhpcy5wcml2SW5UdXJuKSB7XG4gICAgICAgICAgICAvLyBXaGF0PyBIb3cgYXJlIHdlIHN0YXJ0aW5nIGEgdHVybiB3aXRoIGFub3RoZXIgbm90IGRvbmU/XG4gICAgICAgICAgICB0aGlzLnByaXZUdXJuRGVmZXJyYWwucmVqZWN0KFwiQW5vdGhlciB0dXJuIHN0YXJ0ZWQgYmVmb3JlIGN1cnJlbnQgY29tcGxldGVkLlwiKTtcbiAgICAgICAgICAgIC8vIEF2b2lkIFVuaGFuZGxlZFByb21pc2VSZWplY3Rpb24gaWYgcHJpdlR1cm5EZWZlcnJhbCBpcyBub3QgYmVpbmcgYXdhaXRlZFxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsLnByb21pc2UudGhlbigpLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2SW5UdXJuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcml2VHVybkRlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgfVxuICAgIG9uQXVkaW9DaHVua1JlY2VpdmVkKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTeW50aGVzaXppbmcpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtLndyaXRlKGRhdGEpO1xuICAgICAgICAgICAgdGhpcy5wcml2Qnl0ZXNSZWNlaXZlZCArPSBkYXRhLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlR1cm5BdWRpb0Rlc3RpbmF0aW9uLndyaXRlKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG9uVGV4dEJvdW5kYXJ5RXZlbnQobWV0YWRhdGEpIHtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0T2Zmc2V0KG1ldGFkYXRhLkRhdGEudGV4dC5UZXh0LCBtZXRhZGF0YS5UeXBlKTtcbiAgICB9XG4gICAgb25WaXNlbWVNZXRhZGF0YVJlY2VpdmVkKG1ldGFkYXRhKSB7XG4gICAgICAgIGlmIChtZXRhZGF0YS5EYXRhLkFuaW1hdGlvbkNodW5rICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlBhcnRpYWxWaXNlbWVBbmltYXRpb24gKz0gbWV0YWRhdGEuRGF0YS5BbmltYXRpb25DaHVuaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblNlc3Npb25FbmQobWV0YWRhdGEpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9EdXJhdGlvbiA9IG1ldGFkYXRhLkRhdGEuT2Zmc2V0O1xuICAgIH1cbiAgICBkaXNwb3NlKCkge1xuICAgICAgICBpZiAoIXRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgIC8vIHdlIHNob3VsZCBoYXZlIGNvbXBsZXRlZCBieSBub3cuIElmIHdlIGRpZCBub3QgaXRzIGFuIHVua25vd24gZXJyb3IuXG4gICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblN0b3BTeW50aGVzaXppbmcoKSB7XG4gICAgICAgIHRoaXMub25Db21wbGV0ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB2aXNlbWUgYW5pbWF0aW9uIHN0cmluZyAobWVyZ2VkIGZyb20gYW5pbWF0aW9uIGNodW5rKSwgYW5kIGNsZWFycyB0aGUgaW50ZXJuYWxcbiAgICAgKiBwYXJ0aWFsIGFuaW1hdGlvbi5cbiAgICAgKi9cbiAgICBnZXRBbmRDbGVhclZpc2VtZUFuaW1hdGlvbigpIHtcbiAgICAgICAgY29uc3QgYW5pbWF0aW9uID0gdGhpcy5wcml2UGFydGlhbFZpc2VtZUFuaW1hdGlvbjtcbiAgICAgICAgdGhpcy5wcml2UGFydGlhbFZpc2VtZUFuaW1hdGlvbiA9IFwiXCI7XG4gICAgICAgIHJldHVybiBhbmltYXRpb247XG4gICAgfVxuICAgIG9uRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0aGUgdGV4dCBpcyBhbiBYTUwoU1NNTCkgdGFnXG4gICAgICogQHBhcmFtIHRleHRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN0YXRpYyBpc1htbFRhZyh0ZXh0KSB7XG4gICAgICAgIHJldHVybiB0ZXh0Lmxlbmd0aCA+PSAyICYmIHRleHRbMF0gPT09IFwiPFwiICYmIHRleHRbdGV4dC5sZW5ndGggLSAxXSA9PT0gXCI+XCI7XG4gICAgfVxuICAgIHVwZGF0ZVRleHRPZmZzZXQodGV4dCwgdHlwZSkge1xuICAgICAgICBpZiAodHlwZSA9PT0gTWV0YWRhdGFUeXBlLldvcmRCb3VuZGFyeSkge1xuICAgICAgICAgICAgdGhpcy5wcml2VGV4dE9mZnNldCA9IHRoaXMucHJpdlJhd1RleHQuaW5kZXhPZih0ZXh0LCB0aGlzLnByaXZOZXh0U2VhcmNoVGV4dEluZGV4KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZUZXh0T2Zmc2V0ID49IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZOZXh0U2VhcmNoVGV4dEluZGV4ID0gdGhpcy5wcml2VGV4dE9mZnNldCArIHRleHQubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZJc1NTTUwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud2l0aGluWG1sVGFnKHRoaXMucHJpdlRleHRPZmZzZXQpICYmICFTeW50aGVzaXNUdXJuLmlzWG1sVGFnKHRleHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRleHRPZmZzZXQodGV4dCwgdHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTZW50ZW5jZU9mZnNldCA9IHRoaXMucHJpdlJhd1RleHQuaW5kZXhPZih0ZXh0LCB0aGlzLnByaXZOZXh0U2VhcmNoU2VudGVuY2VJbmRleCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2U2VudGVuY2VPZmZzZXQgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk5leHRTZWFyY2hTZW50ZW5jZUluZGV4ID0gdGhpcy5wcml2U2VudGVuY2VPZmZzZXQgKyB0ZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2SXNTU01MKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndpdGhpblhtbFRhZyh0aGlzLnByaXZTZW50ZW5jZU9mZnNldCkgJiYgIVN5bnRoZXNpc1R1cm4uaXNYbWxUYWcodGV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGV4dE9mZnNldCh0ZXh0LCB0eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkNvbXBsZXRlKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2SXNTeW50aGVzaXppbmcpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdklzU3ludGhlc2l6aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByaXZJc1N5bnRoZXNpc0VuZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZJblR1cm4gPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZUdXJuQXVkaW9EZXN0aW5hdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2VHVybkF1ZGlvRGVzdGluYXRpb24uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUdXJuQXVkaW9EZXN0aW5hdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZWFkQWxsQXVkaW9Gcm9tU3RyZWFtKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdklzU3ludGhlc2lzRW5kZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNlaXZlZEF1ZGlvID0gbmV3IEFycmF5QnVmZmVyKHRoaXMuYnl0ZXNSZWNlaXZlZCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2QXVkaW9PdXRwdXRTdHJlYW0ucmVhZCh0aGlzLnByaXZSZWNlaXZlZEF1ZGlvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjZWl2ZWRBdWRpbyA9IG5ldyBBcnJheUJ1ZmZlcigwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBjdXJyZW50IGlkeCBpcyBpbiBYTUwoU1NNTCkgdGFnXG4gICAgICogQHBhcmFtIGlkeFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgd2l0aGluWG1sVGFnKGlkeCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmF3VGV4dC5pbmRleE9mKFwiPFwiLCBpZHggKyAxKSA+IHRoaXMucHJpdlJhd1RleHQuaW5kZXhPZihcIj5cIiwgaWR4ICsgMSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXNUdXJuLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250ZXh0LCBTcGVlY2hTZXJ2aWNlQ29uZmlnIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuZXhwb3J0IHZhciBTeW50aGVzaXNTZXJ2aWNlVHlwZTtcbihmdW5jdGlvbiAoU3ludGhlc2lzU2VydmljZVR5cGUpIHtcbiAgICBTeW50aGVzaXNTZXJ2aWNlVHlwZVtTeW50aGVzaXNTZXJ2aWNlVHlwZVtcIlN0YW5kYXJkXCJdID0gMF0gPSBcIlN0YW5kYXJkXCI7XG4gICAgU3ludGhlc2lzU2VydmljZVR5cGVbU3ludGhlc2lzU2VydmljZVR5cGVbXCJDdXN0b21cIl0gPSAxXSA9IFwiQ3VzdG9tXCI7XG59KShTeW50aGVzaXNTZXJ2aWNlVHlwZSB8fCAoU3ludGhlc2lzU2VydmljZVR5cGUgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIFN5bnRoZXNpemVyQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hTZXJ2aWNlQ29uZmlnLCBwYXJhbWV0ZXJzKSB7XG4gICAgICAgIHRoaXMucHJpdlN5bnRoZXNpc1NlcnZpY2VUeXBlID0gU3ludGhlc2lzU2VydmljZVR5cGUuU3RhbmRhcmQ7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFNlcnZpY2VDb25maWcgPSBzcGVlY2hTZXJ2aWNlQ29uZmlnID8gc3BlZWNoU2VydmljZUNvbmZpZyA6IG5ldyBTcGVlY2hTZXJ2aWNlQ29uZmlnKG5ldyBDb250ZXh0KG51bGwpKTtcbiAgICAgICAgdGhpcy5wcml2UGFyYW1ldGVycyA9IHBhcmFtZXRlcnM7XG4gICAgfVxuICAgIGdldCBwYXJhbWV0ZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFyYW1ldGVycztcbiAgICB9XG4gICAgZ2V0IHN5bnRoZXNpc1NlcnZpY2VUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3ludGhlc2lzU2VydmljZVR5cGU7XG4gICAgfVxuICAgIHNldCBzeW50aGVzaXNTZXJ2aWNlVHlwZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXNTZXJ2aWNlVHlwZSA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgU3BlZWNoU2VydmljZUNvbmZpZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFNlcnZpY2VDb25maWc7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TeW50aGVzaXplckNvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uLCB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBPdXRwdXRGb3JtYXQsIFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25GYWN0b3J5QmFzZSB9IGZyb20gXCIuL0Nvbm5lY3Rpb25GYWN0b3J5QmFzZVwiO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgSGVhZGVyTmFtZXMgfSBmcm9tIFwiLi9IZWFkZXJOYW1lc1wiO1xuaW1wb3J0IHsgUXVlcnlQYXJhbWV0ZXJOYW1lcyB9IGZyb20gXCIuL1F1ZXJ5UGFyYW1ldGVyTmFtZXNcIjtcbmV4cG9ydCBjbGFzcyBUcmFuc2NyaWJlckNvbm5lY3Rpb25GYWN0b3J5IGV4dGVuZHMgQ29ubmVjdGlvbkZhY3RvcnlCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5tdWx0aWF1ZGlvUmVsYXRpdmVVcmkgPSBcIi9zcGVlY2gvcmVjb2duaXRpb24vbXVsdGlhdWRpb1wiO1xuICAgIH1cbiAgICBjcmVhdGUoY29uZmlnLCBhdXRoSW5mbywgY29ubmVjdGlvbklkKSB7XG4gICAgICAgIGxldCBlbmRwb2ludCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQsIHVuZGVmaW5lZCk7XG4gICAgICAgIGNvbnN0IHJlZ2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCBcImNlbnRyYWx1c1wiKTtcbiAgICAgICAgY29uc3QgaG9zdFN1ZmZpeCA9IENvbm5lY3Rpb25GYWN0b3J5QmFzZS5nZXRIb3N0U3VmZml4KHJlZ2lvbik7XG4gICAgICAgIGNvbnN0IGhvc3REZWZhdWx0ID0gXCJ3c3M6Ly90cmFuc2NyaWJlLlwiICsgcmVnaW9uICsgXCIuY3RzLnNwZWVjaFwiICsgaG9zdFN1ZmZpeCArIHRoaXMubXVsdGlhdWRpb1JlbGF0aXZlVXJpO1xuICAgICAgICBjb25zdCBob3N0ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBob3N0RGVmYXVsdCk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAgIHRoaXMuc2V0UXVlcnlQYXJhbXMocXVlcnlQYXJhbXMsIGNvbmZpZywgZW5kcG9pbnQpO1xuICAgICAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICAgICAgICBlbmRwb2ludCA9IGhvc3Q7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICBpZiAoYXV0aEluZm8udG9rZW4gIT09IHVuZGVmaW5lZCAmJiBhdXRoSW5mby50b2tlbiAhPT0gXCJcIikge1xuICAgICAgICAgICAgaGVhZGVyc1thdXRoSW5mby5oZWFkZXJOYW1lXSA9IGF1dGhJbmZvLnRva2VuO1xuICAgICAgICB9XG4gICAgICAgIGhlYWRlcnNbSGVhZGVyTmFtZXMuQ29ubmVjdGlvbklkXSA9IGNvbm5lY3Rpb25JZDtcbiAgICAgICAgY29uZmlnLnBhcmFtZXRlcnMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9VcmwsIGVuZHBvaW50KTtcbiAgICAgICAgY29uc3QgZW5hYmxlQ29tcHJlc3Npb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1FbmFibGVXZWJzb2NrZXRDb21wcmVzc2lvblwiLCBcImZhbHNlXCIpID09PSBcInRydWVcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJzb2NrZXRDb25uZWN0aW9uKGVuZHBvaW50LCBxdWVyeVBhcmFtcywgaGVhZGVycywgbmV3IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIoKSwgUHJveHlJbmZvLmZyb21SZWNvZ25pemVyQ29uZmlnKGNvbmZpZyksIGVuYWJsZUNvbXByZXNzaW9uLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbiAgICBzZXRRdWVyeVBhcmFtcyhxdWVyeVBhcmFtcywgY29uZmlnLCBlbmRwb2ludFVybCkge1xuICAgICAgICBjb25zdCBlbmRwb2ludElkID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludElkLCB1bmRlZmluZWQpO1xuICAgICAgICBjb25zdCBsYW5ndWFnZSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlLCB1bmRlZmluZWQpO1xuICAgICAgICBpZiAoZW5kcG9pbnRJZCAmJiAhKFF1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3VzdG9tU3BlZWNoRGVwbG95bWVudElkIGluIHF1ZXJ5UGFyYW1zKSkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdXN0b21TcGVlY2hEZXBsb3ltZW50SWRdID0gZW5kcG9pbnRJZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGFuZ3VhZ2UgJiYgIShRdWVyeVBhcmFtZXRlck5hbWVzLkxhbmd1YWdlIGluIHF1ZXJ5UGFyYW1zKSkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5MYW5ndWFnZV0gPSBsYW5ndWFnZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB3b3JkTGV2ZWxUaW1pbmdzID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHMsIFwiZmFsc2VcIikudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIGNvbnN0IGRldGFpbGVkID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBPdXRwdXRGb3JtYXRbT3V0cHV0Rm9ybWF0LlNpbXBsZV0pICE9PSBPdXRwdXRGb3JtYXRbT3V0cHV0Rm9ybWF0LlNpbXBsZV07XG4gICAgICAgIGlmICh3b3JkTGV2ZWxUaW1pbmdzIHx8IGRldGFpbGVkKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdF0gPSBPdXRwdXRGb3JtYXRbT3V0cHV0Rm9ybWF0LkRldGFpbGVkXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0Q29tbW9uVXJsUGFyYW1zKGNvbmZpZywgcXVlcnlQYXJhbXMsIGVuZHBvaW50VXJsKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zY3JpYmVyQ29ubmVjdGlvbkZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlc3RDb25maWdCYXNlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5icm93c2VyL1Jlc3RDb25maWdCYXNlXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZyBleHRlbmRzIFJlc3RDb25maWdCYXNlIHtcbiAgICBzdGF0aWMgZ2V0IGhvc3QoKSB7XG4gICAgICAgIHJldHVybiBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZIb3N0O1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IGFwaVZlcnNpb24oKSB7XG4gICAgICAgIHJldHVybiBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZBcGlWZXJzaW9uO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0IGNsaWVudEFwcElkKCkge1xuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2Q2xpZW50QXBwSWQ7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgZGVmYXVsdExhbmd1YWdlQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdkRlZmF1bHRMYW5ndWFnZUNvZGU7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgcmVzdFBhdGgoKSB7XG4gICAgICAgIHJldHVybiBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZSZXN0UGF0aDtcbiAgICB9XG4gICAgc3RhdGljIGdldCB3ZWJTb2NrZXRQYXRoKCkge1xuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2V2ViU29ja2V0UGF0aDtcbiAgICB9XG4gICAgc3RhdGljIGdldCB0cmFuc2NyaXB0aW9uRXZlbnRLZXlzKCkge1xuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2VHJhbnNjcmlwdGlvbkV2ZW50S2V5cztcbiAgICB9XG59XG5Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZIb3N0ID0gXCJkZXYubWljcm9zb2Z0dHJhbnNsYXRvci5jb21cIjtcbkNvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdlJlc3RQYXRoID0gXCIvY2FwaXRvL3Jvb21cIjtcbkNvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdkFwaVZlcnNpb24gPSBcIjIuMFwiO1xuQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5wcml2RGVmYXVsdExhbmd1YWdlQ29kZSA9IFwiZW4tVVNcIjtcbkNvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdkNsaWVudEFwcElkID0gXCJGQzUzOUMyMi0xNzY3LTRGMUYtODRCQy1CNEQ4MTExMTRGMTVcIjtcbkNvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucHJpdldlYlNvY2tldFBhdGggPSBcIi9jYXBpdG8vdHJhbnNsYXRlXCI7XG5Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnByaXZUcmFuc2NyaXB0aW9uRXZlbnRLZXlzID0gW1wiaUNhbFVpZFwiLCBcImNhbGxJZFwiLCBcIm9yZ2FuaXplclwiLCBcIkZMQUNcIiwgXCJNVFVyaVwiLCBcIkRpZmZlcmVudGlhdGVHdWVzdFNwZWFrZXJzXCIsIFwiYXVkaW9yZWNvcmRpbmdcIiwgXCJUaHJlYWRpZFwiLCBcIk9yZ2FuaXplck1yaVwiLCBcIk9yZ2FuaXplclRlbmFudElkXCIsIFwiVXNlclRva2VuXCJdO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBQcm94eUluZm8sIFdlYnNvY2tldENvbm5lY3Rpb24gfSBmcm9tIFwiLi4vLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgY3JlYXRlR3VpZCB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4uLy4uL3Nkay9Db250cmFjdHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25GYWN0b3J5QmFzZSB9IGZyb20gXCIuLi9Db25uZWN0aW9uRmFjdG9yeUJhc2VcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25XZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlclwiO1xuLyoqXG4gKiBDcmVhdGUgYSBjb25uZWN0aW9uIHRvIHRoZSBDb252ZXJzYXRpb24gVHJhbnNsYXRvciB3ZWJzb2NrZXQgZm9yIHNlbmRpbmcgaW5zdGFudCBtZXNzYWdlcyBhbmQgY29tbWFuZHMsIGFuZCBmb3IgcmVjZWl2aW5nIHRyYW5zbGF0ZWQgbWVzc2FnZXMuXG4gKiBUaGUgY29udmVyc2F0aW9uIG11c3QgYWxyZWFkeSBoYXZlIGJlZW4gc3RhcnRlZCBvciBqb2luZWQuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25Db25uZWN0aW9uRmFjdG9yeSBleHRlbmRzIENvbm5lY3Rpb25GYWN0b3J5QmFzZSB7XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBjb25zdCBlbmRwb2ludEhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfSG9zdCwgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5ob3N0KTtcbiAgICAgICAgY29uc3QgY29ycmVsYXRpb25JZCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Db3JyZWxhdGlvbklkLCBjcmVhdGVHdWlkKCkpO1xuICAgICAgICBjb25zdCBlbmRwb2ludCA9IGB3c3M6Ly8ke2VuZHBvaW50SG9zdH0ke0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcud2ViU29ja2V0UGF0aH1gO1xuICAgICAgICBjb25zdCB0b2tlbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ub2tlbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAgIHF1ZXJ5UGFyYW1zW0NvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuY29uZmlnUGFyYW1zLmFwaVZlcnNpb25dID0gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5hcGlWZXJzaW9uO1xuICAgICAgICBxdWVyeVBhcmFtc1tDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmNvbmZpZ1BhcmFtcy50b2tlbl0gPSB0b2tlbjtcbiAgICAgICAgcXVlcnlQYXJhbXNbQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5jb25maWdQYXJhbXMuY29ycmVsYXRpb25JZF0gPSBjb3JyZWxhdGlvbklkO1xuICAgICAgICBjb25zdCBlbmFibGVDb21wcmVzc2lvbiA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFwiU1BFRUNILUVuYWJsZVdlYnNvY2tldENvbXByZXNzaW9uXCIsIFwiZmFsc2VcIikgPT09IFwidHJ1ZVwiO1xuICAgICAgICByZXR1cm4gbmV3IFdlYnNvY2tldENvbm5lY3Rpb24oZW5kcG9pbnQsIHF1ZXJ5UGFyYW1zLCB7fSwgbmV3IENvbnZlcnNhdGlvbldlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIoKSwgUHJveHlJbmZvLmZyb21SZWNvZ25pemVyQ29uZmlnKGNvbmZpZyksIGVuYWJsZUNvbXByZXNzaW9uLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uQ29ubmVjdGlvbkZhY3RvcnkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UgZXh0ZW5kcyBDb25uZWN0aW9uTWVzc2FnZSB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZVR5cGUsIGJvZHksIGhlYWRlcnMsIGlkKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2VUeXBlLCBib2R5LCBoZWFkZXJzLCBpZCk7XG4gICAgICAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKHRoaXMudGV4dEJvZHkpO1xuICAgICAgICBpZiAoanNvbi50eXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbk1lc3NhZ2VUeXBlID0ganNvbi50eXBlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBjb252ZXJzYXRpb25NZXNzYWdlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbnZlcnNhdGlvbk1lc3NhZ2VUeXBlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlc3RNZXNzYWdlQWRhcHRlciwgUmVzdFJlcXVlc3RUeXBlIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi8uLi9zZGsvQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4uLy4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZ1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbk1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvL1xuICAgICAgICB0aGlzLnByaXZSZXF1ZXN0UGFyYW1zID0gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5jb25maWdQYXJhbXM7XG4gICAgICAgIHRoaXMucHJpdkVycm9ycyA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucmVzdEVycm9ycztcbiAgICAgICAgdGhpcy5wcml2SG9zdCA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuaG9zdDtcbiAgICAgICAgdGhpcy5wcml2QXBpVmVyc2lvbiA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuYXBpVmVyc2lvbjtcbiAgICAgICAgdGhpcy5wcml2UmVzdFBhdGggPSBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLnJlc3RQYXRoO1xuICAgICAgICB0aGlzLnByaXZSZXN0QWRhcHRlciA9IG5ldyBSZXN0TWVzc2FnZUFkYXB0ZXIoe30pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYWtlIGEgUE9TVCByZXF1ZXN0IHRvIHRoZSBDb252ZXJzYXRpb24gTWFuYWdlciBzZXJ2aWNlIGVuZHBvaW50IHRvIGNyZWF0ZSBvciBqb2luIGEgY29udmVyc2F0aW9uLlxuICAgICAqIEBwYXJhbSBhcmdzXG4gICAgICogQHBhcmFtIGNvbnZlcnNhdGlvbkNvZGVcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgKiBAcGFyYW0gZXJyb3JDYWxsYmFja1xuICAgICAqL1xuICAgIGNyZWF0ZU9ySm9pbihhcmdzLCBjb252ZXJzYXRpb25Db2RlLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChhcmdzLCBcImFyZ3NcIik7XG4gICAgICAgICAgICBjb25zdCBsYW5ndWFnZUNvZGUgPSBhcmdzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlLCBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmRlZmF1bHRMYW5ndWFnZUNvZGUpO1xuICAgICAgICAgICAgY29uc3Qgbmlja25hbWUgPSBhcmdzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lLCBcImNvbnZlcnNhdGlvbl9ob3N0XCIpO1xuICAgICAgICAgICAgY29uc3QgZW5kcG9pbnRIb3N0ID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfSG9zdCwgdGhpcy5wcml2SG9zdCk7XG4gICAgICAgICAgICBjb25zdCBjb3JyZWxhdGlvbklkID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfQ29ycmVsYXRpb25JZCk7XG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25LZXkgPSBhcmdzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvblJlZ2lvbiA9IGFyZ3MuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24pO1xuICAgICAgICAgICAgY29uc3QgYXV0aFRva2VuID0gYXJncy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShsYW5ndWFnZUNvZGUsIFwibGFuZ3VhZ2VDb2RlXCIpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG5pY2tuYW1lLCBcIm5pY2tuYW1lXCIpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGVuZHBvaW50SG9zdCwgXCJlbmRwb2ludEhvc3RcIik7XG4gICAgICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICAgICAgcXVlcnlQYXJhbXNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5hcGlWZXJzaW9uXSA9IHRoaXMucHJpdkFwaVZlcnNpb247XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLmxhbmd1YWdlQ29kZV0gPSBsYW5ndWFnZUNvZGU7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLm5pY2tuYW1lXSA9IG5pY2tuYW1lO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgaWYgKGNvcnJlbGF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMuY29ycmVsYXRpb25JZF0gPSBjb3JyZWxhdGlvbklkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVhZGVyc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLmNsaWVudEFwcElkXSA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuY2xpZW50QXBwSWQ7XG4gICAgICAgICAgICBpZiAoY29udmVyc2F0aW9uQ29kZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbXNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5yb29tSWRdID0gY29udmVyc2F0aW9uQ29kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHN1YnNjcmlwdGlvblJlZ2lvbiwgdGhpcy5wcml2RXJyb3JzLmF1dGhJbnZhbGlkU3Vic2NyaXB0aW9uUmVnaW9uKTtcbiAgICAgICAgICAgICAgICBoZWFkZXJzW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMuc3Vic2NyaXB0aW9uUmVnaW9uXSA9IHN1YnNjcmlwdGlvblJlZ2lvbjtcbiAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbdGhpcy5wcml2UmVxdWVzdFBhcmFtcy5zdWJzY3JpcHRpb25LZXldID0gc3Vic2NyaXB0aW9uS2V5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChhdXRoVG9rZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLmF1dGhvcml6YXRpb25dID0gYEJlYXJlciAke2F1dGhUb2tlbn1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoc3Vic2NyaXB0aW9uS2V5LCB0aGlzLnByaXZFcnJvcnMuYXV0aEludmFsaWRTdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHt9O1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVzdEFkYXB0ZXIub3B0aW9ucyA9IGNvbmZpZztcbiAgICAgICAgICAgIGNvbnN0IGVuZHBvaW50ID0gYGh0dHBzOi8vJHtlbmRwb2ludEhvc3R9JHt0aGlzLnByaXZSZXN0UGF0aH1gO1xuICAgICAgICAgICAgLy8gVE9ETzogc3VwcG9ydCBhIHByb3h5IGFuZCBjZXJ0aWZpY2F0ZSB2YWxpZGF0aW9uXG4gICAgICAgICAgICB0aGlzLnByaXZSZXN0QWRhcHRlci5yZXF1ZXN0KFJlc3RSZXF1ZXN0VHlwZS5Qb3N0LCBlbmRwb2ludCwgcXVlcnlQYXJhbXMsIG51bGwpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdElkID0gUmVzdE1lc3NhZ2VBZGFwdGVyLmV4dHJhY3RIZWFkZXJWYWx1ZSh0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLnJlcXVlc3RJZCwgcmVzcG9uc2UuaGVhZGVycyk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSB0aGlzLnByaXZFcnJvcnMuaW52YWxpZENyZWF0ZUpvaW5Db252ZXJzYXRpb25SZXNwb25zZS5yZXBsYWNlKFwie3N0YXR1c31cIiwgcmVzcG9uc2Uuc3RhdHVzLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVyck1lc3NhZ2VSYXc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyck1lc3NhZ2VSYXcgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSBgIFske2Vyck1lc3NhZ2VSYXcuZXJyb3IuY29kZX06ICR7ZXJyTWVzc2FnZVJhdy5lcnJvci5tZXNzYWdlfV1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgKz0gYCBbJHtyZXNwb25zZS5kYXRhfV1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSBgICR7cmVxdWVzdElkfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvbiA9IEpTT04ucGFyc2UocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnZlcnNhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb252ZXJzYXRpb24ucmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2IoY29udmVyc2F0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNiID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ha2UgYSBERUxFVEUgcmVxdWVzdCB0byB0aGUgQ29udmVyc2F0aW9uIE1hbmFnZXIgc2VydmljZSBlbmRwb2ludCB0byBsZWF2ZSB0aGUgY29udmVyc2F0aW9uLlxuICAgICAqIEBwYXJhbSBhcmdzXG4gICAgICogQHBhcmFtIHNlc3Npb25Ub2tlblxuICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAqL1xuICAgIGxlYXZlKGFyZ3MsIHNlc3Npb25Ub2tlbikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChhcmdzLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwiY29uZmlnXCIpKTtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc2Vzc2lvblRva2VuLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwidG9rZW5cIikpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVuZHBvaW50SG9zdCA9IGFyZ3MuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX0hvc3QsIHRoaXMucHJpdkhvc3QpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvcnJlbGF0aW9uSWQgPSBhcmdzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Db3JyZWxhdGlvbklkKTtcbiAgICAgICAgICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMuYXBpVmVyc2lvbl0gPSB0aGlzLnByaXZBcGlWZXJzaW9uO1xuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW3RoaXMucHJpdlJlcXVlc3RQYXJhbXMuc2Vzc2lvblRva2VuXSA9IHNlc3Npb25Ub2tlbjtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgICAgICAgICAgaWYgKGNvcnJlbGF0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1t0aGlzLnByaXZSZXF1ZXN0UGFyYW1zLmNvcnJlbGF0aW9uSWRdID0gY29ycmVsYXRpb25JZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0ge307XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlc3RBZGFwdGVyLm9wdGlvbnMgPSBjb25maWc7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5kcG9pbnQgPSBgaHR0cHM6Ly8ke2VuZHBvaW50SG9zdH0ke3RoaXMucHJpdlJlc3RQYXRofWA7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogc3VwcG9ydCBhIHByb3h5IGFuZCBjZXJ0aWZpY2F0ZSB2YWxpZGF0aW9uXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVzdEFkYXB0ZXIucmVxdWVzdChSZXN0UmVxdWVzdFR5cGUuRGVsZXRlLCBlbmRwb2ludCwgcXVlcnlQYXJhbXMsIG51bGwpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgb24gZGVsZXRlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25NYW5hZ2VyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQsIERlZmVycmVkLCB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuLyoqXG4gKiBQbGFjZWhvbGRlciBjbGFzcyBmb3IgdGhlIENvbnZlcnNhdGlvbiBSZXF1ZXN0IFNlc3Npb24uIEJhc2VkIG9mZiBSZXF1ZXN0U2Vzc2lvbi5cbiAqIFRPRE86IGRlZmluZSB3aGF0IHRlbGVtZXRyeSBpcyByZXF1aXJlZC5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblJlcXVlc3RTZXNzaW9uIHtcbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZEZXRhY2hhYmxlcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLnByaXZTZXNzaW9uSWQgPSBzZXNzaW9uSWQ7XG4gICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2UmVxdWVzdENvbXBsZXRpb25EZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgIH1cbiAgICBnZXQgc2Vzc2lvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2Vzc2lvbklkO1xuICAgIH1cbiAgICBnZXQgcmVxdWVzdElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVxdWVzdElkO1xuICAgIH1cbiAgICBnZXQgY29tcGxldGlvblByb21pc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXF1ZXN0Q29tcGxldGlvbkRlZmVycmFsLnByb21pc2U7XG4gICAgfVxuICAgIG9uUHJlQ29ubmVjdGlvblN0YXJ0KGF1dGhGZXRjaEV2ZW50SWQsIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICB0aGlzLnByaXZTZXNzaW9uSWQgPSBjb25uZWN0aW9uSWQ7XG4gICAgfVxuICAgIG9uQXV0aENvbXBsZXRlZChpc0Vycm9yKSB7XG4gICAgICAgIGlmIChpc0Vycm9yKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkNvbm5lY3Rpb25Fc3RhYmxpc2hDb21wbGV0ZWQoc3RhdHVzQ29kZSkge1xuICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzQ29kZSA9PT0gNDAzKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvblNlcnZpY2VUdXJuRW5kUmVzcG9uc2UoY29udGludW91c1JlY29nbml0aW9uKSB7XG4gICAgICAgIGlmICghY29udGludW91c1JlY29nbml0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLm9uQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkaXNwb3NlKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICAgICAgLy8gd2Ugc2hvdWxkIGhhdmUgY29tcGxldGVkIGJ5IG5vdy4gSWYgd2UgZGlkIG5vdCBpdHMgYW4gdW5rbm93biBlcnJvci5cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRldGFjaGFibGUgb2YgdGhpcy5wcml2RGV0YWNoYWJsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgZGV0YWNoYWJsZS5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvbkNvbXBsZXRlKCkge1xuICAgICAgICAvL1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgQ29ubmVjdGlvblN0YXRlLCBjcmVhdGVOb0Rhc2hHdWlkLCBEZWZlcnJlZCwgTWVzc2FnZVR5cGUsIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgQ29udmVyc2F0aW9uRXhwaXJhdGlvbkV2ZW50QXJncywgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncywgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25SZXN1bHQsIFJlc3VsdFJlYXNvbiwgVHJhbnNsYXRpb25zIH0gZnJvbSBcIi4uLy4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb2duaXRpdmVUb2tlbkF1dGhlbnRpY2F0aW9uLCBTZXJ2aWNlUmVjb2duaXplckJhc2UgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25Db25uZWN0aW9uTWVzc2FnZVwiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uUmVxdWVzdFNlc3Npb24gfSBmcm9tIFwiLi9Db252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvblwiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uUmVjZWl2ZWRUcmFuc2xhdGlvbkV2ZW50QXJncywgTG9ja1Jvb21FdmVudEFyZ3MsIE11dGVBbGxFdmVudEFyZ3MsIFBhcnRpY2lwYW50QXR0cmlidXRlRXZlbnRBcmdzLCBQYXJ0aWNpcGFudEV2ZW50QXJncywgUGFydGljaXBhbnRzTGlzdEV2ZW50QXJncyB9IGZyb20gXCIuL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JFdmVudEFyZ3NcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMsIENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25UcmFuc2xhdG9ySW50ZXJmYWNlc1wiO1xuaW1wb3J0IHsgQ29tbWFuZFJlc3BvbnNlUGF5bG9hZCwgUGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UsIFBhcnRpY2lwYW50c0xpc3RQYXlsb2FkUmVzcG9uc2UsIFNwZWVjaFJlc3BvbnNlUGF5bG9hZCwgVGV4dFJlc3BvbnNlUGF5bG9hZCB9IGZyb20gXCIuL1NlcnZpY2VNZXNzYWdlcy9FeHBvcnRzXCI7XG4vKipcbiAqIFRoZSBzZXJ2aWNlIGFkYXB0ZXIgaGFuZGxlcyBzZW5kaW5nIGFuZCByZWNlaXZpbmcgbWVzc2FnZXMgdG8gdGhlIENvbnZlcnNhdGlvbiBUcmFuc2xhdG9yIHdlYnNvY2tldC5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblNlcnZpY2VBZGFwdGVyIGV4dGVuZHMgU2VydmljZVJlY29nbml6ZXJCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCBjb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yKSB7XG4gICAgICAgIHN1cGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIGNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlnUHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2TGFzdFBhcnRpYWxVdHRlcmFuY2VJZCA9IFwiXCI7XG4gICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IgPSBjb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yO1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25BdXRoZW50aWNhdGlvbiA9IGF1dGhlbnRpY2F0aW9uO1xuICAgICAgICB0aGlzLnJlY2VpdmVNZXNzYWdlT3ZlcnJpZGUgPSAoKSA9PiB0aGlzLnJlY2VpdmVDb252ZXJzYXRpb25NZXNzYWdlT3ZlcnJpZGUoKTtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVPdmVycmlkZSA9ICgpID0+IHRoaXMubm9PcCgpO1xuICAgICAgICB0aGlzLnBvc3RDb25uZWN0SW1wbE92ZXJyaWRlID0gKGNvbm5lY3Rpb24pID0+IHRoaXMuY29udmVyc2F0aW9uQ29ubmVjdEltcGwoY29ubmVjdGlvbik7XG4gICAgICAgIHRoaXMuY29uZmlnQ29ubmVjdGlvbk92ZXJyaWRlID0gKCkgPT4gdGhpcy5jb25maWdDb25uZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdE92ZXJyaWRlID0gKCkgPT4gdGhpcy5wcml2RGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbiA9IG5ldyBDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbihjcmVhdGVOb0Rhc2hHdWlkKCkpO1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25Db25uZWN0aW9uRmFjdG9yeSA9IGNvbm5lY3Rpb25GYWN0b3J5O1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25Jc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgfVxuICAgIGlzRGlzcG9zZWQoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5pc0Rpc3Bvc2VkKCkgfHwgdGhpcy5wcml2Q29udmVyc2F0aW9uSXNEaXNwb3NlZDtcbiAgICB9XG4gICAgZGlzcG9zZShyZWFzb24pIHtcbiAgICAgICAgY29uc3QgX3N1cGVyID0gT2JqZWN0LmNyZWF0ZShudWxsLCB7XG4gICAgICAgICAgICBkaXNwb3NlOiB7IGdldDogKCkgPT4gc3VwZXIuZGlzcG9zZSB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uSXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlnUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCBjb25uZWN0aW9uLmRpc3Bvc2UocmVhc29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgcmVhc29uKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbm5lY3Rpb24uc2VuZChuZXcgQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgbWVzc2FnZSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZE1lc3NhZ2VBc3luYyhtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHlpZWxkIGNvbm5lY3Rpb24uc2VuZChuZXcgQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgbWVzc2FnZSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcHJpdkRpc2Nvbm5lY3QoKSB7XG4gICAgICAgIGlmICh0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbih0aGlzLnByaXZDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQsIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yLCBDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvciwgXCJEaXNjb25uZWN0aW5nXCIpO1xuICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3JlcXVpcmUtYXdhaXRcbiAgICBwcm9jZXNzVHlwZVNwZWNpZmljTWVzc2FnZXMoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb24oc2Vzc2lvbklkLCByZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gdHJ1ZTtcbiAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBuZXcgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncyhjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yLCBlcnJvckNvZGUsIHVuZGVmaW5lZCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLmNhbmNlbGVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIGNhbmNlbEV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoX2EpIHtcbiAgICAgICAgICAgIC8vIGNvbnRpbnVlIG9uIGVycm9yXG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRXN0YWJsaXNoZXMgYSB3ZWJzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgZW5kIHBvaW50LlxuICAgICAqL1xuICAgIGNvbnZlcnNhdGlvbkNvbm5lY3RJbXBsKGNvbm5lY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25Mb29wID0gdGhpcy5zdGFydE1lc3NhZ2VMb29wKCk7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgaW5jb21pbmcgd2Vic29ja2V0IG1lc3NhZ2VzXG4gICAgICovXG4gICAgcmVjZWl2ZUNvbnZlcnNhdGlvbk1lc3NhZ2VPdmVycmlkZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQoKSB8fCB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gd2Ugd29uJ3QgcmVseSBvbiB0aGUgY2FzY2FkaW5nIHByb21pc2VzIG9mIHRoZSBjb25uZWN0aW9uIHNpbmNlIHdlIHdhbnQgdG8gY29udGludWFsbHkgYmUgYXZhaWxhYmxlIHRvIHJlY2VpdmUgbWVzc2FnZXNcbiAgICAgICAgICAgIGNvbnN0IGNvbW11bmljYXRpb25DdXN0b2RpYW4gPSBuZXcgRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IHlpZWxkIGNvbm5lY3Rpb24ucmVhZCgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQoKSB8fCB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlJ3JlIGRvbmUuXG4gICAgICAgICAgICAgICAgICAgIGNvbW11bmljYXRpb25DdXN0b2RpYW4ucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlQ29udmVyc2F0aW9uTWVzc2FnZU92ZXJyaWRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHNlc3Npb25JZCA9IHRoaXMucHJpdkNvbnZlcnNhdGlvblJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZDtcbiAgICAgICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25NZXNzYWdlVHlwZSA9IG1lc3NhZ2UuY29udmVyc2F0aW9uTWVzc2FnZVR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBsZXQgc2VuZEZpbmFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjb252ZXJzYXRpb25NZXNzYWdlVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImluZm9cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwYXJ0aWNpcGFudF9jb21tYW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY29tbWFuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbW1hbmRQYXlsb2FkID0gQ29tbWFuZFJlc3BvbnNlUGF5bG9hZC5mcm9tSlNPTihtZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmRQYXlsb2FkLmNvbW1hbmQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1BhcnRpY3BhbnRMaXN0JyBpcyB0aGUgZmlyc3QgbWVzc2FnZSBzZW50IHRvIHRoZSB1c2VyIGFmdGVyIHRoZSB3ZWJzb2NrZXQgY29ubmVjdGlvbiBoYXMgb3BlbmVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGUgY29uc3VtaW5nIGNsaWVudCBtdXN0IHdhaXQgZm9yIHRoaXMgbWVzc2FnZSB0byBhcnJpdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogYmVmb3JlIHN0YXJ0aW5nIHRvIHNlbmQgdGhlaXIgb3duIGRhdGEuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicGFydGljaXBhbnRsaXN0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNpcGFudHNQYXlsb2FkID0gUGFydGljaXBhbnRzTGlzdFBheWxvYWRSZXNwb25zZS5mcm9tSlNPTihtZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRpY2lwYW50c1Jlc3VsdCA9IHBhcnRpY2lwYW50c1BheWxvYWQucGFydGljaXBhbnRzLm1hcCgocCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRpY2lwYW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdmF0YXI6IHAuYXZhdGFyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogcC5uaWNrbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHAucGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIb3N0OiBwLmlzaG9zdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNdXRlZDogcC5pc211dGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1VzaW5nVHRzOiBwLnVzZXR0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkTGFuZ3VhZ2U6IHAubG9jYWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFydGljaXBhbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRzTGlzdFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudHNMaXN0UmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IFBhcnRpY2lwYW50c0xpc3RFdmVudEFyZ3MocGFydGljaXBhbnRzUGF5bG9hZC5yb29taWQsIHBhcnRpY2lwYW50c1BheWxvYWQudG9rZW4sIHBhcnRpY2lwYW50c1BheWxvYWQudHJhbnNsYXRlVG8sIHBhcnRpY2lwYW50c1BheWxvYWQucHJvZmFuaXR5RmlsdGVyLCBwYXJ0aWNpcGFudHNQYXlsb2FkLnJvb21Qcm9mYW5pdHlGaWx0ZXIsIHBhcnRpY2lwYW50c1BheWxvYWQucm9vbUxvY2tlZCwgcGFydGljaXBhbnRzUGF5bG9hZC5tdXRlQWxsLCBwYXJ0aWNpcGFudHNSZXN1bHQsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnU2V0VHJhbnNsYXRlVG9MYW5ndWFnZXMnIHJlcHJlc2VudHMgdGhlIGxpc3Qgb2YgbGFuZ3VhZ2VzIGJlaW5nIHVzZWQgaW4gdGhlIENvbnZlcnNhdGlvbiBieSBhbGwgdXNlcnMoPykuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFRoaXMgaXMgc2VudCBhdCB0aGUgc3RhcnQgb2YgdGhlIENvbnZlcnNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNldHRyYW5zbGF0ZXRvbGFuZ3VhZ2VzXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgUGFydGljaXBhbnRBdHRyaWJ1dGVFdmVudEFyZ3MoY29tbWFuZFBheWxvYWQucGFydGljaXBhbnRJZCwgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRUcmFuc2xhdGVUb0xhbmd1YWdlcywgY29tbWFuZFBheWxvYWQudmFsdWUsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnU2V0UHJvZmFuaXR5RmlsdGVyaW5nJyBsZXRzIHRoZSBjbGllbnQgc2V0IHRoZSBsZXZlbCBvZiBwcm9mYW5pdHkgZmlsdGVyaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBJZiBzZW50IGJ5IHRoZSBwYXJ0aWNpcGFudCB0aGUgc2V0dGluZyB3aWxsIGVmZmVjdCBvbmx5IHRoZWlyIG93biBwcm9mYW5pdHkgbGV2ZWwuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIElmIHNlbnQgYnkgdGhlIGhvc3QsIHRoZSBzZXR0aW5nIHdpbGwgZWZmZWN0IGFsbCBwYXJ0aWNpcGFudHMgaW5jbHVkaW5nIHRoZSBob3N0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBOb3RlOiB0aGUgcHJvZmFuaXR5IGZpbHRlcnMgZGlmZmVyIGZyb20gU3BlZWNoIFNlcnZpY2UgKD8pOiAnbWFya2VkJywgJ3JhdycsICdyZW1vdmVkJywgJ3RhZ2dlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZXRwcm9mYW5pdHlmaWx0ZXJpbmdcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBQYXJ0aWNpcGFudEF0dHJpYnV0ZUV2ZW50QXJncyhjb21tYW5kUGF5bG9hZC5wYXJ0aWNpcGFudElkLCBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldFByb2Zhbml0eUZpbHRlcmluZywgY29tbWFuZFBheWxvYWQudmFsdWUsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnU2V0TXV0ZScgaXMgc2VudCBpZiB0aGUgcGFydGljaXBhbnQgaGFzIGJlZW4gbXV0ZWQgYnkgdGhlIGhvc3QuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENoZWNrIHRoZSAncGFydGljaXBhbnRJZCcgdG8gZGV0ZXJtaW5lIGlmIHRoZSBjdXJyZW50IHVzZXIgaGFzIGJlZW4gbXV0ZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2V0bXV0ZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IFBhcnRpY2lwYW50QXR0cmlidXRlRXZlbnRBcmdzKGNvbW1hbmRQYXlsb2FkLnBhcnRpY2lwYW50SWQsIENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0TXV0ZSwgY29tbWFuZFBheWxvYWQudmFsdWUsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnU2V0TXV0ZUFsbCcgaXMgc2VudCBpZiB0aGUgQ29udmVyc2F0aW9uIGhhcyBiZWVuIG11dGVkIGJ5IHRoZSBob3N0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNldG11dGVhbGxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IubXV0ZUFsbENvbW1hbmRSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IubXV0ZUFsbENvbW1hbmRSZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgTXV0ZUFsbEV2ZW50QXJncyhjb21tYW5kUGF5bG9hZC52YWx1ZSwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICdSb29tRXhwaXJhdGlvbldhcm5pbmcnIGlzIHNlbnQgdG93YXJkcyB0aGUgZW5kIG9mIHRoZSBDb252ZXJzYXRpb24gc2Vzc2lvbiB0byBnaXZlIGEgdGltZW91dCB3YXJuaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInJvb21leHBpcmF0aW9ud2FybmluZ1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5jb252ZXJzYXRpb25FeHBpcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5jb252ZXJzYXRpb25FeHBpcmF0aW9uKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBDb252ZXJzYXRpb25FeHBpcmF0aW9uRXZlbnRBcmdzKGNvbW1hbmRQYXlsb2FkLnZhbHVlLCB0aGlzLnByaXZDb252ZXJzYXRpb25SZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ1NldFVzZVR0cycgaXMgc2VudCBhcyBhIGNvbmZpcm1hdGlvbiBpZiB0aGUgdXNlciByZXF1ZXN0cyBUVFMgdG8gYmUgdHVybmVkIG9uIG9yIG9mZi5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZXR1c2V0dHNcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IsIG5ldyBQYXJ0aWNpcGFudEF0dHJpYnV0ZUV2ZW50QXJncyhjb21tYW5kUGF5bG9hZC5wYXJ0aWNpcGFudElkLCBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldFVzZVRUUywgY29tbWFuZFBheWxvYWQudmFsdWUsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnU2V0TG9ja1N0YXRlJyBpcyBzZXQgaWYgdGhlIGhvc3QgaGFzIGxvY2tlZCBvciB1bmxvY2tlZCB0aGUgQ29udmVyc2F0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNldGxvY2tzdGF0ZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5sb2NrUm9vbUNvbW1hbmRSZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IubG9ja1Jvb21Db21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IExvY2tSb29tRXZlbnRBcmdzKGNvbW1hbmRQYXlsb2FkLnZhbHVlLCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ0NoYW5nZU5pY2tuYW1lJyBpcyByZWNlaXZlZCBpZiBhIHVzZXIgY2hhbmdlcyB0aGVpciBkaXNwbGF5IG5hbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEFueSBjYWNoZWQgcGFydGljcGlhbnRzIGxpc3Qgc2hvdWxkIGJlIHVwZGF0ZWQgdG8gcmVmbGVjdCB0aGUgZGlzcGxheSBuYW1lLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImNoYW5nZW5pY2tuYW1lXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50VXBkYXRlQ29tbWFuZFJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudFVwZGF0ZUNvbW1hbmRSZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgUGFydGljaXBhbnRBdHRyaWJ1dGVFdmVudEFyZ3MoY29tbWFuZFBheWxvYWQucGFydGljaXBhbnRJZCwgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5jaGFuZ2VOaWNrbmFtZSwgY29tbWFuZFBheWxvYWQubmlja25hbWUsIHNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAnSm9pblNlc3Npb24nIGlzIHNlbnQgd2hlbiBhIHVzZXIgam9pbnMgdGhlIENvbnZlcnNhdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJqb2luc2Vzc2lvblwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgam9pblBhcnRpY2lwYW50UGF5bG9hZCA9IFBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLmZyb21KU09OKG1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgam9pbmluZ1BhcnRpY2lwYW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF2YXRhcjogam9pblBhcnRpY2lwYW50UGF5bG9hZC5hdmF0YXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQubmlja25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQucGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hvc3Q6IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQuaXNob3N0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTXV0ZWQ6IGpvaW5QYXJ0aWNpcGFudFBheWxvYWQuaXNtdXRlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1VzaW5nVHRzOiBqb2luUGFydGljaXBhbnRQYXlsb2FkLnVzZXR0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVmZXJyZWRMYW5ndWFnZTogam9pblBhcnRpY2lwYW50UGF5bG9hZC5sb2NhbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3Rvci5wYXJ0aWNpcGFudEpvaW5Db21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50Sm9pbkNvbW1hbmRSZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgUGFydGljaXBhbnRFdmVudEFyZ3Moam9pbmluZ1BhcnRpY2lwYW50LCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogJ0xlYXZlU2Vzc2lvbicgaXMgc2VudCB3aGVuIGEgdXNlciBsZWF2ZXMgdGhlIENvbnZlcnNhdGlvbicuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibGVhdmVzZXNzaW9uXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWF2aW5nUGFydGljaXBhbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGNvbW1hbmRQYXlsb2FkLnBhcnRpY2lwYW50SWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50TGVhdmVDb21tYW5kUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnBhcnRpY2lwYW50TGVhdmVDb21tYW5kUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IFBhcnRpY2lwYW50RXZlbnRBcmdzKGxlYXZpbmdQYXJ0aWNpcGFudCwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICdEaXNjb25uZWN0U2Vzc2lvbicgaXMgc2VudCB3aGVuIGEgdXNlciBpcyBkaXNjb25uZWN0ZWQgZnJvbSB0aGUgc2Vzc2lvbiAoZS5nLiBuZXR3b3JrIHByb2JsZW0pLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDaGVjayB0aGUgJ1BhcnRpY2lwYW50SWQnIHRvIGNoZWNrIHdoZXRoZXIgdGhlIG1lc3NhZ2UgaXMgZm9yIHRoZSBjdXJyZW50IHVzZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGlzY29ubmVjdHNlc3Npb25cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc2Nvbm5lY3RQYXJ0aWNpcGFudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogY29tbWFuZFBheWxvYWQucGFydGljaXBhbnRJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwidG9rZW5cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gbmV3IENvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml6YXRpb25Ub2tlbiA9IGNvbW1hbmRQYXlsb2FkLnRva2VuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYXV0aG9yaXphdGlvblRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdXRob3JpemF0aW9uVG9rZW4gPSBjb21tYW5kUGF5bG9hZC50b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXV0aGVudGljYXRpb24gPSB0b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTWVzc2FnZSBub3QgcmVjb2duaXplZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAqICdwYXJ0aWFsJyAob3IgJ2h5cG90aGVzaXMnKSByZXByZXNlbnRzIGEgdW5maW5hbGl6ZWQgc3BlZWNoIG1lc3NhZ2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwYXJ0aWFsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAqICdmaW5hbCcgKG9yICdwaHJhc2UnKSByZXByZXNlbnRzIGEgZmluYWxpemVkIHNwZWVjaCBtZXNzYWdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZmluYWxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hQYXlsb2FkID0gU3BlZWNoUmVzcG9uc2VQYXlsb2FkLmZyb21KU09OKG1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvblJlc3VsdFJlYXNvbiA9IChjb252ZXJzYXRpb25NZXNzYWdlVHlwZSA9PT0gXCJmaW5hbFwiKSA/IFJlc3VsdFJlYXNvbi5UcmFuc2xhdGVkUGFydGljaXBhbnRTcGVlY2ggOiBSZXN1bHRSZWFzb24uVHJhbnNsYXRpbmdQYXJ0aWNpcGFudFNwZWVjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGVlY2hSZXN1bHQgPSBuZXcgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25SZXN1bHQoc3BlZWNoUGF5bG9hZC5wYXJ0aWNpcGFudElkLCB0aGlzLmdldFRyYW5zbGF0aW9ucyhzcGVlY2hQYXlsb2FkLnRyYW5zbGF0aW9ucyksIHNwZWVjaFBheWxvYWQubGFuZ3VhZ2UsIHNwZWVjaFBheWxvYWQuaWQsIGNvbnZlcnNhdGlvblJlc3VsdFJlYXNvbiwgc3BlZWNoUGF5bG9hZC5yZWNvZ25pdGlvbiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIG1lc3NhZ2UudGV4dEJvZHksIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwZWVjaFBheWxvYWQuaXNGaW5hbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayB0aGUgbGVuZ3RoLCBzb21ldGltZXMgZW1wdHkgZmluYWxzIGFyZSByZXR1cm5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3BlZWNoUmVzdWx0LnRleHQgIT09IHVuZGVmaW5lZCAmJiBzcGVlY2hSZXN1bHQudGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kRmluYWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNwZWVjaFBheWxvYWQuaWQgPT09IHRoaXMucHJpdkxhc3RQYXJ0aWFsVXR0ZXJhbmNlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgZmluYWwgYXMgbm9ybWFsLiBXZSBoYWQgYSBub24tZW1wdHkgcGFydGlhbCBmb3IgdGhpcyBzYW1lIHV0dGVyYW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gc2VuZGluZyB0aGUgZW1wdHkgZmluYWwgaXMgaW1wb3J0YW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kRmluYWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3VwcHJlc3MgdW5uZWVkZWQgZmluYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VuZEZpbmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnRyYW5zbGF0aW9uUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnRyYW5zbGF0aW9uUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IENvbnZlcnNhdGlvblJlY2VpdmVkVHJhbnNsYXRpb25FdmVudEFyZ3MoQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5maW5hbCwgc3BlZWNoUmVzdWx0LCBzZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzcGVlY2hSZXN1bHQudGV4dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkxhc3RQYXJ0aWFsVXR0ZXJhbmNlSWQgPSBzcGVlY2hQYXlsb2FkLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnRyYW5zbGF0aW9uUmVjZWl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IudHJhbnNsYXRpb25SZWNlaXZlZCh0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLCBuZXcgQ29udmVyc2F0aW9uUmVjZWl2ZWRUcmFuc2xhdGlvbkV2ZW50QXJncyhDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLnBhcnRpYWwsIHNwZWVjaFJlc3VsdCwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIFwidHJhbnNsYXRlZF9tZXNzYWdlXCIgaXMgYSB0ZXh0IG1lc3NhZ2Ugb3IgaW5zdGFudCBtZXNzYWdlIChJTSkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmFuc2xhdGVkX21lc3NhZ2VcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0UGF5bG9hZCA9IFRleHRSZXNwb25zZVBheWxvYWQuZnJvbUpTT04obWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogKE5hdGl2ZSBwYXJpdHkpIGEgcmVzdWx0IHJlYXNvbiBzaG91bGQgYmUgc2V0IGJhc2VkIHdoZXRoZXIgdGhlIHBhcnRpY2lwYW50SWQgaXMgb3VycyBvciBub3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0UmVzdWx0ID0gbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0KHRleHRQYXlsb2FkLnBhcnRpY2lwYW50SWQsIHRoaXMuZ2V0VHJhbnNsYXRpb25zKHRleHRQYXlsb2FkLnRyYW5zbGF0aW9ucyksIHRleHRQYXlsb2FkLmxhbmd1YWdlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdGV4dFBheWxvYWQub3JpZ2luYWxUZXh0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBtZXNzYWdlLnRleHRCb2R5LCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblNlcnZpY2VDb25uZWN0b3IudHJhbnNsYXRpb25SZWNlaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25TZXJ2aWNlQ29ubmVjdG9yLnRyYW5zbGF0aW9uUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uU2VydmljZUNvbm5lY3RvciwgbmV3IENvbnZlcnNhdGlvblJlY2VpdmVkVHJhbnNsYXRpb25FdmVudEFyZ3MoQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5pbnN0YW50TWVzc2FnZSwgdGV4dFJlc3VsdCwgc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgYW55IHVuc3VwcG9ydGVkIG1lc3NhZ2UgdHlwZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb250aW51ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNlaXZlQ29udmVyc2F0aW9uTWVzc2FnZU92ZXJyaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3AgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbW11bmljYXRpb25DdXN0b2RpYW4ucHJvbWlzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0YXJ0TWVzc2FnZUxvb3AoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnRlcm1pbmF0ZU1lc3NhZ2VMb29wID0gZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlUmV0cmlldmFsUHJvbWlzZSA9IHRoaXMucmVjZWl2ZUNvbnZlcnNhdGlvbk1lc3NhZ2VPdmVycmlkZSgpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0geWllbGQgbWVzc2FnZVJldHJpZXZhbFByb21pc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbFJlY29nbml0aW9uKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uID8gdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkIDogXCJcIiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24gPyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQgOiBcIlwiLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5SdW50aW1lRXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFRha2VzIGFuIGVzdGFibGlzaGVkIHdlYnNvY2tldCBjb25uZWN0aW9uIHRvIHRoZSBlbmRwb2ludFxuICAgIGNvbmZpZ0Nvbm5lY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlnUHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UudGhlbigoY29ubmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLnN0YXRlKCkgPT09IENvbm5lY3Rpb25TdGF0ZS5EaXNjb25uZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpZ0Nvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWdQcm9taXNlO1xuICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25JZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkNvbmZpZ1Byb21pc2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGVybWluYXRlTWVzc2FnZUxvb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uQ29uZmlnUHJvbWlzZSA9IHRoaXMuY29ubmVjdEltcGwoKS50aGVuKChjb25uZWN0aW9uKSA9PiBjb25uZWN0aW9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25Db25maWdQcm9taXNlO1xuICAgIH1cbiAgICBnZXRUcmFuc2xhdGlvbnMoc2VydmljZVJlc3VsdFRyYW5zbGF0aW9ucykge1xuICAgICAgICBsZXQgdHJhbnNsYXRpb25zO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBzZXJ2aWNlUmVzdWx0VHJhbnNsYXRpb25zKSB7XG4gICAgICAgICAgICB0cmFuc2xhdGlvbnMgPSBuZXcgVHJhbnNsYXRpb25zKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRyYW5zbGF0aW9uIG9mIHNlcnZpY2VSZXN1bHRUcmFuc2xhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB0cmFuc2xhdGlvbnMuc2V0KHRyYW5zbGF0aW9uLmxhbmcsIHRyYW5zbGF0aW9uLnRyYW5zbGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJhbnNsYXRpb25zO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uU2VydmljZUFkYXB0ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3h5SW5mbywgUmVzdENvbmZpZ0Jhc2UsIFdlYnNvY2tldENvbm5lY3Rpb24sIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5icm93c2VyL0V4cG9ydHNcIjtcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi9TdHJpbmdVdGlsc1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4uLy4uL3Nkay9Db250cmFjdHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IEhlYWRlck5hbWVzIH0gZnJvbSBcIi4uL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBRdWVyeVBhcmFtZXRlck5hbWVzIH0gZnJvbSBcIi4uL1F1ZXJ5UGFyYW1ldGVyTmFtZXNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25GYWN0b3J5QmFzZSB9IGZyb20gXCIuLy4uL0Nvbm5lY3Rpb25GYWN0b3J5QmFzZVwiO1xuaW1wb3J0IHsgVHJhbnNjcmliZXJDb25uZWN0aW9uRmFjdG9yeSwgVHJhbnNsYXRpb25Db25uZWN0aW9uRmFjdG9yeSwgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciwgfSBmcm9tIFwiLi8uLi9FeHBvcnRzXCI7XG4vKipcbiAqIENvbm5lY3Rpb24gZmFjdG9yeSBmb3IgdGhlIGNvbnZlcnNhdGlvbiB0cmFuc2xhdG9yLiBIYW5kbGVzIGNvbm5lY3RpbmcgdG8gdGhlIHJlZ3VsYXIgdHJhbnNsYXRvciBlbmRwb2ludCxcbiAqIGFzIHdlbGwgYXMgdGhlIHZpcnR1YWwgbWljcm9waG9uZSBhcnJheSB0cmFuc2NyaXB0aW9uIGVuZHBvaW50XG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29ubmVjdGlvbkZhY3RvcnkgZXh0ZW5kcyBDb25uZWN0aW9uRmFjdG9yeUJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGNvbnZHZXR0ZXIpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoY29udkdldHRlciwgXCJjb252R2V0dGVyXCIpO1xuICAgICAgICB0aGlzLnByaXZDb252R2V0dGVyID0gY29udkdldHRlcjtcbiAgICB9XG4gICAgY3JlYXRlKGNvbmZpZywgYXV0aEluZm8sIGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBjb25zdCBpc1ZpcnRNaWNBcnJheUVuZHBvaW50ID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJDb252ZXJzYXRpb25UcmFuc2xhdG9yX011bHRpQ2hhbm5lbEF1ZGlvXCIsIFwiXCIpLnRvVXBwZXJDYXNlKCkgPT09IFwiVFJVRVwiO1xuICAgICAgICBjb25zdCBjb252SW5mbyA9IHRoaXMucHJpdkNvbnZHZXR0ZXIoKS5yb29tO1xuICAgICAgICBjb25zdCByZWdpb24gPSBjb252SW5mby5jb2duaXRpdmVTcGVlY2hSZWdpb24gfHwgY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIFwiXCIpO1xuICAgICAgICBjb25zdCByZXBsYWNlbWVudFZhbHVlcyA9IHtcbiAgICAgICAgICAgIGhvc3RTdWZmaXg6IENvbm5lY3Rpb25GYWN0b3J5QmFzZS5nZXRIb3N0U3VmZml4KHJlZ2lvbiksXG4gICAgICAgICAgICBwYXRoOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29ubmVjdGlvbkZhY3RvcnkuQ1RTX1ZJUlRfTUlDX1BBVEgsXG4gICAgICAgICAgICByZWdpb246IGVuY29kZVVSSUNvbXBvbmVudChyZWdpb24pXG4gICAgICAgIH07XG4gICAgICAgIHJlcGxhY2VtZW50VmFsdWVzW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuTGFuZ3VhZ2VdID0gZW5jb2RlVVJJQ29tcG9uZW50KGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlLCBcIlwiKSk7XG4gICAgICAgIHJlcGxhY2VtZW50VmFsdWVzW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3RzTWVldGluZ0lkXSA9IGVuY29kZVVSSUNvbXBvbmVudChjb252SW5mby5yb29tSWQpO1xuICAgICAgICByZXBsYWNlbWVudFZhbHVlc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c0RldmljZUlkXSA9IGVuY29kZVVSSUNvbXBvbmVudChjb252SW5mby5wYXJ0aWNpcGFudElkKTtcbiAgICAgICAgcmVwbGFjZW1lbnRWYWx1ZXNbUXVlcnlQYXJhbWV0ZXJOYW1lcy5DdHNJc1BhcnRpY2lwYW50XSA9IGNvbnZJbmZvLmlzSG9zdCA/IFwiXCIgOiAoXCImXCIgKyBRdWVyeVBhcmFtZXRlck5hbWVzLkN0c0lzUGFydGljaXBhbnQpO1xuICAgICAgICBsZXQgZW5kcG9pbnRVcmwgPSBcIlwiO1xuICAgICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGlmIChpc1ZpcnRNaWNBcnJheUVuZHBvaW50KSB7XG4gICAgICAgICAgICAvLyBjb25uZWN0aW5nIHRvIHRoZSBjb252ZXJzYXRpb24gdHJhbnNjcmlwdGlvbiB2aXJ0dWFsIG1pY3JvcGhvbmUgYXJyYXkgZW5kcG9pbnRcbiAgICAgICAgICAgIGVuZHBvaW50VXJsID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCk7XG4gICAgICAgICAgICBpZiAoIWVuZHBvaW50VXJsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaG9zdE5hbWUgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIFwidHJhbnNjcmliZS57cmVnaW9ufS5jdHMuc3BlZWNoe2hvc3RTdWZmaXh9XCIpO1xuICAgICAgICAgICAgICAgIGVuZHBvaW50VXJsID0gXCJ3c3M6Ly9cIiArIGhvc3ROYW1lICsgXCJ7cGF0aH1cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGJlY2F1c2UgdGhlIHJlZ2lvbiBjYW4gY2hhbmdlIGR1cmluZyBhIHNlc3Npb24sIHdlIHN1cHBvcnQgYmVpbmcgcGFzc2VkIGEgZm9ybWF0IHN0cmluZyB3aGljaCB3ZSBjYW4gdGhlblxuICAgICAgICAgICAgLy8gcmVwbGFjZSB3aXRoIHRoZSBjb3JyZWN0IGluZm9ybWF0aW9uLlxuICAgICAgICAgICAgZW5kcG9pbnRVcmwgPSBTdHJpbmdVdGlscy5mb3JtYXRTdHJpbmcoZW5kcG9pbnRVcmwsIHJlcGxhY2VtZW50VmFsdWVzKTtcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwoZW5kcG9pbnRVcmwpO1xuICAgICAgICAgICAgcGFyc2VkVXJsLnNlYXJjaFBhcmFtcy5mb3JFYWNoKCh2YWwsIGtleSkgPT4ge1xuICAgICAgICAgICAgICAgIHF1ZXJ5UGFyYW1zW2tleV0gPSB2YWw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5GYWN0b3J5ID0gbmV3IFRyYW5zY3JpYmVyQ29ubmVjdGlvbkZhY3RvcnkoKTtcbiAgICAgICAgICAgIGNvbm5GYWN0b3J5LnNldFF1ZXJ5UGFyYW1zKHF1ZXJ5UGFyYW1zLCBjb25maWcsIGVuZHBvaW50VXJsKTtcbiAgICAgICAgICAgIC8vIFNvbWUgcXVlcnkgcGFyYW1ldGVycyBhcmUgcmVxdWlyZWQgZm9yIHRoZSBDVFMgZW5kcG9pbnQsIGxldCdzIGV4cGxpY2l0eSBzZXQgdGhlbSBoZXJlXG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c01lZXRpbmdJZF0gPSByZXBsYWNlbWVudFZhbHVlc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c01lZXRpbmdJZF07XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c0RldmljZUlkXSA9IHJlcGxhY2VtZW50VmFsdWVzW1F1ZXJ5UGFyYW1ldGVyTmFtZXMuQ3RzRGV2aWNlSWRdO1xuICAgICAgICAgICAgaWYgKCFjb252SW5mby5pc0hvc3QpIHtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkN0c0lzUGFydGljaXBhbnRdID0gXCJcIjsgLy8gdGhpcyBkb2Vzbid0IGhhdmUgYSB2YWx1ZSBzbyBzZXQgdG8gYW4gZW1wdHkgc3RyaW5nXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShRdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdCBpbiBxdWVyeVBhcmFtcykpIHtcbiAgICAgICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkZvcm1hdF0gPSBcInNpbXBsZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyc2VkVXJsLnNlYXJjaFBhcmFtcy5mb3JFYWNoKCh2YWwsIGtleSkgPT4ge1xuICAgICAgICAgICAgICAgIHBhcnNlZFVybC5zZWFyY2hQYXJhbXMuc2V0KGtleSwgcXVlcnlQYXJhbXNba2V5XSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHF1ZXJ5UGFyYW1zW2tleV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGVuZHBvaW50VXJsID0gcGFyc2VkVXJsLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBjb25uZWN0aW5nIHRvIHJlZ3VsYXIgdHJhbnNsYXRpb24gZW5kcG9pbnRcbiAgICAgICAgICAgIGNvbnN0IGNvbm5GYWN0b3J5ID0gbmV3IFRyYW5zbGF0aW9uQ29ubmVjdGlvbkZhY3RvcnkoKTtcbiAgICAgICAgICAgIGVuZHBvaW50VXJsID0gY29ubkZhY3RvcnkuZ2V0RW5kcG9pbnRVcmwoY29uZmlnLCB0cnVlKTtcbiAgICAgICAgICAgIGVuZHBvaW50VXJsID0gU3RyaW5nVXRpbHMuZm9ybWF0U3RyaW5nKGVuZHBvaW50VXJsLCByZXBsYWNlbWVudFZhbHVlcyk7XG4gICAgICAgICAgICBjb25uRmFjdG9yeS5zZXRRdWVyeVBhcmFtcyhxdWVyeVBhcmFtcywgY29uZmlnLCBlbmRwb2ludFVybCk7XG4gICAgICAgIH1cbiAgICAgICAgaGVhZGVyc1tIZWFkZXJOYW1lcy5Db25uZWN0aW9uSWRdID0gY29ubmVjdGlvbklkO1xuICAgICAgICBoZWFkZXJzW1Jlc3RDb25maWdCYXNlLmNvbmZpZ1BhcmFtcy50b2tlbl0gPSBjb252SW5mby50b2tlbjtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuKSB7XG4gICAgICAgICAgICBoZWFkZXJzW2F1dGhJbmZvLmhlYWRlck5hbWVdID0gYXV0aEluZm8udG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZW5hYmxlQ29tcHJlc3Npb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShcIlNQRUVDSC1FbmFibGVXZWJzb2NrZXRDb21wcmVzc2lvblwiLCBcIlwiKS50b1VwcGVyQ2FzZSgpID09PSBcIlRSVUVcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJzb2NrZXRDb25uZWN0aW9uKGVuZHBvaW50VXJsLCBxdWVyeVBhcmFtcywgaGVhZGVycywgbmV3IFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIoKSwgUHJveHlJbmZvLmZyb21SZWNvZ25pemVyQ29uZmlnKGNvbmZpZyksIGVuYWJsZUNvbXByZXNzaW9uLCBjb25uZWN0aW9uSWQpO1xuICAgIH1cbn1cbkNvbnZlcnNhdGlvblRyYW5zbGF0b3JDb25uZWN0aW9uRmFjdG9yeS5DVFNfVklSVF9NSUNfUEFUSCA9IFwiL3NwZWVjaC9yZWNvZ25pdGlvbi9keW5hbWljYXVkaW9cIjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNsYXRvckNvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgU2Vzc2lvbkV2ZW50QXJncyB9IGZyb20gXCIuLi8uLi9zZGsvRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIE11dGVBbGxFdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICBjb25zdHJ1Y3Rvcihpc011dGVkLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2SXNNdXRlZCA9IGlzTXV0ZWQ7XG4gICAgfVxuICAgIGdldCBpc011dGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNNdXRlZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgTG9ja1Jvb21FdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICBjb25zdHJ1Y3Rvcihpc0xvY2tlZCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdklzTG9ja2VkID0gaXNMb2NrZWQ7XG4gICAgfVxuICAgIGdldCBpc011dGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNMb2NrZWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcnRpY2lwYW50RXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IocGFydGljaXBhbnQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZQYXJ0aWNpcGFudCA9IHBhcnRpY2lwYW50O1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGFydGljaXBhbnRBdHRyaWJ1dGVFdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJ0aWNpcGFudElkLCBrZXksIHZhbHVlLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2S2V5ID0ga2V5O1xuICAgICAgICB0aGlzLnByaXZWYWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnByaXZQYXJ0aWNpcGFudElkID0gcGFydGljaXBhbnRJZDtcbiAgICB9XG4gICAgZ2V0IHZhbHVlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VmFsdWU7XG4gICAgfVxuICAgIGdldCBrZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZLZXk7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50SWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFBhcnRpY2lwYW50c0xpc3RFdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICBjb25zdHJ1Y3Rvcihjb252ZXJzYXRpb25JZCwgdG9rZW4sIHRyYW5zbGF0ZVRvLCBwcm9mYW5pdHlGaWx0ZXIsIHJvb21Qcm9mYW5pdHlGaWx0ZXIsIGlzUm9vbUxvY2tlZCwgaXNNdXRlQWxsLCBwYXJ0aWNpcGFudHMsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSb29tSWQgPSBjb252ZXJzYXRpb25JZDtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvblRva2VuID0gdG9rZW47XG4gICAgICAgIHRoaXMucHJpdlRyYW5zbGF0ZVRvID0gdHJhbnNsYXRlVG87XG4gICAgICAgIHRoaXMucHJpdlByb2Zhbml0eUZpbHRlciA9IHByb2Zhbml0eUZpbHRlcjtcbiAgICAgICAgdGhpcy5wcml2Um9vbVByb2Zhbml0eUZpbHRlciA9IHJvb21Qcm9mYW5pdHlGaWx0ZXI7XG4gICAgICAgIHRoaXMucHJpdklzUm9vbUxvY2tlZCA9IGlzUm9vbUxvY2tlZDtcbiAgICAgICAgdGhpcy5wcml2SXNSb29tTG9ja2VkID0gaXNNdXRlQWxsO1xuICAgICAgICB0aGlzLnByaXZQYXJ0aWNpcGFudHMgPSBwYXJ0aWNpcGFudHM7XG4gICAgfVxuICAgIGdldCBzZXNzaW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXNzaW9uVG9rZW47XG4gICAgfVxuICAgIGdldCBjb252ZXJzYXRpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJvb21JZDtcbiAgICB9XG4gICAgZ2V0IHRyYW5zbGF0ZVRvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRlVG87XG4gICAgfVxuICAgIGdldCBwcm9mYW5pdHlGaWx0ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9mYW5pdHlGaWx0ZXI7XG4gICAgfVxuICAgIGdldCByb29tUHJvZmFuaXR5RmlsdGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Um9vbVByb2Zhbml0eUZpbHRlcjtcbiAgICB9XG4gICAgZ2V0IGlzUm9vbUxvY2tlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzUm9vbUxvY2tlZDtcbiAgICB9XG4gICAgZ2V0IGlzTXV0ZUFsbCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzTXV0ZUFsbDtcbiAgICB9XG4gICAgZ2V0IHBhcnRpY2lwYW50cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50cztcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uUmVjZWl2ZWRUcmFuc2xhdGlvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IoY29tbWFuZCwgcGF5bG9hZCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHRoaXMucHJpdlBheWxvYWQgPSBwYXlsb2FkO1xuICAgICAgICB0aGlzLnByaXZDb21tYW5kID0gY29tbWFuZDtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgIH1cbiAgICBnZXQgcGF5bG9hZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBheWxvYWQ7XG4gICAgfVxuICAgIGdldCBjb21tYW5kKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZDtcbiAgICB9XG4gICAgZ2V0IHNlc3Npb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNlc3Npb25JZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblRyYW5zbGF0b3JFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKiBVc2VycyBwYXJ0aWNpcGF0aW5nIGluIHRoZSBjb252ZXJzYXRpb24gKi9cbmV4cG9ydCBjbGFzcyBJbnRlcm5hbFBhcnRpY2lwYW50cyB7XG4gICAgY29uc3RydWN0b3IocGFydGljaXBhbnRzID0gW10sIG1lSWQpIHtcbiAgICAgICAgdGhpcy5wYXJ0aWNpcGFudHMgPSBwYXJ0aWNpcGFudHM7XG4gICAgICAgIHRoaXMubWVJZCA9IG1lSWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBvciB1cGRhdGUgYSBwYXJ0aWNpcGFudFxuICAgICAqIEBwYXJhbSB2YWx1ZVxuICAgICAqL1xuICAgIGFkZE9yVXBkYXRlUGFydGljaXBhbnQodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBleGlzdHMgPSB0aGlzLmdldFBhcnRpY2lwYW50SW5kZXgodmFsdWUuaWQpO1xuICAgICAgICBpZiAoZXhpc3RzID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMucGFydGljaXBhbnRzLnNwbGljZShleGlzdHMsIDEsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGFydGljaXBhbnRzLnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVuc3VyZSBpdCB3YXMgYWRkZWQgb2tcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UGFydGljaXBhbnQodmFsdWUuaWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaW5kIHRoZSBwYXJ0aWNpcGFudCdzIHBvc2l0aW9uIGluIHRoZSBwYXJ0aWNpcGFudHMgbGlzdC5cbiAgICAgKiBAcGFyYW0gaWRcbiAgICAgKi9cbiAgICBnZXRQYXJ0aWNpcGFudEluZGV4KGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnRpY2lwYW50cy5maW5kSW5kZXgoKHApID0+IHAuaWQgPT09IGlkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZCB0aGUgcGFydGljaXBhbnQgYnkgaWQuXG4gICAgICogQHBhcmFtIGlkXG4gICAgICovXG4gICAgZ2V0UGFydGljaXBhbnQoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFydGljaXBhbnRzLmZpbmQoKHApID0+IHAuaWQgPT09IGlkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgcGFydGljaXBhbnQgZnJvbSB0aGUgcGFydGljaXBhbnRzIGxpc3QuXG4gICAgICovXG4gICAgZGVsZXRlUGFydGljaXBhbnQoaWQpIHtcbiAgICAgICAgdGhpcy5wYXJ0aWNpcGFudHMgPSB0aGlzLnBhcnRpY2lwYW50cy5maWx0ZXIoKHApID0+IHAuaWQgIT09IGlkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSGVscGVyIHRvIHJldHVybiB0aGUgY29udmVyc2F0aW9uIGhvc3QuXG4gICAgICovXG4gICAgZ2V0IGhvc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnRpY2lwYW50cy5maW5kKChwKSA9PiBwLmlzSG9zdCA9PT0gdHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhlbHBlciB0byByZXR1cm4gdGhlIGN1cnJlbnQgdXNlci5cbiAgICAgKi9cbiAgICBnZXQgbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFBhcnRpY2lwYW50KHRoaXMubWVJZCk7XG4gICAgfVxufVxuLyoqXG4gKiBMaXN0IG9mIGNvbW1hbmQgbWVzc2FnZSB0eXBlc1xuICovXG5leHBvcnQgY29uc3QgQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcyA9IHtcbiAgICBjb21tYW5kOiBcImNvbW1hbmRcIixcbiAgICBmaW5hbDogXCJmaW5hbFwiLFxuICAgIGluZm86IFwiaW5mb1wiLFxuICAgIGluc3RhbnRNZXNzYWdlOiBcImluc3RhbnRfbWVzc2FnZVwiLFxuICAgIGtlZXBBbGl2ZTogXCJrZWVwX2FsaXZlXCIsXG4gICAgcGFydGlhbDogXCJwYXJ0aWFsXCIsXG4gICAgcGFydGljaXBhbnRDb21tYW5kOiBcInBhcnRpY2lwYW50X2NvbW1hbmRcIixcbiAgICB0cmFuc2xhdGVkTWVzc2FnZTogXCJ0cmFuc2xhdGVkX21lc3NhZ2VcIlxufTtcbi8qKlxuICogTGlzdCBvZiBjb21tYW5kIHR5cGVzXG4gKi9cbmV4cG9ydCBjb25zdCBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzID0ge1xuICAgIGNoYW5nZU5pY2tuYW1lOiBcIkNoYW5nZU5pY2tuYW1lXCIsXG4gICAgZGlzY29ubmVjdFNlc3Npb246IFwiRGlzY29ubmVjdFNlc3Npb25cIixcbiAgICBlamVjdFBhcnRpY2lwYW50OiBcIkVqZWN0UGFydGljaXBhbnRcIixcbiAgICBpbnN0YW50X21lc3NhZ2U6IFwiaW5zdGFudF9tZXNzYWdlXCIsXG4gICAgam9pblNlc3Npb246IFwiSm9pblNlc3Npb25cIixcbiAgICBsZWF2ZVNlc3Npb246IFwiTGVhdmVTZXNzaW9uXCIsXG4gICAgcGFydGljaXBhbnRMaXN0OiBcIlBhcnRpY2lwYW50TGlzdFwiLFxuICAgIHJvb21FeHBpcmF0aW9uV2FybmluZzogXCJSb29tRXhwaXJhdGlvbldhcm5pbmdcIixcbiAgICBzZXRMb2NrU3RhdGU6IFwiU2V0TG9ja1N0YXRlXCIsXG4gICAgc2V0TXV0ZTogXCJTZXRNdXRlXCIsXG4gICAgc2V0TXV0ZUFsbDogXCJTZXRNdXRlQWxsXCIsXG4gICAgc2V0UHJvZmFuaXR5RmlsdGVyaW5nOiBcIlNldFByb2Zhbml0eUZpbHRlcmluZ1wiLFxuICAgIHNldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzOiBcIlNldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzXCIsXG4gICAgc2V0VXNlVFRTOiBcIlNldFVzZVRUU1wiXG59O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2xhdG9ySW50ZXJmYWNlcy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWNsYXNzZXMtcGVyLWZpbGVcbmltcG9ydCB7IFJlY29nbml6ZXJDb25maWcgfSBmcm9tIFwiLi4vLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBCYWNrZ3JvdW5kRXZlbnQsIEV2ZW50cywgVGltZW91dCB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4uLy4uL3Nkay9Db250cmFjdHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb24sIFJlY29nbml6ZXIgfSBmcm9tIFwiLi4vLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25GYWN0b3J5IH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uQ29ubmVjdGlvbkZhY3RvcnlcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvblNlcnZpY2VBZGFwdGVyIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uU2VydmljZUFkYXB0ZXJcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25SZWNvZ25pemVyRmFjdG9yeSB7XG4gICAgc3RhdGljIGZyb21Db25maWcoY29udmVyc2F0aW9uLCBzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ29udmVyc2F0aW9uVHJhbnNsYXRvclJlY29nbml6ZXIoY29udmVyc2F0aW9uLCBzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnKTtcbiAgICB9XG59XG4vKipcbiAqIFNlbmRzIG1lc3NhZ2VzIHRvIHRoZSBDb252ZXJzYXRpb24gVHJhbnNsYXRvciB3ZWJzb2NrZXQgYW5kIGxpc3RlbnMgZm9yIGluY29taW5nIGV2ZW50cyBjb250YWluaW5nIHdlYnNvY2tldCBtZXNzYWdlcy5cbiAqIEJhc2VkIG9mZiB0aGUgcmVjb2duaXplcnMgaW4gdGhlIFNESyBmb2xkZXIuXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2xhdG9yUmVjb2duaXplciBleHRlbmRzIFJlY29nbml6ZXIge1xuICAgIGNvbnN0cnVjdG9yKGNvbnZlcnNhdGlvbiwgc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZykge1xuICAgICAgICBjb25zdCBzZXJ2aWNlQ29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHNlcnZpY2VDb25maWdJbXBsLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uSW1wbCA9IGNvbnZlcnNhdGlvbjtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGNvbnZlcnNhdGlvbkltcGwsIFwiY29udmVyc2F0aW9uSW1wbFwiKTtcbiAgICAgICAgc3VwZXIoYXVkaW9Db25maWcsIHNlcnZpY2VDb25maWdJbXBsLnByb3BlcnRpZXMsIG5ldyBDb252ZXJzYXRpb25Db25uZWN0aW9uRmFjdG9yeSgpKTtcbiAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uID0gY29udmVyc2F0aW9uSW1wbDtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gc2VydmljZUNvbmZpZ0ltcGwucHJvcGVydGllcy5jbG9uZSgpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uID0gQ29ubmVjdGlvbi5mcm9tUmVjb2duaXplcih0aGlzKTtcbiAgICAgICAgdGhpcy5wcml2U2V0VGltZW91dCA9ICh0eXBlb2YgKEJsb2IpICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiAoV29ya2VyKSAhPT0gXCJ1bmRlZmluZWRcIikgPyBUaW1lb3V0LnNldFRpbWVvdXQgOiBzZXRUaW1lb3V0O1xuICAgICAgICB0aGlzLnByaXZDbGVhclRpbWVvdXQgPSAodHlwZW9mIChCbG9iKSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgKFdvcmtlcikgIT09IFwidW5kZWZpbmVkXCIpID8gVGltZW91dC5jbGVhclRpbWVvdXQgOiBjbGVhclRpbWVvdXQ7XG4gICAgfVxuICAgIHNldCBjb25uZWN0ZWQoY2IpIHtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbi5jb25uZWN0ZWQgPSBjYjtcbiAgICB9XG4gICAgc2V0IGRpc2Nvbm5lY3RlZChjYikge1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uLmRpc2Nvbm5lY3RlZCA9IGNiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHNwZWVjaCBsYW5ndWFnZSB1c2VkIGJ5IHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHByb3BlcnRpZXMgZm9yIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBpc0Rpc3Bvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNEaXNwb3NlZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29ubmVjdCB0byB0aGUgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB0b2tlblxuICAgICAqL1xuICAgIGNvbm5lY3QodG9rZW4sIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLmNvbnZlcnNhdGlvblRyYW5zbGF0b3JUb2tlbiA9IHRva2VuO1xuICAgICAgICAgICAgdGhpcy5yZXNldENvbnZlcnNhdGlvblRpbWVvdXQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY28uY29ubmVjdEFzeW5jKGNiLCBlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc2Nvbm5lY3QgZnJvbSB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGRpc2Nvbm5lY3QoY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZUaW1lb3V0VG9rZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q2xlYXJUaW1lb3V0KHRoaXMucHJpdlRpbWVvdXRUb2tlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLmRpc2Nvbm5lY3QoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgcmVjb2duaXplci5cbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZSh0cnVlKS5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmQgdGhlIG11dGUgYWxsIHBhcnRpY2lwYW50cyBjb21tYW5kIHRvIHRoZSB3ZWJzb2NrZXRcbiAgICAgKiBAcGFyYW0gY29udmVyc2F0aW9uSWRcbiAgICAgKiBAcGFyYW0gcGFydGljaXBhbnRJZFxuICAgICAqIEBwYXJhbSBpc011dGVkXG4gICAgICovXG4gICAgc2VuZFJlcXVlc3QoY29tbWFuZCwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIHRoaXMuc2VuZE1lc3NhZ2UoY29tbWFuZCwgY2IsIGVycik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlZEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGVycih0eXBlZEVycm9yLm5hbWUgKyBcIjogXCIgKyB0eXBlZEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBEZXN0cm95IHRoZSByZWNvZ25pemVyLlxuICAgICAgICAgICAgdGhpcy5kaXNwb3NlKHRydWUpLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChuZXcgQmFja2dyb3VuZEV2ZW50KHJlYXNvbikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2UgYW5kIGRpc3Bvc2UgdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcml2SXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbm5lY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbi5jbG9zZUNvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuZGlzcG9zZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2UgdGhlIHJlY29nbml6ZXJcbiAgICAgKiBAcGFyYW0gZGlzcG9zaW5nXG4gICAgICovXG4gICAgZGlzcG9zZShkaXNwb3NpbmcpIHtcbiAgICAgICAgY29uc3QgX3N1cGVyID0gT2JqZWN0LmNyZWF0ZShudWxsLCB7XG4gICAgICAgICAgICBkaXNwb3NlOiB7IGdldDogKCkgPT4gc3VwZXIuZGlzcG9zZSB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdklzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlRpbWVvdXRUb2tlbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNsZWFyVGltZW91dCh0aGlzLnByaXZUaW1lb3V0VG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb25uZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb24uY2xvc2VDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHRoZSBjb25maWcgZm9yIHRoZSByZWNvZ25pemVyXG4gICAgICogQHBhcmFtIHNwZWVjaENvbmZpZ1xuICAgICAqL1xuICAgIGNyZWF0ZVJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJpdlByb3BlcnRpZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgdGhlIHNlcnZpY2UgcmVjb2duaXplci5cbiAgICAgKiBUaGUgYXVkaW8gc291cmNlIGlzIHJlZHVuZG5hbnQgaGVyZSBidXQgaXMgcmVxdWlyZWQgYnkgdGhlIGltcGxlbWVudGF0aW9uLlxuICAgICAqIEBwYXJhbSBhdXRoZW50aWNhdGlvblxuICAgICAqIEBwYXJhbSBjb25uZWN0aW9uRmFjdG9yeVxuICAgICAqIEBwYXJhbSBhdWRpb0NvbmZpZ1xuICAgICAqIEBwYXJhbSByZWNvZ25pemVyQ29uZmlnXG4gICAgICovXG4gICAgY3JlYXRlU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0NvbmZpZywgcmVjb2duaXplckNvbmZpZykge1xuICAgICAgICBjb25zdCBhdWRpb1NvdXJjZSA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IENvbnZlcnNhdGlvblNlcnZpY2VBZGFwdGVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHRoaXMpO1xuICAgIH1cbiAgICBzZW5kTWVzc2FnZShtc2csIGNiLCBlcnIpIHtcbiAgICAgICAgY29uc3Qgd2l0aEFzeW5jID0gdGhpcy5wcml2UmVjbztcbiAgICAgICAgY29uc3QgUHJvbWlzZVRvRW1wdHlDYWxsYmFjayA9IChwcm9taXNlLCBjYiwgZXJyKSA9PiB7XG4gICAgICAgICAgICBpZiAocHJvbWlzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyKGAnVW5oYW5kbGVkIGVycm9yIG9uIHByb21pc2UgY2FsbGJhY2s6ICR7ZX0nYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCAocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIocmVhc29uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgeyB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKFwiTnVsbCBwcm9taXNlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZVRvRW1wdHlDYWxsYmFjayh3aXRoQXN5bmMuc2VuZE1lc3NhZ2VBc3luYyhtc2cpLCBjYiwgZXJyKTtcbiAgICAgICAgdGhpcy5yZXNldENvbnZlcnNhdGlvblRpbWVvdXQoKTtcbiAgICB9XG4gICAgcmVzZXRDb252ZXJzYXRpb25UaW1lb3V0KCkge1xuICAgICAgICBpZiAodGhpcy5wcml2VGltZW91dFRva2VuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50XG4gICAgICAgICAgICB0aGlzLnByaXZDbGVhclRpbWVvdXQodGhpcy5wcml2VGltZW91dFRva2VuKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZUaW1lb3V0VG9rZW4gPSB0aGlzLnByaXZTZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VuZFJlcXVlc3QodGhpcy5wcml2Q29udmVyc2F0aW9uLmdldEtlZXBBbGl2ZSgpKTtcbiAgICAgICAgfSwgNjAwMDApO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNsYXRvclJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IERlZmVycmVkLCBNZXNzYWdlVHlwZSwgUmF3V2Vic29ja2V0TWVzc2FnZSwgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2VcIjtcbi8qKlxuICogQmFzZWQgb2ZmIFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIuIFRoZSBtZXNzYWdlcyBmb3IgQ29udmVyc2F0aW9uIFRyYW5zbGF0b3IgaGF2ZSBzb21lIHZhcmlhdGlvbnMgZnJvbSB0aGUgU3BlZWNoIG1lc3NhZ2VzLlxuICovXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciB7XG4gICAgLyoqXG4gICAgICogRm9ybWF0IGluY29taW5nIG1lc3NhZ2VzOiB0ZXh0IChzcGVlY2ggcGFydGlhbC9maW5hbCwgSU0pIG9yIGJpbmFyeSAodHRzKVxuICAgICAqL1xuICAgIHRvQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBjb25zdCBkZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmNvbWluZ01lc3NhZ2UgPSBuZXcgQ29udmVyc2F0aW9uQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZS5tZXNzYWdlVHlwZSwgbWVzc2FnZS50ZXh0Q29udGVudCwge30sIG1lc3NhZ2UuaWQpO1xuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUoaW5jb21pbmdNZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkJpbmFyeSkge1xuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUobmV3IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25NZXNzYWdlKG1lc3NhZ2UubWVzc2FnZVR5cGUsIG1lc3NhZ2UuYmluYXJ5Q29udGVudCwgdW5kZWZpbmVkLCBtZXNzYWdlLmlkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGRlZmVycmFsLnJlamVjdChgRXJyb3IgZm9ybWF0dGluZyB0aGUgbWVzc2FnZS4gRXJyb3I6ICR7ZX1gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVmZXJyYWwucHJvbWlzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9ybWF0IG91dGdvaW5nIG1lc3NhZ2VzOiB0ZXh0IChjb21tYW5kcyBvciBJTSlcbiAgICAgKi9cbiAgICBmcm9tQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBjb25zdCBkZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gYCR7bWVzc2FnZS50ZXh0Qm9keSA/IG1lc3NhZ2UudGV4dEJvZHkgOiBcIlwifWA7XG4gICAgICAgICAgICAgICAgZGVmZXJyYWwucmVzb2x2ZShuZXcgUmF3V2Vic29ja2V0TWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBwYXlsb2FkLCBtZXNzYWdlLmlkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGRlZmVycmFsLnJlamVjdChgRXJyb3IgZm9ybWF0dGluZyB0aGUgbWVzc2FnZS4gJHtlfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IHsgQ29udmVyc2F0aW9uTWFuYWdlciB9IGZyb20gXCIuL0NvbnZlcnNhdGlvbk1hbmFnZXJcIjtcbmV4cG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnXCI7XG5leHBvcnQgeyBDb252ZXJzYXRpb25SZWNvZ25pemVyRmFjdG9yeSB9IGZyb20gXCIuL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JSZWNvZ25pemVyXCI7XG5leHBvcnQgeyBUcmFuc2NyaWJlclJlY29nbml6ZXIgfSBmcm9tIFwiLi9UcmFuc2NyaWJlclJlY29nbml6ZXJcIjtcbmV4cG9ydCB7IENvbnZlcnNhdGlvblJlY2VpdmVkVHJhbnNsYXRpb25FdmVudEFyZ3MsIExvY2tSb29tRXZlbnRBcmdzLCBNdXRlQWxsRXZlbnRBcmdzLCBQYXJ0aWNpcGFudEF0dHJpYnV0ZUV2ZW50QXJncywgUGFydGljaXBhbnRFdmVudEFyZ3MsIFBhcnRpY2lwYW50c0xpc3RFdmVudEFyZ3MgfSBmcm9tIFwiLi9Db252ZXJzYXRpb25UcmFuc2xhdG9yRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLCBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLCBJbnRlcm5hbFBhcnRpY2lwYW50cyB9IGZyb20gXCIuL0NvbnZlcnNhdGlvblRyYW5zbGF0b3JJbnRlcmZhY2VzXCI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUV4cG9ydHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmNvbnN0IHBhcnNlQ29tbWFuZFJlc3BvbnNlID0gKGpzb24pID0+IEpTT04ucGFyc2UoanNvbik7XG5leHBvcnQgY2xhc3MgQ29tbWFuZFJlc3BvbnNlUGF5bG9hZCB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2UgPSBwYXJzZUNvbW1hbmRSZXNwb25zZShqc29uKTtcbiAgICB9XG4gICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2UudHlwZTtcbiAgICB9XG4gICAgZ2V0IGNvbW1hbmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2UuY29tbWFuZDtcbiAgICB9XG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLmlkO1xuICAgIH1cbiAgICBnZXQgbmlja25hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2Uubmlja25hbWU7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29tbWFuZFJlc3BvbnNlLnBhcnRpY2lwYW50SWQ7XG4gICAgfVxuICAgIGdldCByb29taWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2Uucm9vbWlkO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb21tYW5kUmVzcG9uc2UudmFsdWU7XG4gICAgfVxuICAgIGdldCB0b2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbW1hbmRSZXNwb25zZS50b2tlbjtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDb21tYW5kUmVzcG9uc2VQYXlsb2FkKGpzb24pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29tbWFuZFJlc3BvbnNlUGF5bG9hZC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuY29uc3QgcGFyc2VMaXN0UmVzcG9uc2UgPSAoanNvbikgPT4gSlNPTi5wYXJzZShqc29uKTtcbmNvbnN0IHBhcnNlUGFydGljaXBhbnRSZXNwb25zZSA9IChqc29uKSA9PiBKU09OLnBhcnNlKGpzb24pO1xuZXhwb3J0IGNsYXNzIFBhcnRpY2lwYW50c0xpc3RQYXlsb2FkUmVzcG9uc2Uge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlID0gcGFyc2VMaXN0UmVzcG9uc2UoanNvbik7XG4gICAgfVxuICAgIGdldCByb29taWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHNQYXlsb2FkUmVzcG9uc2Uucm9vbWlkO1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHNQYXlsb2FkUmVzcG9uc2UuaWQ7XG4gICAgfVxuICAgIGdldCBjb21tYW5kKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLmNvbW1hbmQ7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHNQYXlsb2FkUmVzcG9uc2UucGFydGljaXBhbnRzO1xuICAgIH1cbiAgICBnZXQgdG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudHNQYXlsb2FkUmVzcG9uc2UudG9rZW47XG4gICAgfVxuICAgIGdldCB0cmFuc2xhdGVUbygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS50cmFuc2xhdGVUbztcbiAgICB9XG4gICAgZ2V0IHByb2Zhbml0eUZpbHRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50c1BheWxvYWRSZXNwb25zZS5wcm9mYW5pdHlGaWx0ZXI7XG4gICAgfVxuICAgIGdldCByb29tUHJvZmFuaXR5RmlsdGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLnJvb21Qcm9mYW5pdHlGaWx0ZXI7XG4gICAgfVxuICAgIGdldCByb29tTG9ja2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLnJvb21Mb2NrZWQ7XG4gICAgfVxuICAgIGdldCBtdXRlQWxsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLm11dGVBbGw7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRzUGF5bG9hZFJlc3BvbnNlLnR5cGU7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgUGFydGljaXBhbnRzTGlzdFBheWxvYWRSZXNwb25zZShqc29uKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2Uge1xuICAgIGNvbnN0cnVjdG9yKGpzb24pIHtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UgPSBwYXJzZVBhcnRpY2lwYW50UmVzcG9uc2UoanNvbik7XG4gICAgfVxuICAgIGdldCBuaWNrbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLm5pY2tuYW1lO1xuICAgIH1cbiAgICBnZXQgbG9jYWxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UubG9jYWxlO1xuICAgIH1cbiAgICBnZXQgdXNldHRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UudXNldHRzO1xuICAgIH1cbiAgICBnZXQgaXNtdXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLmlzbXV0ZWQ7XG4gICAgfVxuICAgIGdldCBpc2hvc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQYXJ0aWNpcGFudFBheWxvYWRSZXNwb25zZS5pc2hvc3Q7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnRQYXlsb2FkUmVzcG9uc2UucGFydGljaXBhbnRJZDtcbiAgICB9XG4gICAgZ2V0IGF2YXRhcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBhcnRpY2lwYW50UGF5bG9hZFJlc3BvbnNlLmF2YXRhcjtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJ0aWNpcGFudFBheWxvYWRSZXNwb25zZShqc29uKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBhcnRpY2lwYW50UmVzcG9uc2VQYXlsb2FkLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5jb25zdCBwYXJzZVNwZWVjaFJlc3BvbnNlID0gKGpzb24pID0+IEpTT04ucGFyc2UoanNvbik7XG5jb25zdCBwYXJzZVRleHRSZXNwb25zZSA9IChqc29uKSA9PiBKU09OLnBhcnNlKGpzb24pO1xuZXhwb3J0IGNsYXNzIFNwZWVjaFJlc3BvbnNlUGF5bG9hZCB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hSZXNwb25zZSA9IHBhcnNlU3BlZWNoUmVzcG9uc2UoanNvbik7XG4gICAgfVxuICAgIGdldCByZWNvZ25pdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlc3BvbnNlLnJlY29nbml0aW9uO1xuICAgIH1cbiAgICBnZXQgdHJhbnNsYXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UudHJhbnNsYXRpb25zO1xuICAgIH1cbiAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS5pZDtcbiAgICB9XG4gICAgZ2V0IGxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UubGFuZ3VhZ2U7XG4gICAgfVxuICAgIGdldCBuaWNrbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlc3BvbnNlLm5pY2tuYW1lO1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlc3BvbnNlLnBhcnRpY2lwYW50SWQ7XG4gICAgfVxuICAgIGdldCByb29taWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS5yb29taWQ7XG4gICAgfVxuICAgIGdldCB0aW1lc3RhbXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS50aW1lc3RhbXA7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUmVzcG9uc2UudHlwZTtcbiAgICB9XG4gICAgZ2V0IGlzRmluYWwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hSZXNwb25zZS50eXBlID09PSBcImZpbmFsXCI7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3BlZWNoUmVzcG9uc2VQYXlsb2FkKGpzb24pO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBUZXh0UmVzcG9uc2VQYXlsb2FkIHtcbiAgICBjb25zdHJ1Y3Rvcihqc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlRleHRSZXNwb25zZSA9IHBhcnNlVGV4dFJlc3BvbnNlKGpzb24pO1xuICAgIH1cbiAgICBnZXQgb3JpZ2luYWxUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLm9yaWdpbmFsVGV4dDtcbiAgICB9XG4gICAgZ2V0IHRyYW5zbGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRSZXNwb25zZS50cmFuc2xhdGlvbnM7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHRSZXNwb25zZS5pZDtcbiAgICB9XG4gICAgZ2V0IGxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLmxhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgbmlja25hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0UmVzcG9uc2Uubmlja25hbWU7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLnBhcnRpY2lwYW50SWQ7XG4gICAgfVxuICAgIGdldCByb29taWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0UmVzcG9uc2Uucm9vbWlkO1xuICAgIH1cbiAgICBnZXQgdGltZXN0YW1wKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dFJlc3BvbnNlLnRpbWVzdGFtcDtcbiAgICB9XG4gICAgZ2V0IHR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0UmVzcG9uc2UudHlwZTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0UmVzcG9uc2VQYXlsb2FkKGpzb24pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25SZXNwb25zZVBheWxvYWQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4uLy4uL3Nkay9Db250cmFjdHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQsIFJlY29nbml6ZXIsIH0gZnJvbSBcIi4uLy4uL3Nkay9FeHBvcnRzXCI7XG5pbXBvcnQgeyBSZWNvZ25pdGlvbk1vZGUsIFJlY29nbml6ZXJDb25maWcsIFRyYW5zY3JpYmVyQ29ubmVjdGlvbkZhY3RvcnksIFRyYW5zY3JpcHRpb25TZXJ2aWNlUmVjb2duaXplciwgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIFRyYW5zY3JpYmVyUmVjb2duaXplciBleHRlbmRzIFJlY29nbml6ZXIge1xuICAgIC8qKlxuICAgICAqIFRyYW5zY3JpYmVyUmVjb2duaXplciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnfSBzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZyAtIE5vbi1hdWRpbyBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsID0gc3BlZWNoVHJhbnNsYXRpb25Db25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwsIFwic3BlZWNoVHJhbnNsYXRpb25Db25maWdcIik7XG4gICAgICAgIGNvbnN0IGF1ZGlvQ29uZmlnSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoYXVkaW9Db25maWdJbXBsLCBcImF1ZGlvQ29uZmlnSW1wbFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlLCBQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSk7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnLCBzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvcGVydGllcywgbmV3IFRyYW5zY3JpYmVyQ29ubmVjdGlvbkZhY3RvcnkoKSk7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplciA9IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKTtcbiAgICB9XG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBnZXQgYXV0aG9yaXphdGlvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4pO1xuICAgIH1cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHRva2VuKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0b2tlbiwgXCJ0b2tlblwiKTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHRva2VuKTtcbiAgICB9XG4gICAgc2V0IGNvbnZlcnNhdGlvbihjKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGMsIFwiQ29udmVyc2F0aW9uXCIpO1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24gPSBjO1xuICAgIH1cbiAgICBnZXRDb252ZXJzYXRpb25JbmZvKCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZDb252ZXJzYXRpb24sIFwiQ29udmVyc2F0aW9uXCIpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29udmVyc2F0aW9uLmNvbnZlcnNhdGlvbkluZm87XG4gICAgfVxuICAgIHN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luY0ltcGwoUmVjb2duaXRpb25Nb2RlLkNvbnZlcnNhdGlvbiksIGNiLCBlcnIpO1xuICAgIH1cbiAgICBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuZGlzcG9zZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8vIFB1c2ggYXN5bmMgam9pbi9sZWF2ZSBjb252ZXJzYXRpb24gbWVzc2FnZSB2aWEgc2VydmljZVJlY29nbml6ZXJcbiAgICBwdXNoQ29udmVyc2F0aW9uRXZlbnQoY29udmVyc2F0aW9uSW5mbywgY29tbWFuZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgcmVjbyA9ICh0aGlzLnByaXZSZWNvKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHJlY28sIFwic2VydmljZVJlY29nbml6ZXJcIik7XG4gICAgICAgICAgICB5aWVsZCByZWNvLnNlbmRTcGVlY2hFdmVudEFzeW5jKGNvbnZlcnNhdGlvbkluZm8sIGNvbW1hbmQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZW5mb3JjZUF1ZGlvR2F0aW5nKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgYXVkaW9Db25maWdJbXBsID0gdGhpcy5hdWRpb0NvbmZpZztcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdCA9IHlpZWxkIGF1ZGlvQ29uZmlnSW1wbC5mb3JtYXQ7XG4gICAgICAgICAgICBjb25zdCBjaGFubmVscyA9IGZvcm1hdC5jaGFubmVscztcbiAgICAgICAgICAgIGlmIChjaGFubmVscyA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoXCJmMGY1ZGViYy1mOGM5LTQ4OTItYWM0Yi05MGE3YWIzNTlmZDJcIiwgXCJmYWxzZVwiKS50b0xvd2VyQ2FzZSgpICE9PSBcInRydWVcIikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTaW5nbGUgY2hhbm5lbCBhdWRpbyBjb25maWd1cmF0aW9uIGZvciBDb252ZXJzYXRpb25UcmFuc2NyaWJlciBpcyBjdXJyZW50bHkgdW5kZXIgcHJpdmF0ZSBwcmV2aWV3LCBwbGVhc2UgY29udGFjdCBkaWFyaXphdGlvbnJlcXVlc3RAbWljcm9zb2Z0LmNvbSBmb3IgbW9yZSBkZXRhaWxzXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNoYW5uZWxzICE9PSA4KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBhdWRpbyBjb25maWd1cmF0aW9uOiBEZXRlY3RlZCAke2NoYW5uZWxzfS1jaGFubmVsIGF1ZGlvYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25uZWN0Q2FsbGJhY2tzKHRyYW5zY3JpYmVyKSB7XG4gICAgICAgIHRoaXMuY2FuY2VsZWQgPSAocywgZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCEhdHJhbnNjcmliZXIuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgICAgICB0cmFuc2NyaWJlci5jYW5jZWxlZCh0cmFuc2NyaWJlciwgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucmVjb2duaXppbmcgPSAocywgZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCEhdHJhbnNjcmliZXIudHJhbnNjcmliaW5nKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNjcmliZXIudHJhbnNjcmliaW5nKHRyYW5zY3JpYmVyLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZWNvZ25pemVkID0gKHMsIGUpID0+IHtcbiAgICAgICAgICAgIGlmICghIXRyYW5zY3JpYmVyLnRyYW5zY3JpYmVkKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNjcmliZXIudHJhbnNjcmliZWQodHJhbnNjcmliZXIsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNlc3Npb25TdGFydGVkID0gKHMsIGUpID0+IHtcbiAgICAgICAgICAgIGlmICghIXRyYW5zY3JpYmVyLnNlc3Npb25TdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNjcmliZXIuc2Vzc2lvblN0YXJ0ZWQodHJhbnNjcmliZXIsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNlc3Npb25TdG9wcGVkID0gKHMsIGUpID0+IHtcbiAgICAgICAgICAgIGlmICghIXRyYW5zY3JpYmVyLnNlc3Npb25TdG9wcGVkKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNjcmliZXIuc2Vzc2lvblN0b3BwZWQodHJhbnNjcmliZXIsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBkaXNjb25uZWN0Q2FsbGJhY2tzKCkge1xuICAgICAgICB0aGlzLmNhbmNlbGVkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlY29nbml6aW5nID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlY29nbml6ZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2Vzc2lvblN0YXJ0ZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2Vzc2lvblN0b3BwZWQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2VzIGFueSByZXNvdXJjZXMgaGVsZCBieSB0aGUgb2JqZWN0LlxuICAgICAqIEBtZW1iZXIgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIucHJvdG90eXBlLmRpc3Bvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtib29sZWFufSBkaXNwb3NpbmcgLSB0cnVlIGlmIGRpc3Bvc2luZyB0aGUgb2JqZWN0LlxuICAgICAqL1xuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgY3JlYXRlU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0NvbmZpZywgcmVjb2duaXplckNvbmZpZykge1xuICAgICAgICBjb25zdCBjb25maWdJbXBsID0gYXVkaW9Db25maWc7XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNjcmlwdGlvblNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgY29uZmlnSW1wbCwgcmVjb2duaXplckNvbmZpZywgdGhpcyk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2NyaWJlclJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgTWVzc2FnZVR5cGUgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MsIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0LCB9IGZyb20gXCIuLi9zZGsvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDb252ZXJzYXRpb25TZXJ2aWNlUmVjb2duaXplciB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuSW50ZXJuYWxcIjtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIFRyYW5zY3JpcHRpb25TZXJ2aWNlUmVjb2duaXplciBleHRlbmRzIENvbnZlcnNhdGlvblNlcnZpY2VSZWNvZ25pemVyIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCB0cmFuc2NyaWJlcikge1xuICAgICAgICBzdXBlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCB0cmFuc2NyaWJlcik7XG4gICAgICAgIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplciA9IHRyYW5zY3JpYmVyO1xuICAgICAgICB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTk92ZXJyaWRlID0gKGNvbm5lY3Rpb24pID0+IHRoaXMuc2VuZFRyYW5zY3JpcHRpb25TdGFydEpTT04oY29ubmVjdGlvbik7XG4gICAgICAgIGlmICh0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHMpID09PSBcInRydWVcIikge1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29udGV4dC5zZXRXb3JkTGV2ZWxUaW1pbmdzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VuZFNwZWVjaEV2ZW50QXN5bmMoaW5mbywgY29tbWFuZCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uaXNSZWNvZ25pemluZykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFNwZWVjaEV2ZW50KGNvbm5lY3Rpb24sIHRoaXMuY3JlYXRlU3BlZWNoRXZlbnRQYXlsb2FkKGluZm8sIGNvbW1hbmQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzU3BlZWNoTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpO1xuICAgIH1cbiAgICBoYW5kbGVSZWNvZ25pemVkQ2FsbGJhY2socmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCk7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIucmVjb2duaXplZCh0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIsIGV2ZW50KTtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZFcnJvckNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAvLyBhbmQgaWYgaXQncyBzdWNjZXNzZnVsIGRvbid0IGludm9rZSB0aGVcbiAgICAgICAgICAgICAgICAvLyBlcnJvciBhZnRlciB0aGF0LlxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVSZWNvZ25pemluZ0NhbGxiYWNrKHJlc3VsdCwgZHVyYXRpb24sIHNlc3Npb25JZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZXYgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MocmVzdWx0LCBkdXJhdGlvbiwgc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplci5yZWNvZ25pemluZyh0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIsIGV2KTtcbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gQ2FuY2VscyByZWNvZ25pdGlvbi5cbiAgICBjYW5jZWxSZWNvZ25pdGlvbihzZXNzaW9uSWQsIHJlcXVlc3RJZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckNvZGUsIGVycm9yKSB7XG4gICAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHByb3BlcnRpZXMuc2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbZXJyb3JDb2RlXSk7XG4gICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplci5jYW5jZWxlZCkge1xuICAgICAgICAgICAgY29uc3QgY2FuY2VsRXZlbnQgPSBuZXcgQ29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzKGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3IsIGVycm9yQ29kZSwgdW5kZWZpbmVkLCBzZXNzaW9uSWQpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIuY2FuY2VsZWQodGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLCBjYW5jZWxFdmVudCk7XG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQocmVxdWVzdElkLCBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIHVuZGVmaW5lZCwgLy8gVGV4dFxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBEdXJhdGlvblxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBPZmZzZXRcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2VcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gTGFuZ3VhZ2UgRGV0ZWN0aW9uIENvbmZpZGVuY2VcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gU3BlYWtlciBJZFxuICAgICAgICAgICAgZXJyb3IsIHVuZGVmaW5lZCwgLy8gSnNvblxuICAgICAgICAgICAgcHJvcGVydGllcyk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9iKSB7IH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBFbmNhcHN1bGF0ZWQgZm9yIGRlcml2ZWQgc2VydmljZSByZWNvZ25pemVycyB0aGF0IG5lZWQgdG8gc2VuZCBhZGRpdGlvbmFsIEpTT05cbiAgICBzZW5kVHJhbnNjcmlwdGlvblN0YXJ0SlNPTihjb25uZWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRTcGVlY2hDb250ZXh0KGNvbm5lY3Rpb24sIHRydWUpO1xuICAgICAgICAgICAgY29uc3QgaW5mbyA9IHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplci5nZXRDb252ZXJzYXRpb25JbmZvKCk7XG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gdGhpcy5jcmVhdGVTcGVlY2hFdmVudFBheWxvYWQoaW5mbywgXCJzdGFydFwiKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuc2VuZFNwZWVjaEV2ZW50KGNvbm5lY3Rpb24sIHBheWxvYWQpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kV2F2ZUhlYWRlcihjb25uZWN0aW9uKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRTcGVlY2hFdmVudChjb25uZWN0aW9uLCBwYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaEV2ZW50SnNvbiA9IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpO1xuICAgICAgICBpZiAoc3BlZWNoRXZlbnRKc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInNwZWVjaC5ldmVudFwiLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvblwiLCBzcGVlY2hFdmVudEpzb24pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNyZWF0ZVNwZWVjaEV2ZW50UGF5bG9hZChpbmZvLCBjb21tYW5kKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50RGljdCA9IHsgaWQ6IFwibWVldGluZ1wiLCBuYW1lOiBjb21tYW5kLCBtZWV0aW5nOiBpbmZvLmNvbnZlcnNhdGlvblByb3BlcnRpZXMgfTtcbiAgICAgICAgZXZlbnREaWN0Lm1lZXRpbmcuaWQgPSBpbmZvLmlkO1xuICAgICAgICBldmVudERpY3QubWVldGluZy5hdHRlbmRlZXMgPSBpbmZvLnBhcnRpY2lwYW50cztcbiAgICAgICAgZXZlbnREaWN0Lm1lZXRpbmcucmVjb3JkID0gaW5mby5jb252ZXJzYXRpb25Qcm9wZXJ0aWVzLmF1ZGlvcmVjb3JkaW5nID09PSBcIm9uXCIgPyBcInRydWVcIiA6IFwiZmFsc2VcIjtcbiAgICAgICAgcmV0dXJuIGV2ZW50RGljdDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zY3JpcHRpb25TZXJ2aWNlUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJveHlJbmZvLCBXZWJzb2NrZXRDb25uZWN0aW9uLCB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi9jb21tb24vU3RyaW5nVXRpbHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25GYWN0b3J5QmFzZSB9IGZyb20gXCIuL0Nvbm5lY3Rpb25GYWN0b3J5QmFzZVwiO1xuaW1wb3J0IHsgV2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlciwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBRdWVyeVBhcmFtZXRlck5hbWVzIH0gZnJvbSBcIi4vUXVlcnlQYXJhbWV0ZXJOYW1lc1wiO1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uQ29ubmVjdGlvbkZhY3RvcnkgZXh0ZW5kcyBDb25uZWN0aW9uRmFjdG9yeUJhc2Uge1xuICAgIGNyZWF0ZShjb25maWcsIGF1dGhJbmZvLCBjb25uZWN0aW9uSWQpIHtcbiAgICAgICAgY29uc3QgZW5kcG9pbnQgPSB0aGlzLmdldEVuZHBvaW50VXJsKGNvbmZpZyk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0ge307XG4gICAgICAgIGlmIChjb25maWcuYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBxdWVyeVBhcmFtc1tRdWVyeVBhcmFtZXRlck5hbWVzLkVuYWJsZUxhbmd1YWdlSWRdID0gXCJ0cnVlXCI7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRRdWVyeVBhcmFtcyhxdWVyeVBhcmFtcywgY29uZmlnLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgaWYgKGF1dGhJbmZvLnRva2VuICE9PSB1bmRlZmluZWQgJiYgYXV0aEluZm8udG9rZW4gIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGhlYWRlcnNbYXV0aEluZm8uaGVhZGVyTmFtZV0gPSBhdXRoSW5mby50b2tlbjtcbiAgICAgICAgfVxuICAgICAgICBoZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0gPSBjb25uZWN0aW9uSWQ7XG4gICAgICAgIGNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsLCBlbmRwb2ludCk7XG4gICAgICAgIGNvbnN0IGVuYWJsZUNvbXByZXNzaW9uID0gY29uZmlnLnBhcmFtZXRlcnMuZ2V0UHJvcGVydHkoXCJTUEVFQ0gtRW5hYmxlV2Vic29ja2V0Q29tcHJlc3Npb25cIiwgXCJmYWxzZVwiKSA9PT0gXCJ0cnVlXCI7XG4gICAgICAgIHJldHVybiBuZXcgV2Vic29ja2V0Q29ubmVjdGlvbihlbmRwb2ludCwgcXVlcnlQYXJhbXMsIGhlYWRlcnMsIG5ldyBXZWJzb2NrZXRNZXNzYWdlRm9ybWF0dGVyKCksIFByb3h5SW5mby5mcm9tUmVjb2duaXplckNvbmZpZyhjb25maWcpLCBlbmFibGVDb21wcmVzc2lvbiwgY29ubmVjdGlvbklkKTtcbiAgICB9XG4gICAgZ2V0RW5kcG9pbnRVcmwoY29uZmlnLCByZXR1cm5SZWdpb25QbGFjZWhvbGRlcikge1xuICAgICAgICBjb25zdCByZWdpb24gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbik7XG4gICAgICAgIGNvbnN0IGhvc3RTdWZmaXggPSBDb25uZWN0aW9uRmFjdG9yeUJhc2UuZ2V0SG9zdFN1ZmZpeChyZWdpb24pO1xuICAgICAgICBsZXQgZW5kcG9pbnRVcmwgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCB1bmRlZmluZWQpO1xuICAgICAgICBpZiAoIWVuZHBvaW50VXJsKSB7XG4gICAgICAgICAgICBpZiAoY29uZmlnLmF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIFwid3NzOi8ve3JlZ2lvbn0uc3R0LnNwZWVjaFwiICsgaG9zdFN1ZmZpeCk7XG4gICAgICAgICAgICAgICAgZW5kcG9pbnRVcmwgPSBob3N0ICsgXCIvc3BlZWNoL3VuaXZlcnNhbC92MlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaG9zdCA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdCwgXCJ3c3M6Ly97cmVnaW9ufS5zMnMuc3BlZWNoXCIgKyBob3N0U3VmZml4KTtcbiAgICAgICAgICAgICAgICBlbmRwb2ludFVybCA9IGhvc3QgKyBcIi9zcGVlY2gvdHJhbnNsYXRpb24vY29nbml0aXZlc2VydmljZXMvdjFcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocmV0dXJuUmVnaW9uUGxhY2Vob2xkZXIgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHJldHVybiBlbmRwb2ludFVybDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuZm9ybWF0U3RyaW5nKGVuZHBvaW50VXJsLCB7IHJlZ2lvbiB9KTtcbiAgICB9XG4gICAgc2V0UXVlcnlQYXJhbXMocXVlcnlQYXJhbXMsIGNvbmZpZywgZW5kcG9pbnRVcmwpIHtcbiAgICAgICAgcXVlcnlQYXJhbXMuZnJvbSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKTtcbiAgICAgICAgcXVlcnlQYXJhbXMudG8gPSBjb25maWcucGFyYW1ldGVycy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMpO1xuICAgICAgICB0aGlzLnNldENvbW1vblVybFBhcmFtcyhjb25maWcsIHF1ZXJ5UGFyYW1zLCBlbmRwb2ludFVybCk7XG4gICAgICAgIHRoaXMuc2V0VXJsUGFyYW1ldGVyKFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1RyYW5zbGF0aW9uUmVxdWVzdFN0YWJsZVBhcnRpYWxSZXN1bHQsIFF1ZXJ5UGFyYW1ldGVyTmFtZXMuU3RhYmxlVHJhbnNsYXRpb24sIGNvbmZpZywgcXVlcnlQYXJhbXMsIGVuZHBvaW50VXJsKTtcbiAgICAgICAgY29uc3QgdHJhbnNsYXRpb25Wb2ljZSA9IGNvbmZpZy5wYXJhbWV0ZXJzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Wb2ljZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKHRyYW5zbGF0aW9uVm9pY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcXVlcnlQYXJhbXMudm9pY2UgPSB0cmFuc2xhdGlvblZvaWNlO1xuICAgICAgICAgICAgcXVlcnlQYXJhbXMuZmVhdHVyZXMgPSBcInRleHR0b3NwZWVjaFwiO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvbkNvbm5lY3Rpb25GYWN0b3J5LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IE1lc3NhZ2VUeXBlLCBUcmFuc2xhdGlvblN0YXR1cywgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLCBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzLCBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0LCBUcmFuc2xhdGlvbnMsIFRyYW5zbGF0aW9uU3ludGhlc2lzRXZlbnRBcmdzLCBUcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdCwgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ29udmVyc2F0aW9uU2VydmljZVJlY29nbml6ZXIsIEVudW1UcmFuc2xhdGlvbiwgUmVjb2duaXRpb25TdGF0dXMsIFN5bnRoZXNpc1N0YXR1cywgVHJhbnNsYXRpb25IeXBvdGhlc2lzLCBUcmFuc2xhdGlvblBocmFzZSwgVHJhbnNsYXRpb25TeW50aGVzaXNFbmQsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25TZXJ2aWNlUmVjb2duaXplciBleHRlbmRzIENvbnZlcnNhdGlvblNlcnZpY2VSZWNvZ25pemVyIHtcbiAgICBjb25zdHJ1Y3RvcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCB0cmFuc2xhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgc3VwZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgdHJhbnNsYXRpb25SZWNvZ25pemVyKTtcbiAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyID0gdHJhbnNsYXRpb25SZWNvZ25pemVyO1xuICAgICAgICB0aGlzLmNvbm5lY3Rpb25FdmVudHMuYXR0YWNoKChjb25uZWN0aW9uRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uRXZlbnQubmFtZSA9PT0gXCJDb25uZWN0aW9uRXN0YWJsaXNoZWRFdmVudFwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLm9uQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbkNsb3NlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5vbkRpc2Nvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0UHJvcHMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgICAgICBsZXQgcHJvY2Vzc2VkID0geWllbGQgdGhpcy5wcm9jZXNzU3BlZWNoTWVzc2FnZXMoY29ubmVjdGlvbk1lc3NhZ2UpO1xuICAgICAgICAgICAgaWYgKHByb2Nlc3NlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaGFuZGxlVHJhbnNsYXRpb25QaHJhc2UgPSAodHJhbnNsYXRlZFBocmFzZSkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uUGhyYXNlUmVjb2duaXplZCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0ICsgdHJhbnNsYXRlZFBocmFzZS5PZmZzZXQgKyB0cmFuc2xhdGVkUGhyYXNlLkR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAodHJhbnNsYXRlZFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cyA9PT0gUmVjb2duaXRpb25TdGF0dXMuU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBPSywgdGhlIHJlY29nbml0aW9uIHdhcyBzdWNjZXNzZnVsLiBIb3cnZCB0aGUgdHJhbnNsYXRpb24gZG8/XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZmlyZUV2ZW50Rm9yUmVzdWx0KHRyYW5zbGF0ZWRQaHJhc2UsIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnJlY29nbml6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnJlY29nbml6ZWQodGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWVtcHR5ICovXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3QgZ29pbmcgdG8gbGV0IGVycm9ycyBpbiB0aGUgZXZlbnQgaGFuZGxlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlcG9ydCByZXN1bHQgdG8gcHJvbWlzZS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2U3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQucmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2RXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpZiBpdCdzIHN1Y2Nlc3NmdWwgZG9uJ3QgaW52b2tlIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3IgYWZ0ZXIgdGhhdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkVycm9yQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlUmVjb2duaXRpb25SZXN1bHQodHJhbnNsYXRlZFBocmFzZS5SZWNvZ25pdGlvblN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0KHVuZGVmaW5lZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCByZWFzb24sIHRyYW5zbGF0ZWRQaHJhc2UuVGV4dCwgdHJhbnNsYXRlZFBocmFzZS5EdXJhdGlvbiwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uY3VycmVudFR1cm5BdWRpb09mZnNldCArIHRyYW5zbGF0ZWRQaHJhc2UuT2Zmc2V0LCB0cmFuc2xhdGVkUGhyYXNlLkxhbmd1YWdlLCB0cmFuc2xhdGVkUGhyYXNlLkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlYXNvbiA9PT0gUmVzdWx0UmVhc29uLkNhbmNlbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxSZWFzb24gPSBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZUNhbmNlbFJlc3VsdCh0cmFuc2xhdGVkUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhbmNlbGxhdGlvbkVycm9yQ29kZSA9IEVudW1UcmFuc2xhdGlvbi5pbXBsVHJhbnNsYXRlQ2FuY2VsRXJyb3JDb2RlKHRyYW5zbGF0ZWRQaHJhc2UuUmVjb2duaXRpb25TdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxSZWNvZ25pdGlvbkxvY2FsKGNhbmNlbFJlYXNvbiwgY2FuY2VsbGF0aW9uRXJyb3JDb2RlLCBFbnVtVHJhbnNsYXRpb24uaW1wbFRyYW5zbGF0ZUVycm9yRGV0YWlscyhjYW5jZWxsYXRpb25FcnJvckNvZGUpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmlzU3BlZWNoRW5kZWQgJiYgcmVhc29uID09PSBSZXN1bHRSZWFzb24uTm9NYXRjaCAmJiB0cmFuc2xhdGVkUGhyYXNlLlJlY29nbml0aW9uU3RhdHVzICE9PSBSZWNvZ25pdGlvblN0YXR1cy5Jbml0aWFsU2lsZW5jZVRpbWVvdXQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXYgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncyhyZXN1bHQsIHJlc3VsdC5vZmZzZXQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnJlY29nbml6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemVkKHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciwgZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcG9ydCByZXN1bHQgdG8gcHJvbWlzZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayhyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZFcnJvckNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgaW52b2tlIHRoZSBjYWxsIGJhY2sgb25jZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWYgaXQncyBzdWNjZXNzZnVsIGRvbid0IGludm9rZSB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlcnJvciBhZnRlciB0aGF0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvckNhbGxiYWNrID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRQcm9wcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0LCBjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmFuc2xhdGlvbi5oeXBvdGhlc2lzXCI6XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuZmlyZUV2ZW50Rm9yUmVzdWx0KFRyYW5zbGF0aW9uSHlwb3RoZXNpcy5mcm9tSlNPTihjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSksIHJlc3VsdFByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25IeXBvdGhlc2lzKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLmN1cnJlbnRUdXJuQXVkaW9PZmZzZXQgKyByZXN1bHQub2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnJlY29nbml6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemluZyh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpcCB0aGluZ3MgdXAuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInRyYW5zbGF0aW9uLnJlc3BvbnNlXCI6XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBocmFzZSA9IEpTT04ucGFyc2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoISFwaHJhc2UuU3BlZWNoUGhyYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBoYW5kbGVUcmFuc2xhdGlvblBocmFzZShUcmFuc2xhdGlvblBocmFzZS5mcm9tVHJhbnNsYXRpb25SZXNwb25zZShwaHJhc2UpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwidHJhbnNsYXRpb24ucGhyYXNlXCI6XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGhhbmRsZVRyYW5zbGF0aW9uUGhyYXNlKFRyYW5zbGF0aW9uUGhyYXNlLmZyb21KU09OKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmFuc2xhdGlvbi5zeW50aGVzaXNcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZW5kU3ludGhlc2lzQXVkaW8oY29ubmVjdGlvbk1lc3NhZ2UuYmluYXJ5Qm9keSwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImF1ZGlvLmVuZFwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0cmFuc2xhdGlvbi5zeW50aGVzaXMuZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN5bnRoRW5kID0gVHJhbnNsYXRpb25TeW50aGVzaXNFbmQuZnJvbUpTT04oY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHN5bnRoRW5kLlN5bnRoZXNpc1N0YXR1cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBTeW50aGVzaXNTdGF0dXMuRXJyb3I6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnN5bnRoZXNpemluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHQoUmVzdWx0UmVhc29uLkNhbmNlbGVkLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXRFdmVudCA9IG5ldyBUcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncyhyZXN1bHQsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIuc3ludGhlc2l6aW5nKHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciwgcmV0RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW5kIHJhaXNlIGEgY2FuY2VsZWQgZXZlbnQgdG8gc2VuZCB0aGUgcmljaChlcikgZXJyb3IgbWVzc2FnZSBiYWNrLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxlZFJlc3VsdCA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3ModGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3IsIHN5bnRoRW5kLkZhaWx1cmVSZWFzb24sIENhbmNlbGxhdGlvbkVycm9yQ29kZS5TZXJ2aWNlRXJyb3IsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLmNhbmNlbGVkKHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciwgY2FuY2VsZWRSZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBnb2luZyB0byBsZXQgZXJyb3JzIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU3ludGhlc2lzU3RhdHVzLlN1Y2Nlc3M6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZW5kU3ludGhlc2lzQXVkaW8odW5kZWZpbmVkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwcm9jZXNzZWQ7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBDYW5jZWxzIHJlY29nbml0aW9uLlxuICAgIGNhbmNlbFJlY29nbml0aW9uKHNlc3Npb25JZCwgcmVxdWVzdElkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yQ29kZSwgZXJyb3IpIHtcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtlcnJvckNvZGVdKTtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICBjb25zdCBjYW5jZWxFdmVudCA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3Moc2Vzc2lvbklkLCBjYW5jZWxsYXRpb25SZWFzb24sIGVycm9yLCBlcnJvckNvZGUsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5jYW5jZWxlZCh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIGNhbmNlbEV2ZW50KTtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9hKSB7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoISF0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0KHVuZGVmaW5lZCwgLy8gVHJhbnNsYXRpb25zXG4gICAgICAgICAgICByZXF1ZXN0SWQsIFJlc3VsdFJlYXNvbi5DYW5jZWxlZCwgdW5kZWZpbmVkLCAvLyBUZXh0XG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIERydWF0aW9uXG4gICAgICAgICAgICB1bmRlZmluZWQsIC8vIE9mZnNldFxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZVxuICAgICAgICAgICAgdW5kZWZpbmVkLCAvLyBMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2VcbiAgICAgICAgICAgIGVycm9yLCB1bmRlZmluZWQsIC8vIEpzb25cbiAgICAgICAgICAgIHByb3BlcnRpZXMpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NDYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfYikgeyB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlUmVjb2duaXppbmdDYWxsYmFjayhyZXN1bHQsIGR1cmF0aW9uLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IFRyYW5zbGF0aW9uUmVjb2duaXRpb25FdmVudEFyZ3MoVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdC5mcm9tU3BlZWNoUmVjb2duaXRpb25SZXN1bHQocmVzdWx0KSwgZHVyYXRpb24sIHNlc3Npb25JZCk7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIucmVjb2duaXppbmcodGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLCBldik7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZVJlY29nbml6ZWRDYWxsYmFjayhyZXN1bHQsIG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBldiA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzKFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQuZnJvbVNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHJlc3VsdCksIG9mZnNldCwgc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5yZWNvZ25pemVkKHRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplciwgZXYpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgIC8vIHRyaXAgdGhpbmdzIHVwLlxuICAgICAgICB9XG4gICAgfVxuICAgIGZpcmVFdmVudEZvclJlc3VsdChzZXJ2aWNlUmVzdWx0LCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIGxldCB0cmFuc2xhdGlvbnM7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHNlcnZpY2VSZXN1bHQuVHJhbnNsYXRpb24uVHJhbnNsYXRpb25zKSB7XG4gICAgICAgICAgICB0cmFuc2xhdGlvbnMgPSBuZXcgVHJhbnNsYXRpb25zKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRyYW5zbGF0aW9uIG9mIHNlcnZpY2VSZXN1bHQuVHJhbnNsYXRpb24uVHJhbnNsYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgdHJhbnNsYXRpb25zLnNldCh0cmFuc2xhdGlvbi5MYW5ndWFnZSwgdHJhbnNsYXRpb24uVGV4dCB8fCB0cmFuc2xhdGlvbi5EaXNwbGF5VGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHJlc3VsdFJlYXNvbjtcbiAgICAgICAgbGV0IGxhbmd1YWdlO1xuICAgICAgICBsZXQgY29uZmlkZW5jZTtcbiAgICAgICAgaWYgKHNlcnZpY2VSZXN1bHQgaW5zdGFuY2VvZiBUcmFuc2xhdGlvblBocmFzZSkge1xuICAgICAgICAgICAgaWYgKCEhc2VydmljZVJlc3VsdC5UcmFuc2xhdGlvbiAmJiBzZXJ2aWNlUmVzdWx0LlRyYW5zbGF0aW9uLlRyYW5zbGF0aW9uU3RhdHVzID09PSBUcmFuc2xhdGlvblN0YXR1cy5TdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0UmVhc29uID0gUmVzdWx0UmVhc29uLlRyYW5zbGF0ZWRTcGVlY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHRSZWFzb24gPSBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWVjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxhbmd1YWdlID0gc2VydmljZVJlc3VsdC5MYW5ndWFnZTtcbiAgICAgICAgICAgIGNvbmZpZGVuY2UgPSBzZXJ2aWNlUmVzdWx0LkNvbmZpZGVuY2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHRSZWFzb24gPSBSZXN1bHRSZWFzb24uVHJhbnNsYXRpbmdTcGVlY2g7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gc2VydmljZVJlc3VsdC5PZmZzZXQgKyB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5jdXJyZW50VHVybkF1ZGlvT2Zmc2V0O1xuICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdCh0cmFuc2xhdGlvbnMsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgcmVzdWx0UmVhc29uLCBzZXJ2aWNlUmVzdWx0LlRleHQsIHNlcnZpY2VSZXN1bHQuRHVyYXRpb24sIG9mZnNldCwgbGFuZ3VhZ2UsIGNvbmZpZGVuY2UsIHNlcnZpY2VSZXN1bHQuVHJhbnNsYXRpb24uRmFpbHVyZVJlYXNvbiwgSlNPTi5zdHJpbmdpZnkoc2VydmljZVJlc3VsdCksIHByb3BlcnRpZXMpO1xuICAgICAgICBjb25zdCBldiA9IG5ldyBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzKHJlc3VsdCwgb2Zmc2V0LCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zZXNzaW9uSWQpO1xuICAgICAgICByZXR1cm4gZXY7XG4gICAgfVxuICAgIHNlbmRTeW50aGVzaXNBdWRpbyhhdWRpbywgc2Vzc2lvbklkKSB7XG4gICAgICAgIGNvbnN0IHJlYXNvbiA9ICh1bmRlZmluZWQgPT09IGF1ZGlvKSA/IFJlc3VsdFJlYXNvbi5TeW50aGVzaXppbmdBdWRpb0NvbXBsZXRlZCA6IFJlc3VsdFJlYXNvbi5TeW50aGVzaXppbmdBdWRpbztcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFRyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0KHJlYXNvbiwgYXVkaW8pO1xuICAgICAgICBjb25zdCByZXRFdmVudCA9IG5ldyBUcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncyhyZXN1bHQsIHNlc3Npb25JZCk7XG4gICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0aW9uUmVjb2duaXplci5zeW50aGVzaXppbmcpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25SZWNvZ25pemVyLnN5bnRoZXNpemluZyh0aGlzLnByaXZUcmFuc2xhdGlvblJlY29nbml6ZXIsIHJldEV2ZW50KTtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gTm90IGdvaW5nIHRvIGxldCBlcnJvcnMgaW4gdGhlIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgICAgICAgICAvLyB0cmlwIHRoaW5ncyB1cC5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25TZXJ2aWNlUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRyYW5zbGF0aW9uIHN0YXR1cy5cbiAqIEBjbGFzcyBUcmFuc2xhdGlvblN0YXR1c1xuICovXG5leHBvcnQgdmFyIFRyYW5zbGF0aW9uU3RhdHVzO1xuKGZ1bmN0aW9uIChUcmFuc2xhdGlvblN0YXR1cykge1xuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25TdGF0dXMuU3VjY2Vzc1xuICAgICAqL1xuICAgIFRyYW5zbGF0aW9uU3RhdHVzW1RyYW5zbGF0aW9uU3RhdHVzW1wiU3VjY2Vzc1wiXSA9IDBdID0gXCJTdWNjZXNzXCI7XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblN0YXR1cy5FcnJvclxuICAgICAqL1xuICAgIFRyYW5zbGF0aW9uU3RhdHVzW1RyYW5zbGF0aW9uU3RhdHVzW1wiRXJyb3JcIl0gPSAxXSA9IFwiRXJyb3JcIjtcbn0pKFRyYW5zbGF0aW9uU3RhdHVzIHx8IChUcmFuc2xhdGlvblN0YXR1cyA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uU3RhdHVzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFJlcGxheWFibGVBdWRpb05vZGUgfSBmcm9tIFwiLi4vY29tbW9uLmJyb3dzZXIvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRGVmZXJyYWxNYXAsIERlZmVycmVkLCBNZXNzYWdlVHlwZSwgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgU2Vzc2lvbkV2ZW50QXJncywgVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdCwgVm9pY2VQcm9maWxlUGhyYXNlUmVzdWx0LCBWb2ljZVByb2ZpbGVSZXN1bHQsIFZvaWNlUHJvZmlsZVR5cGUgfSBmcm9tIFwiLi4vc2RrL0V4cG9ydHNcIjtcbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgU2VydmljZVJlY29nbml6ZXJCYXNlLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vU3BlZWNoQ29ubmVjdGlvbk1lc3NhZ2UuSW50ZXJuYWxcIjtcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIFZvaWNlU2VydmljZVJlY29nbml6ZXIgZXh0ZW5kcyBTZXJ2aWNlUmVjb2duaXplckJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Tb3VyY2UsIHJlY29nbml6ZXJDb25maWcsIHJlY29nbml6ZXIpIHtcbiAgICAgICAgc3VwZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb1NvdXJjZSwgcmVjb2duaXplckNvbmZpZywgcmVjb2duaXplcik7XG4gICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwID0gbmV3IERlZmVycmFsTWFwKCk7XG4gICAgICAgIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZSA9IGF1ZGlvU291cmNlO1xuICAgICAgICB0aGlzLnNlbmRQcmVQYXlsb2FkSlNPTk92ZXJyaWRlID0gKCkgPT4gdGhpcy5ub09wKCk7XG4gICAgfVxuICAgIHNldCBTcGVha2VyQXVkaW9Tb3VyY2UoYXVkaW9Tb3VyY2UpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlYWtlckF1ZGlvU291cmNlID0gYXVkaW9Tb3VyY2U7XG4gICAgfVxuICAgIHByb2Nlc3NUeXBlU3BlY2lmaWNNZXNzYWdlcyhjb25uZWN0aW9uTWVzc2FnZSkge1xuICAgICAgICBsZXQgcHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHJlc3VsdFByb3BzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBpZiAoY29ubmVjdGlvbk1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgIHJlc3VsdFByb3BzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHQsIGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGNvbm5lY3Rpb25NZXNzYWdlLnBhdGgudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgLy8gUHJvZmlsZSBtYW5hZ2VtZW50IHJlc3BvbnNlIGZvciBjcmVhdGUsIGZldGNoLCBkZWxldGUsIHJlc2V0XG4gICAgICAgICAgICBjYXNlIFwic3BlYWtlci5wcm9maWxlc1wiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChyZXNwb25zZS5vcGVyYXRpb24udG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3JlYXRlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNyZWF0ZVJlc3BvbnNlKHJlc3BvbnNlLCBjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWxldGVcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInJlc2V0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVJlc3VsdFJlc3BvbnNlKHJlc3BvbnNlLCBjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJmZXRjaFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5yb2xsbWVudFJlc3BvbnNlID0gSlNPTi5wYXJzZShjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUZldGNoUmVzcG9uc2UoZW5yb2xsbWVudFJlc3BvbnNlLCBjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8vIEFjdGl2YXRpb24gYW5kIGF1dGhvcml6YXRpb24gcGhyYXNlIHJlc3BvbnNlXG4gICAgICAgICAgICBjYXNlIFwic3BlYWtlci5waHJhc2VzXCI6XG4gICAgICAgICAgICAgICAgY29uc3QgcGhyYXNlUmVzcG9uc2UgPSBKU09OLnBhcnNlKGNvbm5lY3Rpb25NZXNzYWdlLnRleHRCb2R5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVBocmFzZXNSZXNwb25zZShwaHJhc2VSZXNwb25zZSwgY29ubmVjdGlvbk1lc3NhZ2UucmVxdWVzdElkKTtcbiAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLy8gRW5yb2xsbWVudCByZXNwb25zZVxuICAgICAgICAgICAgY2FzZSBcInNwZWFrZXIucHJvZmlsZS5lbnJvbGxtZW50XCI6XG4gICAgICAgICAgICAgICAgY29uc3QgZW5yb2xsbWVudFJlc3BvbnNlID0gSlNPTi5wYXJzZShjb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQodGhpcy5lbnJvbGxtZW50UmVhc29uRnJvbSghIWVucm9sbG1lbnRSZXNwb25zZS5lbnJvbGxtZW50ID8gZW5yb2xsbWVudFJlc3BvbnNlLmVucm9sbG1lbnQuZW5yb2xsbWVudFN0YXR1cyA6IGVucm9sbG1lbnRSZXNwb25zZS5zdGF0dXMuc3RhdHVzQ29kZSksICEhZW5yb2xsbWVudFJlc3BvbnNlLmVucm9sbG1lbnQgPyBKU09OLnN0cmluZ2lmeShlbnJvbGxtZW50UmVzcG9uc2UuZW5yb2xsbWVudCkgOiB1bmRlZmluZWQsIGVucm9sbG1lbnRSZXNwb25zZS5zdGF0dXMucmVhc29uKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZEZWZlcnJhbE1hcC5nZXRJZChjb25uZWN0aW9uTWVzc2FnZS5yZXF1ZXN0SWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwLmNvbXBsZXRlKGNvbm5lY3Rpb25NZXNzYWdlLnJlcXVlc3RJZCwgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TcGVlY2hFbmRlZCgpO1xuICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRlZmZlcmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIGRlZmZlcmFsLnJlc29sdmUocHJvY2Vzc2VkKTtcbiAgICAgICAgcmV0dXJuIGRlZmZlcmFsLnByb21pc2U7XG4gICAgfVxuICAgIC8vIENhbmNlbHMgcmVjb2duaXRpb24uXG4gICAgY2FuY2VsUmVjb2duaXRpb24oc2Vzc2lvbklkLCByZXF1ZXN0SWQsIGNhbmNlbGxhdGlvblJlYXNvbiwgZXJyb3JDb2RlLCBlcnJvcikge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICAvLyBjb25zdCBlbnJvbGxtZW50UmVzcG9uc2U6IEVucm9sbG1lbnRSZXNwb25zZSA9IEpTT04ucGFyc2UoY29ubmVjdGlvbk1lc3NhZ2UudGV4dEJvZHkpIGFzIEVucm9sbG1lbnRSZXNwb25zZTtcbiAgICAgICAgcHJvcGVydGllcy5zZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtlcnJvckNvZGVdKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQoUmVzdWx0UmVhc29uLkNhbmNlbGVkLCBlcnJvciwgZXJyb3IpO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZEZWZlcnJhbE1hcC5nZXRJZChyZXF1ZXN0SWQpKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5jb21wbGV0ZShyZXF1ZXN0SWQsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlUHJvZmlsZShwcm9maWxlVHlwZSwgbG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAvLyBTdGFydCB0aGUgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS4gVGhlIHByb21pc2UgdGhpcyB3aWxsIGNyZWF0ZSBpcyBzdG9yZWQgYW5kIHdpbGwgYmUgdXNlZCBieSBjb25maWd1cmVDb25uZWN0aW9uKCkuXG4gICAgICAgICAgICB0aGlzLnZvaWNlUHJvZmlsZVR5cGUgPSBwcm9maWxlVHlwZS50b1N0cmluZygpO1xuICAgICAgICAgICAgY29uc3QgY29uUHJvbWlzZSA9IHRoaXMuY29ubmVjdEltcGwoKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3JlYXRlUHJvZmlsZURlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICAgICAgeWllbGQgY29uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnNlbmRDcmVhdGVQcm9maWxlKGNyZWF0ZVByb2ZpbGVEZWZlcnJhbCwgcHJvZmlsZVR5cGUsIGxvY2FsZSk7XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVByb2ZpbGVEZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJlc2V0UHJvZmlsZShwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnZvaWNlUHJvZmlsZVR5cGUgPSBwcm9maWxlLnByb2ZpbGVUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZW5kQ29tbW9uUmVxdWVzdChcInJlc2V0XCIsIHByb2ZpbGUucHJvZmlsZVR5cGUsIHByb2ZpbGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGVsZXRlUHJvZmlsZShwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnZvaWNlUHJvZmlsZVR5cGUgPSBwcm9maWxlLnByb2ZpbGVUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZW5kQ29tbW9uUmVxdWVzdChcImRlbGV0ZVwiLCBwcm9maWxlLnByb2ZpbGVUeXBlLCBwcm9maWxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHJpZXZlRW5yb2xsbWVudFJlc3VsdChwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnZvaWNlUHJvZmlsZVR5cGUgPSBwcm9maWxlLnByb2ZpbGVUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZFeHBlY3RlZFByb2ZpbGVJZCA9IHByb2ZpbGUucHJvZmlsZUlkO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VuZENvbW1vblJlcXVlc3QoXCJmZXRjaFwiLCBwcm9maWxlLnByb2ZpbGVUeXBlLCBwcm9maWxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldEFsbFByb2ZpbGVzKHByb2ZpbGVUeXBlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnZvaWNlUHJvZmlsZVR5cGUgPSBwcm9maWxlVHlwZS50b1N0cmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VuZENvbW1vblJlcXVlc3QoXCJmZXRjaFwiLCBwcm9maWxlVHlwZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRBY3RpdmF0aW9uUGhyYXNlcyhwcm9maWxlVHlwZSwgbGFuZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZVR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2aWNlLiBUaGUgcHJvbWlzZSB0aGlzIHdpbGwgY3JlYXRlIGlzIHN0b3JlZCBhbmQgd2lsbCBiZSB1c2VkIGJ5IGNvbmZpZ3VyZUNvbm5lY3Rpb24oKS5cbiAgICAgICAgICAgIGNvbnN0IGNvblByb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGdldFBocmFzZXNEZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvblByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kUGhyYXNlc1JlcXVlc3QoZ2V0UGhyYXNlc0RlZmVycmFsLCBwcm9maWxlVHlwZSwgbGFuZyk7XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLnJlY2VpdmVNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBocmFzZXNEZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVucm9sbFByb2ZpbGUocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdGhpcy52b2ljZVByb2ZpbGVUeXBlID0gcHJvZmlsZS5wcm9maWxlVHlwZS50b1N0cmluZygpO1xuICAgICAgICAgICAgY29uc3QgZW5yb2xsbWVudERlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5zdGFydE5ld1JlY29nbml0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5saXN0ZW5Gb3JTZXJ2aWNlVGVsZW1ldHJ5KHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZS5ldmVudHMpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplckNvbmZpZy5wYXJhbWV0ZXJzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoX1Nlc3Npb25JZCwgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2aWNlLiBUaGUgcHJvbWlzZSB0aGlzIHdpbGwgY3JlYXRlIGlzIHN0b3JlZCBhbmQgd2lsbCBiZSB1c2VkIGJ5IGNvbmZpZ3VyZUNvbm5lY3Rpb24oKS5cbiAgICAgICAgICAgIGNvbnN0IGNvblByb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICBjb25zdCBwcmVBdWRpb1Byb21pc2UgPSB0aGlzLnNlbmRQcmVBdWRpb01lc3NhZ2VzKHByb2ZpbGUsIGVucm9sbG1lbnREZWZlcnJhbCk7XG4gICAgICAgICAgICBjb25zdCBub2RlID0geWllbGQgdGhpcy5wcml2U3BlYWtlckF1ZGlvU291cmNlLmF0dGFjaCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5hdWRpb05vZGVJZCk7XG4gICAgICAgICAgICBjb25zdCBmb3JtYXQgPSB5aWVsZCB0aGlzLnByaXZTcGVha2VyQXVkaW9Tb3VyY2UuZm9ybWF0O1xuICAgICAgICAgICAgY29uc3QgZGV2aWNlSW5mbyA9IHlpZWxkIHRoaXMucHJpdlNwZWFrZXJBdWRpb1NvdXJjZS5kZXZpY2VJbmZvO1xuICAgICAgICAgICAgY29uc3QgYXVkaW9Ob2RlID0gbmV3IFJlcGxheWFibGVBdWRpb05vZGUobm9kZSwgZm9ybWF0LmF2Z0J5dGVzUGVyU2VjKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uQXVkaW9Tb3VyY2VBdHRhY2hDb21wbGV0ZWQoYXVkaW9Ob2RlLCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyQ29uZmlnLlNwZWVjaFNlcnZpY2VDb25maWcuQ29udGV4dC5hdWRpbyA9IHsgc291cmNlOiBkZXZpY2VJbmZvIH07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHlpZWxkIGNvblByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgcHJlQXVkaW9Qcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsUmVjb2duaXRpb24odGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLkNvbm5lY3Rpb25GYWlsdXJlLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvblN0YXJ0RXZlbnRBcmdzID0gbmV3IFNlc3Npb25FdmVudEFyZ3ModGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkKTtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIuc2Vzc2lvblN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnNlc3Npb25TdGFydGVkKHRoaXMucHJpdlJlY29nbml6ZXIsIHNlc3Npb25TdGFydEV2ZW50QXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2b2lkIHRoaXMucmVjZWl2ZU1lc3NhZ2UoKTtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvU2VuZFByb21pc2UgPSB0aGlzLnNlbmRBdWRpbyhhdWRpb05vZGUpO1xuICAgICAgICAgICAgLy8gLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICAgICAgICAgIGF1ZGlvU2VuZFByb21pc2UudGhlbigoKSA9PiB7IH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsUmVjb2duaXRpb24odGhpcy5wcml2UmVxdWVzdFNlc3Npb24uc2Vzc2lvbklkLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLlJ1bnRpbWVFcnJvciwgZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZW5yb2xsbWVudERlZmVycmFsLnByb21pc2U7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZW5kUHJlQXVkaW9NZXNzYWdlcyhwcm9maWxlLCBlbnJvbGxtZW50RGVmZXJyYWwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB5aWVsZCB0aGlzLmZldGNoQ29ubmVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TcGVlY2hDb250ZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5hZGQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBlbnJvbGxtZW50RGVmZXJyYWwpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kQmFzZVJlcXVlc3QoY29ubmVjdGlvbiwgXCJlbnJvbGxcIiwgdGhpcy5zY2VuYXJpb0Zyb20ocHJvZmlsZS5wcm9maWxlVHlwZSksIHByb2ZpbGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZFBocmFzZXNSZXF1ZXN0KGdldFBocmFzZXNEZWZlcnJhbCwgcHJvZmlsZVR5cGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHlpZWxkIHRoaXMuZmV0Y2hDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5vblNwZWVjaENvbnRleHQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkRlZmVycmFsTWFwLmFkZCh0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIGdldFBocmFzZXNEZWZlcnJhbCk7XG4gICAgICAgICAgICBjb25zdCBzY2VuYXJpbyA9IHRoaXMuc2NlbmFyaW9Gcm9tKHByb2ZpbGVUeXBlKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVDcmVhdGVSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICAgICAgICBzY2VuYXJpbyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBcInNwZWFrZXIucHJvZmlsZS5waHJhc2VzXCIsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04XCIsIEpTT04uc3RyaW5naWZ5KHByb2ZpbGVDcmVhdGVSZXF1ZXN0KSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2VuZENyZWF0ZVByb2ZpbGUoY3JlYXRlUHJvZmlsZURlZmVycmFsLCBwcm9maWxlVHlwZSwgbG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLm9uU3BlZWNoQ29udGV4dCgpO1xuICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuYWRkKHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgY3JlYXRlUHJvZmlsZURlZmVycmFsKTtcbiAgICAgICAgICAgIGNvbnN0IHNjZW5hcmlvID0gcHJvZmlsZVR5cGUgPT09IFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb24gPyBcIlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uXCIgOlxuICAgICAgICAgICAgICAgIHByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvbiA/IFwiVGV4dEluZGVwZW5kZW50VmVyaWZpY2F0aW9uXCIgOiBcIlRleHREZXBlbmRlbnRWZXJpZmljYXRpb25cIjtcbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVDcmVhdGVSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICAgICAgICBudW1iZXI6IFwiMVwiLFxuICAgICAgICAgICAgICAgIHNjZW5hcmlvLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBjb25uZWN0aW9uLnNlbmQobmV3IFNwZWVjaENvbm5lY3Rpb25NZXNzYWdlKE1lc3NhZ2VUeXBlLlRleHQsIFwic3BlYWtlci5wcm9maWxlLmNyZWF0ZVwiLCB0aGlzLnByaXZSZXF1ZXN0U2Vzc2lvbi5yZXF1ZXN0SWQsIFwiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOFwiLCBKU09OLnN0cmluZ2lmeShwcm9maWxlQ3JlYXRlUmVxdWVzdCkpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRDb21tb25SZXF1ZXN0KG9wZXJhdGlvbiwgcHJvZmlsZVR5cGUsIHByb2ZpbGUgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIC8vIFN0YXJ0IHRoZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2aWNlLiBUaGUgcHJvbWlzZSB0aGlzIHdpbGwgY3JlYXRlIGlzIHN0b3JlZCBhbmQgd2lsbCBiZSB1c2VkIGJ5IGNvbmZpZ3VyZUNvbm5lY3Rpb24oKS5cbiAgICAgICAgICAgIGNvbnN0IGNvblByb21pc2UgPSB0aGlzLmNvbm5lY3RJbXBsKCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVxdWVzdFNlc3Npb24ub25TcGVlY2hDb250ZXh0KCk7XG4gICAgICAgICAgICAgICAgeWllbGQgY29uUHJvbWlzZTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb25uZWN0aW9uID0geWllbGQgdGhpcy5mZXRjaENvbm5lY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5hZGQodGhpcy5wcml2UmVxdWVzdFNlc3Npb24ucmVxdWVzdElkLCBkZWZlcnJhbCk7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5zZW5kQmFzZVJlcXVlc3QoY29ubmVjdGlvbiwgb3BlcmF0aW9uLCB0aGlzLnNjZW5hcmlvRnJvbShwcm9maWxlVHlwZSksIHByb2ZpbGUpO1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5yZWNlaXZlTWVzc2FnZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJhbC5wcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNlbmRCYXNlUmVxdWVzdChjb25uZWN0aW9uLCBvcGVyYXRpb24sIHNjZW5hcmlvLCBwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBwcm9maWxlUmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICBzY2VuYXJpb1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICghIXByb2ZpbGUpIHtcbiAgICAgICAgICAgICAgICBwcm9maWxlUmVxdWVzdC5wcm9maWxlSWRzID0gW3Byb2ZpbGUucHJvZmlsZUlkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb2ZpbGVSZXF1ZXN0Lm1heFBhZ2VTaXplID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29ubmVjdGlvbi5zZW5kKG5ldyBTcGVlY2hDb25uZWN0aW9uTWVzc2FnZShNZXNzYWdlVHlwZS5UZXh0LCBgc3BlYWtlci5wcm9maWxlLiR7b3BlcmF0aW9ufWAsIHRoaXMucHJpdlJlcXVlc3RTZXNzaW9uLnJlcXVlc3RJZCwgXCJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04XCIsIEpTT04uc3RyaW5naWZ5KHByb2ZpbGVSZXF1ZXN0KSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZXh0cmFjdFNwZWFrZXJDb250ZXh0KG1vZGVsKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmZWF0dXJlczoge1xuICAgICAgICAgICAgICAgIGludGVyaW1SZXN1bHQ6IFwiZW5hYmxlZFwiLFxuICAgICAgICAgICAgICAgIHByb2dyZXNzaXZlRGV0ZWN0aW9uOiBcImRpc2FibGVkXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvZmlsZUlkczogbW9kZWwucHJvZmlsZUlkcyxcbiAgICAgICAgICAgIHNjZW5hcmlvOiBtb2RlbC5zY2VuYXJpbyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaGFuZGxlUGhyYXNlc1Jlc3BvbnNlKHJlc3BvbnNlLCByZXF1ZXN0SWQpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2RGVmZXJyYWxNYXAuZ2V0SWQocmVxdWVzdElkKSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cy5zdGF0dXNDb2RlLnRvTG93ZXJDYXNlKCkgIT09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhc29uID0gUmVzdWx0UmVhc29uLkNhbmNlbGVkO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBWb2ljZVByb2ZpbGVQaHJhc2VSZXN1bHQocmVhc29uLCByZXNwb25zZS5zdGF0dXMuc3RhdHVzQ29kZSwgcmVzcG9uc2UucGFzc1BocmFzZVR5cGUsIFtdKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5jb21wbGV0ZShyZXF1ZXN0SWQsIHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghIXJlc3BvbnNlLnBocmFzZXMgJiYgcmVzcG9uc2UucGhyYXNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhc29uID0gUmVzdWx0UmVhc29uLkVucm9sbGluZ1ZvaWNlUHJvZmlsZTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVm9pY2VQcm9maWxlUGhyYXNlUmVzdWx0KHJlYXNvbiwgcmVzcG9uc2Uuc3RhdHVzLnN0YXR1c0NvZGUsIHJlc3BvbnNlLnBhc3NQaHJhc2VUeXBlLCByZXNwb25zZS5waHJhc2VzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5jb21wbGV0ZShyZXF1ZXN0SWQsIHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWb2ljZSBQcm9maWxlIGdldCBhY3RpdmF0aW9uIHBocmFzZXMgZmFpbGVkLCBubyBwaHJhc2VzIHJlY2VpdmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBWb2ljZSBQcm9maWxlIGdldCBhY3RpdmF0aW9uIHBocmFzZXMgcmVxdWVzdCBmb3IgcmVxdWVzdElEICR7cmVxdWVzdElkfSBub3QgZm91bmRgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVDcmVhdGVSZXNwb25zZShyZXNwb25zZSwgcmVxdWVzdElkKSB7XG4gICAgICAgIGlmICghIXJlc3BvbnNlLnByb2ZpbGVzICYmIHJlc3BvbnNlLnByb2ZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkRlZmVycmFsTWFwLmdldElkKHJlcXVlc3RJZCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9maWxlSWRzID0gcmVzcG9uc2UucHJvZmlsZXMubWFwKChwcm9maWxlKSA9PiBwcm9maWxlLnByb2ZpbGVJZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCBwcm9maWxlSWRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVm9pY2UgUHJvZmlsZSBjcmVhdGUgcmVxdWVzdCBmb3IgcmVxdWVzdElEICR7cmVxdWVzdElkfSBub3QgZm91bmRgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZvaWNlIFByb2ZpbGUgY3JlYXRlIGZhaWxlZCwgbm8gcHJvZmlsZSBpZCByZWNlaXZlZFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVSZXN1bHRSZXNwb25zZShyZXNwb25zZSwgcmVxdWVzdElkKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkRlZmVycmFsTWFwLmdldElkKHJlcXVlc3RJZCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1Y2Nlc3NSZWFzb24gPSByZXNwb25zZS5vcGVyYXRpb24udG9Mb3dlckNhc2UoKSA9PT0gXCJkZWxldGVcIiA/IFJlc3VsdFJlYXNvbi5EZWxldGVkVm9pY2VQcm9maWxlIDogUmVzdWx0UmVhc29uLlJlc2V0Vm9pY2VQcm9maWxlO1xuICAgICAgICAgICAgY29uc3QgcmVhc29uID0gcmVzcG9uc2Uuc3RhdHVzLnN0YXR1c0NvZGUudG9Mb3dlckNhc2UoKSA9PT0gXCJzdWNjZXNzXCIgPyBzdWNjZXNzUmVhc29uIDogUmVzdWx0UmVhc29uLkNhbmNlbGVkO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFZvaWNlUHJvZmlsZVJlc3VsdChyZWFzb24sIGBzdGF0dXNDb2RlOiAke3Jlc3BvbnNlLnN0YXR1cy5zdGF0dXNDb2RlfSwgZXJyb3JEZXRhaWxzOiAke3Jlc3BvbnNlLnN0YXR1cy5yZWFzb259YCk7XG4gICAgICAgICAgICB0aGlzLnByaXZEZWZlcnJhbE1hcC5jb21wbGV0ZShyZXF1ZXN0SWQsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZvaWNlIFByb2ZpbGUgY3JlYXRlIHJlcXVlc3QgZm9yIHJlcXVlc3RJRCAke3JlcXVlc3RJZH0gbm90IGZvdW5kYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRmV0Y2hSZXNwb25zZShlbnJvbGxtZW50UmVzcG9uc2UsIHJlcXVlc3RJZCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZEZWZlcnJhbE1hcC5nZXRJZChyZXF1ZXN0SWQpICYmICEhZW5yb2xsbWVudFJlc3BvbnNlLnByb2ZpbGVzWzBdKSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZFeHBlY3RlZFByb2ZpbGVJZCAmJiBlbnJvbGxtZW50UmVzcG9uc2UucHJvZmlsZXMubGVuZ3RoID09PSAxICYmIGVucm9sbG1lbnRSZXNwb25zZS5wcm9maWxlc1swXS5wcm9maWxlSWQgPT09IHRoaXMucHJpdkV4cGVjdGVkUHJvZmlsZUlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RXhwZWN0ZWRQcm9maWxlSWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZUluZm8gPSBlbnJvbGxtZW50UmVzcG9uc2UucHJvZmlsZXNbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQodGhpcy5lbnJvbGxtZW50UmVhc29uRnJvbShwcm9maWxlSW5mby5lbnJvbGxtZW50U3RhdHVzKSwgSlNPTi5zdHJpbmdpZnkocHJvZmlsZUluZm8pLCBlbnJvbGxtZW50UmVzcG9uc2Uuc3RhdHVzLnJlYXNvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCByZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZW5yb2xsbWVudFJlc3BvbnNlLnByb2ZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpUHJvZmlsZXMgPSBlbnJvbGxtZW50UmVzcG9uc2UucHJvZmlsZXM7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvZmlsZVJlc3VsdHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHByb2ZpbGUgb2YgaVByb2ZpbGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2ZpbGVSZXN1bHRzLnB1c2gobmV3IFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQodGhpcy5lbnJvbGxtZW50UmVhc29uRnJvbShwcm9maWxlLmVucm9sbG1lbnRTdGF0dXMpLCBKU09OLnN0cmluZ2lmeShwcm9maWxlKSwgZW5yb2xsbWVudFJlc3BvbnNlLnN0YXR1cy5yZWFzb24pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGVmZXJyYWxNYXAuY29tcGxldGUocmVxdWVzdElkLCBwcm9maWxlUmVzdWx0cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZvaWNlIFByb2ZpbGUgZmV0Y2ggcmVxdWVzdCBmb3IgcmVxdWVzdElEICR7cmVxdWVzdElkfSBub3QgZm91bmRgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbnJvbGxtZW50UmVhc29uRnJvbShzdGF0dXNDb2RlKSB7XG4gICAgICAgIHN3aXRjaCAoc3RhdHVzQ29kZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwiZW5yb2xsZWRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVzdWx0UmVhc29uLkVucm9sbGVkVm9pY2VQcm9maWxlO1xuICAgICAgICAgICAgY2FzZSBcImludmFsaWRsb2NhbGVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJpbnZhbGlkcGhyYXNlXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW52YWxpZGF1ZGlvZm9ybWF0XCI6XG4gICAgICAgICAgICBjYXNlIFwiaW52YWxpZHNjZW5hcmlvXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW52YWxpZHByb2ZpbGVjb3VudFwiOlxuICAgICAgICAgICAgY2FzZSBcImludmFsaWRvcGVyYXRpb25cIjpcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpb3Rvb3Nob3J0XCI6XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW90b29sb25nXCI6XG4gICAgICAgICAgICBjYXNlIFwidG9vbWFueWVucm9sbG1lbnRzXCI6XG4gICAgICAgICAgICBjYXNlIFwic3RvcmFnZWNvbmZsaWN0XCI6XG4gICAgICAgICAgICBjYXNlIFwicHJvZmlsZW5vdGZvdW5kXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW5jb21wYXRpYmxlcHJvZmlsZXNcIjpcbiAgICAgICAgICAgIGNhc2UgXCJpbmNvbXBsZXRlZW5yb2xsbWVudFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRSZWFzb24uQ2FuY2VsZWQ7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBSZXN1bHRSZWFzb24uRW5yb2xsaW5nVm9pY2VQcm9maWxlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNjZW5hcmlvRnJvbShwcm9maWxlVHlwZSkge1xuICAgICAgICByZXR1cm4gcHJvZmlsZVR5cGUgPT09IFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb24gPyBcIlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uXCIgOlxuICAgICAgICAgICAgcHJvZmlsZVR5cGUgPT09IFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50VmVyaWZpY2F0aW9uID8gXCJUZXh0SW5kZXBlbmRlbnRWZXJpZmljYXRpb25cIiA6IFwiVGV4dERlcGVuZGVudFZlcmlmaWNhdGlvblwiO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vm9pY2VTZXJ2aWNlUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29ubmVjdGlvbk1lc3NhZ2UsIERlZmVycmVkLCBNZXNzYWdlVHlwZSwgUmF3V2Vic29ja2V0TWVzc2FnZSwgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmNvbnN0IENSTEYgPSBcIlxcclxcblwiO1xuZXhwb3J0IGNsYXNzIFdlYnNvY2tldE1lc3NhZ2VGb3JtYXR0ZXIge1xuICAgIHRvQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZSkge1xuICAgICAgICBjb25zdCBkZWZlcnJhbCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0TWVzc2FnZSA9IG1lc3NhZ2UudGV4dENvbnRlbnQ7XG4gICAgICAgICAgICAgICAgbGV0IGhlYWRlcnMgPSB7fTtcbiAgICAgICAgICAgICAgICBsZXQgYm9keSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckJvZHlTcGxpdCA9IHRleHRNZXNzYWdlLnNwbGl0KFwiXFxyXFxuXFxyXFxuXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVyQm9keVNwbGl0ICYmIGhlYWRlckJvZHlTcGxpdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzID0gdGhpcy5wYXJzZUhlYWRlcnMoaGVhZGVyQm9keVNwbGl0WzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWFkZXJCb2R5U3BsaXQubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHkgPSBoZWFkZXJCb2R5U3BsaXRbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVmZXJyYWwucmVzb2x2ZShuZXcgQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZS5tZXNzYWdlVHlwZSwgYm9keSwgaGVhZGVycywgbWVzc2FnZS5pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobWVzc2FnZS5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuQmluYXJ5KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmluYXJ5TWVzc2FnZSA9IG1lc3NhZ2UuYmluYXJ5Q29udGVudDtcbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgICAgIGxldCBib2R5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAoIWJpbmFyeU1lc3NhZ2UgfHwgYmluYXJ5TWVzc2FnZS5ieXRlTGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGJpbmFyeSBtZXNzYWdlIGZvcm1hdC4gSGVhZGVyIGxlbmd0aCBtaXNzaW5nLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YVZpZXcgPSBuZXcgRGF0YVZpZXcoYmluYXJ5TWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyTGVuZ3RoID0gZGF0YVZpZXcuZ2V0SW50MTYoMCk7XG4gICAgICAgICAgICAgICAgaWYgKGJpbmFyeU1lc3NhZ2UuYnl0ZUxlbmd0aCA8IGhlYWRlckxlbmd0aCArIDIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBiaW5hcnkgbWVzc2FnZSBmb3JtYXQuIEhlYWRlciBjb250ZW50IG1pc3NpbmcuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVyc1N0cmluZyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBoZWFkZXJMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzU3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGRhdGFWaWV3KS5nZXRJbnQ4KGkgKyAyKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB0aGlzLnBhcnNlSGVhZGVycyhoZWFkZXJzU3RyaW5nKTtcbiAgICAgICAgICAgICAgICBpZiAoYmluYXJ5TWVzc2FnZS5ieXRlTGVuZ3RoID4gaGVhZGVyTGVuZ3RoICsgMikge1xuICAgICAgICAgICAgICAgICAgICBib2R5ID0gYmluYXJ5TWVzc2FnZS5zbGljZSgyICsgaGVhZGVyTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVmZXJyYWwucmVzb2x2ZShuZXcgQ29ubmVjdGlvbk1lc3NhZ2UobWVzc2FnZS5tZXNzYWdlVHlwZSwgYm9keSwgaGVhZGVycywgbWVzc2FnZS5pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBkZWZlcnJhbC5yZWplY3QoYEVycm9yIGZvcm1hdHRpbmcgdGhlIG1lc3NhZ2UuIEVycm9yOiAke2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlZmVycmFsLnByb21pc2U7XG4gICAgfVxuICAgIGZyb21Db25uZWN0aW9uTWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgIGNvbnN0IGRlZmVycmFsID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAobWVzc2FnZS5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSBgJHt0aGlzLm1ha2VIZWFkZXJzKG1lc3NhZ2UpfSR7Q1JMRn0ke21lc3NhZ2UudGV4dEJvZHkgPyBtZXNzYWdlLnRleHRCb2R5IDogXCJcIn1gO1xuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUobmV3IFJhd1dlYnNvY2tldE1lc3NhZ2UoTWVzc2FnZVR5cGUuVGV4dCwgcGF5bG9hZCwgbWVzc2FnZS5pZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobWVzc2FnZS5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuQmluYXJ5KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyc1N0cmluZyA9IHRoaXMubWFrZUhlYWRlcnMobWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IG1lc3NhZ2UuYmluYXJ5Qm9keTtcbiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJCdWZmZXIgPSB0aGlzLnN0cmluZ1RvQXJyYXlCdWZmZXIoaGVhZGVyc1N0cmluZyk7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVySW50OEFycmF5ID0gbmV3IEludDhBcnJheShoZWFkZXJCdWZmZXIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckxlbmd0aCA9IGhlYWRlckludDhBcnJheS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBheWxvYWRJbnQ4QXJyYXkgPSBuZXcgSW50OEFycmF5KDIgKyBoZWFkZXJMZW5ndGggKyAoY29udGVudCA/IGNvbnRlbnQuYnl0ZUxlbmd0aCA6IDApKTtcbiAgICAgICAgICAgICAgICBwYXlsb2FkSW50OEFycmF5WzBdID0gKChoZWFkZXJMZW5ndGggPj4gOCkgJiAweGZmKTtcbiAgICAgICAgICAgICAgICBwYXlsb2FkSW50OEFycmF5WzFdID0gaGVhZGVyTGVuZ3RoICYgMHhmZjtcbiAgICAgICAgICAgICAgICBwYXlsb2FkSW50OEFycmF5LnNldChoZWFkZXJJbnQ4QXJyYXksIDIpO1xuICAgICAgICAgICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJvZHlJbnQ4QXJyYXkgPSBuZXcgSW50OEFycmF5KGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkSW50OEFycmF5LnNldChib2R5SW50OEFycmF5LCAyICsgaGVhZGVyTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgcGF5bG9hZCA9IHBheWxvYWRJbnQ4QXJyYXkuYnVmZmVyO1xuICAgICAgICAgICAgICAgIGRlZmVycmFsLnJlc29sdmUobmV3IFJhd1dlYnNvY2tldE1lc3NhZ2UoTWVzc2FnZVR5cGUuQmluYXJ5LCBwYXlsb2FkLCBtZXNzYWdlLmlkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGRlZmVycmFsLnJlamVjdChgRXJyb3IgZm9ybWF0dGluZyB0aGUgbWVzc2FnZS4gJHtlfWApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZlcnJhbC5wcm9taXNlO1xuICAgIH1cbiAgICBtYWtlSGVhZGVycyhtZXNzYWdlKSB7XG4gICAgICAgIGxldCBoZWFkZXJzU3RyaW5nID0gXCJcIjtcbiAgICAgICAgaWYgKG1lc3NhZ2UuaGVhZGVycykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXIgaW4gbWVzc2FnZS5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzU3RyaW5nICs9IGAke2hlYWRlcn06ICR7bWVzc2FnZS5oZWFkZXJzW2hlYWRlcl19JHtDUkxGfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZWFkZXJzU3RyaW5nO1xuICAgIH1cbiAgICBwYXJzZUhlYWRlcnMoaGVhZGVyc1N0cmluZykge1xuICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgIGlmIChoZWFkZXJzU3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJNYXRjaGVzID0gaGVhZGVyc1N0cmluZy5tYXRjaCgvW15cXHJcXG5dKy9nKTtcbiAgICAgICAgICAgIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVyTWF0Y2hlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXBhcmF0b3JJbmRleCA9IGhlYWRlci5pbmRleE9mKFwiOlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlck5hbWUgPSBzZXBhcmF0b3JJbmRleCA+IDAgPyBoZWFkZXIuc3Vic3RyKDAsIHNlcGFyYXRvckluZGV4KS50cmltKCkudG9Mb3dlckNhc2UoKSA6IGhlYWRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlclZhbHVlID0gc2VwYXJhdG9ySW5kZXggPiAwICYmIGhlYWRlci5sZW5ndGggPiAoc2VwYXJhdG9ySW5kZXggKyAxKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyLnN1YnN0cihzZXBhcmF0b3JJbmRleCArIDEpLnRyaW0oKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbaGVhZGVyTmFtZV0gPSBoZWFkZXJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGVhZGVycztcbiAgICB9XG4gICAgc3RyaW5nVG9BcnJheUJ1ZmZlcihzdHIpIHtcbiAgICAgICAgY29uc3QgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKHN0ci5sZW5ndGgpO1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGJ1ZmZlcik7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2aWV3LnNldFVpbnQ4KGksIHN0ci5jaGFyQ29kZUF0KGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYnVmZmVyO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9V2Vic29ja2V0TWVzc2FnZUZvcm1hdHRlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IEV2ZW50VHlwZSwgUGxhdGZvcm1FdmVudCB9IGZyb20gXCIuL1BsYXRmb3JtRXZlbnRcIjtcbmV4cG9ydCBjbGFzcyBBdWRpb1NvdXJjZUV2ZW50IGV4dGVuZHMgUGxhdGZvcm1FdmVudCB7XG4gICAgY29uc3RydWN0b3IoZXZlbnROYW1lLCBhdWRpb1NvdXJjZUlkLCBldmVudFR5cGUgPSBFdmVudFR5cGUuSW5mbykge1xuICAgICAgICBzdXBlcihldmVudE5hbWUsIGV2ZW50VHlwZSk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvU291cmNlSWQgPSBhdWRpb1NvdXJjZUlkO1xuICAgIH1cbiAgICBnZXQgYXVkaW9Tb3VyY2VJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvU291cmNlSWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvU291cmNlSW5pdGlhbGl6aW5nRXZlbnQgZXh0ZW5kcyBBdWRpb1NvdXJjZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkKSB7XG4gICAgICAgIHN1cGVyKFwiQXVkaW9Tb3VyY2VJbml0aWFsaXppbmdFdmVudFwiLCBhdWRpb1NvdXJjZUlkKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50IGV4dGVuZHMgQXVkaW9Tb3VyY2VFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCkge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU291cmNlUmVhZHlFdmVudFwiLCBhdWRpb1NvdXJjZUlkKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9Tb3VyY2VPZmZFdmVudCBleHRlbmRzIEF1ZGlvU291cmNlRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvU291cmNlSWQpIHtcbiAgICAgICAgc3VwZXIoXCJBdWRpb1NvdXJjZU9mZkV2ZW50XCIsIGF1ZGlvU291cmNlSWQpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBdWRpb1NvdXJjZUVycm9yRXZlbnQgZXh0ZW5kcyBBdWRpb1NvdXJjZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkLCBlcnJvcikge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU291cmNlRXJyb3JFdmVudFwiLCBhdWRpb1NvdXJjZUlkLCBFdmVudFR5cGUuRXJyb3IpO1xuICAgICAgICB0aGlzLnByaXZFcnJvciA9IGVycm9yO1xuICAgIH1cbiAgICBnZXQgZXJyb3IoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvcjtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9TdHJlYW1Ob2RlRXZlbnQgZXh0ZW5kcyBBdWRpb1NvdXJjZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHN1cGVyKGV2ZW50TmFtZSwgYXVkaW9Tb3VyY2VJZCk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvTm9kZUlkID0gYXVkaW9Ob2RlSWQ7XG4gICAgfVxuICAgIGdldCBhdWRpb05vZGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvTm9kZUlkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCBleHRlbmRzIEF1ZGlvU3RyZWFtTm9kZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCkge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU3RyZWFtTm9kZUF0dGFjaGluZ0V2ZW50XCIsIGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoZWRFdmVudCBleHRlbmRzIEF1ZGlvU3RyZWFtTm9kZUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCkge1xuICAgICAgICBzdXBlcihcIkF1ZGlvU3RyZWFtTm9kZUF0dGFjaGVkRXZlbnRcIiwgYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50IGV4dGVuZHMgQXVkaW9TdHJlYW1Ob2RlRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvU291cmNlSWQsIGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHN1cGVyKFwiQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudFwiLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvU3RyZWFtTm9kZUVycm9yRXZlbnQgZXh0ZW5kcyBBdWRpb1N0cmVhbU5vZGVFdmVudCB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Tb3VyY2VJZCwgYXVkaW9Ob2RlSWQsIGVycm9yKSB7XG4gICAgICAgIHN1cGVyKFwiQXVkaW9TdHJlYW1Ob2RlRXJyb3JFdmVudFwiLCBhdWRpb1NvdXJjZUlkLCBhdWRpb05vZGVJZCk7XG4gICAgICAgIHRoaXMucHJpdkVycm9yID0gZXJyb3I7XG4gICAgfVxuICAgIGdldCBlcnJvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9Tb3VyY2VFdmVudHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEV2ZW50VHlwZSwgUGxhdGZvcm1FdmVudCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBCYWNrZ3JvdW5kRXZlbnQgZXh0ZW5kcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihlcnJvcikge1xuICAgICAgICBzdXBlcihcIkJhY2tncm91bmRFdmVudFwiLCBFdmVudFR5cGUuRXJyb3IpO1xuICAgICAgICB0aGlzLnByaXZFcnJvciA9IGVycm9yO1xuICAgIH1cbiAgICBnZXQgZXJyb3IoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvcjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUJhY2tncm91bmRFcnJvci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU3RyZWFtIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENodW5rZWRBcnJheUJ1ZmZlclN0cmVhbSBleHRlbmRzIFN0cmVhbSB7XG4gICAgY29uc3RydWN0b3IodGFyZ2V0Q2h1bmtTaXplLCBzdHJlYW1JZCkge1xuICAgICAgICBzdXBlcihzdHJlYW1JZCk7XG4gICAgICAgIHRoaXMucHJpdlRhcmdldENodW5rU2l6ZSA9IHRhcmdldENodW5rU2l6ZTtcbiAgICAgICAgdGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMgPSAwO1xuICAgIH1cbiAgICB3cml0ZVN0cmVhbUNodW5rKGNodW5rKSB7XG4gICAgICAgIC8vIE5vIHBlbmRpbmcgd3JpdGUsIGFuZCB0aGUgYnVmZmVyIGlzIHRoZSByaWdodCBzaXplIHNvIHdyaXRlIGl0LlxuICAgICAgICBpZiAoY2h1bmsuaXNFbmQgfHxcbiAgICAgICAgICAgICgwID09PSB0aGlzLnByaXZOZXh0QnVmZmVyUmVhZHlCeXRlcyAmJiBjaHVuay5idWZmZXIuYnl0ZUxlbmd0aCA9PT0gdGhpcy5wcml2VGFyZ2V0Q2h1bmtTaXplKSkge1xuICAgICAgICAgICAgc3VwZXIud3JpdGVTdHJlYW1DaHVuayhjaHVuayk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGJ5dGVzQ29waWVkRnJvbUJ1ZmZlciA9IDA7XG4gICAgICAgIHdoaWxlIChieXRlc0NvcGllZEZyb21CdWZmZXIgPCBjaHVuay5idWZmZXIuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgLy8gRmlsbCB0aGUgbmV4dCBidWZmZXIuXG4gICAgICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0aGlzLnByaXZOZXh0QnVmZmVyVG9Xcml0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdk5leHRCdWZmZXJUb1dyaXRlID0gbmV3IEFycmF5QnVmZmVyKHRoaXMucHJpdlRhcmdldENodW5rU2l6ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TmV4dEJ1ZmZlclN0YXJ0VGltZSA9IGNodW5rLnRpbWVSZWNlaXZlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEZpbmQgb3V0IGhvdyBtYW55IGJ5dGVzIHdlIGNhbiBjb3B5IGludG8gdGhlIHJlYWQgYnVmZmVyLlxuICAgICAgICAgICAgY29uc3QgYnl0ZXNUb0NvcHkgPSBNYXRoLm1pbihjaHVuay5idWZmZXIuYnl0ZUxlbmd0aCAtIGJ5dGVzQ29waWVkRnJvbUJ1ZmZlciwgdGhpcy5wcml2VGFyZ2V0Q2h1bmtTaXplIC0gdGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMpO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0VmlldyA9IG5ldyBVaW50OEFycmF5KHRoaXMucHJpdk5leHRCdWZmZXJUb1dyaXRlKTtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZVZpZXcgPSBuZXcgVWludDhBcnJheShjaHVuay5idWZmZXIuc2xpY2UoYnl0ZXNDb3BpZWRGcm9tQnVmZmVyLCBieXRlc1RvQ29weSArIGJ5dGVzQ29waWVkRnJvbUJ1ZmZlcikpO1xuICAgICAgICAgICAgdGFyZ2V0Vmlldy5zZXQoc291cmNlVmlldywgdGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMpO1xuICAgICAgICAgICAgdGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMgKz0gYnl0ZXNUb0NvcHk7XG4gICAgICAgICAgICBieXRlc0NvcGllZEZyb21CdWZmZXIgKz0gYnl0ZXNUb0NvcHk7XG4gICAgICAgICAgICAvLyBBcmUgd2UgcmVhZHkgdG8gd3JpdGU/XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2TmV4dEJ1ZmZlclJlYWR5Qnl0ZXMgPT09IHRoaXMucHJpdlRhcmdldENodW5rU2l6ZSkge1xuICAgICAgICAgICAgICAgIHN1cGVyLndyaXRlU3RyZWFtQ2h1bmsoe1xuICAgICAgICAgICAgICAgICAgICBidWZmZXI6IHRoaXMucHJpdk5leHRCdWZmZXJUb1dyaXRlLFxuICAgICAgICAgICAgICAgICAgICBpc0VuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogdGhpcy5wcml2TmV4dEJ1ZmZlclN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZOZXh0QnVmZmVyUmVhZHlCeXRlcyA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TmV4dEJ1ZmZlclRvV3JpdGUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIC8vIFNlbmQgd2hhdGV2ZXIgaXMgcGVuZGluZywgdGhlbiBjbG9zZSB0aGUgYmFzZSBjbGFzcy5cbiAgICAgICAgaWYgKDAgIT09IHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzICYmICF0aGlzLmlzQ2xvc2VkKSB7XG4gICAgICAgICAgICBzdXBlci53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgICAgICBidWZmZXI6IHRoaXMucHJpdk5leHRCdWZmZXJUb1dyaXRlLnNsaWNlKDAsIHRoaXMucHJpdk5leHRCdWZmZXJSZWFkeUJ5dGVzKSxcbiAgICAgICAgICAgICAgICBpc0VuZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdGltZVJlY2VpdmVkOiB0aGlzLnByaXZOZXh0QnVmZmVyU3RhcnRUaW1lLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNodW5rZWRBcnJheUJ1ZmZlclN0cmVhbS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgRXZlbnRUeXBlLCBQbGF0Zm9ybUV2ZW50IH0gZnJvbSBcIi4vUGxhdGZvcm1FdmVudFwiO1xuZXhwb3J0IGNsYXNzIFNlcnZpY2VFdmVudCBleHRlbmRzIFBsYXRmb3JtRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwganNvbnN0cmluZywgZXZlbnRUeXBlID0gRXZlbnRUeXBlLkluZm8pIHtcbiAgICAgICAgc3VwZXIoZXZlbnROYW1lLCBldmVudFR5cGUpO1xuICAgICAgICB0aGlzLnByaXZKc29uUmVzdWx0ID0ganNvbnN0cmluZztcbiAgICB9XG4gICAgZ2V0IGpzb25TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZKc29uUmVzdWx0O1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uRXZlbnQgZXh0ZW5kcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIGNvbm5lY3Rpb25JZCwgZXZlbnRUeXBlID0gRXZlbnRUeXBlLkluZm8pIHtcbiAgICAgICAgc3VwZXIoZXZlbnROYW1lLCBldmVudFR5cGUpO1xuICAgICAgICB0aGlzLnByaXZDb25uZWN0aW9uSWQgPSBjb25uZWN0aW9uSWQ7XG4gICAgfVxuICAgIGdldCBjb25uZWN0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uSWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25TdGFydEV2ZW50IGV4dGVuZHMgQ29ubmVjdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25uZWN0aW9uSWQsIHVyaSwgaGVhZGVycykge1xuICAgICAgICBzdXBlcihcIkNvbm5lY3Rpb25TdGFydEV2ZW50XCIsIGNvbm5lY3Rpb25JZCk7XG4gICAgICAgIHRoaXMucHJpdlVyaSA9IHVyaTtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVycyA9IGhlYWRlcnM7XG4gICAgfVxuICAgIGdldCB1cmkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZVcmk7XG4gICAgfVxuICAgIGdldCBoZWFkZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SGVhZGVycztcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgQ29ubmVjdGlvbkVzdGFibGlzaGVkRXZlbnQgZXh0ZW5kcyBDb25uZWN0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGNvbm5lY3Rpb25JZCkge1xuICAgICAgICBzdXBlcihcIkNvbm5lY3Rpb25Fc3RhYmxpc2hlZEV2ZW50XCIsIGNvbm5lY3Rpb25JZCk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25DbG9zZWRFdmVudCBleHRlbmRzIENvbm5lY3Rpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IoY29ubmVjdGlvbklkLCBzdGF0dXNDb2RlLCByZWFzb24pIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uQ2xvc2VkRXZlbnRcIiwgY29ubmVjdGlvbklkLCBFdmVudFR5cGUuRGVidWcpO1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdlN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgIH1cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICBnZXQgc3RhdHVzQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0YXR1c0NvZGU7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25FcnJvckV2ZW50IGV4dGVuZHMgQ29ubmVjdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25uZWN0aW9uSWQsIG1lc3NhZ2UsIHR5cGUpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uRXJyb3JFdmVudFwiLCBjb25uZWN0aW9uSWQsIEV2ZW50VHlwZS5EZWJ1Zyk7XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICB0aGlzLnByaXZUeXBlID0gdHlwZTtcbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXNzYWdlO1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR5cGU7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25Fc3RhYmxpc2hFcnJvckV2ZW50IGV4dGVuZHMgQ29ubmVjdGlvbkV2ZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihjb25uZWN0aW9uSWQsIHN0YXR1c2NvZGUsIHJlYXNvbikge1xuICAgICAgICBzdXBlcihcIkNvbm5lY3Rpb25Fc3RhYmxpc2hFcnJvckV2ZW50XCIsIGNvbm5lY3Rpb25JZCwgRXZlbnRUeXBlLkVycm9yKTtcbiAgICAgICAgdGhpcy5wcml2U3RhdHVzQ29kZSA9IHN0YXR1c2NvZGU7XG4gICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IHJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgZ2V0IHN0YXR1c0NvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTdGF0dXNDb2RlO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uTWVzc2FnZVJlY2VpdmVkRXZlbnQgZXh0ZW5kcyBDb25uZWN0aW9uRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGNvbm5lY3Rpb25JZCwgbmV0d29ya1JlY2VpdmVkVGltZUlTTywgbWVzc2FnZSkge1xuICAgICAgICBzdXBlcihcIkNvbm5lY3Rpb25NZXNzYWdlUmVjZWl2ZWRFdmVudFwiLCBjb25uZWN0aW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZOZXR3b3JrUmVjZWl2ZWRUaW1lID0gbmV0d29ya1JlY2VpdmVkVGltZUlTTztcbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxuICAgIGdldCBuZXR3b3JrUmVjZWl2ZWRUaW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TmV0d29ya1JlY2VpdmVkVGltZTtcbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXNzYWdlO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uTWVzc2FnZVNlbnRFdmVudCBleHRlbmRzIENvbm5lY3Rpb25FdmVudCB7XG4gICAgY29uc3RydWN0b3IoY29ubmVjdGlvbklkLCBuZXR3b3JrU2VudFRpbWVJU08sIG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIoXCJDb25uZWN0aW9uTWVzc2FnZVNlbnRFdmVudFwiLCBjb25uZWN0aW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZOZXR3b3JrU2VudFRpbWUgPSBuZXR3b3JrU2VudFRpbWVJU087XG4gICAgICAgIHRoaXMucHJpdk1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH1cbiAgICBnZXQgbmV0d29ya1NlbnRUaW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TmV0d29ya1NlbnRUaW1lO1xuICAgIH1cbiAgICBnZXQgbWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1lc3NhZ2U7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25uZWN0aW9uRXZlbnRzLmpzLm1hcFxuIiwiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1yZXR1cm4gKi9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgSW52YWxpZE9wZXJhdGlvbkVycm9yIH0gZnJvbSBcIi4vRXJyb3JcIjtcbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQgfSBmcm9tIFwiLi9HdWlkXCI7XG5leHBvcnQgdmFyIE1lc3NhZ2VUeXBlO1xuKGZ1bmN0aW9uIChNZXNzYWdlVHlwZSkge1xuICAgIE1lc3NhZ2VUeXBlW01lc3NhZ2VUeXBlW1wiVGV4dFwiXSA9IDBdID0gXCJUZXh0XCI7XG4gICAgTWVzc2FnZVR5cGVbTWVzc2FnZVR5cGVbXCJCaW5hcnlcIl0gPSAxXSA9IFwiQmluYXJ5XCI7XG59KShNZXNzYWdlVHlwZSB8fCAoTWVzc2FnZVR5cGUgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25NZXNzYWdlIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlVHlwZSwgYm9keSwgaGVhZGVycywgaWQpIHtcbiAgICAgICAgdGhpcy5wcml2Qm9keSA9IG51bGw7XG4gICAgICAgIGlmIChtZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCAmJiBib2R5ICYmICEodHlwZW9mIChib2R5KSA9PT0gXCJzdHJpbmdcIikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJQYXlsb2FkIG11c3QgYmUgYSBzdHJpbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5CaW5hcnkgJiYgYm9keSAmJiAhKGJvZHkgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJQYXlsb2FkIG11c3QgYmUgQXJyYXlCdWZmZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZVR5cGUgPSBtZXNzYWdlVHlwZTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudFxuICAgICAgICB0aGlzLnByaXZCb2R5ID0gYm9keTtcbiAgICAgICAgdGhpcy5wcml2SGVhZGVycyA9IGhlYWRlcnMgPyBoZWFkZXJzIDoge307XG4gICAgICAgIHRoaXMucHJpdklkID0gaWQgPyBpZCA6IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLm1lc3NhZ2VUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIE1lc3NhZ2VUeXBlLkJpbmFyeTpcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTaXplID0gdGhpcy5iaW5hcnlCb2R5ICE9PSBudWxsID8gdGhpcy5iaW5hcnlCb2R5LmJ5dGVMZW5ndGggOiAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBNZXNzYWdlVHlwZS5UZXh0OlxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNpemUgPSB0aGlzLnRleHRCb2R5Lmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbWVzc2FnZVR5cGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNZXNzYWdlVHlwZTtcbiAgICB9XG4gICAgZ2V0IGhlYWRlcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZIZWFkZXJzO1xuICAgIH1cbiAgICBnZXQgYm9keSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkJvZHk7XG4gICAgfVxuICAgIGdldCB0ZXh0Qm9keSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdk1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5CaW5hcnkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJOb3Qgc3VwcG9ydGVkIGZvciBiaW5hcnkgbWVzc2FnZVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2Qm9keTtcbiAgICB9XG4gICAgZ2V0IGJpbmFyeUJvZHkoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZNZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIk5vdCBzdXBwb3J0ZWQgZm9yIHRleHQgbWVzc2FnZVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2Qm9keTtcbiAgICB9XG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25uZWN0aW9uTWVzc2FnZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25PcGVuUmVzcG9uc2Uge1xuICAgIGNvbnN0cnVjdG9yKHN0YXR1c0NvZGUsIHJlYXNvbikge1xuICAgICAgICB0aGlzLnByaXZTdGF0dXNDb2RlID0gc3RhdHVzQ29kZTtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgIH1cbiAgICBnZXQgc3RhdHVzQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0YXR1c0NvZGU7XG4gICAgfVxuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25uZWN0aW9uT3BlblJlc3BvbnNlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIFRoZSBlcnJvciB0aGF0IGlzIHRocm93biB3aGVuIGFuIGFyZ3VtZW50IHBhc3NlZCBpbiBpcyBudWxsLlxuICpcbiAqIEBleHBvcnRcbiAqIEBjbGFzcyBEZWZmZXJhbE1hcFxuICovXG5leHBvcnQgY2xhc3MgRGVmZXJyYWxNYXAge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByaXZNYXAgPSB7fTtcbiAgICB9XG4gICAgYWRkKGlkLCBkZWZlcnJhbCkge1xuICAgICAgICB0aGlzLnByaXZNYXBbaWRdID0gZGVmZXJyYWw7XG4gICAgfVxuICAgIGdldElkKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNYXBbaWRdO1xuICAgIH1cbiAgICBjb21wbGV0ZShpZCwgcmVzdWx0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnByaXZNYXBbaWRdLnJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdk1hcFtpZF0ucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMucHJpdk1hcFtpZF0gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURlZmVycmFsTWFwLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBFdmVudFR5cGUsIFBsYXRmb3JtRXZlbnQgfSBmcm9tIFwiLi9QbGF0Zm9ybUV2ZW50XCI7XG5leHBvcnQgY2xhc3MgRGlhbG9nRXZlbnQgZXh0ZW5kcyBQbGF0Zm9ybUV2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihldmVudE5hbWUsIGV2ZW50VHlwZSA9IEV2ZW50VHlwZS5JbmZvKSB7XG4gICAgICAgIHN1cGVyKGV2ZW50TmFtZSwgZXZlbnRUeXBlKTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgU2VuZGluZ0FnZW50Q29udGV4dE1lc3NhZ2VFdmVudCBleHRlbmRzIERpYWxvZ0V2ZW50IHtcbiAgICBjb25zdHJ1Y3RvcihhZ2VudENvbmZpZykge1xuICAgICAgICBzdXBlcihcIlNlbmRpbmdBZ2VudENvbnRleHRNZXNzYWdlRXZlbnRcIik7XG4gICAgICAgIHRoaXMucHJpdkFnZW50Q29uZmlnID0gYWdlbnRDb25maWc7XG4gICAgfVxuICAgIGdldCBhZ2VudENvbmZpZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFnZW50Q29uZmlnO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RGlhbG9nRXZlbnRzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuLyoqXG4gKiBUaGUgZXJyb3IgdGhhdCBpcyB0aHJvd24gd2hlbiBhbiBhcmd1bWVudCBwYXNzZWQgaW4gaXMgbnVsbC5cbiAqXG4gKiBAZXhwb3J0XG4gKiBAY2xhc3MgQXJndW1lbnROdWxsRXJyb3JcbiAqIEBleHRlbmRzIHtFcnJvcn1cbiAqL1xuZXhwb3J0IGNsYXNzIEFyZ3VtZW50TnVsbEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgQXJndW1lbnROdWxsRXJyb3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXJndW1lbnROYW1lIC0gTmFtZSBvZiB0aGUgYXJndW1lbnQgdGhhdCBpcyBudWxsXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgQXJndW1lbnROdWxsRXJyb3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihhcmd1bWVudE5hbWUpIHtcbiAgICAgICAgc3VwZXIoYXJndW1lbnROYW1lKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJBcmd1bWVudE51bGxcIjtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gYXJndW1lbnROYW1lO1xuICAgIH1cbn1cbi8qKlxuICogVGhlIGVycm9yIHRoYXQgaXMgdGhyb3duIHdoZW4gYW4gaW52YWxpZCBvcGVyYXRpb24gaXMgcGVyZm9ybWVkIGluIHRoZSBjb2RlLlxuICpcbiAqIEBleHBvcnRcbiAqIEBjbGFzcyBJbnZhbGlkT3BlcmF0aW9uRXJyb3JcbiAqIEBleHRlbmRzIHtFcnJvcn1cbiAqL1xuZXhwb3J0IGNsYXNzIEludmFsaWRPcGVyYXRpb25FcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIEludmFsaWRPcGVyYXRpb25FcnJvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvciAtIFRoZSBlcnJvclxuICAgICAqXG4gICAgICogQG1lbWJlck9mIEludmFsaWRPcGVyYXRpb25FcnJvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGVycm9yKSB7XG4gICAgICAgIHN1cGVyKGVycm9yKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJJbnZhbGlkT3BlcmF0aW9uXCI7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IGVycm9yO1xuICAgIH1cbn1cbi8qKlxuICogVGhlIGVycm9yIHRoYXQgaXMgdGhyb3duIHdoZW4gYW4gb2JqZWN0IGlzIGRpc3Bvc2VkLlxuICpcbiAqIEBleHBvcnRcbiAqIEBjbGFzcyBPYmplY3REaXNwb3NlZEVycm9yXG4gKiBAZXh0ZW5kcyB7RXJyb3J9XG4gKi9cbmV4cG9ydCBjbGFzcyBPYmplY3REaXNwb3NlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgT2JqZWN0RGlzcG9zZWRFcnJvci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvYmplY3ROYW1lIC0gVGhlIG9iamVjdCB0aGF0IGlzIGRpc3Bvc2VkXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yIC0gVGhlIGVycm9yXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgT2JqZWN0RGlzcG9zZWRFcnJvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9iamVjdE5hbWUsIGVycm9yKSB7XG4gICAgICAgIHN1cGVyKGVycm9yKTtcbiAgICAgICAgdGhpcy5uYW1lID0gb2JqZWN0TmFtZSArIFwiT2JqZWN0RGlzcG9zZWRcIjtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3I7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FcnJvci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgT2JqZWN0RGlzcG9zZWRFcnJvciB9IGZyb20gXCIuL0Vycm9yXCI7XG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkIH0gZnJvbSBcIi4vR3VpZFwiO1xuZXhwb3J0IGNsYXNzIEV2ZW50U291cmNlIHtcbiAgICBjb25zdHJ1Y3RvcihtZXRhZGF0YSkge1xuICAgICAgICB0aGlzLnByaXZFdmVudExpc3RlbmVycyA9IHt9O1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkNvbnNvbGVMaXN0ZW5lciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2TWV0YWRhdGEgPSBtZXRhZGF0YTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKCkpIHtcbiAgICAgICAgICAgIHRocm93IChuZXcgT2JqZWN0RGlzcG9zZWRFcnJvcihcIkV2ZW50U291cmNlXCIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZXRhZGF0YSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJhbU5hbWUgaW4gdGhpcy5tZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWV2ZW50Lm1ldGFkYXRhW3BhcmFtTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5tZXRhZGF0YVtwYXJhbU5hbWVdID0gdGhpcy5tZXRhZGF0YVtwYXJhbU5hbWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgZXZlbnRJZCBpbiB0aGlzLnByaXZFdmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgaWYgKGV2ZW50SWQgJiYgdGhpcy5wcml2RXZlbnRMaXN0ZW5lcnNbZXZlbnRJZF0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZFdmVudExpc3RlbmVyc1tldmVudElkXShldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXR0YWNoKG9uRXZlbnRDYWxsYmFjaykge1xuICAgICAgICBjb25zdCBpZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRMaXN0ZW5lcnNbaWRdID0gb25FdmVudENhbGxiYWNrO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdkV2ZW50TGlzdGVuZXJzW2lkXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgIH1cbiAgICBhdHRhY2hMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRhY2goKGUpID0+IGxpc3RlbmVyLm9uRXZlbnQoZSkpO1xuICAgIH1cbiAgICBhdHRhY2hDb25zb2xlTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29uc29sZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICB2b2lkIHRoaXMucHJpdkNvbnNvbGVMaXN0ZW5lci5kZXRhY2goKTsgLy8gRGV0YWNoIGltcGxlbWVudGF0aW9uIGZvciBldmVudExpc3RlbmVycyBpcyBzeW5jaHJvbm91c1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkNvbnNvbGVMaXN0ZW5lciA9IHRoaXMuYXR0YWNoKChlKSA9PiBsaXN0ZW5lci5vbkV2ZW50KGUpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbnNvbGVMaXN0ZW5lcjtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGRpc3Bvc2UoKSB7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50TGlzdGVuZXJzID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IHRydWU7XG4gICAgfVxuICAgIGdldCBtZXRhZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk1ldGFkYXRhO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXZlbnRTb3VyY2UuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEFyZ3VtZW50TnVsbEVycm9yIH0gZnJvbSBcIi4vRXJyb3JcIjtcbmltcG9ydCB7IEV2ZW50U291cmNlIH0gZnJvbSBcIi4vRXZlbnRTb3VyY2VcIjtcbmV4cG9ydCBjbGFzcyBFdmVudHMge1xuICAgIHN0YXRpYyBzZXRFdmVudFNvdXJjZShldmVudFNvdXJjZSkge1xuICAgICAgICBpZiAoIWV2ZW50U291cmNlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnROdWxsRXJyb3IoXCJldmVudFNvdXJjZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBFdmVudHMucHJpdkluc3RhbmNlID0gZXZlbnRTb3VyY2U7XG4gICAgfVxuICAgIHN0YXRpYyBnZXQgaW5zdGFuY2UoKSB7XG4gICAgICAgIHJldHVybiBFdmVudHMucHJpdkluc3RhbmNlO1xuICAgIH1cbn1cbkV2ZW50cy5wcml2SW5zdGFuY2UgPSBuZXcgRXZlbnRTb3VyY2UoKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9RXZlbnRzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyB2NCBhcyB1dWlkIH0gZnJvbSBcInV1aWRcIjtcbmNvbnN0IGNyZWF0ZUd1aWQgPSAoKSA9PiB1dWlkKCk7XG5jb25zdCBjcmVhdGVOb0Rhc2hHdWlkID0gKCkgPT4gY3JlYXRlR3VpZCgpLnJlcGxhY2UobmV3IFJlZ0V4cChcIi1cIiwgXCJnXCIpLCBcIlwiKS50b1VwcGVyQ2FzZSgpO1xuZXhwb3J0IHsgY3JlYXRlR3VpZCwgY3JlYXRlTm9EYXNoR3VpZCB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1HdWlkLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgdmFyIENvbm5lY3Rpb25TdGF0ZTtcbihmdW5jdGlvbiAoQ29ubmVjdGlvblN0YXRlKSB7XG4gICAgQ29ubmVjdGlvblN0YXRlW0Nvbm5lY3Rpb25TdGF0ZVtcIk5vbmVcIl0gPSAwXSA9IFwiTm9uZVwiO1xuICAgIENvbm5lY3Rpb25TdGF0ZVtDb25uZWN0aW9uU3RhdGVbXCJDb25uZWN0ZWRcIl0gPSAxXSA9IFwiQ29ubmVjdGVkXCI7XG4gICAgQ29ubmVjdGlvblN0YXRlW0Nvbm5lY3Rpb25TdGF0ZVtcIkNvbm5lY3RpbmdcIl0gPSAyXSA9IFwiQ29ubmVjdGluZ1wiO1xuICAgIENvbm5lY3Rpb25TdGF0ZVtDb25uZWN0aW9uU3RhdGVbXCJEaXNjb25uZWN0ZWRcIl0gPSAzXSA9IFwiRGlzY29ubmVjdGVkXCI7XG59KShDb25uZWN0aW9uU3RhdGUgfHwgKENvbm5lY3Rpb25TdGF0ZSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUlDb25uZWN0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBPYmplY3REaXNwb3NlZEVycm9yIH0gZnJvbSBcIi4vRXJyb3JcIjtcbmV4cG9ydCBjbGFzcyBMaXN0IHtcbiAgICBjb25zdHJ1Y3RvcihsaXN0KSB7XG4gICAgICAgIHRoaXMucHJpdlN1YnNjcmlwdGlvbklkQ291bnRlciA9IDA7XG4gICAgICAgIHRoaXMucHJpdkFkZFN1YnNjcmlwdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2UmVtb3ZlU3Vic2NyaXB0aW9ucyA9IHt9O1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFN1YnNjcmlwdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2RGlzcG9zZVJlYXNvbiA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdkxpc3QgPSBbXTtcbiAgICAgICAgLy8gY29weSB0aGUgbGlzdCByYXRoZXIgdGhhbiB0YWtpbmcgYXMgaXMuXG4gICAgICAgIGlmIChsaXN0KSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQoaXRlbUluZGV4KSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMaXN0W2l0ZW1JbmRleF07XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQoMCk7XG4gICAgfVxuICAgIGxhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldCh0aGlzLmxlbmd0aCgpIC0gMSk7XG4gICAgfVxuICAgIGFkZChpdGVtKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHRoaXMuaW5zZXJ0QXQodGhpcy5wcml2TGlzdC5sZW5ndGgsIGl0ZW0pO1xuICAgIH1cbiAgICBpbnNlcnRBdChpbmRleCwgaXRlbSkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3QudW5zaGlmdChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpbmRleCA9PT0gdGhpcy5wcml2TGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkxpc3Quc3BsaWNlKGluZGV4LCAwLCBpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRyaWdnZXJTdWJzY3JpcHRpb25zKHRoaXMucHJpdkFkZFN1YnNjcmlwdGlvbnMpO1xuICAgIH1cbiAgICByZW1vdmVGaXJzdCgpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlQXQoMCk7XG4gICAgfVxuICAgIHJlbW92ZUxhc3QoKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZUF0KHRoaXMubGVuZ3RoKCkgLSAxKTtcbiAgICB9XG4gICAgcmVtb3ZlQXQoaW5kZXgpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlKGluZGV4LCAxKVswXTtcbiAgICB9XG4gICAgcmVtb3ZlKGluZGV4LCBjb3VudCkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBjb25zdCByZW1vdmVkRWxlbWVudHMgPSB0aGlzLnByaXZMaXN0LnNwbGljZShpbmRleCwgY291bnQpO1xuICAgICAgICB0aGlzLnRyaWdnZXJTdWJzY3JpcHRpb25zKHRoaXMucHJpdlJlbW92ZVN1YnNjcmlwdGlvbnMpO1xuICAgICAgICByZXR1cm4gcmVtb3ZlZEVsZW1lbnRzO1xuICAgIH1cbiAgICBjbGVhcigpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgdGhpcy5yZW1vdmUoMCwgdGhpcy5sZW5ndGgoKSk7XG4gICAgfVxuICAgIGxlbmd0aCgpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxpc3QubGVuZ3RoO1xuICAgIH1cbiAgICBvbkFkZGVkKGFkZGVkQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uSWQgPSB0aGlzLnByaXZTdWJzY3JpcHRpb25JZENvdW50ZXIrKztcbiAgICAgICAgdGhpcy5wcml2QWRkU3Vic2NyaXB0aW9uc1tzdWJzY3JpcHRpb25JZF0gPSBhZGRlZENhbGxiYWNrO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdkFkZFN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgfVxuICAgIG9uUmVtb3ZlZChyZW1vdmVkQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uSWQgPSB0aGlzLnByaXZTdWJzY3JpcHRpb25JZENvdW50ZXIrKztcbiAgICAgICAgdGhpcy5wcml2UmVtb3ZlU3Vic2NyaXB0aW9uc1tzdWJzY3JpcHRpb25JZF0gPSByZW1vdmVkQ2FsbGJhY2s7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkZXRhY2g6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5wcml2UmVtb3ZlU3Vic2NyaXB0aW9uc1tzdWJzY3JpcHRpb25JZF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgb25EaXNwb3NlZChkaXNwb3NlZENhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbklkID0gdGhpcy5wcml2U3Vic2NyaXB0aW9uSWRDb3VudGVyKys7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkU3Vic2NyaXB0aW9uc1tzdWJzY3JpcHRpb25JZF0gPSBkaXNwb3NlZENhbGxiYWNrO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGV0YWNoOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucHJpdkRpc3Bvc2VkU3Vic2NyaXB0aW9uc1tzdWJzY3JpcHRpb25JZF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgam9pbihzZXBlcmF0b3IpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxpc3Quam9pbihzZXBlcmF0b3IpO1xuICAgIH1cbiAgICB0b0FycmF5KCkge1xuICAgICAgICBjb25zdCBjbG9uZUNvcHkgPSBBcnJheSgpO1xuICAgICAgICB0aGlzLnByaXZMaXN0LmZvckVhY2goKHZhbCkgPT4ge1xuICAgICAgICAgICAgY2xvbmVDb3B5LnB1c2godmFsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjbG9uZUNvcHk7XG4gICAgfVxuICAgIGFueShjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndoZXJlKGNhbGxiYWNrKS5sZW5ndGgoKSA+IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sZW5ndGgoKSA+IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWxsKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiB0aGlzLndoZXJlKGNhbGxiYWNrKS5sZW5ndGgoKSA9PT0gdGhpcy5sZW5ndGgoKTtcbiAgICB9XG4gICAgZm9yRWFjaChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGVuZ3RoKCk7IGkrKykge1xuICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5wcml2TGlzdFtpXSwgaSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0KGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdExpc3QgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByaXZMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzZWxlY3RMaXN0LnB1c2goY2FsbGJhY2sodGhpcy5wcml2TGlzdFtpXSwgaSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgTGlzdChzZWxlY3RMaXN0KTtcbiAgICB9XG4gICAgd2hlcmUoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgY29uc3QgZmlsdGVyZWRMaXN0ID0gbmV3IExpc3QoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByaXZMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2sodGhpcy5wcml2TGlzdFtpXSwgaSkpIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJlZExpc3QuYWRkKHRoaXMucHJpdkxpc3RbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWx0ZXJlZExpc3Q7XG4gICAgfVxuICAgIG9yZGVyQnkoY29tcGFyZUZuKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIGNvbnN0IGNsb25lZEFycmF5ID0gdGhpcy50b0FycmF5KCk7XG4gICAgICAgIGNvbnN0IG9yZGVyZWRBcnJheSA9IGNsb25lZEFycmF5LnNvcnQoY29tcGFyZUZuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBMaXN0KG9yZGVyZWRBcnJheSk7XG4gICAgfVxuICAgIG9yZGVyQnlEZXNjKGNvbXBhcmVGbikge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlZCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5vcmRlckJ5KChhLCBiKSA9PiBjb21wYXJlRm4oYiwgYSkpO1xuICAgIH1cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBMaXN0KHRoaXMudG9BcnJheSgpKTtcbiAgICB9XG4gICAgY29uY2F0KGxpc3QpIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZWQoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBMaXN0KHRoaXMucHJpdkxpc3QuY29uY2F0KGxpc3QudG9BcnJheSgpKSk7XG4gICAgfVxuICAgIGNvbmNhdEFycmF5KGFycmF5KSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkRpc3Bvc2VkKCk7XG4gICAgICAgIHJldHVybiBuZXcgTGlzdCh0aGlzLnByaXZMaXN0LmNvbmNhdChhcnJheSkpO1xuICAgIH1cbiAgICBpc0Rpc3Bvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGlzdCA9PSBudWxsO1xuICAgIH1cbiAgICBkaXNwb3NlKHJlYXNvbikge1xuICAgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCgpKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlUmVhc29uID0gcmVhc29uO1xuICAgICAgICAgICAgdGhpcy5wcml2TGlzdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnByaXZBZGRTdWJzY3JpcHRpb25zID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlbW92ZVN1YnNjcmlwdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyU3Vic2NyaXB0aW9ucyh0aGlzLnByaXZEaXNwb3NlZFN1YnNjcmlwdGlvbnMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93SWZEaXNwb3NlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgT2JqZWN0RGlzcG9zZWRFcnJvcihcIkxpc3RcIiwgdGhpcy5wcml2RGlzcG9zZVJlYXNvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdHJpZ2dlclN1YnNjcmlwdGlvbnMoc3Vic2NyaXB0aW9ucykge1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpcHRpb25JZCBpbiBzdWJzY3JpcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbnNbc3Vic2NyaXB0aW9uSWRdKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1MaXN0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBjcmVhdGVOb0Rhc2hHdWlkIH0gZnJvbSBcIi4vR3VpZFwiO1xuZXhwb3J0IHZhciBFdmVudFR5cGU7XG4oZnVuY3Rpb24gKEV2ZW50VHlwZSkge1xuICAgIEV2ZW50VHlwZVtFdmVudFR5cGVbXCJEZWJ1Z1wiXSA9IDBdID0gXCJEZWJ1Z1wiO1xuICAgIEV2ZW50VHlwZVtFdmVudFR5cGVbXCJJbmZvXCJdID0gMV0gPSBcIkluZm9cIjtcbiAgICBFdmVudFR5cGVbRXZlbnRUeXBlW1wiV2FybmluZ1wiXSA9IDJdID0gXCJXYXJuaW5nXCI7XG4gICAgRXZlbnRUeXBlW0V2ZW50VHlwZVtcIkVycm9yXCJdID0gM10gPSBcIkVycm9yXCI7XG4gICAgRXZlbnRUeXBlW0V2ZW50VHlwZVtcIk5vbmVcIl0gPSA0XSA9IFwiTm9uZVwiO1xufSkoRXZlbnRUeXBlIHx8IChFdmVudFR5cGUgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIFBsYXRmb3JtRXZlbnQge1xuICAgIGNvbnN0cnVjdG9yKGV2ZW50TmFtZSwgZXZlbnRUeXBlKSB7XG4gICAgICAgIHRoaXMucHJpdk5hbWUgPSBldmVudE5hbWU7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50VGltZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5wcml2RXZlbnRUeXBlID0gZXZlbnRUeXBlO1xuICAgICAgICB0aGlzLnByaXZNZXRhZGF0YSA9IHt9O1xuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk5hbWU7XG4gICAgfVxuICAgIGdldCBldmVudElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXZlbnRJZDtcbiAgICB9XG4gICAgZ2V0IGV2ZW50VGltZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkV2ZW50VGltZTtcbiAgICB9XG4gICAgZ2V0IGV2ZW50VHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkV2ZW50VHlwZTtcbiAgICB9XG4gICAgZ2V0IG1ldGFkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWV0YWRhdGE7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1QbGF0Zm9ybUV2ZW50LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSwgQHR5cGVzY3JpcHQtZXNsaW50L3R5cGVkZWYgKi9cbmV4cG9ydCB2YXIgUHJvbWlzZVN0YXRlO1xuKGZ1bmN0aW9uIChQcm9taXNlU3RhdGUpIHtcbiAgICBQcm9taXNlU3RhdGVbUHJvbWlzZVN0YXRlW1wiTm9uZVwiXSA9IDBdID0gXCJOb25lXCI7XG4gICAgUHJvbWlzZVN0YXRlW1Byb21pc2VTdGF0ZVtcIlJlc29sdmVkXCJdID0gMV0gPSBcIlJlc29sdmVkXCI7XG4gICAgUHJvbWlzZVN0YXRlW1Byb21pc2VTdGF0ZVtcIlJlamVjdGVkXCJdID0gMl0gPSBcIlJlamVjdGVkXCI7XG59KShQcm9taXNlU3RhdGUgfHwgKFByb21pc2VTdGF0ZSA9IHt9KSk7XG5leHBvcnQgY2xhc3MgUHJvbWlzZVJlc3VsdCB7XG4gICAgY29uc3RydWN0b3IocHJvbWlzZVJlc3VsdEV2ZW50U291cmNlKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkVycm9yID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IHRoaXMuZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHByb21pc2VSZXN1bHRFdmVudFNvdXJjZS5vbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzQ29tcGxldGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNDb21wbGV0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc0NvbXBsZXRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzQ29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IGlzQ29tcGxldGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNDb21wbGV0ZWQ7XG4gICAgfVxuICAgIGdldCBpc0Vycm9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNFcnJvcjtcbiAgICB9XG4gICAgZ2V0IGVycm9yKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3I7XG4gICAgfVxuICAgIGdldCByZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN1bHQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFByb21pc2VSZXN1bHRFdmVudFNvdXJjZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc2V0UmVzdWx0ID0gKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2T25TZXRSZXN1bHQocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXRFcnJvciA9IChlcnJvcikgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2T25TZXRFcnJvcihlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub24gPSAob25TZXRSZXN1bHQsIG9uU2V0RXJyb3IpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdk9uU2V0UmVzdWx0ID0gb25TZXRSZXN1bHQ7XG4gICAgICAgICAgICB0aGlzLnByaXZPblNldEVycm9yID0gb25TZXRFcnJvcjtcbiAgICAgICAgfTtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgRGVmZXJyZWQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnJlc29sdmUgPSAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZSZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZWplY3QgPSAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlamVjdChlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1mdW5jdGlvbi1yZXR1cm4tdHlwZVxuICAgICAgICB0aGlzLnByaXZQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2UmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgcHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb21pc2U7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFNpbmsge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByaXZTdGF0ZSA9IFByb21pc2VTdGF0ZS5Ob25lO1xuICAgICAgICB0aGlzLnByaXZQcm9taXNlUmVzdWx0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcml2UHJvbWlzZVJlc3VsdEV2ZW50cyA9IG51bGw7XG4gICAgICAgIHRoaXMucHJpdlN1Y2Nlc3NIYW5kbGVycyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZFcnJvckhhbmRsZXJzID0gW107XG4gICAgICAgIHRoaXMucHJpdlByb21pc2VSZXN1bHRFdmVudHMgPSBuZXcgUHJvbWlzZVJlc3VsdEV2ZW50U291cmNlKCk7XG4gICAgICAgIHRoaXMucHJpdlByb21pc2VSZXN1bHQgPSBuZXcgUHJvbWlzZVJlc3VsdCh0aGlzLnByaXZQcm9taXNlUmVzdWx0RXZlbnRzKTtcbiAgICB9XG4gICAgZ2V0IHN0YXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3RhdGU7XG4gICAgfVxuICAgIGdldCByZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9taXNlUmVzdWx0O1xuICAgIH1cbiAgICByZXNvbHZlKHJlc3VsdCkge1xuICAgICAgICBpZiAodGhpcy5wcml2U3RhdGUgIT09IFByb21pc2VTdGF0ZS5Ob25lKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCInQ2Fubm90IHJlc29sdmUgYSBjb21wbGV0ZWQgcHJvbWlzZSdcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2U3RhdGUgPSBQcm9taXNlU3RhdGUuUmVzb2x2ZWQ7XG4gICAgICAgIHRoaXMucHJpdlByb21pc2VSZXN1bHRFdmVudHMuc2V0UmVzdWx0KHJlc3VsdCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wcml2U3VjY2Vzc0hhbmRsZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLmV4ZWN1dGVTdWNjZXNzQ2FsbGJhY2socmVzdWx0LCB0aGlzLnByaXZTdWNjZXNzSGFuZGxlcnNbaV0sIHRoaXMucHJpdkVycm9ySGFuZGxlcnNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGV0YWNoSGFuZGxlcnMoKTtcbiAgICB9XG4gICAgcmVqZWN0KGVycm9yKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZTdGF0ZSAhPT0gUHJvbWlzZVN0YXRlLk5vbmUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIidDYW5ub3QgcmVqZWN0IGEgY29tcGxldGVkIHByb21pc2UnXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlN0YXRlID0gUHJvbWlzZVN0YXRlLlJlamVjdGVkO1xuICAgICAgICB0aGlzLnByaXZQcm9taXNlUmVzdWx0RXZlbnRzLnNldEVycm9yKGVycm9yKTtcbiAgICAgICAgZm9yIChjb25zdCBlcnJvckhhbmRsZXIgb2YgdGhpcy5wcml2RXJyb3JIYW5kbGVycykge1xuICAgICAgICAgICAgdGhpcy5leGVjdXRlRXJyb3JDYWxsYmFjayhlcnJvciwgZXJyb3JIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRldGFjaEhhbmRsZXJzKCk7XG4gICAgfVxuICAgIG9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgICBpZiAoc3VjY2Vzc0NhbGxiYWNrID09IG51bGwpIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgICAgIHN1Y2Nlc3NDYWxsYmFjayA9ICgpID0+IHsgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcml2U3RhdGUgPT09IFByb21pc2VTdGF0ZS5Ob25lKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTdWNjZXNzSGFuZGxlcnMucHVzaChzdWNjZXNzQ2FsbGJhY2spO1xuICAgICAgICAgICAgdGhpcy5wcml2RXJyb3JIYW5kbGVycy5wdXNoKGVycm9yQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdlN0YXRlID09PSBQcm9taXNlU3RhdGUuUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGVTdWNjZXNzQ2FsbGJhY2sodGhpcy5wcml2UHJvbWlzZVJlc3VsdC5yZXN1bHQsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnByaXZTdGF0ZSA9PT0gUHJvbWlzZVN0YXRlLlJlamVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlRXJyb3JDYWxsYmFjayh0aGlzLnByaXZQcm9taXNlUmVzdWx0LmVycm9yLCBlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZGV0YWNoSGFuZGxlcnMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleGVjdXRlU3VjY2Vzc0NhbGxiYWNrKHJlc3VsdCwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5leGVjdXRlRXJyb3JDYWxsYmFjayhgJ1VuaGFuZGxlZCBjYWxsYmFjayBlcnJvcjogJHtlfSdgLCBlcnJvckNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleGVjdXRlRXJyb3JDYWxsYmFjayhlcnJvciwgZXJyb3JDYWxsYmFjaykge1xuICAgICAgICBpZiAoZXJyb3JDYWxsYmFjaykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBlcnJvckNhbGxiYWNrKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnVW5oYW5kbGVkIGNhbGxiYWNrIGVycm9yOiAke2V9LiBJbm5lckVycm9yOiAke2Vycm9yfSdgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJ1VuaGFuZGxlZCBlcnJvcjogJHtlcnJvcn0nYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGV0YWNoSGFuZGxlcnMoKSB7XG4gICAgICAgIHRoaXMucHJpdkVycm9ySGFuZGxlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2U3VjY2Vzc0hhbmRsZXJzID0gW107XG4gICAgfVxufVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1hcnJvdy9wcmVmZXItYXJyb3ctZnVuY3Rpb25zXG5leHBvcnQgZnVuY3Rpb24gbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyhwcm9taXNlLCBjYiwgZXJyKSB7XG4gICAgcHJvbWlzZS50aGVuKCh2YWwpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgY2IodmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlZEVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikgeyB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgZXJyKHR5cGVkRXJyb3IubmFtZSArIFwiOiBcIiArIHR5cGVkRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikgeyB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvbWlzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IsIE9iamVjdERpc3Bvc2VkRXJyb3IgfSBmcm9tIFwiLi9FcnJvclwiO1xuaW1wb3J0IHsgTGlzdCB9IGZyb20gXCIuL0xpc3RcIjtcbmltcG9ydCB7IERlZmVycmVkLCB9IGZyb20gXCIuL1Byb21pc2VcIjtcbnZhciBTdWJzY3JpYmVyVHlwZTtcbihmdW5jdGlvbiAoU3Vic2NyaWJlclR5cGUpIHtcbiAgICBTdWJzY3JpYmVyVHlwZVtTdWJzY3JpYmVyVHlwZVtcIkRlcXVldWVcIl0gPSAwXSA9IFwiRGVxdWV1ZVwiO1xuICAgIFN1YnNjcmliZXJUeXBlW1N1YnNjcmliZXJUeXBlW1wiUGVla1wiXSA9IDFdID0gXCJQZWVrXCI7XG59KShTdWJzY3JpYmVyVHlwZSB8fCAoU3Vic2NyaWJlclR5cGUgPSB7fSkpO1xuZXhwb3J0IGNsYXNzIFF1ZXVlIHtcbiAgICBjb25zdHJ1Y3RvcihsaXN0KSB7XG4gICAgICAgIHRoaXMucHJpdlByb21pc2VTdG9yZSA9IG5ldyBMaXN0KCk7XG4gICAgICAgIHRoaXMucHJpdklzRHJhaW5JblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzRGlzcG9zaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VSZWFzb24gPSBudWxsO1xuICAgICAgICB0aGlzLnByaXZMaXN0ID0gbGlzdCA/IGxpc3QgOiBuZXcgTGlzdCgpO1xuICAgICAgICB0aGlzLnByaXZEZXRhY2hhYmxlcyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycyA9IG5ldyBMaXN0KCk7XG4gICAgICAgIHRoaXMucHJpdkRldGFjaGFibGVzLnB1c2godGhpcy5wcml2TGlzdC5vbkFkZGVkKCgpID0+IHRoaXMuZHJhaW4oKSkpO1xuICAgIH1cbiAgICBlbnF1ZXVlKGl0ZW0pIHtcbiAgICAgICAgdGhpcy50aHJvd0lmRGlzcG9zZSgpO1xuICAgICAgICB0aGlzLmVucXVldWVGcm9tUHJvbWlzZShuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gcmVzb2x2ZShpdGVtKSkpO1xuICAgIH1cbiAgICBlbnF1ZXVlRnJvbVByb21pc2UocHJvbWlzZSkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlKCk7XG4gICAgICAgIHByb21pc2UudGhlbigodmFsKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByaXZMaXN0LmFkZCh2YWwpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgICAgICB9LCAoKSA9PiB7IH0pO1xuICAgIH1cbiAgICBkZXF1ZXVlKCkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlKCk7XG4gICAgICAgIGNvbnN0IGRlZmVycmVkU3Vic2NyaWJlciA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBpZiAodGhpcy5wcml2U3Vic2NyaWJlcnMpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlN1YnNjcmliZXJzLmFkZCh7IGRlZmVycmFsOiBkZWZlcnJlZFN1YnNjcmliZXIsIHR5cGU6IFN1YnNjcmliZXJUeXBlLkRlcXVldWUgfSk7XG4gICAgICAgICAgICB0aGlzLmRyYWluKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlZmVycmVkU3Vic2NyaWJlci5wcm9taXNlO1xuICAgIH1cbiAgICBwZWVrKCkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlKCk7XG4gICAgICAgIGNvbnN0IGRlZmVycmVkU3Vic2NyaWJlciA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICBjb25zdCBzdWJzID0gdGhpcy5wcml2U3Vic2NyaWJlcnM7XG4gICAgICAgIGlmIChzdWJzKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycy5hZGQoeyBkZWZlcnJhbDogZGVmZXJyZWRTdWJzY3JpYmVyLCB0eXBlOiBTdWJzY3JpYmVyVHlwZS5QZWVrIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmFpbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZlcnJlZFN1YnNjcmliZXIucHJvbWlzZTtcbiAgICB9XG4gICAgbGVuZ3RoKCkge1xuICAgICAgICB0aGlzLnRocm93SWZEaXNwb3NlKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMaXN0Lmxlbmd0aCgpO1xuICAgIH1cbiAgICBpc0Rpc3Bvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3Vic2NyaWJlcnMgPT0gbnVsbDtcbiAgICB9XG4gICAgZHJhaW5BbmREaXNwb3NlKHBlbmRpbmdJdGVtUHJvY2Vzc29yLCByZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKCkgJiYgIXRoaXMucHJpdklzRGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZVJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2luZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3VicyA9IHRoaXMucHJpdlN1YnNjcmliZXJzO1xuICAgICAgICAgICAgICAgIGlmIChzdWJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChzdWJzLmxlbmd0aCgpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaWJlciA9IHN1YnMucmVtb3ZlRmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHRoaXMgbmVlZHMgd29yayAoUmVzb2x2ZShudWxsKSBpbnN0ZWFkPykuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmRlZmVycmFsLnJlc29sdmUodW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN1YnNjcmliZXIuZGVmZXJyYWwucmVqZWN0KFwiRGlzcG9zZWRcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gbm90ZTogdGhpcyBibG9jayBhc3N1bWVzIGNvb3BlcmF0aXZlIG11bHRpdGFza2luZywgaS5lLixcbiAgICAgICAgICAgICAgICAgICAgLy8gYmV0d2VlbiB0aGUgaWYtc3RhdGVtZW50IGFuZCB0aGUgYXNzaWdubWVudCB0aGVyZSBhcmUgbm9cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhyZWFkIHN3aXRjaGVzLlxuICAgICAgICAgICAgICAgICAgICAvLyBSZWFzb24gaXMgdGhhdCBiZXR3ZWVuIHRoZSBpbml0aWFsIGNvbnN0ID0gdGhpcy47IGFuZCB0aGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIHBvaW50IHRoZXJlIGlzIHRoZSBkZXJyYWwucmVzb2x2ZSgpIG9wZXJhdGlvbiB0aGF0IG1pZ2h0IGhhdmVcbiAgICAgICAgICAgICAgICAgICAgLy8gY2F1c2VkIHJlY3Vyc2l2ZSBjYWxscyB0byB0aGUgUXVldWUsIGVzcGVjaWFsbHksIGNhbGxpbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gRGlzcG9zZSgpIG9uIHRoZSBxdWV1ZSBhbHJlZHkgKHdoaWNoIHdvdWxkIHJlc2V0IHRoZSB2YXJcbiAgICAgICAgICAgICAgICAgICAgLy8gaGVyZSB0byBudWxsISkuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoYXQgc2hvdWxkIGdlbmVyYWxseSBob2xkIHRydWUgZm9yIGphdmFzY3JpcHQuLi5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdlN1YnNjcmliZXJzID09PSBzdWJzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycyA9IHN1YnM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkZXRhY2hhYmxlIG9mIHRoaXMucHJpdkRldGFjaGFibGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGRldGFjaGFibGUuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZQcm9taXNlU3RvcmUubGVuZ3RoKCkgPiAwICYmIHBlbmRpbmdJdGVtUHJvY2Vzc29yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb21pc2VBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZQcm9taXNlU3RvcmUudG9BcnJheSgpLmZvckVhY2goKHdyYXBwZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2VBcnJheS5wdXNoKHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VBcnJheSkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZMaXN0LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nSXRlbVByb2Nlc3NvcihpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGlzdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlN1YnNjcmliZXJzID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGlzdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGlzcG9zZShyZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuZHJhaW5BbmREaXNwb3NlKG51bGwsIHJlYXNvbik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkcmFpbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZJc0RyYWluSW5Qcm9ncmVzcyAmJiAhdGhpcy5wcml2SXNEaXNwb3NpbmcpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdklzRHJhaW5JblByb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHN1YnMgPSB0aGlzLnByaXZTdWJzY3JpYmVycztcbiAgICAgICAgICAgIGNvbnN0IGxpc3RzID0gdGhpcy5wcml2TGlzdDtcbiAgICAgICAgICAgIGlmIChzdWJzICYmIGxpc3RzKSB7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGxpc3RzLmxlbmd0aCgpID4gMCAmJiBzdWJzLmxlbmd0aCgpID4gMCAmJiAhdGhpcy5wcml2SXNEaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Vic2NyaWJlciA9IHN1YnMucmVtb3ZlRmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmliZXIudHlwZSA9PT0gU3Vic2NyaWJlclR5cGUuUGVlaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5kZWZlcnJhbC5yZXNvbHZlKGxpc3RzLmZpcnN0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVxdWV1ZWRJdGVtID0gbGlzdHMucmVtb3ZlRmlyc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuZGVmZXJyYWwucmVzb2x2ZShkZXF1ZXVlZEl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIG5vdGU6IHRoaXMgYmxvY2sgYXNzdW1lcyBjb29wZXJhdGl2ZSBtdWx0aXRhc2tpbmcsIGkuZS4sXG4gICAgICAgICAgICAgICAgLy8gYmV0d2VlbiB0aGUgaWYtc3RhdGVtZW50IGFuZCB0aGUgYXNzaWdubWVudCB0aGVyZSBhcmUgbm9cbiAgICAgICAgICAgICAgICAvLyB0aHJlYWQgc3dpdGNoZXMuXG4gICAgICAgICAgICAgICAgLy8gUmVhc29uIGlzIHRoYXQgYmV0d2VlbiB0aGUgaW5pdGlhbCBjb25zdCA9IHRoaXMuOyBhbmQgdGhpc1xuICAgICAgICAgICAgICAgIC8vIHBvaW50IHRoZXJlIGlzIHRoZSBkZXJyYWwucmVzb2x2ZSgpIG9wZXJhdGlvbiB0aGF0IG1pZ2h0IGhhdmVcbiAgICAgICAgICAgICAgICAvLyBjYXVzZWQgcmVjdXJzaXZlIGNhbGxzIHRvIHRoZSBRdWV1ZSwgZXNwZWNpYWxseSwgY2FsbGluZ1xuICAgICAgICAgICAgICAgIC8vIERpc3Bvc2UoKSBvbiB0aGUgcXVldWUgYWxyZWR5ICh3aGljaCB3b3VsZCByZXNldCB0aGUgdmFyXG4gICAgICAgICAgICAgICAgLy8gaGVyZSB0byBudWxsISkuXG4gICAgICAgICAgICAgICAgLy8gVGhhdCBzaG91bGQgZ2VuZXJhbGx5IGhvbGQgdHJ1ZSBmb3IgamF2YXNjcmlwdC4uLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZTdWJzY3JpYmVycyA9PT0gc3Vicykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTdWJzY3JpYmVycyA9IHN1YnM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIG5vdGU6IHRoaXMgYmxvY2sgYXNzdW1lcyBjb29wZXJhdGl2ZSBtdWx0aXRhc2tpbmcsIGkuZS4sXG4gICAgICAgICAgICAgICAgLy8gYmV0d2VlbiB0aGUgaWYtc3RhdGVtZW50IGFuZCB0aGUgYXNzaWdubWVudCB0aGVyZSBhcmUgbm9cbiAgICAgICAgICAgICAgICAvLyB0aHJlYWQgc3dpdGNoZXMuXG4gICAgICAgICAgICAgICAgLy8gUmVhc29uIGlzIHRoYXQgYmV0d2VlbiB0aGUgaW5pdGlhbCBjb25zdCA9IHRoaXMuOyBhbmQgdGhpc1xuICAgICAgICAgICAgICAgIC8vIHBvaW50IHRoZXJlIGlzIHRoZSBkZXJyYWwucmVzb2x2ZSgpIG9wZXJhdGlvbiB0aGF0IG1pZ2h0IGhhdmVcbiAgICAgICAgICAgICAgICAvLyBjYXVzZWQgcmVjdXJzaXZlIGNhbGxzIHRvIHRoZSBRdWV1ZSwgZXNwZWNpYWxseSwgY2FsbGluZ1xuICAgICAgICAgICAgICAgIC8vIERpc3Bvc2UoKSBvbiB0aGUgcXVldWUgYWxyZWR5ICh3aGljaCB3b3VsZCByZXNldCB0aGUgdmFyXG4gICAgICAgICAgICAgICAgLy8gaGVyZSB0byBudWxsISkuXG4gICAgICAgICAgICAgICAgLy8gVGhhdCBzaG91bGQgZ2VuZXJhbGx5IGhvbGQgdHJ1ZSBmb3IgamF2YXNjcmlwdC4uLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZMaXN0ID09PSBsaXN0cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZMaXN0ID0gbGlzdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2SXNEcmFpbkluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aHJvd0lmRGlzcG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCgpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZVJlYXNvbikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IodGhpcy5wcml2RGlzcG9zZVJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgT2JqZWN0RGlzcG9zZWRFcnJvcihcIlF1ZXVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucHJpdklzRGlzcG9zaW5nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkVycm9yKFwiUXVldWUgZGlzcG9zaW5nXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1RdWV1ZS5qcy5tYXBcbiIsIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudCAqL1xuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBNZXNzYWdlVHlwZSB9IGZyb20gXCIuL0Nvbm5lY3Rpb25NZXNzYWdlXCI7XG5pbXBvcnQgeyBBcmd1bWVudE51bGxFcnJvciwgSW52YWxpZE9wZXJhdGlvbkVycm9yIH0gZnJvbSBcIi4vRXJyb3JcIjtcbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQgfSBmcm9tIFwiLi9HdWlkXCI7XG5leHBvcnQgY2xhc3MgUmF3V2Vic29ja2V0TWVzc2FnZSB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZVR5cGUsIHBheWxvYWQsIGlkKSB7XG4gICAgICAgIHRoaXMucHJpdlBheWxvYWQgPSBudWxsO1xuICAgICAgICBpZiAoIXBheWxvYWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBBcmd1bWVudE51bGxFcnJvcihcInBheWxvYWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2Vzc1xuICAgICAgICBpZiAobWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkJpbmFyeSAmJiBwYXlsb2FkLl9fcHJvdG9fXy5jb25zdHJ1Y3Rvci5uYW1lICE9PSBcIkFycmF5QnVmZmVyXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJQYXlsb2FkIG11c3QgYmUgQXJyYXlCdWZmZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5UZXh0ICYmICEodHlwZW9mIChwYXlsb2FkKSA9PT0gXCJzdHJpbmdcIikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJQYXlsb2FkIG11c3QgYmUgYSBzdHJpbmdcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2TWVzc2FnZVR5cGUgPSBtZXNzYWdlVHlwZTtcbiAgICAgICAgdGhpcy5wcml2UGF5bG9hZCA9IHBheWxvYWQ7XG4gICAgICAgIHRoaXMucHJpdklkID0gaWQgPyBpZCA6IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICB9XG4gICAgZ2V0IG1lc3NhZ2VUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWVzc2FnZVR5cGU7XG4gICAgfVxuICAgIGdldCBwYXlsb2FkKCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1yZXR1cm5cbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBheWxvYWQ7XG4gICAgfVxuICAgIGdldCB0ZXh0Q29udGVudCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdk1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5CaW5hcnkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJOb3Qgc3VwcG9ydGVkIGZvciBiaW5hcnkgbWVzc2FnZVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGF5bG9hZDtcbiAgICB9XG4gICAgZ2V0IGJpbmFyeUNvbnRlbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZNZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuVGV4dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIk5vdCBzdXBwb3J0ZWQgZm9yIHRleHQgbWVzc2FnZVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGF5bG9hZDtcbiAgICB9XG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SYXdXZWJzb2NrZXRNZXNzYWdlLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5leHBvcnQgY2xhc3MgUmlmZlBjbUVuY29kZXIge1xuICAgIGNvbnN0cnVjdG9yKGFjdHVhbFNhbXBsZVJhdGUsIGRlc2lyZWRTYW1wbGVSYXRlKSB7XG4gICAgICAgIHRoaXMucHJpdkFjdHVhbFNhbXBsZVJhdGUgPSBhY3R1YWxTYW1wbGVSYXRlO1xuICAgICAgICB0aGlzLnByaXZEZXNpcmVkU2FtcGxlUmF0ZSA9IGRlc2lyZWRTYW1wbGVSYXRlO1xuICAgIH1cbiAgICBlbmNvZGUoYWN0dWFsQXVkaW9GcmFtZSkge1xuICAgICAgICBjb25zdCBhdWRpb0ZyYW1lID0gdGhpcy5kb3duU2FtcGxlQXVkaW9GcmFtZShhY3R1YWxBdWRpb0ZyYW1lLCB0aGlzLnByaXZBY3R1YWxTYW1wbGVSYXRlLCB0aGlzLnByaXZEZXNpcmVkU2FtcGxlUmF0ZSk7XG4gICAgICAgIGlmICghYXVkaW9GcmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXVkaW9MZW5ndGggPSBhdWRpb0ZyYW1lLmxlbmd0aCAqIDI7XG4gICAgICAgIGNvbnN0IGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihhdWRpb0xlbmd0aCk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgRGF0YVZpZXcoYnVmZmVyKTtcbiAgICAgICAgdGhpcy5mbG9hdFRvMTZCaXRQQ00odmlldywgMCwgYXVkaW9GcmFtZSk7XG4gICAgICAgIHJldHVybiBidWZmZXI7XG4gICAgfVxuICAgIHNldFN0cmluZyh2aWV3LCBvZmZzZXQsIHN0cikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQgKyBpLCBzdHIuY2hhckNvZGVBdChpKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmxvYXRUbzE2Qml0UENNKHZpZXcsIG9mZnNldCwgaW5wdXQpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKywgb2Zmc2V0ICs9IDIpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBNYXRoLm1heCgtMSwgTWF0aC5taW4oMSwgaW5wdXRbaV0pKTtcbiAgICAgICAgICAgIHZpZXcuc2V0SW50MTYob2Zmc2V0LCBzIDwgMCA/IHMgKiAweDgwMDAgOiBzICogMHg3RkZGLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkb3duU2FtcGxlQXVkaW9GcmFtZShzcmNGcmFtZSwgc3JjUmF0ZSwgZHN0UmF0ZSkge1xuICAgICAgICBpZiAoIXNyY0ZyYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZHN0UmF0ZSA9PT0gc3JjUmF0ZSB8fCBkc3RSYXRlID4gc3JjUmF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHNyY0ZyYW1lO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJhdGlvID0gc3JjUmF0ZSAvIGRzdFJhdGU7XG4gICAgICAgIGNvbnN0IGRzdExlbmd0aCA9IE1hdGgucm91bmQoc3JjRnJhbWUubGVuZ3RoIC8gcmF0aW8pO1xuICAgICAgICBjb25zdCBkc3RGcmFtZSA9IG5ldyBGbG9hdDMyQXJyYXkoZHN0TGVuZ3RoKTtcbiAgICAgICAgbGV0IHNyY09mZnNldCA9IDA7XG4gICAgICAgIGxldCBkc3RPZmZzZXQgPSAwO1xuICAgICAgICB3aGlsZSAoZHN0T2Zmc2V0IDwgZHN0TGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0U3JjT2Zmc2V0ID0gTWF0aC5yb3VuZCgoZHN0T2Zmc2V0ICsgMSkgKiByYXRpbyk7XG4gICAgICAgICAgICBsZXQgYWNjdW0gPSAwO1xuICAgICAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChzcmNPZmZzZXQgPCBuZXh0U3JjT2Zmc2V0ICYmIHNyY09mZnNldCA8IHNyY0ZyYW1lLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGFjY3VtICs9IHNyY0ZyYW1lW3NyY09mZnNldCsrXTtcbiAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZHN0RnJhbWVbZHN0T2Zmc2V0KytdID0gYWNjdW0gLyBjb3VudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZHN0RnJhbWU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SaWZmUGNtRW5jb2Rlci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IgfSBmcm9tIFwiLi9FcnJvclwiO1xuaW1wb3J0IHsgY3JlYXRlTm9EYXNoR3VpZCB9IGZyb20gXCIuL0d1aWRcIjtcbmltcG9ydCB7IFF1ZXVlIH0gZnJvbSBcIi4vUXVldWVcIjtcbmV4cG9ydCBjbGFzcyBTdHJlYW0ge1xuICAgIGNvbnN0cnVjdG9yKHN0cmVhbUlkKSB7XG4gICAgICAgIHRoaXMucHJpdklzV3JpdGVFbmRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJc1JlYWRFbmRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZJZCA9IHN0cmVhbUlkID8gc3RyZWFtSWQgOiBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdlJlYWRlclF1ZXVlID0gbmV3IFF1ZXVlKCk7XG4gICAgfVxuICAgIGdldCBpc0Nsb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzV3JpdGVFbmRlZDtcbiAgICB9XG4gICAgZ2V0IGlzUmVhZEVuZGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNSZWFkRW5kZWQ7XG4gICAgfVxuICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByaXZJc1dyaXRlRW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMud3JpdGVTdHJlYW1DaHVuayh7XG4gICAgICAgICAgICAgICAgYnVmZmVyOiBudWxsLFxuICAgICAgICAgICAgICAgIGlzRW5kOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcml2SXNXcml0ZUVuZGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3cml0ZVN0cmVhbUNodW5rKHN0cmVhbUNodW5rKSB7XG4gICAgICAgIHRoaXMudGhyb3dJZkNsb3NlZCgpO1xuICAgICAgICBpZiAoIXRoaXMucHJpdlJlYWRlclF1ZXVlLmlzRGlzcG9zZWQoKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWFkZXJRdWV1ZS5lbnF1ZXVlKHN0cmVhbUNodW5rKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlYWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZJc1JlYWRFbmRlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIlN0cmVhbSByZWFkIGhhcyBhbHJlYWR5IGZpbmlzaGVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFkZXJRdWV1ZVxuICAgICAgICAgICAgLmRlcXVldWUoKVxuICAgICAgICAgICAgLnRoZW4oKHN0cmVhbUNodW5rKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoc3RyZWFtQ2h1bmsgPT09IHVuZGVmaW5lZCB8fCBzdHJlYW1DaHVuay5pc0VuZCkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlYWRlclF1ZXVlLmRpc3Bvc2UoXCJFbmQgb2Ygc3RyZWFtIHJlYWNoZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RyZWFtQ2h1bms7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgcmVhZEVuZGVkKCkge1xuICAgICAgICBpZiAoIXRoaXMucHJpdklzUmVhZEVuZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZJc1JlYWRFbmRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWFkZXJRdWV1ZSA9IG5ldyBRdWV1ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93SWZDbG9zZWQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZJc1dyaXRlRW5kZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IoXCJTdHJlYW0gY2xvc2VkXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TdHJlYW0uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogU3RyaW5nIGhlbHBlciBmdW5jdGlvbnNcbiAqL1xuZXhwb3J0IGNsYXNzIFN0cmluZ1V0aWxzIHtcbiAgICAvKipcbiAgICAgKiBGb3JtYXRzIGEgc3RyaW5nIGJ5IHJlcGxhY2luZyB0aGUgbmFtZWQge2tleXN9IGluIHRoZSBzdHJpbmcgd2l0aCB0aGUgdmFsdWVzIGNvbnRhaW5lZCBpbiB0aGUgcmVwbGFjZW1lbnQgZGljdGlvbmFyeS5cbiAgICAgKiBAcGFyYW0gZm9ybWF0IFRoZSBmb3JtYXQgc3RyaW5nIHRoYXQgY29udGFpbnMgdGhlIHBhcnRzIHRvIHJlcGxhY2Ugc3Vycm91bmRlZCBieSB7fS4gRm9yIGV4YW1wbGU6IFwid3NzOi8ve3JlZ2lvbn0uY3RzLnNwZWVjaC5taWNyb3NvZnQuY29tXCIuXG4gICAgICogSWYgeW91ciBzdHJpbmcgbmVlZHMgdG8gY29udGFpbiBhIHsgb3IgfSB5b3UgY2FuIHVzZSB0aGUge3sgYW5kIH19IGVzY2FwZSBzZXF1ZW5jZXMgcmVzcGVjdGl2ZWx5LlxuICAgICAqIEBwYXJhbSByZXBsYWNlbWVudHMgVGhlIGRpY3Rpb25hcnkgb2YgcmVwbGFjZW1lbnRzLiBJZiBhIHJlcGxhY2VtZW50IGlzIG5vdCBmb3VuZCwgaXQgaXMgcmVwbGFjZWQgd2l0aCBhbiBlbXB0eSBzdHJpbmdcbiAgICAgKiBAcmV0dXJucyBUaGUgZm9ybWF0dGVkIHN0cmluZy4gSWYgeW91IHBhc3MgaW4gYSBudWxsIG9yIHVuZGVmaW5lZCBmb3JtYXQgc3RyaW5nLCBhbiBlbXB0eSBzdHJpbmcgd2lsbCBiZSByZXR1cm5lZFxuICAgICAqL1xuICAgIHN0YXRpYyBmb3JtYXRTdHJpbmcoZm9ybWF0LCByZXBsYWNlbWVudHMpIHtcbiAgICAgICAgaWYgKCFmb3JtYXQpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVwbGFjZW1lbnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0O1xuICAgICAgICB9XG4gICAgICAgIGxldCBmb3JtYXR0ZWQgPSBcIlwiO1xuICAgICAgICBsZXQga2V5ID0gXCJcIjtcbiAgICAgICAgY29uc3QgYXBwZW5kVG9Gb3JtYXR0ZWQgPSAoc3RyKSA9PiB7XG4gICAgICAgICAgICBmb3JtYXR0ZWQgKz0gc3RyO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBhcHBlbmRUb0tleSA9IChzdHIpID0+IHtcbiAgICAgICAgICAgIGtleSArPSBzdHI7XG4gICAgICAgIH07XG4gICAgICAgIGxldCBhcHBlbmRGdW5jID0gYXBwZW5kVG9Gb3JtYXR0ZWQ7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZm9ybWF0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBjID0gZm9ybWF0W2ldO1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9IGkgKyAxIDwgZm9ybWF0Lmxlbmd0aCA/IGZvcm1hdFtpICsgMV0gOiBcIlwiO1xuICAgICAgICAgICAgc3dpdGNoIChjKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIntcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQgPT09IFwie1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmRGdW5jKFwie1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZEZ1bmMgPSBhcHBlbmRUb0tleTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwifVwiOlxuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCA9PT0gXCJ9XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZEZ1bmMoXCJ9XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkICs9IHJlcGxhY2VtZW50c1trZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kRnVuYyA9IGFwcGVuZFRvRm9ybWF0dGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBhcHBlbmRGdW5jKGMpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm9ybWF0dGVkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3RyaW5nVXRpbHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCBjbGFzcyBUaW1lb3V0IHtcbiAgICBzdGF0aWMgbG9hZCgpIHtcbiAgICAgICAgLy8gUHJlZmlsbGluZyB0aGUgTWFwcyB3aXRoIGEgZnVuY3Rpb24gaW5kZXhlZCBieSB6ZXJvIGlzIG5lY2Vzc2FyeSB0byBiZSBjb21wbGlhbnQgd2l0aCB0aGUgc3BlY2lmaWNhdGlvbi5cbiAgICAgICAgY29uc3Qgc2NoZWR1bGVkVGltZW91dEZ1bmN0aW9ucyA9IG5ldyBNYXAoW1swLCAoKSA9PiB7IH1dXSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgICAgIGNvbnN0IHVuaGFuZGxlZFJlcXVlc3RzID0gbmV3IE1hcCgpO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgY29uc3Qgd29ya2VyU2NyaXB0ID0gYCFmdW5jdGlvbihlKXt2YXIgdD17fTtmdW5jdGlvbiBuKHIpe2lmKHRbcl0pcmV0dXJuIHRbcl0uZXhwb3J0czt2YXIgbz10W3JdPXtpOnIsbDohMSxleHBvcnRzOnt9fTtyZXR1cm4gZVtyXS5jYWxsKG8uZXhwb3J0cyxvLG8uZXhwb3J0cyxuKSxvLmw9ITAsby5leHBvcnRzfW4ubT1lLG4uYz10LG4uZD1mdW5jdGlvbihlLHQscil7bi5vKGUsdCl8fE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse2VudW1lcmFibGU6ITAsZ2V0OnJ9KX0sbi5yPWZ1bmN0aW9uKGUpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZTpcIk1vZHVsZVwifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9LG4udD1mdW5jdGlvbihlLHQpe2lmKDEmdCYmKGU9bihlKSksOCZ0KXJldHVybiBlO2lmKDQmdCYmXCJvYmplY3RcIj09dHlwZW9mIGUmJmUmJmUuX19lc01vZHVsZSlyZXR1cm4gZTt2YXIgcj1PYmplY3QuY3JlYXRlKG51bGwpO2lmKG4ucihyKSxPYmplY3QuZGVmaW5lUHJvcGVydHkocixcImRlZmF1bHRcIix7ZW51bWVyYWJsZTohMCx2YWx1ZTplfSksMiZ0JiZcInN0cmluZ1wiIT10eXBlb2YgZSlmb3IodmFyIG8gaW4gZSluLmQocixvLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfS5iaW5kKG51bGwsbykpO3JldHVybiByfSxuLm49ZnVuY3Rpb24oZSl7dmFyIHQ9ZSYmZS5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIGUuZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gZX07cmV0dXJuIG4uZCh0LFwiYVwiLHQpLHR9LG4ubz1mdW5jdGlvbihlLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KX0sbi5wPVwiXCIsbihuLnM9MTQpfShbZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO24uZCh0LFwiYVwiLChmdW5jdGlvbigpe3JldHVybiBpfSkpLG4uZCh0LFwiYlwiLChmdW5jdGlvbigpe3JldHVybiB1fSkpLG4uZCh0LFwiY1wiLChmdW5jdGlvbigpe3JldHVybiBhfSkpLG4uZCh0LFwiZFwiLChmdW5jdGlvbigpe3JldHVybiBkfSkpO2NvbnN0IHI9bmV3IE1hcCxvPW5ldyBNYXAsaT1lPT57Y29uc3QgdD1yLmdldChlKTtpZih2b2lkIDA9PT10KXRocm93IG5ldyBFcnJvcignVGhlcmUgaXMgbm8gaW50ZXJ2YWwgc2NoZWR1bGVkIHdpdGggdGhlIGdpdmVuIGlkIFwiJy5jb25jYXQoZSwnXCIuJykpO2NsZWFyVGltZW91dCh0KSxyLmRlbGV0ZShlKX0sdT1lPT57Y29uc3QgdD1vLmdldChlKTtpZih2b2lkIDA9PT10KXRocm93IG5ldyBFcnJvcignVGhlcmUgaXMgbm8gdGltZW91dCBzY2hlZHVsZWQgd2l0aCB0aGUgZ2l2ZW4gaWQgXCInLmNvbmNhdChlLCdcIi4nKSk7Y2xlYXJUaW1lb3V0KHQpLG8uZGVsZXRlKGUpfSxmPShlLHQpPT57bGV0IG4scjtpZihcInBlcmZvcm1hbmNlXCJpbiBzZWxmKXtjb25zdCBvPXBlcmZvcm1hbmNlLm5vdygpO249byxyPWUtTWF0aC5tYXgoMCxvLXQpfWVsc2Ugbj1EYXRlLm5vdygpLHI9ZTtyZXR1cm57ZXhwZWN0ZWQ6bityLHJlbWFpbmluZ0RlbGF5OnJ9fSxjPShlLHQsbixyKT0+e2NvbnN0IG89XCJwZXJmb3JtYW5jZVwiaW4gc2VsZj9wZXJmb3JtYW5jZS5ub3coKTpEYXRlLm5vdygpO28+bj9wb3N0TWVzc2FnZSh7aWQ6bnVsbCxtZXRob2Q6XCJjYWxsXCIscGFyYW1zOnt0aW1lcklkOnR9fSk6ZS5zZXQodCxzZXRUaW1lb3V0KGMsbi1vLGUsdCxuKSl9LGE9KGUsdCxuKT0+e2NvbnN0e2V4cGVjdGVkOm8scmVtYWluaW5nRGVsYXk6aX09ZihlLG4pO3Iuc2V0KHQsc2V0VGltZW91dChjLGkscix0LG8pKX0sZD0oZSx0LG4pPT57Y29uc3R7ZXhwZWN0ZWQ6cixyZW1haW5pbmdEZWxheTppfT1mKGUsbik7by5zZXQodCxzZXRUaW1lb3V0KGMsaSxvLHQscikpfX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO24ucih0KTt2YXIgcj1uKDIpO2Zvcih2YXIgbyBpbiByKVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gcltlXX0pKX0obyk7dmFyIGk9bigzKTtmb3IodmFyIG8gaW4gaSlcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIGlbZV19KSl9KG8pO3ZhciB1PW4oNCk7Zm9yKHZhciBvIGluIHUpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiB1W2VdfSkpfShvKTt2YXIgZj1uKDUpO2Zvcih2YXIgbyBpbiBmKVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gZltlXX0pKX0obyk7dmFyIGM9big2KTtmb3IodmFyIG8gaW4gYylcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIGNbZV19KSl9KG8pO3ZhciBhPW4oNyk7Zm9yKHZhciBvIGluIGEpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiBhW2VdfSkpfShvKTt2YXIgZD1uKDgpO2Zvcih2YXIgbyBpbiBkKVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gZFtlXX0pKX0obyk7dmFyIHM9big5KTtmb3IodmFyIG8gaW4gcylcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIHNbZV19KSl9KG8pfSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtuLnIodCk7dmFyIHI9bigxMSk7Zm9yKHZhciBvIGluIHIpXCJkZWZhdWx0XCIhPT1vJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiByW2VdfSkpfShvKTt2YXIgaT1uKDEyKTtmb3IodmFyIG8gaW4gaSlcImRlZmF1bHRcIiE9PW8mJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIGlbZV19KSl9KG8pO3ZhciB1PW4oMTMpO2Zvcih2YXIgbyBpbiB1KVwiZGVmYXVsdFwiIT09byYmZnVuY3Rpb24oZSl7bi5kKHQsZSwoZnVuY3Rpb24oKXtyZXR1cm4gdVtlXX0pKX0obyl9LGZ1bmN0aW9uKGUsdCl7fSxmdW5jdGlvbihlLHQpe30sZnVuY3Rpb24oZSx0KXt9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtuLnIodCk7dmFyIHI9bigwKSxvPW4oMSk7Zm9yKHZhciBpIGluIG8pXCJkZWZhdWx0XCIhPT1pJiZmdW5jdGlvbihlKXtuLmQodCxlLChmdW5jdGlvbigpe3JldHVybiBvW2VdfSkpfShpKTt2YXIgdT1uKDEwKTtmb3IodmFyIGkgaW4gdSlcImRlZmF1bHRcIiE9PWkmJmZ1bmN0aW9uKGUpe24uZCh0LGUsKGZ1bmN0aW9uKCl7cmV0dXJuIHVbZV19KSl9KGkpO2FkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsKHtkYXRhOmV9KT0+e3RyeXtpZihcImNsZWFyXCI9PT1lLm1ldGhvZCl7Y29uc3R7aWQ6dCxwYXJhbXM6e3RpbWVySWQ6bn19PWU7T2JqZWN0KHIuYikobikscG9zdE1lc3NhZ2Uoe2Vycm9yOm51bGwsaWQ6dH0pfWVsc2V7aWYoXCJzZXRcIiE9PWUubWV0aG9kKXRocm93IG5ldyBFcnJvcignVGhlIGdpdmVuIG1ldGhvZCBcIicuY29uY2F0KGUubWV0aG9kLCdcIiBpcyBub3Qgc3VwcG9ydGVkJykpO3tjb25zdHtwYXJhbXM6e2RlbGF5OnQsbm93Om4sdGltZXJJZDpvfX09ZTtPYmplY3Qoci5kKSh0LG8sbil9fX1jYXRjaCh0KXtwb3N0TWVzc2FnZSh7ZXJyb3I6e21lc3NhZ2U6dC5tZXNzYWdlfSxpZDplLmlkLHJlc3VsdDpudWxsfSl9fSl9XSk7YDtcbiAgICAgICAgY29uc3Qgd29ya2VyVXJsID0gXCJkYXRhOnRleHQvamF2YXNjcmlwdDtiYXNlNjQsXCIgKyBidG9hKHdvcmtlclNjcmlwdCk7XG4gICAgICAgIGNvbnN0IHdvcmtlciA9IG5ldyBXb3JrZXIod29ya2VyVXJsKTtcbiAgICAgICAgd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsICh7IGRhdGEgfSkgPT4ge1xuICAgICAgICAgICAgaWYgKFRpbWVvdXQuaXNDYWxsTm90aWZpY2F0aW9uKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBwYXJhbXM6IHsgdGltZXJJZCB9IH0gPSBkYXRhO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkT3JGdW5jID0gc2NoZWR1bGVkVGltZW91dEZ1bmN0aW9ucy5nZXQodGltZXJJZCk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpZE9yRnVuYyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1bmhhbmRsZWRUaW1lcklkID0gdW5oYW5kbGVkUmVxdWVzdHMuZ2V0KGlkT3JGdW5jKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVuaGFuZGxlZFRpbWVySWQgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5oYW5kbGVkVGltZXJJZCAhPT0gdGltZXJJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHRpbWVyIGlzIGluIGFuIHVuZGVmaW5lZCBzdGF0ZS5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGlkT3JGdW5jICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkT3JGdW5jKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgdGltZW91dCBjYW4gYmUgc2FmZWx5IGRlbGV0ZWQgYmVjYXVzZSBpdCBpcyBvbmx5IGNhbGxlZCBvbmNlLlxuICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZWRUaW1lb3V0RnVuY3Rpb25zLmRlbGV0ZSh0aW1lcklkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSB0aW1lciBpcyBpbiBhbiB1bmRlZmluZWQgc3RhdGUuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKFRpbWVvdXQuaXNDbGVhclJlc3BvbnNlKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBpZCB9ID0gZGF0YTtcbiAgICAgICAgICAgICAgICBjb25zdCB1bmhhbmRsZWRUaW1lcklkID0gdW5oYW5kbGVkUmVxdWVzdHMuZ2V0KGlkKTtcbiAgICAgICAgICAgICAgICBpZiAodW5oYW5kbGVkVGltZXJJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSB0aW1lciBpcyBpbiBhbiB1bmRlZmluZWQgc3RhdGUuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB1bmhhbmRsZWRSZXF1ZXN0cy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgICAgIHNjaGVkdWxlZFRpbWVvdXRGdW5jdGlvbnMuZGVsZXRlKHVuaGFuZGxlZFRpbWVySWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBlcnJvcjogeyBtZXNzYWdlIH0gfSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2xlYXJUaW1lb3V0ID0gKHRpbWVySWQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgICAgIHVuaGFuZGxlZFJlcXVlc3RzLnNldChpZCwgdGltZXJJZCk7XG4gICAgICAgICAgICBzY2hlZHVsZWRUaW1lb3V0RnVuY3Rpb25zLnNldCh0aW1lcklkLCBpZCk7XG4gICAgICAgICAgICB3b3JrZXIucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJjbGVhclwiLFxuICAgICAgICAgICAgICAgIHBhcmFtczogeyB0aW1lcklkIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBzZXRUaW1lb3V0ID0gKGZ1bmMsIGRlbGF5KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aW1lcklkID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgICAgIHNjaGVkdWxlZFRpbWVvdXRGdW5jdGlvbnMuc2V0KHRpbWVySWQsIGZ1bmMpO1xuICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBpZDogbnVsbCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwic2V0XCIsXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGF5LFxuICAgICAgICAgICAgICAgICAgICBub3c6IHBlcmZvcm1hbmNlLm5vdygpLFxuICAgICAgICAgICAgICAgICAgICB0aW1lcklkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGltZXJJZDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCxcbiAgICAgICAgICAgIHNldFRpbWVvdXRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIGxvYWRXb3JrZXJUaW1lcnMoKSB7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoVGltZW91dC53b3JrZXJUaW1lcnMgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVGltZW91dC53b3JrZXJUaW1lcnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBUaW1lb3V0LndvcmtlclRpbWVycyA9IFRpbWVvdXQubG9hZCgpO1xuICAgICAgICAgICAgcmV0dXJuIFRpbWVvdXQud29ya2VyVGltZXJzO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBzdGF0aWMgaXNDYWxsTm90aWZpY2F0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2UubWV0aG9kICE9PSB1bmRlZmluZWQgJiYgbWVzc2FnZS5tZXRob2QgPT09IFwiY2FsbFwiO1xuICAgIH1cbiAgICBzdGF0aWMgaXNDbGVhclJlc3BvbnNlKG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IgPT09IG51bGwgJiYgdHlwZW9mIG1lc3NhZ2UuaWQgPT09IFwibnVtYmVyXCI7XG4gICAgfVxufVxuVGltZW91dC53b3JrZXJUaW1lcnMgPSBudWxsO1xuVGltZW91dC5jbGVhclRpbWVvdXQgPSAodGltZXJJZCkgPT4gVGltZW91dC50aW1lcnMoKS5jbGVhclRpbWVvdXQodGltZXJJZCk7XG5UaW1lb3V0LnNldFRpbWVvdXQgPSAoZnVuYywgZGVsYXkpID0+IFRpbWVvdXQudGltZXJzKCkuc2V0VGltZW91dChmdW5jLCBkZWxheSk7XG5UaW1lb3V0LnRpbWVycyA9IFRpbWVvdXQubG9hZFdvcmtlclRpbWVycygpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UaW1lb3V0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgY29udGVudHMgb2YgcmVjZWl2ZWQgbWVzc2FnZS9ldmVudHMuXG4gKiBAY2xhc3MgQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge2FueX0gYWN0aXZpdHkgLSBUaGUgYWN0aXZpdHkuLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFjdGl2aXR5LCBhdWRpb1N0cmVhbSkge1xuICAgICAgICB0aGlzLnByaXZBY3Rpdml0eSA9IGFjdGl2aXR5O1xuICAgICAgICB0aGlzLnByaXZBdWRpb1N0cmVhbSA9IGF1ZGlvU3RyZWFtO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSByZWNlaXZlZCBhY3Rpdml0eVxuICAgICAqIEBtZW1iZXIgQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJncy5wcm90b3R5cGUuYWN0aXZpdHlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2FueX0gdGhlIHJlY2VpdmVkIGFjdGl2aXR5LlxuICAgICAqL1xuICAgIGdldCBhY3Rpdml0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFjdGl2aXR5O1xuICAgIH1cbiAgICBnZXQgYXVkaW9TdHJlYW0oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb1N0cmVhbTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFjdGl2aXR5UmVjZWl2ZWRFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEZpbGVBdWRpb1NvdXJjZSwgTWljQXVkaW9Tb3VyY2UsIFBjbVJlY29yZGVyLCB9IGZyb20gXCIuLi8uLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBBdWRpb0lucHV0U3RyZWFtLCBQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrLCBQdWxsQXVkaW9PdXRwdXRTdHJlYW0sIFB1c2hBdWRpb091dHB1dFN0cmVhbSwgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2ssIFNwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmltcG9ydCB7IEF1ZGlvRmlsZVdyaXRlciB9IGZyb20gXCIuL0F1ZGlvRmlsZVdyaXRlclwiO1xuaW1wb3J0IHsgUHVsbEF1ZGlvSW5wdXRTdHJlYW1JbXBsIH0gZnJvbSBcIi4vQXVkaW9JbnB1dFN0cmVhbVwiO1xuaW1wb3J0IHsgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtSW1wbCB9IGZyb20gXCIuL0F1ZGlvT3V0cHV0U3RyZWFtXCI7XG4vKipcbiAqIFJlcHJlc2VudHMgYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbiB1c2VkIGZvciBzcGVjaWZ5aW5nIHdoYXQgdHlwZSBvZiBpbnB1dCB0byB1c2UgKG1pY3JvcGhvbmUsIGZpbGUsIHN0cmVhbSkuXG4gKiBAY2xhc3MgQXVkaW9Db25maWdcbiAqIFVwZGF0ZWQgaW4gdmVyc2lvbiAxLjExLjBcbiAqL1xuZXhwb3J0IGNsYXNzIEF1ZGlvQ29uZmlnIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEF1ZGlvQ29uZmlnIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGRlZmF1bHQgbWljcm9waG9uZSBvbiB0aGUgc3lzdGVtLlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbURlZmF1bHRNaWNyb3Bob25lSW5wdXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0F1ZGlvQ29uZmlnfSBUaGUgYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbiBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tRGVmYXVsdE1pY3JvcGhvbmVJbnB1dCgpIHtcbiAgICAgICAgY29uc3QgcGNtUmVjb3JkZXIgPSBuZXcgUGNtUmVjb3JkZXIodHJ1ZSk7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9Db25maWdJbXBsKG5ldyBNaWNBdWRpb1NvdXJjZShwY21SZWNvcmRlcikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEF1ZGlvQ29uZmlnIG9iamVjdCByZXByZXNlbnRpbmcgYSBtaWNyb3Bob25lIHdpdGggdGhlIHNwZWNpZmllZCBkZXZpY2UgSUQuXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZy5mcm9tTWljcm9waG9uZUlucHV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgdW5kZWZpbmVkfSBkZXZpY2VJZCAtIFNwZWNpZmllcyB0aGUgZGV2aWNlIElEIG9mIHRoZSBtaWNyb3Bob25lIHRvIGJlIHVzZWQuXG4gICAgICogRGVmYXVsdCBtaWNyb3Bob25lIGlzIHVzZWQgdGhlIHZhbHVlIGlzIG9taXR0ZWQuXG4gICAgICogQHJldHVybnMge0F1ZGlvQ29uZmlnfSBUaGUgYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbiBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tTWljcm9waG9uZUlucHV0KGRldmljZUlkKSB7XG4gICAgICAgIGNvbnN0IHBjbVJlY29yZGVyID0gbmV3IFBjbVJlY29yZGVyKHRydWUpO1xuICAgICAgICByZXR1cm4gbmV3IEF1ZGlvQ29uZmlnSW1wbChuZXcgTWljQXVkaW9Tb3VyY2UocGNtUmVjb3JkZXIsIGRldmljZUlkKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gQXVkaW9Db25maWcgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3BlY2lmaWVkIGZpbGUuXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZy5mcm9tV2F2RmlsZUlucHV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7RmlsZX0gZmlsZU5hbWUgLSBTcGVjaWZpZXMgdGhlIGF1ZGlvIGlucHV0IGZpbGUuIEN1cnJlbnRseSwgb25seSBXQVYgLyBQQ00gaXMgc3VwcG9ydGVkLlxuICAgICAqIEByZXR1cm5zIHtBdWRpb0NvbmZpZ30gVGhlIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb24gYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVdhdkZpbGVJbnB1dChmaWxlLCBuYW1lID0gXCJ1bm5hbWVkQnVmZmVyLndhdlwiKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9Db25maWdJbXBsKG5ldyBGaWxlQXVkaW9Tb3VyY2UoZmlsZSwgbmFtZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEF1ZGlvQ29uZmlnIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHNwZWNpZmllZCBzdHJlYW0uXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZy5mcm9tU3RyZWFtSW5wdXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtBdWRpb0lucHV0U3RyZWFtIHwgUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFjayB8IE1lZGlhU3RyZWFtfSBhdWRpb1N0cmVhbSAtIFNwZWNpZmllcyB0aGUgY3VzdG9tIGF1ZGlvIGlucHV0XG4gICAgICogc3RyZWFtLiBDdXJyZW50bHksIG9ubHkgV0FWIC8gUENNIGlzIHN1cHBvcnRlZC5cbiAgICAgKiBAcmV0dXJucyB7QXVkaW9Db25maWd9IFRoZSBhdWRpbyBpbnB1dCBjb25maWd1cmF0aW9uIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21TdHJlYW1JbnB1dChhdWRpb1N0cmVhbSkge1xuICAgICAgICBpZiAoYXVkaW9TdHJlYW0gaW5zdGFuY2VvZiBQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvQ29uZmlnSW1wbChuZXcgUHVsbEF1ZGlvSW5wdXRTdHJlYW1JbXBsKGF1ZGlvU3RyZWFtKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGF1ZGlvU3RyZWFtIGluc3RhbmNlb2YgQXVkaW9JbnB1dFN0cmVhbSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb0NvbmZpZ0ltcGwoYXVkaW9TdHJlYW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgTWVkaWFTdHJlYW0gIT09IFwidW5kZWZpbmVkXCIgJiYgYXVkaW9TdHJlYW0gaW5zdGFuY2VvZiBNZWRpYVN0cmVhbSkge1xuICAgICAgICAgICAgY29uc3QgcGNtUmVjb3JkZXIgPSBuZXcgUGNtUmVjb3JkZXIoZmFsc2UpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb0NvbmZpZ0ltcGwobmV3IE1pY0F1ZGlvU291cmNlKHBjbVJlY29yZGVyLCBudWxsLCBudWxsLCBhdWRpb1N0cmVhbSkpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBTdXBwb3J0ZWQgVHlwZVwiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBBdWRpb0NvbmZpZyBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBkZWZhdWx0IHNwZWFrZXIuXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZy5mcm9tRGVmYXVsdFNwZWFrZXJPdXRwdXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0F1ZGlvQ29uZmlnfSBUaGUgYXVkaW8gb3V0cHV0IGNvbmZpZ3VyYXRpb24gYmVpbmcgY3JlYXRlZC5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTEuMFxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tRGVmYXVsdFNwZWFrZXJPdXRwdXQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRDb25maWdJbXBsKG5ldyBTcGVha2VyQXVkaW9EZXN0aW5hdGlvbigpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBBdWRpb0NvbmZpZyBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBjdXN0b20gSVBsYXllciBvYmplY3QuXG4gICAgICogWW91IGNhbiB1c2UgdGhlIElQbGF5ZXIgb2JqZWN0IHRvIGNvbnRyb2wgcGF1c2UsIHJlc3VtZSwgZXRjLlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbVNwZWFrZXJPdXRwdXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtJUGxheWVyfSBwbGF5ZXIgLSB0aGUgSVBsYXllciBvYmplY3QgZm9yIHBsYXliYWNrLlxuICAgICAqIEByZXR1cm5zIHtBdWRpb0NvbmZpZ30gVGhlIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9uIGJlaW5nIGNyZWF0ZWQuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEyLjBcbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVNwZWFrZXJPdXRwdXQocGxheWVyKSB7XG4gICAgICAgIGlmIChwbGF5ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIEF1ZGlvQ29uZmlnLmZyb21EZWZhdWx0U3BlYWtlck91dHB1dCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGF5ZXIgaW5zdGFuY2VvZiBTcGVha2VyQXVkaW9EZXN0aW5hdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dENvbmZpZ0ltcGwocGxheWVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgU3VwcG9ydGVkIFR5cGVcIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gQXVkaW9Db25maWcgb2JqZWN0IHJlcHJlc2VudGluZyBhIHNwZWNpZmllZCBvdXRwdXQgYXVkaW8gZmlsZVxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbUF1ZGlvRmlsZU91dHB1dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1BhdGhMaWtlfSBmaWxlbmFtZSAtIHRoZSBmaWxlbmFtZSBvZiB0aGUgb3V0cHV0IGF1ZGlvIGZpbGVcbiAgICAgKiBAcmV0dXJucyB7QXVkaW9Db25maWd9IFRoZSBhdWRpbyBvdXRwdXQgY29uZmlndXJhdGlvbiBiZWluZyBjcmVhdGVkLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xMS4wXG4gICAgICovXG4gICAgc3RhdGljIGZyb21BdWRpb0ZpbGVPdXRwdXQoZmlsZW5hbWUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dENvbmZpZ0ltcGwobmV3IEF1ZGlvRmlsZVdyaXRlcihmaWxlbmFtZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIEF1ZGlvQ29uZmlnIG9iamVjdCByZXByZXNlbnRpbmcgYSBzcGVjaWZpZWQgYXVkaW8gb3V0cHV0IHN0cmVhbVxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWcuZnJvbVN0cmVhbU91dHB1dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0F1ZGlvT3V0cHV0U3RyZWFtIHwgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2t9IGF1ZGlvU3RyZWFtIC0gU3BlY2lmaWVzIHRoZSBjdXN0b20gYXVkaW8gb3V0cHV0XG4gICAgICogc3RyZWFtLlxuICAgICAqIEByZXR1cm5zIHtBdWRpb0NvbmZpZ30gVGhlIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9uIGJlaW5nIGNyZWF0ZWQuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjExLjBcbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN0cmVhbU91dHB1dChhdWRpb1N0cmVhbSkge1xuICAgICAgICBpZiAoYXVkaW9TdHJlYW0gaW5zdGFuY2VvZiBQdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFjaykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dENvbmZpZ0ltcGwobmV3IFB1c2hBdWRpb091dHB1dFN0cmVhbUltcGwoYXVkaW9TdHJlYW0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXVkaW9TdHJlYW0gaW5zdGFuY2VvZiBQdXNoQXVkaW9PdXRwdXRTdHJlYW0pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRDb25maWdJbXBsKGF1ZGlvU3RyZWFtKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXVkaW9TdHJlYW0gaW5zdGFuY2VvZiBQdWxsQXVkaW9PdXRwdXRTdHJlYW0pIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRDb25maWdJbXBsKGF1ZGlvU3RyZWFtKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgU3VwcG9ydGVkIFR5cGVcIik7XG4gICAgfVxufVxuLyoqXG4gKiBSZXByZXNlbnRzIGF1ZGlvIGlucHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIEF1ZGlvQ29uZmlnSW1wbFxuICovXG5leHBvcnQgY2xhc3MgQXVkaW9Db25maWdJbXBsIGV4dGVuZHMgQXVkaW9Db25maWcge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtJQXVkaW9Tb3VyY2V9IHNvdXJjZSAtIEFuIGF1ZGlvIHNvdXJjZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihzb3VyY2UpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2U291cmNlID0gc291cmNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgaW5mb3JtYXRpb24gZm9yIHRoZSBhdWRpb1xuICAgICAqL1xuICAgIGdldCBmb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTb3VyY2UuZm9ybWF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnSW1wbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoY2IsIGVycikge1xuICAgICAgICB0aGlzLnByaXZTb3VyY2UudHVybk9mZigpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1ZGlvQ29uZmlnSW1wbC5wcm90b3R5cGUuaWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTb3VyY2UuaWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZ0ltcGwucHJvdG90eXBlLnR1cm5PblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn0gQSBwcm9taXNlLlxuICAgICAqL1xuICAgIHR1cm5PbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNvdXJjZS50dXJuT24oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZ0ltcGwucHJvdG90eXBlLmF0dGFjaFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYXVkaW9Ob2RlSWQgLSBUaGUgYXVkaW8gbm9kZSBpZC5cbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxJQXVkaW9TdHJlYW1Ob2RlPn0gQSBwcm9taXNlLlxuICAgICAqL1xuICAgIGF0dGFjaChhdWRpb05vZGVJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmF0dGFjaChhdWRpb05vZGVJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXVkaW9Db25maWdJbXBsLnByb3RvdHlwZS5kZXRhY2hcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF1ZGlvTm9kZUlkIC0gVGhlIGF1ZGlvIG5vZGUgaWQuXG4gICAgICovXG4gICAgZGV0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTb3VyY2UuZGV0YWNoKGF1ZGlvTm9kZUlkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZ0ltcGwucHJvdG90eXBlLnR1cm5PZmZcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb21pc2U8dm9pZD59IEEgcHJvbWlzZS5cbiAgICAgKi9cbiAgICB0dXJuT2ZmKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLnR1cm5PZmYoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBBdWRpb0NvbmZpZ0ltcGwucHJvdG90eXBlLmV2ZW50c1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7RXZlbnRTb3VyY2U8QXVkaW9Tb3VyY2VFdmVudD59IEFuIGV2ZW50IHNvdXJjZSBmb3IgYXVkaW8gZXZlbnRzLlxuICAgICAqL1xuICAgIGdldCBldmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTb3VyY2UuZXZlbnRzO1xuICAgIH1cbiAgICBzZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwodmFsdWUsIFwidmFsdWVcIik7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHRoaXMucHJpdlNvdXJjZS5zZXRQcm9wZXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5wcml2U291cmNlLnNldFByb3BlcnR5KG5hbWUsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgQXVkaW9Db25maWcgaW5zdGFuY2UgZG9lcyBub3Qgc3VwcG9ydCBzZXR0aW5nIHByb3BlcnRpZXMuXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFByb3BlcnR5KG5hbWUsIGRlZikge1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSB0aGlzLnByaXZTb3VyY2UuZ2V0UHJvcGVydHkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZTb3VyY2UuZ2V0UHJvcGVydHkobmFtZSwgZGVmKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgQXVkaW9Db25maWcgaW5zdGFuY2UgZG9lcyBub3Qgc3VwcG9ydCBnZXR0aW5nIHByb3BlcnRpZXMuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWY7XG4gICAgfVxuICAgIGdldCBkZXZpY2VJbmZvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U291cmNlLmRldmljZUluZm87XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEF1ZGlvT3V0cHV0Q29uZmlnSW1wbCBleHRlbmRzIEF1ZGlvQ29uZmlnIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7SUF1ZGlvRGVzdGluYXRpb259IGRlc3RpbmF0aW9uIC0gQW4gYXVkaW8gZGVzdGluYXRpb24uXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZGVzdGluYXRpb24pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2RGVzdGluYXRpb24gPSBkZXN0aW5hdGlvbjtcbiAgICB9XG4gICAgc2V0IGZvcm1hdChmb3JtYXQpIHtcbiAgICAgICAgdGhpcy5wcml2RGVzdGluYXRpb24uZm9ybWF0ID0gZm9ybWF0O1xuICAgIH1cbiAgICB3cml0ZShidWZmZXIpIHtcbiAgICAgICAgdGhpcy5wcml2RGVzdGluYXRpb24ud3JpdGUoYnVmZmVyKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMucHJpdkRlc3RpbmF0aW9uLmNsb3NlKCk7XG4gICAgfVxuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGVzdGluYXRpb24uaWQoKTtcbiAgICB9XG4gICAgc2V0UHJvcGVydHkoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgQXVkaW9Db25maWcgaW5zdGFuY2UgZG9lcyBub3Qgc3VwcG9ydCBzZXR0aW5nIHByb3BlcnRpZXMuXCIpO1xuICAgIH1cbiAgICBnZXRQcm9wZXJ0eSgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBBdWRpb0NvbmZpZyBpbnN0YW5jZSBkb2VzIG5vdCBzdXBwb3J0IGdldHRpbmcgcHJvcGVydGllcy5cIik7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BdWRpb0NvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0ICogYXMgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi4vQ29udHJhY3RzXCI7XG5leHBvcnQgY2xhc3MgQXVkaW9GaWxlV3JpdGVyIHtcbiAgICBjb25zdHJ1Y3RvcihmaWxlbmFtZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChmcy5vcGVuU3luYywgXCJcXG5GaWxlIFN5c3RlbSBhY2Nlc3Mgbm90IGF2YWlsYWJsZSwgcGxlYXNlIHVzZSBQdXNoIG9yIFB1bGxBdWRpb091dHB1dFN0cmVhbVwiKTtcbiAgICAgICAgdGhpcy5wcml2RmQgPSBmcy5vcGVuU3luYyhmaWxlbmFtZSwgXCJ3XCIpO1xuICAgIH1cbiAgICBzZXQgZm9ybWF0KGZvcm1hdCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk5vdFVuZGVmaW5lZCh0aGlzLnByaXZBdWRpb0Zvcm1hdCwgXCJmb3JtYXQgaXMgYWxyZWFkeSBzZXRcIik7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvRm9ybWF0ID0gZm9ybWF0O1xuICAgICAgICBsZXQgaGVhZGVyT2Zmc2V0ID0gMDtcbiAgICAgICAgaWYgKHRoaXMucHJpdkF1ZGlvRm9ybWF0Lmhhc0hlYWRlcikge1xuICAgICAgICAgICAgaGVhZGVyT2Zmc2V0ID0gdGhpcy5wcml2QXVkaW9Gb3JtYXQuaGVhZGVyLmJ5dGVMZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdkZkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdldyaXRlU3RyZWFtID0gZnMuY3JlYXRlV3JpdGVTdHJlYW0oXCJcIiwgeyBmZDogdGhpcy5wcml2RmQsIHN0YXJ0OiBoZWFkZXJPZmZzZXQsIGF1dG9DbG9zZTogZmFsc2UgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd3JpdGUoYnVmZmVyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdkF1ZGlvRm9ybWF0LCBcIm11c3Qgc2V0IGZvcm1hdCBiZWZvcmUgd3JpdGluZy5cIik7XG4gICAgICAgIGlmICh0aGlzLnByaXZXcml0ZVN0cmVhbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZXcml0ZVN0cmVhbS53cml0ZShuZXcgVWludDhBcnJheShidWZmZXIuc2xpY2UoMCkpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJpdkZkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdldyaXRlU3RyZWFtLm9uKFwiZmluaXNoXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2QXVkaW9Gb3JtYXQuaGFzSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvRm9ybWF0LnVwZGF0ZUhlYWRlcih0aGlzLnByaXZXcml0ZVN0cmVhbS5ieXRlc1dyaXR0ZW4pO1xuICAgICAgICAgICAgICAgICAgICBmcy53cml0ZVN5bmModGhpcy5wcml2RmQsIG5ldyBJbnQ4QXJyYXkodGhpcy5wcml2QXVkaW9Gb3JtYXQuaGVhZGVyKSwgMCwgdGhpcy5wcml2QXVkaW9Gb3JtYXQuaGVhZGVyLmJ5dGVMZW5ndGgsIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmcy5jbG9zZVN5bmModGhpcy5wcml2RmQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkZkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnByaXZXcml0ZVN0cmVhbS5lbmQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9GaWxlV3JpdGVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBjb25uZWN0aXZpdHksIHR5cGUsIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9Tb3VyY2VJbml0aWFsaXppbmdFdmVudCwgQXVkaW9Tb3VyY2VSZWFkeUV2ZW50LCBBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50LCBBdWRpb1N0cmVhbU5vZGVBdHRhY2hpbmdFdmVudCwgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCwgQ2h1bmtlZEFycmF5QnVmZmVyU3RyZWFtLCBFdmVudHMsIEV2ZW50U291cmNlLCB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgY3JlYXRlTm9EYXNoR3VpZCB9IGZyb20gXCIuLi8uLi9jb21tb24vR3VpZFwiO1xuaW1wb3J0IHsgQXVkaW9TdHJlYW1Gb3JtYXQgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsIH0gZnJvbSBcIi4vQXVkaW9TdHJlYW1Gb3JtYXRcIjtcbi8qKlxuICogUmVwcmVzZW50cyBhdWRpbyBpbnB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQGNsYXNzIEF1ZGlvSW5wdXRTdHJlYW1cbiAqL1xuZXhwb3J0IGNsYXNzIEF1ZGlvSW5wdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBtZW1vcnkgYmFja2VkIFB1c2hBdWRpb0lucHV0U3RyZWFtIHdpdGggdGhlIHNwZWNpZmllZCBhdWRpbyBmb3JtYXQuXG4gICAgICogQG1lbWJlciBBdWRpb0lucHV0U3RyZWFtLmNyZWF0ZVB1c2hTdHJlYW1cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtBdWRpb1N0cmVhbUZvcm1hdH0gZm9ybWF0IC0gVGhlIGF1ZGlvIGRhdGEgZm9ybWF0IGluIHdoaWNoIGF1ZGlvIHdpbGwgYmVcbiAgICAgKiB3cml0dGVuIHRvIHRoZSBwdXNoIGF1ZGlvIHN0cmVhbSdzIHdyaXRlKCkgbWV0aG9kIChSZXF1aXJlZCBpZiBmb3JtYXQgaXMgbm90IDE2IGtIeiAxNmJpdCBtb25vIFBDTSkuXG4gICAgICogQHJldHVybnMge1B1c2hBdWRpb0lucHV0U3RyZWFtfSBUaGUgYXVkaW8gaW5wdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZVB1c2hTdHJlYW0oZm9ybWF0KSB7XG4gICAgICAgIHJldHVybiBQdXNoQXVkaW9JbnB1dFN0cmVhbS5jcmVhdGUoZm9ybWF0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFB1bGxBdWRpb0lucHV0U3RyZWFtIHRoYXQgZGVsZWdhdGVzIHRvIHRoZSBzcGVjaWZpZWQgY2FsbGJhY2sgaW50ZXJmYWNlIGZvciByZWFkKClcbiAgICAgKiBhbmQgY2xvc2UoKSBtZXRob2RzLlxuICAgICAqIEBtZW1iZXIgQXVkaW9JbnB1dFN0cmVhbS5jcmVhdGVQdWxsU3RyZWFtXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFja30gY2FsbGJhY2sgLSBUaGUgY3VzdG9tIGF1ZGlvIGlucHV0IG9iamVjdCwgZGVyaXZlZCBmcm9tXG4gICAgICogUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFja1xuICAgICAqIEBwYXJhbSB7QXVkaW9TdHJlYW1Gb3JtYXR9IGZvcm1hdCAtIFRoZSBhdWRpbyBkYXRhIGZvcm1hdCBpbiB3aGljaCBhdWRpbyB3aWxsIGJlIHJldHVybmVkIGZyb21cbiAgICAgKiB0aGUgY2FsbGJhY2sncyByZWFkKCkgbWV0aG9kIChSZXF1aXJlZCBpZiBmb3JtYXQgaXMgbm90IDE2IGtIeiAxNmJpdCBtb25vIFBDTSkuXG4gICAgICogQHJldHVybnMge1B1bGxBdWRpb0lucHV0U3RyZWFtfSBUaGUgYXVkaW8gaW5wdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZVB1bGxTdHJlYW0oY2FsbGJhY2ssIGZvcm1hdCkge1xuICAgICAgICByZXR1cm4gUHVsbEF1ZGlvSW5wdXRTdHJlYW0uY3JlYXRlKGNhbGxiYWNrLCBmb3JtYXQpO1xuICAgICAgICAvLyB0aHJvdyBuZXcgRXJyb3IoXCJPb3BzXCIpO1xuICAgIH1cbn1cbi8qKlxuICogUmVwcmVzZW50cyBtZW1vcnkgYmFja2VkIHB1c2ggYXVkaW8gaW5wdXQgc3RyZWFtIHVzZWQgZm9yIGN1c3RvbSBhdWRpbyBpbnB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBjbGFzcyBQdXNoQXVkaW9JbnB1dFN0cmVhbVxuICovXG5leHBvcnQgY2xhc3MgUHVzaEF1ZGlvSW5wdXRTdHJlYW0gZXh0ZW5kcyBBdWRpb0lucHV0U3RyZWFtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbWVtb3J5IGJhY2tlZCBQdXNoQXVkaW9JbnB1dFN0cmVhbSB3aXRoIHRoZSBzcGVjaWZpZWQgYXVkaW8gZm9ybWF0LlxuICAgICAqIEBtZW1iZXIgUHVzaEF1ZGlvSW5wdXRTdHJlYW0uY3JlYXRlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7QXVkaW9TdHJlYW1Gb3JtYXR9IGZvcm1hdCAtIFRoZSBhdWRpbyBkYXRhIGZvcm1hdCBpbiB3aGljaCBhdWRpbyB3aWxsIGJlIHdyaXR0ZW4gdG8gdGhlXG4gICAgICogcHVzaCBhdWRpbyBzdHJlYW0ncyB3cml0ZSgpIG1ldGhvZCAoUmVxdWlyZWQgaWYgZm9ybWF0IGlzIG5vdCAxNiBrSHogMTZiaXQgbW9ubyBQQ00pLlxuICAgICAqIEByZXR1cm5zIHtQdXNoQXVkaW9JbnB1dFN0cmVhbX0gVGhlIHB1c2ggYXVkaW8gaW5wdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZShmb3JtYXQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdXNoQXVkaW9JbnB1dFN0cmVhbUltcGwoZm9ybWF0KTtcbiAgICB9XG59XG4vKipcbiAqIFJlcHJlc2VudHMgbWVtb3J5IGJhY2tlZCBwdXNoIGF1ZGlvIGlucHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIFB1c2hBdWRpb0lucHV0U3RyZWFtSW1wbFxuICovXG5leHBvcnQgY2xhc3MgUHVzaEF1ZGlvSW5wdXRTdHJlYW1JbXBsIGV4dGVuZHMgUHVzaEF1ZGlvSW5wdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRhbGl6ZXMgYW4gaW5zdGFuY2Ugd2l0aCB0aGUgZ2l2ZW4gdmFsdWVzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXVkaW9TdHJlYW1Gb3JtYXR9IGZvcm1hdCAtIFRoZSBhdWRpbyBzdHJlYW0gZm9ybWF0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGZvcm1hdCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoZm9ybWF0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkZvcm1hdCA9IEF1ZGlvU3RyZWFtRm9ybWF0SW1wbC5nZXREZWZhdWx0SW5wdXRGb3JtYXQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkZvcm1hdCA9IGZvcm1hdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZFdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbSA9IG5ldyBDaHVua2VkQXJyYXlCdWZmZXJTdHJlYW0odGhpcy5wcml2Rm9ybWF0LmF2Z0J5dGVzUGVyU2VjIC8gMTApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgaW5mb3JtYXRpb24gZm9yIHRoZSBhdWRpb1xuICAgICAqL1xuICAgIGdldCBmb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5wcml2Rm9ybWF0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIHRoZSBhdWRpbyBkYXRhIHNwZWNpZmllZCBieSBtYWtpbmcgYW4gaW50ZXJuYWwgY29weSBvZiB0aGUgZGF0YS5cbiAgICAgKiBAbWVtYmVyIFB1c2hBdWRpb0lucHV0U3RyZWFtSW1wbC5wcm90b3R5cGUud3JpdGVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcn0gZGF0YUJ1ZmZlciAtIFRoZSBhdWRpbyBidWZmZXIgb2Ygd2hpY2ggdGhpcyBmdW5jdGlvbiB3aWxsIG1ha2UgYSBjb3B5LlxuICAgICAqL1xuICAgIHdyaXRlKGRhdGFCdWZmZXIpIHtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtLndyaXRlU3RyZWFtQ2h1bmsoe1xuICAgICAgICAgICAgYnVmZmVyOiBkYXRhQnVmZmVyLFxuICAgICAgICAgICAgaXNFbmQ6IGZhbHNlLFxuICAgICAgICAgICAgdGltZVJlY2VpdmVkOiBEYXRlLm5vdygpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHN0cmVhbS5cbiAgICAgKiBAbWVtYmVyIFB1c2hBdWRpb0lucHV0U3RyZWFtSW1wbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbS5jbG9zZSgpO1xuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICB0dXJuT24oKSB7XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VJbml0aWFsaXppbmdFdmVudCh0aGlzLnByaXZJZCkpOyAvLyBubyBzdHJlYW0gaWRcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZVJlYWR5RXZlbnQodGhpcy5wcml2SWQpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhdHRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFtID0gdGhpcy5wcml2U3RyZWFtO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkZXRhY2g6ICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaWQ6ICgpID0+IGF1ZGlvTm9kZUlkLFxuICAgICAgICAgICAgICAgIHJlYWQ6ICgpID0+IHN0cmVhbS5yZWFkKCksXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZGV0YWNoKGF1ZGlvTm9kZUlkKSB7XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlRGV0YWNoZWRFdmVudCh0aGlzLnByaXZJZCwgYXVkaW9Ob2RlSWQpKTtcbiAgICB9XG4gICAgdHVybk9mZigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBnZXQgZXZlbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXZlbnRzO1xuICAgIH1cbiAgICBnZXQgZGV2aWNlSW5mbygpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBiaXRzcGVyc2FtcGxlOiB0aGlzLnByaXZGb3JtYXQuYml0c1BlclNhbXBsZSxcbiAgICAgICAgICAgIGNoYW5uZWxjb3VudDogdGhpcy5wcml2Rm9ybWF0LmNoYW5uZWxzLFxuICAgICAgICAgICAgY29ubmVjdGl2aXR5OiBjb25uZWN0aXZpdHkuVW5rbm93bixcbiAgICAgICAgICAgIG1hbnVmYWN0dXJlcjogXCJTcGVlY2ggU0RLXCIsXG4gICAgICAgICAgICBtb2RlbDogXCJQdXNoU3RyZWFtXCIsXG4gICAgICAgICAgICBzYW1wbGVyYXRlOiB0aGlzLnByaXZGb3JtYXQuc2FtcGxlc1BlclNlYyxcbiAgICAgICAgICAgIHR5cGU6IHR5cGUuU3RyZWFtLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25FdmVudChldmVudCkge1xuICAgICAgICB0aGlzLnByaXZFdmVudHMub25FdmVudChldmVudCk7XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5vbkV2ZW50KGV2ZW50KTtcbiAgICB9XG4gICAgdG9CdWZmZXIoYXJyYXlCdWZmZXIpIHtcbiAgICAgICAgY29uc3QgYnVmID0gQnVmZmVyLmFsbG9jKGFycmF5QnVmZmVyLmJ5dGVMZW5ndGgpO1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1Zi5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgYnVmW2ldID0gdmlld1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYnVmO1xuICAgIH1cbn1cbi8qXG4gKiBSZXByZXNlbnRzIGF1ZGlvIGlucHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAY2xhc3MgUHVsbEF1ZGlvSW5wdXRTdHJlYW1cbiAqL1xuZXhwb3J0IGNsYXNzIFB1bGxBdWRpb0lucHV0U3RyZWFtIGV4dGVuZHMgQXVkaW9JbnB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW5kIGluc3RhbmNlLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgUHVsbEF1ZGlvSW5wdXRTdHJlYW0gdGhhdCBkZWxlZ2F0ZXMgdG8gdGhlIHNwZWNpZmllZCBjYWxsYmFjayBpbnRlcmZhY2UgZm9yXG4gICAgICogcmVhZCgpIGFuZCBjbG9zZSgpIG1ldGhvZHMsIHVzaW5nIHRoZSBkZWZhdWx0IGZvcm1hdCAoMTYga0h6IDE2Yml0IG1vbm8gUENNKS5cbiAgICAgKiBAbWVtYmVyIFB1bGxBdWRpb0lucHV0U3RyZWFtLmNyZWF0ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1B1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2t9IGNhbGxiYWNrIC0gVGhlIGN1c3RvbSBhdWRpbyBpbnB1dCBvYmplY3QsXG4gICAgICogZGVyaXZlZCBmcm9tIFB1bGxBdWRpb0lucHV0U3RyZWFtQ3VzdG9tQ2FsbGJhY2tcbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBmb3JtYXQgLSBUaGUgYXVkaW8gZGF0YSBmb3JtYXQgaW4gd2hpY2ggYXVkaW8gd2lsbCBiZVxuICAgICAqIHJldHVybmVkIGZyb20gdGhlIGNhbGxiYWNrJ3MgcmVhZCgpIG1ldGhvZCAoUmVxdWlyZWQgaWYgZm9ybWF0IGlzIG5vdCAxNiBrSHogMTZiaXQgbW9ubyBQQ00pLlxuICAgICAqIEByZXR1cm5zIHtQdWxsQXVkaW9JbnB1dFN0cmVhbX0gVGhlIHB1c2ggYXVkaW8gaW5wdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZShjYWxsYmFjaywgZm9ybWF0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUHVsbEF1ZGlvSW5wdXRTdHJlYW1JbXBsKGNhbGxiYWNrLCBmb3JtYXQpO1xuICAgIH1cbn1cbi8qKlxuICogUmVwcmVzZW50cyBhdWRpbyBpbnB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIGlucHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBQdWxsQXVkaW9JbnB1dFN0cmVhbUltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIFB1bGxBdWRpb0lucHV0U3RyZWFtSW1wbCBleHRlbmRzIFB1bGxBdWRpb0lucHV0U3RyZWFtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgUHVsbEF1ZGlvSW5wdXRTdHJlYW0gdGhhdCBkZWxlZ2F0ZXMgdG8gdGhlIHNwZWNpZmllZCBjYWxsYmFjayBpbnRlcmZhY2UgZm9yXG4gICAgICogcmVhZCgpIGFuZCBjbG9zZSgpIG1ldGhvZHMsIHVzaW5nIHRoZSBkZWZhdWx0IGZvcm1hdCAoMTYga0h6IDE2Yml0IG1vbm8gUENNKS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1B1bGxBdWRpb0lucHV0U3RyZWFtQ2FsbGJhY2t9IGNhbGxiYWNrIC0gVGhlIGN1c3RvbSBhdWRpbyBpbnB1dCBvYmplY3QsXG4gICAgICogZGVyaXZlZCBmcm9tIFB1bGxBdWRpb0lucHV0U3RyZWFtQ3VzdG9tQ2FsbGJhY2tcbiAgICAgKiBAcGFyYW0ge0F1ZGlvU3RyZWFtRm9ybWF0fSBmb3JtYXQgLSBUaGUgYXVkaW8gZGF0YSBmb3JtYXQgaW4gd2hpY2ggYXVkaW8gd2lsbCBiZVxuICAgICAqIHJldHVybmVkIGZyb20gdGhlIGNhbGxiYWNrJ3MgcmVhZCgpIG1ldGhvZCAoUmVxdWlyZWQgaWYgZm9ybWF0IGlzIG5vdCAxNiBrSHogMTZiaXQgbW9ubyBQQ00pLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGNhbGxiYWNrLCBmb3JtYXQpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZm9ybWF0KSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGb3JtYXQgPSBBdWRpb1N0cmVhbUZvcm1hdC5nZXREZWZhdWx0SW5wdXRGb3JtYXQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkZvcm1hdCA9IGZvcm1hdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZFdmVudHMgPSBuZXcgRXZlbnRTb3VyY2UoKTtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBjcmVhdGVOb0Rhc2hHdWlkKCk7XG4gICAgICAgIHRoaXMucHJpdkNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIHRoaXMucHJpdklzQ2xvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkJ1ZmZlclNpemUgPSB0aGlzLnByaXZGb3JtYXQuYXZnQnl0ZXNQZXJTZWMgLyAxMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9ybWF0IGluZm9ybWF0aW9uIGZvciB0aGUgYXVkaW9cbiAgICAgKi9cbiAgICBnZXQgZm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucHJpdkZvcm1hdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgc3RyZWFtLlxuICAgICAqIEBtZW1iZXIgUHVsbEF1ZGlvSW5wdXRTdHJlYW1JbXBsLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5wcml2SXNDbG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnByaXZDYWxsYmFjay5jbG9zZSgpO1xuICAgIH1cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICB0dXJuT24oKSB7XG4gICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9Tb3VyY2VJbml0aWFsaXppbmdFdmVudCh0aGlzLnByaXZJZCkpOyAvLyBubyBzdHJlYW0gaWRcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1NvdXJjZVJlYWR5RXZlbnQodGhpcy5wcml2SWQpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBhdHRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRoaXMub25FdmVudChuZXcgQXVkaW9TdHJlYW1Ob2RlQXR0YWNoaW5nRXZlbnQodGhpcy5wcml2SWQsIGF1ZGlvTm9kZUlkKSk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnR1cm5PbigpO1xuICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVBdHRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkZXRhY2g6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q2FsbGJhY2suY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50dXJuT2ZmKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpZDogKCkgPT4gYXVkaW9Ob2RlSWQsXG4gICAgICAgICAgICAgICAgcmVhZDogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxCeXRlcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0cmFuc21pdEJ1ZmY7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVudGlsIHdlIGhhdmUgdGhlIG1pbmltdW0gbnVtYmVyIG9mIGJ5dGVzIHRvIHNlbmQgaW4gYSB0cmFuc21pc3Npb24sIGtlZXAgYXNraW5nIGZvciBtb3JlLlxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAodG90YWxCeXRlcyA8IHRoaXMucHJpdkJ1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNpemluZyB0aGUgcmVhZCBidWZmZXIgdG8gdGhlIGRlbHRhIGJldHdlZW4gdGhlIHBlcmZlY3Qgc2l6ZSBhbmQgd2hhdCdzIGxlZnQgbWVhbnMgd2Ugd29uJ3QgZXZlciBnZXQgdG9vIG11Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgYmFjay5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRCdWZmID0gbmV3IEFycmF5QnVmZmVyKHRoaXMucHJpdkJ1ZmZlclNpemUgLSB0b3RhbEJ5dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHB1bGxlZEJ5dGVzID0gdGhpcy5wcml2Q2FsbGJhY2sucmVhZChyZWFkQnVmZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyByZXR1cm4gYnVmZmVyIHlldCBkZWZpbmVkLCBzZXQgdGhlIHJldHVybiBidWZmZXIgdG8gdGhlIHRoYXQgd2FzIGp1c3QgcG9wdWxhdGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3YXMsIGlmIHdlIGhhdmUgZW5vdWdoIGRhdGEgdGhlcmUncyBubyBjb3B5IHBlbmFsdHksIGJ1dCBpZiB3ZSBkb24ndCB3ZSBoYXZlIGEgYnVmZmVyIHRoYXQncyB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByZWZlcnJlZCBzaXplIGFsbG9jYXRlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1bmRlZmluZWQgPT09IHRyYW5zbWl0QnVmZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbWl0QnVmZiA9IHJlYWRCdWZmO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IHRoZSBmaXJzdCBiaXRlIGF0IHRoZSBhcHBsZSwgc28gZmlsbCB0aGUgcmV0dXJuIGJ1ZmZlciB3aXRoIHRoZSBkYXRhIHdlIGdvdCBiYWNrLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGludFZpZXcgPSBuZXcgSW50OEFycmF5KHRyYW5zbWl0QnVmZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50Vmlldy5zZXQobmV3IEludDhBcnJheShyZWFkQnVmZiksIHRvdGFsQnl0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG5vIGJ5dGVzIHRvIHJlYWQsIGp1c3QgYnJlYWsgb3V0IGFuZCBiZSBkb25lLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IHB1bGxlZEJ5dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEJ5dGVzICs9IHB1bGxlZEJ5dGVzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyOiB0cmFuc21pdEJ1ZmYuc2xpY2UoMCwgdG90YWxCeXRlcyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VuZDogdGhpcy5wcml2SXNDbG9zZWQgfHwgdG90YWxCeXRlcyA9PT0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBkZXRhY2goYXVkaW9Ob2RlSWQpIHtcbiAgICAgICAgdGhpcy5vbkV2ZW50KG5ldyBBdWRpb1N0cmVhbU5vZGVEZXRhY2hlZEV2ZW50KHRoaXMucHJpdklkLCBhdWRpb05vZGVJZCkpO1xuICAgIH1cbiAgICB0dXJuT2ZmKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGdldCBldmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFdmVudHM7XG4gICAgfVxuICAgIGdldCBkZXZpY2VJbmZvKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIGJpdHNwZXJzYW1wbGU6IHRoaXMucHJpdkZvcm1hdC5iaXRzUGVyU2FtcGxlLFxuICAgICAgICAgICAgY2hhbm5lbGNvdW50OiB0aGlzLnByaXZGb3JtYXQuY2hhbm5lbHMsXG4gICAgICAgICAgICBjb25uZWN0aXZpdHk6IGNvbm5lY3Rpdml0eS5Vbmtub3duLFxuICAgICAgICAgICAgbWFudWZhY3R1cmVyOiBcIlNwZWVjaCBTREtcIixcbiAgICAgICAgICAgIG1vZGVsOiBcIlB1bGxTdHJlYW1cIixcbiAgICAgICAgICAgIHNhbXBsZXJhdGU6IHRoaXMucHJpdkZvcm1hdC5zYW1wbGVzUGVyU2VjLFxuICAgICAgICAgICAgdHlwZTogdHlwZS5TdHJlYW0sXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBvbkV2ZW50KGV2ZW50KSB7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50cy5vbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQoZXZlbnQpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9JbnB1dFN0cmVhbS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0IH0gZnJvbSBcIi4uL1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFwiO1xuaW1wb3J0IHsgQXVkaW9Gb3JtYXRUYWcsIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbCB9IGZyb20gXCIuL0F1ZGlvU3RyZWFtRm9ybWF0XCI7XG4vKipcbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgQXVkaW9PdXRwdXRGb3JtYXRJbXBsXG4gKiBVcGRhdGVkIGluIHZlcnNpb24gMS4xNy4wXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtY2xhc3Nlcy1wZXItZmlsZVxuZXhwb3J0IGNsYXNzIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbCBleHRlbmRzIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSB3aXRoIHRoZSBnaXZlbiB2YWx1ZXMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIGZvcm1hdFRhZ1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjaGFubmVscyAtIE51bWJlciBvZiBjaGFubmVscy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2FtcGxlc1BlclNlYyAtIFNhbXBsZXMgcGVyIHNlY29uZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYXZnQnl0ZXNQZXJTZWMgLSBBdmVyYWdlIGJ5dGVzIHBlciBzZWNvbmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJsb2NrQWxpZ24gLSBCbG9jayBhbGlnbm1lbnQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdHNQZXJTYW1wbGUgLSBCaXRzIHBlciBzYW1wbGUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF1ZGlvRm9ybWF0U3RyaW5nIC0gQXVkaW8gZm9ybWF0IHN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmcgLSBBdWRpbyBmb3JtYXQgc3RyaW5nIHNlbnQgdG8gc2VydmljZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGhhc0hlYWRlciAtIElmIHRoZSBmb3JtYXQgaGFzIGhlYWRlciBvciBub3QuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZm9ybWF0VGFnLCBjaGFubmVscywgc2FtcGxlc1BlclNlYywgYXZnQnl0ZXNQZXJTZWMsIGJsb2NrQWxpZ24sIGJpdHNQZXJTYW1wbGUsIGF1ZGlvRm9ybWF0U3RyaW5nLCByZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmcsIGhhc0hlYWRlcikge1xuICAgICAgICBzdXBlcihzYW1wbGVzUGVyU2VjLCBiaXRzUGVyU2FtcGxlLCBjaGFubmVscywgZm9ybWF0VGFnKTtcbiAgICAgICAgdGhpcy5mb3JtYXRUYWcgPSBmb3JtYXRUYWc7XG4gICAgICAgIHRoaXMuYXZnQnl0ZXNQZXJTZWMgPSBhdmdCeXRlc1BlclNlYztcbiAgICAgICAgdGhpcy5ibG9ja0FsaWduID0gYmxvY2tBbGlnbjtcbiAgICAgICAgdGhpcy5wcmlBdWRpb0Zvcm1hdFN0cmluZyA9IGF1ZGlvRm9ybWF0U3RyaW5nO1xuICAgICAgICB0aGlzLnByaVJlcXVlc3RBdWRpb0Zvcm1hdFN0cmluZyA9IHJlcXVlc3RBdWRpb0Zvcm1hdFN0cmluZztcbiAgICAgICAgdGhpcy5wcmlIYXNIZWFkZXIgPSBoYXNIZWFkZXI7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0KHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCkge1xuICAgICAgICBpZiAoc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBBdWRpb091dHB1dEZvcm1hdEltcGwuZ2V0RGVmYXVsdE91dHB1dEZvcm1hdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBBdWRpb091dHB1dEZvcm1hdEltcGwuZnJvbVNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZyhBdWRpb091dHB1dEZvcm1hdEltcGwuU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0VG9TdHJpbmdbc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0XSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nKHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZykge1xuICAgICAgICBzd2l0Y2ggKHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZykge1xuICAgICAgICAgICAgY2FzZSBcInJhdy04a2h6LThiaXQtbW9uby1tdWxhd1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk11TGF3LCAxLCA4MDAwLCA4MDAwLCAxLCA4LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJpZmYtMTZraHotMTZrYnBzLW1vbm8tc2lyZW5cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5TaXJlbiwgMSwgMTYwMDAsIDIwMDAsIDQwLCAwLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwiYXVkaW8tMTZraHotMTZrYnBzLW1vbm8tc2lyZW5cIiwgdHJ1ZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMTZraHotMTZrYnBzLW1vbm8tc2lyZW5cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5TaXJlbiwgMSwgMTYwMDAsIDIwMDAsIDQwLCAwLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTE2a2h6LTMya2JpdHJhdGUtbW9uby1tcDNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NUDMsIDEsIDE2MDAwLCAzMiA8PCA3LCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0xNmtoei0xMjhrYml0cmF0ZS1tb25vLW1wM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk1QMywgMSwgMTYwMDAsIDEyOCA8PCA3LCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0xNmtoei02NGtiaXRyYXRlLW1vbm8tbXAzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuTVAzLCAxLCAxNjAwMCwgNjQgPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMjRraHotNDhrYml0cmF0ZS1tb25vLW1wM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk1QMywgMSwgMjQwMDAsIDQ4IDw8IDcsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTI0a2h6LTk2a2JpdHJhdGUtbW9uby1tcDNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NUDMsIDEsIDI0MDAwLCA5NiA8PCA3LCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0yNGtoei0xNjBrYml0cmF0ZS1tb25vLW1wM1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk1QMywgMSwgMjQwMDAsIDE2MCA8PCA3LCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctMTZraHotMTZiaXQtbW9uby10cnVlc2lsa1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlNJTEtTa3lwZSwgMSwgMTYwMDAsIDMyMDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLThraHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDgwMDAsIDE2MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy04a2h6LTE2Yml0LW1vbm8tcGNtXCIsIHRydWUpO1xuICAgICAgICAgICAgY2FzZSBcInJpZmYtMjRraHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDI0MDAwLCA0ODAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctMjRraHotMTZiaXQtbW9uby1wY21cIiwgdHJ1ZSk7XG4gICAgICAgICAgICBjYXNlIFwicmlmZi04a2h6LThiaXQtbW9uby1tdWxhd1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk11TGF3LCAxLCA4MDAwLCA4MDAwLCAxLCA4LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LThraHotOGJpdC1tb25vLW11bGF3XCIsIHRydWUpO1xuICAgICAgICAgICAgY2FzZSBcInJhdy0xNmtoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgMTYwMDAsIDMyMDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy0xNmtoei0xNmJpdC1tb25vLXBjbVwiLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LTI0a2h6LTE2Yml0LW1vbm8tcGNtXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuUENNLCAxLCAyNDAwMCwgNDgwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LTI0a2h6LTE2Yml0LW1vbm8tcGNtXCIsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctOGtoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgODAwMCwgMTYwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIFwicmF3LThraHotMTZiaXQtbW9uby1wY21cIiwgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcIm9nZy0xNmtoei0xNmJpdC1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5PR0dfT1BVUywgMSwgMTYwMDAsIDgxOTIsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcIm9nZy0yNGtoei0xNmJpdC1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5PR0dfT1BVUywgMSwgMjQwMDAsIDgxOTIsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJhdy00OGtoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgNDgwMDAsIDk2MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy00OGtoei0xNmJpdC1tb25vLXBjbVwiLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmlmZi00OGtoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgNDgwMDAsIDk2MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBcInJhdy00OGtoei0xNmJpdC1tb25vLXBjbVwiLCB0cnVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby00OGtoei05NmtiaXRyYXRlLW1vbm8tbXAzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuTVAzLCAxLCA0ODAwMCwgOTYgPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tNDhraHotMTkya2JpdHJhdGUtbW9uby1tcDNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5NUDMsIDEsIDQ4MDAwLCAxOTIgPDwgNywgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwib2dnLTQ4a2h6LTE2Yml0LW1vbm8tb3B1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk9HR19PUFVTLCAxLCA0ODAwMCwgMTIwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcIndlYm0tMTZraHotMTZiaXQtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuV0VCTV9PUFVTLCAxLCAxNjAwMCwgNDAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwid2VibS0yNGtoei0xNmJpdC1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5XRUJNX09QVVMsIDEsIDI0MDAwLCA2MDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJ3ZWJtLTI0a2h6LTE2Yml0LTI0a2Jwcy1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5XRUJNX09QVVMsIDEsIDI0MDAwLCAzMDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0xNmtoei0xNmJpdC0zMmticHMtbW9uby1vcHVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb091dHB1dEZvcm1hdEltcGwoQXVkaW9Gb3JtYXRUYWcuT1BVUywgMSwgMTYwMDAsIDQwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTI0a2h6LTE2Yml0LTQ4a2Jwcy1tb25vLW9wdXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5PUFVTLCAxLCAyNDAwMCwgNjAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwiYXVkaW8tMjRraHotMTZiaXQtMjRrYnBzLW1vbm8tb3B1c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLk9QVVMsIDEsIDI0MDAwLCAzMDAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJhdWRpby0yNGtoei0xNmJpdC1tb25vLWZsYWNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5GTEFDLCAxLCAyNDAwMCwgMjQwMDAsIDIsIDE2LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcImF1ZGlvLTQ4a2h6LTE2Yml0LW1vbm8tZmxhY1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLkZMQUMsIDEsIDQ4MDAwLCAzMDAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LTI0a2h6LTE2Yml0LW1vbm8tdHJ1ZXNpbGtcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5TSUxLU2t5cGUsIDEsIDI0MDAwLCA0ODAwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBmYWxzZSk7XG4gICAgICAgICAgICBjYXNlIFwicmF3LThraHotOGJpdC1tb25vLWFsYXdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5BTGF3LCAxLCA4MDAwLCA4MDAwLCAxLCA4LCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgZmFsc2UpO1xuICAgICAgICAgICAgY2FzZSBcInJpZmYtOGtoei04Yml0LW1vbm8tYWxhd1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLkFMYXcsIDEsIDgwMDAsIDgwMDAsIDEsIDgsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctOGtoei04Yml0LW1vbm8tYWxhd1wiLCB0cnVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctMjIwNTBoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgMjIwNTAsIDQ0MTAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLTIyMDUwaHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDIyMDUwLCA0NDEwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctMjIwNTBoei0xNmJpdC1tb25vLXBjbVwiLCB0cnVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyYXctNDQxMDBoei0xNmJpdC1tb25vLXBjbVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgNDQxMDAsIDg4MjAwLCAyLCAxNiwgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0U3RyaW5nLCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcsIGZhbHNlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLTQ0MTAwaHotMTZiaXQtbW9uby1wY21cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbChBdWRpb0Zvcm1hdFRhZy5QQ00sIDEsIDQ0MTAwLCA4ODIwMCwgMiwgMTYsIHNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFN0cmluZywgXCJyYXctNDQxMDBoei0xNmJpdC1tb25vLXBjbVwiLCB0cnVlKTtcbiAgICAgICAgICAgIGNhc2UgXCJyaWZmLTE2a2h6LTE2Yml0LW1vbm8tcGNtXCI6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXVkaW9PdXRwdXRGb3JtYXRJbXBsKEF1ZGlvRm9ybWF0VGFnLlBDTSwgMSwgMTYwMDAsIDMyMDAwLCAyLCAxNiwgXCJyaWZmLTE2a2h6LTE2Yml0LW1vbm8tcGNtXCIsIFwicmF3LTE2a2h6LTE2Yml0LW1vbm8tcGNtXCIsIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBnZXREZWZhdWx0T3V0cHV0Rm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gQXVkaW9PdXRwdXRGb3JtYXRJbXBsLmZyb21TcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRTdHJpbmcoKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpID8gXCJhdWRpby0yNGtoei00OGtiaXRyYXRlLW1vbm8tbXAzXCIgOiBcInJpZmYtMTZraHotMTZiaXQtbW9uby1wY21cIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyBpZiB0aGlzIGF1ZGlvIG91dHB1dCBmb3JtYXQgaGFzIGEgaGVhZGVyXG4gICAgICogQGJvb2xlYW4gQXVkaW9PdXRwdXRGb3JtYXRJbXBsLnByb3RvdHlwZS5oYXNIZWFkZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IGhhc0hlYWRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpSGFzSGVhZGVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGhlYWRlciBvZiB0aGlzIGZvcm1hdFxuICAgICAqIEBBcnJheUJ1ZmZlciBBdWRpb091dHB1dEZvcm1hdEltcGwucHJvdG90eXBlLmhlYWRlclxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBnZXQgaGVhZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNIZWFkZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZIZWFkZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgaGVhZGVyIGJhc2VkIG9uIHRoZSBhdWRpbyBsZW5ndGhcbiAgICAgKiBAbWVtYmVyIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC51cGRhdGVIZWFkZXJcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGF1ZGlvTGVuZ3RoIC0gdGhlIGF1ZGlvIGxlbmd0aFxuICAgICAqL1xuICAgIHVwZGF0ZUhlYWRlcihhdWRpb0xlbmd0aCkge1xuICAgICAgICBpZiAodGhpcy5wcmlIYXNIZWFkZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgRGF0YVZpZXcodGhpcy5wcml2SGVhZGVyKTtcbiAgICAgICAgICAgIHZpZXcuc2V0VWludDMyKDQsIGF1ZGlvTGVuZ3RoICsgdGhpcy5wcml2SGVhZGVyLmJ5dGVMZW5ndGggLSA4LCB0cnVlKTtcbiAgICAgICAgICAgIHZpZXcuc2V0VWludDMyKDQwLCBhdWRpb0xlbmd0aCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBhdWRpbyBmb3JtYXQgc3RyaW5nIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZpY2VcbiAgICAgKiBAc3RyaW5nIEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5wcm90b3R5cGUucmVxdWVzdEF1ZGlvRm9ybWF0U3RyaW5nXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCByZXF1ZXN0QXVkaW9Gb3JtYXRTdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaVJlcXVlc3RBdWRpb0Zvcm1hdFN0cmluZztcbiAgICB9XG59XG5BdWRpb091dHB1dEZvcm1hdEltcGwuU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0VG9TdHJpbmcgPSB7XG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc4S2h6OEJpdE1vbm9NVUxhd106IFwicmF3LThraHotOGJpdC1tb25vLW11bGF3XCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMTZLaHoxNkticHNNb25vU2lyZW5dOiBcInJpZmYtMTZraHotMTZrYnBzLW1vbm8tc2lyZW5cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMTZLaHoxNkticHNNb25vU2lyZW5dOiBcImF1ZGlvLTE2a2h6LTE2a2Jwcy1tb25vLXNpcmVuXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MzJLQml0UmF0ZU1vbm9NcDNdOiBcImF1ZGlvLTE2a2h6LTMya2JpdHJhdGUtbW9uby1tcDNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMTZLaHoxMjhLQml0UmF0ZU1vbm9NcDNdOiBcImF1ZGlvLTE2a2h6LTEyOGtiaXRyYXRlLW1vbm8tbXAzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6NjRLQml0UmF0ZU1vbm9NcDNdOiBcImF1ZGlvLTE2a2h6LTY0a2JpdHJhdGUtbW9uby1tcDNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMjRLaHo0OEtCaXRSYXRlTW9ub01wM106IFwiYXVkaW8tMjRraHotNDhrYml0cmF0ZS1tb25vLW1wM1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejk2S0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby0yNGtoei05NmtiaXRyYXRlLW1vbm8tbXAzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6MTYwS0JpdFJhdGVNb25vTXAzXTogXCJhdWRpby0yNGtoei0xNjBrYml0cmF0ZS1tb25vLW1wM1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3MTZLaHoxNkJpdE1vbm9UcnVlU2lsa106IFwicmF3LTE2a2h6LTE2Yml0LW1vbm8tdHJ1ZXNpbGtcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmYxNktoejE2Qml0TW9ub1BjbV06IFwicmlmZi0xNmtoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjhLaHoxNkJpdE1vbm9QY21dOiBcInJpZmYtOGtoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjI0S2h6MTZCaXRNb25vUGNtXTogXCJyaWZmLTI0a2h6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmOEtoejhCaXRNb25vTVVMYXddOiBcInJpZmYtOGtoei04Yml0LW1vbm8tbXVsYXdcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzE2S2h6MTZCaXRNb25vUGNtXTogXCJyYXctMTZraHotMTZiaXQtbW9uby1wY21cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzI0S2h6MTZCaXRNb25vUGNtXTogXCJyYXctMjRraHotMTZiaXQtbW9uby1wY21cIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzhLaHoxNkJpdE1vbm9QY21dOiBcInJhdy04a2h6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5PZ2cxNktoejE2Qml0TW9ub09wdXNdOiBcIm9nZy0xNmtoei0xNmJpdC1tb25vLW9wdXNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0Lk9nZzI0S2h6MTZCaXRNb25vT3B1c106IFwib2dnLTI0a2h6LTE2Yml0LW1vbm8tb3B1c1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3NDhLaHoxNkJpdE1vbm9QY21dOiBcInJhdy00OGtoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjQ4S2h6MTZCaXRNb25vUGNtXTogXCJyaWZmLTQ4a2h6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzQ4S2h6OTZLQml0UmF0ZU1vbm9NcDNdOiBcImF1ZGlvLTQ4a2h6LTk2a2JpdHJhdGUtbW9uby1tcDNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvNDhLaHoxOTJLQml0UmF0ZU1vbm9NcDNdOiBcImF1ZGlvLTQ4a2h6LTE5MmtiaXRyYXRlLW1vbm8tbXAzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5PZ2c0OEtoejE2Qml0TW9ub09wdXNdOiBcIm9nZy00OGtoei0xNmJpdC1tb25vLW9wdXNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LldlYm0xNktoejE2Qml0TW9ub09wdXNdOiBcIndlYm0tMTZraHotMTZiaXQtbW9uby1vcHVzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5XZWJtMjRLaHoxNkJpdE1vbm9PcHVzXTogXCJ3ZWJtLTI0a2h6LTE2Yml0LW1vbm8tb3B1c1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuV2VibTI0S2h6MTZCaXQyNEticHNNb25vT3B1c106IFwid2VibS0yNGtoei0xNmJpdC0yNGticHMtbW9uby1vcHVzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcyNEtoejE2Qml0TW9ub1RydWVTaWxrXTogXCJyYXctMjRraHotMTZiaXQtbW9uby10cnVlc2lsa1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3OEtoejhCaXRNb25vQUxhd106IFwicmF3LThraHotOGJpdC1tb25vLWFsYXdcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmY4S2h6OEJpdE1vbm9BTGF3XTogXCJyaWZmLThraHotOGJpdC1tb25vLWFsYXdcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMTZLaHoxNkJpdDMyS2Jwc01vbm9PcHVzXTogXCJhdWRpby0xNmtoei0xNmJpdC0zMmticHMtbW9uby1vcHVzXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6MTZCaXQ0OEticHNNb25vT3B1c106IFwiYXVkaW8tMjRraHotMTZiaXQtNDhrYnBzLW1vbm8tb3B1c1wiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNdOiBcImF1ZGlvLTI0a2h6LTE2Yml0LTI0a2Jwcy1tb25vLW9wdXNcIixcbiAgICBbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzIyMDUwSHoxNkJpdE1vbm9QY21dOiBcInJhdy0yMjA1MGh6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMjIwNTBIejE2Qml0TW9ub1BjbV06IFwicmlmZi0yMjA1MGh6LTE2Yml0LW1vbm8tcGNtXCIsXG4gICAgW1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc0NDEwMEh6MTZCaXRNb25vUGNtXTogXCJyYXctNDQxMDBoei0xNmJpdC1tb25vLXBjbVwiLFxuICAgIFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjQ0MTAwSHoxNkJpdE1vbm9QY21dOiBcInJpZmYtNDQxMDBoei0xNmJpdC1tb25vLXBjbVwiLFxufTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXVkaW9PdXRwdXRGb3JtYXQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQsIFN0cmVhbSwgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbCB9IGZyb20gXCIuL0F1ZGlvT3V0cHV0Rm9ybWF0XCI7XG4vKipcbiAqIFJlcHJlc2VudHMgYXVkaW8gb3V0cHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gb3V0cHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQGNsYXNzIEF1ZGlvT3V0cHV0U3RyZWFtXG4gKi9cbmV4cG9ydCBjbGFzcyBBdWRpb091dHB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2UuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG1lbW9yeSBiYWNrZWQgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtIHdpdGggdGhlIHNwZWNpZmllZCBhdWRpbyBmb3JtYXQuXG4gICAgICogQG1lbWJlciBBdWRpb091dHB1dFN0cmVhbS5jcmVhdGVQdWxsU3RyZWFtXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQdWxsQXVkaW9PdXRwdXRTdHJlYW19IFRoZSBhdWRpbyBvdXRwdXQgc3RyZWFtIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZVB1bGxTdHJlYW0oKSB7XG4gICAgICAgIHJldHVybiBQdWxsQXVkaW9PdXRwdXRTdHJlYW0uY3JlYXRlKCk7XG4gICAgfVxufVxuLyoqXG4gKiBSZXByZXNlbnRzIG1lbW9yeSBiYWNrZWQgcHVzaCBhdWRpbyBvdXRwdXQgc3RyZWFtIHVzZWQgZm9yIGN1c3RvbSBhdWRpbyBvdXRwdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAY2xhc3MgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtXG4gKi9cbmV4cG9ydCBjbGFzcyBQdWxsQXVkaW9PdXRwdXRTdHJlYW0gZXh0ZW5kcyBBdWRpb091dHB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG1lbW9yeSBiYWNrZWQgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtIHdpdGggdGhlIHNwZWNpZmllZCBhdWRpbyBmb3JtYXQuXG4gICAgICogQG1lbWJlciBQdWxsQXVkaW9PdXRwdXRTdHJlYW0uY3JlYXRlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQdWxsQXVkaW9PdXRwdXRTdHJlYW19IFRoZSBwdXNoIGF1ZGlvIG91dHB1dCBzdHJlYW0gYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKCkge1xuICAgICAgICByZXR1cm4gbmV3IFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwoKTtcbiAgICB9XG59XG4vKipcbiAqIFJlcHJlc2VudHMgbWVtb3J5IGJhY2tlZCBwdXNoIGF1ZGlvIG91dHB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbFxuICovXG5leHBvcnQgY2xhc3MgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbCBleHRlbmRzIFB1bGxBdWRpb091dHB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugd2l0aCB0aGUgZ2l2ZW4gdmFsdWVzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnByaXZJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtID0gbmV3IFN0cmVhbSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24gdG8gdGhlIHN0cmVhbS4gRm9yIGludGVybmFsIHVzZSBvbmx5LlxuICAgICAqIEBwYXJhbSB7QXVkaW9TdHJlYW1Gb3JtYXR9IGZvcm1hdCAtIHRoZSBmb3JtYXQgdG8gYmUgc2V0LlxuICAgICAqL1xuICAgIHNldCBmb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgIGlmIChmb3JtYXQgPT09IHVuZGVmaW5lZCB8fCBmb3JtYXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkZvcm1hdCA9IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbC5nZXREZWZhdWx0T3V0cHV0Rm9ybWF0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Rm9ybWF0ID0gZm9ybWF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3JtYXQgaW5mb3JtYXRpb24gZm9yIHRoZSBhdWRpb1xuICAgICAqL1xuICAgIGdldCBmb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZGb3JtYXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgc3RyZWFtIGlzIGNsb3NlZFxuICAgICAqIEBtZW1iZXIgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbC5wcm90b3R5cGUuaXNDbG9zZWRcbiAgICAgKiBAcHJvcGVydHlcbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IGlzQ2xvc2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3RyZWFtLmlzQ2xvc2VkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBpZCBvZiB0aGUgc3RyZWFtXG4gICAgICogQG1lbWJlciBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsLnByb3RvdHlwZS5pZFxuICAgICAqIEBwcm9wZXJ0eVxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBhdWRpbyBkYXRhIGZyb20gdGhlIGludGVybmFsIGJ1ZmZlci5cbiAgICAgKiBAbWVtYmVyIFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwucHJvdG90eXBlLnJlYWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcn0gZGF0YUJ1ZmZlciAtIEFuIEFycmF5QnVmZmVyIHRvIHN0b3JlIHRoZSByZWFkIGRhdGEuXG4gICAgICogQHJldHVybnMge1Byb21pc2U8bnVtYmVyPn0gLSBBdWRpbyBidWZmZXIgbGVuZ3RoIGhhcyBiZWVuIHJlYWQuXG4gICAgICovXG4gICAgcmVhZChkYXRhQnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBpbnRWaWV3ID0gbmV3IEludDhBcnJheShkYXRhQnVmZmVyKTtcbiAgICAgICAgICAgIGxldCB0b3RhbEJ5dGVzID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZMYXN0Q2h1bmtWaWV3ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2TGFzdENodW5rVmlldy5sZW5ndGggPiBkYXRhQnVmZmVyLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaW50Vmlldy5zZXQodGhpcy5wcml2TGFzdENodW5rVmlldy5zbGljZSgwLCBkYXRhQnVmZmVyLmJ5dGVMZW5ndGgpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGFzdENodW5rVmlldyA9IHRoaXMucHJpdkxhc3RDaHVua1ZpZXcuc2xpY2UoZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkYXRhQnVmZmVyLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbnRWaWV3LnNldCh0aGlzLnByaXZMYXN0Q2h1bmtWaWV3KTtcbiAgICAgICAgICAgICAgICB0b3RhbEJ5dGVzID0gdGhpcy5wcml2TGFzdENodW5rVmlldy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TGFzdENodW5rVmlldyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFVudGlsIHdlIGhhdmUgdGhlIG1pbmltdW0gbnVtYmVyIG9mIGJ5dGVzIHRvIHNlbmQgaW4gYSB0cmFuc21pc3Npb24sIGtlZXAgYXNraW5nIGZvciBtb3JlLlxuICAgICAgICAgICAgd2hpbGUgKHRvdGFsQnl0ZXMgPCBkYXRhQnVmZmVyLmJ5dGVMZW5ndGggJiYgIXRoaXMucHJpdlN0cmVhbS5pc1JlYWRFbmRlZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNodW5rID0geWllbGQgdGhpcy5wcml2U3RyZWFtLnJlYWQoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsgIT09IHVuZGVmaW5lZCAmJiAhY2h1bmsuaXNFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRtcEJ1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNodW5rLmJ1ZmZlci5ieXRlTGVuZ3RoID4gZGF0YUJ1ZmZlci5ieXRlTGVuZ3RoIC0gdG90YWxCeXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG1wQnVmZmVyID0gY2h1bmsuYnVmZmVyLnNsaWNlKDAsIGRhdGFCdWZmZXIuYnl0ZUxlbmd0aCAtIHRvdGFsQnl0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2TGFzdENodW5rVmlldyA9IG5ldyBJbnQ4QXJyYXkoY2h1bmsuYnVmZmVyLnNsaWNlKGRhdGFCdWZmZXIuYnl0ZUxlbmd0aCAtIHRvdGFsQnl0ZXMpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRtcEJ1ZmZlciA9IGNodW5rLmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbnRWaWV3LnNldChuZXcgSW50OEFycmF5KHRtcEJ1ZmZlciksIHRvdGFsQnl0ZXMpO1xuICAgICAgICAgICAgICAgICAgICB0b3RhbEJ5dGVzICs9IHRtcEJ1ZmZlci5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3RyZWFtLnJlYWRFbmRlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0b3RhbEJ5dGVzO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIHRoZSBhdWRpbyBkYXRhIHNwZWNpZmllZCBieSBtYWtpbmcgYW4gaW50ZXJuYWwgY29weSBvZiB0aGUgZGF0YS5cbiAgICAgKiBAbWVtYmVyIFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwucHJvdG90eXBlLndyaXRlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJ9IGRhdGFCdWZmZXIgLSBUaGUgYXVkaW8gYnVmZmVyIG9mIHdoaWNoIHRoaXMgZnVuY3Rpb24gd2lsbCBtYWtlIGEgY29weS5cbiAgICAgKi9cbiAgICB3cml0ZShkYXRhQnVmZmVyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlN0cmVhbSwgXCJtdXN0IHNldCBmb3JtYXQgYmVmb3JlIHdyaXRpbmdcIik7XG4gICAgICAgIHRoaXMucHJpdlN0cmVhbS53cml0ZVN0cmVhbUNodW5rKHtcbiAgICAgICAgICAgIGJ1ZmZlcjogZGF0YUJ1ZmZlcixcbiAgICAgICAgICAgIGlzRW5kOiBmYWxzZSxcbiAgICAgICAgICAgIHRpbWVSZWNlaXZlZDogRGF0ZS5ub3coKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBzdHJlYW0uXG4gICAgICogQG1lbWJlciBQdWxsQXVkaW9PdXRwdXRTdHJlYW1JbXBsLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5wcml2U3RyZWFtLmNsb3NlKCk7XG4gICAgfVxufVxuLypcbiAqIFJlcHJlc2VudHMgYXVkaW8gb3V0cHV0IHN0cmVhbSB1c2VkIGZvciBjdXN0b20gYXVkaW8gb3V0cHV0IGNvbmZpZ3VyYXRpb25zLlxuICogQGNsYXNzIFB1c2hBdWRpb091dHB1dFN0cmVhbVxuICovXG5leHBvcnQgY2xhc3MgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtIGV4dGVuZHMgQXVkaW9PdXRwdXRTdHJlYW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuZCBpbnN0YW5jZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFB1c2hBdWRpb091dHB1dFN0cmVhbSB0aGF0IGRlbGVnYXRlcyB0byB0aGUgc3BlY2lmaWVkIGNhbGxiYWNrIGludGVyZmFjZSBmb3JcbiAgICAgKiB3cml0ZSgpIGFuZCBjbG9zZSgpIG1ldGhvZHMuXG4gICAgICogQG1lbWJlciBQdXNoQXVkaW9PdXRwdXRTdHJlYW0uY3JlYXRlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2t9IGNhbGxiYWNrIC0gVGhlIGN1c3RvbSBhdWRpbyBvdXRwdXQgb2JqZWN0LFxuICAgICAqIGRlcml2ZWQgZnJvbSBQdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFja1xuICAgICAqIEByZXR1cm5zIHtQdXNoQXVkaW9PdXRwdXRTdHJlYW19IFRoZSBwdXNoIGF1ZGlvIG91dHB1dCBzdHJlYW0gYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlKGNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtSW1wbChjYWxsYmFjayk7XG4gICAgfVxufVxuLyoqXG4gKiBSZXByZXNlbnRzIGF1ZGlvIG91dHB1dCBzdHJlYW0gdXNlZCBmb3IgY3VzdG9tIGF1ZGlvIG91dHB1dCBjb25maWd1cmF0aW9ucy5cbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtSW1wbFxuICovXG5leHBvcnQgY2xhc3MgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtSW1wbCBleHRlbmRzIFB1c2hBdWRpb091dHB1dFN0cmVhbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFB1c2hBdWRpb091dHB1dFN0cmVhbSB0aGF0IGRlbGVnYXRlcyB0byB0aGUgc3BlY2lmaWVkIGNhbGxiYWNrIGludGVyZmFjZSBmb3JcbiAgICAgKiByZWFkKCkgYW5kIGNsb3NlKCkgbWV0aG9kcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1B1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrfSBjYWxsYmFjayAtIFRoZSBjdXN0b20gYXVkaW8gb3V0cHV0IG9iamVjdCxcbiAgICAgKiBkZXJpdmVkIGZyb20gUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2tcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihjYWxsYmFjaykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnByaXZJZCA9IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2Q2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIHNldCBmb3JtYXQoZm9ybWF0KSB7IH1cbiAgICB3cml0ZShidWZmZXIpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcml2Q2FsbGJhY2sud3JpdGUpIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNhbGxiYWNrLndyaXRlKGJ1ZmZlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkNhbGxiYWNrLmNsb3NlKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZDYWxsYmFjay5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BdWRpb091dHB1dFN0cmVhbS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5leHBvcnQgdmFyIEF1ZGlvRm9ybWF0VGFnO1xuKGZ1bmN0aW9uIChBdWRpb0Zvcm1hdFRhZykge1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiUENNXCJdID0gMV0gPSBcIlBDTVwiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiTXVMYXdcIl0gPSAyXSA9IFwiTXVMYXdcIjtcbiAgICBBdWRpb0Zvcm1hdFRhZ1tBdWRpb0Zvcm1hdFRhZ1tcIlNpcmVuXCJdID0gM10gPSBcIlNpcmVuXCI7XG4gICAgQXVkaW9Gb3JtYXRUYWdbQXVkaW9Gb3JtYXRUYWdbXCJNUDNcIl0gPSA0XSA9IFwiTVAzXCI7XG4gICAgQXVkaW9Gb3JtYXRUYWdbQXVkaW9Gb3JtYXRUYWdbXCJTSUxLU2t5cGVcIl0gPSA1XSA9IFwiU0lMS1NreXBlXCI7XG4gICAgQXVkaW9Gb3JtYXRUYWdbQXVkaW9Gb3JtYXRUYWdbXCJPR0dfT1BVU1wiXSA9IDZdID0gXCJPR0dfT1BVU1wiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiV0VCTV9PUFVTXCJdID0gN10gPSBcIldFQk1fT1BVU1wiO1xuICAgIEF1ZGlvRm9ybWF0VGFnW0F1ZGlvRm9ybWF0VGFnW1wiQUxhd1wiXSA9IDhdID0gXCJBTGF3XCI7XG4gICAgQXVkaW9Gb3JtYXRUYWdbQXVkaW9Gb3JtYXRUYWdbXCJGTEFDXCJdID0gOV0gPSBcIkZMQUNcIjtcbiAgICBBdWRpb0Zvcm1hdFRhZ1tBdWRpb0Zvcm1hdFRhZ1tcIk9QVVNcIl0gPSAxMF0gPSBcIk9QVVNcIjtcbn0pKEF1ZGlvRm9ybWF0VGFnIHx8IChBdWRpb0Zvcm1hdFRhZyA9IHt9KSk7XG4vKipcbiAqIFJlcHJlc2VudHMgYXVkaW8gc3RyZWFtIGZvcm1hdCB1c2VkIGZvciBjdXN0b20gYXVkaW8gaW5wdXQgY29uZmlndXJhdGlvbnMuXG4gKiBAY2xhc3MgQXVkaW9TdHJlYW1Gb3JtYXRcbiAqL1xuZXhwb3J0IGNsYXNzIEF1ZGlvU3RyZWFtRm9ybWF0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGF1ZGlvIHN0cmVhbSBmb3JtYXQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgZGVmYXVsdCBhdWRpbyBzdHJlYW1cbiAgICAgKiBmb3JtYXQgKDE2S0h6IDE2Yml0IG1vbm8gUENNKS5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvU3RyZWFtRm9ybWF0LmdldERlZmF1bHRJbnB1dEZvcm1hdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7QXVkaW9TdHJlYW1Gb3JtYXR9IFRoZSBhdWRpbyBzdHJlYW0gZm9ybWF0IGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGdldERlZmF1bHRJbnB1dEZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbC5nZXREZWZhdWx0SW5wdXRGb3JtYXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhdWRpbyBzdHJlYW0gZm9ybWF0IG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgZm9ybWF0IGNoYXJhY3RlcmlzdGljcy5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvU3RyZWFtRm9ybWF0LmdldFdhdmVGb3JtYXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNhbXBsZXNQZXJTZWNvbmQgLSBTYW1wbGUgcmF0ZSwgaW4gc2FtcGxlcyBwZXIgc2Vjb25kIChIZXJ0eikuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdHNQZXJTYW1wbGUgLSBCaXRzIHBlciBzYW1wbGUsIHR5cGljYWxseSAxNi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2hhbm5lbHMgLSBOdW1iZXIgb2YgY2hhbm5lbHMgaW4gdGhlIHdhdmVmb3JtLWF1ZGlvIGRhdGEuIE1vbmF1cmFsIGRhdGFcbiAgICAgKiB1c2VzIG9uZSBjaGFubmVsIGFuZCBzdGVyZW8gZGF0YSB1c2VzIHR3byBjaGFubmVscy5cbiAgICAgKiBAcGFyYW0ge0F1ZGlvRm9ybWF0VGFnfSBmb3JtYXQgLSBBdWRpbyBmb3JtYXQgKFBDTSwgYWxhdyBvciBtdWxhdykuXG4gICAgICogQHJldHVybnMge0F1ZGlvU3RyZWFtRm9ybWF0fSBUaGUgYXVkaW8gc3RyZWFtIGZvcm1hdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRXYXZlRm9ybWF0KHNhbXBsZXNQZXJTZWNvbmQsIGJpdHNQZXJTYW1wbGUsIGNoYW5uZWxzLCBmb3JtYXQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdWRpb1N0cmVhbUZvcm1hdEltcGwoc2FtcGxlc1BlclNlY29uZCwgYml0c1BlclNhbXBsZSwgY2hhbm5lbHMsIGZvcm1hdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXVkaW8gc3RyZWFtIGZvcm1hdCBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIHBjbSB3YXZlZm9ybWF0IGNoYXJhY3RlcmlzdGljcy5cbiAgICAgKiBAbWVtYmVyIEF1ZGlvU3RyZWFtRm9ybWF0LmdldFdhdmVGb3JtYXRQQ01cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNhbXBsZXNQZXJTZWNvbmQgLSBTYW1wbGUgcmF0ZSwgaW4gc2FtcGxlcyBwZXIgc2Vjb25kIChIZXJ0eikuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdHNQZXJTYW1wbGUgLSBCaXRzIHBlciBzYW1wbGUsIHR5cGljYWxseSAxNi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2hhbm5lbHMgLSBOdW1iZXIgb2YgY2hhbm5lbHMgaW4gdGhlIHdhdmVmb3JtLWF1ZGlvIGRhdGEuIE1vbmF1cmFsIGRhdGFcbiAgICAgKiB1c2VzIG9uZSBjaGFubmVsIGFuZCBzdGVyZW8gZGF0YSB1c2VzIHR3byBjaGFubmVscy5cbiAgICAgKiBAcmV0dXJucyB7QXVkaW9TdHJlYW1Gb3JtYXR9IFRoZSBhdWRpbyBzdHJlYW0gZm9ybWF0IGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGdldFdhdmVGb3JtYXRQQ00oc2FtcGxlc1BlclNlY29uZCwgYml0c1BlclNhbXBsZSwgY2hhbm5lbHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdWRpb1N0cmVhbUZvcm1hdEltcGwoc2FtcGxlc1BlclNlY29uZCwgYml0c1BlclNhbXBsZSwgY2hhbm5lbHMpO1xuICAgIH1cbn1cbi8qKlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBBdWRpb1N0cmVhbUZvcm1hdEltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIEF1ZGlvU3RyZWFtRm9ybWF0SW1wbCBleHRlbmRzIEF1ZGlvU3RyZWFtRm9ybWF0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIHdpdGggdGhlIGdpdmVuIHZhbHVlcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2FtcGxlc1BlclNlYyAtIFNhbXBsZXMgcGVyIHNlY29uZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0c1BlclNhbXBsZSAtIEJpdHMgcGVyIHNhbXBsZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2hhbm5lbHMgLSBOdW1iZXIgb2YgY2hhbm5lbHMuXG4gICAgICogQHBhcmFtIHtBdWRpb0Zvcm1hdFRhZ30gZm9ybWF0IC0gQXVkaW8gZm9ybWF0IChQQ00sIGFsYXcgb3IgbXVsYXcpLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNhbXBsZXNQZXJTZWMgPSAxNjAwMCwgYml0c1BlclNhbXBsZSA9IDE2LCBjaGFubmVscyA9IDEsIGZvcm1hdCA9IEF1ZGlvRm9ybWF0VGFnLlBDTSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBsZXQgaXNXYXZGb3JtYXQgPSB0cnVlO1xuICAgICAgICAvKiAxIGZvciBQQ007IDYgZm9yIGFsYXc7IDcgZm9yIG11bGF3ICovXG4gICAgICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICAgICAgICBjYXNlIEF1ZGlvRm9ybWF0VGFnLlBDTTpcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdFRhZyA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEF1ZGlvRm9ybWF0VGFnLkFMYXc6XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXRUYWcgPSA2O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBBdWRpb0Zvcm1hdFRhZy5NdUxhdzpcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdFRhZyA9IDc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGlzV2F2Rm9ybWF0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5iaXRzUGVyU2FtcGxlID0gYml0c1BlclNhbXBsZTtcbiAgICAgICAgdGhpcy5zYW1wbGVzUGVyU2VjID0gc2FtcGxlc1BlclNlYztcbiAgICAgICAgdGhpcy5jaGFubmVscyA9IGNoYW5uZWxzO1xuICAgICAgICB0aGlzLmF2Z0J5dGVzUGVyU2VjID0gdGhpcy5zYW1wbGVzUGVyU2VjICogdGhpcy5jaGFubmVscyAqICh0aGlzLmJpdHNQZXJTYW1wbGUgLyA4KTtcbiAgICAgICAgdGhpcy5ibG9ja0FsaWduID0gdGhpcy5jaGFubmVscyAqIE1hdGgubWF4KHRoaXMuYml0c1BlclNhbXBsZSwgOCk7XG4gICAgICAgIGlmIChpc1dhdkZvcm1hdCkge1xuICAgICAgICAgICAgdGhpcy5wcml2SGVhZGVyID0gbmV3IEFycmF5QnVmZmVyKDQ0KTtcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0RhdGFWaWV3XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KHRoaXMucHJpdkhlYWRlcik7XG4gICAgICAgICAgICAvKiBSSUZGIGlkZW50aWZpZXIgKi9cbiAgICAgICAgICAgIHRoaXMuc2V0U3RyaW5nKHZpZXcsIDAsIFwiUklGRlwiKTtcbiAgICAgICAgICAgIC8qIGZpbGUgbGVuZ3RoICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQzMig0LCAwLCB0cnVlKTtcbiAgICAgICAgICAgIC8qIFJJRkYgdHlwZSAmIEZvcm1hdCAqL1xuICAgICAgICAgICAgdGhpcy5zZXRTdHJpbmcodmlldywgOCwgXCJXQVZFZm10IFwiKTtcbiAgICAgICAgICAgIC8qIGZvcm1hdCBjaHVuayBsZW5ndGggKi9cbiAgICAgICAgICAgIHZpZXcuc2V0VWludDMyKDE2LCAxNiwgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBhdWRpbyBmb3JtYXQgKi9cbiAgICAgICAgICAgIHZpZXcuc2V0VWludDE2KDIwLCB0aGlzLmZvcm1hdFRhZywgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBjaGFubmVsIGNvdW50ICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQxNigyMiwgdGhpcy5jaGFubmVscywgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBzYW1wbGUgcmF0ZSAqL1xuICAgICAgICAgICAgdmlldy5zZXRVaW50MzIoMjQsIHRoaXMuc2FtcGxlc1BlclNlYywgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBieXRlIHJhdGUgKHNhbXBsZSByYXRlICogYmxvY2sgYWxpZ24pICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQzMigyOCwgdGhpcy5hdmdCeXRlc1BlclNlYywgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBibG9jayBhbGlnbiAoY2hhbm5lbCBjb3VudCAqIGJ5dGVzIHBlciBzYW1wbGUpICovXG4gICAgICAgICAgICB2aWV3LnNldFVpbnQxNigzMiwgdGhpcy5jaGFubmVscyAqICh0aGlzLmJpdHNQZXJTYW1wbGUgLyA4KSwgdHJ1ZSk7XG4gICAgICAgICAgICAvKiBiaXRzIHBlciBzYW1wbGUgKi9cbiAgICAgICAgICAgIHZpZXcuc2V0VWludDE2KDM0LCB0aGlzLmJpdHNQZXJTYW1wbGUsIHRydWUpO1xuICAgICAgICAgICAgLyogZGF0YSBjaHVuayBpZGVudGlmaWVyICovXG4gICAgICAgICAgICB0aGlzLnNldFN0cmluZyh2aWV3LCAzNiwgXCJkYXRhXCIpO1xuICAgICAgICAgICAgLyogZGF0YSBjaHVuayBsZW5ndGggKi9cbiAgICAgICAgICAgIHZpZXcuc2V0VWludDMyKDQwLCAwLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgdGhlIGRlZmF1bHQgaW5wdXQgZm9ybWF0LlxuICAgICAqIEBtZW1iZXIgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsLmdldERlZmF1bHRJbnB1dEZvcm1hdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7QXVkaW9TdHJlYW1Gb3JtYXRJbXBsfSBUaGUgZGVmYXVsdCBpbnB1dCBmb3JtYXQuXG4gICAgICovXG4gICAgc3RhdGljIGdldERlZmF1bHRJbnB1dEZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdWRpb1N0cmVhbUZvcm1hdEltcGwoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhdWRpbyBjb250ZXh0IGFwcHJvcHJpYXRlIHRvIGN1cnJlbnQgYnJvd3NlclxuICAgICAqIEBtZW1iZXIgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsLmdldEF1ZGlvQ29udGV4dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7QXVkaW9Db250ZXh0fSBBbiBhdWRpbyBjb250ZXh0IGluc3RhbmNlXG4gICAgICovXG4gICAgLyogZXNsaW50LWRpc2FibGUgKi9cbiAgICBzdGF0aWMgZ2V0QXVkaW9Db250ZXh0KHNhbXBsZVJhdGUpIHtcbiAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgU3BlZWNoIFNESyBidWcgaW4gU2FmYXJpLlxuICAgICAgICBjb25zdCBBdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IC8vIG91ciBwcmVmZXJyZWQgaW1wbFxuICAgICAgICAgICAgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dCAvLyBmYWxsYmFjaywgbW9zdGx5IHdoZW4gb24gU2FmYXJpXG4gICAgICAgICAgICB8fCBmYWxzZTsgLy8gY291bGQgbm90IGZpbmQuXG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9BdWRpb0NvbnRleHRcbiAgICAgICAgaWYgKCEhQXVkaW9Db250ZXh0KSB7XG4gICAgICAgICAgICBpZiAoc2FtcGxlUmF0ZSAhPT0gdW5kZWZpbmVkICYmIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0U3VwcG9ydGVkQ29uc3RyYWludHMoKS5zYW1wbGVSYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb0NvbnRleHQoeyBzYW1wbGVSYXRlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBXZWIgQXVkaW8gQVBJIChBdWRpb0NvbnRleHQgaXMgbm90IGF2YWlsYWJsZSkuXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qIGVzbGludC1lbmFibGUgKi9cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0LlxuICAgICAqIEBtZW1iZXIgQXVkaW9TdHJlYW1Gb3JtYXRJbXBsLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBnZXQgaGVhZGVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SGVhZGVyO1xuICAgIH1cbiAgICBzZXRTdHJpbmcodmlldywgb2Zmc2V0LCBzdHIpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0ICsgaSwgc3RyLmNoYXJDb2RlQXQoaSkpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BdWRpb1N0cmVhbUZvcm1hdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBJbnZhbGlkT3BlcmF0aW9uRXJyb3IgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0Vycm9yXCI7XG5pbXBvcnQgeyBBdWRpb1N0cmVhbUZvcm1hdCB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb1N0cmVhbUZvcm1hdEltcGwgfSBmcm9tIFwiLi9BdWRpb1N0cmVhbUZvcm1hdFwiO1xuLyoqXG4gKiBCYXNlIGF1ZGlvIHBsYXllciBjbGFzc1xuICogVE9ETzogUGxheXMgb25seSBQQ00gZm9yIG5vdy5cbiAqIEBjbGFzc1xuICovXG5leHBvcnQgY2xhc3MgQmFzZUF1ZGlvUGxheWVyIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXVkaW9TdHJlYW1Gb3JtYXR9IGF1ZGlvRm9ybWF0IGF1ZGlvIHN0cmVhbSBmb3JtYXQgcmVjb2duaXplZCBieSB0aGUgcGxheWVyLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvRm9ybWF0KSB7XG4gICAgICAgIHRoaXMuYXVkaW9Db250ZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5nYWluTm9kZSA9IG51bGw7XG4gICAgICAgIHRoaXMuYXV0b1VwZGF0ZUJ1ZmZlclRpbWVyID0gMDtcbiAgICAgICAgaWYgKGF1ZGlvRm9ybWF0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGF1ZGlvRm9ybWF0ID0gQXVkaW9TdHJlYW1Gb3JtYXQuZ2V0RGVmYXVsdElucHV0Rm9ybWF0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0KGF1ZGlvRm9ybWF0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogcGxheSBBdWRpbyBzYW1wbGVcbiAgICAgKiBAcGFyYW0gbmV3QXVkaW9EYXRhIGF1ZGlvIGRhdGEgdG8gYmUgcGxheWVkLlxuICAgICAqL1xuICAgIHBsYXlBdWRpb1NhbXBsZShuZXdBdWRpb0RhdGEsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWRDb250ZXh0KCk7XG4gICAgICAgICAgICBjb25zdCBhdWRpb0RhdGEgPSB0aGlzLmZvcm1hdEF1ZGlvRGF0YShuZXdBdWRpb0RhdGEpO1xuICAgICAgICAgICAgY29uc3QgbmV3U2FtcGxlc0RhdGEgPSBuZXcgRmxvYXQzMkFycmF5KHRoaXMuc2FtcGxlcy5sZW5ndGggKyBhdWRpb0RhdGEubGVuZ3RoKTtcbiAgICAgICAgICAgIG5ld1NhbXBsZXNEYXRhLnNldCh0aGlzLnNhbXBsZXMsIDApO1xuICAgICAgICAgICAgbmV3U2FtcGxlc0RhdGEuc2V0KGF1ZGlvRGF0YSwgdGhpcy5zYW1wbGVzLmxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnNhbXBsZXMgPSBuZXdTYW1wbGVzRGF0YTtcbiAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgZXJyKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIHN0b3BzIGF1ZGlvIGFuZCBjbGVhcnMgdGhlIGJ1ZmZlcnNcbiAgICAgKi9cbiAgICBzdG9wQXVkaW8oY2IsIGVycikge1xuICAgICAgICBpZiAodGhpcy5hdWRpb0NvbnRleHQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuc2FtcGxlcyA9IG5ldyBGbG9hdDMyQXJyYXkoKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYXV0b1VwZGF0ZUJ1ZmZlclRpbWVyKTtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9Db250ZXh0LmNsb3NlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuYXVkaW9Db250ZXh0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbml0KGF1ZGlvRm9ybWF0KSB7XG4gICAgICAgIHRoaXMuYXVkaW9Gb3JtYXQgPSBhdWRpb0Zvcm1hdDtcbiAgICAgICAgdGhpcy5zYW1wbGVzID0gbmV3IEZsb2F0MzJBcnJheSgpO1xuICAgIH1cbiAgICBlbnN1cmVJbml0aWFsaXplZENvbnRleHQoKSB7XG4gICAgICAgIGlmICh0aGlzLmF1ZGlvQ29udGV4dCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVBdWRpb0NvbnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyUGVyaW9kID0gMjAwO1xuICAgICAgICAgICAgdGhpcy5hdXRvVXBkYXRlQnVmZmVyVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBdWRpb0J1ZmZlcigpO1xuICAgICAgICAgICAgfSwgdGltZXJQZXJpb2QpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNyZWF0ZUF1ZGlvQ29udGV4dCgpIHtcbiAgICAgICAgLy8gbmV3ICgod2luZG93IGFzIGFueSkuQXVkaW9Db250ZXh0IHx8ICh3aW5kb3cgYXMgYW55KS53ZWJraXRBdWRpb0NvbnRleHQpKCk7XG4gICAgICAgIHRoaXMuYXVkaW9Db250ZXh0ID0gQXVkaW9TdHJlYW1Gb3JtYXRJbXBsLmdldEF1ZGlvQ29udGV4dCgpO1xuICAgICAgICAvLyBUT0RPOiBWYXJpb3VzIGV4YW1wbGVzIHNob3dzIHRoaXMgZ2FpbiBub2RlLCBpdCBkb2VzIG5vdCBzZWVtIHRvIGJlIG5lZWRlZCB1bmxlc3Mgd2UgcGxhblxuICAgICAgICAvLyB0byBjb250cm9sIHRoZSB2b2x1bWUsIG5vdCBsaWtlbHlcbiAgICAgICAgdGhpcy5nYWluTm9kZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUdhaW4oKTtcbiAgICAgICAgdGhpcy5nYWluTm9kZS5nYWluLnZhbHVlID0gMTtcbiAgICAgICAgdGhpcy5nYWluTm9kZS5jb25uZWN0KHRoaXMuYXVkaW9Db250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLmF1ZGlvQ29udGV4dC5jdXJyZW50VGltZTtcbiAgICB9XG4gICAgZm9ybWF0QXVkaW9EYXRhKGF1ZGlvRGF0YSkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuYXVkaW9Gb3JtYXQuYml0c1BlclNhbXBsZSkge1xuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcm1hdEFycmF5QnVmZmVyKG5ldyBJbnQ4QXJyYXkoYXVkaW9EYXRhKSwgMTI4KTtcbiAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0QXJyYXlCdWZmZXIobmV3IEludDE2QXJyYXkoYXVkaW9EYXRhKSwgMzI3NjgpO1xuICAgICAgICAgICAgY2FzZSAzMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXRBcnJheUJ1ZmZlcihuZXcgSW50MzJBcnJheShhdWRpb0RhdGEpLCAyMTQ3NDgzNjQ4KTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FcnJvcihcIk9ubHkgV0FWRV9GT1JNQVRfUENNICg4LzE2LzMyIGJwcykgZm9ybWF0IHN1cHBvcnRlZCBhdCB0aGlzIHRpbWVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9ybWF0QXJyYXlCdWZmZXIoYXVkaW9EYXRhLCBtYXhWYWx1ZSkge1xuICAgICAgICBjb25zdCBmbG9hdDMyRGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoYXVkaW9EYXRhLmxlbmd0aCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXVkaW9EYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmbG9hdDMyRGF0YVtpXSA9IGF1ZGlvRGF0YVtpXSAvIG1heFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmbG9hdDMyRGF0YTtcbiAgICB9XG4gICAgdXBkYXRlQXVkaW9CdWZmZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnNhbXBsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2hhbm5lbENvdW50ID0gdGhpcy5hdWRpb0Zvcm1hdC5jaGFubmVscztcbiAgICAgICAgY29uc3QgYnVmZmVyU291cmNlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgIGNvbnN0IGZyYW1lQ291bnQgPSB0aGlzLnNhbXBsZXMubGVuZ3RoIC8gY2hhbm5lbENvdW50O1xuICAgICAgICBjb25zdCBhdWRpb0J1ZmZlciA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlcihjaGFubmVsQ291bnQsIGZyYW1lQ291bnQsIHRoaXMuYXVkaW9Gb3JtYXQuc2FtcGxlc1BlclNlYyk7XG4gICAgICAgIC8vIFRPRE86IFNob3VsZCB3ZSBkbyB0aGUgY29udmVyc2lvbiBpbiB0aGUgcHVzaEF1ZGlvU2FtcGxlIGluc3RlYWQ/XG4gICAgICAgIGZvciAobGV0IGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgY2hhbm5lbENvdW50OyBjaGFubmVsKyspIHtcbiAgICAgICAgICAgIC8vIEZpbGwgaW4gaW5kaXZpZHVhbCBjaGFubmVsIGRhdGFcbiAgICAgICAgICAgIGxldCBjaGFubmVsT2Zmc2V0ID0gY2hhbm5lbDtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvRGF0YSA9IGF1ZGlvQnVmZmVyLmdldENoYW5uZWxEYXRhKGNoYW5uZWwpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNhbXBsZXMubGVuZ3RoOyBpKyssIGNoYW5uZWxPZmZzZXQgKz0gY2hhbm5lbENvdW50KSB7XG4gICAgICAgICAgICAgICAgYXVkaW9EYXRhW2ldID0gdGhpcy5zYW1wbGVzW2NoYW5uZWxPZmZzZXRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0VGltZSA8IHRoaXMuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IHRoaXMuYXVkaW9Db250ZXh0LmN1cnJlbnRUaW1lO1xuICAgICAgICB9XG4gICAgICAgIGJ1ZmZlclNvdXJjZS5idWZmZXIgPSBhdWRpb0J1ZmZlcjtcbiAgICAgICAgYnVmZmVyU291cmNlLmNvbm5lY3QodGhpcy5nYWluTm9kZSk7XG4gICAgICAgIGJ1ZmZlclNvdXJjZS5zdGFydCh0aGlzLnN0YXJ0VGltZSk7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB3ZSBwbGF5IHRoZSBuZXh0IHNhbXBsZSBhZnRlciB0aGUgY3VycmVudCBvbmUuXG4gICAgICAgIHRoaXMuc3RhcnRUaW1lICs9IGF1ZGlvQnVmZmVyLmR1cmF0aW9uO1xuICAgICAgICAvLyBDbGVhciB0aGUgc2FtcGxlcyBmb3IgdGhlIG5leHQgcHVzaGVkIGRhdGEuXG4gICAgICAgIHRoaXMuc2FtcGxlcyA9IG5ldyBGbG9hdDMyQXJyYXkoKTtcbiAgICB9XG4gICAgcGxheUF1ZGlvKGF1ZGlvRGF0YSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYXVkaW9Db250ZXh0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVBdWRpb0NvbnRleHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb24gPSB0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbjtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShhdWRpb0RhdGEsIChuZXdCdWZmZXIpID0+IHtcbiAgICAgICAgICAgICAgICBzb3VyY2UuYnVmZmVyID0gbmV3QnVmZmVyO1xuICAgICAgICAgICAgICAgIHNvdXJjZS5jb25uZWN0KGRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICBzb3VyY2Uuc3RhcnQoMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1CYXNlQXVkaW9QbGF5ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQW4gYWJzdHJhY3QgYmFzZSBjbGFzcyB0aGF0IGRlZmluZXMgY2FsbGJhY2sgbWV0aG9kcyAocmVhZCgpIGFuZCBjbG9zZSgpKSBmb3JcbiAqIGN1c3RvbSBhdWRpbyBpbnB1dCBzdHJlYW1zKS5cbiAqIEBjbGFzcyBQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrXG4gKi9cbmV4cG9ydCBjbGFzcyBQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrIHtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFjay5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBBbiBhYnN0cmFjdCBiYXNlIGNsYXNzIHRoYXQgZGVmaW5lcyBjYWxsYmFjayBtZXRob2RzICh3cml0ZSgpIGFuZCBjbG9zZSgpKSBmb3JcbiAqIGN1c3RvbSBhdWRpbyBvdXRwdXQgc3RyZWFtcykuXG4gKiBAY2xhc3MgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2tcbiAqL1xuZXhwb3J0IGNsYXNzIFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrIHtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2suanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgU3ludGhlc2lzQWRhcHRlckJhc2UgfSBmcm9tIFwiLi4vLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBCYWNrZ3JvdW5kRXZlbnQsIGNyZWF0ZU5vRGFzaEd1aWQsIEV2ZW50cyB9IGZyb20gXCIuLi8uLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtSW1wbCB9IGZyb20gXCIuL0F1ZGlvT3V0cHV0U3RyZWFtXCI7XG5pbXBvcnQgeyBBdWRpb0Zvcm1hdFRhZyB9IGZyb20gXCIuL0F1ZGlvU3RyZWFtRm9ybWF0XCI7XG5jb25zdCBNZWRpYUR1cmF0aW9uUGxhY2Vob2xkZXJTZWNvbmRzID0gNjAgKiAzMDtcbmNvbnN0IEF1ZGlvRm9ybWF0VG9NaW1lVHlwZSA9IHtcbiAgICBbQXVkaW9Gb3JtYXRUYWcuUENNXTogXCJhdWRpby93YXZcIixcbiAgICBbQXVkaW9Gb3JtYXRUYWcuTXVMYXddOiBcImF1ZGlvL3gtd2F2XCIsXG4gICAgW0F1ZGlvRm9ybWF0VGFnLk1QM106IFwiYXVkaW8vbXBlZ1wiLFxuICAgIFtBdWRpb0Zvcm1hdFRhZy5PR0dfT1BVU106IFwiYXVkaW8vb2dnXCIsXG4gICAgW0F1ZGlvRm9ybWF0VGFnLldFQk1fT1BVU106IFwiYXVkaW8vd2VibTsgY29kZWNzPW9wdXNcIixcbiAgICBbQXVkaW9Gb3JtYXRUYWcuQUxhd106IFwiYXVkaW8veC13YXZcIixcbiAgICBbQXVkaW9Gb3JtYXRUYWcuRkxBQ106IFwiYXVkaW8vZmxhY1wiLFxufTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgc3BlYWtlciBwbGF5YmFjayBhdWRpbyBkZXN0aW5hdGlvbiwgd2hpY2ggb25seSB3b3JrcyBpbiBicm93c2VyLlxuICogTm90ZTogdGhlIFNESyB3aWxsIHRyeSB0byB1c2UgPGEgaHJlZj1cImh0dHBzOi8vd3d3LnczLm9yZy9UUi9tZWRpYS1zb3VyY2UvXCI+TWVkaWEgU291cmNlIEV4dGVuc2lvbnM8L2E+IHRvIHBsYXkgYXVkaW8uXG4gKiBNcDMgZm9ybWF0IGhhcyBiZXR0ZXIgc3VwcG9ydHMgb24gTWljcm9zb2Z0IEVkZ2UsIENocm9tZSBhbmQgU2FmYXJpIChkZXNrdG9wKSwgc28sIGl0J3MgYmV0dGVyIHRvIHNwZWNpZnkgbXAzIGZvcm1hdCBmb3IgcGxheWJhY2suXG4gKiBAY2xhc3MgU3BlYWtlckF1ZGlvRGVzdGluYXRpb25cbiAqIFVwZGF0ZWQgaW4gdmVyc2lvbiAxLjE3LjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWFrZXJBdWRpb0Rlc3RpbmF0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihhdWRpb0Rlc3RpbmF0aW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2UGxheWJhY2tTdGFydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkFwcGVuZGluZ1RvQnVmZmVyID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdk1lZGlhU291cmNlT3BlbmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQgPSAwO1xuICAgICAgICB0aGlzLnByaXZJZCA9IGF1ZGlvRGVzdGluYXRpb25JZCA/IGF1ZGlvRGVzdGluYXRpb25JZCA6IGNyZWF0ZU5vRGFzaEd1aWQoKTtcbiAgICAgICAgdGhpcy5wcml2SXNQYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNDbG9zZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJZDtcbiAgICB9XG4gICAgd3JpdGUoYnVmZmVyLCBjYiwgZXJyKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZBdWRpb0J1ZmZlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpb0J1ZmZlci5wdXNoKGJ1ZmZlcik7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNvdXJjZUJ1ZmZlcigpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5wcml2QXVkaW9PdXRwdXRTdHJlYW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9PdXRwdXRTdHJlYW0ud3JpdGUoYnVmZmVyKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQgKz0gYnVmZmVyLmJ5dGVMZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xvc2UoY2IsIGVycikge1xuICAgICAgICB0aGlzLnByaXZJc0Nsb3NlZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnByaXZTb3VyY2VCdWZmZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVTb3VyY2VCdWZmZXJVcGRhdGVFbmQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgaWYgKCh0aGlzLnByaXZGb3JtYXQuZm9ybWF0VGFnID09PSBBdWRpb0Zvcm1hdFRhZy5QQ00gfHwgdGhpcy5wcml2Rm9ybWF0LmZvcm1hdFRhZyA9PT0gQXVkaW9Gb3JtYXRUYWcuTXVMYXdcbiAgICAgICAgICAgICAgICB8fCB0aGlzLnByaXZGb3JtYXQuZm9ybWF0VGFnID09PSBBdWRpb0Zvcm1hdFRhZy5BTGF3KSAmJiB0aGlzLnByaXZGb3JtYXQuaGFzSGVhZGVyID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiUGxheSBiYWNrIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHJhdyBQQ00sIG11bGF3IG9yIGFsYXcgZm9ybWF0IHdpdGhvdXQgaGVhZGVyLlwiKTtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLm9uQXVkaW9FbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkF1ZGlvRW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCByZWNlaXZlZEF1ZGlvID0gbmV3IEFycmF5QnVmZmVyKHRoaXMucHJpdkJ5dGVzUmVjZWl2ZWQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtLnJlYWQocmVjZWl2ZWRBdWRpbykudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVkQXVkaW8gPSBTeW50aGVzaXNBZGFwdGVyQmFzZS5hZGRIZWFkZXIocmVjZWl2ZWRBdWRpbywgdGhpcy5wcml2Rm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW9CbG9iID0gbmV3IEJsb2IoW3JlY2VpdmVkQXVkaW9dLCB7IHR5cGU6IEF1ZGlvRm9ybWF0VG9NaW1lVHlwZVt0aGlzLnByaXZGb3JtYXQuZm9ybWF0VGFnXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8uc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYXVkaW9CbG9iKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlQbGF5YmFjaygpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIHVuc3VwcG9ydGVkIGZvcm1hdCwgY2FsbCBvbkF1ZGlvRW5kIGRpcmVjdGx5LlxuICAgICAgICAgICAgaWYgKCEhdGhpcy5vbkF1ZGlvRW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkF1ZGlvRW5kKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHNldCBmb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3NcbiAgICAgICAgaWYgKHR5cGVvZiAoQXVkaW9Db250ZXh0KSAhPT0gXCJ1bmRlZmluZWRcIiB8fCAodHlwZW9mICh3aW5kb3cpICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiAod2luZG93LndlYmtpdEF1ZGlvQ29udGV4dCkgIT09IFwidW5kZWZpbmVkXCIpKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZGb3JtYXQgPSBmb3JtYXQ7XG4gICAgICAgICAgICBjb25zdCBtaW1lVHlwZSA9IEF1ZGlvRm9ybWF0VG9NaW1lVHlwZVt0aGlzLnByaXZGb3JtYXQuZm9ybWF0VGFnXTtcbiAgICAgICAgICAgIGlmIChtaW1lVHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVua25vd24gbWltZVR5cGUgZm9yIGZvcm1hdCAke0F1ZGlvRm9ybWF0VGFnW3RoaXMucHJpdkZvcm1hdC5mb3JtYXRUYWddfTsgcGxheWJhY2sgaXMgbm90IHN1cHBvcnRlZC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiAoTWVkaWFTb3VyY2UpICE9PSBcInVuZGVmaW5lZFwiICYmIE1lZGlhU291cmNlLmlzVHlwZVN1cHBvcnRlZChtaW1lVHlwZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpbyA9IG5ldyBBdWRpbygpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvQnVmZmVyID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFTb3VyY2UgPSBuZXcgTWVkaWFTb3VyY2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpby5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHRoaXMucHJpdk1lZGlhU291cmNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpby5sb2FkKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TWVkaWFTb3VyY2Uub25zb3VyY2VvcGVuID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVNvdXJjZU9wZW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdk1lZGlhU291cmNlLmR1cmF0aW9uID0gTWVkaWFEdXJhdGlvblBsYWNlaG9sZGVyU2Vjb25kcztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U291cmNlQnVmZmVyID0gdGhpcy5wcml2TWVkaWFTb3VyY2UuYWRkU291cmNlQnVmZmVyKG1pbWVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U291cmNlQnVmZmVyLm9udXBkYXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTb3VyY2VCdWZmZXIoKS5jYXRjaCgocmVhc29uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRzLmluc3RhbmNlLm9uRXZlbnQobmV3IEJhY2tncm91bmRFdmVudChyZWFzb24pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTb3VyY2VCdWZmZXIub251cGRhdGVlbmQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCgpLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChuZXcgQmFja2dyb3VuZEV2ZW50KHJlYXNvbikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNvdXJjZUJ1ZmZlci5vbnVwZGF0ZXN0YXJ0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2QXBwZW5kaW5nVG9CdWZmZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU291cmNlQnVmZmVyKCkuY2F0Y2goKHJlYXNvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBFdmVudHMuaW5zdGFuY2Uub25FdmVudChuZXcgQmFja2dyb3VuZEV2ZW50KHJlYXNvbikpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYEZvcm1hdCAke0F1ZGlvRm9ybWF0VGFnW3RoaXMucHJpdkZvcm1hdC5mb3JtYXRUYWddfSBjb3VsZCBub3QgYmUgcGxheWVkIGJ5IE1TRSwgc3RyZWFtaW5nIHBsYXliYWNrIGlzIG5vdCBlbmFibGVkLmApO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvT3V0cHV0U3RyZWFtID0gbmV3IFB1bGxBdWRpb091dHB1dFN0cmVhbUltcGwoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb091dHB1dFN0cmVhbS5mb3JtYXQgPSB0aGlzLnByaXZGb3JtYXQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8gPSBuZXcgQXVkaW8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgdm9sdW1lKCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICByZXR1cm4gKF9iID0gKF9hID0gdGhpcy5wcml2QXVkaW8pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS52b2x1bWUpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IC0xO1xuICAgIH1cbiAgICBzZXQgdm9sdW1lKHZvbHVtZSkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZBdWRpbykge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8udm9sdW1lID0gdm9sdW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIG11dGUoKSB7XG4gICAgICAgIGlmICghIXRoaXMucHJpdkF1ZGlvKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZBdWRpby5tdXRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5tdXRlKCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZBdWRpbykge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8ubXV0ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgaXNDbG9zZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJc0Nsb3NlZDtcbiAgICB9XG4gICAgZ2V0IGN1cnJlbnRUaW1lKCkge1xuICAgICAgICBpZiAodGhpcy5wcml2QXVkaW8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvLmN1cnJlbnRUaW1lO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcGF1c2UoKSB7XG4gICAgICAgIGlmICghdGhpcy5wcml2SXNQYXVzZWQgJiYgdGhpcy5wcml2QXVkaW8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8ucGF1c2UoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdklzUGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXN1bWUoY2IsIGVycikge1xuICAgICAgICBpZiAodGhpcy5wcml2SXNQYXVzZWQgJiYgdGhpcy5wcml2QXVkaW8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5wcml2QXVkaW8ucGxheSgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnByaXZJc1BhdXNlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBpbnRlcm5hbEF1ZGlvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW87XG4gICAgfVxuICAgIHVwZGF0ZVNvdXJjZUJ1ZmZlcigpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZBdWRpb0J1ZmZlciAhPT0gdW5kZWZpbmVkICYmICh0aGlzLnByaXZBdWRpb0J1ZmZlci5sZW5ndGggPiAwKSAmJiB0aGlzLnNvdXJjZUJ1ZmZlckF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2QXBwZW5kaW5nVG9CdWZmZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJpbmFyeSA9IHRoaXMucHJpdkF1ZGlvQnVmZmVyLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U291cmNlQnVmZmVyLmFwcGVuZEJ1ZmZlcihiaW5hcnkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2QXVkaW9CdWZmZXIudW5zaGlmdChiaW5hcnkpO1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImJ1ZmZlciBmaWxsZWQsIHBhdXNpbmcgYWRkaXRpb24gb2YgYmluYXJpZXMgdW50aWwgc3BhY2UgaXMgbWFkZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLm5vdGlmeVBsYXliYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmNhbkVuZFN0cmVhbSgpKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5oYW5kbGVTb3VyY2VCdWZmZXJVcGRhdGVFbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGhhbmRsZVNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbkVuZFN0cmVhbSgpICYmIHRoaXMuc291cmNlQnVmZmVyQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZNZWRpYVNvdXJjZS5lbmRPZlN0cmVhbSgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMubm90aWZ5UGxheWJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG5vdGlmeVBsYXliYWNrKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZQbGF5YmFja1N0YXJ0ZWQgJiYgdGhpcy5wcml2QXVkaW8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlBsYXliYWNrU3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5vbkF1ZGlvU3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkF1ZGlvU3RhcnQodGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvLm9uZW5kZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMub25BdWRpb0VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkF1ZGlvRW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJpdklzUGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkF1ZGlvLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjYW5FbmRTdHJlYW0oKSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pc0Nsb3NlZCAmJiB0aGlzLnByaXZTb3VyY2VCdWZmZXIgIT09IHVuZGVmaW5lZCAmJiAodGhpcy5wcml2QXVkaW9CdWZmZXIubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgJiYgdGhpcy5wcml2TWVkaWFTb3VyY2VPcGVuZWQgJiYgIXRoaXMucHJpdkFwcGVuZGluZ1RvQnVmZmVyICYmIHRoaXMucHJpdk1lZGlhU291cmNlLnJlYWR5U3RhdGUgPT09IFwib3BlblwiKTtcbiAgICB9XG4gICAgc291cmNlQnVmZmVyQXZhaWxhYmxlKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMucHJpdlNvdXJjZUJ1ZmZlciAhPT0gdW5kZWZpbmVkICYmICF0aGlzLnByaXZTb3VyY2VCdWZmZXIudXBkYXRpbmcpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlckF1ZGlvRGVzdGluYXRpb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNPcGVuUmFuZ2VPcHRpb25OYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgTGFuZ3VhZ2VJZE1vZGUgfSBmcm9tIFwiLi9MYW5ndWFnZUlkTW9kZVwiO1xuLyoqXG4gKiBMYW5ndWFnZSBhdXRvIGRldGVjdCBjb25maWd1cmF0aW9uLlxuICogQGNsYXNzIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ1xuICogQWRkZWQgaW4gdmVyc2lvbiAxLjEzLjAuXG4gKi9cbmV4cG9ydCBjbGFzcyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fTGFuZ3VhZ2VJZE1vZGUsIFwiQXRTdGFydFwiKTtcbiAgICAgICAgdGhpcy5wcml2TGFuZ3VhZ2VJZE1vZGUgPSBMYW5ndWFnZUlkTW9kZS5BdFN0YXJ0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5mcm9tT3BlblJhbmdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIE9ubHkgW1tTcGVlY2hTeW50aGVzaXplcl1dIHN1cHBvcnRzIHNvdXJjZSBsYW5ndWFnZSBhdXRvIGRldGVjdGlvbiBmcm9tIG9wZW4gcmFuZ2UsXG4gICAgICogZm9yIFtbUmVjb2duaXplcl1dLCBwbGVhc2UgdXNlIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZyB3aXRoIHNwZWNpZmljIHNvdXJjZSBsYW5ndWFnZXMuXG4gICAgICogQHJldHVybiB7QXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnfSBJbnN0YW5jZSBvZiBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWdcbiAgICAgKiBAc3VtbWFyeSBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgd2l0aCBvcGVuIHJhbmdlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tT3BlblJhbmdlKCkge1xuICAgICAgICBjb25zdCBjb25maWcgPSBuZXcgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnKCk7XG4gICAgICAgIGNvbmZpZy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcywgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlc09wZW5SYW5nZU9wdGlvbk5hbWUpO1xuICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5mcm9tTGFuZ3VhZ2VzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IGxhbmd1YWdlcyBDb21tYS1zZXBhcmF0ZWQgc3RyaW5nIG9mIGxhbmd1YWdlcyAoZWcuIFwiZW4tVVMsZnItRlJcIikgdG8gcG9wdWxhdGUgcHJvcGVydGllcyBvZiBjb25maWcuXG4gICAgICogQHJldHVybiB7QXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnfSBJbnN0YW5jZSBvZiBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWdcbiAgICAgKiBAc3VtbWFyeSBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgd2l0aCBnaXZlbiBsYW5ndWFnZXMuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21MYW5ndWFnZXMobGFuZ3VhZ2VzKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmQXJyYXlFbXB0eU9yV2hpdGVzcGFjZShsYW5ndWFnZXMsIFwibGFuZ3VhZ2VzXCIpO1xuICAgICAgICBjb25zdCBjb25maWcgPSBuZXcgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnKCk7XG4gICAgICAgIGNvbmZpZy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcywgbGFuZ3VhZ2VzLmpvaW4oKSk7XG4gICAgICAgIHJldHVybiBjb25maWc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLmZyb21Tb3VyY2VMYW5ndWFnZUNvbmZpZ3NcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtTb3VyY2VMYW5ndWFnZUNvbmZpZ1tdfSBjb25maWdzIFNvdXJjZUxhbmd1YWdlQ29uZmlncyB0byBwb3B1bGF0ZSBwcm9wZXJ0aWVzIG9mIGNvbmZpZy5cbiAgICAgKiBAcmV0dXJuIHtBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWd9IEluc3RhbmNlIG9mIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ1xuICAgICAqIEBzdW1tYXJ5IENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZyB3aXRoIGdpdmVuIFNvdXJjZUxhbmd1YWdlQ29uZmlncy5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVNvdXJjZUxhbmd1YWdlQ29uZmlncyhjb25maWdzKSB7XG4gICAgICAgIGlmIChjb25maWdzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIG5vbi1lbXB0eSBTb3VyY2VMYW5ndWFnZUNvbmZpZyBhcnJheS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYXV0b0NvbmZpZyA9IG5ldyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcoKTtcbiAgICAgICAgY29uc3QgbGFuZ3MgPSBbXTtcbiAgICAgICAgY29uZmlncy5mb3JFYWNoKChjb25maWcpID0+IHtcbiAgICAgICAgICAgIGxhbmdzLnB1c2goY29uZmlnLmxhbmd1YWdlKTtcbiAgICAgICAgICAgIGlmIChjb25maWcuZW5kcG9pbnRJZCAhPT0gdW5kZWZpbmVkICYmIGNvbmZpZy5lbmRwb2ludElkICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VzdG9tUHJvcGVydHkgPSBjb25maWcubGFuZ3VhZ2UgKyBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBhdXRvQ29uZmlnLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoY3VzdG9tUHJvcGVydHksIGNvbmZpZy5lbmRwb2ludElkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGF1dG9Db25maWcucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMsIGxhbmdzLmpvaW4oKSk7XG4gICAgICAgIHJldHVybiBhdXRvQ29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZy5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJuIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFByb3BlcnRpZXMgb2YgdGhlIGNvbmZpZy5cbiAgICAgKiBAc3VtbWFyeSBHZXRzIGFuIGF1dG8gZGV0ZWN0ZWQgbGFuZ3VhZ2UgY29uZmlnIHByb3BlcnRpZXNcbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLnByb3RvdHlwZS5tb2RlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7TGFuZ3VhZ2VJZE1vZGV9IG1vZGUgTElEIG1vZGUgZGVzaXJlZC5cbiAgICAgKiBAc3VtbWFyeSBTZXRzIExJRCBvcGVyYXRpb24gdG8gZGVzaXJlZCBtb2RlXG4gICAgICovXG4gICAgc2V0IG1vZGUobW9kZSkge1xuICAgICAgICBpZiAobW9kZSA9PT0gTGFuZ3VhZ2VJZE1vZGUuQ29udGludW91cykge1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uLCBcIjJcIik7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fTGFuZ3VhZ2VJZE1vZGUsIFwiQ29udGludW91c1wiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHsgLy8gTGFuZ3VhZ2VJZE1vZGUuQXRTdGFydFxuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uLCBcIjFcIik7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fTGFuZ3VhZ2VJZE1vZGUsIFwiQXRTdGFydFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZUlkTW9kZSA9IG1vZGU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuLyoqXG4gKiBPdXRwdXQgZm9ybWF0XG4gKiBAY2xhc3MgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VSZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQobGFuZ3VhZ2UsIFwibGFuZ3VhZ2VcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgXCJsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2VcIik7XG4gICAgICAgIHRoaXMucHJpdkxhbmd1YWdlID0gbGFuZ3VhZ2U7XG4gICAgICAgIHRoaXMucHJpdkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSA9IGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VSZXN1bHQgb2JqZWN0IGZyb20gYSBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCBpbnN0YW5jZS5cbiAgICAgKiBAbWVtYmVyIEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdC5mcm9tUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7U3BlZWNoUmVjb2duaXRpb25SZXN1bHR9IHJlc3VsdCAtIFRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQHJldHVybnMge0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdH0gQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0IG9iamVjdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbmV3IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdChyZXN1bHQubGFuZ3VhZ2UsIHJlc3VsdC5sYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UpO1xuICAgIH1cbiAgICBnZXQgbGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZVJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlQ29uZmlnLCBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCB9IGZyb20gXCIuL0RpYWxvZ1NlcnZpY2VDb25maWdcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIENsYXNzIHRoYXQgZGVmaW5lcyBjb25maWd1cmF0aW9ucyBmb3IgdGhlIGRpYWxvZyBzZXJ2aWNlIGNvbm5lY3RvciBvYmplY3QgZm9yIHVzaW5nIGEgQm90IEZyYW1ld29yayBiYWNrZW5kLlxuICogQGNsYXNzIEJvdEZyYW1ld29ya0NvbmZpZ1xuICovXG5leHBvcnQgY2xhc3MgQm90RnJhbWV3b3JrQ29uZmlnIGV4dGVuZHMgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgQm90RnJhbWV3b3JrQ29uZmlnLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgYm90IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGluc3RhbmNlIHdpdGggdGhlIHByb3ZpZGVkIHN1YnNjcmlwdGlvbiBpbmZvcm1hdGlvbi5cbiAgICAgKiBAbWVtYmVyIEJvdEZyYW1ld29ya0NvbmZpZy5mcm9tU3Vic2NyaXB0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBzdWJzY3JpcHRpb24gU3Vic2NyaXB0aW9uIGtleSBhc3NvY2lhdGVkIHdpdGggdGhlIGJvdFxuICAgICAqIEBwYXJhbSByZWdpb24gVGhlIHJlZ2lvbiBuYW1lIChzZWUgdGhlIDxhIGhyZWY9XCJodHRwczovL2FrYS5tcy9jc3NwZWVjaC9yZWdpb25cIj5yZWdpb24gcGFnZTwvYT4pLlxuICAgICAqIEBwYXJhbSBib3RJZCBPcHRpb25hbC4gSWRlbnRpZmllciBmb3IgdXNpbmcgYSBzcGVjaWZpYyBib3Qgd2l0aGluIGFuIEF6dXJlIHJlc291cmNlIGdyb3VwLiBFcXVpdmFsZW50IHRvIHRoZVxuICAgICAqIHJlc291cmNlIG5hbWUuXG4gICAgICogQHJldHVybnMge0JvdEZyYW1ld29ya0NvbmZpZ30gQSBuZXcgYm90IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbiwgcmVnaW9uLCBib3RJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc3Vic2NyaXB0aW9uLCBcInN1YnNjcmlwdGlvblwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IGJvdEZyYW1ld29ya0NvbmZpZyA9IG5ldyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCgpO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZSwgRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5Cb3RGcmFtZXdvcmspO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbik7XG4gICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlZ2lvbiwgcmVnaW9uKTtcbiAgICAgICAgaWYgKGJvdElkKSB7XG4gICAgICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZCwgYm90SWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBib3RGcmFtZXdvcmtDb25maWc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBib3QgZnJhbWV3b3JrIGNvbmZpZ3VyYXRpb24gaW5zdGFuY2UgZm9yIHRoZSBzcGVjaWZpZWQgYXV0aG9yaXphdGlvbiB0b2tlbiBhbmQgcmVnaW9uLlxuICAgICAqIE5vdGU6IFRoZSBjYWxsZXIgbXVzdCBlbnN1cmUgdGhhdCBhbiBhdXRob3JpemF0aW9uIHRva2VuIGlzIHZhbGlkLiBCZWZvcmUgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiBleHBpcmVzLCB0aGVcbiAgICAgKiBjYWxsZXIgbXVzdCByZWZyZXNoIGl0IGJ5IHNldHRpbmcgdGhlIGF1dGhvcml6YXRpb25Ub2tlbiBwcm9wZXJ0eSBvbiB0aGUgY29ycmVzcG9uZGluZ1xuICAgICAqIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IgaW5zdGFuY2UgY3JlYXRlZCB3aXRoIHRoaXMgY29uZmlnLiBUaGUgY29udGVudHMgb2YgY29uZmlndXJhdGlvbiBvYmplY3RzIGFyZSBjb3BpZWRcbiAgICAgKiB3aGVuIGNvbm5lY3RvcnMgYXJlIGNyZWF0ZWQsIHNvIHNldHRpbmcgYXV0aG9yaXphdGlvblRva2VuIG9uIGEgRGlhbG9nU2VydmljZUNvbm5lY3RvciB3aWxsIG5vdCB1cGRhdGUgdGhlXG4gICAgICogb3JpZ2luYWwgY29uZmlndXJhdGlvbidzIGF1dGhvcml6YXRpb24gdG9rZW4uIENyZWF0ZSBhIG5ldyBjb25maWd1cmF0aW9uIGluc3RhbmNlIG9yIHNldCB0aGVcbiAgICAgKiBTcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiBwcm9wZXJ0eSB0byB1cGRhdGUgYW4gZXhpc3RpbmcgaW5zdGFuY2UgaWYgaXQgd2lsbCBiZSB1c2VkIHRvIGNyZWF0ZVxuICAgICAqIGZ1cnRoZXIgRGlhbG9nU2VydmljZUNvbm5lY3RvcnMuXG4gICAgICogQG1lbWJlciBCb3RGcmFtZXdvcmtDb25maWcuZnJvbUF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gYXV0aG9yaXphdGlvblRva2VuIFRoZSBhdXRob3JpemF0aW9uIHRva2VuIGFzc29jaWF0ZWQgd2l0aCB0aGUgYm90XG4gICAgICogQHBhcmFtIHJlZ2lvbiBUaGUgcmVnaW9uIG5hbWUgKHNlZSB0aGUgPGEgaHJlZj1cImh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3JlZ2lvblwiPnJlZ2lvbiBwYWdlPC9hPikuXG4gICAgICogQHBhcmFtIGJvdElkIE9wdGlvbmFsLiBJZGVudGlmaWVyIGZvciB1c2luZyBhIHNwZWNpZmljIGJvdCB3aXRoaW4gYW4gQXp1cmUgcmVzb3VyY2UgZ3JvdXAuIEVxdWl2YWxlbnQgdG8gdGhlXG4gICAgICogcmVzb3VyY2UgbmFtZS5cbiAgICAgKiBAcmV0dXJucyB7Qm90RnJhbWV3b3JrQ29uZmlnfSBBIG5ldyBib3QgZnJhbWV3b3JrIGNvbmZpZ3VyYXRpb24gaW5zdGFuY2UuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21BdXRob3JpemF0aW9uVG9rZW4oYXV0aG9yaXphdGlvblRva2VuLCByZWdpb24sIGJvdElkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShhdXRob3JpemF0aW9uVG9rZW4sIFwiYXV0aG9yaXphdGlvblRva2VuXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocmVnaW9uLCBcInJlZ2lvblwiKTtcbiAgICAgICAgY29uc3QgYm90RnJhbWV3b3JrQ29uZmlnID0gbmV3IERpYWxvZ1NlcnZpY2VDb25maWdJbXBsKCk7XG4gICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlLCBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkJvdEZyYW1ld29yayk7XG4gICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCBhdXRob3JpemF0aW9uVG9rZW4pO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIGlmIChib3RJZCkge1xuICAgICAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWQsIGJvdElkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYm90RnJhbWV3b3JrQ29uZmlnO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGEgQm90RnJhbWV3b3JrQ29uZmlnLlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGludGVuZGVkIG9ubHkgZm9yIHVzZXJzIHdobyB1c2UgYSBub24tZGVmYXVsdCBzZXJ2aWNlIGhvc3QuIFRoZSBzdGFuZGFyZCByZXNvdXJjZSBwYXRoIHdpbGwgYmVcbiAgICAgKiBhc3N1bWVkLiBGb3Igc2VydmljZXMgd2l0aCBhIG5vbi1zdGFuZGFyZCByZXNvdXJjZSBwYXRoIG9yIG5vIHBhdGggYXQgYWxsLCB1c2UgZnJvbUVuZHBvaW50IGluc3RlYWQuXG4gICAgICogTm90ZTogUXVlcnkgcGFyYW1ldGVycyBhcmUgbm90IGFsbG93ZWQgaW4gdGhlIGhvc3QgVVJJIGFuZCBtdXN0IGJlIHNldCBieSBvdGhlciBBUElzLlxuICAgICAqIE5vdGU6IFRvIHVzZSBhbiBhdXRob3JpemF0aW9uIHRva2VuIHdpdGggZnJvbUhvc3QsIHVzZSBmcm9tSG9zdChVUkwpIGFuZCB0aGVuIHNldCB0aGUgQXV0aG9yaXphdGlvblRva2VuXG4gICAgICogcHJvcGVydHkgb24gdGhlIGNyZWF0ZWQgQm90RnJhbWV3b3JrQ29uZmlnIGluc3RhbmNlLlxuICAgICAqIE5vdGU6IEFkZGVkIGluIHZlcnNpb24gMS4xNS4wLlxuICAgICAqIEBtZW1iZXIgQm90RnJhbWV3b3JrQ29uZmlnLmZyb21Ib3N0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7VVJMIHwgc3RyaW5nfSBob3N0IC0gSWYgYSBVUkwgaXMgcHJvdmlkZWQsIHRoZSBmdWxseS1xdWFsaWZpZWQgaG9zdCB3aXRoIHByb3RvY29sIChlLmcuXG4gICAgICogd3NzOi8veW91ci5ob3N0LmNvbToxMjM0KSB3aWxsIGJlIHVzZWQuIElmIGEgc3RyaW5nIGlzIHByb3ZpZGVkLCBpdCB3aWxsIGJlIGVtYmVkZGVkIGluXG4gICAgICogd3NzOi8ve2hvc3R9LmNvbnZhaS5zcGVlY2guYXp1cmUudXMuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LiBJZiBhIHN1YnNjcmlwdGlvbiBrZXkgaXMgbm90IHNwZWNpZmllZCwgYW4gYXV0aG9yaXphdGlvblxuICAgICAqIHRva2VuIG11c3QgYmUgc2V0LlxuICAgICAqIEBwYXJhbSBib3RJZCBPcHRpb25hbC4gSWRlbnRpZmllciBmb3IgdXNpbmcgYSBzcGVjaWZpYyBib3Qgd2l0aGluIGFuIEF6dXJlIHJlc291cmNlIGdyb3VwLiBFcXVpdmFsZW50IHRvIHRoZVxuICAgICAqIHJlc291cmNlIG5hbWUuXG4gICAgICogQHJldHVybnMge0JvdEZyYW1ld29ya0NvbmZpZ30gQSBuZXcgYm90IGZyYW1ld29yayBjb25maWd1cmF0aW9uIGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSG9zdChob3N0LCBzdWJzY3JpcHRpb25LZXksIGJvdElkKSB7XG4gICAgICAgIHZvaWQgYm90SWQ7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGhvc3QsIFwiaG9zdFwiKTtcbiAgICAgICAgY29uc3QgcmVzb2x2ZWRIb3N0ID0gaG9zdCBpbnN0YW5jZW9mIFVSTCA/IGhvc3QgOiBuZXcgVVJMKGB3c3M6Ly8ke2hvc3R9LmNvbnZhaS5zcGVlY2guYXp1cmUudXNgKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQocmVzb2x2ZWRIb3N0LCBcInJlc29sdmVkSG9zdFwiKTtcbiAgICAgICAgY29uc3QgYm90RnJhbWV3b3JrQ29uZmlnID0gbmV3IERpYWxvZ1NlcnZpY2VDb25maWdJbXBsKCk7XG4gICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlLCBEaWFsb2dTZXJ2aWNlQ29uZmlnLkRpYWxvZ1R5cGVzLkJvdEZyYW1ld29yayk7XG4gICAgICAgIGJvdEZyYW1ld29ya0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIHJlc29sdmVkSG9zdC50b1N0cmluZygpKTtcbiAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbktleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJvdEZyYW1ld29ya0NvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBhIEJvdEZyYW1ld29ya0NvbmZpZy5cbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBvbmx5IGZvciB1c2VycyB3aG8gdXNlIGEgbm9uLXN0YW5kYXJkIHNlcnZpY2UgZW5kcG9pbnQgb3IgcGFyYW1ldGVycy5cbiAgICAgKiBOb3RlOiBUaGUgcXVlcnkgcGFyYW1ldGVycyBzcGVjaWZpZWQgaW4gdGhlIGVuZHBvaW50IFVSTCBhcmUgbm90IGNoYW5nZWQsIGV2ZW4gaWYgdGhleSBhcmUgc2V0IGJ5IGFueSBvdGhlciBBUElzLlxuICAgICAqIE5vdGU6IFRvIHVzZSBhdXRob3JpemF0aW9uIHRva2VuIHdpdGggZnJvbUVuZHBvaW50LCBwYXNzIGFuIGVtcHR5IHN0cmluZyB0byB0aGUgc3Vic2NyaXB0aW9uS2V5IGluIHRoZVxuICAgICAqIGZyb21FbmRwb2ludCBtZXRob2QsIGFuZCB0aGVuIHNldCBhdXRob3JpemF0aW9uVG9rZW49XCJ0b2tlblwiIG9uIHRoZSBjcmVhdGVkIEJvdEZyYW1ld29ya0NvbmZpZyBpbnN0YW5jZSB0b1xuICAgICAqIHVzZSB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKiBOb3RlOiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMC5cbiAgICAgKiBAbWVtYmVyIEJvdEZyYW1ld29ya0NvbmZpZy5mcm9tRW5kcG9pbnRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtVUkx9IGVuZHBvaW50IC0gVGhlIHNlcnZpY2UgZW5kcG9pbnQgdG8gY29ubmVjdCB0by5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3Vic2NyaXB0aW9uS2V5IC0gVGhlIHN1YnNjcmlwdGlvbiBrZXkuIElmIGEgc3Vic2NyaXB0aW9uIGtleSBpcyBub3Qgc3BlY2lmaWVkLCBhbiBhdXRob3JpemF0aW9uXG4gICAgICogdG9rZW4gbXVzdCBiZSBzZXQuXG4gICAgICogQHJldHVybnMge0JvdEZyYW1ld29ya0NvbmZpZ30gLSBBIG5ldyBib3QgZnJhbWV3b3JrIGNvbmZpZ3VyYXRpb24gaW5zdGFuY2UgdXNpbmcgdGhlIHByb3ZpZGVkIGVuZHBvaW50LlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tRW5kcG9pbnQoZW5kcG9pbnQsIHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoZW5kcG9pbnQsIFwiZW5kcG9pbnRcIik7XG4gICAgICAgIGNvbnN0IGJvdEZyYW1ld29ya0NvbmZpZyA9IG5ldyBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCgpO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZSwgRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5Cb3RGcmFtZXdvcmspO1xuICAgICAgICBib3RGcmFtZXdvcmtDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludCwgZW5kcG9pbnQudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgYm90RnJhbWV3b3JrQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBib3RGcmFtZXdvcmtDb25maWc7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Cb3RGcmFtZXdvcmtDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgRW51bVRyYW5zbGF0aW9uLCBTaW1wbGVTcGVlY2hQaHJhc2UgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZSB9IGZyb20gXCIuL0NhbmNlbGxhdGlvbkRldGFpbHNCYXNlXCI7XG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIENvbnRhaW5zIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IHdoeSBhIHJlc3VsdCB3YXMgY2FuY2VsZWQuXG4gKiBAY2xhc3MgQ2FuY2VsbGF0aW9uRGV0YWlsc1xuICovXG5leHBvcnQgY2xhc3MgQ2FuY2VsbGF0aW9uRGV0YWlscyBleHRlbmRzIENhbmNlbGxhdGlvbkRldGFpbHNCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKSB7XG4gICAgICAgIHN1cGVyKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIENhbmNlbGxhdGlvbkRldGFpbHMgb2JqZWN0IGZvciB0aGUgY2FuY2VsZWQgUmVjb2duaXRpb25SZXN1bHQuXG4gICAgICogQG1lbWJlciBDYW5jZWxsYXRpb25EZXRhaWxzLmZyb21SZXN1bHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtSZWNvZ25pdGlvblJlc3VsdCB8IFNwZWVjaFN5bnRoZXNpc1Jlc3VsdH0gcmVzdWx0IC0gVGhlIHJlc3VsdCB0aGF0IHdhcyBjYW5jZWxlZC5cbiAgICAgKiBAcmV0dXJucyB7Q2FuY2VsbGF0aW9uRGV0YWlsc30gVGhlIGNhbmNlbGxhdGlvbiBkZXRhaWxzIG9iamVjdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICBsZXQgcmVhc29uID0gQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yO1xuICAgICAgICBsZXQgZXJyb3JDb2RlID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3I7XG4gICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBSZWNvZ25pdGlvblJlc3VsdCAmJiAhIXJlc3VsdC5qc29uKSB7XG4gICAgICAgICAgICBjb25zdCBzaW1wbGVTcGVlY2ggPSBTaW1wbGVTcGVlY2hQaHJhc2UuZnJvbUpTT04ocmVzdWx0Lmpzb24pO1xuICAgICAgICAgICAgcmVhc29uID0gRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVDYW5jZWxSZXN1bHQoc2ltcGxlU3BlZWNoLlJlY29nbml0aW9uU3RhdHVzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISFyZXN1bHQucHJvcGVydGllcykge1xuICAgICAgICAgICAgZXJyb3JDb2RlID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW3Jlc3VsdC5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yXSldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQ2FuY2VsbGF0aW9uRGV0YWlscyhyZWFzb24sIHJlc3VsdC5lcnJvckRldGFpbHMgfHwgRW51bVRyYW5zbGF0aW9uLmltcGxUcmFuc2xhdGVFcnJvckRldGFpbHMoZXJyb3JDb2RlKSwgZXJyb3JDb2RlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNhbmNlbGxhdGlvbkRldGFpbHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQ29udGFpbnMgZGV0YWlsZWQgaW5mb3JtYXRpb24gYWJvdXQgd2h5IGEgcmVzdWx0IHdhcyBjYW5jZWxlZC5cbiAqIEBjbGFzcyBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZVxuICovXG5leHBvcnQgY2xhc3MgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2Uge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtDYW5jZWxsYXRpb25SZWFzb259IHJlYXNvbiAtIFRoZSBjYW5jZWxsYXRpb24gcmVhc29uLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvckRldGFpbHMgLSBUaGUgZXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSkge1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IGVycm9yRGV0YWlscztcbiAgICAgICAgdGhpcy5wcml2RXJyb3JDb2RlID0gZXJyb3JDb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSByZWNvZ25pdGlvbiB3YXMgY2FuY2VsZWQuXG4gICAgICogQG1lbWJlciBDYW5jZWxsYXRpb25EZXRhaWxzQmFzZS5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtDYW5jZWxsYXRpb25SZWFzb259IFNwZWNpZmllcyB0aGUgcmVhc29uIGNhbmNlbGVkLlxuICAgICAqL1xuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluIGNhc2Ugb2YgYW4gdW5zdWNjZXNzZnVsIHJlY29nbml0aW9uLCBwcm92aWRlcyBkZXRhaWxzIG9mIHRoZSBvY2N1cnJlZCBlcnJvci5cbiAgICAgKiBAbWVtYmVyIENhbmNlbGxhdGlvbkRldGFpbHNCYXNlLnByb3RvdHlwZS5lcnJvckRldGFpbHNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBlcnJvciBkZXRhaWxzLlxuICAgICAqL1xuICAgIGdldCBlcnJvckRldGFpbHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvckRldGFpbHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBlcnJvciBjb2RlIGluIGNhc2Ugb2YgYW4gdW5zdWNjZXNzZnVsIHJlY29nbml0aW9uLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xLjAuXG4gICAgICogQHJldHVybiBBbiBlcnJvciBjb2RlIHRoYXQgcmVwcmVzZW50cyB0aGUgZXJyb3IgcmVhc29uLlxuICAgICAqL1xuICAgIGdldCBFcnJvckNvZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvckNvZGU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DYW5jZWxsYXRpb25EZXRhaWxzQmFzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIGVycm9yIGNvZGUgaW4gY2FzZSB0aGF0IENhbmNlbGxhdGlvblJlYXNvbiBpcyBFcnJvci5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xLjAuXG4gKi9cbmV4cG9ydCB2YXIgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlO1xuKGZ1bmN0aW9uIChDYW5jZWxsYXRpb25FcnJvckNvZGUpIHtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCBubyBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc3BlZWNoIHJlY29nbml0aW9uLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJOb0Vycm9yXCJdID0gMF0gPSBcIk5vRXJyb3JcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgYW4gYXV0aGVudGljYXRpb24gZXJyb3IuXG4gICAgICovXG4gICAgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZVtcIkF1dGhlbnRpY2F0aW9uRmFpbHVyZVwiXSA9IDFdID0gXCJBdXRoZW50aWNhdGlvbkZhaWx1cmVcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCBvbmUgb3IgbW9yZSByZWNvZ25pdGlvbiBwYXJhbWV0ZXJzIGFyZSBpbnZhbGlkLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJCYWRSZXF1ZXN0UGFyYW1ldGVyc1wiXSA9IDJdID0gXCJCYWRSZXF1ZXN0UGFyYW1ldGVyc1wiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IHRoZSBudW1iZXIgb2YgcGFyYWxsZWwgcmVxdWVzdHMgZXhjZWVkZWQgdGhlIG51bWJlciBvZiBhbGxvd2VkXG4gICAgICogY29uY3VycmVudCB0cmFuc2NyaXB0aW9ucyBmb3IgdGhlIHN1YnNjcmlwdGlvbi5cbiAgICAgKi9cbiAgICBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW1wiVG9vTWFueVJlcXVlc3RzXCJdID0gM10gPSBcIlRvb01hbnlSZXF1ZXN0c1wiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBhIGNvbm5lY3Rpb24gZXJyb3IuXG4gICAgICovXG4gICAgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZVtcIkNvbm5lY3Rpb25GYWlsdXJlXCJdID0gNF0gPSBcIkNvbm5lY3Rpb25GYWlsdXJlXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGEgdGltZS1vdXQgZXJyb3Igd2hlbiB3YWl0aW5nIGZvciByZXNwb25zZSBmcm9tIHNlcnZpY2UuXG4gICAgICovXG4gICAgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZVtcIlNlcnZpY2VUaW1lb3V0XCJdID0gNV0gPSBcIlNlcnZpY2VUaW1lb3V0XCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoYXQgYW4gZXJyb3IgaXMgcmV0dXJuZWQgYnkgdGhlIHNlcnZpY2UuXG4gICAgICovXG4gICAgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZVtcIlNlcnZpY2VFcnJvclwiXSA9IDZdID0gXCJTZXJ2aWNlRXJyb3JcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgYW4gdW5leHBlY3RlZCBydW50aW1lIGVycm9yLlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJSdW50aW1lRXJyb3JcIl0gPSA3XSA9IFwiUnVudGltZUVycm9yXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIGFuIHF1b3RhIG92ZXJydW4gb24gZXhpc3Rpbmcga2V5LlxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGVbXCJGb3JiaWRkZW5cIl0gPSA4XSA9IFwiRm9yYmlkZGVuXCI7XG59KShDYW5jZWxsYXRpb25FcnJvckNvZGUgfHwgKENhbmNlbGxhdGlvbkVycm9yQ29kZSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNhbmNlbGxhdGlvbkVycm9yQ29kZXMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnQgb2YgYSBDYW5jZWxsYXRpb25FdmVudC5cbiAqIEBjbGFzcyBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlXG4gKi9cbmV4cG9ydCBjbGFzcyBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlIGV4dGVuZHMgUmVjb2duaXRpb25FdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtDYW5jZWxsYXRpb25SZWFzb259IHJlYXNvbiAtIFRoZSBjYW5jZWxsYXRpb24gcmVhc29uLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvckRldGFpbHMgLSBFcnJvciBkZXRhaWxzLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gVGhlIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSwgb2Zmc2V0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIob2Zmc2V0LCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IGVycm9yRGV0YWlscztcbiAgICAgICAgdGhpcy5wcml2RXJyb3JDb2RlID0gZXJyb3JDb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSByZWNvZ25pdGlvbiB3YXMgY2FuY2VsZWQuXG4gICAgICogQG1lbWJlciBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlLnByb3RvdHlwZS5yZWFzb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0NhbmNlbGxhdGlvblJlYXNvbn0gU3BlY2lmaWVzIHRoZSByZWFzb24gY2FuY2VsZWQuXG4gICAgICovXG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGVycm9yIGNvZGUgaW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgb3BlcmF0aW9uLlxuICAgICAqIEByZXR1cm4gQW4gZXJyb3IgY29kZSB0aGF0IHJlcHJlc2VudHMgdGhlIGVycm9yIHJlYXNvbi5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JDb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JDb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCBvcGVyYXRpb24sIHByb3ZpZGVzIGRldGFpbHMgb2YgdGhlIG9jY3VycmVkIGVycm9yLlxuICAgICAqIEBtZW1iZXIgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZS5wcm90b3R5cGUuZXJyb3JEZXRhaWxzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgZXJyb3IgZGV0YWlscy5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRoZSBwb3NzaWJsZSByZWFzb25zIGEgcmVjb2duaXRpb24gcmVzdWx0IG1pZ2h0IGJlIGNhbmNlbGVkLlxuICogQGNsYXNzIENhbmNlbGxhdGlvblJlYXNvblxuICovXG5leHBvcnQgdmFyIENhbmNlbGxhdGlvblJlYXNvbjtcbihmdW5jdGlvbiAoQ2FuY2VsbGF0aW9uUmVhc29uKSB7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoYXQgYW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIENhbmNlbGxhdGlvblJlYXNvbi5FcnJvclxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvblJlYXNvbltDYW5jZWxsYXRpb25SZWFzb25bXCJFcnJvclwiXSA9IDBdID0gXCJFcnJvclwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IHRoZSBlbmQgb2YgdGhlIGF1ZGlvIHN0cmVhbSB3YXMgcmVhY2hlZC5cbiAgICAgKiBAbWVtYmVyIENhbmNlbGxhdGlvblJlYXNvbi5FbmRPZlN0cmVhbVxuICAgICAqL1xuICAgIENhbmNlbGxhdGlvblJlYXNvbltDYW5jZWxsYXRpb25SZWFzb25bXCJFbmRPZlN0cmVhbVwiXSA9IDFdID0gXCJFbmRPZlN0cmVhbVwiO1xufSkoQ2FuY2VsbGF0aW9uUmVhc29uIHx8IChDYW5jZWxsYXRpb25SZWFzb24gPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DYW5jZWxsYXRpb25SZWFzb24uanMubWFwXG4iLCIvL1xuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgZnVsbCBsaWNlbnNlIGluZm9ybWF0aW9uLlxuLy9cbmltcG9ydCB7IFNlcnZpY2VSZWNvZ25pemVyQmFzZSwgU3ludGhlc2lzQWRhcHRlckJhc2UsIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcywgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25NZXNzYWdlSW1wbCB9IGZyb20gXCIuL0Nvbm5lY3Rpb25NZXNzYWdlXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb25FdmVudEFyZ3MsIENvbm5lY3Rpb25NZXNzYWdlRXZlbnRBcmdzLCBTZXJ2aWNlRXZlbnRBcmdzLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogQ29ubmVjdGlvbiBpcyBhIHByb3h5IGNsYXNzIGZvciBtYW5hZ2luZyBjb25uZWN0aW9uIHRvIHRoZSBzcGVlY2ggc2VydmljZSBvZiB0aGUgc3BlY2lmaWVkIFJlY29nbml6ZXIuXG4gKiBCeSBkZWZhdWx0LCBhIFJlY29nbml6ZXIgYXV0b25vbW91c2x5IG1hbmFnZXMgY29ubmVjdGlvbiB0byBzZXJ2aWNlIHdoZW4gbmVlZGVkLlxuICogVGhlIENvbm5lY3Rpb24gY2xhc3MgcHJvdmlkZXMgYWRkaXRpb25hbCBtZXRob2RzIGZvciB1c2VycyB0byBleHBsaWNpdGx5IG9wZW4gb3IgY2xvc2UgYSBjb25uZWN0aW9uIGFuZFxuICogdG8gc3Vic2NyaWJlIHRvIGNvbm5lY3Rpb24gc3RhdHVzIGNoYW5nZXMuXG4gKiBUaGUgdXNlIG9mIENvbm5lY3Rpb24gaXMgb3B0aW9uYWwsIGFuZCBtYWlubHkgZm9yIHNjZW5hcmlvcyB3aGVyZSBmaW5lIHR1bmluZyBvZiBhcHBsaWNhdGlvblxuICogYmVoYXZpb3IgYmFzZWQgb24gY29ubmVjdGlvbiBzdGF0dXMgaXMgbmVlZGVkLiBVc2VycyBjYW4gb3B0aW9uYWxseSBjYWxsIE9wZW4oKSB0byBtYW51YWxseSBzZXQgdXAgYSBjb25uZWN0aW9uXG4gKiBpbiBhZHZhbmNlIGJlZm9yZSBzdGFydGluZyByZWNvZ25pdGlvbiBvbiB0aGUgUmVjb2duaXplciBhc3NvY2lhdGVkIHdpdGggdGhpcyBDb25uZWN0aW9uLlxuICogSWYgdGhlIFJlY29nbml6ZXIgbmVlZHMgdG8gY29ubmVjdCBvciBkaXNjb25uZWN0IHRvIHNlcnZpY2UsIGl0IHdpbGxcbiAqIHNldHVwIG9yIHNodXRkb3duIHRoZSBjb25uZWN0aW9uIGluZGVwZW5kZW50bHkuIEluIHRoaXMgY2FzZSB0aGUgQ29ubmVjdGlvbiB3aWxsIGJlIG5vdGlmaWVkIGJ5IGNoYW5nZSBvZiBjb25uZWN0aW9uXG4gKiBzdGF0dXMgdmlhIENvbm5lY3RlZC9EaXNjb25uZWN0ZWQgZXZlbnRzLlxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjIuMS5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb24ge1xuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIENvbm5lY3Rpb24gaW5zdGFuY2UgZnJvbSB0aGUgc3BlY2lmaWVkIHJlY29nbml6ZXIuXG4gICAgICogQHBhcmFtIHJlY29nbml6ZXIgVGhlIHJlY29nbml6ZXIgYXNzb2NpYXRlZCB3aXRoIHRoZSBjb25uZWN0aW9uLlxuICAgICAqIEByZXR1cm4gVGhlIENvbm5lY3Rpb24gaW5zdGFuY2Ugb2YgdGhlIHJlY29nbml6ZXIuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21SZWNvZ25pemVyKHJlY29nbml6ZXIpIHtcbiAgICAgICAgY29uc3QgcmVjb0Jhc2UgPSByZWNvZ25pemVyLmludGVybmFsRGF0YTtcbiAgICAgICAgY29uc3QgcmV0ID0gbmV3IENvbm5lY3Rpb24oKTtcbiAgICAgICAgcmV0LnByaXZJbnRlcm5hbERhdGEgPSByZWNvQmFzZTtcbiAgICAgICAgcmV0LnNldHVwRXZlbnRzKCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIENvbm5lY3Rpb24gaW5zdGFuY2UgZnJvbSB0aGUgc3BlY2lmaWVkIHN5bnRoZXNpemVyLlxuICAgICAqIEBwYXJhbSBzeW50aGVzaXplciBUaGUgc3ludGhlc2l6ZXIgYXNzb2NpYXRlZCB3aXRoIHRoZSBjb25uZWN0aW9uLlxuICAgICAqIEByZXR1cm4gVGhlIENvbm5lY3Rpb24gaW5zdGFuY2Ugb2YgdGhlIHN5bnRoZXNpemVyLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tU3ludGhlc2l6ZXIoc3ludGhlc2l6ZXIpIHtcbiAgICAgICAgY29uc3Qgc3ludGhCYXNlID0gc3ludGhlc2l6ZXIuaW50ZXJuYWxEYXRhO1xuICAgICAgICBjb25zdCByZXQgPSBuZXcgQ29ubmVjdGlvbigpO1xuICAgICAgICByZXQucHJpdkludGVybmFsRGF0YSA9IHN5bnRoQmFzZTtcbiAgICAgICAgcmV0LnNldHVwRXZlbnRzKCk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0byBzZXQgdXAgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS5cbiAgICAgKiBVc2VycyBjYW4gb3B0aW9uYWxseSBjYWxsIG9wZW5Db25uZWN0aW9uKCkgdG8gbWFudWFsbHkgc2V0IHVwIGEgY29ubmVjdGlvbiBpbiBhZHZhbmNlIGJlZm9yZSBzdGFydGluZyByZWNvZ25pdGlvbiBvbiB0aGVcbiAgICAgKiBSZWNvZ25pemVyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIENvbm5lY3Rpb24uIEFmdGVyIHN0YXJ0aW5nIHJlY29nbml0aW9uLCBjYWxsaW5nIE9wZW4oKSB3aWxsIGhhdmUgbm8gZWZmZWN0XG4gICAgICpcbiAgICAgKiBOb3RlOiBPbiByZXR1cm4sIHRoZSBjb25uZWN0aW9uIG1pZ2h0IG5vdCBiZSByZWFkeSB5ZXQuIFBsZWFzZSBzdWJzY3JpYmUgdG8gdGhlIENvbm5lY3RlZCBldmVudCB0b1xuICAgICAqIGJlIG5vdGlmaWVkIHdoZW4gdGhlIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWQuXG4gICAgICovXG4gICAgb3BlbkNvbm5lY3Rpb24oY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucHJpdkludGVybmFsRGF0YS5jb25uZWN0KCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIGNvbm5lY3Rpb24gdGhlIHNlcnZpY2UuXG4gICAgICogVXNlcnMgY2FuIG9wdGlvbmFsbHkgY2FsbCBjbG9zZUNvbm5lY3Rpb24oKSB0byBtYW51YWxseSBzaHV0ZG93biB0aGUgY29ubmVjdGlvbiBvZiB0aGUgYXNzb2NpYXRlZCBSZWNvZ25pemVyLlxuICAgICAqXG4gICAgICogSWYgY2xvc2VDb25uZWN0aW9uKCkgaXMgY2FsbGVkIGR1cmluZyByZWNvZ25pdGlvbiwgcmVjb2duaXRpb24gd2lsbCBmYWlsIGFuZCBjYW5jZWwgd2l0aCBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBjbG9zZUNvbm5lY3Rpb24oY2IsIGVycikge1xuICAgICAgICBpZiAodGhpcy5wcml2SW50ZXJuYWxEYXRhIGluc3RhbmNlb2YgU3ludGhlc2lzQWRhcHRlckJhc2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRpc2Nvbm5lY3RpbmcgYSBzeW50aGVzaXplcidzIGNvbm5lY3Rpb24gaXMgY3VycmVudGx5IG5vdCBzdXBwb3J0ZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucHJpdkludGVybmFsRGF0YS5kaXNjb25uZWN0KCksIGNiLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGVuZHMgYSBwYXJhbWV0ZXIgaW4gYSBtZXNzYWdlIHRvIHNlcnZpY2UuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEyLjEuXG4gICAgICogQHBhcmFtIHBhdGggVGhlIHBhdGggb2YgdGhlIG5ldHdvcmsgbWVzc2FnZS5cbiAgICAgKiBAcGFyYW0gcHJvcGVydHlOYW1lIE5hbWUgb2YgdGhlIHByb3BlcnR5XG4gICAgICogQHBhcmFtIHByb3BlcnR5VmFsdWUgVmFsdWUgb2YgdGhlIHByb3BlcnR5LiBUaGlzIGlzIGEganNvbiBzdHJpbmcuXG4gICAgICovXG4gICAgc2V0TWVzc2FnZVByb3BlcnR5KHBhdGgsIHByb3BlcnR5TmFtZSwgcHJvcGVydHlWYWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocHJvcGVydHlOYW1lLCBcInByb3BlcnR5TmFtZVwiKTtcbiAgICAgICAgaWYgKHRoaXMucHJpdkludGVybmFsRGF0YSBpbnN0YW5jZW9mIFNlcnZpY2VSZWNvZ25pemVyQmFzZSkge1xuICAgICAgICAgICAgaWYgKHBhdGgudG9Mb3dlckNhc2UoKSAhPT0gXCJzcGVlY2guY29udGV4dFwiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT25seSBzcGVlY2guY29udGV4dCBtZXNzYWdlIHByb3BlcnR5IHNldHMgYXJlIGN1cnJlbnRseSBzdXBwb3J0ZWQgZm9yIHJlY29nbml6ZXJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJbnRlcm5hbERhdGEuc3BlZWNoQ29udGV4dC5zZXRTZWN0aW9uKHByb3BlcnR5TmFtZSwgcHJvcGVydHlWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5wcml2SW50ZXJuYWxEYXRhIGluc3RhbmNlb2YgU3ludGhlc2lzQWRhcHRlckJhc2UpIHtcbiAgICAgICAgICAgIGlmIChwYXRoLnRvTG93ZXJDYXNlKCkgIT09IFwic3ludGhlc2lzLmNvbnRleHRcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9ubHkgc3ludGhlc2lzLmNvbnRleHQgbWVzc2FnZSBwcm9wZXJ0eSBzZXRzIGFyZSBjdXJyZW50bHkgc3VwcG9ydGVkIGZvciBzeW50aGVzaXplclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkludGVybmFsRGF0YS5zeW50aGVzaXNDb250ZXh0LnNldFNlY3Rpb24ocHJvcGVydHlOYW1lLCBwcm9wZXJ0eVZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kcyBhIG1lc3NhZ2UgdG8gdGhlIHNwZWVjaCBzZXJ2aWNlLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xMy4wLlxuICAgICAqIEBwYXJhbSBwYXRoIFRoZSBXZWJTb2NrZXQgcGF0aCBvZiB0aGUgbWVzc2FnZVxuICAgICAqIEBwYXJhbSBwYXlsb2FkIFRoZSBwYXlsb2FkIG9mIHRoZSBtZXNzYWdlLiBUaGlzIGlzIGEganNvbiBzdHJpbmcgb3IgYSBBcnJheUJ1ZmZlci5cbiAgICAgKiBAcGFyYW0gc3VjY2VzcyBBIGNhbGxiYWNrIHRvIGluZGljYXRlIHN1Y2Nlc3MuXG4gICAgICogQHBhcmFtIGVycm9yIEEgY2FsbGJhY2sgdG8gaW5kaWNhdGUgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc2VuZE1lc3NhZ2VBc3luYyhwYXRoLCBwYXlsb2FkLCBzdWNjZXNzLCBlcnJvcikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucHJpdkludGVybmFsRGF0YS5zZW5kTmV0d29ya01lc3NhZ2UocGF0aCwgcGF5bG9hZCksIHN1Y2Nlc3MsIGVycm9yKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzcG9zZSBvZiBhc3NvY2lhdGVkIHJlc291cmNlcy5cbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgLyogZXNsaW50LWRpc2FibGUgbm8tZW1wdHkgKi9cbiAgICB9XG4gICAgc2V0dXBFdmVudHMoKSB7XG4gICAgICAgIHRoaXMucHJpdkV2ZW50TGlzdGVuZXIgPSB0aGlzLnByaXZJbnRlcm5hbERhdGEuY29ubmVjdGlvbkV2ZW50cy5hdHRhY2goKGNvbm5lY3Rpb25FdmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbm5lY3Rpb25FdmVudC5uYW1lID09PSBcIkNvbm5lY3Rpb25Fc3RhYmxpc2hlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLmNvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbm5lY3RlZChuZXcgQ29ubmVjdGlvbkV2ZW50QXJncyhjb25uZWN0aW9uRXZlbnQuY29ubmVjdGlvbklkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbkNsb3NlZEV2ZW50XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLmRpc2Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3RlZChuZXcgQ29ubmVjdGlvbkV2ZW50QXJncyhjb25uZWN0aW9uRXZlbnQuY29ubmVjdGlvbklkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29ubmVjdGlvbkV2ZW50Lm5hbWUgPT09IFwiQ29ubmVjdGlvbk1lc3NhZ2VTZW50RXZlbnRcIikge1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMubWVzc2FnZVNlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlU2VudChuZXcgQ29ubmVjdGlvbk1lc3NhZ2VFdmVudEFyZ3MobmV3IENvbm5lY3Rpb25NZXNzYWdlSW1wbChjb25uZWN0aW9uRXZlbnQubWVzc2FnZSkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb25uZWN0aW9uRXZlbnQubmFtZSA9PT0gXCJDb25uZWN0aW9uTWVzc2FnZVJlY2VpdmVkRXZlbnRcIikge1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMubWVzc2FnZVJlY2VpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZVJlY2VpdmVkKG5ldyBDb25uZWN0aW9uTWVzc2FnZUV2ZW50QXJncyhuZXcgQ29ubmVjdGlvbk1lc3NhZ2VJbXBsKGNvbm5lY3Rpb25FdmVudC5tZXNzYWdlKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucHJpdlNlcnZpY2VFdmVudExpc3RlbmVyID0gdGhpcy5wcml2SW50ZXJuYWxEYXRhLnNlcnZpY2VFdmVudHMuYXR0YWNoKChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnJlY2VpdmVkU2VydmljZU1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlY2VpdmVkU2VydmljZU1lc3NhZ2UobmV3IFNlcnZpY2VFdmVudEFyZ3MoZS5qc29uU3RyaW5nLCBlLm5hbWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25uZWN0aW9uLmpzLm1hcFxuIiwiLy9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0LiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLiBTZWUgTElDRU5TRS5tZCBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGZ1bGwgbGljZW5zZSBpbmZvcm1hdGlvbi5cbi8vXG5pbXBvcnQgeyBTZXNzaW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIHBheWxvYWQgZm9yIGNvbm5lY3Rpb24gZXZlbnRzIGxpa2UgQ29ubmVjdGVkL0Rpc2Nvbm5lY3RlZC5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS4yLjBcbiAqL1xuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25FdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29ubmVjdGlvbkV2ZW50QXJncy5qcy5tYXBcbiIsIi8vXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UubWQgZmlsZSBpbiB0aGUgcHJvamVjdCByb290IGZvciBmdWxsIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4vL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5pbXBvcnQgeyBIZWFkZXJOYW1lcyB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0hlYWRlck5hbWVzXCI7XG5pbXBvcnQgeyBNZXNzYWdlVHlwZSB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlDb2xsZWN0aW9uIH0gZnJvbSBcIi4vUHJvcGVydHlDb2xsZWN0aW9uXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4vUHJvcGVydHlJZFwiO1xuLyoqXG4gKiBDb25uZWN0aW9uTWVzc2FnZSByZXByZXNlbnRzIGltcGxlbWVudGF0aW9uIHNwZWNpZmljIG1lc3NhZ2VzIHNlbnQgdG8gYW5kIHJlY2VpdmVkIGZyb21cbiAqIHRoZSBzcGVlY2ggc2VydmljZS4gVGhlc2UgbWVzc2FnZXMgYXJlIHByb3ZpZGVkIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBub3RcbiAqIGJlIHVzZWQgZm9yIHByb2R1Y3Rpb24gdXNlIGNhc2VzIHdpdGggdGhlIEF6dXJlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZS5cbiAqIE1lc3NhZ2VzIHNlbnQgdG8gYW5kIHJlY2VpdmVkIGZyb20gdGhlIFNwZWVjaCBTZXJ2aWNlIGFyZSBzdWJqZWN0IHRvIGNoYW5nZSB3aXRob3V0XG4gKiBub3RpY2UuIFRoaXMgaW5jbHVkZXMgbWVzc2FnZSBjb250ZW50cywgaGVhZGVycywgcGF5bG9hZHMsIG9yZGVyaW5nLCBldGMuXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTEuMC5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25NZXNzYWdlIHtcbn1cbmV4cG9ydCBjbGFzcyBDb25uZWN0aW9uTWVzc2FnZUltcGwge1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBpZiAoISF0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5oZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0pIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hfU2Vzc2lvbklkLCB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5oZWFkZXJzW0hlYWRlck5hbWVzLkNvbm5lY3Rpb25JZF0pO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlLmhlYWRlcnMpLmZvckVhY2goKGhlYWRlcikgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShoZWFkZXIsIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlLmhlYWRlcnNbaGVhZGVyXSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbWVzc2FnZSBwYXRoLlxuICAgICAqL1xuICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UuaGVhZGVyc1tPYmplY3Qua2V5cyh0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5oZWFkZXJzKS5maW5kKChrZXkpID0+IGtleS50b0xvd2VyQ2FzZSgpID09PSBcInBhdGhcIi50b0xvd2VyQ2FzZSgpKV07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0byBzZWUgaWYgdGhlIENvbm5lY3Rpb25NZXNzYWdlIGlzIGEgdGV4dCBtZXNzYWdlLlxuICAgICAqIFNlZSBhbHNvIElzQmluYXJ5TWVzc2FnZSgpLlxuICAgICAqL1xuICAgIGdldCBpc1RleHRNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q29ubmVjdGlvbk1lc3NhZ2UubWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLlRleHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0byBzZWUgaWYgdGhlIENvbm5lY3Rpb25NZXNzYWdlIGlzIGEgYmluYXJ5IG1lc3NhZ2UuXG4gICAgICogU2VlIGFsc28gR2V0QmluYXJ5TWVzc2FnZSgpLlxuICAgICAqL1xuICAgIGdldCBpc0JpbmFyeU1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS5tZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuQmluYXJ5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB0ZXh0IG1lc3NhZ2UgcGF5bG9hZC4gVHlwaWNhbGx5IHRoZSB0ZXh0IG1lc3NhZ2UgY29udGVudC10eXBlIGlzXG4gICAgICogYXBwbGljYXRpb24vanNvbi4gVG8gZGV0ZXJtaW5lIG90aGVyIGNvbnRlbnQtdHlwZXMgdXNlXG4gICAgICogUHJvcGVydGllcy5HZXRQcm9wZXJ0eShcIkNvbnRlbnQtVHlwZVwiKS5cbiAgICAgKi9cbiAgICBnZXQgVGV4dE1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZDb25uZWN0aW9uTWVzc2FnZS50ZXh0Qm9keTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYmluYXJ5IG1lc3NhZ2UgcGF5bG9hZC5cbiAgICAgKi9cbiAgICBnZXQgYmluYXJ5TWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlLmJpbmFyeUJvZHk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyA8c2VlIGNyZWY9XCJDb25uZWN0aW9uTWVzc2FnZVwiLz4uXG4gICAgICogTWVzc2FnZSBoZWFkZXJzIGNhbiBiZSBhY2Nlc3NlZCB2aWEgdGhpcyBjb2xsZWN0aW9uIChlLmcuIFwiQ29udGVudC1UeXBlXCIpLlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGNvbm5lY3Rpb24gbWVzc2FnZS5cbiAgICAgKi9cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25uZWN0aW9uTWVzc2FnZS5qcy5tYXBcbiIsIi8vXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UubWQgZmlsZSBpbiB0aGUgcHJvamVjdCByb290IGZvciBmdWxsIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4vL1xuZXhwb3J0IGNsYXNzIENvbm5lY3Rpb25NZXNzYWdlRXZlbnRBcmdzIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlID0gbWVzc2FnZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgPHNlZSBjcmVmPVwiQ29ubmVjdGlvbk1lc3NhZ2VcIi8+IGFzc29jaWF0ZWQgd2l0aCB0aGlzIDxzZWUgY3JlZj1cIkNvbm5lY3Rpb25NZXNzYWdlRXZlbnRBcmdzXCIvPi5cbiAgICAgKi9cbiAgICBnZXQgbWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgY29ubmVjdGlvbiBtZXNzYWdlIGV2ZW50LlxuICAgICAqL1xuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gXCJNZXNzYWdlOiBcIiArIHRoaXMucHJpdkNvbm5lY3Rpb25NZXNzYWdlLnRvU3RyaW5nKCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db25uZWN0aW9uTWVzc2FnZUV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBAY2xhc3MgQ29udHJhY3RzXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgY2xhc3MgQ29udHJhY3RzIHtcbiAgICBzdGF0aWMgdGhyb3dJZk51bGxPclVuZGVmaW5lZChwYXJhbSwgbmFtZSkge1xuICAgICAgICBpZiAocGFyYW0gPT09IHVuZGVmaW5lZCB8fCBwYXJhbSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhyb3dJZk51bGxPclVuZGVmaW5lZDpcIiArIG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmTnVsbChwYXJhbSwgbmFtZSkge1xuICAgICAgICBpZiAocGFyYW0gPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRocm93SWZOdWxsOlwiICsgbmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHBhcmFtLCBuYW1lKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHBhcmFtLCBuYW1lKTtcbiAgICAgICAgaWYgKChcIlwiICsgcGFyYW0pLnRyaW0oKS5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0aHJvd0lmTnVsbE9yV2hpdGVzcGFjZTpcIiArIG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmTnVsbE9yVG9vTG9uZyhwYXJhbSwgbmFtZSwgbWF4TGVuZ3RoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHBhcmFtLCBuYW1lKTtcbiAgICAgICAgaWYgKChcIlwiICsgcGFyYW0pLmxlbmd0aCA+IG1heExlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhyb3dJZk51bGxPclRvb0xvbmc6XCIgKyBuYW1lICsgXCIgKG1vcmUgdGhhbiBcIiArIG1heExlbmd0aC50b1N0cmluZygpICsgXCIgY2hhcmFjdGVycylcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHRocm93SWZOdWxsT3JUb29TaG9ydChwYXJhbSwgbmFtZSwgbWluTGVuZ3RoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHBhcmFtLCBuYW1lKTtcbiAgICAgICAgaWYgKChcIlwiICsgcGFyYW0pLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhyb3dJZk51bGxPclRvb1Nob3J0OlwiICsgbmFtZSArIFwiIChsZXNzIHRoYW4gXCIgKyBtaW5MZW5ndGgudG9TdHJpbmcoKSArIFwiIGNoYXJhY3RlcnMpXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmRGlzcG9zZWQoaXNEaXNwb3NlZCkge1xuICAgICAgICBpZiAoaXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhlIG9iamVjdCBpcyBhbHJlYWR5IGRpc3Bvc2VkXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyB0aHJvd0lmQXJyYXlFbXB0eU9yV2hpdGVzcGFjZShhcnJheSwgbmFtZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChhcnJheSwgbmFtZSk7XG4gICAgICAgIGlmIChhcnJheS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRocm93SWZBcnJheUVtcHR5T3JXaGl0ZXNwYWNlOlwiICsgbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGFycmF5KSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoaXRlbSwgbmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIHRocm93SWZGaWxlRG9lc05vdEV4aXN0KHBhcmFtLCBuYW1lKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShwYXJhbSwgbmFtZSk7XG4gICAgICAgIC8vIFRPRE8gY2hlY2sgZm9yIGZpbGUgZXhpc3RlbmNlLlxuICAgIH1cbiAgICBzdGF0aWMgdGhyb3dJZk5vdFVuZGVmaW5lZChwYXJhbSwgbmFtZSkge1xuICAgICAgICBpZiAocGFyYW0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhyb3dJZk5vdFVuZGVmaW5lZDpcIiArIG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db250cmFjdHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2UsIH0gZnJvbSBcIi4vQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZVwiO1xuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnQgb2YgYSBSZWNvZ25pdGlvbkVycm9yRXZlbnQuXG4gKiBAY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzXG4gKi9cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25UcmFuc2NyaXB0aW9uQ2FuY2VsZWRFdmVudEFyZ3MgZXh0ZW5kcyBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlIHtcbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Q29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IERpYWxvZ1NlcnZpY2VDb25maWcsIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsIH0gZnJvbSBcIi4vRGlhbG9nU2VydmljZUNvbmZpZ1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogQ2xhc3MgdGhhdCBkZWZpbmVzIGNvbmZpZ3VyYXRpb25zIGZvciB0aGUgZGlhbG9nIHNlcnZpY2UgY29ubmVjdG9yIG9iamVjdCBmb3IgdXNpbmcgYSBDdXN0b21Db21tYW5kcyBiYWNrZW5kLlxuICogQGNsYXNzIEN1c3RvbUNvbW1hbmRzQ29uZmlnXG4gKi9cbmV4cG9ydCBjbGFzcyBDdXN0b21Db21tYW5kc0NvbmZpZyBleHRlbmRzIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIEN1c3RvbUNvbW1hbmRzQ29uZmlnLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBib3QgZnJhbWV3b3JrIGNvbmZpZyB3aXRoIHRoZSBzcGVjaWZpZWQgc3Vic2NyaXB0aW9uIGFuZCByZWdpb24uXG4gICAgICogQG1lbWJlciBDdXN0b21Db21tYW5kc0NvbmZpZy5mcm9tU3Vic2NyaXB0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBhcHBsaWNhdGlvbklkIFNwZWVjaCBDb21tYW5kcyBhcHBsaWNhdGlvbiBpZC5cbiAgICAgKiBAcGFyYW0gc3Vic2NyaXB0aW9uIFN1YnNjcmlwdGlvbiBrZXkgYXNzb2NpYXRlZCB3aXRoIHRoZSBib3RcbiAgICAgKiBAcGFyYW0gcmVnaW9uIFRoZSByZWdpb24gbmFtZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcmV0dXJucyB7Q3VzdG9tQ29tbWFuZHNDb25maWd9IEEgbmV3IGJvdCBmcmFtZXdvcmsgY29uZmlnLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tU3Vic2NyaXB0aW9uKGFwcGxpY2F0aW9uSWQsIHN1YnNjcmlwdGlvbiwgcmVnaW9uKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShhcHBsaWNhdGlvbklkLCBcImFwcGxpY2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShzdWJzY3JpcHRpb24sIFwic3Vic2NyaXB0aW9uXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocmVnaW9uLCBcInJlZ2lvblwiKTtcbiAgICAgICAgY29uc3QgY3VzdG9tQ29tbWFuZHNDb25maWcgPSBuZXcgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwoKTtcbiAgICAgICAgY3VzdG9tQ29tbWFuZHNDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRGlhbG9nVHlwZSwgRGlhbG9nU2VydmljZUNvbmZpZy5EaWFsb2dUeXBlcy5DdXN0b21Db21tYW5kcyk7XG4gICAgICAgIGN1c3RvbUNvbW1hbmRzQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWQsIGFwcGxpY2F0aW9uSWQpO1xuICAgICAgICBjdXN0b21Db21tYW5kc0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgY3VzdG9tQ29tbWFuZHNDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIHJldHVybiBjdXN0b21Db21tYW5kc0NvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgYm90IGZyYW1ld29yayBjb25maWcgd2l0aCB0aGUgc3BlY2lmaWVkIFNwZWVjaCBDb21tYW5kcyBhcHBsaWNhdGlvbiBpZCwgYXV0aG9yaXphdGlvbiB0b2tlbiBhbmQgcmVnaW9uLlxuICAgICAqIE5vdGU6IFRoZSBjYWxsZXIgbmVlZHMgdG8gZW5zdXJlIHRoYXQgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gaXMgdmFsaWQuIEJlZm9yZSB0aGUgYXV0aG9yaXphdGlvbiB0b2tlblxuICAgICAqIGV4cGlyZXMsIHRoZSBjYWxsZXIgbmVlZHMgdG8gcmVmcmVzaCBpdCBieSBjYWxsaW5nIHRoaXMgc2V0dGVyIHdpdGggYSBuZXcgdmFsaWQgdG9rZW4uXG4gICAgICogQXMgY29uZmlndXJhdGlvbiB2YWx1ZXMgYXJlIGNvcGllZCB3aGVuIGNyZWF0aW5nIGEgbmV3IHJlY29nbml6ZXIsIHRoZSBuZXcgdG9rZW4gdmFsdWUgd2lsbCBub3QgYXBwbHkgdG8gcmVjb2duaXplcnMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiBjcmVhdGVkLlxuICAgICAqIEZvciByZWNvZ25pemVycyB0aGF0IGhhdmUgYmVlbiBjcmVhdGVkIGJlZm9yZSwgeW91IG5lZWQgdG8gc2V0IGF1dGhvcml6YXRpb24gdG9rZW4gb2YgdGhlIGNvcnJlc3BvbmRpbmcgcmVjb2duaXplclxuICAgICAqIHRvIHJlZnJlc2ggdGhlIHRva2VuLiBPdGhlcndpc2UsIHRoZSByZWNvZ25pemVycyB3aWxsIGVuY291bnRlciBlcnJvcnMgZHVyaW5nIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgQ3VzdG9tQ29tbWFuZHNDb25maWcuZnJvbUF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gYXBwbGljYXRpb25JZCBTcGVlY2ggQ29tbWFuZHMgYXBwbGljYXRpb24gaWQuXG4gICAgICogQHBhcmFtIGF1dGhvcml6YXRpb25Ub2tlbiBUaGUgYXV0aG9yaXphdGlvbiB0b2tlbiBhc3NvY2lhdGVkIHdpdGggdGhlIGFwcGxpY2F0aW9uLlxuICAgICAqIEBwYXJhbSByZWdpb24gVGhlIHJlZ2lvbiBuYW1lIChzZWUgdGhlIDxhIGhyZWY9XCJodHRwczovL2FrYS5tcy9jc3NwZWVjaC9yZWdpb25cIj5yZWdpb24gcGFnZTwvYT4pLlxuICAgICAqIEByZXR1cm5zIHtDdXN0b21Db21tYW5kc0NvbmZpZ30gQSBuZXcgc3BlZWNoIGNvbW1hbmRzIGNvbmZpZy5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUF1dGhvcml6YXRpb25Ub2tlbihhcHBsaWNhdGlvbklkLCBhdXRob3JpemF0aW9uVG9rZW4sIHJlZ2lvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXBwbGljYXRpb25JZCwgXCJhcHBsaWNhdGlvbklkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXV0aG9yaXphdGlvblRva2VuLCBcImF1dGhvcml6YXRpb25Ub2tlblwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IGN1c3RvbUNvbW1hbmRzQ29uZmlnID0gbmV3IERpYWxvZ1NlcnZpY2VDb25maWdJbXBsKCk7XG4gICAgICAgIGN1c3RvbUNvbW1hbmRzQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGUsIERpYWxvZ1NlcnZpY2VDb25maWcuRGlhbG9nVHlwZXMuQ3VzdG9tQ29tbWFuZHMpO1xuICAgICAgICBjdXN0b21Db21tYW5kc0NvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkLCBhcHBsaWNhdGlvbklkKTtcbiAgICAgICAgY3VzdG9tQ29tbWFuZHNDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgYXV0aG9yaXphdGlvblRva2VuKTtcbiAgICAgICAgY3VzdG9tQ29tbWFuZHNDb25maWcuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIHJldHVybiBjdXN0b21Db21tYW5kc0NvbmZpZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgY29ycmVzcG9uZGluZyBiYWNrZW5kIGFwcGxpY2F0aW9uIGlkZW50aWZpZXIuXG4gICAgICogQG1lbWJlciBDdXN0b21Db21tYW5kc0NvbmZpZy5wcm90b3R5cGUuQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGFwcGxpY2F0aW9uIGlkZW50aWZpZXIgdG8gc2V0LlxuICAgICAqL1xuICAgIHNldCBhcHBsaWNhdGlvbklkKHZhbHVlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh2YWx1ZSwgXCJ2YWx1ZVwiKTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkLCB2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGNvcnJlc3BvbmRpbmcgYmFja2VuZCBhcHBsaWNhdGlvbiBpZGVudGlmaWVyLlxuICAgICAqIEBtZW1iZXIgQ3VzdG9tQ29tbWFuZHNDb25maWcucHJvdG90eXBlLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSBhcHBsaWNhdGlvbiBpZGVudGlmaWVyIHRvIGdldC5cbiAgICAgKi9cbiAgICBnZXQgYXBwbGljYXRpb25JZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQXBwbGljYXRpb25JZCk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DdXN0b21Db21tYW5kc0NvbmZpZy5qcy5tYXBcbiIsIi8vXG4vLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4gU2VlIExJQ0VOU0UubWQgZmlsZSBpbiB0aGUgcHJvamVjdCByb290IGZvciBmdWxsIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4vL1xuaW1wb3J0IHsgQ29uc29sZUxvZ2dpbmdMaXN0ZW5lciB9IGZyb20gXCIuLi9jb21tb24uYnJvd3Nlci9FeHBvcnRzXCI7XG5pbXBvcnQgeyBFdmVudHMgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBkaWFnbm9zdGljcyBBUEkgZm9yIG1hbmFnaW5nIGNvbnNvbGUgb3V0cHV0XG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjEuMFxuICovXG5leHBvcnQgY2xhc3MgRGlhZ25vc3RpY3Mge1xuICAgIHN0YXRpYyBTZXRMb2dnaW5nTGV2ZWwobG9nTGV2ZWwpIHtcbiAgICAgICAgdGhpcy5wcml2TGlzdGVuZXIgPSBuZXcgQ29uc29sZUxvZ2dpbmdMaXN0ZW5lcihsb2dMZXZlbCk7XG4gICAgICAgIEV2ZW50cy5pbnN0YW5jZS5hdHRhY2hDb25zb2xlTGlzdGVuZXIodGhpcy5wcml2TGlzdGVuZXIpO1xuICAgIH1cbiAgICBzdGF0aWMgU3RhcnRDb25zb2xlT3V0cHV0KCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5wcml2TGlzdGVuZXIuZW5hYmxlQ29uc29sZU91dHB1dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3RhdGljIFN0b3BDb25zb2xlT3V0cHV0KCkge1xuICAgICAgICBpZiAoISF0aGlzLnByaXZMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5wcml2TGlzdGVuZXIuZW5hYmxlQ29uc29sZU91dHB1dCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBTZXRMb2dPdXRwdXRQYXRoKHBhdGgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2TGlzdGVuZXIubG9nUGF0aCA9IHBhdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGaWxlIHN5c3RlbSBsb2dnaW5nIG5vdCBhdmFpbGFibGUgaW4gYnJvd3Nlci5cIik7XG4gICAgICAgIH1cbiAgICB9XG59XG5EaWFnbm9zdGljcy5wcml2TGlzdGVuZXIgPSB1bmRlZmluZWQ7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWdub3N0aWNzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkLCBTcGVlY2hDb25maWdJbXBsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBDbGFzcyB0aGF0IGRlZmluZXMgYmFzZSBjb25maWd1cmF0aW9ucyBmb3IgZGlhbG9nIHNlcnZpY2UgY29ubmVjdG9yXG4gKiBAY2xhc3MgRGlhbG9nU2VydmljZUNvbmZpZ1xuICovXG5leHBvcnQgY2xhc3MgRGlhbG9nU2VydmljZUNvbmZpZyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBEaWFsb2dTZXJ2aWNlIGNvbmZpZy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBjb3JyZXNwb25kaW5nIGJhY2tlbmQgYXBwbGljYXRpb24gaWRlbnRpZmllci5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25maWcucHJvdG90eXBlLkNvbnZlcnNhdGlvbl9BcHBsaWNhdGlvbklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSBhcHBsaWNhdGlvbiBpZGVudGlmaWVyIHRvIHNldC5cbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgc2V0IGFwcGxpY2F0aW9uSWQodmFsdWUpIHsgfVxuICAgIHN0YXRpYyBnZXQgRGlhbG9nVHlwZXMoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBCb3RGcmFtZXdvcms6IFwiYm90X2ZyYW1ld29ya1wiLFxuICAgICAgICAgICAgQ3VzdG9tQ29tbWFuZHM6IFwiY3VzdG9tX2NvbW1hbmRzXCJcbiAgICAgICAgfTtcbiAgICB9XG59XG4vKipcbiAqIERpYWxvZyBTZXJ2aWNlIGNvbmZpZ3VyYXRpb24uXG4gKiBAY2xhc3MgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIERpYWxvZ1NlcnZpY2VDb25maWdJbXBsIGV4dGVuZHMgRGlhbG9nU2VydmljZUNvbmZpZyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBkaWFsb2dTZXJ2aWNlIGNvbmZpZy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29uZmlnID0gbmV3IFNwZWVjaENvbmZpZ0ltcGwoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJvdmlkZXMgYWNjZXNzIHRvIGN1c3RvbSBwcm9wZXJ0aWVzLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIHByb3BlcnRpZXMuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hDb25maWcucHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3BlZWNoIHJlY29nbml0aW9uIGxhbmd1YWdlLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvdG90eXBlLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hDb25maWcuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgc3BlZWNoIHJlY29nbml0aW9uIGxhbmd1YWdlLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbmZpZ0ltcGwucHJvdG90eXBlLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGxhbmd1YWdlIHRvIHNldC5cbiAgICAgKi9cbiAgICBzZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSh2YWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodmFsdWUsIFwidmFsdWVcIik7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaENvbmZpZy5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlID0gdmFsdWU7XG4gICAgfVxuICAgIGdldCBvdXRwdXRGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hDb25maWcub3V0cHV0Rm9ybWF0O1xuICAgIH1cbiAgICBzZXQgb3V0cHV0Rm9ybWF0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaENvbmZpZy5vdXRwdXRGb3JtYXQgPSB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyBhIG5hbWVkIHByb3BlcnR5IGFzIHZhbHVlXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbC5wcm90b3R5cGUuc2V0UHJvcGVydHlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUlkIHwgc3RyaW5nfSBuYW1lIC0gVGhlIHByb3BlcnR5IHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgdmFsdWUuXG4gICAgICovXG4gICAgc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29uZmlnLnNldFByb3BlcnR5KG5hbWUsIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyBhIG5hbWVkIHByb3BlcnR5IGFzIHZhbHVlXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbC5wcm90b3R5cGUuZ2V0UHJvcGVydHlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUlkIHwgc3RyaW5nfSBuYW1lIC0gVGhlIHByb3BlcnR5IHRvIGdldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGVmIC0gVGhlIGRlZmF1bHQgdmFsdWUgdG8gcmV0dXJuIGluIGNhc2UgdGhlIHByb3BlcnR5IGlzIG5vdCBrbm93bi5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY3VycmVudCB2YWx1ZSwgb3IgcHJvdmlkZWQgZGVmYXVsdCwgb2YgdGhlIGdpdmVuIHByb3BlcnR5LlxuICAgICAqL1xuICAgIGdldFByb3BlcnR5KG5hbWUsIGRlZikge1xuICAgICAgICB2b2lkIGRlZjtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaENvbmZpZy5nZXRQcm9wZXJ0eShuYW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJveHkgY29uZmlndXJhdGlvbi5cbiAgICAgKiBPbmx5IHJlbGV2YW50IGluIE5vZGUuanMgZW52aXJvbm1lbnRzLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS40LjAuXG4gICAgICogQHBhcmFtIHByb3h5SG9zdE5hbWUgVGhlIGhvc3QgbmFtZSBvZiB0aGUgcHJveHkgc2VydmVyLCB3aXRob3V0IHRoZSBwcm90b2NvbCBzY2hlbWUgKGh0dHA6Ly8pXG4gICAgICogQHBhcmFtIHByb3h5UG9ydCBUaGUgcG9ydCBudW1iZXIgb2YgdGhlIHByb3h5IHNlcnZlci5cbiAgICAgKiBAcGFyYW0gcHJveHlVc2VyTmFtZSBUaGUgdXNlciBuYW1lIG9mIHRoZSBwcm94eSBzZXJ2ZXIuXG4gICAgICogQHBhcmFtIHByb3h5UGFzc3dvcmQgVGhlIHBhc3N3b3JkIG9mIHRoZSBwcm94eSBzZXJ2ZXIuXG4gICAgICovXG4gICAgc2V0UHJveHkocHJveHlIb3N0TmFtZSwgcHJveHlQb3J0LCBwcm94eVVzZXJOYW1lLCBwcm94eVBhc3N3b3JkKSB7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lLCBwcm94eUhvc3ROYW1lKTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UG9ydCwgYCR7cHJveHlQb3J0fWApO1xuICAgICAgICBpZiAocHJveHlVc2VyTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWUsIHByb3h5VXNlck5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm94eVBhc3N3b3JkKSB7XG4gICAgICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZCwgcHJveHlQYXNzd29yZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0U2VydmljZVByb3BlcnR5KG5hbWUsIHZhbHVlLCBjaGFubmVsKSB7XG4gICAgICAgIHZvaWQgY2hhbm5lbDtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoQ29uZmlnLnNldFNlcnZpY2VQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2Ugb2YgYXNzb2NpYXRlZCByZXNvdXJjZXMuXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWxvZ1NlcnZpY2VDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgRGlhbG9nQ29ubmVjdGlvbkZhY3RvcnkgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9EaWFsb2dDb25uZWN0b3JGYWN0b3J5XCI7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlQWRhcHRlciwgUmVjb2duaXRpb25Nb2RlLCBSZWNvZ25pemVyQ29uZmlnIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgRGVmZXJyZWQsIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUmVjb2duaXplciB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi9Qcm9wZXJ0eUlkXCI7XG4vKipcbiAqIERpYWxvZyBTZXJ2aWNlIENvbm5lY3RvclxuICogQGNsYXNzIERpYWxvZ1NlcnZpY2VDb25uZWN0b3JcbiAqL1xuZXhwb3J0IGNsYXNzIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGUgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0RpYWxvZ1NlcnZpY2VDb25maWd9IGRpYWxvZ0NvbmZpZyAtIFNldCBvZiBwcm9wZXJ0aWVzIHRvIGNvbmZpZ3VyZSB0aGlzIHJlY29nbml6ZXIuXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBjb25maWcgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZGlhbG9nQ29uZmlnLCBhdWRpb0NvbmZpZykge1xuICAgICAgICBjb25zdCBkaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbCA9IGRpYWxvZ0NvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGRpYWxvZ0NvbmZpZywgXCJkaWFsb2dDb25maWdcIik7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnLCBkaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbC5wcm9wZXJ0aWVzLCBuZXcgRGlhbG9nQ29ubmVjdGlvbkZhY3RvcnkoKSk7XG4gICAgICAgIHRoaXMuaXNUdXJuQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBkaWFsb2dTZXJ2aWNlQ29uZmlnSW1wbC5wcm9wZXJ0aWVzLmNsb25lKCk7XG4gICAgICAgIGNvbnN0IGFnZW50Q29uZmlnID0gdGhpcy5idWlsZEFnZW50Q29uZmlnKCk7XG4gICAgICAgIHRoaXMucHJpdlJlY28uYWdlbnRDb25maWcuc2V0KGFnZW50Q29uZmlnKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIGEgY29ubmVjdGlvbiB0byB0aGUgc2VydmljZS5cbiAgICAgKiBVc2VycyBjYW4gb3B0aW9uYWxseSBjYWxsIGNvbm5lY3QoKSB0byBtYW51YWxseSBzZXQgdXAgYSBjb25uZWN0aW9uIGluIGFkdmFuY2UsIGJlZm9yZSBzdGFydGluZyBpbnRlcmFjdGlvbnMuXG4gICAgICpcbiAgICAgKiBOb3RlOiBPbiByZXR1cm4sIHRoZSBjb25uZWN0aW9uIG1pZ2h0IG5vdCBiZSByZWFkeSB5ZXQuIFBsZWFzZSBzdWJzY3JpYmUgdG8gdGhlIENvbm5lY3RlZCBldmVudCB0b1xuICAgICAqIGJlIG5vdGlmaWVkIHdoZW4gdGhlIGNvbm5lY3Rpb24gaXMgZXN0YWJsaXNoZWQuXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnByb3RvdHlwZS5jb25uZWN0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNvbm5lY3QoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucHJpdlJlY28uY29ubmVjdCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBjb25uZWN0aW9uIHRoZSBzZXJ2aWNlLlxuICAgICAqIFVzZXJzIGNhbiBvcHRpb25hbGx5IGNhbGwgZGlzY29ubmVjdCgpIHRvIG1hbnVhbGx5IHNodXRkb3duIHRoZSBjb25uZWN0aW9uIG9mIHRoZSBhc3NvY2lhdGVkIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IuXG4gICAgICpcbiAgICAgKiBJZiBkaXNjb25uZWN0KCkgaXMgY2FsbGVkIGR1cmluZyBhIHJlY29nbml0aW9uLCByZWNvZ25pdGlvbiB3aWxsIGZhaWwgYW5kIGNhbmNlbCB3aXRoIGFuIGVycm9yLlxuICAgICAqL1xuICAgIGRpc2Nvbm5lY3QoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucHJpdlJlY28uZGlzY29ubmVjdCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBnZXQgYXV0aG9yaXphdGlvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIERpYWxvZ1NlcnZpY2VDb25uZWN0b3IucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdG9rZW4gLSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odG9rZW4pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRva2VuLCBcInRva2VuXCIpO1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBEaWFsb2dTZXJ2aWNlQ29ubmVjdG9yLlxuICAgICAqL1xuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqIEdldHMgdGhlIHRlbXBsYXRlIGZvciB0aGUgYWN0aXZpdHkgZ2VuZXJhdGVkIGJ5IHNlcnZpY2UgZnJvbSBzcGVlY2guXG4gICAgICogUHJvcGVydGllcyBmcm9tIHRoZSB0ZW1wbGF0ZSB3aWxsIGJlIHN0YW1wZWQgb24gdGhlIGdlbmVyYXRlZCBhY3Rpdml0eS5cbiAgICAgKiBJdCBjYW4gYmUgZW1wdHlcbiAgICAgKi9cbiAgICBnZXQgc3BlZWNoQWN0aXZpdHlUZW1wbGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9TcGVlY2hfQWN0aXZpdHlfVGVtcGxhdGUpO1xuICAgIH1cbiAgICAvKiogU2V0cyB0aGUgdGVtcGxhdGUgZm9yIHRoZSBhY3Rpdml0eSBnZW5lcmF0ZWQgYnkgc2VydmljZSBmcm9tIHNwZWVjaC5cbiAgICAgKiBQcm9wZXJ0aWVzIGZyb20gdGhlIHRlbXBsYXRlIHdpbGwgYmUgc3RhbXBlZCBvbiB0aGUgZ2VuZXJhdGVkIGFjdGl2aXR5LlxuICAgICAqIEl0IGNhbiBiZSBudWxsIG9yIGVtcHR5LlxuICAgICAqIE5vdGU6IGl0IGhhcyB0byBiZSBhIHZhbGlkIEpzb24gb2JqZWN0LlxuICAgICAqL1xuICAgIHNldCBzcGVlY2hBY3Rpdml0eVRlbXBsYXRlKHNwZWVjaEFjdGl2aXR5VGVtcGxhdGUpIHtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX1NwZWVjaF9BY3Rpdml0eV9UZW1wbGF0ZSwgc3BlZWNoQWN0aXZpdHlUZW1wbGF0ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyByZWNvZ25pdGlvbiBhbmQgc3RvcHMgYWZ0ZXIgdGhlIGZpcnN0IHV0dGVyYW5jZSBpcyByZWNvZ25pemVkLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5wcm90b3R5cGUubGlzdGVuT25jZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIHRoYXQgcmVjZWl2ZWQgdGhlIHJlc3VsdCB3aGVuIHRoZSByZWNvIGhhcyBjb21wbGV0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBsaXN0ZW5PbmNlQXN5bmMoY2IsIGVycikge1xuICAgICAgICBpZiAodGhpcy5pc1R1cm5Db21wbGV0ZSkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrSG9sZGVyID0gKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlY28uY29ubmVjdCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1R1cm5Db21wbGV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJldCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlY28ucmVjb2duaXplKFJlY29nbml0aW9uTW9kZS5Db252ZXJzYXRpb24sIHJldC5yZXNvbHZlLCByZXQucmVqZWN0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0geWllbGQgcmV0LnByb21pc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5pbXBsUmVjb2duaXplclN0b3AoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgcmV0UHJvbWlzZSA9IGNhbGxiYWNrSG9sZGVyKCk7XG4gICAgICAgICAgICByZXRQcm9taXNlLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBEZXN0cm95IHRoZSByZWNvZ25pemVyLlxuICAgICAgICAgICAgICAgIC8vIFdlJ3ZlIGRvbmUgYWxsIHdlIGNhbiBoZXJlLlxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2UodHJ1ZSkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyhyZXRQcm9taXNlLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNUdXJuQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgfSksIGNiLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbmRBY3Rpdml0eUFzeW5jKGFjdGl2aXR5LCBjYiwgZXJyQ2IpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnByaXZSZWNvLnNlbmRNZXNzYWdlKGFjdGl2aXR5KSwgY2IsIGVyckNiKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogY2xvc2VzIGFsbCBleHRlcm5hbCByZXNvdXJjZXMgaGVsZCBieSBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBtZW1iZXIgRGlhbG9nU2VydmljZUNvbm5lY3Rvci5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoY2IsIGVycikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGlzcG9zZSh0cnVlKSwgY2IsIGVycik7XG4gICAgfVxuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZJc0Rpc3Bvc2VkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcml2UHJvcGVydGllcyk7XG4gICAgfVxuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgYXVkaW9Tb3VyY2UgPSBhdWRpb0NvbmZpZztcbiAgICAgICAgcmV0dXJuIG5ldyBEaWFsb2dTZXJ2aWNlQWRhcHRlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvU291cmNlLCByZWNvZ25pemVyQ29uZmlnLCB0aGlzKTtcbiAgICB9XG4gICAgYnVpbGRBZ2VudENvbmZpZygpIHtcbiAgICAgICAgY29uc3QgY29tbXVuaWNhdGlvblR5cGUgPSB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoXCJDb252ZXJzYXRpb25fQ29tbXVuaWNhdGlvbl9UeXBlXCIsIFwiRGVmYXVsdFwiKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJvdEluZm86IHtcbiAgICAgICAgICAgICAgICBjb21tVHlwZTogY29tbXVuaWNhdGlvblR5cGUsXG4gICAgICAgICAgICAgICAgY29tbWFuZHNDdWx0dXJlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbklkOiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQWdlbnRfQ29ubmVjdGlvbl9JZCksXG4gICAgICAgICAgICAgICAgY29udmVyc2F0aW9uSWQ6IHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9Db252ZXJzYXRpb25fSWQsIHVuZGVmaW5lZCksXG4gICAgICAgICAgICAgICAgZnJvbUlkOiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25fRnJvbV9JZCwgdW5kZWZpbmVkKSxcbiAgICAgICAgICAgICAgICB0dHNBdWRpb0Zvcm1hdDogdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhPdXRwdXRGb3JtYXQsIHVuZGVmaW5lZClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB2ZXJzaW9uOiAwLjJcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPURpYWxvZ1NlcnZpY2VDb25uZWN0b3IuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmV4cG9ydCB7IEF1ZGlvQ29uZmlnIH0gZnJvbSBcIi4vQXVkaW8vQXVkaW9Db25maWdcIjtcbmV4cG9ydCB7IEF1ZGlvU3RyZWFtRm9ybWF0LCBBdWRpb0Zvcm1hdFRhZyB9IGZyb20gXCIuL0F1ZGlvL0F1ZGlvU3RyZWFtRm9ybWF0XCI7XG5leHBvcnQgeyBBdWRpb0lucHV0U3RyZWFtLCBQdWxsQXVkaW9JbnB1dFN0cmVhbSwgUHVzaEF1ZGlvSW5wdXRTdHJlYW0gfSBmcm9tIFwiLi9BdWRpby9BdWRpb0lucHV0U3RyZWFtXCI7XG5leHBvcnQgeyBBdWRpb091dHB1dFN0cmVhbSwgUHVsbEF1ZGlvT3V0cHV0U3RyZWFtLCBQdXNoQXVkaW9PdXRwdXRTdHJlYW0gfSBmcm9tIFwiLi9BdWRpby9BdWRpb091dHB1dFN0cmVhbVwiO1xuZXhwb3J0IHsgQ2FuY2VsbGF0aW9uUmVhc29uIH0gZnJvbSBcIi4vQ2FuY2VsbGF0aW9uUmVhc29uXCI7XG5leHBvcnQgeyBQdWxsQXVkaW9JbnB1dFN0cmVhbUNhbGxiYWNrIH0gZnJvbSBcIi4vQXVkaW8vUHVsbEF1ZGlvSW5wdXRTdHJlYW1DYWxsYmFja1wiO1xuZXhwb3J0IHsgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2sgfSBmcm9tIFwiLi9BdWRpby9QdXNoQXVkaW9PdXRwdXRTdHJlYW1DYWxsYmFja1wiO1xuZXhwb3J0IHsgS2V5d29yZFJlY29nbml0aW9uTW9kZWwgfSBmcm9tIFwiLi9LZXl3b3JkUmVjb2duaXRpb25Nb2RlbFwiO1xuZXhwb3J0IHsgU2Vzc2lvbkV2ZW50QXJncyB9IGZyb20gXCIuL1Nlc3Npb25FdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vUmVjb2duaXRpb25FdmVudEFyZ3NcIjtcbmV4cG9ydCB7IE91dHB1dEZvcm1hdCB9IGZyb20gXCIuL091dHB1dEZvcm1hdFwiO1xuZXhwb3J0IHsgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9JbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi9SZWNvZ25pdGlvblJlc3VsdFwiO1xuZXhwb3J0IHsgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi9TcGVlY2hSZWNvZ25pdGlvblJlc3VsdFwiO1xuZXhwb3J0IHsgSW50ZW50UmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi9JbnRlbnRSZWNvZ25pdGlvblJlc3VsdFwiO1xuZXhwb3J0IHsgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWwgfSBmcm9tIFwiLi9MYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbFwiO1xuZXhwb3J0IHsgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9TcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgU3BlZWNoUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncyB9IGZyb20gXCIuL1NwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFRyYW5zbGF0aW9uUmVjb2duaXRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9UcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBUcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJncyB9IGZyb20gXCIuL1RyYW5zbGF0aW9uU3ludGhlc2lzRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdFwiO1xuZXhwb3J0IHsgVHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHQgfSBmcm9tIFwiLi9UcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdFwiO1xuZXhwb3J0IHsgUmVzdWx0UmVhc29uIH0gZnJvbSBcIi4vUmVzdWx0UmVhc29uXCI7XG5leHBvcnQgeyBTcGVlY2hDb25maWcsIFNwZWVjaENvbmZpZ0ltcGwgfSBmcm9tIFwiLi9TcGVlY2hDb25maWdcIjtcbmV4cG9ydCB7IFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLCBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwgfSBmcm9tIFwiLi9TcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ1wiO1xuZXhwb3J0IHsgUHJvcGVydHlDb2xsZWN0aW9uIH0gZnJvbSBcIi4vUHJvcGVydHlDb2xsZWN0aW9uXCI7XG5leHBvcnQgeyBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4vUHJvcGVydHlJZFwiO1xuZXhwb3J0IHsgUmVjb2duaXplciB9IGZyb20gXCIuL1JlY29nbml6ZXJcIjtcbmV4cG9ydCB7IFNwZWVjaFJlY29nbml6ZXIgfSBmcm9tIFwiLi9TcGVlY2hSZWNvZ25pemVyXCI7XG5leHBvcnQgeyBJbnRlbnRSZWNvZ25pemVyIH0gZnJvbSBcIi4vSW50ZW50UmVjb2duaXplclwiO1xuZXhwb3J0IHsgVm9pY2VQcm9maWxlVHlwZSB9IGZyb20gXCIuL1ZvaWNlUHJvZmlsZVR5cGVcIjtcbmV4cG9ydCB7IFRyYW5zbGF0aW9uUmVjb2duaXplciB9IGZyb20gXCIuL1RyYW5zbGF0aW9uUmVjb2duaXplclwiO1xuZXhwb3J0IHsgVHJhbnNsYXRpb25zIH0gZnJvbSBcIi4vVHJhbnNsYXRpb25zXCI7XG5leHBvcnQgeyBOb01hdGNoUmVhc29uIH0gZnJvbSBcIi4vTm9NYXRjaFJlYXNvblwiO1xuZXhwb3J0IHsgTm9NYXRjaERldGFpbHMgfSBmcm9tIFwiLi9Ob01hdGNoRGV0YWlsc1wiO1xuZXhwb3J0IHsgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzIH0gZnJvbSBcIi4vVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBJbnRlbnRSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzIH0gZnJvbSBcIi4vSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UgfSBmcm9tIFwiLi9DYW5jZWxsYXRpb25EZXRhaWxzQmFzZVwiO1xuZXhwb3J0IHsgQ2FuY2VsbGF0aW9uRGV0YWlscyB9IGZyb20gXCIuL0NhbmNlbGxhdGlvbkRldGFpbHNcIjtcbmV4cG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZSB9IGZyb20gXCIuL0NhbmNlbGxhdGlvbkVycm9yQ29kZXNcIjtcbmV4cG9ydCB7IENvbm5lY3Rpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9Db25uZWN0aW9uRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBTZXJ2aWNlRXZlbnRBcmdzIH0gZnJvbSBcIi4vU2VydmljZUV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgQ29ubmVjdGlvbiB9IGZyb20gXCIuL0Nvbm5lY3Rpb25cIjtcbmV4cG9ydCB7IFBocmFzZUxpc3RHcmFtbWFyIH0gZnJvbSBcIi4vUGhyYXNlTGlzdEdyYW1tYXJcIjtcbmV4cG9ydCB7IERpYWxvZ1NlcnZpY2VDb25maWcgfSBmcm9tIFwiLi9EaWFsb2dTZXJ2aWNlQ29uZmlnXCI7XG5leHBvcnQgeyBCb3RGcmFtZXdvcmtDb25maWcgfSBmcm9tIFwiLi9Cb3RGcmFtZXdvcmtDb25maWdcIjtcbmV4cG9ydCB7IEN1c3RvbUNvbW1hbmRzQ29uZmlnIH0gZnJvbSBcIi4vQ3VzdG9tQ29tbWFuZHNDb25maWdcIjtcbmV4cG9ydCB7IERpYWxvZ1NlcnZpY2VDb25uZWN0b3IgfSBmcm9tIFwiLi9EaWFsb2dTZXJ2aWNlQ29ubmVjdG9yXCI7XG5leHBvcnQgeyBBY3Rpdml0eVJlY2VpdmVkRXZlbnRBcmdzIH0gZnJvbSBcIi4vQWN0aXZpdHlSZWNlaXZlZEV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzIH0gZnJvbSBcIi4vVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBTZXJ2aWNlUHJvcGVydHlDaGFubmVsIH0gZnJvbSBcIi4vU2VydmljZVByb3BlcnR5Q2hhbm5lbFwiO1xuZXhwb3J0IHsgUHJvZmFuaXR5T3B0aW9uIH0gZnJvbSBcIi4vUHJvZmFuaXR5T3B0aW9uXCI7XG5leHBvcnQgeyBCYXNlQXVkaW9QbGF5ZXIgfSBmcm9tIFwiLi9BdWRpby9CYXNlQXVkaW9QbGF5ZXJcIjtcbmV4cG9ydCB7IENvbm5lY3Rpb25NZXNzYWdlRXZlbnRBcmdzIH0gZnJvbSBcIi4vQ29ubmVjdGlvbk1lc3NhZ2VFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IENvbm5lY3Rpb25NZXNzYWdlIH0gZnJvbSBcIi4vQ29ubmVjdGlvbk1lc3NhZ2VcIjtcbmV4cG9ydCB7IFZvaWNlUHJvZmlsZSB9IGZyb20gXCIuL1ZvaWNlUHJvZmlsZVwiO1xuZXhwb3J0IHsgVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdCwgVm9pY2VQcm9maWxlRW5yb2xsbWVudENhbmNlbGxhdGlvbkRldGFpbHMgfSBmcm9tIFwiLi9Wb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0XCI7XG5leHBvcnQgeyBWb2ljZVByb2ZpbGVSZXN1bHQsIFZvaWNlUHJvZmlsZUNhbmNlbGxhdGlvbkRldGFpbHMgfSBmcm9tIFwiLi9Wb2ljZVByb2ZpbGVSZXN1bHRcIjtcbmV4cG9ydCB7IFZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdCB9IGZyb20gXCIuL1ZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdFwiO1xuZXhwb3J0IHsgVm9pY2VQcm9maWxlQ2xpZW50IH0gZnJvbSBcIi4vVm9pY2VQcm9maWxlQ2xpZW50XCI7XG5leHBvcnQgeyBTcGVha2VyUmVjb2duaXplciB9IGZyb20gXCIuL1NwZWFrZXJSZWNvZ25pemVyXCI7XG5leHBvcnQgeyBTcGVha2VySWRlbnRpZmljYXRpb25Nb2RlbCB9IGZyb20gXCIuL1NwZWFrZXJJZGVudGlmaWNhdGlvbk1vZGVsXCI7XG5leHBvcnQgeyBTcGVha2VyVmVyaWZpY2F0aW9uTW9kZWwgfSBmcm9tIFwiLi9TcGVha2VyVmVyaWZpY2F0aW9uTW9kZWxcIjtcbmV4cG9ydCB7IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZyB9IGZyb20gXCIuL0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ1wiO1xuZXhwb3J0IHsgQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0IH0gZnJvbSBcIi4vQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlUmVzdWx0XCI7XG5leHBvcnQgeyBTb3VyY2VMYW5ndWFnZUNvbmZpZyB9IGZyb20gXCIuL1NvdXJjZUxhbmd1YWdlQ29uZmlnXCI7XG5leHBvcnQgeyBTcGVha2VyUmVjb2duaXRpb25SZXN1bHQsIFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUsIFNwZWFrZXJSZWNvZ25pdGlvbkNhbmNlbGxhdGlvbkRldGFpbHMgfSBmcm9tIFwiLi9TcGVha2VyUmVjb2duaXRpb25SZXN1bHRcIjtcbmV4cG9ydCB7IENvbnZlcnNhdGlvbiwgQ29udmVyc2F0aW9uRXhwaXJhdGlvbkV2ZW50QXJncywgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncywgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncywgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25FdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0LCBDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBDb252ZXJzYXRpb25UcmFuc2NyaWJlciwgUGFydGljaXBhbnQsIFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbiwgVXNlciB9IGZyb20gXCIuL1RyYW5zY3JpcHRpb24vRXhwb3J0c1wiO1xuZXhwb3J0IHsgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0IH0gZnJvbSBcIi4vU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0XCI7XG5leHBvcnQgeyBTcGVlY2hTeW50aGVzaXplciB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpemVyXCI7XG5leHBvcnQgeyBTeW50aGVzaXNSZXN1bHQgfSBmcm9tIFwiLi9TeW50aGVzaXNSZXN1bHRcIjtcbmV4cG9ydCB7IFNwZWVjaFN5bnRoZXNpc1Jlc3VsdCB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpc1Jlc3VsdFwiO1xuZXhwb3J0IHsgU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzIH0gZnJvbSBcIi4vU3BlZWNoU3ludGhlc2lzRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MgfSBmcm9tIFwiLi9TcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzIH0gZnJvbSBcIi4vU3BlZWNoU3ludGhlc2lzQm9va21hcmtFdmVudEFyZ3NcIjtcbmV4cG9ydCB7IFNwZWVjaFN5bnRoZXNpc1Zpc2VtZUV2ZW50QXJncyB9IGZyb20gXCIuL1NwZWVjaFN5bnRoZXNpc1Zpc2VtZUV2ZW50QXJnc1wiO1xuZXhwb3J0IHsgU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlIH0gZnJvbSBcIi4vU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlXCI7XG5leHBvcnQgeyBTeW50aGVzaXNWb2ljZXNSZXN1bHQgfSBmcm9tIFwiLi9TeW50aGVzaXNWb2ljZXNSZXN1bHRcIjtcbmV4cG9ydCB7IFZvaWNlSW5mbyB9IGZyb20gXCIuL1ZvaWNlSW5mb1wiO1xuZXhwb3J0IHsgU3BlYWtlckF1ZGlvRGVzdGluYXRpb24gfSBmcm9tIFwiLi9BdWRpby9TcGVha2VyQXVkaW9EZXN0aW5hdGlvblwiO1xuZXhwb3J0IHsgQ29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzIH0gZnJvbSBcIi4vQ29udmVyc2F0aW9uVHJhbnNjcmlwdGlvbkNhbmNlbGVkRXZlbnRBcmdzXCI7XG5leHBvcnQgeyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0gfSBmcm9tIFwiLi9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW1cIjtcbmV4cG9ydCB7IFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkgfSBmcm9tIFwiLi9Qcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5XCI7XG5leHBvcnQgeyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZyB9IGZyb20gXCIuL1Byb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnXCI7XG5leHBvcnQgeyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdCB9IGZyb20gXCIuL1Byb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0XCI7XG5leHBvcnQgeyBMYW5ndWFnZUlkTW9kZSB9IGZyb20gXCIuL0xhbmd1YWdlSWRNb2RlXCI7XG5leHBvcnQgeyBEaWFnbm9zdGljcyB9IGZyb20gXCIuL0RpYWdub3N0aWNzXCI7XG5leHBvcnQgeyBMb2dMZXZlbCB9IGZyb20gXCIuL0xvZ0xldmVsXCI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUV4cG9ydHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IEludGVudFJlY29nbml0aW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmUgcGF5bG9hZCBvZiBpbnRlbnQgcmVjb2duaXRpb24gY2FuY2VsZWQgcmVzdWx0IGV2ZW50cy5cbiAqIEBjbGFzcyBJbnRlbnRSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnRlbnRSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzIGV4dGVuZHMgSW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtDYW5jZWxsYXRpb25SZWFzb259IHJlc3VsdCAtIFRoZSByZXN1bHQgb2YgdGhlIGludGVudCByZWNvZ25pdGlvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb2Zmc2V0IC0gVGhlIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge0ludGVudFJlY29nbml0aW9uUmVzdWx0fSBzZXNzaW9uSWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlLCByZXN1bHQsIG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IGVycm9yRGV0YWlscztcbiAgICAgICAgdGhpcy5wcml2RXJyb3JDb2RlID0gZXJyb3JDb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSByZWNvZ25pdGlvbiB3YXMgY2FuY2VsZWQuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLnByb3RvdHlwZS5yZWFzb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge0NhbmNlbGxhdGlvblJlYXNvbn0gU3BlY2lmaWVzIHRoZSByZWFzb24gY2FuY2VsZWQuXG4gICAgICovXG4gICAgZ2V0IHJlYXNvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlYXNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGVycm9yIGNvZGUgaW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgcmVjb2duaXRpb24uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEuMC5cbiAgICAgKiBAcmV0dXJuIEFuIGVycm9yIGNvZGUgdGhhdCByZXByZXNlbnRzIHRoZSBlcnJvciByZWFzb24uXG4gICAgICovXG4gICAgZ2V0IGVycm9yQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yQ29kZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gY2FzZSBvZiBhbiB1bnN1Y2Nlc3NmdWwgcmVjb2duaXRpb24sIHByb3ZpZGVzIGRldGFpbHMgb2YgdGhlIG9jY3VycmVkIGVycm9yLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5wcm90b3R5cGUuZXJyb3JEZXRhaWxzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgZXJyb3IgZGV0YWlscy5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW50ZW50UmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUmVjb2duaXRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIEludGVudCByZWNvZ25pdGlvbiByZXN1bHQgZXZlbnQgYXJndW1lbnRzLlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncyBleHRlbmRzIFJlY29nbml0aW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSByZXN1bHQgLSBUaGUgcmVzdWx0IG9mIHRoZSBpbnRlbnQgcmVjb2duaXRpb24uXG4gICAgICogQHBhcmFtIG9mZnNldCAtIFRoZSBvZmZzZXQuXG4gICAgICogQHBhcmFtIHNlc3Npb25JZCAtIFRoZSBzZXNzaW9uIGlkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdCwgb2Zmc2V0LCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIob2Zmc2V0LCBzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlcHJlc2VudHMgdGhlIGludGVudCByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pdGlvbkV2ZW50QXJncy5wcm90b3R5cGUucmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtJbnRlbnRSZWNvZ25pdGlvblJlc3VsdH0gUmVwcmVzZW50cyB0aGUgaW50ZW50IHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW50ZW50UmVjb2duaXRpb25FdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFNwZWVjaFJlY29nbml0aW9uUmVzdWx0IH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBJbnRlbnQgcmVjb2duaXRpb24gcmVzdWx0LlxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBjbGFzcyBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdCBleHRlbmRzIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSBpbnRlbnRJZCAtIFRoZSBpbnRlbnQgaWQuXG4gICAgICogQHBhcmFtIHJlc3VsdElkIC0gVGhlIHJlc3VsdCBpZC5cbiAgICAgKiBAcGFyYW0gcmVhc29uIC0gVGhlIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0gdGV4dCAtIFRoZSByZWNvZ25pemVkIHRleHQuXG4gICAgICogQHBhcmFtIGR1cmF0aW9uIC0gVGhlIGR1cmF0aW9uLlxuICAgICAqIEBwYXJhbSBvZmZzZXQgLSBUaGUgb2Zmc2V0IGludG8gdGhlIHN0cmVhbS5cbiAgICAgKiBAcGFyYW0gbGFuZ3VhZ2UgLSBQcmltYXJ5IExhbmd1YWdlIGRldGVjdGVkLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0gbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlIC0gUHJpbWFyeSBMYW5ndWFnZSBjb25maWRlbmNlIChcIlVua25vd24sXCIgXCJMb3csXCIgXCJNZWRpdW0sXCIgXCJIaWdoXCIuLi4pLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIGpzb24gLSBBZGRpdGlvbmFsIEpzb24sIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSBwcm9wZXJ0aWVzIC0gQWRkaXRpb25hbCBwcm9wZXJ0aWVzLCBpZiBwcm92aWRlZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihpbnRlbnRJZCwgcmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgbGFuZ3VhZ2UsIGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1cGVyKHJlc3VsdElkLCByZWFzb24sIHRleHQsIGR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5wcml2SW50ZW50SWQgPSBpbnRlbnRJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBpbnRlbnQgaWRlbnRpZmllciBiZWluZyByZWNvZ25pemVkLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLmludGVudElkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgaW50ZW50IGlkZW50aWZpZXIgYmVpbmcgcmVjb2duaXplZC5cbiAgICAgKi9cbiAgICBnZXQgaW50ZW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZJbnRlbnRJZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudFJlY29nbml0aW9uUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IEFkZGVkTG1JbnRlbnQsIEludGVudENvbm5lY3Rpb25GYWN0b3J5LCBJbnRlbnRTZXJ2aWNlUmVjb2duaXplciwgUmVjb2duaXRpb25Nb2RlLCBSZWNvZ25pemVyQ29uZmlnIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkLCBSZWNvZ25pemVyLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogSW50ZW50IHJlY29nbml6ZXIuXG4gKiBAY2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIEludGVudFJlY29nbml6ZXIgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGUgSW50ZW50UmVjb2duaXplci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaENvbmZpZ30gc3BlZWNoQ29uZmlnIC0gVGhlIHNldCBvZiBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMuXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBpbnB1dCBjb25maWcgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZykge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChzcGVlY2hDb25maWcsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICBjb25zdCBjb25maWdJbXBsID0gc3BlZWNoQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChjb25maWdJbXBsLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgc3VwZXIoYXVkaW9Db25maWcsIGNvbmZpZ0ltcGwucHJvcGVydGllcywgbmV3IEludGVudENvbm5lY3Rpb25GYWN0b3J5KCkpO1xuICAgICAgICB0aGlzLnByaXZBZGRlZEludGVudHMgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2QWRkZWRMbUludGVudHMgPSB7fTtcbiAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBjb25maWdJbXBsLnByb3BlcnRpZXM7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UpLCBQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHNwb2tlbiBsYW5ndWFnZSBvZiByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gdGhlIHNwb2tlbiBsYW5ndWFnZSBvZiByZWNvZ25pdGlvbi5cbiAgICAgKi9cbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZEludGVudFJlY29nbml6ZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBnZXQgYXV0aG9yaXphdGlvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzL1NldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIE5vdGU6IFBsZWFzZSB1c2UgYSB0b2tlbiBkZXJpdmVkIGZyb20geW91ciBMYW5ndWFnZVVuZGVyc3RhbmRpbmcgc3Vic2NyaXB0aW9uIGtleSBmb3IgdGhlIEludGVudCByZWNvZ25pemVyLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih2YWx1ZSkge1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBJbnRlbnRSZWNvZ25pemVyLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpclxuICAgICAqIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIEludGVudFJlY29nbml6ZXIuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgaW50ZW50IHJlY29nbml0aW9uLCBhbmQgc3RvcHMgYWZ0ZXIgdGhlIGZpcnN0IHV0dGVyYW5jZSBpcyByZWNvZ25pemVkLlxuICAgICAqIFRoZSB0YXNrIHJldHVybnMgdGhlIHJlY29nbml0aW9uIHRleHQgYW5kIGludGVudCBhcyByZXN1bHQuXG4gICAgICogTm90ZTogUmVjb2duaXplT25jZUFzeW5jKCkgcmV0dXJucyB3aGVuIHRoZSBmaXJzdCB1dHRlcmFuY2UgaGFzIGJlZW4gcmVjb2duaXplZCxcbiAgICAgKiBzbyBpdCBpcyBzdWl0YWJsZSBvbmx5IGZvciBzaW5nbGUgc2hvdCByZWNvZ25pdGlvbiBsaWtlIGNvbW1hbmQgb3IgcXVlcnkuXG4gICAgICogRm9yIGxvbmctcnVubmluZyByZWNvZ25pdGlvbiwgdXNlIFN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmMoKSBpbnN0ZWFkLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUucmVjb2duaXplT25jZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIHRoYXQgcmVjZWl2ZWQgdGhlIHJlY29nbml0aW9uIGhhcyBmaW5pc2hlZCB3aXRoIGFuIEludGVudFJlY29nbml0aW9uUmVzdWx0LlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgcmVjb2duaXplT25jZUFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZEludGVudFJlY29nbml6ZXIpO1xuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5wcml2QWRkZWRMbUludGVudHMpLmxlbmd0aCAhPT0gMCB8fCB1bmRlZmluZWQgIT09IHRoaXMucHJpdlVtYnJlbGxhSW50ZW50KSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5idWlsZFNwZWVjaENvbnRleHQoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY28uc3BlZWNoQ29udGV4dC5zZXRTZWN0aW9uKFwiaW50ZW50XCIsIGNvbnRleHQuSW50ZW50KTtcbiAgICAgICAgICAgIHRoaXMucHJpdlJlY28uZHluYW1pY0dyYW1tYXIuYWRkUmVmZXJlbmNlR3JhbW1hcihjb250ZXh0LlJlZmVyZW5jZUdyYW1tYXJzKTtcbiAgICAgICAgICAgIGNvbnN0IGludGVudFJlY28gPSB0aGlzLnByaXZSZWNvO1xuICAgICAgICAgICAgaW50ZW50UmVjby5zZXRJbnRlbnRzKHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzLCB0aGlzLnByaXZVbWJyZWxsYUludGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnJlY29nbml6ZU9uY2VBc3luY0ltcGwoUmVjb2duaXRpb25Nb2RlLkludGVyYWN0aXZlKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBzcGVlY2ggcmVjb2duaXRpb24sIHVudGlsIHN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYygpIGlzIGNhbGxlZC5cbiAgICAgKiBVc2VyIG11c3Qgc3Vic2NyaWJlIHRvIGV2ZW50cyB0byByZWNlaXZlIHJlY29nbml0aW9uIHJlc3VsdHMuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzKS5sZW5ndGggIT09IDAgfHwgdW5kZWZpbmVkICE9PSB0aGlzLnByaXZVbWJyZWxsYUludGVudCkge1xuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXMuYnVpbGRTcGVlY2hDb250ZXh0KCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLnNwZWVjaENvbnRleHQuc2V0U2VjdGlvbihcImludGVudFwiLCBjb250ZXh0LkludGVudCk7XG4gICAgICAgICAgICB0aGlzLnByaXZSZWNvLmR5bmFtaWNHcmFtbWFyLmFkZFJlZmVyZW5jZUdyYW1tYXIoY29udGV4dC5SZWZlcmVuY2VHcmFtbWFycyk7XG4gICAgICAgICAgICBjb25zdCBpbnRlbnRSZWNvID0gdGhpcy5wcml2UmVjbztcbiAgICAgICAgICAgIGludGVudFJlY28uc2V0SW50ZW50cyh0aGlzLnByaXZBZGRlZExtSW50ZW50cywgdGhpcy5wcml2VW1icmVsbGFJbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbChSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3BzIGNvbnRpbnVvdXMgaW50ZW50IHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0b3BwZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuc3RvcENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jSW1wbCgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnRzIHNwZWVjaCByZWNvZ25pdGlvbiB3aXRoIGtleXdvcmQgc3BvdHRpbmcsIHVudGlsIHN0b3BLZXl3b3JkUmVjb2duaXRpb25Bc3luYygpIGlzIGNhbGxlZC5cbiAgICAgKiBVc2VyIG11c3Qgc3Vic2NyaWJlIHRvIGV2ZW50cyB0byByZWNlaXZlIHJlY29nbml0aW9uIHJlc3VsdHMuXG4gICAgICogTm90ZTogS2V5IHdvcmQgc3BvdHRpbmcgZnVuY3Rpb25hbGl0eSBpcyBvbmx5IGF2YWlsYWJsZSBvbiB0aGUgU3BlZWNoIERldmljZXMgU0RLLlxuICAgICAqIFRoaXMgZnVuY3Rpb25hbGl0eSBpcyBjdXJyZW50bHkgbm90IGluY2x1ZGVkIGluIHRoZSBTREsgaXRzZWxmLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuc3RhcnRLZXl3b3JkUmVjb2duaXRpb25Bc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0tleXdvcmRSZWNvZ25pdGlvbk1vZGVsfSBtb2RlbCAtIFRoZSBrZXl3b3JkIHJlY29nbml0aW9uIG1vZGVsIHRoYXQgc3BlY2lmaWVzIHRoZSBrZXl3b3JkIHRvIGJlIHJlY29nbml6ZWQuXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgaW52b2tlZCBvbmNlIHRoZSByZWNvZ25pdGlvbiBoYXMgc3RhcnRlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHN0YXJ0S2V5d29yZFJlY29nbml0aW9uQXN5bmMobW9kZWwsIGNiLCBlcnIpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKG1vZGVsLCBcIm1vZGVsXCIpO1xuICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgIGVycihcIk5vdCB5ZXQgaW1wbGVtZW50ZWQuXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3BzIGNvbnRpbnVvdXMgc3BlZWNoIHJlY29nbml0aW9uLlxuICAgICAqIE5vdGU6IEtleSB3b3JkIHNwb3R0aW5nIGZ1bmN0aW9uYWxpdHkgaXMgb25seSBhdmFpbGFibGUgb24gdGhlIFNwZWVjaCBEZXZpY2VzIFNESy5cbiAgICAgKiBUaGlzIGZ1bmN0aW9uYWxpdHkgaXMgY3VycmVudGx5IG5vdCBpbmNsdWRlZCBpbiB0aGUgU0RLIGl0c2VsZi5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLnN0b3BLZXl3b3JkUmVjb2duaXRpb25Bc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHJlY29nbml0aW9uIGhhcyBzdG9wcGVkLlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgc3RvcEtleXdvcmRSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgaWYgKCEhY2IpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIHBocmFzZSB0aGF0IHNob3VsZCBiZSByZWNvZ25pemVkIGFzIGludGVudC5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLmFkZEludGVudFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW50ZW50SWQgLSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGlkZW50aWZpZXIgb2YgdGhlIGludGVudCB0byBiZSByZWNvZ25pemVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwaHJhc2UgLSBBIFN0cmluZyB0aGF0IHNwZWNpZmllcyB0aGUgcGhyYXNlIHJlcHJlc2VudGluZyB0aGUgaW50ZW50LlxuICAgICAqL1xuICAgIGFkZEludGVudChzaW1wbGVQaHJhc2UsIGludGVudElkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKGludGVudElkLCBcImludGVudElkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc2ltcGxlUGhyYXNlLCBcInNpbXBsZVBocmFzZVwiKTtcbiAgICAgICAgdGhpcy5wcml2QWRkZWRJbnRlbnRzLnB1c2goW2ludGVudElkLCBzaW1wbGVQaHJhc2VdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBpbnRlbnQgZnJvbSBMYW5ndWFnZSBVbmRlcnN0YW5kaW5nIHNlcnZpY2UgZm9yIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgSW50ZW50UmVjb2duaXplci5wcm90b3R5cGUuYWRkSW50ZW50V2l0aExhbmd1YWdlTW9kZWxcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGludGVudElkIC0gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBpZGVudGlmaWVyIG9mIHRoZSBpbnRlbnRcbiAgICAgKiB0byBiZSByZWNvZ25pemVkLiBJZ25vcmVkIGlmIGludGVudE5hbWUgaXMgZW1wdHkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGVsIC0gVGhlIGludGVudCBtb2RlbCBmcm9tIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgc2VydmljZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW50ZW50TmFtZSAtIFRoZSBpbnRlbnQgbmFtZSBkZWZpbmVkIGluIHRoZSBpbnRlbnQgbW9kZWwuIElmIGl0XG4gICAgICogaXMgZW1wdHksIGFsbCBpbnRlbnQgbmFtZXMgZGVmaW5lZCBpbiB0aGUgbW9kZWwgd2lsbCBiZSBhZGRlZC5cbiAgICAgKi9cbiAgICBhZGRJbnRlbnRXaXRoTGFuZ3VhZ2VNb2RlbChpbnRlbnRJZCwgbW9kZWwsIGludGVudE5hbWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZEludGVudFJlY29nbml6ZXIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoaW50ZW50SWQsIFwiaW50ZW50SWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChtb2RlbCwgXCJtb2RlbFwiKTtcbiAgICAgICAgY29uc3QgbW9kZWxJbXBsID0gbW9kZWw7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShtb2RlbEltcGwuYXBwSWQsIFwibW9kZWwuYXBwSWRcIik7XG4gICAgICAgIHRoaXMucHJpdkFkZGVkTG1JbnRlbnRzW2ludGVudElkXSA9IG5ldyBBZGRlZExtSW50ZW50KG1vZGVsSW1wbCwgaW50ZW50TmFtZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBzdW1tYXJ5IEFkZHMgYWxsIGludGVudHMgZnJvbSB0aGUgc3BlY2lmaWVkIExhbmd1YWdlIFVuZGVyc3RhbmRpbmcgTW9kZWwuXG4gICAgICogQG1lbWJlciBJbnRlbnRSZWNvZ25pemVyLnByb3RvdHlwZS5hZGRBbGxJbnRlbnRzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge0xhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsfSBtb2RlbCAtIFRoZSBsYW5ndWFnZSB1bmRlcnN0YW5kaW5nIG1vZGVsIGNvbnRhaW5pbmcgdGhlIGludGVudHMuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGludGVudElkIC0gQSBjdXN0b20gaWQgU3RyaW5nIHRvIGJlIHJldHVybmVkIGluIHRoZSBJbnRlbnRSZWNvZ25pdGlvblJlc3VsdCdzIGdldEludGVudElkKCkgbWV0aG9kLlxuICAgICAqL1xuICAgIGFkZEFsbEludGVudHMobW9kZWwsIGludGVudElkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChtb2RlbCwgXCJtb2RlbFwiKTtcbiAgICAgICAgY29uc3QgbW9kZWxJbXBsID0gbW9kZWw7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShtb2RlbEltcGwuYXBwSWQsIFwibW9kZWwuYXBwSWRcIik7XG4gICAgICAgIHRoaXMucHJpdlVtYnJlbGxhSW50ZW50ID0gbmV3IEFkZGVkTG1JbnRlbnQobW9kZWxJbXBsLCBpbnRlbnRJZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIGNsb3NlcyBhbGwgZXh0ZXJuYWwgcmVzb3VyY2VzIGhlbGQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAbWVtYmVyIEludGVudFJlY29nbml6ZXIucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKGNiLCBlcnJvckNiKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmRpc3Bvc2UodHJ1ZSksIGNiLCBlcnJvckNiKTtcbiAgICB9XG4gICAgY3JlYXRlUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcml2UHJvcGVydGllcyk7XG4gICAgfVxuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgYXVkaW9JbXBsID0gYXVkaW9Db25maWc7XG4gICAgICAgIHJldHVybiBuZXcgSW50ZW50U2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0ltcGwsIHJlY29nbml6ZXJDb25maWcsIHRoaXMpO1xuICAgIH1cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICBjb25zdCBfc3VwZXIgPSBPYmplY3QuY3JlYXRlKG51bGwsIHtcbiAgICAgICAgICAgIGRpc3Bvc2U6IHsgZ2V0OiAoKSA9PiBzdXBlci5kaXNwb3NlIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWRJbnRlbnRSZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkSW50ZW50UmVjb2duaXplciA9IHRydWU7XG4gICAgICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgYnVpbGRTcGVlY2hDb250ZXh0KCkge1xuICAgICAgICBsZXQgYXBwSWQ7XG4gICAgICAgIGxldCByZWdpb247XG4gICAgICAgIGxldCBzdWJzY3JpcHRpb25LZXk7XG4gICAgICAgIGNvbnN0IHJlZkdyYW1tZXJzID0gW107XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHRoaXMucHJpdlVtYnJlbGxhSW50ZW50KSB7XG4gICAgICAgICAgICBhcHBJZCA9IHRoaXMucHJpdlVtYnJlbGxhSW50ZW50Lm1vZGVsSW1wbC5hcHBJZDtcbiAgICAgICAgICAgIHJlZ2lvbiA9IHRoaXMucHJpdlVtYnJlbGxhSW50ZW50Lm1vZGVsSW1wbC5yZWdpb247XG4gICAgICAgICAgICBzdWJzY3JpcHRpb25LZXkgPSB0aGlzLnByaXZVbWJyZWxsYUludGVudC5tb2RlbEltcGwuc3Vic2NyaXB0aW9uS2V5O1xuICAgICAgICB9XG4gICAgICAgIC8vIEJ1aWxkIHRoZSByZWZlcmVuY2UgZ3JhbW1lciBhcnJheS5cbiAgICAgICAgZm9yIChjb25zdCBpbnRlbnRJZCBvZiBPYmplY3Qua2V5cyh0aGlzLnByaXZBZGRlZExtSW50ZW50cykpIHtcbiAgICAgICAgICAgIGNvbnN0IGFkZGVkTG1JbnRlbnQgPSB0aGlzLnByaXZBZGRlZExtSW50ZW50c1tpbnRlbnRJZF07XG4gICAgICAgICAgICAvLyB2YWxpZGF0ZSBhbGwgdGhlIHNhbWUgbW9kZWwsIHJlZ2lvbiwgYW5kIGtleS4uLlxuICAgICAgICAgICAgaWYgKGFwcElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBhcHBJZCA9IGFkZGVkTG1JbnRlbnQubW9kZWxJbXBsLmFwcElkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGFwcElkICE9PSBhZGRlZExtSW50ZW50Lm1vZGVsSW1wbC5hcHBJZCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnRlbnRzIG11c3QgYWxsIGJlIGZyb20gdGhlIHNhbWUgTFVJUyBtb2RlbFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVnaW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZWdpb24gPSBhZGRlZExtSW50ZW50Lm1vZGVsSW1wbC5yZWdpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVnaW9uICE9PSBhZGRlZExtSW50ZW50Lm1vZGVsSW1wbC5yZWdpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW50ZW50cyBtdXN0IGFsbCBiZSBmcm9tIHRoZSBzYW1lIExVSVMgbW9kZWwgaW4gYSBzaW5nbGUgcmVnaW9uXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbktleSA9IGFkZGVkTG1JbnRlbnQubW9kZWxJbXBsLnN1YnNjcmlwdGlvbktleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb25LZXkgIT09IGFkZGVkTG1JbnRlbnQubW9kZWxJbXBsLnN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnRlbnRzIG11c3QgYWxsIHVzZSB0aGUgc2FtZSBzdWJzY3JpcHRpb24ga2V5XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGdyYW1tZXIgPSBcImx1aXMvXCIgKyBhcHBJZCArIFwiLVBST0RVQ1RJT04jXCIgKyBpbnRlbnRJZDtcbiAgICAgICAgICAgIHJlZkdyYW1tZXJzLnB1c2goZ3JhbW1lcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIEludGVudDoge1xuICAgICAgICAgICAgICAgIGlkOiBhcHBJZCxcbiAgICAgICAgICAgICAgICBrZXk6IChzdWJzY3JpcHRpb25LZXkgPT09IHVuZGVmaW5lZCkgPyB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXldKSA6IHN1YnNjcmlwdGlvbktleSxcbiAgICAgICAgICAgICAgICBwcm92aWRlcjogXCJMVUlTXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgUmVmZXJlbmNlR3JhbW1hcnM6ICh1bmRlZmluZWQgPT09IHRoaXMucHJpdlVtYnJlbGxhSW50ZW50KSA/IHJlZkdyYW1tZXJzIDogW1wibHVpcy9cIiArIGFwcElkICsgXCItUFJPRFVDVElPTlwiXSxcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUludGVudFJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuLyoqXG4gKiBSZXByZXNlbnRzIGEga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbCBmb3IgcmVjb2duaXppbmcgd2hlblxuICogdGhlIHVzZXIgc2F5cyBhIGtleXdvcmQgdG8gaW5pdGlhdGUgZnVydGhlciBzcGVlY2ggcmVjb2duaXRpb24uXG4gKiBAY2xhc3MgS2V5d29yZFJlY29nbml0aW9uTW9kZWxcbiAqL1xuZXhwb3J0IGNsYXNzIEtleXdvcmRSZWNvZ25pdGlvbk1vZGVsIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYW5kIGluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBrZXl3b3JkIHJlY29nbml0aW9uIG1vZGVsIHVzaW5nIHRoZSBzcGVjaWZpZWQgZmlsZW5hbWUuXG4gICAgICogQG1lbWJlciBLZXl3b3JkUmVjb2duaXRpb25Nb2RlbC5mcm9tRmlsZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmlsZU5hbWUgLSBBIHN0cmluZyB0aGF0IHJlcHJlc2VudHMgZmlsZSBuYW1lIGZvciB0aGUga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbC5cbiAgICAgKiBOb3RlLCB0aGUgZmlsZSBjYW4gcG9pbnQgdG8gYSB6aXAgZmlsZSBpbiB3aGljaCBjYXNlIHRoZSBtb2RlbFxuICAgICAqIHdpbGwgYmUgZXh0cmFjdGVkIGZyb20gdGhlIHppcC5cbiAgICAgKiBAcmV0dXJucyB7S2V5d29yZFJlY29nbml0aW9uTW9kZWx9IFRoZSBrZXl3b3JkIHJlY29nbml0aW9uIG1vZGVsIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21GaWxlKGZpbGVOYW1lKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRmlsZURvZXNOb3RFeGlzdChmaWxlTmFtZSwgXCJmaWxlTmFtZVwiKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IHlldCBpbXBsZW1lbnRlZC5cIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBrZXl3b3JkIHJlY29nbml0aW9uIG1vZGVsIHVzaW5nIHRoZSBzcGVjaWZpZWQgZmlsZW5hbWUuXG4gICAgICogQG1lbWJlciBLZXl3b3JkUmVjb2duaXRpb25Nb2RlbC5mcm9tU3RyZWFtXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlIC0gQSBGaWxlIHRoYXQgcmVwcmVzZW50cyBmaWxlIGZvciB0aGUga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbC5cbiAgICAgKiBOb3RlLCB0aGUgZmlsZSBjYW4gcG9pbnQgdG8gYSB6aXAgZmlsZSBpbiB3aGljaCBjYXNlIHRoZSBtb2RlbCB3aWxsIGJlIGV4dHJhY3RlZCBmcm9tIHRoZSB6aXAuXG4gICAgICogQHJldHVybnMge0tleXdvcmRSZWNvZ25pdGlvbk1vZGVsfSBUaGUga2V5d29yZCByZWNvZ25pdGlvbiBtb2RlbCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tU3RyZWFtKGZpbGUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGZpbGUsIFwiZmlsZVwiKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IHlldCBpbXBsZW1lbnRlZC5cIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2Ugb2YgYXNzb2NpYXRlZCByZXNvdXJjZXMuXG4gICAgICogQG1lbWJlciBLZXl3b3JkUmVjb2duaXRpb25Nb2RlbC5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkID0gdHJ1ZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUtleXdvcmRSZWNvZ25pdGlvbk1vZGVsLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIExhbmd1YWdlIElkZW50aWZpY2F0aW9uIG1vZGVcbiAqIEBjbGFzcyBMYW5ndWFnZUlkTW9kZVxuICovXG5leHBvcnQgdmFyIExhbmd1YWdlSWRNb2RlO1xuKGZ1bmN0aW9uIChMYW5ndWFnZUlkTW9kZSkge1xuICAgIC8qKlxuICAgICAqIERldGVjdCBsYW5ndWFnZSBhdCBhdWRpbyBzdGFydFxuICAgICAqIEBtZW1iZXIgTGFuZ3VhZ2VJZE1vZGUuQXRTdGFydFxuICAgICAqL1xuICAgIExhbmd1YWdlSWRNb2RlW0xhbmd1YWdlSWRNb2RlW1wiQXRTdGFydFwiXSA9IDBdID0gXCJBdFN0YXJ0XCI7XG4gICAgLyoqXG4gICAgICogQ29udGludW91c2x5IGRldGVjdCBsYW5ndWFnZVxuICAgICAqIEBtZW1iZXIgTGFuZ3VhZ2VJZE1vZGUuQ29udGludW91c1xuICAgICAqL1xuICAgIExhbmd1YWdlSWRNb2RlW0xhbmd1YWdlSWRNb2RlW1wiQ29udGludW91c1wiXSA9IDFdID0gXCJDb250aW51b3VzXCI7XG59KShMYW5ndWFnZUlkTW9kZSB8fCAoTGFuZ3VhZ2VJZE1vZGUgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1MYW5ndWFnZUlkTW9kZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1jbGFzc2VzLXBlci1maWxlXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbi8qKlxuICogTGFuZ3VhZ2UgdW5kZXJzdGFuZGluZyBtb2RlbFxuICogQGNsYXNzIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsXG4gKi9cbmV4cG9ydCBjbGFzcyBMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2VcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGxhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWwgdXNpbmcgdGhlIHNwZWNpZmllZCBlbmRwb2ludC5cbiAgICAgKiBAbWVtYmVyIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsLmZyb21FbmRwb2ludFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1VSTH0gdXJpIC0gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBlbmRwb2ludCBvZiB0aGUgbGFuZ3VhZ2UgdW5kZXJzdGFuZGluZyBtb2RlbC5cbiAgICAgKiBAcmV0dXJucyB7TGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWx9IFRoZSBsYW5ndWFnZSB1bmRlcnN0YW5kaW5nIG1vZGVsIGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21FbmRwb2ludCh1cmkpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHVyaSwgXCJ1cmlcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh1cmkuaG9zdG5hbWUsIFwidXJpXCIpO1xuICAgICAgICBjb25zdCBsYW5nTW9kZWxJbXAgPSBuZXcgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWxJbXBsKCk7XG4gICAgICAgIC8vIE5lZWQgdG8gZXh0cmFjdCB0aGUgYXBwIElEIGZyb20gdGhlIFVSTC5cbiAgICAgICAgLy8gVVJMIGlzIGluIHRoZSBmb3JtYXQ6IGh0dHBzOi8vPHJlZ2lvbj4uYXBpLmNvZ25pdGl2ZS5taWNyb3NvZnQuY29tL2x1aXMvdjIuMC9hcHBzLzxHdWlkPj9zdWJzY3JpcHRpb24ta2V5PTxrZXk+JnRpbWV6b25lT2Zmc2V0PS0zNjBcbiAgICAgICAgLy8gU3RhcnQgdGVhcmluZyB0aGUgc3RyaW5nIGFwYXJ0LlxuICAgICAgICAvLyByZWdpb24gY2FuIGJlIGV4dHJhY3RlZCBmcm9tIHRoZSBob3N0IG5hbWUuXG4gICAgICAgIGNvbnN0IGZpcnN0RG90ID0gdXJpLmhvc3QuaW5kZXhPZihcIi5cIik7XG4gICAgICAgIGlmICgtMSA9PT0gZmlyc3REb3QpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBkZXRlcm1pbmUgcmVnaW9uIGZyb20gZW5kcG9pbnRcIik7XG4gICAgICAgIH1cbiAgICAgICAgbGFuZ01vZGVsSW1wLnJlZ2lvbiA9IHVyaS5ob3N0LnN1YnN0cigwLCBmaXJzdERvdCk7XG4gICAgICAgIC8vIE5vdyB0aGUgYXBwIElELlxuICAgICAgICBjb25zdCBsYXN0U2VnbWVudCA9IHVyaS5wYXRobmFtZS5sYXN0SW5kZXhPZihcIi9cIikgKyAxO1xuICAgICAgICBpZiAoLTEgPT09IGxhc3RTZWdtZW50KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZGV0ZXJtaW5lIGFwcElkIGZyb20gZW5kcG9pbnRcIik7XG4gICAgICAgIH1cbiAgICAgICAgbGFuZ01vZGVsSW1wLmFwcElkID0gdXJpLnBhdGhuYW1lLnN1YnN0cihsYXN0U2VnbWVudCk7XG4gICAgICAgIC8vIEFuZCBmaW5hbGx5IHRoZSBrZXkuXG4gICAgICAgIGxhbmdNb2RlbEltcC5zdWJzY3JpcHRpb25LZXkgPSB1cmkuc2VhcmNoUGFyYW1zLmdldChcInN1YnNjcmlwdGlvbi1rZXlcIik7XG4gICAgICAgIGlmICh1bmRlZmluZWQgPT09IGxhbmdNb2RlbEltcC5zdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBkZXRlcm1pbmUgc3Vic2NyaXB0aW9uIGtleSBmcm9tIGVuZHBvaW50XCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsYW5nTW9kZWxJbXA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gbGFuZ3VhZ2UgdW5kZXJzdGFuZGluZyBtb2RlbCB1c2luZyB0aGUgYXBwbGljYXRpb24gaWQgb2YgTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWwuZnJvbUFwcElkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBJZCAtIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgYXBwbGljYXRpb24gaWQgb2YgTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBzZXJ2aWNlLlxuICAgICAqIEByZXR1cm5zIHtMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbH0gVGhlIGxhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWwgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUFwcElkKGFwcElkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShhcHBJZCwgXCJhcHBJZFwiKTtcbiAgICAgICAgY29uc3QgbGFuZ01vZGVsSW1wID0gbmV3IExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsSW1wbCgpO1xuICAgICAgICBsYW5nTW9kZWxJbXAuYXBwSWQgPSBhcHBJZDtcbiAgICAgICAgcmV0dXJuIGxhbmdNb2RlbEltcDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGxhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWwgdXNpbmcgaG9zdG5hbWUsIHN1YnNjcmlwdGlvbiBrZXkgYW5kIGFwcGxpY2F0aW9uXG4gICAgICogaWQgb2YgTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWwuZnJvbVN1YnNjcmlwdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3Vic2NyaXB0aW9uS2V5IC0gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSBzdWJzY3JpcHRpb24ga2V5IG9mXG4gICAgICogTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBzZXJ2aWNlLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhcHBJZCAtIEEgU3RyaW5nIHRoYXQgcmVwcmVzZW50cyB0aGUgYXBwbGljYXRpb24gaWQgb2YgTGFuZ3VhZ2VcbiAgICAgKiBVbmRlcnN0YW5kaW5nIHNlcnZpY2UuXG4gICAgICogQHBhcmFtIHtMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbH0gcmVnaW9uIC0gQSBTdHJpbmcgdGhhdCByZXByZXNlbnRzIHRoZSByZWdpb25cbiAgICAgKiBvZiB0aGUgTGFuZ3VhZ2UgVW5kZXJzdGFuZGluZyBzZXJ2aWNlIChzZWUgdGhlIDxhIGhyZWY9XCJodHRwczovL2FrYS5tcy9jc3NwZWVjaC9yZWdpb25cIj5yZWdpb24gcGFnZTwvYT4pLlxuICAgICAqIEByZXR1cm5zIHtMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbH0gVGhlIGxhbmd1YWdlIHVuZGVyc3RhbmRpbmcgbW9kZWwgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb25LZXksIGFwcElkLCByZWdpb24pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHN1YnNjcmlwdGlvbktleSwgXCJzdWJzY3JpcHRpb25LZXlcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShhcHBJZCwgXCJhcHBJZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IGxhbmdNb2RlbEltcCA9IG5ldyBMYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbEltcGwoKTtcbiAgICAgICAgbGFuZ01vZGVsSW1wLmFwcElkID0gYXBwSWQ7XG4gICAgICAgIGxhbmdNb2RlbEltcC5yZWdpb24gPSByZWdpb247XG4gICAgICAgIGxhbmdNb2RlbEltcC5zdWJzY3JpcHRpb25LZXkgPSBzdWJzY3JpcHRpb25LZXk7XG4gICAgICAgIHJldHVybiBsYW5nTW9kZWxJbXA7XG4gICAgfVxufVxuLyoqXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIExhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsSW1wbFxuICovXG5leHBvcnQgY2xhc3MgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWxJbXBsIGV4dGVuZHMgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nTW9kZWwge1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1MYW5ndWFnZVVuZGVyc3RhbmRpbmdNb2RlbC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUmVjb2duaXRpb25TdGF0dXMsIFNpbXBsZVNwZWVjaFBocmFzZSB9IGZyb20gXCIuLi8uLi9zcmMvY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBOb01hdGNoUmVhc29uIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBDb250YWlucyBkZXRhaWxlZCBpbmZvcm1hdGlvbiBmb3IgTm9NYXRjaCByZWNvZ25pdGlvbiByZXN1bHRzLlxuICogQGNsYXNzIE5vTWF0Y2hEZXRhaWxzXG4gKi9cbmV4cG9ydCBjbGFzcyBOb01hdGNoRGV0YWlscyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge05vTWF0Y2hSZWFzb259IHJlYXNvbiAtIFRoZSBuby1tYXRjaCByZWFzb24uXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVhc29uKSB7XG4gICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IHJlYXNvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBOb01hdGNoRGV0YWlscyBvYmplY3QgZm9yIHRoZSBOb01hdGNoIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0cy5cbiAgICAgKiBAbWVtYmVyIE5vTWF0Y2hEZXRhaWxzLmZyb21SZXN1bHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCB8IEludGVudFJlY29nbml0aW9uUmVzdWx0IHwgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdH1cbiAgICAgKiByZXN1bHQgLSBUaGUgcmVjb2duaXRpb24gcmVzdWx0IHRoYXQgd2FzIG5vdCByZWNvZ25pemVkLlxuICAgICAqIEByZXR1cm5zIHtOb01hdGNoRGV0YWlsc30gVGhlIG5vIG1hdGNoIGRldGFpbHMgb2JqZWN0IGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21SZXN1bHQocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IHNpbXBsZVNwZWVjaCA9IFNpbXBsZVNwZWVjaFBocmFzZS5mcm9tSlNPTihyZXN1bHQuanNvbik7XG4gICAgICAgIGxldCByZWFzb24gPSBOb01hdGNoUmVhc29uLk5vdFJlY29nbml6ZWQ7XG4gICAgICAgIHN3aXRjaCAoc2ltcGxlU3BlZWNoLlJlY29nbml0aW9uU3RhdHVzKSB7XG4gICAgICAgICAgICBjYXNlIFJlY29nbml0aW9uU3RhdHVzLkJhYmJsZVRpbWVvdXQ6XG4gICAgICAgICAgICAgICAgcmVhc29uID0gTm9NYXRjaFJlYXNvbi5Jbml0aWFsQmFiYmxlVGltZW91dDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUmVjb2duaXRpb25TdGF0dXMuSW5pdGlhbFNpbGVuY2VUaW1lb3V0OlxuICAgICAgICAgICAgICAgIHJlYXNvbiA9IE5vTWF0Y2hSZWFzb24uSW5pdGlhbFNpbGVuY2VUaW1lb3V0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZWFzb24gPSBOb01hdGNoUmVhc29uLk5vdFJlY29nbml6ZWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBOb01hdGNoRGV0YWlscyhyZWFzb24pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSByZWNvZ25pdGlvbiB3YXMgY2FuY2VsZWQuXG4gICAgICogQG1lbWJlciBOb01hdGNoRGV0YWlscy5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtOb01hdGNoUmVhc29ufSBTcGVjaWZpZXMgdGhlIHJlYXNvbiBjYW5jZWxlZC5cbiAgICAgKi9cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Tm9NYXRjaERldGFpbHMuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyB0aGUgcG9zc2libGUgcmVhc29ucyBhIHJlY29nbml0aW9uIHJlc3VsdCBtaWdodCBub3QgYmUgcmVjb2duaXplZC5cbiAqIEBjbGFzcyBOb01hdGNoUmVhc29uXG4gKi9cbmV4cG9ydCB2YXIgTm9NYXRjaFJlYXNvbjtcbihmdW5jdGlvbiAoTm9NYXRjaFJlYXNvbikge1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IHNwZWVjaCB3YXMgZGV0ZWN0ZWQsIGJ1dCBub3QgcmVjb2duaXplZC5cbiAgICAgKiBAbWVtYmVyIE5vTWF0Y2hSZWFzb24uTm90UmVjb2duaXplZFxuICAgICAqL1xuICAgIE5vTWF0Y2hSZWFzb25bTm9NYXRjaFJlYXNvbltcIk5vdFJlY29nbml6ZWRcIl0gPSAwXSA9IFwiTm90UmVjb2duaXplZFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGF0IHRoZSBzdGFydCBvZiB0aGUgYXVkaW8gc3RyZWFtIGNvbnRhaW5lZCBvbmx5IHNpbGVuY2UsXG4gICAgICogYW5kIHRoZSBzZXJ2aWNlIHRpbWVkIG91dCB3YWl0aW5nIGZvciBzcGVlY2guXG4gICAgICogQG1lbWJlciBOb01hdGNoUmVhc29uLkluaXRpYWxTaWxlbmNlVGltZW91dFxuICAgICAqL1xuICAgIE5vTWF0Y2hSZWFzb25bTm9NYXRjaFJlYXNvbltcIkluaXRpYWxTaWxlbmNlVGltZW91dFwiXSA9IDFdID0gXCJJbml0aWFsU2lsZW5jZVRpbWVvdXRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCB0aGUgc3RhcnQgb2YgdGhlIGF1ZGlvIHN0cmVhbSBjb250YWluZWQgb25seSBub2lzZSxcbiAgICAgKiBhbmQgdGhlIHNlcnZpY2UgdGltZWQgb3V0IHdhaXRpbmcgZm9yIHNwZWVjaC5cbiAgICAgKiBAbWVtYmVyIE5vTWF0Y2hSZWFzb24uSW5pdGlhbEJhYmJsZVRpbWVvdXRcbiAgICAgKi9cbiAgICBOb01hdGNoUmVhc29uW05vTWF0Y2hSZWFzb25bXCJJbml0aWFsQmFiYmxlVGltZW91dFwiXSA9IDJdID0gXCJJbml0aWFsQmFiYmxlVGltZW91dFwiO1xufSkoTm9NYXRjaFJlYXNvbiB8fCAoTm9NYXRjaFJlYXNvbiA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPU5vTWF0Y2hSZWFzb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lIFNwZWVjaCBSZWNvZ25pemVyIG91dHB1dCBmb3JtYXRzLlxuICogQGNsYXNzIE91dHB1dEZvcm1hdFxuICovXG5leHBvcnQgdmFyIE91dHB1dEZvcm1hdDtcbihmdW5jdGlvbiAoT3V0cHV0Rm9ybWF0KSB7XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBPdXRwdXRGb3JtYXQuU2ltcGxlXG4gICAgICovXG4gICAgT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdFtcIlNpbXBsZVwiXSA9IDBdID0gXCJTaW1wbGVcIjtcbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIE91dHB1dEZvcm1hdC5EZXRhaWxlZFxuICAgICAqL1xuICAgIE91dHB1dEZvcm1hdFtPdXRwdXRGb3JtYXRbXCJEZXRhaWxlZFwiXSA9IDFdID0gXCJEZXRhaWxlZFwiO1xufSkoT3V0cHV0Rm9ybWF0IHx8IChPdXRwdXRGb3JtYXQgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1PdXRwdXRGb3JtYXQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQWxsb3dzIGFkZGl0aW9ucyBvZiBuZXcgcGhyYXNlcyB0byBpbXByb3ZlIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAqXG4gKiBQaHJhc2VzIGFkZGVkIHRvIHRoZSByZWNvZ25pemVyIGFyZSBlZmZlY3RpdmUgYXQgdGhlIHN0YXJ0IG9mIHRoZSBuZXh0IHJlY29nbml0aW9uLCBvciB0aGUgbmV4dCB0aW1lIHRoZSBTcGVlY2hTREsgbXVzdCByZWNvbm5lY3RcbiAqIHRvIHRoZSBzcGVlY2ggc2VydmljZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFBocmFzZUxpc3RHcmFtbWFyIHtcbiAgICBjb25zdHJ1Y3RvcihyZWNvZ0Jhc2UpIHtcbiAgICAgICAgdGhpcy5wcml2R3JhbW1lckJ1aWxkZXIgPSByZWNvZ0Jhc2UuZHluYW1pY0dyYW1tYXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBQaHJhc2VMaXN0R3JhbW1hciBmcm9tIGEgZ2l2ZW4gc3BlZWNoIHJlY29nbml6ZXIuIFdpbGwgYWNjZXB0IGFueSByZWNvZ25pemVyIHRoYXQgZGVyaXZlcyBmcm9tIEBjbGFzcyBSZWNvZ25pemVyLlxuICAgICAqIEBwYXJhbSByZWNvZ25pemVyIFRoZSByZWNvZ25pemVyIHRvIGFkZCBwaHJhc2UgbGlzdHMgdG8uXG4gICAgICovXG4gICAgc3RhdGljIGZyb21SZWNvZ25pemVyKHJlY29nbml6ZXIpIHtcbiAgICAgICAgY29uc3QgcmVjb0Jhc2UgPSByZWNvZ25pemVyLmludGVybmFsRGF0YTtcbiAgICAgICAgcmV0dXJuIG5ldyBQaHJhc2VMaXN0R3JhbW1hcihyZWNvQmFzZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBzaW5nbGUgcGhyYXNlIHRvIHRoZSBjdXJyZW50IHJlY29nbml6ZXIuXG4gICAgICogQHBhcmFtIHBocmFzZSBQaHJhc2UgdG8gYWRkLlxuICAgICAqL1xuICAgIGFkZFBocmFzZShwaHJhc2UpIHtcbiAgICAgICAgdGhpcy5wcml2R3JhbW1lckJ1aWxkZXIuYWRkUGhyYXNlKHBocmFzZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgbXVsdGlwbGUgcGhyYXNlcyB0byB0aGUgY3VycmVudCByZWNvZ25pemVyLlxuICAgICAqIEBwYXJhbSBwaHJhc2VzIEFycmF5IG9mIHBocmFzZXMgdG8gYWRkLlxuICAgICAqL1xuICAgIGFkZFBocmFzZXMocGhyYXNlcykge1xuICAgICAgICB0aGlzLnByaXZHcmFtbWVyQnVpbGRlci5hZGRQaHJhc2UocGhyYXNlcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyBhbGwgcGhyYXNlcyBhZGRlZCB0byB0aGUgY3VycmVudCByZWNvZ25pemVyLlxuICAgICAqL1xuICAgIGNsZWFyKCkge1xuICAgICAgICB0aGlzLnByaXZHcmFtbWVyQnVpbGRlci5jbGVhclBocmFzZXMoKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVBocmFzZUxpc3RHcmFtbWFyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIFByb2Zhbml0eSBvcHRpb24uXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wLlxuICovXG5leHBvcnQgdmFyIFByb2Zhbml0eU9wdGlvbjtcbihmdW5jdGlvbiAoUHJvZmFuaXR5T3B0aW9uKSB7XG4gICAgUHJvZmFuaXR5T3B0aW9uW1Byb2Zhbml0eU9wdGlvbltcIk1hc2tlZFwiXSA9IDBdID0gXCJNYXNrZWRcIjtcbiAgICBQcm9mYW5pdHlPcHRpb25bUHJvZmFuaXR5T3B0aW9uW1wiUmVtb3ZlZFwiXSA9IDFdID0gXCJSZW1vdmVkXCI7XG4gICAgUHJvZmFuaXR5T3B0aW9uW1Byb2Zhbml0eU9wdGlvbltcIlJhd1wiXSA9IDJdID0gXCJSYXdcIjtcbn0pKFByb2Zhbml0eU9wdGlvbiB8fCAoUHJvZmFuaXR5T3B0aW9uID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvZmFuaXR5T3B0aW9uLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbSwgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eSwgUHJvcGVydHlDb2xsZWN0aW9uLCBQcm9wZXJ0eUlkIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBQcm9udW5jaWF0aW9uIGFzc2Vzc21lbnQgY29uZmlndXJhdGlvbi5cbiAqIEBjbGFzcyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZ1xuICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjAuXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZyB7XG4gICAgLyoqXG4gICAgICogUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcgY29uc3RydWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlZmVyZW5jZVRleHRcbiAgICAgKiBAcGFyYW0gZ3JhZGluZ1N5c3RlbVxuICAgICAqIEBwYXJhbSBncmFudWxhcml0eVxuICAgICAqIEBwYXJhbSBlbmFibGVNaXNjdWVcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZWZlcmVuY2VUZXh0LCBncmFkaW5nU3lzdGVtID0gUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtLkZpdmVQb2ludCwgZ3JhbnVsYXJpdHkgPSBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5LlBob25lbWUsIGVuYWJsZU1pc2N1ZSA9IGZhbHNlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHJlZmVyZW5jZVRleHQsIFwicmVmZXJlbmNlVGV4dFwiKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1JlZmVyZW5jZVRleHQsIHJlZmVyZW5jZVRleHQpO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfR3JhZGluZ1N5c3RlbSwgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtW2dyYWRpbmdTeXN0ZW1dKTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0dyYW51bGFyaXR5LCBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5W2dyYW51bGFyaXR5XSk7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudF9FbmFibGVNaXNjdWUsIFN0cmluZyhlbmFibGVNaXNjdWUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5mcm9tSlNPTlxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ganNvbiBUaGUganNvbiBzdHJpbmcgY29udGFpbmluZyB0aGUgcHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IHBhcmFtZXRlcnMuXG4gICAgICogQHJldHVybiB7UHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWd9IEluc3RhbmNlIG9mIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnXG4gICAgICogQHN1bW1hcnkgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcgZnJvbSBqc29uLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGpzb24sIFwianNvblwiKTtcbiAgICAgICAgY29uc3QgY29uZmlnID0gbmV3IFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnKFwiXCIpO1xuICAgICAgICBjb25maWcucHJpdlByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIGNvbmZpZy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfSnNvbiwganNvbik7XG4gICAgICAgIHJldHVybiBjb25maWc7XG4gICAgfVxuICAgIHRvSlNPTigpIHtcbiAgICAgICAgdGhpcy51cGRhdGVKc29uKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfUGFyYW1zKTtcbiAgICB9XG4gICAgYXBwbHlUbyhyZWNvZ25pemVyKSB7XG4gICAgICAgIHRoaXMudXBkYXRlSnNvbigpO1xuICAgICAgICBjb25zdCByZWNvQmFzZSA9IHJlY29nbml6ZXIuaW50ZXJuYWxEYXRhO1xuICAgICAgICByZWNvQmFzZS5zcGVlY2hDb250ZXh0LnNldFByb251bmNpYXRpb25Bc3Nlc3NtZW50UGFyYW1zKHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1BhcmFtcykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSByZWZlcmVuY2UgdGV4dC5cbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnLnByb3RvdHlwZS5yZWZlcmVuY2VUZXh0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJlZmVyZW5jZSB0ZXh0LlxuICAgICAqL1xuICAgIGdldCByZWZlcmVuY2VUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfUmVmZXJlbmNlVGV4dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgcmVmZXJlbmNlIHRleHQuXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUucmVmZXJlbmNlVGV4dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVmZXJlbmNlVGV4dCAtIFJlZmVyZW5jZSB0ZXh0LlxuICAgICAqL1xuICAgIHNldCByZWZlcmVuY2VUZXh0KHJlZmVyZW5jZVRleHQpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZmVyZW5jZVRleHQsIFwicmVmZXJlbmNlVGV4dFwiKTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfUmVmZXJlbmNlVGV4dCwgcmVmZXJlbmNlVGV4dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHBob25lbWUgYWxwaGFiZXQuXG4gICAgICogVGhlIHZhbGlkIHZhbHVlcyBhcmUgXCJTQVBJXCIgKGRlZmF1bHQpIGFuZCBcIklQQVwiLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMC4wXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUucGhvbmVtZUFscGhhYmV0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwaG9uZW1lQWxwaGFiZXQgLSBQaG9uZW1lIGFscGhhYmV0LlxuICAgICAqL1xuICAgIHNldCBwaG9uZW1lQWxwaGFiZXQocGhvbmVtZUFscGhhYmV0KSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShwaG9uZW1lQWxwaGFiZXQsIFwicGhvbmVtZUFscGhhYmV0XCIpO1xuICAgICAgICB0aGlzLnByaXZQaG9uZW1lQWxwaGFiZXQgPSBwaG9uZW1lQWxwaGFiZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGJvb2xlYW4gZW5hYmxlTWlzY3VlIHByb3BlcnR5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yNi4wXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUuZW5hYmxlTWlzY3VlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZW5hYmxlTWlzY3VlIC0gZW5hYmxlIG1pc2N1ZS5cbiAgICAgKi9cbiAgICBzZXQgZW5hYmxlTWlzY3VlKGVuYWJsZU1pc2N1ZSkge1xuICAgICAgICBjb25zdCBlbmFibGVNaXNjdWVTdHJpbmcgPSBlbmFibGVNaXNjdWUgPyBcInRydWVcIiA6IFwiZmFsc2VcIjtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfRW5hYmxlTWlzY3VlLCBlbmFibGVNaXNjdWVTdHJpbmcpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBib29sZWFuIGVuYWJsZU1pc2N1ZSBwcm9wZXJ0eS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjYuMFxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRDb25maWcucHJvdG90eXBlLmVuYWJsZU1pc2N1ZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBlbmFibGVNaXNjdWUgLSBlbmFibGUgbWlzY3VlLlxuICAgICAqL1xuICAgIGdldCBlbmFibGVNaXNjdWUoKSB7XG4gICAgICAgIGNvbnN0IGVuYWJsZU1pc2N1ZVN0cmluZyA9IHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0VuYWJsZU1pc2N1ZSwgXCJmYWxzZVwiKTtcbiAgICAgICAgcmV0dXJuIChlbmFibGVNaXNjdWVTdHJpbmcudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBuYmVzdCBwaG9uZW1lIGNvdW50XG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIwLjBcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnLnByb3RvdHlwZS5uYmVzdFBob25lbWVDb3VudFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbmJlc3RQaG9uZW1lQ291bnQgLSBOQmVzdCBwaG9uZW1lIGNvdW50LlxuICAgICAqL1xuICAgIHNldCBuYmVzdFBob25lbWVDb3VudChuYmVzdFBob25lbWVDb3VudCkge1xuICAgICAgICB0aGlzLnByaXZOQmVzdFBob25lbWVDb3VudCA9IG5iZXN0UGhvbmVtZUNvdW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnLnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm4ge1Byb3BlcnR5Q29sbGVjdGlvbn0gUHJvcGVydGllcyBvZiB0aGUgY29uZmlnLlxuICAgICAqIEBzdW1tYXJ5IEdldHMgYSBwcm9udW5jaWF0aW9uIGFzc2Vzc21lbnQgY29uZmlnIHByb3BlcnRpZXNcbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIHVwZGF0ZUpzb24oKSB7XG4gICAgICAgIGNvbnN0IGpzb25TdHJpbmcgPSB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfSnNvbiwgXCJ7fVwiKTtcbiAgICAgICAgY29uc3QgcGFyYW1zSnNvbiA9IEpTT04ucGFyc2UoanNvblN0cmluZyk7XG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZVRleHQgPSB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfUmVmZXJlbmNlVGV4dCk7XG4gICAgICAgIGlmIChyZWZlcmVuY2VUZXh0KSB7XG4gICAgICAgICAgICBwYXJhbXNKc29uLnJlZmVyZW5jZVRleHQgPSByZWZlcmVuY2VUZXh0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGdyYWRpbmdTeXN0ZW0gPSB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfR3JhZGluZ1N5c3RlbSk7XG4gICAgICAgIGlmIChncmFkaW5nU3lzdGVtKSB7XG4gICAgICAgICAgICBwYXJhbXNKc29uLmdyYWRpbmdTeXN0ZW0gPSBncmFkaW5nU3lzdGVtO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGdyYW51bGFyaXR5ID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlByb251bmNpYXRpb25Bc3Nlc3NtZW50X0dyYW51bGFyaXR5KTtcbiAgICAgICAgaWYgKGdyYW51bGFyaXR5KSB7XG4gICAgICAgICAgICBwYXJhbXNKc29uLmdyYW51bGFyaXR5ID0gZ3JhbnVsYXJpdHk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdlBob25lbWVBbHBoYWJldCkge1xuICAgICAgICAgICAgcGFyYW1zSnNvbi5waG9uZW1lQWxwaGFiZXQgPSB0aGlzLnByaXZQaG9uZW1lQWxwaGFiZXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJpdk5CZXN0UGhvbmVtZUNvdW50KSB7XG4gICAgICAgICAgICBwYXJhbXNKc29uLm5iZXN0UGhvbmVtZUNvdW50ID0gdGhpcy5wcml2TkJlc3RQaG9uZW1lQ291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWx3YXlzIHNldCBkaW1lbnNpb24gdG8gQ29tcHJlaGVuc2l2ZVxuICAgICAgICBwYXJhbXNKc29uLmRpbWVuc2lvbiA9IFwiQ29tcHJlaGVuc2l2ZVwiO1xuICAgICAgICBwYXJhbXNKc29uLmVuYWJsZU1pc2N1ZSA9IHRoaXMuZW5hYmxlTWlzY3VlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfUGFyYW1zLCBKU09OLnN0cmluZ2lmeShwYXJhbXNKc29uKSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRoZSBwb2ludCBzeXN0ZW0gZm9yIHByb251bmNpYXRpb24gc2NvcmUgY2FsaWJyYXRpb247IGRlZmF1bHQgdmFsdWUgaXMgRml2ZVBvaW50LlxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjBcbiAqIEBjbGFzcyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW1cbiAqL1xuZXhwb3J0IHZhciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW07XG4oZnVuY3Rpb24gKFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbSkge1xuICAgIC8qKlxuICAgICAqIEZpdmUgcG9pbnQgY2FsaWJyYXRpb25cbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbS5GaXZlUG9pbnRcbiAgICAgKi9cbiAgICBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW1bUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtW1wiRml2ZVBvaW50XCJdID0gMV0gPSBcIkZpdmVQb2ludFwiO1xuICAgIC8qKlxuICAgICAqIEh1bmRyZWQgbWFya1xuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtLkh1bmRyZWRNYXJrXG4gICAgICovXG4gICAgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFkaW5nU3lzdGVtW1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbVtcIkh1bmRyZWRNYXJrXCJdID0gMl0gPSBcIkh1bmRyZWRNYXJrXCI7XG59KShQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYWRpbmdTeXN0ZW0gfHwgKFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhZGluZ1N5c3RlbS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIHRoZSBwcm9udW5jaWF0aW9uIGV2YWx1YXRpb24gZ3JhbnVsYXJpdHk7IGRlZmF1bHQgdmFsdWUgaXMgUGhvbmVtZS5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gKiBAY2xhc3MgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVxuICovXG5leHBvcnQgdmFyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHk7XG4oZnVuY3Rpb24gKFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkpIHtcbiAgICAvKipcbiAgICAgKiBTaG93cyB0aGUgc2NvcmUgb24gdGhlIGZ1bGwgdGV4dCwgd29yZCBhbmQgcGhvbmVtZSBsZXZlbFxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eS5QaG9uZW1lXG4gICAgICovXG4gICAgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVtQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5W1wiUGhvbmVtZVwiXSA9IDFdID0gXCJQaG9uZW1lXCI7XG4gICAgLyoqXG4gICAgICogU2hvd3MgdGhlIHNjb3JlIG9uIHRoZSBmdWxsIHRleHQgYW5kIHdvcmQgbGV2ZWxcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkuV29yZFxuICAgICAqL1xuICAgIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHlbUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eVtcIldvcmRcIl0gPSAyXSA9IFwiV29yZFwiO1xuICAgIC8qKlxuICAgICAqIFNob3dzIHRoZSBzY29yZSBvbiB0aGUgZnVsbCB0ZXh0IGxldmVsIG9ubHlcbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkuRnVsbFRleHRcbiAgICAgKi9cbiAgICBQcm9udW5jaWF0aW9uQXNzZXNzbWVudEdyYW51bGFyaXR5W1Byb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHlbXCJGdWxsVGV4dFwiXSA9IDNdID0gXCJGdWxsVGV4dFwiO1xufSkoUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eSB8fCAoUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRHcmFudWxhcml0eSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVByb251bmNpYXRpb25Bc3Nlc3NtZW50R3JhbnVsYXJpdHkuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgUHJvcGVydHlJZCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogUHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IHJlc3VsdHMuXG4gKiBAY2xhc3MgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHRcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wLlxuICovXG5leHBvcnQgY2xhc3MgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKGpzb25TdHJpbmcpIHtcbiAgICAgICAgY29uc3QgaiA9IEpTT04ucGFyc2UoanNvblN0cmluZyk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGouTkJlc3RbMF0sIFwiTkJlc3RcIik7XG4gICAgICAgIHRoaXMucHJpdlByb25Kc29uID0gai5OQmVzdFswXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdC5mcm9tUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7UmVjb2duaXRpb25SZXN1bHR9IHJlc3VsdCBUaGUgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqIEByZXR1cm4ge1Byb251bmNpYXRpb25Bc3Nlc3NtZW50Q29uZmlnfSBJbnN0YW5jZSBvZiBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZ1xuICAgICAqIEBzdW1tYXJ5IENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIFByb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0IGZyb20gcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChyZXN1bHQsIFwicmVzdWx0XCIpO1xuICAgICAgICBjb25zdCBqc29uID0gcmVzdWx0LnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGpzb24sIFwianNvblwiKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdChqc29uKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgZGV0YWlsIHJlc3VsdCBvZiBwcm9udW5jaWF0aW9uIGFzc2Vzc21lbnQuXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudENvbmZpZy5wcm90b3R5cGUuZGV0YWlsUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtEZXRhaWxSZXN1bHR9IGRldGFpbCByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IGRldGFpbFJlc3VsdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb25Kc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgc2NvcmUgaW5kaWNhdGluZyB0aGUgcHJvbnVuY2lhdGlvbiBhY2N1cmFjeSBvZiB0aGUgZ2l2ZW4gc3BlZWNoLCB3aGljaCBpbmRpY2F0ZXNcbiAgICAgKiBob3cgY2xvc2VseSB0aGUgcGhvbmVtZXMgbWF0Y2ggYSBuYXRpdmUgc3BlYWtlcidzIHByb251bmNpYXRpb24uXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdC5wcm90b3R5cGUuYWNjdXJhY3lTY29yZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBBY2N1cmFjeSBzY29yZS5cbiAgICAgKi9cbiAgICBnZXQgYWNjdXJhY3lTY29yZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGV0YWlsUmVzdWx0LlByb251bmNpYXRpb25Bc3Nlc3NtZW50LkFjY3VyYWN5U2NvcmU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBvdmVyYWxsIHNjb3JlIGluZGljYXRpbmcgdGhlIHByb251bmNpYXRpb24gcXVhbGl0eSBvZiB0aGUgZ2l2ZW4gc3BlZWNoLlxuICAgICAqIFRoaXMgaXMgY2FsY3VsYXRlZCBmcm9tIEFjY3VyYWN5U2NvcmUsIEZsdWVuY3lTY29yZSBhbmQgQ29tcGxldGVuZXNzU2NvcmUgd2l0aCB3ZWlnaHQuXG4gICAgICogQG1lbWJlciBQcm9udW5jaWF0aW9uQXNzZXNzbWVudFJlc3VsdC5wcm90b3R5cGUucHJvbnVuY2lhdGlvblNjb3JlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFByb251bmNpYXRpb24gc2NvcmUuXG4gICAgICovXG4gICAgZ2V0IHByb251bmNpYXRpb25TY29yZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGV0YWlsUmVzdWx0LlByb251bmNpYXRpb25Bc3Nlc3NtZW50LlByb25TY29yZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHNjb3JlIGluZGljYXRpbmcgdGhlIGNvbXBsZXRlbmVzcyBvZiB0aGUgZ2l2ZW4gc3BlZWNoIGJ5IGNhbGN1bGF0aW5nIHRoZSByYXRpbyBvZiBwcm9ub3VuY2VkIHdvcmRzIHRvd2FyZHMgZW50aXJlIGlucHV0LlxuICAgICAqIEBtZW1iZXIgUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQucHJvdG90eXBlLmNvbXBsZXRlbmVzc1Njb3JlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IENvbXBsZXRlbmVzcyBzY29yZS5cbiAgICAgKi9cbiAgICBnZXQgY29tcGxldGVuZXNzU2NvcmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRldGFpbFJlc3VsdC5Qcm9udW5jaWF0aW9uQXNzZXNzbWVudC5Db21wbGV0ZW5lc3NTY29yZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHNjb3JlIGluZGljYXRpbmcgdGhlIGZsdWVuY3kgb2YgdGhlIGdpdmVuIHNwZWVjaC5cbiAgICAgKiBAbWVtYmVyIFByb251bmNpYXRpb25Bc3Nlc3NtZW50UmVzdWx0LnByb3RvdHlwZS5mbHVlbmN5U2NvcmVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gRmx1ZW5jeSBzY29yZS5cbiAgICAgKi9cbiAgICBnZXQgZmx1ZW5jeVNjb3JlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZXRhaWxSZXN1bHQuUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnQuRmx1ZW5jeVNjb3JlO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFByb3BlcnR5SWQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFJlcHJlc2VudHMgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMuXG4gKiBAY2xhc3MgUHJvcGVydHlDb2xsZWN0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9wZXJ0eUNvbGxlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByaXZLZXlzID0gW107XG4gICAgICAgIHRoaXMucHJpdlZhbHVlcyA9IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwcm9wZXJ0eSB2YWx1ZSBpbiB0eXBlIFN0cmluZy5cbiAgICAgKiBDdXJyZW50bHkgb25seSBTdHJpbmcsIGludCBhbmQgYm9vbCBhcmUgYWxsb3dlZC5cbiAgICAgKiBJZiB0aGUgbmFtZSBpcyBub3QgYXZhaWxhYmxlLCB0aGUgc3BlY2lmaWVkIGRlZmF1bHRWYWx1ZSBpcyByZXR1cm5lZC5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0UHJvcGVydHlcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIFRoZSBwYXJhbWV0ZXIgbmFtZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IG51bWJlciB8IGJvb2xlYW59IGRlZiAtIFRoZSBkZWZhdWx0IHZhbHVlIHdoaWNoIGlzIHJldHVybmVkIGlmIHRoZSBwYXJhbWV0ZXJcbiAgICAgKiBpcyBub3QgYXZhaWxhYmxlIGluIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHZhbHVlIG9mIHRoZSBwYXJhbWV0ZXIuXG4gICAgICovXG4gICAgZ2V0UHJvcGVydHkoa2V5LCBkZWYpIHtcbiAgICAgICAgbGV0IGtleVRvVXNlO1xuICAgICAgICBpZiAodHlwZW9mIGtleSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAga2V5VG9Vc2UgPSBrZXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBrZXlUb1VzZSA9IFByb3BlcnR5SWRba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHRoaXMucHJpdktleXMubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZLZXlzW25dID09PSBrZXlUb1VzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByaXZWYWx1ZXNbbl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBTdHJpbmcoZGVmKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgU3RyaW5nIHZhbHVlIG9mIHRoZSBwYXJhbWV0ZXIgc3BlY2lmaWVkIGJ5IG5hbWUuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUNvbGxlY3Rpb24ucHJvdG90eXBlLnNldFByb3BlcnR5XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBUaGUgcGFyYW1ldGVyIG5hbWUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIHZhbHVlIG9mIHRoZSBwYXJhbWV0ZXIuXG4gICAgICovXG4gICAgc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSkge1xuICAgICAgICBsZXQga2V5VG9Vc2U7XG4gICAgICAgIGlmICh0eXBlb2Yga2V5ID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBrZXlUb1VzZSA9IGtleTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGtleVRvVXNlID0gUHJvcGVydHlJZFtrZXldO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdGhpcy5wcml2S2V5cy5sZW5ndGg7IG4rKykge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdktleXNbbl0gPT09IGtleVRvVXNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2VmFsdWVzW25dID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdktleXMucHVzaChrZXlUb1VzZSk7XG4gICAgICAgIHRoaXMucHJpdlZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvbmVzIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlDb2xsZWN0aW9uLnByb3RvdHlwZS5jbG9uZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBBIGNvcHkgb2YgdGhlIGNvbGxlY3Rpb24uXG4gICAgICovXG4gICAgY2xvbmUoKSB7XG4gICAgICAgIGNvbnN0IGNsb25lZE1hcCA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0aGlzLnByaXZLZXlzLmxlbmd0aDsgbisrKSB7XG4gICAgICAgICAgICBjbG9uZWRNYXAucHJpdktleXMucHVzaCh0aGlzLnByaXZLZXlzW25dKTtcbiAgICAgICAgICAgIGNsb25lZE1hcC5wcml2VmFsdWVzLnB1c2godGhpcy5wcml2VmFsdWVzW25dKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2xvbmVkTWFwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXJnZXMgdGhpcyBzZXQgb2YgcHJvcGVydGllcyBpbnRvIGFub3RoZXIsIG5vIG92ZXJ3cml0ZXMuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUNvbGxlY3Rpb24ucHJvdG90eXBlLm1lcmdlVG9cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUNvbGxlY3Rpb259ICBkZXN0aW5hdGlvbkNvbGxlY3Rpb24gLSBUaGUgY29sbGVjdGlvbiB0byBtZXJnZSBpbnRvLlxuICAgICAqL1xuICAgIG1lcmdlVG8oZGVzdGluYXRpb25Db2xsZWN0aW9uKSB7XG4gICAgICAgIHRoaXMucHJpdktleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBpZiAoZGVzdGluYXRpb25Db2xsZWN0aW9uLmdldFByb3BlcnR5KGtleSwgdW5kZWZpbmVkKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldFByb3BlcnR5KGtleSk7XG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb25Db2xsZWN0aW9uLnNldFByb3BlcnR5KGtleSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBrZXlzIGluIFByb3BlcnR5IENvbGxlY3Rpb24uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUNvbGxlY3Rpb24ucHJvdG90eXBlLmtleXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZyBbXX0gS2V5cyBpbiB0aGUgY29sbGVjdGlvbi5cbiAgICAgKi9cbiAgICBnZXQga2V5cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdktleXM7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm9wZXJ0eUNvbGxlY3Rpb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBzcGVlY2ggcHJvcGVydHkgaWRzLlxuICogQGNsYXNzIFByb3BlcnR5SWRcbiAqL1xuZXhwb3J0IHZhciBQcm9wZXJ0eUlkO1xuKGZ1bmN0aW9uIChQcm9wZXJ0eUlkKSB7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSBzdWJzY3JpcHRpb24gS2V5LiBJZiB5b3UgYXJlIHVzaW5nIGFuIGludGVudCByZWNvZ25pemVyLCB5b3UgbmVlZCB0b1xuICAgICAqIHNwZWNpZnkgdGhlIExVSVMgZW5kcG9pbnQga2V5IGZvciB5b3VyIHBhcnRpY3VsYXIgTFVJUyBhcHAuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0XG4gICAgICogaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkLCB1c2UgW1tTcGVlY2hDb25maWcuZnJvbVN1YnNjcmlwdGlvbl1dLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXlcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXlcIl0gPSAwXSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5XCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSBlbmRwb2ludCAodXJsKS4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3RcbiAgICAgKiBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW1NwZWVjaENvbmZpZy5mcm9tRW5kcG9pbnRdXS5cbiAgICAgKiBOT1RFOiBUaGlzIGVuZHBvaW50IGlzIG5vdCB0aGUgc2FtZSBhcyB0aGUgZW5kcG9pbnQgdXNlZCB0byBvYnRhaW4gYW4gYWNjZXNzIHRva2VuLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50XCJdID0gMV0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50XCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSByZWdpb24uIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG9cbiAgICAgKiB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkLCB1c2UgW1tTcGVlY2hDb25maWcuZnJvbVN1YnNjcmlwdGlvbl1dLCBbW1NwZWVjaENvbmZpZy5mcm9tRW5kcG9pbnRdXSwgW1tTcGVlY2hDb25maWcuZnJvbUF1dGhvcml6YXRpb25Ub2tlbl1dLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb25cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb25cIl0gPSAyXSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uXCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSBhdXRob3JpemF0aW9uIHRva2VuIChha2EgYWNjZXNzIHRva2VuKS4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsXG4gICAgICogeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW1NwZWVjaENvbmZpZy5mcm9tQXV0aG9yaXphdGlvblRva2VuXV0sIFtbU3BlZWNoUmVjb2duaXplci5hdXRob3JpemF0aW9uVG9rZW5dXSxcbiAgICAgKiBbW0ludGVudFJlY29nbml6ZXIuYXV0aG9yaXphdGlvblRva2VuXV0sIFtbVHJhbnNsYXRpb25SZWNvZ25pemVyLmF1dGhvcml6YXRpb25Ub2tlbl1dLCBbW1NwZWFrZXJSZWNvZ25pemVyLmF1dGhvcml6YXRpb25Ub2tlbl1dLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlblxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuXCJdID0gM10gPSBcIlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuXCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSBhdXRob3JpemF0aW9uIHR5cGUuIEN1cnJlbnRseSB1bnVzZWQuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1R5cGVcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9UeXBlXCJdID0gNF0gPSBcIlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1R5cGVcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlIGVuZHBvaW50IGlkLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndFxuICAgICAqIGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCwgdXNlIFtbU3BlZWNoQ29uZmlnLmVuZHBvaW50SWRdXS5cbiAgICAgKiBOT1RFOiBUaGUgZW5kcG9pbnQgaWQgaXMgYXZhaWxhYmxlIGluIHRoZSBTcGVlY2ggUG9ydGFsLCBsaXN0ZWQgdW5kZXIgRW5kcG9pbnQgRGV0YWlscy5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWRcIl0gPSA1XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBsaXN0IG9mIGNvbW1hIHNlcGFyYXRlZCBsYW5ndWFnZXMgKEJDUC00NyBmb3JtYXQpIHVzZWQgYXMgdGFyZ2V0IHRyYW5zbGF0aW9uIGxhbmd1YWdlcy4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsXG4gICAgICogeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQgdXNlIFtbU3BlZWNoVHJhbnNsYXRpb25Db25maWcuYWRkVGFyZ2V0TGFuZ3VhZ2VdXSxcbiAgICAgKiBbW1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLnRhcmdldExhbmd1YWdlc11dLCBbW1RyYW5zbGF0aW9uUmVjb2duaXplci50YXJnZXRMYW5ndWFnZXNdXS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlc1xuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXNcIl0gPSA2XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlc1wiO1xuICAgIC8qKlxuICAgICAqIFRoZSBuYW1lIG9mIHRoZSBDb2duaXRpdmUgU2VydmljZSBUZXh0IHRvIFNwZWVjaCBTZXJ2aWNlIFZvaWNlLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzXG4gICAgICogcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCwgdXNlIFtbU3BlZWNoVHJhbnNsYXRpb25Db25maWcudm9pY2VOYW1lXV0uXG4gICAgICogTk9URTogVmFsaWQgdm9pY2UgbmFtZXMgY2FuIGJlIGZvdW5kIDxhIGhyZWY9XCJodHRwczovL2FrYS5tcy9jc3NwZWVjaC92b2ljZW5hbWVzXCI+aGVyZTwvYT4uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVm9pY2VcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlXCJdID0gN10gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVm9pY2VcIjtcbiAgICAvKipcbiAgICAgKiBUcmFuc2xhdGlvbiBmZWF0dXJlcy5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25GZWF0dXJlc1xuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uRmVhdHVyZXNcIl0gPSA4XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25GZWF0dXJlc1wiO1xuICAgIC8qKlxuICAgICAqIFRoZSBMYW5ndWFnZSBVbmRlcnN0YW5kaW5nIFNlcnZpY2UgUmVnaW9uLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW0xhbmd1YWdlVW5kZXJzdGFuZGluZ01vZGVsXV0uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0ludGVudFJlZ2lvblxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0ludGVudFJlZ2lvblwiXSA9IDldID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9JbnRlbnRSZWdpb25cIjtcbiAgICAvKipcbiAgICAgKiBUaGUgaG9zdCBuYW1lIG9mIHRoZSBwcm94eSBzZXJ2ZXIgdXNlZCB0byBjb25uZWN0IHRvIHRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UuIE9ubHkgcmVsZXZhbnQgaW4gTm9kZS5qcyBlbnZpcm9ubWVudHMuXG4gICAgICogWW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQgdXNlIDxzZWUgY3JlZj1cIlNwZWVjaENvbmZpZy5TZXRQcm94eShzdHJpbmcsaW50LHN0cmluZyxzdHJpbmcpXCIvPi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNC4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5SG9zdE5hbWVcIl0gPSAxMF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5SG9zdE5hbWVcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgcG9ydCBvZiB0aGUgcHJveHkgc2VydmVyIHVzZWQgdG8gY29ubmVjdCB0byB0aGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlLiBPbmx5IHJlbGV2YW50IGluIE5vZGUuanMgZW52aXJvbm1lbnRzLlxuICAgICAqIFlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkIHVzZSA8c2VlIGNyZWY9XCJTcGVlY2hDb25maWcuU2V0UHJveHkoc3RyaW5nLGludCxzdHJpbmcsc3RyaW5nKVwiLz4uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjQuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBvcnRcIl0gPSAxMV0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UG9ydFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSB1c2VyIG5hbWUgb2YgdGhlIHByb3h5IHNlcnZlciB1c2VkIHRvIGNvbm5lY3QgdG8gdGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZS4gT25seSByZWxldmFudCBpbiBOb2RlLmpzIGVudmlyb25tZW50cy5cbiAgICAgKiBZb3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCB1c2UgPHNlZSBjcmVmPVwiU3BlZWNoQ29uZmlnLlNldFByb3h5KHN0cmluZyxpbnQsc3RyaW5nLHN0cmluZylcIi8+LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS40LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlVc2VyTmFtZVwiXSA9IDEyXSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlVc2VyTmFtZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBwYXNzd29yZCBvZiB0aGUgcHJveHkgc2VydmVyIHVzZWQgdG8gY29ubmVjdCB0byB0aGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlLiBPbmx5IHJlbGV2YW50IGluIE5vZGUuanMgZW52aXJvbm1lbnRzLlxuICAgICAqIFlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBJbnN0ZWFkIHVzZSA8c2VlIGNyZWY9XCJTcGVlY2hDb25maWcuU2V0UHJveHkoc3RyaW5nLGludCxzdHJpbmcsc3RyaW5nKVwiLz4uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjQuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBhc3N3b3JkXCJdID0gMTNdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBhc3N3b3JkXCI7XG4gICAgLyoqXG4gICAgICogVGhlIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSByZWNvZ25pdGlvbiBNb2RlLiBDYW4gYmUgXCJJTlRFUkFDVElWRVwiLCBcIkNPTlZFUlNBVElPTlwiLCBcIkRJQ1RBVElPTlwiLlxuICAgICAqIFRoaXMgcHJvcGVydHkgaXMgaW50ZW5kZWQgdG8gYmUgcmVhZC1vbmx5LiBUaGUgU0RLIGlzIHVzaW5nIGl0IGludGVybmFsbHkuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29Nb2RlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb01vZGVcIl0gPSAxNF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29Nb2RlXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHNwb2tlbiBsYW5ndWFnZSB0byBiZSByZWNvZ25pemVkIChpbiBCQ1AtNDcgZm9ybWF0KS4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eVxuICAgICAqIGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQsIHVzZSBbW1NwZWVjaENvbmZpZy5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXV0uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZVxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZVwiXSA9IDE1XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHNlc3Npb24gaWQuIFRoaXMgaWQgaXMgYSB1bml2ZXJzYWxseSB1bmlxdWUgaWRlbnRpZmllciAoYWthIFVVSUQpIHJlcHJlc2VudGluZyBhIHNwZWNpZmljIGJpbmRpbmcgb2YgYW4gYXVkaW8gaW5wdXQgc3RyZWFtXG4gICAgICogYW5kIHRoZSB1bmRlcmx5aW5nIHNwZWVjaCByZWNvZ25pdGlvbiBpbnN0YW5jZSB0byB3aGljaCBpdCBpcyBib3VuZC4gVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpc1xuICAgICAqIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEluc3RlYWQgdXNlIFtbU2Vzc2lvbkV2ZW50QXJncy5zZXNzaW9uSWRdXS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoX1Nlc3Npb25JZFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaF9TZXNzaW9uSWRcIl0gPSAxNl0gPSBcIlNwZWVjaF9TZXNzaW9uSWRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgc3Bva2VuIGxhbmd1YWdlIHRvIGJlIHN5bnRoZXNpemVkIChlLmcuIGVuLVVTKVxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aExhbmd1YWdlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhMYW5ndWFnZVwiXSA9IDE3XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhMYW5ndWFnZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBuYW1lIG9mIHRoZSBUVFMgdm9pY2UgdG8gYmUgdXNlZCBmb3Igc3BlZWNoIHN5bnRoZXNpc1xuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aFZvaWNlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZVwiXSA9IDE4XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBzdHJpbmcgdG8gc3BlY2lmeSBUVFMgb3V0cHV0IGF1ZGlvIGZvcm1hdFxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoT3V0cHV0Rm9ybWF0XCJdID0gMTldID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBsaXN0IG9mIGNvbW1hIHNlcGFyYXRlZCBsYW5ndWFnZXMgdXNlZCBhcyBwb3NzaWJsZSBzb3VyY2UgbGFuZ3VhZ2VzXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjEzLjBcbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlc1xuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNcIl0gPSAyMF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdGVkIENvZ25pdGl2ZSBTZXJ2aWNlcyBTcGVlY2ggU2VydmljZSByZXNwb25zZSBvdXRwdXQgZm9ybWF0IChzaW1wbGUgb3IgZGV0YWlsZWQpLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlXG4gICAgICogdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCB1c2UgW1tTcGVlY2hDb25maWcub3V0cHV0Rm9ybWF0XV0uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0RGV0YWlsZWRSZXN1bHRUcnVlRmFsc2VcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdERldGFpbGVkUmVzdWx0VHJ1ZUZhbHNlXCJdID0gMjFdID0gXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdERldGFpbGVkUmVzdWx0VHJ1ZUZhbHNlXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHJlcXVlc3RlZCBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgcmVzcG9uc2Ugb3V0cHV0IHByb2Zhbml0eSBsZXZlbC4gQ3VycmVudGx5IHVudXNlZC5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RQcm9mYW5pdHlGaWx0ZXJUcnVlRmFsc2VcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFByb2Zhbml0eUZpbHRlclRydWVGYWxzZVwiXSA9IDIyXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RQcm9mYW5pdHlGaWx0ZXJUcnVlRmFsc2VcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlIHJlc3BvbnNlIG91dHB1dCAoaW4gSlNPTiBmb3JtYXQpLiBUaGlzIHByb3BlcnR5IGlzIGF2YWlsYWJsZSBvbiByZWNvZ25pdGlvbiByZXN1bHQgb2JqZWN0cyBvbmx5LlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0XCJdID0gMjNdID0gXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBDb2duaXRpdmUgU2VydmljZXMgU3BlZWNoIFNlcnZpY2UgZXJyb3IgZGV0YWlscyAoaW4gSlNPTiBmb3JtYXQpLiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvXG4gICAgICogdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuIEluc3RlYWQgdXNlIFtbQ2FuY2VsbGF0aW9uRGV0YWlscy5lcnJvckRldGFpbHNdXS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25FcnJvckRldGFpbHNcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvbkVycm9yRGV0YWlsc1wiXSA9IDI0XSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX0pzb25FcnJvckRldGFpbHNcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgY2FuY2VsbGF0aW9uIHJlYXNvbi4gQ3VycmVudGx5IHVudXNlZC5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ2FuY2VsbGF0aW9uRGV0YWlsc19SZWFzb25cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDYW5jZWxsYXRpb25EZXRhaWxzX1JlYXNvblwiXSA9IDI1XSA9IFwiQ2FuY2VsbGF0aW9uRGV0YWlsc19SZWFzb25cIjtcbiAgICAvKipcbiAgICAgKiBUaGUgY2FuY2VsbGF0aW9uIHRleHQuIEN1cnJlbnRseSB1bnVzZWQuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNhbmNlbGxhdGlvbkRldGFpbHNfUmVhc29uVGV4dFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNhbmNlbGxhdGlvbkRldGFpbHNfUmVhc29uVGV4dFwiXSA9IDI2XSA9IFwiQ2FuY2VsbGF0aW9uRGV0YWlsc19SZWFzb25UZXh0XCI7XG4gICAgLyoqXG4gICAgICogVGhlIENhbmNlbGxhdGlvbiBkZXRhaWxlZCB0ZXh0LiBDdXJyZW50bHkgdW51c2VkLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5DYW5jZWxsYXRpb25EZXRhaWxzX1JlYXNvbkRldGFpbGVkVGV4dFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNhbmNlbGxhdGlvbkRldGFpbHNfUmVhc29uRGV0YWlsZWRUZXh0XCJdID0gMjddID0gXCJDYW5jZWxsYXRpb25EZXRhaWxzX1JlYXNvbkRldGFpbGVkVGV4dFwiO1xuICAgIC8qKlxuICAgICAqIFRoZSBMYW5ndWFnZSBVbmRlcnN0YW5kaW5nIFNlcnZpY2UgcmVzcG9uc2Ugb3V0cHV0IChpbiBKU09OIGZvcm1hdCkuIEF2YWlsYWJsZSB2aWEgW1tJbnRlbnRSZWNvZ25pdGlvblJlc3VsdF1dXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkxhbmd1YWdlVW5kZXJzdGFuZGluZ1NlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0XG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nU2VydmljZVJlc3BvbnNlX0pzb25SZXN1bHRcIl0gPSAyOF0gPSBcIkxhbmd1YWdlVW5kZXJzdGFuZGluZ1NlcnZpY2VSZXNwb25zZV9Kc29uUmVzdWx0XCI7XG4gICAgLyoqXG4gICAgICogVGhlIFVSTCBzdHJpbmcgYnVpbHQgZnJvbSBzcGVlY2ggY29uZmlndXJhdGlvbi5cbiAgICAgKiBUaGlzIHByb3BlcnR5IGlzIGludGVuZGVkIHRvIGJlIHJlYWQtb25seS4gVGhlIFNESyBpcyB1c2luZyBpdCBpbnRlcm5hbGx5LlxuICAgICAqIE5PVEU6IEFkZGVkIGluIHZlcnNpb24gMS43LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVXJsXCJdID0gMjldID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9VcmxcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgaW5pdGlhbCBzaWxlbmNlIHRpbWVvdXQgdmFsdWUgKGluIG1pbGxpc2Vjb25kcykgdXNlZCBieSB0aGUgc2VydmljZS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSW5pdGlhbFNpbGVuY2VUaW1lb3V0TXNcIl0gPSAzMF0gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0luaXRpYWxTaWxlbmNlVGltZW91dE1zXCI7XG4gICAgLyoqXG4gICAgICogVGhlIGVuZCBzaWxlbmNlIHRpbWVvdXQgdmFsdWUgKGluIG1pbGxpc2Vjb25kcykgdXNlZCBieSB0aGUgc2VydmljZS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kU2lsZW5jZVRpbWVvdXRNc1wiXSA9IDMxXSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kU2lsZW5jZVRpbWVvdXRNc1wiO1xuICAgIC8qKlxuICAgICAqIEEgZHVyYXRpb24gb2YgZGV0ZWN0ZWQgc2lsZW5jZSwgbWVhc3VyZWQgaW4gbWlsbGlzZWNvbmRzLCBhZnRlciB3aGljaCBzcGVlY2gtdG8tdGV4dCB3aWxsIGRldGVybWluZSBhIHNwb2tlblxuICAgICAqIHBocmFzZSBoYXMgZW5kZWQgYW5kIGdlbmVyYXRlIGEgZmluYWwgUmVjb2duaXplZCByZXN1bHQuIENvbmZpZ3VyaW5nIHRoaXMgdGltZW91dCBtYXkgYmUgaGVscGZ1bCBpbiBzaXR1YXRpb25zXG4gICAgICogd2hlcmUgc3Bva2VuIGlucHV0IGlzIHNpZ25pZmljYW50bHkgZmFzdGVyIG9yIHNsb3dlciB0aGFuIHVzdWFsIGFuZCBkZWZhdWx0IHNlZ21lbnRhdGlvbiBiZWhhdmlvciBjb25zaXN0ZW50bHlcbiAgICAgKiB5aWVsZHMgcmVzdWx0cyB0aGF0IGFyZSB0b28gbG9uZyBvciB0b28gc2hvcnQuIFNlZ21lbnRhdGlvbiB0aW1lb3V0IHZhbHVlcyB0aGF0IGFyZSBpbmFwcHJvcHJpYXRlbHkgaGlnaCBvciBsb3dcbiAgICAgKiBjYW4gbmVnYXRpdmVseSBhZmZlY3Qgc3BlZWNoLXRvLXRleHQgYWNjdXJhY3k7IHRoaXMgcHJvcGVydHkgc2hvdWxkIGJlIGNhcmVmdWxseSBjb25maWd1cmVkIGFuZCB0aGUgcmVzdWx0aW5nXG4gICAgICogYmVoYXZpb3Igc2hvdWxkIGJlIHRob3JvdWdobHkgdmFsaWRhdGVkIGFzIGludGVuZGVkLlxuICAgICAqXG4gICAgICogRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgdGltZW91dCBjb25maWd1cmF0aW9uIHRoYXQgaW5jbHVkZXMgZGlzY3Vzc2lvbiBvZiBkZWZhdWx0IGJlaGF2aW9ycywgcGxlYXNlIHZpc2l0XG4gICAgICogaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvdGltZW91dHMuXG4gICAgICpcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjEuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hfU2VnbWVudGF0aW9uU2lsZW5jZVRpbWVvdXRNc1wiXSA9IDMyXSA9IFwiU3BlZWNoX1NlZ21lbnRhdGlvblNpbGVuY2VUaW1lb3V0TXNcIjtcbiAgICAvKipcbiAgICAgKiBBIGJvb2xlYW4gdmFsdWUgc3BlY2lmeWluZyB3aGV0aGVyIGF1ZGlvIGxvZ2dpbmcgaXMgZW5hYmxlZCBpbiB0aGUgc2VydmljZSBvciBub3QuXG4gICAgICogQXVkaW8gYW5kIGNvbnRlbnQgbG9ncyBhcmUgc3RvcmVkIGVpdGhlciBpbiBNaWNyb3NvZnQtb3duZWQgc3RvcmFnZSwgb3IgaW4geW91ciBvd24gc3RvcmFnZSBhY2NvdW50IGxpbmtlZFxuICAgICAqIHRvIHlvdXIgQ29nbml0aXZlIFNlcnZpY2VzIHN1YnNjcmlwdGlvbiAoQnJpbmcgWW91ciBPd24gU3RvcmFnZSAoQllPUykgZW5hYmxlZCBTcGVlY2ggcmVzb3VyY2UpLlxuICAgICAqIFRoZSBsb2dzIHdpbGwgYmUgcmVtb3ZlZCBhZnRlciAzMCBkYXlzLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS43LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmFibGVBdWRpb0xvZ2dpbmdcIl0gPSAzM10gPSBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuYWJsZUF1ZGlvTG9nZ2luZ1wiO1xuICAgIC8qKlxuICAgICAqIFRoZSBzcGVlY2ggc2VydmljZSBjb25uZWN0aW9uIGxhbmd1YWdlIGlkZW50aWZpZXIgbW9kZS5cbiAgICAgKiBDYW4gYmUgXCJBdFN0YXJ0XCIgKHRoZSBkZWZhdWx0KSwgb3IgXCJDb250aW51b3VzXCIuIFNlZSBMYW5ndWFnZVxuICAgICAqIElkZW50aWZpY2F0aW9uIGRvY3VtZW50IGh0dHBzOi8vYWthLm1zL3NwZWVjaC9saWQ/cGl2b3RzPXByb2dyYW1taW5nLWxhbmd1YWdlLWphdmFzY3JpcHRcbiAgICAgKiBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEFkZGVkIGluIDEuMjUuMFxuICAgICAqKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9MYW5ndWFnZUlkTW9kZVwiXSA9IDM0XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fTGFuZ3VhZ2VJZE1vZGVcIjtcbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIGRlc2lyZWQgZW5kcG9pbnQgdmVyc2lvbiB0byB0YXJnZXQgZm9yIFNwZWVjaCBSZWNvZ25pdGlvbi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjEuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29nbml0aW9uRW5kcG9pbnRWZXJzaW9uXCJdID0gMzVdID0gXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvZ25pdGlvbkVuZHBvaW50VmVyc2lvblwiO1xuICAgIC8qKlxuICAgIC8qKlxuICAgICAqIEEgc3RyaW5nIHZhbHVlIHRoZSBjdXJyZW50IHNwZWFrZXIgcmVjb2duaXRpb24gc2NlbmFyaW8vbW9kZSAoVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb24sIGV0Yy4pLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMy4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3BlYWtlcklkTW9kZVwiXSA9IDM2XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3BlYWtlcklkTW9kZVwiO1xuICAgIC8qKlxuICAgICAqIFRoZSByZXF1ZXN0ZWQgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlIHJlc3BvbnNlIG91dHB1dCBwcm9mYW5pdHkgc2V0dGluZy5cbiAgICAgKiBBbGxvd2VkIHZhbHVlcyBhcmUgXCJtYXNrZWRcIiwgXCJyZW1vdmVkXCIsIGFuZCBcInJhd1wiLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS43LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZVJlc3BvbnNlX1Byb2Zhbml0eU9wdGlvblwiXSA9IDM3XSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1Byb2Zhbml0eU9wdGlvblwiO1xuICAgIC8qKlxuICAgICAqIEEgc3RyaW5nIHZhbHVlIHNwZWNpZnlpbmcgd2hpY2ggcG9zdCBwcm9jZXNzaW5nIG9wdGlvbiBzaG91bGQgYmUgdXNlZCBieSBzZXJ2aWNlLlxuICAgICAqIEFsbG93ZWQgdmFsdWVzIGFyZSBcIlRydWVUZXh0XCIuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjcuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qb3N0UHJvY2Vzc2luZ09wdGlvblwiXSA9IDM4XSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1Bvc3RQcm9jZXNzaW5nT3B0aW9uXCI7XG4gICAgLyoqXG4gICAgICogQSBib29sZWFuIHZhbHVlIHNwZWNpZnlpbmcgd2hldGhlciB0byBpbmNsdWRlIHdvcmQtbGV2ZWwgdGltZXN0YW1wcyBpbiB0aGUgcmVzcG9uc2UgcmVzdWx0LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS43LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRMZXZlbFRpbWVzdGFtcHNcIl0gPSAzOV0gPSBcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0V29yZExldmVsVGltZXN0YW1wc1wiO1xuICAgIC8qKlxuICAgICAqIFRoZSBudW1iZXIgb2YgdGltZXMgYSB3b3JkIGhhcyB0byBiZSBpbiBwYXJ0aWFsIHJlc3VsdHMgdG8gYmUgcmV0dXJuZWQuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjcuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9TdGFibGVQYXJ0aWFsUmVzdWx0VGhyZXNob2xkXCJdID0gNDBdID0gXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfU3RhYmxlUGFydGlhbFJlc3VsdFRocmVzaG9sZFwiO1xuICAgIC8qKlxuICAgICAqIEEgc3RyaW5nIHZhbHVlIHNwZWNpZnlpbmcgdGhlIG91dHB1dCBmb3JtYXQgb3B0aW9uIGluIHRoZSByZXNwb25zZSByZXN1bHQuIEludGVybmFsIHVzZSBvbmx5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS43LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZVJlc3BvbnNlX091dHB1dEZvcm1hdE9wdGlvblwiXSA9IDQxXSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX091dHB1dEZvcm1hdE9wdGlvblwiO1xuICAgIC8qKlxuICAgICAqIEEgYm9vbGVhbiB2YWx1ZSB0byByZXF1ZXN0IGZvciBzdGFiaWxpemluZyB0cmFuc2xhdGlvbiBwYXJ0aWFsIHJlc3VsdHMgYnkgb21pdHRpbmcgd29yZHMgaW4gdGhlIGVuZC5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuNy4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9UcmFuc2xhdGlvblJlcXVlc3RTdGFibGVQYXJ0aWFsUmVzdWx0XCJdID0gNDJdID0gXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfVHJhbnNsYXRpb25SZXF1ZXN0U3RhYmxlUGFydGlhbFJlc3VsdFwiO1xuICAgIC8qKlxuICAgICAqIEEgYm9vbGVhbiB2YWx1ZSBzcGVjaWZ5aW5nIHdoZXRoZXIgdG8gcmVxdWVzdCBXb3JkQm91bmRhcnkgZXZlbnRzLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRCb3VuZGFyeVxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMS4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0V29yZEJvdW5kYXJ5XCJdID0gNDNdID0gXCJTcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUmVxdWVzdFdvcmRCb3VuZGFyeVwiO1xuICAgIC8qKlxuICAgICAqIEEgYm9vbGVhbiB2YWx1ZSBzcGVjaWZ5aW5nIHdoZXRoZXIgdG8gcmVxdWVzdCBwdW5jdHVhdGlvbiBib3VuZGFyeSBpbiBXb3JkQm91bmRhcnkgRXZlbnRzLiBEZWZhdWx0IGlzIHRydWUuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0UHVuY3R1YXRpb25Cb3VuZGFyeVxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMS4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0UHVuY3R1YXRpb25Cb3VuZGFyeVwiXSA9IDQ0XSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RQdW5jdHVhdGlvbkJvdW5kYXJ5XCI7XG4gICAgLyoqXG4gICAgICogQSBib29sZWFuIHZhbHVlIHNwZWNpZnlpbmcgd2hldGhlciB0byByZXF1ZXN0IHNlbnRlbmNlIGJvdW5kYXJ5IGluIFdvcmRCb3VuZGFyeSBFdmVudHMuIERlZmF1bHQgaXMgZmFsc2UuXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0U2VudGVuY2VCb3VuZGFyeVxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMS4wLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0U2VudGVuY2VCb3VuZGFyeVwiXSA9IDQ1XSA9IFwiU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RTZW50ZW5jZUJvdW5kYXJ5XCI7XG4gICAgLyoqXG4gICAgICogSWRlbnRpZmllciB1c2VkIHRvIGNvbm5lY3QgdG8gdGhlIGJhY2tlbmQgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDb252ZXJzYXRpb25fQXBwbGljYXRpb25JZFwiXSA9IDQ2XSA9IFwiQ29udmVyc2F0aW9uX0FwcGxpY2F0aW9uSWRcIjtcbiAgICAvKipcbiAgICAgKiBUeXBlIG9mIGRpYWxvZyBiYWNrZW5kIHRvIGNvbm5lY3QgdG8uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0RpYWxvZ1R5cGVcIl0gPSA0N10gPSBcIkNvbnZlcnNhdGlvbl9EaWFsb2dUeXBlXCI7XG4gICAgLyoqXG4gICAgICogU2lsZW5jZSB0aW1lb3V0IGZvciBsaXN0ZW5pbmdcbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0luaXRpYWxfU2lsZW5jZV9UaW1lb3V0XG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0luaXRpYWxfU2lsZW5jZV9UaW1lb3V0XCJdID0gNDhdID0gXCJDb252ZXJzYXRpb25fSW5pdGlhbF9TaWxlbmNlX1RpbWVvdXRcIjtcbiAgICAvKipcbiAgICAgKiBGcm9tIElkIHRvIGFkZCB0byBzcGVlY2ggcmVjb2duaXRpb24gYWN0aXZpdGllcy5cbiAgICAgKiBAbWVtYmVyIFByb3BlcnR5SWQuQ29udmVyc2F0aW9uX0Zyb21fSWRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDb252ZXJzYXRpb25fRnJvbV9JZFwiXSA9IDQ5XSA9IFwiQ29udmVyc2F0aW9uX0Zyb21fSWRcIjtcbiAgICAvKipcbiAgICAgKiBDb252ZXJzYXRpb25JZCBmb3IgdGhlIHNlc3Npb24uXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9Db252ZXJzYXRpb25fSWRcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDb252ZXJzYXRpb25fQ29udmVyc2F0aW9uX0lkXCJdID0gNTBdID0gXCJDb252ZXJzYXRpb25fQ29udmVyc2F0aW9uX0lkXCI7XG4gICAgLyoqXG4gICAgICogQ29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgY3VzdG9tIHZvaWNlIGRlcGxveW1lbnQgaWRzLlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5Db252ZXJzYXRpb25fQ3VzdG9tX1ZvaWNlX0RlcGxveW1lbnRfSWRzXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX0N1c3RvbV9Wb2ljZV9EZXBsb3ltZW50X0lkc1wiXSA9IDUxXSA9IFwiQ29udmVyc2F0aW9uX0N1c3RvbV9Wb2ljZV9EZXBsb3ltZW50X0lkc1wiO1xuICAgIC8qKlxuICAgICAqIFNwZWVjaCBhY3Rpdml0eSB0ZW1wbGF0ZSwgc3RhbXAgcHJvcGVydGllcyBmcm9tIHRoZSB0ZW1wbGF0ZSBvbiB0aGUgYWN0aXZpdHkgZ2VuZXJhdGVkIGJ5IHRoZSBzZXJ2aWNlIGZvciBzcGVlY2guXG4gICAgICogQG1lbWJlciBQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvbl9TcGVlY2hfQWN0aXZpdHlfVGVtcGxhdGVcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTAuMC5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDb252ZXJzYXRpb25fU3BlZWNoX0FjdGl2aXR5X1RlbXBsYXRlXCJdID0gNTJdID0gXCJDb252ZXJzYXRpb25fU3BlZWNoX0FjdGl2aXR5X1RlbXBsYXRlXCI7XG4gICAgLyoqXG4gICAgICogRW5hYmxlcyBvciBkaXNhYmxlcyB0aGUgcmVjZWlwdCBvZiB0dXJuIHN0YXR1cyBtZXNzYWdlcyBhcyBvYnRhaW5lZCBvbiB0aGUgdHVyblN0YXR1c1JlY2VpdmVkIGV2ZW50LlxuICAgICAqIEBtZW1iZXIgUHJvcGVydHlJZC5Db252ZXJzYXRpb25fUmVxdWVzdF9Cb3RfU3RhdHVzX01lc3NhZ2VzXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjAuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uX1JlcXVlc3RfQm90X1N0YXR1c19NZXNzYWdlc1wiXSA9IDUzXSA9IFwiQ29udmVyc2F0aW9uX1JlcXVlc3RfQm90X1N0YXR1c19NZXNzYWdlc1wiO1xuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgY29ubmVjdGlvbiBJRCB0byBiZSBwcm92aWRlZCBpbiB0aGUgQWdlbnQgY29uZmlndXJhdGlvbiBtZXNzYWdlLCBlLmcuIGEgRGlyZWN0IExpbmUgdG9rZW4gZm9yXG4gICAgICogY2hhbm5lbCBhdXRoZW50aWNhdGlvbi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMS5cbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJDb252ZXJzYXRpb25fQWdlbnRfQ29ubmVjdGlvbl9JZFwiXSA9IDU0XSA9IFwiQ29udmVyc2F0aW9uX0FnZW50X0Nvbm5lY3Rpb25fSWRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgQ29nbml0aXZlIFNlcnZpY2VzIFNwZWVjaCBTZXJ2aWNlIGhvc3QgKHVybCkuIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogSW5zdGVhZCwgdXNlIFtbU3BlZWNoQ29uZmlnLmZyb21Ib3N0XV0uXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdFwiXSA9IDU1XSA9IFwiU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSG9zdFwiO1xuICAgIC8qKlxuICAgICAqIFNldCB0aGUgaG9zdCBmb3Igc2VydmljZSBjYWxscyB0byB0aGUgQ29udmVyc2F0aW9uIFRyYW5zbGF0b3IgUkVTVCBtYW5hZ2VtZW50IGFuZCB3ZWJzb2NrZXQgY2FsbHMuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ib3N0XCJdID0gNTZdID0gXCJDb252ZXJzYXRpb25UcmFuc2xhdG9yX0hvc3RcIjtcbiAgICAvKipcbiAgICAgKiBPcHRpb25hbGx5IHNldCB0aGUgdGhlIGhvc3QncyBkaXNwbGF5IG5hbWUuXG4gICAgICogVXNlZCB3aGVuIGpvaW5pbmcgYSBjb252ZXJzYXRpb24uXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lXCJdID0gNTddID0gXCJDb252ZXJzYXRpb25UcmFuc2xhdG9yX05hbWVcIjtcbiAgICAvKipcbiAgICAgKiBPcHRpb25hbGx5IHNldCBhIHZhbHVlIGZvciB0aGUgWC1Db3JyZWxhdGlvbklkIHJlcXVlc3QgaGVhZGVyLlxuICAgICAqIFVzZWQgZm9yIHRyb3VibGVzaG9vdGluZyBlcnJvcnMgaW4gdGhlIHNlcnZlciBsb2dzLiBJdCBzaG91bGQgYmUgYSB2YWxpZCBndWlkLlxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfQ29ycmVsYXRpb25JZFwiXSA9IDU4XSA9IFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Db3JyZWxhdGlvbklkXCI7XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBjb252ZXJzYXRpb24gdG9rZW4gdG8gYmUgc2VudCB0byB0aGUgc3BlZWNoIHNlcnZpY2UuIFRoaXMgZW5hYmxlcyB0aGVcbiAgICAgKiBzZXJ2aWNlIHRvIHNlcnZpY2UgY2FsbCBmcm9tIHRoZSBzcGVlY2ggc2VydmljZSB0byB0aGUgQ29udmVyc2F0aW9uIFRyYW5zbGF0b3Igc2VydmljZSBmb3IgcmVsYXlpbmdcbiAgICAgKiByZWNvZ25pdGlvbnMuIEZvciBpbnRlcm5hbCB1c2UuXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ub2tlblwiXSA9IDU5XSA9IFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ub2tlblwiO1xuICAgIC8qKlxuICAgICAqIFRoZSByZWZlcmVuY2UgdGV4dCBvZiB0aGUgYXVkaW8gZm9yIHByb251bmNpYXRpb24gZXZhbHVhdGlvbi5cbiAgICAgKiBGb3IgdGhpcyBhbmQgdGhlIGZvbGxvd2luZyBwcm9udW5jaWF0aW9uIGFzc2Vzc21lbnQgcGFyYW1ldGVycywgc2VlXG4gICAgICogaHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vYXp1cmUvY29nbml0aXZlLXNlcnZpY2VzL3NwZWVjaC1zZXJ2aWNlL3Jlc3Qtc3BlZWNoLXRvLXRleHQjcHJvbnVuY2lhdGlvbi1hc3Nlc3NtZW50LXBhcmFtZXRlcnMgZm9yIGRldGFpbHMuXG4gICAgICogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIHlvdSBzaG91bGRuJ3QgaGF2ZSB0byB1c2UgdGhpcyBwcm9wZXJ0eSBkaXJlY3RseS5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTUuMFxuICAgICAqL1xuICAgIFByb3BlcnR5SWRbUHJvcGVydHlJZFtcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1JlZmVyZW5jZVRleHRcIl0gPSA2MF0gPSBcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1JlZmVyZW5jZVRleHRcIjtcbiAgICAvKipcbiAgICAgKiBUaGUgcG9pbnQgc3lzdGVtIGZvciBwcm9udW5jaWF0aW9uIHNjb3JlIGNhbGlicmF0aW9uIChGaXZlUG9pbnQgb3IgSHVuZHJlZE1hcmspLlxuICAgICAqIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9HcmFkaW5nU3lzdGVtXCJdID0gNjFdID0gXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9HcmFkaW5nU3lzdGVtXCI7XG4gICAgLyoqXG4gICAgICogVGhlIHByb251bmNpYXRpb24gZXZhbHVhdGlvbiBncmFudWxhcml0eSAoUGhvbmVtZSwgV29yZCwgb3IgRnVsbFRleHQpLlxuICAgICAqIFVuZGVyIG5vcm1hbCBjaXJjdW1zdGFuY2VzLCB5b3Ugc2hvdWxkbid0IGhhdmUgdG8gdXNlIHRoaXMgcHJvcGVydHkgZGlyZWN0bHkuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9HcmFudWxhcml0eVwiXSA9IDYyXSA9IFwiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfR3JhbnVsYXJpdHlcIjtcbiAgICAvKipcbiAgICAgKiBEZWZpbmVzIGlmIGVuYWJsZSBtaXNjdWUgY2FsY3VsYXRpb24uXG4gICAgICogV2l0aCB0aGlzIGVuYWJsZWQsIHRoZSBwcm9ub3VuY2VkIHdvcmRzIHdpbGwgYmUgY29tcGFyZWQgdG8gdGhlIHJlZmVyZW5jZSB0ZXh0LFxuICAgICAqIGFuZCB3aWxsIGJlIG1hcmtlZCB3aXRoIG9taXNzaW9uL2luc2VydGlvbiBiYXNlZCBvbiB0aGUgY29tcGFyaXNvbi4gVGhlIGRlZmF1bHQgc2V0dGluZyBpcyBGYWxzZS5cbiAgICAgKiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfRW5hYmxlTWlzY3VlXCJdID0gNjNdID0gXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9FbmFibGVNaXNjdWVcIjtcbiAgICAvKipcbiAgICAgKiBUaGUganNvbiBzdHJpbmcgb2YgcHJvbnVuY2lhdGlvbiBhc3Nlc3NtZW50IHBhcmFtZXRlcnNcbiAgICAgKiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgeW91IHNob3VsZG4ndCBoYXZlIHRvIHVzZSB0aGlzIHByb3BlcnR5IGRpcmVjdGx5LlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNS4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfSnNvblwiXSA9IDY0XSA9IFwiUHJvbnVuY2lhdGlvbkFzc2Vzc21lbnRfSnNvblwiO1xuICAgIC8qKlxuICAgICAqIFByb251bmNpYXRpb24gYXNzZXNzbWVudCBwYXJhbWV0ZXJzLlxuICAgICAqIFRoaXMgcHJvcGVydHkgaXMgaW50ZW5kZWQgdG8gYmUgcmVhZC1vbmx5LiBUaGUgU0RLIGlzIHVzaW5nIGl0IGludGVybmFsbHkuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE1LjBcbiAgICAgKi9cbiAgICBQcm9wZXJ0eUlkW1Byb3BlcnR5SWRbXCJQcm9udW5jaWF0aW9uQXNzZXNzbWVudF9QYXJhbXNcIl0gPSA2NV0gPSBcIlByb251bmNpYXRpb25Bc3Nlc3NtZW50X1BhcmFtc1wiO1xuICAgIC8qKlxuICAgICAqIFZlcnNpb24gb2YgU3BlYWtlciBSZWNvZ25pdGlvbiBBUEkgdG8gdXNlLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xOC4wXG4gICAgICovXG4gICAgUHJvcGVydHlJZFtQcm9wZXJ0eUlkW1wiU3BlYWtlclJlY29nbml0aW9uX0FwaV9WZXJzaW9uXCJdID0gNjZdID0gXCJTcGVha2VyUmVjb2duaXRpb25fQXBpX1ZlcnNpb25cIjtcbn0pKFByb3BlcnR5SWQgfHwgKFByb3BlcnR5SWQgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qcm9wZXJ0eUlkLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBTZXNzaW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIHBheWxvYWQgZm9yIHNlc3Npb24gZXZlbnRzIGxpa2UgU3BlZWNoIFN0YXJ0L0VuZCBEZXRlY3RlZFxuICogQGNsYXNzXG4gKi9cbmV4cG9ydCBjbGFzcyBSZWNvZ25pdGlvbkV2ZW50QXJncyBleHRlbmRzIFNlc3Npb25FdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25JZCAtIFRoZSBzZXNzaW9uIGlkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdk9mZnNldCA9IG9mZnNldDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVwcmVzZW50cyB0aGUgbWVzc2FnZSBvZmZzZXRcbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uRXZlbnRBcmdzLnByb3RvdHlwZS5vZmZzZXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IG9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk9mZnNldDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVJlY29nbml0aW9uRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgcmVzdWx0IG9mIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAqIEBjbGFzcyBSZWNvZ25pdGlvblJlc3VsdFxuICovXG5leHBvcnQgY2xhc3MgUmVjb2duaXRpb25SZXN1bHQge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlc3VsdElkIC0gVGhlIHJlc3VsdCBpZC5cbiAgICAgKiBAcGFyYW0ge1Jlc3VsdFJlYXNvbn0gcmVhc29uIC0gVGhlIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSByZWNvZ25pemVkIHRleHQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGR1cmF0aW9uIC0gVGhlIGR1cmF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBUaGUgb2Zmc2V0IGludG8gdGhlIHN0cmVhbS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgLSBQcmltYXJ5IExhbmd1YWdlIGRldGVjdGVkLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlIC0gUHJpbWFyeSBMYW5ndWFnZSBjb25maWRlbmNlIChcIlVua25vd24sXCIgXCJMb3csXCIgXCJNZWRpdW0sXCIgXCJIaWdoXCIuLi4pLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGpzb24gLSBBZGRpdGlvbmFsIEpzb24sIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7UHJvcGVydHlDb2xsZWN0aW9ufSBwcm9wZXJ0aWVzIC0gQWRkaXRpb25hbCBwcm9wZXJ0aWVzLCBpZiBwcm92aWRlZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHRJZCwgcmVhc29uLCB0ZXh0LCBkdXJhdGlvbiwgb2Zmc2V0LCBsYW5ndWFnZSwgbGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlLCBlcnJvckRldGFpbHMsIGpzb24sIHByb3BlcnRpZXMpIHtcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0SWQgPSByZXN1bHRJZDtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZUZXh0ID0gdGV4dDtcbiAgICAgICAgdGhpcy5wcml2RHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgdGhpcy5wcml2T2Zmc2V0ID0gb2Zmc2V0O1xuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZSA9IGxhbmd1YWdlO1xuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UgPSBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2U7XG4gICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IGVycm9yRGV0YWlscztcbiAgICAgICAgdGhpcy5wcml2SnNvbiA9IGpzb247XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHJlc3VsdCBpZGVudGlmaWVyLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLnJlc3VsdElkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFNwZWNpZmllcyB0aGUgcmVzdWx0IGlkZW50aWZpZXIuXG4gICAgICovXG4gICAgZ2V0IHJlc3VsdElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0SWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyBzdGF0dXMgb2YgdGhlIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5yZWFzb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Jlc3VsdFJlYXNvbn0gU3BlY2lmaWVzIHN0YXR1cyBvZiB0aGUgcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByZXNlbnRzIHRoZSByZWNvZ25pemVkIHRleHQgaW4gdGhlIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS50ZXh0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFByZXNlbnRzIHRoZSByZWNvZ25pemVkIHRleHQgaW4gdGhlIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgdGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIER1cmF0aW9uIG9mIHJlY29nbml6ZWQgc3BlZWNoIGluIDEwMCBuYW5vIHNlY29uZCBpbmNyZW1lbnRzLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLmR1cmF0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IER1cmF0aW9uIG9mIHJlY29nbml6ZWQgc3BlZWNoIGluIDEwMCBuYW5vIHNlY29uZCBpbmNyZW1lbnRzLlxuICAgICAqL1xuICAgIGdldCBkdXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkR1cmF0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPZmZzZXQgb2YgcmVjb2duaXplZCBzcGVlY2ggaW4gMTAwIG5hbm8gc2Vjb25kIGluY3JlbWVudHMuXG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUub2Zmc2V0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IE9mZnNldCBvZiByZWNvZ25pemVkIHNwZWVjaCBpbiAxMDAgbmFubyBzZWNvbmQgaW5jcmVtZW50cy5cbiAgICAgKi9cbiAgICBnZXQgb2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2T2Zmc2V0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmltYXJ5IExhbmd1YWdlIGRldGVjdGVkLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLmxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGxhbmd1YWdlIGRldGVjdGVkLlxuICAgICAqL1xuICAgIGdldCBsYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkxhbmd1YWdlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmltYXJ5IExhbmd1YWdlIGRldGVjdGlvbiBjb25maWRlbmNlIChVbmtub3duLCBMb3csIE1lZGl1bSwgSGlnaCkuXG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUubGFuZ3VhZ2VEZXRlY3Rpb25Db25maWRlbmNlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGRldGVjdGlvbiBjb25maWRlbmNlIHN0cmVuZ3RoLlxuICAgICAqL1xuICAgIGdldCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluIGNhc2Ugb2YgYW4gdW5zdWNjZXNzZnVsIHJlY29nbml0aW9uLCBwcm92aWRlcyBkZXRhaWxzIG9mIHRoZSBvY2N1cnJlZCBlcnJvci5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml0aW9uUmVzdWx0LnByb3RvdHlwZS5lcnJvckRldGFpbHNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gYSBicmllZiBkZXNjcmlwdGlvbiBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyBjb250YWluaW5nIEpzb24gc2VyaWFsaXplZCByZWNvZ25pdGlvbiByZXN1bHQgYXMgaXQgd2FzIHJlY2VpdmVkIGZyb20gdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUuanNvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybnMge3N0cmluZ30gSnNvbiBzZXJpYWxpemVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IGpzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZKc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIHByb3BlcnRpZXMgZXhwb3NlZCBpbiB0aGUgcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIHNldCBvZiBwcm9wZXJ0aWVzIGV4cG9zZWQgaW4gdGhlIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWNvZ25pdGlvblJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBDb2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvbiwgQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbiwgQ29udGV4dCwgT1MsIFNlcnZpY2VSZWNvZ25pemVyQmFzZSwgU3BlZWNoU2VydmljZUNvbmZpZywgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBEZWZlcnJlZCwgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBBdWRpb0NvbmZpZywgUHJvcGVydHlJZCwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgdGhlIGJhc2UgY2xhc3MgUmVjb2duaXplciB3aGljaCBtYWlubHkgY29udGFpbnMgY29tbW9uIGV2ZW50IGhhbmRsZXJzLlxuICogQGNsYXNzIFJlY29nbml6ZXJcbiAqL1xuZXhwb3J0IGNsYXNzIFJlY29nbml6ZXIge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIGEgUmVjb2duaXplclxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvSW5wdXQgLSBBbiBvcHRpb25hbCBhdWRpbyBpbnB1dCBzdHJlYW0gYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXVkaW9Db25maWcsIHByb3BlcnRpZXMsIGNvbm5lY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgIHRoaXMuYXVkaW9Db25maWcgPSAoYXVkaW9Db25maWcgIT09IHVuZGVmaW5lZCkgPyBhdWRpb0NvbmZpZyA6IEF1ZGlvQ29uZmlnLmZyb21EZWZhdWx0TWljcm9waG9uZUlucHV0KCk7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzLmNsb25lKCk7XG4gICAgICAgIHRoaXMucHJpdkNvbm5lY3Rpb25GYWN0b3J5ID0gY29ubmVjdGlvbkZhY3Rvcnk7XG4gICAgICAgIHRoaXMuaW1wbENvbW1vblJlY29nbml6ZXJTZXR1cCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlIG9mIGFzc29jaWF0ZWQgcmVzb3VyY2VzLlxuICAgICAqIEBtZW1iZXIgUmVjb2duaXplci5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoY2IsIGVycm9yQ2IpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZCk7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5kaXNwb3NlKHRydWUpLCBjYiwgZXJyb3JDYik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBJbnRlcm5hbFxuICAgICAqIEludGVybmFsIGRhdGEgbWVtYmVyIHRvIHN1cHBvcnQgZnJvbVJlY29nbml6ZXIqIHBhdHRlcm4gbWV0aG9kcyBvbiBvdGhlciBjbGFzc2VzLlxuICAgICAqIERvIG5vdCB1c2UgZXh0ZXJuYWxseSwgb2JqZWN0IHJldHVybmVkIHdpbGwgY2hhbmdlIHdpdGhvdXQgd2FybmluZyBvciBub3RpY2UuXG4gICAgICovXG4gICAgZ2V0IGludGVybmFsRGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY287XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHBlcmZvcm1zIGNsZWFudXAgb2YgcmVzb3VyY2VzLlxuICAgICAqIFRoZSBCb29sZWFuIHBhcmFtZXRlciBkaXNwb3NpbmcgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIG1ldGhvZCBpcyBjYWxsZWRcbiAgICAgKiBmcm9tIERpc3Bvc2UgKGlmIGRpc3Bvc2luZyBpcyB0cnVlKSBvciBmcm9tIHRoZSBmaW5hbGl6ZXIgKGlmIGRpc3Bvc2luZyBpcyBmYWxzZSkuXG4gICAgICogRGVyaXZlZCBjbGFzc2VzIHNob3VsZCBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBkaXNwb3NlIHJlc291cmNlIGlmIG5lZWRlZC5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml6ZXIucHJvdG90eXBlLmRpc3Bvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtib29sZWFufSBkaXNwb3NpbmcgLSBGbGFnIHRvIHJlcXVlc3QgZGlzcG9zYWwuXG4gICAgICovXG4gICAgZGlzcG9zZShkaXNwb3NpbmcpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UmVjbykge1xuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNvLmF1ZGlvU291cmNlLnR1cm5PZmYoKTtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjby5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgcmV0dXJucyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgdGVsZW1ldHJ5IHNldHRpbmcuXG4gICAgICogQG1lbWJlciBSZWNvZ25pemVyLnByb3RvdHlwZS50ZWxlbWV0cnlFbmFibGVkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHRlbGVtZXRyeSBpcyBlbmFibGVkLCBmYWxzZSBvdGhlcndpc2UuXG4gICAgICovXG4gICAgc3RhdGljIGdldCB0ZWxlbWV0cnlFbmFibGVkKCkge1xuICAgICAgICByZXR1cm4gU2VydmljZVJlY29nbml6ZXJCYXNlLnRlbGVtZXRyeURhdGFFbmFibGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBnbG9iYWxseSBlbmFibGVzIG9yIGRpc2FibGVzIHRlbGVtZXRyeS5cbiAgICAgKiBAbWVtYmVyIFJlY29nbml6ZXIucHJvdG90eXBlLmVuYWJsZVRlbGVtZXRyeVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gZW5hYmxlZCAtIEdsb2JhbCBzZXR0aW5nIGZvciB0ZWxlbWV0cnkgY29sbGVjdGlvbi5cbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGVsZW1ldHJ5IGluZm9ybWF0aW9uIGxpa2UgbWljcm9waG9uZSBlcnJvcnMsXG4gICAgICogcmVjb2duaXRpb24gZXJyb3JzIGFyZSBjb2xsZWN0ZWQgYW5kIHNlbnQgdG8gTWljcm9zb2Z0LlxuICAgICAqIElmIHNldCB0byBmYWxzZSwgbm8gdGVsZW1ldHJ5IGlzIHNlbnQgdG8gTWljcm9zb2Z0LlxuICAgICAqL1xuICAgIHN0YXRpYyBlbmFibGVUZWxlbWV0cnkoZW5hYmxlZCkge1xuICAgICAgICBTZXJ2aWNlUmVjb2duaXplckJhc2UudGVsZW1ldHJ5RGF0YUVuYWJsZWQgPSBlbmFibGVkO1xuICAgIH1cbiAgICAvLyBEb2VzIHRoZSBnZW5lcmljIHJlY29nbml6ZXIgc2V0dXAgdGhhdCBpcyBjb21tb24gYWNyb3NzIGFsbCByZWNvZ25pemVyIHR5cGVzLlxuICAgIGltcGxDb21tb25SZWNvZ25pemVyU2V0dXAoKSB7XG4gICAgICAgIGxldCBvc1BsYXRmb3JtID0gKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpID8gXCJCcm93c2VyXCIgOiBcIk5vZGVcIjtcbiAgICAgICAgbGV0IG9zTmFtZSA9IFwidW5rbm93blwiO1xuICAgICAgICBsZXQgb3NWZXJzaW9uID0gXCJ1bmtub3duXCI7XG4gICAgICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBvc1BsYXRmb3JtID0gb3NQbGF0Zm9ybSArIFwiL1wiICsgbmF2aWdhdG9yLnBsYXRmb3JtO1xuICAgICAgICAgICAgb3NOYW1lID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgICAgIG9zVmVyc2lvbiA9IG5hdmlnYXRvci5hcHBWZXJzaW9uO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlY29nbml6ZXJDb25maWcgPSB0aGlzLmNyZWF0ZVJlY29nbml6ZXJDb25maWcobmV3IFNwZWVjaFNlcnZpY2VDb25maWcobmV3IENvbnRleHQobmV3IE9TKG9zUGxhdGZvcm0sIG9zTmFtZSwgb3NWZXJzaW9uKSkpKTtcbiAgICAgICAgdGhpcy5wcml2UmVjbyA9IHRoaXMuY3JlYXRlU2VydmljZVJlY29nbml6ZXIoUmVjb2duaXplci5nZXRBdXRoRnJvbVByb3BlcnRpZXModGhpcy5wcml2UHJvcGVydGllcyksIHRoaXMucHJpdkNvbm5lY3Rpb25GYWN0b3J5LCB0aGlzLmF1ZGlvQ29uZmlnLCByZWNvZ25pemVyQ29uZmlnKTtcbiAgICB9XG4gICAgcmVjb2duaXplT25jZUFzeW5jSW1wbChyZWNvZ25pdGlvbk1vZGUpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWQpO1xuICAgICAgICAgICAgY29uc3QgcmV0ID0gbmV3IERlZmVycmVkKCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjby5yZWNvZ25pemUocmVjb2duaXRpb25Nb2RlLCByZXQucmVzb2x2ZSwgcmV0LnJlamVjdCk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB5aWVsZCByZXQucHJvbWlzZTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luY0ltcGwocmVjb2duaXRpb25Nb2RlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNvLnJlY29nbml6ZShyZWNvZ25pdGlvbk1vZGUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luY0ltcGwoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpbXBsUmVjb2duaXplclN0b3AoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2UmVjbykge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlJlY28uc3RvcFJlY29nbml6aW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0QXV0aEZyb21Qcm9wZXJ0aWVzKHByb3BlcnRpZXMpIHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uS2V5ID0gcHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgYXV0aGVudGljYXRpb24gPSAoc3Vic2NyaXB0aW9uS2V5ICYmIHN1YnNjcmlwdGlvbktleSAhPT0gXCJcIikgP1xuICAgICAgICAgICAgbmV3IENvZ25pdGl2ZVN1YnNjcmlwdGlvbktleUF1dGhlbnRpY2F0aW9uKHN1YnNjcmlwdGlvbktleSkgOlxuICAgICAgICAgICAgbmV3IENvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml6YXRpb25Ub2tlbiA9IHByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXV0aG9yaXphdGlvblRva2VuID0gcHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYXV0aG9yaXphdGlvblRva2VuKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYXV0aGVudGljYXRpb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1SZWNvZ25pemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgdGhlIHBvc3NpYmxlIHJlYXNvbnMgYSByZWNvZ25pdGlvbiByZXN1bHQgbWlnaHQgYmUgZ2VuZXJhdGVkLlxuICogQGNsYXNzIFJlc3VsdFJlYXNvblxuICovXG5leHBvcnQgdmFyIFJlc3VsdFJlYXNvbjtcbihmdW5jdGlvbiAoUmVzdWx0UmVhc29uKSB7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHNwZWVjaCBjb3VsZCBub3QgYmUgcmVjb2duaXplZC4gTW9yZSBkZXRhaWxzXG4gICAgICogY2FuIGJlIGZvdW5kIGluIHRoZSBOb01hdGNoRGV0YWlscyBvYmplY3QuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uTm9NYXRjaFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJOb01hdGNoXCJdID0gMF0gPSBcIk5vTWF0Y2hcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhhdCB0aGUgcmVjb2duaXRpb24gd2FzIGNhbmNlbGVkLiBNb3JlIGRldGFpbHNcbiAgICAgKiBjYW4gYmUgZm91bmQgdXNpbmcgdGhlIENhbmNlbGxhdGlvbkRldGFpbHMgb2JqZWN0LlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLkNhbmNlbGVkXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIkNhbmNlbGVkXCJdID0gMV0gPSBcIkNhbmNlbGVkXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBzcGVlY2ggcmVzdWx0IGNvbnRhaW5zIGh5cG90aGVzaXMgdGV4dC5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkU3BlZWNoXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlJlY29nbml6aW5nU3BlZWNoXCJdID0gMl0gPSBcIlJlY29nbml6aW5nU3BlZWNoXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBzcGVlY2ggcmVzdWx0IGNvbnRhaW5zIGZpbmFsIHRleHQgdGhhdCBoYXMgYmVlbiByZWNvZ25pemVkLlxuICAgICAqIFNwZWVjaCBSZWNvZ25pdGlvbiBpcyBub3cgY29tcGxldGUgZm9yIHRoaXMgcGhyYXNlLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlJlY29nbml6ZWRTcGVlY2hcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiUmVjb2duaXplZFNwZWVjaFwiXSA9IDNdID0gXCJSZWNvZ25pemVkU3BlZWNoXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBzcGVlY2ggcmVzdWx0IGNvbnRhaW5zIGEgZmluYWxpemVkIGFjY2VwdGFuY2Ugb2YgYSBwcm92aWRlZCBrZXl3b3JkLlxuICAgICAqIFNwZWVjaCByZWNvZ25pdGlvbiB3aWxsIGNvbnRpbnVlIHVubGVzcyBvdGhlcndpc2UgY29uZmlndXJlZC5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkS2V5d29yZFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZWNvZ25pemVkS2V5d29yZFwiXSA9IDRdID0gXCJSZWNvZ25pemVkS2V5d29yZFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgaW50ZW50IHJlc3VsdCBjb250YWlucyBoeXBvdGhlc2lzIHRleHQgYW5kIGludGVudC5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZWNvZ25pemluZ0ludGVudFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZWNvZ25pemluZ0ludGVudFwiXSA9IDVdID0gXCJSZWNvZ25pemluZ0ludGVudFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgaW50ZW50IHJlc3VsdCBjb250YWlucyBmaW5hbCB0ZXh0IGFuZCBpbnRlbnQuXG4gICAgICogU3BlZWNoIFJlY29nbml0aW9uIGFuZCBJbnRlbnQgZGV0ZXJtaW5hdGlvbiBhcmUgbm93IGNvbXBsZXRlIGZvciB0aGlzIHBocmFzZS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkSW50ZW50XG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlJlY29nbml6ZWRJbnRlbnRcIl0gPSA2XSA9IFwiUmVjb2duaXplZEludGVudFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgdHJhbnNsYXRpb24gcmVzdWx0IGNvbnRhaW5zIGh5cG90aGVzaXMgdGV4dCBhbmQgaXRzIHRyYW5zbGF0aW9uKHMpLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlRyYW5zbGF0aW5nU3BlZWNoXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlRyYW5zbGF0aW5nU3BlZWNoXCJdID0gN10gPSBcIlRyYW5zbGF0aW5nU3BlZWNoXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSB0cmFuc2xhdGlvbiByZXN1bHQgY29udGFpbnMgZmluYWwgdGV4dCBhbmQgY29ycmVzcG9uZGluZyB0cmFuc2xhdGlvbihzKS5cbiAgICAgKiBTcGVlY2ggUmVjb2duaXRpb24gYW5kIFRyYW5zbGF0aW9uIGFyZSBub3cgY29tcGxldGUgZm9yIHRoaXMgcGhyYXNlLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlRyYW5zbGF0ZWRTcGVlY2hcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiVHJhbnNsYXRlZFNwZWVjaFwiXSA9IDhdID0gXCJUcmFuc2xhdGVkU3BlZWNoXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBzeW50aGVzaXplZCBhdWRpbyByZXN1bHQgY29udGFpbnMgYSBub24temVybyBhbW91bnQgb2YgYXVkaW8gZGF0YVxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlN5bnRoZXNpemluZ0F1ZGlvXCJdID0gOV0gPSBcIlN5bnRoZXNpemluZ0F1ZGlvXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSBzeW50aGVzaXplZCBhdWRpbyBpcyBub3cgY29tcGxldGUgZm9yIHRoaXMgcGhyYXNlLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvQ29tcGxldGVkXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlN5bnRoZXNpemluZ0F1ZGlvQ29tcGxldGVkXCJdID0gMTBdID0gXCJTeW50aGVzaXppbmdBdWRpb0NvbXBsZXRlZFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgc3BlZWNoIHN5bnRoZXNpcyBpcyBub3cgc3RhcnRlZFxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvU3RhcnRlZFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJTeW50aGVzaXppbmdBdWRpb1N0YXJ0ZWRcIl0gPSAxMV0gPSBcIlN5bnRoZXNpemluZ0F1ZGlvU3RhcnRlZFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgdm9pY2UgcHJvZmlsZSBpcyBiZWluZyBlbnJvbGxlZCBhbmQgY3VzdG9tZXJzIG5lZWQgdG8gc2VuZCBtb3JlIGF1ZGlvIHRvIGNyZWF0ZSBhIHZvaWNlIHByb2ZpbGUuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uRW5yb2xsaW5nVm9pY2VQcm9maWxlXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIkVucm9sbGluZ1ZvaWNlUHJvZmlsZVwiXSA9IDEyXSA9IFwiRW5yb2xsaW5nVm9pY2VQcm9maWxlXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHRoZSB2b2ljZSBwcm9maWxlIGhhcyBiZWVuIGVucm9sbGVkLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLkVucm9sbGVkVm9pY2VQcm9maWxlXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIkVucm9sbGVkVm9pY2VQcm9maWxlXCJdID0gMTNdID0gXCJFbnJvbGxlZFZvaWNlUHJvZmlsZVwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBzdWNjZXNzZnVsIGlkZW50aWZpY2F0aW9uIG9mIHNvbWUgc3BlYWtlcnMuXG4gICAgICogQG1lbWJlciBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWFrZXJzXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlJlY29nbml6ZWRTcGVha2Vyc1wiXSA9IDE0XSA9IFwiUmVjb2duaXplZFNwZWFrZXJzXCI7XG4gICAgLyoqXG4gICAgICogSW5kaWNhdGVzIHN1Y2Nlc3NmdWxseSB2ZXJpZmllZCBvbmUgc3BlYWtlci5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZWNvZ25pemVkU3BlYWtlclxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZWNvZ25pemVkU3BlYWtlclwiXSA9IDE1XSA9IFwiUmVjb2duaXplZFNwZWFrZXJcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgYSB2b2ljZSBwcm9maWxlIGhhcyBiZWVuIHJlc2V0IHN1Y2Nlc3NmdWxseS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5SZXNldFZvaWNlUHJvZmlsZVxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJSZXNldFZvaWNlUHJvZmlsZVwiXSA9IDE2XSA9IFwiUmVzZXRWb2ljZVByb2ZpbGVcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgYSB2b2ljZSBwcm9maWxlIGhhcyBiZWVuIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLkRlbGV0ZWRWb2ljZVByb2ZpbGVcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiRGVsZXRlZFZvaWNlUHJvZmlsZVwiXSA9IDE3XSA9IFwiRGVsZXRlZFZvaWNlUHJvZmlsZVwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyBzeW50aGVzaXMgdm9pY2VzIGxpc3QgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZC5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5Wb2ljZXNMaXN0UmV0cmlldmVkXG4gICAgICovXG4gICAgUmVzdWx0UmVhc29uW1Jlc3VsdFJlYXNvbltcIlZvaWNlc0xpc3RSZXRyaWV2ZWRcIl0gPSAxOF0gPSBcIlZvaWNlc0xpc3RSZXRyaWV2ZWRcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHRyYW5zY3JpcHRpb24gcmVzdWx0IGNvbnRhaW5zIGh5cG90aGVzaXMgdGV4dCBhbmQgaXRzIHRyYW5zbGF0aW9uKHMpIGZvclxuICAgICAqIG90aGVyIHBhcnRpY2lwYW50cyBpbiB0aGUgY29udmVyc2F0aW9uLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlRyYW5zbGF0aW5nUGFydGljaXBhbnRTcGVlY2hcbiAgICAgKi9cbiAgICBSZXN1bHRSZWFzb25bUmVzdWx0UmVhc29uW1wiVHJhbnNsYXRpbmdQYXJ0aWNpcGFudFNwZWVjaFwiXSA9IDE5XSA9IFwiVHJhbnNsYXRpbmdQYXJ0aWNpcGFudFNwZWVjaFwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgdHJhbnNjcmlwdGlvbiByZXN1bHQgY29udGFpbnMgZmluYWwgdGV4dCBhbmQgY29ycmVzcG9uZGluZyB0cmFuc2xhdGlvbihzKVxuICAgICAqIGZvciBvdGhlciBwYXJ0aWNpcGFudHMgaW4gdGhlIGNvbnZlcnNhdGlvbi4gU3BlZWNoIFJlY29nbml0aW9uIGFuZCBUcmFuc2xhdGlvbiBhcmUgbm93XG4gICAgICogY29tcGxldGUgZm9yIHRoaXMgcGhyYXNlLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlRyYW5zbGF0ZWRQYXJ0aWNpcGFudFNwZWVjaFxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJUcmFuc2xhdGVkUGFydGljaXBhbnRTcGVlY2hcIl0gPSAyMF0gPSBcIlRyYW5zbGF0ZWRQYXJ0aWNpcGFudFNwZWVjaFwiO1xuICAgIC8qKlxuICAgICAqIDxzdW1tYXJ5PlxuICAgICAqIEluZGljYXRlcyB0aGUgdHJhbnNjcmlwdGlvbiByZXN1bHQgY29udGFpbnMgdGhlIGluc3RhbnQgbWVzc2FnZSBhbmQgY29ycmVzcG9uZGluZ1xuICAgICAqIHRyYW5zbGF0aW9uKHMpLlxuICAgICAqIEBtZW1iZXIgUmVzdWx0UmVhc29uLlRyYW5zbGF0ZWRJbnN0YW50TWVzc2FnZVxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJUcmFuc2xhdGVkSW5zdGFudE1lc3NhZ2VcIl0gPSAyMV0gPSBcIlRyYW5zbGF0ZWRJbnN0YW50TWVzc2FnZVwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgdHJhbnNjcmlwdGlvbiByZXN1bHQgY29udGFpbnMgdGhlIGluc3RhbnQgbWVzc2FnZSBmb3Igb3RoZXIgcGFydGljaXBhbnRzXG4gICAgICogaW4gdGhlIGNvbnZlcnNhdGlvbiBhbmQgY29ycmVzcG9uZGluZyB0cmFuc2xhdGlvbihzKS5cbiAgICAgKiBAbWVtYmVyIFJlc3VsdFJlYXNvbi5UcmFuc2xhdGVkUGFydGljaXBhbnRJbnN0YW50TWVzc2FnZVxuICAgICAqL1xuICAgIFJlc3VsdFJlYXNvbltSZXN1bHRSZWFzb25bXCJUcmFuc2xhdGVkUGFydGljaXBhbnRJbnN0YW50TWVzc2FnZVwiXSA9IDIyXSA9IFwiVHJhbnNsYXRlZFBhcnRpY2lwYW50SW5zdGFudE1lc3NhZ2VcIjtcbn0pKFJlc3VsdFJlYXNvbiB8fCAoUmVzdWx0UmVhc29uID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVzdWx0UmVhc29uLmpzLm1hcFxuIiwiLy9cbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0LiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLiBTZWUgTElDRU5TRS5tZCBmaWxlIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGZ1bGwgbGljZW5zZSBpbmZvcm1hdGlvbi5cbi8vXG5pbXBvcnQgeyBTZXNzaW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIHBheWxvYWQgZm9yIGFueSBTZXJ2aWNlIG1lc3NhZ2UgZXZlbnRcbiAqIEFkZGVkIGluIHZlcnNpb24gMS45LjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNlcnZpY2VFdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBqc29uIC0ganNvbiBwYXlsb2FkIG9mIHRoZSBVU1AgbWVzc2FnZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihqc29uLCBuYW1lLCBzZXNzaW9uSWQpIHtcbiAgICAgICAgc3VwZXIoc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2SnNvblJlc3VsdCA9IGpzb247XG4gICAgICAgIHRoaXMucHJpdkV2ZW50TmFtZSA9IG5hbWU7XG4gICAgfVxuICAgIGdldCBqc29uU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SnNvblJlc3VsdDtcbiAgICB9XG4gICAgZ2V0IGV2ZW50TmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkV2ZW50TmFtZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNlcnZpY2VFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBjaGFubmVscyB1c2VkIHRvIHBhc3MgcHJvcGVydHkgc2V0dGluZ3MgdG8gc2VydmljZS5cbiAqIEFkZGVkIGluIHZlcnNpb24gMS43LjAuXG4gKi9cbmV4cG9ydCB2YXIgU2VydmljZVByb3BlcnR5Q2hhbm5lbDtcbihmdW5jdGlvbiAoU2VydmljZVByb3BlcnR5Q2hhbm5lbCkge1xuICAgIC8qKlxuICAgICAqIFVzZXMgVVJJIHF1ZXJ5IHBhcmFtZXRlciB0byBwYXNzIHByb3BlcnR5IHNldHRpbmdzIHRvIHNlcnZpY2UuXG4gICAgICovXG4gICAgU2VydmljZVByb3BlcnR5Q2hhbm5lbFtTZXJ2aWNlUHJvcGVydHlDaGFubmVsW1wiVXJpUXVlcnlQYXJhbWV0ZXJcIl0gPSAwXSA9IFwiVXJpUXVlcnlQYXJhbWV0ZXJcIjtcbn0pKFNlcnZpY2VQcm9wZXJ0eUNoYW5uZWwgfHwgKFNlcnZpY2VQcm9wZXJ0eUNoYW5uZWwgPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TZXJ2aWNlUHJvcGVydHlDaGFubmVsLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgY29udGVudCBmb3Igc2Vzc2lvbiBldmVudHMgbGlrZSBTZXNzaW9uU3RhcnRlZC9TdG9wcGVkLCBTb3VuZFN0YXJ0ZWQvU3RvcHBlZC5cbiAqIEBjbGFzcyBTZXNzaW9uRXZlbnRBcmdzXG4gKi9cbmV4cG9ydCBjbGFzcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uSWQpIHtcbiAgICAgICAgdGhpcy5wcml2U2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXByZXNlbnRzIHRoZSBzZXNzaW9uIGlkZW50aWZpZXIuXG4gICAgICogQG1lbWJlciBTZXNzaW9uRXZlbnRBcmdzLnByb3RvdHlwZS5zZXNzaW9uSWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmVwcmVzZW50cyB0aGUgc2Vzc2lvbiBpZGVudGlmaWVyLlxuICAgICAqL1xuICAgIGdldCBzZXNzaW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTZXNzaW9uSWQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TZXNzaW9uRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbi8qKlxuICogU291cmNlIExhbmd1YWdlIGNvbmZpZ3VyYXRpb24uXG4gKiBAY2xhc3MgU291cmNlTGFuZ3VhZ2VDb25maWdcbiAqL1xuZXhwb3J0IGNsYXNzIFNvdXJjZUxhbmd1YWdlQ29uZmlnIHtcbiAgICBjb25zdHJ1Y3RvcihsYW5ndWFnZSwgZW5kcG9pbnRJZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChsYW5ndWFnZSwgXCJsYW5ndWFnZVwiKTtcbiAgICAgICAgdGhpcy5wcml2TGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICAgICAgdGhpcy5wcml2RW5kcG9pbnRJZCA9IGVuZHBvaW50SWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIgU291cmNlTGFuZ3VhZ2VDb25maWcuZnJvbUxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZSBsYW5ndWFnZSAoZWcuIFwiZW4tVVNcIikgdmFsdWUgb2YgY29uZmlnLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nP30gZW5kcG9pbnRJZCBlbmRwb2ludElkIG9mIG1vZGVsIGJvdW5kIHRvIGdpdmVuIGxhbmd1YWdlIG9mIGNvbmZpZy5cbiAgICAgKiBAcmV0dXJuIHtTb3VyY2VMYW5ndWFnZUNvbmZpZ30gSW5zdGFuY2Ugb2YgU291cmNlTGFuZ3VhZ2VDb25maWdcbiAgICAgKiBAc3VtbWFyeSBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBTb3VyY2VMYW5ndWFnZUNvbmZpZyB3aXRoIHRoZSBnaXZlbiBsYW5ndWFnZSBhbmQgb3B0aW9uYWwgZW5kcG9pbnRJZC5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTMuMC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUxhbmd1YWdlKGxhbmd1YWdlLCBlbmRwb2ludElkKSB7XG4gICAgICAgIHJldHVybiBuZXcgU291cmNlTGFuZ3VhZ2VDb25maWcobGFuZ3VhZ2UsIGVuZHBvaW50SWQpO1xuICAgIH1cbiAgICBnZXQgbGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMYW5ndWFnZTtcbiAgICB9XG4gICAgZ2V0IGVuZHBvaW50SWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFbmRwb2ludElkO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U291cmNlTGFuZ3VhZ2VDb25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgVm9pY2VQcm9maWxlVHlwZSwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgU3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwgY2xhc3MgZm9yIFNwZWFrZXIgUmVjb2duaXRpb25cbiAqIE1vZGVsIGNvbnRhaW5zIGEgc2V0IG9mIHByb2ZpbGVzIGFnYWluc3Qgd2hpY2ggdG8gaWRlbnRpZnkgc3BlYWtlcihzKVxuICogQGNsYXNzIFNwZWFrZXJJZGVudGlmaWNhdGlvbk1vZGVsXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVha2VySWRlbnRpZmljYXRpb25Nb2RlbCB7XG4gICAgY29uc3RydWN0b3IocHJvZmlsZXMpIHtcbiAgICAgICAgdGhpcy5wcml2Vm9pY2VQcm9maWxlcyA9IFtdO1xuICAgICAgICB0aGlzLnByaXZQcm9maWxlSWRzID0gW107XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHByb2ZpbGVzLCBcIlZvaWNlUHJvZmlsZXNcIik7XG4gICAgICAgIGlmIChwcm9maWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVtcHR5IFZvaWNlIFByb2ZpbGVzIGFycmF5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgcHJvZmlsZSBvZiBwcm9maWxlcykge1xuICAgICAgICAgICAgaWYgKHByb2ZpbGUucHJvZmlsZVR5cGUgIT09IFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb24pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJZGVudGlmaWNhdGlvbiBtb2RlbCBjYW4gb25seSBiZSBjcmVhdGVkIGZyb20gSWRlbnRpZmljYXRpb24gcHJvZmlsZTogXCIgKyBwcm9maWxlLnByb2ZpbGVJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByaXZWb2ljZVByb2ZpbGVzLnB1c2gocHJvZmlsZSk7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9maWxlSWRzLnB1c2gocHJvZmlsZS5wcm9maWxlSWQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUHJvZmlsZXMocHJvZmlsZXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTcGVha2VySWRlbnRpZmljYXRpb25Nb2RlbChwcm9maWxlcyk7XG4gICAgfVxuICAgIGdldCB2b2ljZVByb2ZpbGVJZHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9maWxlSWRzLmpvaW4oXCIsXCIpO1xuICAgIH1cbiAgICBnZXQgcHJvZmlsZUlkcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb2ZpbGVJZHM7XG4gICAgfVxuICAgIGdldCBzY2VuYXJpbygpIHtcbiAgICAgICAgcmV0dXJuIFwiVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb25cIjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWFrZXJJZGVudGlmaWNhdGlvbk1vZGVsLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UsIENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFJlc3VsdFJlYXNvbiwgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG5leHBvcnQgdmFyIFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGU7XG4oZnVuY3Rpb24gKFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUpIHtcbiAgICBTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlW1NwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGVbXCJWZXJpZnlcIl0gPSAwXSA9IFwiVmVyaWZ5XCI7XG4gICAgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0VHlwZVtTcGVha2VyUmVjb2duaXRpb25SZXN1bHRUeXBlW1wiSWRlbnRpZnlcIl0gPSAxXSA9IFwiSWRlbnRpZnlcIjtcbn0pKFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUgfHwgKFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUgPSB7fSkpO1xuLyoqXG4gKiBPdXRwdXQgZm9ybWF0XG4gKiBAY2xhc3MgU3BlYWtlclJlY29nbml0aW9uUmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVha2VyUmVjb2duaXRpb25SZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlLCByZXN1bHRSZWFzb24gPSBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWFrZXIsIGNhbmNlbGxhdGlvbkVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yLCBlcnJvckRldGFpbHMgPSBcIlwiKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdFR5cGUgPSByZXNwb25zZS5zY2VuYXJpbyA9PT0gXCJUZXh0SW5kZXBlbmRlbnRJZGVudGlmaWNhdGlvblwiID8gU3BlYWtlclJlY29nbml0aW9uUmVzdWx0VHlwZS5JZGVudGlmeSA6IFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUuVmVyaWZ5O1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZXN1bHRSZWFzb247XG4gICAgICAgIGlmICh0aGlzLnByaXZSZWFzb24gIT09IFJlc3VsdFJlYXNvbi5DYW5jZWxlZCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdFR5cGUgPT09IFNwZWFrZXJSZWNvZ25pdGlvblJlc3VsdFR5cGUuSWRlbnRpZnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZQcm9maWxlSWQgPSByZXNwb25zZS5pZGVudGlmaWNhdGlvblJlc3VsdC5pZGVudGlmaWVkUHJvZmlsZS5wcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U2NvcmUgPSByZXNwb25zZS5pZGVudGlmaWNhdGlvblJlc3VsdC5pZGVudGlmaWVkUHJvZmlsZS5zY29yZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWFzb24gPSBSZXN1bHRSZWFzb24uUmVjb2duaXplZFNwZWFrZXJzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U2NvcmUgPSByZXNwb25zZS52ZXJpZmljYXRpb25SZXN1bHQuc2NvcmU7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnZlcmlmaWNhdGlvblJlc3VsdC5yZWNvZ25pdGlvblJlc3VsdC50b0xvd2VyQ2FzZSgpICE9PSBcImFjY2VwdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJlYXNvbiA9IFJlc3VsdFJlYXNvbi5Ob01hdGNoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UudmVyaWZpY2F0aW9uUmVzdWx0LnByb2ZpbGVJZCAhPT0gdW5kZWZpbmVkICYmIHJlc3BvbnNlLnZlcmlmaWNhdGlvblJlc3VsdC5wcm9maWxlSWQgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UHJvZmlsZUlkID0gcmVzcG9uc2UudmVyaWZpY2F0aW9uUmVzdWx0LnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByaXZFcnJvckRldGFpbHMgPSBlcnJvckRldGFpbHM7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW2NhbmNlbGxhdGlvbkVycm9yQ29kZV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfSnNvblJlc3VsdCwgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UpKTtcbiAgICB9XG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICBnZXQgcHJvZmlsZUlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvZmlsZUlkO1xuICAgIH1cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbiAgICBnZXQgc2NvcmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTY29yZTtcbiAgICB9XG59XG4vKipcbiAqIEBjbGFzcyBTcGVha2VyUmVjb2duaXRpb25DYW5jZWxsYXRpb25EZXRhaWxzXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVha2VyUmVjb2duaXRpb25DYW5jZWxsYXRpb25EZXRhaWxzIGV4dGVuZHMgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2Uge1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpIHtcbiAgICAgICAgc3VwZXIocmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgU3BlYWtlclJlY29nbml0aW9uQ2FuY2VsbGF0aW9uRGV0YWlscyBvYmplY3QgZm9yIHRoZSBjYW5jZWxlZCBTcGVha2VyUmVjb2duaXRpb25SZXN1bHRcbiAgICAgKiBAbWVtYmVyIFNwZWFrZXJSZWNvZ25pdGlvbkNhbmNlbGxhdGlvbkRldGFpbHMuZnJvbVJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1NwZWFrZXJSZWNvZ25pdGlvblJlc3VsdH0gcmVzdWx0IC0gVGhlIHJlc3VsdCB0aGF0IHdhcyBjYW5jZWxlZC5cbiAgICAgKiBAcmV0dXJucyB7U3BlYWtlclJlY29nbml0aW9uQ2FuY2VsbGF0aW9uRGV0YWlsc30gVGhlIGNhbmNlbGxhdGlvbiBkZXRhaWxzIG9iamVjdCBiZWluZyBjcmVhdGVkLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICBjb25zdCByZWFzb24gPSBDYW5jZWxsYXRpb25SZWFzb24uRXJyb3I7XG4gICAgICAgIGxldCBlcnJvckNvZGUgPSBDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcjtcbiAgICAgICAgaWYgKCEhcmVzdWx0LnByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZVtyZXN1bHQucHJvcGVydGllcy5nZXRQcm9wZXJ0eShDYW5jZWxsYXRpb25FcnJvckNvZGVQcm9wZXJ0eU5hbWUsIENhbmNlbGxhdGlvbkVycm9yQ29kZVtDYW5jZWxsYXRpb25FcnJvckNvZGUuTm9FcnJvcl0pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFNwZWFrZXJSZWNvZ25pdGlvbkNhbmNlbGxhdGlvbkRldGFpbHMocmVhc29uLCByZXN1bHQuZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlYWtlclJlY29nbml0aW9uUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFJlY29nbml6ZXJDb25maWcsIFNwZWFrZXJSZWNvZ25pdGlvbkNvbm5lY3Rpb25GYWN0b3J5LCBTcGVha2VyU2VydmljZVJlY29nbml6ZXIgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IFByb3BlcnR5SWQsIFJlY29nbml6ZXIsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBEZWZpbmVzIFNwZWFrZXJSZWNvZ25pemVyIGNsYXNzIGZvciBTcGVha2VyIFJlY29nbml0aW9uXG4gKiBIYW5kbGVzIG9wZXJhdGlvbnMgZnJvbSB1c2VyIGZvciBWb2ljZSBQcm9maWxlIG9wZXJhdGlvbnMgKGUuZy4gY3JlYXRlUHJvZmlsZSwgZGVsZXRlUHJvZmlsZSlcbiAqIEBjbGFzcyBTcGVha2VyUmVjb2duaXplclxuICovXG5leHBvcnQgY2xhc3MgU3BlYWtlclJlY29nbml6ZXIgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGUgU3BlYWtlclJlY29nbml6ZXIuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hDb25maWd9IHNwZWVjaENvbmZpZyAtIFRoZSBzZXQgb2YgY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVzLlxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gaW5wdXQgY29uZmlnIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoc3BlZWNoQ29uZmlnLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoY29uZmlnSW1wbCwgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnLCBjb25maWdJbXBsLnByb3BlcnRpZXMsIG5ldyBTcGVha2VyUmVjb2duaXRpb25Db25uZWN0aW9uRmFjdG9yeSgpKTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Db25maWdJbXBsID0gYXVkaW9Db25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbCh0aGlzLnByaXZBdWRpb0NvbmZpZ0ltcGwsIFwiYXVkaW9Db25maWdcIik7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkU3BlYWtlclJlY29nbml6ZXIgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IGNvbmZpZ0ltcGwucHJvcGVydGllcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBTcGVha2VyUmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFNwZWFrZXJSZWNvZ25pemVyLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRva2VuIC0gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHRva2VuKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0b2tlbiwgXCJ0b2tlblwiKTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHRva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgU3BlYWtlclJlY29nbml6ZXIuXG4gICAgICogQG1lbWJlciBTcGVha2VyUmVjb2duaXplci5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBTcGVha2VyUmVjb2duaXplci5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCByZWNvZ25pdGlvbiByZXN1bHQgZm9yIG1vZGVsIHVzaW5nIGdpdmVuIGF1ZGlvXG4gICAgICogQG1lbWJlciBTcGVha2VyUmVjb2duaXplci5wcm90b3R5cGUucmVjb2duaXplT25jZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBwYXJhbSB7U3BlYWtlcklkZW50aWZpY2F0aW9uTW9kZWwgfCBTcGVha2VyVmVyaWZpY2F0aW9uTW9kZWx9IG1vZGVsIE1vZGVsIGNvbnRhaW5pbmcgVm9pY2UgUHJvZmlsZXMgdG8gYmUgaWRlbnRpZmllZFxuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSByZXN1bHQgaXMgcmV0dXJuZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICByZWNvZ25pemVPbmNlQXN5bmMobW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRTcGVha2VyUmVjb2duaXplcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNvZ25pemVTcGVha2VyT25jZUFzeW5jSW1wbChtb2RlbCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbmNsdWRlZCBmb3IgY29tcGF0aWJpbGl0eVxuICAgICAqIEBtZW1iZXIgU3BlYWtlclJlY29nbml6ZXIucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFNwZWFrZXJSZWNvZ25pemVyKTtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuZGlzcG9zZSh0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJlY29nbml6ZVNwZWFrZXJPbmNlQXN5bmNJbXBsKG1vZGVsKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkU3BlYWtlclJlY29nbml6ZXIpO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5pbXBsUmVjb2duaXplclN0b3AoKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHlpZWxkIHRoaXMucHJpdlJlY28ucmVjb2duaXplU3BlYWtlcihtb2RlbCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLmltcGxSZWNvZ25pemVyU3RvcCgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGltcGxSZWNvZ25pemVyU3RvcCgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZSZWNvKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2UmVjby5zdG9wUmVjb2duaXppbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNyZWF0ZVJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcsIHRoaXMucHJpdlByb3BlcnRpZXMpO1xuICAgIH1cbiAgICBjcmVhdGVTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvQ29uZmlnLCByZWNvZ25pemVyQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IGF1ZGlvSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IFNwZWFrZXJTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvSW1wbCwgcmVjb2duaXplckNvbmZpZywgdGhpcyk7XG4gICAgfVxuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZFNwZWFrZXJSZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkU3BlYWtlclJlY29nbml6ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHlpZWxkIF9zdXBlci5kaXNwb3NlLmNhbGwodGhpcywgZGlzcG9zaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVha2VyUmVjb2duaXplci5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBWb2ljZVByb2ZpbGVUeXBlLCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBTcGVha2VyVmVyaWZpY2F0aW9uTW9kZWwgY2xhc3MgZm9yIFNwZWFrZXIgUmVjb2duaXRpb25cbiAqIE1vZGVsIGNvbnRhaW5zIGEgcHJvZmlsZSBhZ2FpbnN0IHdoaWNoIHRvIHZlcmlmeSBhIHNwZWFrZXJcbiAqIEBjbGFzcyBTcGVha2VyVmVyaWZpY2F0aW9uTW9kZWxcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWFrZXJWZXJpZmljYXRpb25Nb2RlbCB7XG4gICAgY29uc3RydWN0b3IocHJvZmlsZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwcm9maWxlLCBcIlZvaWNlUHJvZmlsZVwiKTtcbiAgICAgICAgaWYgKHByb2ZpbGUucHJvZmlsZVR5cGUgPT09IFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZlcmlmaWNhdGlvbiBtb2RlbCBjYW5ub3QgYmUgY3JlYXRlZCBmcm9tIElkZW50aWZpY2F0aW9uIHByb2ZpbGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Vm9pY2VQcm9maWxlID0gcHJvZmlsZTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21Qcm9maWxlKHByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTcGVha2VyVmVyaWZpY2F0aW9uTW9kZWwocHJvZmlsZSk7XG4gICAgfVxuICAgIGdldCB2b2ljZVByb2ZpbGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZWb2ljZVByb2ZpbGU7XG4gICAgfVxuICAgIGdldCBwcm9maWxlSWRzKCkge1xuICAgICAgICByZXR1cm4gW3RoaXMudm9pY2VQcm9maWxlLnByb2ZpbGVJZF07XG4gICAgfVxuICAgIGdldCBzY2VuYXJpbygpIHtcbiAgICAgICAgaWYgKHRoaXMudm9pY2VQcm9maWxlLnByb2ZpbGVUeXBlID09PSBWb2ljZVByb2ZpbGVUeXBlLlRleHREZXBlbmRlbnRWZXJpZmljYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBcIlRleHREZXBlbmRlbnRWZXJpZmljYXRpb25cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvblwiO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVha2VyVmVyaWZpY2F0aW9uTW9kZWwuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBGb3JjZURpY3RhdGlvblByb3BlcnR5TmFtZSwgT3V0cHV0Rm9ybWF0UHJvcGVydHlOYW1lLCBTZXJ2aWNlUHJvcGVydGllc1Byb3BlcnR5TmFtZSB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBQcm9mYW5pdHlPcHRpb24sIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogU3BlZWNoIGNvbmZpZ3VyYXRpb24uXG4gKiBAY2xhc3MgU3BlZWNoQ29uZmlnXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hDb25maWcge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpYyBpbnN0YW5jZSBvZiBTcGVlY2hDb25maWcgcmV0dXJuZWQgYnkgcGFzc2luZyBzdWJzY3JpcHRpb25LZXkgYW5kIHNlcnZpY2UgcmVnaW9uLlxuICAgICAqIE5vdGU6IFBsZWFzZSB1c2UgeW91ciBMYW5ndWFnZVVuZGVyc3RhbmRpbmcgc3Vic2NyaXB0aW9uIGtleSBpbiBjYXNlIHlvdSB3YW50IHRvIHVzZSB0aGUgSW50ZW50IHJlY29nbml6ZXIuXG4gICAgICogQG1lbWJlciBTcGVlY2hDb25maWcuZnJvbVN1YnNjcmlwdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3Vic2NyaXB0aW9uS2V5IC0gVGhlIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlZ2lvbiAtIFRoZSByZWdpb24gbmFtZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoQ29uZmlnfSBUaGUgc3BlZWNoIGZhY3RvcnlcbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb25LZXksIHJlZ2lvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc3Vic2NyaXB0aW9uS2V5LCBcInN1YnNjcmlwdGlvbktleVwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IHNwZWVjaEltcGwgPSBuZXcgU3BlZWNoQ29uZmlnSW1wbCgpO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uLCByZWdpb24pO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fSW50ZW50UmVnaW9uLCByZWdpb24pO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICByZXR1cm4gc3BlZWNoSW1wbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgc3BlZWNoIGNvbmZpZyB3aXRoIHNwZWNpZmllZCBlbmRwb2ludCBhbmQgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBvbmx5IGZvciB1c2VycyB3aG8gdXNlIGEgbm9uLXN0YW5kYXJkIHNlcnZpY2UgZW5kcG9pbnQgb3IgcGFyYW1ldGVycy5cbiAgICAgKiBOb3RlOiBQbGVhc2UgdXNlIHlvdXIgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nIHN1YnNjcmlwdGlvbiBrZXkgaW4gY2FzZSB5b3Ugd2FudCB0byB1c2UgdGhlIEludGVudCByZWNvZ25pemVyLlxuICAgICAqIE5vdGU6IFRoZSBxdWVyeSBwYXJhbWV0ZXJzIHNwZWNpZmllZCBpbiB0aGUgZW5kcG9pbnQgVVJMIGFyZSBub3QgY2hhbmdlZCwgZXZlbiBpZiB0aGV5IGFyZSBzZXQgYnkgYW55IG90aGVyIEFQSXMuXG4gICAgICogRm9yIGV4YW1wbGUsIGlmIGxhbmd1YWdlIGlzIGRlZmluZWQgaW4gdGhlIHVyaSBhcyBxdWVyeSBwYXJhbWV0ZXIgXCJsYW5ndWFnZT1kZS1ERVwiLCBhbmQgYWxzbyBzZXQgYnlcbiAgICAgKiBTcGVlY2hDb25maWcuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSA9IFwiZW4tVVNcIiwgdGhlIGxhbmd1YWdlIHNldHRpbmcgaW4gdXJpIHRha2VzIHByZWNlZGVuY2UsXG4gICAgICogYW5kIHRoZSBlZmZlY3RpdmUgbGFuZ3VhZ2UgaXMgXCJkZS1ERVwiLiBPbmx5IHRoZSBwYXJhbWV0ZXJzIHRoYXQgYXJlIG5vdCBzcGVjaWZpZWQgaW4gdGhlXG4gICAgICogZW5kcG9pbnQgVVJMIGNhbiBiZSBzZXQgYnkgb3RoZXIgQVBJcy5cbiAgICAgKiBOb3RlOiBUbyB1c2UgYXV0aG9yaXphdGlvbiB0b2tlbiB3aXRoIGZyb21FbmRwb2ludCwgcGFzcyBhbiBlbXB0eSBzdHJpbmcgdG8gdGhlIHN1YnNjcmlwdGlvbktleSBpbiB0aGVcbiAgICAgKiBmcm9tRW5kcG9pbnQgbWV0aG9kLCBhbmQgdGhlbiBzZXQgYXV0aG9yaXphdGlvblRva2VuPVwidG9rZW5cIiBvbiB0aGUgY3JlYXRlZCBTcGVlY2hDb25maWcgaW5zdGFuY2UgdG9cbiAgICAgKiB1c2UgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICogQG1lbWJlciBTcGVlY2hDb25maWcuZnJvbUVuZHBvaW50XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7VVJMfSBlbmRwb2ludCAtIFRoZSBzZXJ2aWNlIGVuZHBvaW50IHRvIGNvbm5lY3QgdG8uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LiBJZiBhIHN1YnNjcmlwdGlvbiBrZXkgaXMgbm90IHNwZWNpZmllZCwgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiBtdXN0IGJlIHNldC5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoQ29uZmlnfSBBIHNwZWVjaCBmYWN0b3J5IGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tRW5kcG9pbnQoZW5kcG9pbnQsIHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoZW5kcG9pbnQsIFwiZW5kcG9pbnRcIik7XG4gICAgICAgIGNvbnN0IHNwZWVjaEltcGwgPSBuZXcgU3BlZWNoQ29uZmlnSW1wbCgpO1xuICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnQsIGVuZHBvaW50LmhyZWYpO1xuICAgICAgICBpZiAodW5kZWZpbmVkICE9PSBzdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgICAgIHNwZWVjaEltcGwuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbktleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwZWVjaEltcGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHNwZWVjaCBjb25maWcgd2l0aCBzcGVjaWZpZWQgaG9zdCBhbmQgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBvbmx5IGZvciB1c2VycyB3aG8gdXNlIGEgbm9uLWRlZmF1bHQgc2VydmljZSBob3N0LiBTdGFuZGFyZCByZXNvdXJjZSBwYXRoIHdpbGwgYmUgYXNzdW1lZC5cbiAgICAgKiBGb3Igc2VydmljZXMgd2l0aCBhIG5vbi1zdGFuZGFyZCByZXNvdXJjZSBwYXRoIG9yIG5vIHBhdGggYXQgYWxsLCB1c2UgZnJvbUVuZHBvaW50IGluc3RlYWQuXG4gICAgICogTm90ZTogUXVlcnkgcGFyYW1ldGVycyBhcmUgbm90IGFsbG93ZWQgaW4gdGhlIGhvc3QgVVJJIGFuZCBtdXN0IGJlIHNldCBieSBvdGhlciBBUElzLlxuICAgICAqIE5vdGU6IFRvIHVzZSBhbiBhdXRob3JpemF0aW9uIHRva2VuIHdpdGggZnJvbUhvc3QsIHVzZSBmcm9tSG9zdChVUkwpLFxuICAgICAqIGFuZCB0aGVuIHNldCB0aGUgQXV0aG9yaXphdGlvblRva2VuIHByb3BlcnR5IG9uIHRoZSBjcmVhdGVkIFNwZWVjaENvbmZpZyBpbnN0YW5jZS5cbiAgICAgKiBOb3RlOiBBZGRlZCBpbiB2ZXJzaW9uIDEuOS4wLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoQ29uZmlnLmZyb21Ib3N0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7VVJMfSBob3N0IC0gVGhlIHNlcnZpY2UgZW5kcG9pbnQgdG8gY29ubmVjdCB0by4gRm9ybWF0IGlzIFwicHJvdG9jb2w6Ly9ob3N0OnBvcnRcIiB3aGVyZSBcIjpwb3J0XCIgaXMgb3B0aW9uYWwuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LiBJZiBhIHN1YnNjcmlwdGlvbiBrZXkgaXMgbm90IHNwZWNpZmllZCwgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiBtdXN0IGJlIHNldC5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoQ29uZmlnfSBBIHNwZWVjaCBmYWN0b3J5IGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSG9zdChob3N0TmFtZSwgc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChob3N0TmFtZSwgXCJob3N0TmFtZVwiKTtcbiAgICAgICAgY29uc3Qgc3BlZWNoSW1wbCA9IG5ldyBTcGVlY2hDb25maWdJbXBsKCk7XG4gICAgICAgIHNwZWVjaEltcGwuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Ib3N0LCBob3N0TmFtZS5wcm90b2NvbCArIFwiLy9cIiArIGhvc3ROYW1lLmhvc3RuYW1lICsgKGhvc3ROYW1lLnBvcnQgPT09IFwiXCIgPyBcIlwiIDogXCI6XCIgKyBob3N0TmFtZS5wb3J0KSk7XG4gICAgICAgIGlmICh1bmRlZmluZWQgIT09IHN1YnNjcmlwdGlvbktleSkge1xuICAgICAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgc3Vic2NyaXB0aW9uS2V5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3BlZWNoSW1wbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiB0aGUgc3BlZWNoIGZhY3Rvcnkgd2l0aCBzcGVjaWZpZWQgaW5pdGlhbCBhdXRob3JpemF0aW9uIHRva2VuIGFuZCByZWdpb24uXG4gICAgICogTm90ZTogVGhlIGNhbGxlciBuZWVkcyB0byBlbnN1cmUgdGhhdCB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiBpcyB2YWxpZC4gQmVmb3JlIHRoZSBhdXRob3JpemF0aW9uIHRva2VuXG4gICAgICogZXhwaXJlcywgdGhlIGNhbGxlciBuZWVkcyB0byByZWZyZXNoIGl0IGJ5IGNhbGxpbmcgdGhpcyBzZXR0ZXIgd2l0aCBhIG5ldyB2YWxpZCB0b2tlbi5cbiAgICAgKiBOb3RlOiBQbGVhc2UgdXNlIGEgdG9rZW4gZGVyaXZlZCBmcm9tIHlvdXIgTGFuZ3VhZ2VVbmRlcnN0YW5kaW5nIHN1YnNjcmlwdGlvbiBrZXkgaW4gY2FzZSB5b3Ugd2FudFxuICAgICAqIHRvIHVzZSB0aGUgSW50ZW50IHJlY29nbml6ZXIuIEFzIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGFyZSBjb3BpZWQgd2hlbiBjcmVhdGluZyBhIG5ldyByZWNvZ25pemVyLFxuICAgICAqIHRoZSBuZXcgdG9rZW4gdmFsdWUgd2lsbCBub3QgYXBwbHkgdG8gcmVjb2duaXplcnMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiBjcmVhdGVkLiBGb3IgcmVjb2duaXplcnNcbiAgICAgKiB0aGF0IGhhdmUgYmVlbiBjcmVhdGVkIGJlZm9yZSwgeW91IG5lZWQgdG8gc2V0IGF1dGhvcml6YXRpb24gdG9rZW4gb2YgdGhlIGNvcnJlc3BvbmRpbmcgcmVjb2duaXplclxuICAgICAqIHRvIHJlZnJlc2ggdGhlIHRva2VuLiBPdGhlcndpc2UsIHRoZSByZWNvZ25pemVycyB3aWxsIGVuY291bnRlciBlcnJvcnMgZHVyaW5nIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoQ29uZmlnLmZyb21BdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF1dGhvcml6YXRpb25Ub2tlbiAtIFRoZSBpbml0aWFsIGF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlZ2lvbiAtIFRoZSByZWdpb24gbmFtZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoQ29uZmlnfSBBIHNwZWVjaCBmYWN0b3J5IGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tQXV0aG9yaXphdGlvblRva2VuKGF1dGhvcml6YXRpb25Ub2tlbiwgcmVnaW9uKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChhdXRob3JpemF0aW9uVG9rZW4sIFwiYXV0aG9yaXphdGlvblRva2VuXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocmVnaW9uLCBcInJlZ2lvblwiKTtcbiAgICAgICAgY29uc3Qgc3BlZWNoSW1wbCA9IG5ldyBTcGVlY2hDb25maWdJbXBsKCk7XG4gICAgICAgIHNwZWVjaEltcGwuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIHNwZWVjaEltcGwuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9JbnRlbnRSZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIHNwZWVjaEltcGwuYXV0aG9yaXphdGlvblRva2VuID0gYXV0aG9yaXphdGlvblRva2VuO1xuICAgICAgICByZXR1cm4gc3BlZWNoSW1wbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBjb25maWd1cmF0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoQ29uZmlnLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgY2xvc2UoKSB7IH1cbn1cbi8qKlxuICogQHB1YmxpY1xuICogQGNsYXNzIFNwZWVjaENvbmZpZ0ltcGxcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaENvbmZpZ0ltcGwgZXh0ZW5kcyBTcGVlY2hDb25maWcge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UgPSBcImVuLVVTXCI7IC8vIFNob3VsZCB3ZSBoYXZlIGEgZGVmYXVsdD9cbiAgICAgICAgdGhpcy5vdXRwdXRGb3JtYXQgPSBPdXRwdXRGb3JtYXQuU2ltcGxlO1xuICAgIH1cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIGdldCBlbmRQb2ludCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBVUkwodGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50KSk7XG4gICAgfVxuICAgIGdldCBzdWJzY3JpcHRpb25LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5KTtcbiAgICB9XG4gICAgZ2V0IHJlZ2lvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24pO1xuICAgIH1cbiAgICBnZXQgYXV0aG9yaXphdGlvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKTtcbiAgICB9XG4gICAgc2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgdmFsdWUpO1xuICAgIH1cbiAgICBnZXQgYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzKTtcbiAgICB9XG4gICAgc2V0IGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXMsIHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IG91dHB1dEZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIE91dHB1dEZvcm1hdFt0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgdW5kZWZpbmVkKV07XG4gICAgfVxuICAgIHNldCBvdXRwdXRGb3JtYXQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFt2YWx1ZV0pO1xuICAgIH1cbiAgICBnZXQgZW5kcG9pbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludElkKTtcbiAgICB9XG4gICAgc2V0IGVuZHBvaW50SWQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50SWQsIHZhbHVlKTtcbiAgICB9XG4gICAgc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHZhbHVlLCBcInZhbHVlXCIpO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KG5hbWUsIHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0UHJvcGVydHkobmFtZSwgZGVmKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzLmdldFByb3BlcnR5KG5hbWUsIGRlZik7XG4gICAgfVxuICAgIHNldFByb3h5KHByb3h5SG9zdE5hbWUsIHByb3h5UG9ydCwgcHJveHlVc2VyTmFtZSwgcHJveHlQYXNzd29yZCkge1xuICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eUhvc3ROYW1lXSwgcHJveHlIb3N0TmFtZSk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5UG9ydF0sIHByb3h5UG9ydCk7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5VXNlck5hbWVdLCBwcm94eVVzZXJOYW1lKTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZF0sIHByb3h5UGFzc3dvcmQpO1xuICAgIH1cbiAgICBzZXRTZXJ2aWNlUHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFByb3BlcnRpZXMgPSBKU09OLnBhcnNlKHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIFwie31cIikpO1xuICAgICAgICBjdXJyZW50UHJvcGVydGllc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFNlcnZpY2VQcm9wZXJ0aWVzUHJvcGVydHlOYW1lLCBKU09OLnN0cmluZ2lmeShjdXJyZW50UHJvcGVydGllcykpO1xuICAgIH1cbiAgICBzZXRQcm9mYW5pdHkocHJvZmFuaXR5KSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlUmVzcG9uc2VfUHJvZmFuaXR5T3B0aW9uLCBQcm9mYW5pdHlPcHRpb25bcHJvZmFuaXR5XSk7XG4gICAgfVxuICAgIGVuYWJsZUF1ZGlvTG9nZ2luZygpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuYWJsZUF1ZGlvTG9nZ2luZywgXCJ0cnVlXCIpO1xuICAgIH1cbiAgICByZXF1ZXN0V29yZExldmVsVGltZXN0YW1wcygpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9SZXF1ZXN0V29yZExldmVsVGltZXN0YW1wcywgXCJ0cnVlXCIpO1xuICAgIH1cbiAgICBlbmFibGVEaWN0YXRpb24oKSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoRm9yY2VEaWN0YXRpb25Qcm9wZXJ0eU5hbWUsIFwidHJ1ZVwiKTtcbiAgICB9XG4gICAgY2xvbmUoKSB7XG4gICAgICAgIGNvbnN0IHJldCA9IG5ldyBTcGVlY2hDb25maWdJbXBsKCk7XG4gICAgICAgIHJldC5wcml2UHJvcGVydGllcyA9IHRoaXMucHJpdlByb3BlcnRpZXMuY2xvbmUoKTtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFN5bnRoZXNpc0xhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2UpO1xuICAgIH1cbiAgICBzZXQgc3BlZWNoU3ludGhlc2lzTGFuZ3VhZ2UobGFuZ3VhZ2UpIHtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoTGFuZ3VhZ2UsIGxhbmd1YWdlKTtcbiAgICB9XG4gICAgZ2V0IHNwZWVjaFN5bnRoZXNpc1ZvaWNlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aFZvaWNlKTtcbiAgICB9XG4gICAgc2V0IHNwZWVjaFN5bnRoZXNpc1ZvaWNlTmFtZSh2b2ljZSkge1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZSwgdm9pY2UpO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W3RoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdCwgdW5kZWZpbmVkKV07XG4gICAgfVxuICAgIHNldCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdCwgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W2Zvcm1hdF0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoQ29uZmlnLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBDYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlLCB9IGZyb20gXCIuL0NhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2VcIjtcbmV4cG9ydCBjbGFzcyBTcGVlY2hSZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzIGV4dGVuZHMgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZSB7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1jbGFzc2VzLXBlci1maWxlICovXG5pbXBvcnQgeyBSZWNvZ25pdGlvbkV2ZW50QXJncyB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiBzcGVlY2ggcmVjb2duaXppbmcvcmVjb2duaXplZCBldmVudC5cbiAqIEBjbGFzcyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoUmVjb2duaXRpb25FdmVudEFyZ3MgZXh0ZW5kcyBSZWNvZ25pdGlvbkV2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaFJlY29nbml0aW9uUmVzdWx0fSByZXN1bHQgLSBUaGUgc3BlZWNoIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gVGhlIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihvZmZzZXQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdlJlc3VsdCA9IHJlc3VsdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncy5wcm90b3R5cGUucmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtTcGVlY2hSZWNvZ25pdGlvblJlc3VsdH0gdGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbn1cbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiBjb252ZXJzYXRpb24gdHJhbnNjcmliZWQvdHJhbnNjcmliaW5nIGV2ZW50LlxuICogQGNsYXNzIENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25FdmVudEFyZ3NcbiAqL1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblRyYW5zY3JpcHRpb25FdmVudEFyZ3MgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvbkV2ZW50QXJncyB7XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFJlY29nbml0aW9uRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBSZWNvZ25pdGlvblJlc3VsdCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyByZXN1bHQgb2Ygc3BlZWNoIHJlY29nbml0aW9uLlxuICogQGNsYXNzIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0XG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCBleHRlbmRzIFJlY29nbml0aW9uUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVzdWx0SWQgLSBUaGUgcmVzdWx0IGlkLlxuICAgICAqIEBwYXJhbSB7UmVzdWx0UmVhc29ufSByZWFzb24gLSBUaGUgcmVhc29uLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gVGhlIHJlY29nbml6ZWQgdGV4dC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb24gLSBUaGUgZHVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQgaW50byB0aGUgc3RyZWFtLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZSAtIFByaW1hcnkgTGFuZ3VhZ2UgZGV0ZWN0ZWQsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UgLSBQcmltYXJ5IExhbmd1YWdlIGNvbmZpZGVuY2UgKFwiVW5rbm93bixcIiBcIkxvdyxcIiBcIk1lZGl1bSxcIiBcIkhpZ2hcIi4uLiksIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzcGVha2VySWQgLSBzcGVha2VyIGlkIGZvciBjb252ZXJzYXRpb24gdHJhbnNjcmlwdGlvbiwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGVycm9yRGV0YWlscyAtIEVycm9yIGRldGFpbHMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBqc29uIC0gQWRkaXRpb25hbCBKc29uLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge1Byb3BlcnR5Q29sbGVjdGlvbn0gcHJvcGVydGllcyAtIEFkZGl0aW9uYWwgcHJvcGVydGllcywgaWYgcHJvdmlkZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgbGFuZ3VhZ2UsIGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgc3BlYWtlcklkLCBlcnJvckRldGFpbHMsIGpzb24sIHByb3BlcnRpZXMpIHtcbiAgICAgICAgc3VwZXIocmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgbGFuZ3VhZ2UsIGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5wcml2U3BlYWtlcklkID0gc3BlYWtlcklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBzcGVha2VyIGlkIGZyb20gY29udmVyc2F0aW9uIHRyYW5zY3JpcHRpb24vaWQgc2NlbmFyaW9zXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdC5wcm90b3R5cGUuc3BlYWtlcklkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGlkIG9mIHNwZWFrZXIgaW4gZ2l2ZW4gcmVzdWx0XG4gICAgICovXG4gICAgZ2V0IHNwZWFrZXJJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWFrZXJJZDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFJlY29nbml0aW9uUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgUmVjb2duaXRpb25Nb2RlLCBSZWNvZ25pemVyQ29uZmlnLCBTcGVlY2hDb25uZWN0aW9uRmFjdG9yeSwgU3BlZWNoU2VydmljZVJlY29nbml6ZXIsIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyB9IGZyb20gXCIuLi9jb21tb24vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBPdXRwdXRGb3JtYXQsIFByb3BlcnR5SWQsIFJlY29nbml6ZXIsIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBQZXJmb3JtcyBzcGVlY2ggcmVjb2duaXRpb24gZnJvbSBtaWNyb3Bob25lLCBmaWxlLCBvciBvdGhlciBhdWRpbyBpbnB1dCBzdHJlYW1zLCBhbmQgZ2V0cyB0cmFuc2NyaWJlZCB0ZXh0IGFzIHJlc3VsdC5cbiAqIEBjbGFzcyBTcGVlY2hSZWNvZ25pemVyXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hSZWNvZ25pemVyIGV4dGVuZHMgUmVjb2duaXplciB7XG4gICAgLyoqXG4gICAgICogU3BlZWNoUmVjb2duaXplciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaENvbmZpZ30gc3BlZWNoQ29uZmlnIC0gYW4gc2V0IG9mIGluaXRpYWwgcHJvcGVydGllcyBmb3IgdGhpcyByZWNvZ25pemVyXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoQ29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKHNwZWVjaENvbmZpZ0ltcGwsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uoc3BlZWNoQ29uZmlnSW1wbC5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKSwgUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZV0pO1xuICAgICAgICBzdXBlcihhdWRpb0NvbmZpZywgc3BlZWNoQ29uZmlnSW1wbC5wcm9wZXJ0aWVzLCBuZXcgU3BlZWNoQ29ubmVjdGlvbkZhY3RvcnkoKSk7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplciA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVlY2hSZWNvZ25pemVyIGNvbnN0cnVjdG9yLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7U3BlZWNoQ29uZmlnfSBzcGVlY2hDb25maWcgLSBhbiBzZXQgb2YgaW5pdGlhbCBwcm9wZXJ0aWVzIGZvciB0aGlzIHJlY29nbml6ZXJcbiAgICAgKiBAcGFyYW0ge0F1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZ30gYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnIC0gQW4gc291cmNlIGxhbmd1YWdlIGRldGVjdGlvbiBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBzdGF0aWMgRnJvbUNvbmZpZyhzcGVlY2hDb25maWcsIGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoQ29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLnByb3BlcnRpZXMubWVyZ2VUbyhzcGVlY2hDb25maWdJbXBsLnByb3BlcnRpZXMpO1xuICAgICAgICBjb25zdCByZWNvZ25pemVyID0gbmV3IFNwZWVjaFJlY29nbml6ZXIoc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZyk7XG4gICAgICAgIHJldHVybiByZWNvZ25pemVyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBlbmRwb2ludCBpZCBvZiBhIGN1c3RvbWl6ZWQgc3BlZWNoIG1vZGVsIHRoYXQgaXMgdXNlZCBmb3Igc3BlZWNoIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuZW5kcG9pbnRJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0aGUgZW5kcG9pbnQgaWQgb2YgYSBjdXN0b21pemVkIHNwZWVjaCBtb2RlbCB0aGF0IGlzIHVzZWQgZm9yIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAgICAgKi9cbiAgICBnZXQgZW5kcG9pbnRJZCgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCwgXCIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDBcIik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdG9rZW4gLSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odG9rZW4pIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRva2VuLCBcInRva2VuXCIpO1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBzcG9rZW4gbGFuZ3VhZ2Ugb2YgcmVjb2duaXRpb24uXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBzcG9rZW4gbGFuZ3VhZ2Ugb2YgcmVjb2duaXRpb24uXG4gICAgICovXG4gICAgZ2V0IHNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2UoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRSZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG91dHB1dCBmb3JtYXQgb2YgcmVjb2duaXRpb24uXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5vdXRwdXRGb3JtYXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge091dHB1dEZvcm1hdH0gVGhlIG91dHB1dCBmb3JtYXQgb2YgcmVjb2duaXRpb24uXG4gICAgICovXG4gICAgZ2V0IG91dHB1dEZvcm1hdCgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpO1xuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKSA9PT0gT3V0cHV0Rm9ybWF0W091dHB1dEZvcm1hdC5TaW1wbGVdKSB7XG4gICAgICAgICAgICByZXR1cm4gT3V0cHV0Rm9ybWF0LlNpbXBsZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBPdXRwdXRGb3JtYXQuRGV0YWlsZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgU3BlZWNoUmVjb2duaXplci5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgU3BlZWNoUmVjb2duaXplci5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBzcGVlY2ggcmVjb2duaXRpb24sIGFuZCBzdG9wcyBhZnRlciB0aGUgZmlyc3QgdXR0ZXJhbmNlIGlzIHJlY29nbml6ZWQuXG4gICAgICogVGhlIHRhc2sgcmV0dXJucyB0aGUgcmVjb2duaXRpb24gdGV4dCBhcyByZXN1bHQuXG4gICAgICogTm90ZTogUmVjb2duaXplT25jZUFzeW5jKCkgcmV0dXJucyB3aGVuIHRoZSBmaXJzdCB1dHRlcmFuY2UgaGFzIGJlZW4gcmVjb2duaXplZCxcbiAgICAgKiBzbyBpdCBpcyBzdWl0YWJsZSBvbmx5IGZvciBzaW5nbGUgc2hvdCByZWNvZ25pdGlvblxuICAgICAqIGxpa2UgY29tbWFuZCBvciBxdWVyeS4gRm9yIGxvbmctcnVubmluZyByZWNvZ25pdGlvbiwgdXNlIFN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmMoKSBpbnN0ZWFkLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUucmVjb2duaXplT25jZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIHRoYXQgcmVjZWl2ZWQgdGhlIFNwZWVjaFJlY29nbml0aW9uUmVzdWx0LlxuICAgICAqIEBwYXJhbSBlcnIgLSBDYWxsYmFjayBpbnZva2VkIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICovXG4gICAgcmVjb2duaXplT25jZUFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnJlY29nbml6ZU9uY2VBc3luY0ltcGwoUmVjb2duaXRpb25Nb2RlLkludGVyYWN0aXZlKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBzcGVlY2ggcmVjb2duaXRpb24sIHVudGlsIHN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYygpIGlzIGNhbGxlZC5cbiAgICAgKiBVc2VyIG11c3Qgc3Vic2NyaWJlIHRvIGV2ZW50cyB0byByZWNlaXZlIHJlY29nbml0aW9uIHJlc3VsdHMuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5zdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKFJlY29nbml0aW9uTW9kZS5Db252ZXJzYXRpb24pLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcHMgY29udGludW91cyBzcGVlY2ggcmVjb2duaXRpb24uXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgaW52b2tlZCBvbmNlIHRoZSByZWNvZ25pdGlvbiBoYXMgc3RvcHBlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgc3BlZWNoIHJlY29nbml0aW9uIHdpdGgga2V5d29yZCBzcG90dGluZywgdW50aWxcbiAgICAgKiBzdG9wS2V5d29yZFJlY29nbml0aW9uQXN5bmMoKSBpcyBjYWxsZWQuXG4gICAgICogVXNlciBtdXN0IHN1YnNjcmliZSB0byBldmVudHMgdG8gcmVjZWl2ZSByZWNvZ25pdGlvbiByZXN1bHRzLlxuICAgICAqIE5vdGU6IEtleSB3b3JkIHNwb3R0aW5nIGZ1bmN0aW9uYWxpdHkgaXMgb25seSBhdmFpbGFibGUgb24gdGhlXG4gICAgICogU3BlZWNoIERldmljZXMgU0RLLiBUaGlzIGZ1bmN0aW9uYWxpdHkgaXMgY3VycmVudGx5IG5vdCBpbmNsdWRlZCBpbiB0aGUgU0RLIGl0c2VsZi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFJlY29nbml6ZXIucHJvdG90eXBlLnN0YXJ0S2V5d29yZFJlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtLZXl3b3JkUmVjb2duaXRpb25Nb2RlbH0gbW9kZWwgVGhlIGtleXdvcmQgcmVjb2duaXRpb24gbW9kZWwgdGhhdFxuICAgICAqIHNwZWNpZmllcyB0aGUga2V5d29yZCB0byBiZSByZWNvZ25pemVkLlxuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgcmVjb2duaXRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdGFydEtleXdvcmRSZWNvZ25pdGlvbkFzeW5jKG1vZGVsLCBjYiwgZXJyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChtb2RlbCwgXCJtb2RlbFwiKTtcbiAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICBlcnIoXCJOb3QgeWV0IGltcGxlbWVudGVkLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdG9wcyBjb250aW51b3VzIHNwZWVjaCByZWNvZ25pdGlvbi5cbiAgICAgKiBOb3RlOiBLZXkgd29yZCBzcG90dGluZyBmdW5jdGlvbmFsaXR5IGlzIG9ubHkgYXZhaWxhYmxlIG9uIHRoZVxuICAgICAqIFNwZWVjaCBEZXZpY2VzIFNESy4gVGhpcyBmdW5jdGlvbmFsaXR5IGlzIGN1cnJlbnRseSBub3QgaW5jbHVkZWQgaW4gdGhlIFNESyBpdHNlbGYuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5zdG9wS2V5d29yZFJlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgaW52b2tlZCBvbmNlIHRoZSByZWNvZ25pdGlvbiBoYXMgc3RvcHBlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHN0b3BLZXl3b3JkUmVjb2duaXRpb25Bc3luYyhjYikge1xuICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBjbG9zZXMgYWxsIGV4dGVybmFsIHJlc291cmNlcyBoZWxkIGJ5IGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQG1lbWJlciBTcGVlY2hSZWNvZ25pemVyLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZShjYiwgZXJyb3JDYikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplcik7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5kaXNwb3NlKHRydWUpLCBjYiwgZXJyb3JDYik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2VzIGFueSByZXNvdXJjZXMgaGVsZCBieSB0aGUgb2JqZWN0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoUmVjb2duaXplci5wcm90b3R5cGUuZGlzcG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRpc3Bvc2luZyAtIHRydWUgaWYgZGlzcG9zaW5nIHRoZSBvYmplY3QuXG4gICAgICovXG4gICAgZGlzcG9zZShkaXNwb3NpbmcpIHtcbiAgICAgICAgY29uc3QgX3N1cGVyID0gT2JqZWN0LmNyZWF0ZShudWxsLCB7XG4gICAgICAgICAgICBkaXNwb3NlOiB7IGdldDogKCkgPT4gc3VwZXIuZGlzcG9zZSB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCBfc3VwZXIuZGlzcG9zZS5jYWxsKHRoaXMsIGRpc3Bvc2luZyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjcmVhdGVSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnLCB0aGlzLnByaXZQcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgY3JlYXRlU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBhdWRpb0NvbmZpZywgcmVjb2duaXplckNvbmZpZykge1xuICAgICAgICBjb25zdCBjb25maWdJbXBsID0gYXVkaW9Db25maWc7XG4gICAgICAgIHJldHVybiBuZXcgU3BlZWNoU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBjb25maWdJbXBsLCByZWNvZ25pemVyQ29uZmlnLCB0aGlzKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiBzcGVlY2ggc3ludGhlc2lzIGJvb2ttYXJrIGV2ZW50LlxuICogQGNsYXNzIFNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTYuMFxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2lzQm9va21hcmtFdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGF1ZGlvT2Zmc2V0IC0gVGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCAtIFRoZSBib29rbWFyayB0ZXh0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvT2Zmc2V0LCB0ZXh0KSB7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvT2Zmc2V0ID0gYXVkaW9PZmZzZXQ7XG4gICAgICAgIHRoaXMucHJpdlRleHQgPSB0ZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc0Jvb2ttYXJrRXZlbnRBcmdzLnByb3RvdHlwZS5hdWRpb09mZnNldFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgYXVkaW8gb2Zmc2V0LlxuICAgICAqL1xuICAgIGdldCBhdWRpb09mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvT2Zmc2V0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGJvb2ttYXJrLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzQm9va21hcmtFdmVudEFyZ3MucHJvdG90eXBlLnRleHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gdGhlIGJvb2ttYXJrIHRleHQuXG4gICAgICovXG4gICAgZ2V0IHRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUZXh0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoU3ludGhlc2lzQm9va21hcmtFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyB0aGUgYm91bmRhcnkgdHlwZSBvZiBzcGVlY2ggc3ludGhlc2lzIGJvdW5kYXJ5IGV2ZW50LlxuICogQGNsYXNzIFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZVxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjIxLjBcbiAqL1xuZXhwb3J0IHZhciBTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGU7XG4oZnVuY3Rpb24gKFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZSkge1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgYm91bmRhcnkgdGV4dCBpcyBhIHdvcmQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGUuV29yZFxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZVtcIldvcmRcIl0gPSBcIldvcmRCb3VuZGFyeVwiO1xuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB0aGUgYm91bmRhcnkgdGV4dCBpcyBhIHB1bmN0dWF0aW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlLlB1bmN0dWF0aW9uXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzQm91bmRhcnlUeXBlW1wiUHVuY3R1YXRpb25cIl0gPSBcIlB1bmN0dWF0aW9uQm91bmRhcnlcIjtcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIGJvdW5kYXJ5IHRleHQgaXMgYSBzZW50ZW5jZS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZS5TZW50ZW5jZVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZVtcIlNlbnRlbmNlXCJdID0gXCJTZW50ZW5jZUJvdW5kYXJ5XCI7XG59KShTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGUgfHwgKFNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZS5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnRzIG9mIHNwZWVjaCBzeW50aGVzaXMgZXZlbnRzLlxuICogQGNsYXNzIFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJnc1xuICogQWRkZWQgaW4gdmVyc2lvbiAxLjExLjBcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncyB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaFN5bnRoZXNpc1Jlc3VsdH0gcmVzdWx0IC0gVGhlIHNwZWVjaCBzeW50aGVzaXMgcmVzdWx0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdCkge1xuICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgc3ludGhlc2lzIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc0V2ZW50QXJncy5wcm90b3R5cGUucmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtTcGVlY2hTeW50aGVzaXNSZXN1bHR9IHRoZSBzeW50aGVzaXMgcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCByZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN1bHQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTeW50aGVzaXNFdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lIHNwZWVjaCBzeW50aGVzaXMgYXVkaW8gb3V0cHV0IGZvcm1hdHMuXG4gKiBAZW51bSBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRcbiAqIFVwZGF0ZWQgaW4gdmVyc2lvbiAxLjE3LjBcbiAqL1xuZXhwb3J0IHZhciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQ7XG4oZnVuY3Rpb24gKFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCkge1xuICAgIC8qKlxuICAgICAqIHJhdy04a2h6LThiaXQtbW9uby1tdWxhd1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzhLaHo4Qml0TW9ub01VTGF3LFxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXc4S2h6OEJpdE1vbm9NVUxhd1wiXSA9IDBdID0gXCJSYXc4S2h6OEJpdE1vbm9NVUxhd1wiO1xuICAgIC8qKlxuICAgICAqIHJpZmYtMTZraHotMTZrYnBzLW1vbm8tc2lyZW5cbiAgICAgKiBAbm90ZSBVbnN1cHBvcnRlZCBieSB0aGUgc2VydmljZS4gRG8gbm90IHVzZSB0aGlzIHZhbHVlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmYxNktoejE2S2Jwc01vbm9TaXJlblxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmMTZLaHoxNkticHNNb25vU2lyZW5cIl0gPSAxXSA9IFwiUmlmZjE2S2h6MTZLYnBzTW9ub1NpcmVuXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tMTZraHotMTZrYnBzLW1vbm8tc2lyZW5cbiAgICAgKiBAbm90ZSBVbnN1cHBvcnRlZCBieSB0aGUgc2VydmljZS4gRG8gbm90IHVzZSB0aGlzIHZhbHVlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMTZLaHoxNkticHNNb25vU2lyZW5cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8xNktoejE2S2Jwc01vbm9TaXJlblwiXSA9IDJdID0gXCJBdWRpbzE2S2h6MTZLYnBzTW9ub1NpcmVuXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tMTZraHotMzJrYml0cmF0ZS1tb25vLW1wM1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMTZLaHozMktCaXRSYXRlTW9ub01wM1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzE2S2h6MzJLQml0UmF0ZU1vbm9NcDNcIl0gPSAzXSA9IFwiQXVkaW8xNktoejMyS0JpdFJhdGVNb25vTXAzXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tMTZraHotMTI4a2JpdHJhdGUtbW9uby1tcDNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6MTI4S0JpdFJhdGVNb25vTXAzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMTZLaHoxMjhLQml0UmF0ZU1vbm9NcDNcIl0gPSA0XSA9IFwiQXVkaW8xNktoejEyOEtCaXRSYXRlTW9ub01wM1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTE2a2h6LTY0a2JpdHJhdGUtbW9uby1tcDNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzE2S2h6NjRLQml0UmF0ZU1vbm9NcDNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8xNktoejY0S0JpdFJhdGVNb25vTXAzXCJdID0gNV0gPSBcIkF1ZGlvMTZLaHo2NEtCaXRSYXRlTW9ub01wM1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTI0a2h6LTQ4a2JpdHJhdGUtbW9uby1tcDNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6NDhLQml0UmF0ZU1vbm9NcDNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8yNEtoejQ4S0JpdFJhdGVNb25vTXAzXCJdID0gNl0gPSBcIkF1ZGlvMjRLaHo0OEtCaXRSYXRlTW9ub01wM1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTI0a2h6LTk2a2JpdHJhdGUtbW9uby1tcDNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6OTZLQml0UmF0ZU1vbm9NcDNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8yNEtoejk2S0JpdFJhdGVNb25vTXAzXCJdID0gN10gPSBcIkF1ZGlvMjRLaHo5NktCaXRSYXRlTW9ub01wM1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTI0a2h6LTE2MGtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8yNEtoejE2MEtCaXRSYXRlTW9ub01wM1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzI0S2h6MTYwS0JpdFJhdGVNb25vTXAzXCJdID0gOF0gPSBcIkF1ZGlvMjRLaHoxNjBLQml0UmF0ZU1vbm9NcDNcIjtcbiAgICAvKipcbiAgICAgKiByYXctMTZraHotMTZiaXQtbW9uby10cnVlc2lsa1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzE2S2h6MTZCaXRNb25vVHJ1ZVNpbGtcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmF3MTZLaHoxNkJpdE1vbm9UcnVlU2lsa1wiXSA9IDldID0gXCJSYXcxNktoejE2Qml0TW9ub1RydWVTaWxrXCI7XG4gICAgLyoqXG4gICAgICogcmlmZi0xNmtoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmYxNktoejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmMTZLaHoxNkJpdE1vbm9QY21cIl0gPSAxMF0gPSBcIlJpZmYxNktoejE2Qml0TW9ub1BjbVwiO1xuICAgIC8qKlxuICAgICAqIHJpZmYtOGtoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJpZmY4S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJpZmY4S2h6MTZCaXRNb25vUGNtXCJdID0gMTFdID0gXCJSaWZmOEtoejE2Qml0TW9ub1BjbVwiO1xuICAgIC8qKlxuICAgICAqIHJpZmYtMjRraHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMjRLaHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjI0S2h6MTZCaXRNb25vUGNtXCJdID0gMTJdID0gXCJSaWZmMjRLaHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByaWZmLThraHotOGJpdC1tb25vLW11bGF3XG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmlmZjhLaHo4Qml0TW9ub01VTGF3XG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJpZmY4S2h6OEJpdE1vbm9NVUxhd1wiXSA9IDEzXSA9IFwiUmlmZjhLaHo4Qml0TW9ub01VTGF3XCI7XG4gICAgLyoqXG4gICAgICogcmF3LTE2a2h6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3MTZLaHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmF3MTZLaHoxNkJpdE1vbm9QY21cIl0gPSAxNF0gPSBcIlJhdzE2S2h6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogcmF3LTI0a2h6LTE2Yml0LW1vbm8tcGNtXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3MjRLaHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmF3MjRLaHoxNkJpdE1vbm9QY21cIl0gPSAxNV0gPSBcIlJhdzI0S2h6MTZCaXRNb25vUGNtXCI7XG4gICAgLyoqXG4gICAgICogcmF3LThraHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc4S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzhLaHoxNkJpdE1vbm9QY21cIl0gPSAxNl0gPSBcIlJhdzhLaHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiBvZ2ctMTZraHotMTZiaXQtbW9uby1vcHVzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuT2dnMTZLaHoxNkJpdE1vbm9PcHVzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIk9nZzE2S2h6MTZCaXRNb25vT3B1c1wiXSA9IDE3XSA9IFwiT2dnMTZLaHoxNkJpdE1vbm9PcHVzXCI7XG4gICAgLyoqXG4gICAgICogb2dnLTI0a2h6LTE2Yml0LW1vbm8tb3B1c1xuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0Lk9nZzI0S2h6MTZCaXRNb25vT3B1c1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJPZ2cyNEtoejE2Qml0TW9ub09wdXNcIl0gPSAxOF0gPSBcIk9nZzI0S2h6MTZCaXRNb25vT3B1c1wiO1xuICAgIC8qKlxuICAgICAqIHJhdy00OGtoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LlJhdzQ4S2h6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzQ4S2h6MTZCaXRNb25vUGNtXCJdID0gMTldID0gXCJSYXc0OEtoejE2Qml0TW9ub1BjbVwiO1xuICAgIC8qKlxuICAgICAqIHJpZmYtNDhraHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmNDhLaHoxNkJpdE1vbm9QY21cbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiUmlmZjQ4S2h6MTZCaXRNb25vUGNtXCJdID0gMjBdID0gXCJSaWZmNDhLaHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby00OGtoei05NmtiaXRyYXRlLW1vbm8tbXAzXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW80OEtoejk2S0JpdFJhdGVNb25vTXAzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvNDhLaHo5NktCaXRSYXRlTW9ub01wM1wiXSA9IDIxXSA9IFwiQXVkaW80OEtoejk2S0JpdFJhdGVNb25vTXAzXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tNDhraHotMTkya2JpdHJhdGUtbW9uby1tcDNcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzQ4S2h6MTkyS0JpdFJhdGVNb25vTXAzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvNDhLaHoxOTJLQml0UmF0ZU1vbm9NcDNcIl0gPSAyMl0gPSBcIkF1ZGlvNDhLaHoxOTJLQml0UmF0ZU1vbm9NcDNcIjtcbiAgICAvKipcbiAgICAgKiBvZ2ctNDhraHotMTZiaXQtbW9uby1vcHVzXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE2LjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5PZ2c0OEtoejE2Qml0TW9ub09wdXNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiT2dnNDhLaHoxNkJpdE1vbm9PcHVzXCJdID0gMjNdID0gXCJPZ2c0OEtoejE2Qml0TW9ub09wdXNcIjtcbiAgICAvKipcbiAgICAgKiB3ZWJtLTE2a2h6LTE2Yml0LW1vbm8tb3B1c1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNi4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuV2VibTE2S2h6MTZCaXRNb25vT3B1c1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJXZWJtMTZLaHoxNkJpdE1vbm9PcHVzXCJdID0gMjRdID0gXCJXZWJtMTZLaHoxNkJpdE1vbm9PcHVzXCI7XG4gICAgLyoqXG4gICAgICogd2VibS0yNGtoei0xNmJpdC1tb25vLW9wdXNcbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTYuMFxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LldlYm0yNEtoejE2Qml0TW9ub09wdXNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiV2VibTI0S2h6MTZCaXRNb25vT3B1c1wiXSA9IDI1XSA9IFwiV2VibTI0S2h6MTZCaXRNb25vT3B1c1wiO1xuICAgIC8qKlxuICAgICAqIHJhdy0yNGtoei0xNmJpdC1tb25vLXRydWVzaWxrXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE3LjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcyNEtoejE2Qml0TW9ub1RydWVTaWxrXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzI0S2h6MTZCaXRNb25vVHJ1ZVNpbGtcIl0gPSAyNl0gPSBcIlJhdzI0S2h6MTZCaXRNb25vVHJ1ZVNpbGtcIjtcbiAgICAvKipcbiAgICAgKiByYXctOGtoei04Yml0LW1vbm8tYWxhd1xuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4xNy4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuUmF3OEtoejhCaXRNb25vQUxhd1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSYXc4S2h6OEJpdE1vbm9BTGF3XCJdID0gMjddID0gXCJSYXc4S2h6OEJpdE1vbm9BTGF3XCI7XG4gICAgLyoqXG4gICAgICogcmlmZi04a2h6LThiaXQtbW9uby1hbGF3XG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE3LjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmOEtoejhCaXRNb25vQUxhd1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmOEtoejhCaXRNb25vQUxhd1wiXSA9IDI4XSA9IFwiUmlmZjhLaHo4Qml0TW9ub0FMYXdcIjtcbiAgICAvKipcbiAgICAgKiB3ZWJtLTI0a2h6LTE2Yml0LTI0a2Jwcy1tb25vLW9wdXNcbiAgICAgKiBBdWRpbyBjb21wcmVzc2VkIGJ5IE9QVVMgY29kZWMgaW4gYSB3ZWJtIGNvbnRhaW5lciwgd2l0aCBiaXRyYXRlIG9mIDI0a2Jwcywgb3B0aW1pemVkIGZvciBJb1Qgc2NlbmFyaW8uXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjE5LjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5XZWJtMjRLaHoxNkJpdDI0S2Jwc01vbm9PcHVzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIldlYm0yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNcIl0gPSAyOV0gPSBcIldlYm0yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNcIjtcbiAgICAvKipcbiAgICAgKiBhdWRpby0xNmtoei0xNmJpdC0zMmticHMtbW9uby1vcHVzXG4gICAgICogQXVkaW8gY29tcHJlc3NlZCBieSBPUFVTIGNvZGVjIHdpdGhvdXQgY29udGFpbmVyLCB3aXRoIGJpdHJhdGUgb2YgMzJrYnBzLlxuICAgICAqIEFkZGVkIGluIHZlcnNpb24gMS4yMC4wXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQuQXVkaW8xNktoejE2Qml0MzJLYnBzTW9ub09wdXNcbiAgICAgKi9cbiAgICBTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1wiQXVkaW8xNktoejE2Qml0MzJLYnBzTW9ub09wdXNcIl0gPSAzMF0gPSBcIkF1ZGlvMTZLaHoxNkJpdDMyS2Jwc01vbm9PcHVzXCI7XG4gICAgLyoqXG4gICAgICogYXVkaW8tMjRraHotMTZiaXQtNDhrYnBzLW1vbm8tb3B1c1xuICAgICAqIEF1ZGlvIGNvbXByZXNzZWQgYnkgT1BVUyBjb2RlYyB3aXRob3V0IGNvbnRhaW5lciwgd2l0aCBiaXRyYXRlIG9mIDQ4a2Jwcy5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjAuMFxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LkF1ZGlvMjRLaHoxNkJpdDQ4S2Jwc01vbm9PcHVzXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIkF1ZGlvMjRLaHoxNkJpdDQ4S2Jwc01vbm9PcHVzXCJdID0gMzFdID0gXCJBdWRpbzI0S2h6MTZCaXQ0OEticHNNb25vT3B1c1wiO1xuICAgIC8qKlxuICAgICAqIGF1ZGlvLTI0a2h6LTE2Yml0LTI0a2Jwcy1tb25vLW9wdXNcbiAgICAgKiBBdWRpbyBjb21wcmVzc2VkIGJ5IE9QVVMgY29kZWMgd2l0aG91dCBjb250YWluZXIsIHdpdGggYml0cmF0ZSBvZiAyNGticHMuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIwLjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5BdWRpbzI0S2h6MTZCaXQyNEticHNNb25vT3B1c1xuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJBdWRpbzI0S2h6MTZCaXQyNEticHNNb25vT3B1c1wiXSA9IDMyXSA9IFwiQXVkaW8yNEtoejE2Qml0MjRLYnBzTW9ub09wdXNcIjtcbiAgICAvKipcbiAgICAgKiByYXctMjIwNTBoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIFJhdyBQQ00gYXVkaW8gYXQgMjIwNTBIeiBzYW1wbGluZyByYXRlIGFuZCAxNi1iaXQgZGVwdGguXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIyLjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXcyMjA1MEh6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzIyMDUwSHoxNkJpdE1vbm9QY21cIl0gPSAzM10gPSBcIlJhdzIyMDUwSHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByaWZmLTIyMDUwaHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBQQ00gYXVkaW8gYXQgMjIwNTBIeiBzYW1wbGluZyByYXRlIGFuZCAxNi1iaXQgZGVwdGgsIHdpdGggUklGRiBoZWFkZXIuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIyLjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmMjIwNTBIejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmMjIwNTBIejE2Qml0TW9ub1BjbVwiXSA9IDM0XSA9IFwiUmlmZjIyMDUwSHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByYXctNDQxMDBoei0xNmJpdC1tb25vLXBjbVxuICAgICAqIFJhdyBQQ00gYXVkaW8gYXQgNDQxMDBIeiBzYW1wbGluZyByYXRlIGFuZCAxNi1iaXQgZGVwdGguXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIyLjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SYXc0NDEwMEh6MTZCaXRNb25vUGNtXG4gICAgICovXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W1NwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtcIlJhdzQ0MTAwSHoxNkJpdE1vbm9QY21cIl0gPSAzNV0gPSBcIlJhdzQ0MTAwSHoxNkJpdE1vbm9QY21cIjtcbiAgICAvKipcbiAgICAgKiByaWZmLTQ0MTAwaHotMTZiaXQtbW9uby1wY21cbiAgICAgKiBQQ00gYXVkaW8gYXQgNDQxMDBIeiBzYW1wbGluZyByYXRlIGFuZCAxNi1iaXQgZGVwdGgsIHdpdGggUklGRiBoZWFkZXIuXG4gICAgICogQWRkZWQgaW4gdmVyc2lvbiAxLjIyLjBcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdC5SaWZmNDQxMDBIejE2Qml0TW9ub1BjbVxuICAgICAqL1xuICAgIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdFtTcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXRbXCJSaWZmNDQxMDBIejE2Qml0TW9ub1BjbVwiXSA9IDM2XSA9IFwiUmlmZjQ0MTAwSHoxNkJpdE1vbm9QY21cIjtcbn0pKFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCB8fCAoU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0ID0ge30pKTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBTeW50aGVzaXNSZXN1bHQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgcmVzdWx0IG9mIHNwZWVjaCBzeW50aGVzaXMuXG4gKiBAY2xhc3MgU3BlZWNoU3ludGhlc2lzUmVzdWx0XG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMTEuMFxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoU3ludGhlc2lzUmVzdWx0IGV4dGVuZHMgU3ludGhlc2lzUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZXN1bHRJZCAtIFRoZSByZXN1bHQgaWQuXG4gICAgICogQHBhcmFtIHtSZXN1bHRSZWFzb259IHJlYXNvbiAtIFRoZSByZWFzb24uXG4gICAgICogQHBhcmFtIHtBcnJheUJ1ZmZlcn0gYXVkaW9EYXRhIC0gVGhlIHN5bnRoZXNpemVkIGF1ZGlvIGJpbmFyeS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUNvbGxlY3Rpb259IHByb3BlcnRpZXMgLSBBZGRpdGlvbmFsIHByb3BlcnRpZXMsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdWRpb0R1cmF0aW9uIC0gVGhlIGF1ZGlvIGR1cmF0aW9uLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdElkLCByZWFzb24sIGF1ZGlvRGF0YSwgZXJyb3JEZXRhaWxzLCBwcm9wZXJ0aWVzLCBhdWRpb0R1cmF0aW9uKSB7XG4gICAgICAgIHN1cGVyKHJlc3VsdElkLCByZWFzb24sIGVycm9yRGV0YWlscywgcHJvcGVydGllcyk7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvRGF0YSA9IGF1ZGlvRGF0YTtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9EdXJhdGlvbiA9IGF1ZGlvRHVyYXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzeW50aGVzaXplZCBhdWRpbyBkYXRhXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNSZXN1bHQucHJvdG90eXBlLmF1ZGlvRGF0YVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7QXJyYXlCdWZmZXJ9IFRoZSBzeW50aGVzaXplZCBhdWRpbyBkYXRhLlxuICAgICAqL1xuICAgIGdldCBhdWRpb0RhdGEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb0RhdGE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSB0aW1lIGR1cmF0aW9uIG9mIHN5bnRoZXNpemVkIGF1ZGlvLCBpbiB0aWNrcyAoMTAwIG5hbm9zZWNvbmRzKS5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1Jlc3VsdC5wcm90b3R5cGUuYXVkaW9EdXJhdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBUaGUgdGltZSBkdXJhdGlvbiBvZiBzeW50aGVzaXplZCBhdWRpby5cbiAgICAgKi9cbiAgICBnZXQgYXVkaW9EdXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkF1ZGlvRHVyYXRpb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TcGVlY2hTeW50aGVzaXNSZXN1bHQuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lcyBjb250ZW50cyBvZiBzcGVlY2ggc3ludGhlc2lzIHZpc2VtZSBldmVudC5cbiAqIEBjbGFzcyBTcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3NcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xNi4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGF1ZGlvT2Zmc2V0IC0gVGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmlzZW1lSWQgLSBUaGUgdmlzZW1lIElELlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhbmltYXRpb24gLSBUaGUgYW5pbWF0aW9uLCBjb3VsZCBiZSBpbiBzdmcgb3Igb3RoZXIgZm9ybWF0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvT2Zmc2V0LCB2aXNlbWVJZCwgYW5pbWF0aW9uKSB7XG4gICAgICAgIHRoaXMucHJpdkF1ZGlvT2Zmc2V0ID0gYXVkaW9PZmZzZXQ7XG4gICAgICAgIHRoaXMucHJpdlZpc2VtZUlkID0gdmlzZW1lSWQ7XG4gICAgICAgIHRoaXMucHJpdkFuaW1hdGlvbiA9IGFuaW1hdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNWaXNlbWVFdmVudEFyZ3MucHJvdG90eXBlLmF1ZGlvT2Zmc2V0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSBhdWRpbyBvZmZzZXQuXG4gICAgICovXG4gICAgZ2V0IGF1ZGlvT2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXVkaW9PZmZzZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgdmlzZW1lIElELlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzVmlzZW1lRXZlbnRBcmdzLnByb3RvdHlwZS52aXNlbWVJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgdmlzZW1lIElELlxuICAgICAqL1xuICAgIGdldCB2aXNlbWVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZpc2VtZUlkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGFuaW1hdGlvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1Zpc2VtZUV2ZW50QXJncy5wcm90b3R5cGUuYW5pbWF0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHRoZSBhbmltYXRpb24sIGNvdWxkIGJlIGluIHN2ZyBvciBvdGhlciBmb3JtYXQuXG4gICAgICovXG4gICAgZ2V0IGFuaW1hdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFuaW1hdGlvbjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpc1Zpc2VtZUV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnRzIG9mIHNwZWVjaCBzeW50aGVzaXMgd29yZCBib3VuZGFyeSBldmVudC5cbiAqIEBjbGFzcyBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3NcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4xMS4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGF1ZGlvT2Zmc2V0IC0gVGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb24gLSBUaGUgYXVkaW8gZHVyYXRpb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgLSBUaGUgdGV4dC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd29yZExlbmd0aCAtIFRoZSBsZW5ndGggb2YgdGhlIHdvcmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRleHRPZmZzZXQgLSBUaGUgdGV4dCBvZmZzZXQuXG4gICAgICogQHBhcmFtIHtTcGVlY2hTeW50aGVzaXNCb3VuZGFyeVR5cGV9IGJvdW5kYXJ5VHlwZSAtIFRoZSBib3VuZGFyeSB0eXBlXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXVkaW9PZmZzZXQsIGR1cmF0aW9uLCB0ZXh0LCB3b3JkTGVuZ3RoLCB0ZXh0T2Zmc2V0LCBib3VuZGFyeVR5cGUpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9PZmZzZXQgPSBhdWRpb09mZnNldDtcbiAgICAgICAgdGhpcy5wcml2RHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgdGhpcy5wcml2VGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMucHJpdldvcmRMZW5ndGggPSB3b3JkTGVuZ3RoO1xuICAgICAgICB0aGlzLnByaXZUZXh0T2Zmc2V0ID0gdGV4dE9mZnNldDtcbiAgICAgICAgdGhpcy5wcml2Qm91bmRhcnlUeXBlID0gYm91bmRhcnlUeXBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1dvcmRCb3VuZGFyeUV2ZW50QXJncy5wcm90b3R5cGUuYXVkaW9PZmZzZXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIGF1ZGlvIG9mZnNldC5cbiAgICAgKi9cbiAgICBnZXQgYXVkaW9PZmZzZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpb09mZnNldDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBkdXJhdGlvbiwgaW4gdGlja3MgKDEwMCBuYW5vc2Vjb25kcykuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MucHJvdG90eXBlLmR1cmF0aW9uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IER1cmF0aW9uIGluIDEwMCBuYW5vc2Vjb25kIGluY3JlbWVudHMuXG4gICAgICovXG4gICAgZ2V0IGR1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RHVyYXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgdGV4dCBvZiB0aGUgd29yZCBib3VuZGFyeSBldmVudC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1dvcmRCb3VuZGFyeUV2ZW50QXJncy5wcm90b3R5cGUudGV4dFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0aGUgdGV4dC5cbiAgICAgKi9cbiAgICBnZXQgdGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlRleHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgd29yZCBsZW5ndGhcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpc1dvcmRCb3VuZGFyeUV2ZW50QXJncy5wcm90b3R5cGUud29yZExlbmd0aFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSB0aGUgd29yZCBsZW5ndGhcbiAgICAgKi9cbiAgICBnZXQgd29yZExlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdldvcmRMZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgdGV4dCBvZmZzZXQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXNXb3JkQm91bmRhcnlFdmVudEFyZ3MucHJvdG90eXBlLnRleHRPZmZzZXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge251bWJlcn0gdGhlIHRleHQgb2Zmc2V0LlxuICAgICAqL1xuICAgIGdldCB0ZXh0T2Zmc2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VGV4dE9mZnNldDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBib3VuZGFyeSB0eXBlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2lzV29yZEJvdW5kYXJ5RXZlbnRBcmdzLnByb3RvdHlwZS5ib3VuZGFyeVR5cGVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1NwZWVjaFN5bnRoZXNpc0JvdW5kYXJ5VHlwZX0gdGhlIGJvdW5kYXJ5IHR5cGUuXG4gICAgICovXG4gICAgZ2V0IGJvdW5kYXJ5VHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkJvdW5kYXJ5VHlwZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpc1dvcmRCb3VuZGFyeUV2ZW50QXJncy5qcy5tYXBcbiIsIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbiAqL1xuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IEF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZXNPcGVuUmFuZ2VPcHRpb25OYW1lLCBDb2duaXRpdmVTdWJzY3JpcHRpb25LZXlBdXRoZW50aWNhdGlvbiwgQ29nbml0aXZlVG9rZW5BdXRoZW50aWNhdGlvbiwgQ29udGV4dCwgT1MsIFNwZWVjaFNlcnZpY2VDb25maWcsIFNwZWVjaFN5bnRoZXNpc0Nvbm5lY3Rpb25GYWN0b3J5LCBTeW50aGVzaXNBZGFwdGVyQmFzZSwgU3ludGhlc2lzUmVzdEFkYXB0ZXIsIFN5bnRoZXNpemVyQ29uZmlnLCB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IGNyZWF0ZU5vRGFzaEd1aWQsIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MsIFF1ZXVlIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb0ZpbGVXcml0ZXIgfSBmcm9tIFwiLi9BdWRpby9BdWRpb0ZpbGVXcml0ZXJcIjtcbmltcG9ydCB7IEF1ZGlvT3V0cHV0Rm9ybWF0SW1wbCB9IGZyb20gXCIuL0F1ZGlvL0F1ZGlvT3V0cHV0Rm9ybWF0XCI7XG5pbXBvcnQgeyBQdXNoQXVkaW9PdXRwdXRTdHJlYW1JbXBsIH0gZnJvbSBcIi4vQXVkaW8vQXVkaW9PdXRwdXRTdHJlYW1cIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgQXVkaW9Db25maWcsIFByb3BlcnR5SWQsIFB1bGxBdWRpb091dHB1dFN0cmVhbSwgUHVzaEF1ZGlvT3V0cHV0U3RyZWFtQ2FsbGJhY2ssIFNwZWVjaFN5bnRoZXNpc091dHB1dEZvcm1hdCwgU3ludGhlc2lzVm9pY2VzUmVzdWx0LCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogRGVmaW5lcyB0aGUgY2xhc3MgU3BlZWNoU3ludGhlc2l6ZXIgZm9yIHRleHQgdG8gc3BlZWNoLlxuICogVXBkYXRlZCBpbiB2ZXJzaW9uIDEuMTYuMFxuICogQGNsYXNzIFNwZWVjaFN5bnRoZXNpemVyXG4gKi9cbmV4cG9ydCBjbGFzcyBTcGVlY2hTeW50aGVzaXplciB7XG4gICAgLyoqXG4gICAgICogU3BlZWNoU3ludGhlc2l6ZXIgY29uc3RydWN0b3IuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtTcGVlY2hDb25maWd9IHNwZWVjaENvbmZpZyAtIEFuIHNldCBvZiBpbml0aWFsIHByb3BlcnRpZXMgZm9yIHRoaXMgc3ludGhlc2l6ZXIuXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgc3ludGhlc2l6ZXIuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3BlZWNoQ29uZmlnLCBhdWRpb0NvbmZpZykge1xuICAgICAgICBjb25zdCBzcGVlY2hDb25maWdJbXBsID0gc3BlZWNoQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoc3BlZWNoQ29uZmlnSW1wbCwgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIGlmIChhdWRpb0NvbmZpZyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKGF1ZGlvQ29uZmlnID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvQ29uZmlnID0gKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpID8gdW5kZWZpbmVkIDogQXVkaW9Db25maWcuZnJvbURlZmF1bHRTcGVha2VyT3V0cHV0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvQ29uZmlnID0gYXVkaW9Db25maWc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IHNwZWVjaENvbmZpZ0ltcGwucHJvcGVydGllcy5jbG9uZSgpO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZTeW50aGVzaXppbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2Q29ubmVjdGlvbkZhY3RvcnkgPSBuZXcgU3BlZWNoU3ludGhlc2lzQ29ubmVjdGlvbkZhY3RvcnkoKTtcbiAgICAgICAgdGhpcy5zeW50aGVzaXNSZXF1ZXN0UXVldWUgPSBuZXcgUXVldWUoKTtcbiAgICAgICAgdGhpcy5pbXBsQ29tbW9uU3ludGhlc2l6ZVNldHVwKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gdXNlZCB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBzZXJ2aWNlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2l6ZXIucHJvdG90eXBlLmF1dGhvcml6YXRpb25Ub2tlblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIGdldCBhdXRob3JpemF0aW9uVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlbiAtIEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih0b2tlbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB0b2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFNwZWVjaFN5bnRoZXNpemVyLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2l6ZXIucHJvdG90eXBlLnByb3BlcnRpZXNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1Byb3BlcnR5Q29sbGVjdGlvbn0gVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgU3BlZWNoU3ludGhlc2l6ZXIuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgaWYgYXV0byBkZXRlY3Qgc291cmNlIGxhbmd1YWdlIGlzIGVuYWJsZWRcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpemVyLnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBpZiBhdXRvIGRldGVjdCBzb3VyY2UgbGFuZ3VhZ2UgaXMgZW5hYmxlZFxuICAgICAqL1xuICAgIGdldCBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9BdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VzKSA9PT0gQXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlc09wZW5SYW5nZU9wdGlvbk5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWVjaFN5bnRoZXNpemVyIGNvbnN0cnVjdG9yLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7U3BlZWNoQ29uZmlnfSBzcGVlY2hDb25maWcgLSBhbiBzZXQgb2YgaW5pdGlhbCBwcm9wZXJ0aWVzIGZvciB0aGlzIHN5bnRoZXNpemVyXG4gICAgICogQHBhcmFtIHtBdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWd9IGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZyAtIEFuIHNvdXJjZSBsYW5ndWFnZSBkZXRlY3Rpb24gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHN5bnRoZXNpemVyXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgc3ludGhlc2l6ZXJcbiAgICAgKi9cbiAgICBzdGF0aWMgRnJvbUNvbmZpZyhzcGVlY2hDb25maWcsIGF1dG9EZXRlY3RTb3VyY2VMYW5ndWFnZUNvbmZpZywgYXVkaW9Db25maWcpIHtcbiAgICAgICAgY29uc3Qgc3BlZWNoQ29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgYXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnLnByb3BlcnRpZXMubWVyZ2VUbyhzcGVlY2hDb25maWdJbXBsLnByb3BlcnRpZXMpO1xuICAgICAgICByZXR1cm4gbmV3IFNwZWVjaFN5bnRoZXNpemVyKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcpO1xuICAgIH1cbiAgICBidWlsZFNzbWwodGV4dCkge1xuICAgICAgICBjb25zdCBsYW5ndWFnZVRvRGVmYXVsdFZvaWNlID0ge1xuICAgICAgICAgICAgW1wiYWYtWkFcIl06IFwiYWYtWkEtQWRyaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYW0tRVRcIl06IFwiYW0tRVQtQW1laGFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUFFXCJdOiBcImFyLUFFLUZhdGltYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItQkhcIl06IFwiYXItQkgtQWxpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1EWlwiXTogXCJhci1EWi1BbWluYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItRUdcIl06IFwiYXItRUctU2FsbWFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUlRXCJdOiBcImFyLUlRLUJhc3NlbE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItSk9cIl06IFwiYXItSk8tU2FuYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItS1dcIl06IFwiYXItS1ctRmFoZWROZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLUxZXCJdOiBcImFyLUxZLUltYW5OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLU1BXCJdOiBcImFyLU1BLUphbWFsTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1RQVwiXTogXCJhci1RQS1BbWFsTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJhci1TQVwiXTogXCJhci1TQS1IYW1lZE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYXItU1lcIl06IFwiYXItU1ktQW1hbnlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLVROXCJdOiBcImFyLVROLUhlZGlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImFyLVlFXCJdOiBcImFyLVlFLU1hcnlhbU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiYmctQkdcIl06IFwiYmctQkctQm9yaXNsYXZOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImJuLUJEXCJdOiBcImJuLUJELU5hYmFuaXRhTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJibi1JTlwiXTogXCJibi1JTi1CYXNoa2FyTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJjYS1FU1wiXTogXCJjYS1FUy1Kb2FuYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiY3MtQ1pcIl06IFwiY3MtQ1otQW50b25pbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiY3ktR0JcIl06IFwiY3ktR0ItQWxlZE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZGEtREtcIl06IFwiZGEtREstQ2hyaXN0ZWxOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImRlLUFUXCJdOiBcImRlLUFULUluZ3JpZE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZGUtQ0hcIl06IFwiZGUtQ0gtSmFuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJkZS1ERVwiXTogXCJkZS1ERS1LYXRqYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZWwtR1JcIl06IFwiZWwtR1ItQXRoaW5hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1BVVwiXTogXCJlbi1BVS1OYXRhc2hhTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1DQVwiXTogXCJlbi1DQS1DbGFyYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tR0JcIl06IFwiZW4tR0ItTGliYnlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLUhLXCJdOiBcImVuLUhLLVNhbU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tSUVcIl06IFwiZW4tSUUtQ29ubm9yTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1JTlwiXTogXCJlbi1JTi1OZWVyamFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLUtFXCJdOiBcImVuLUtFLUFzaWxpYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tTkdcIl06IFwiZW4tTkctQWJlb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tTlpcIl06IFwiZW4tTlotTWl0Y2hlbGxOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLVBIXCJdOiBcImVuLVBILUphbWVzTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1TR1wiXTogXCJlbi1TRy1MdW5hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlbi1UWlwiXTogXCJlbi1UWi1FbGltdU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZW4tVVNcIl06IFwiZW4tVVMtSmVubnlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVuLVpBXCJdOiBcImVuLVpBLUxlYWhOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUFSXCJdOiBcImVzLUFSLUVsZW5hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1CT1wiXTogXCJlcy1CTy1NYXJjZWxvTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1DTFwiXTogXCJlcy1DTC1DYXRhbGluYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtQ09cIl06IFwiZXMtQ08tR29uemFsb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtQ1JcIl06IFwiZXMtQ1ItSnVhbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtQ1VcIl06IFwiZXMtQ1UtQmVsa3lzTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1ET1wiXTogXCJlcy1ETy1FbWlsaW9OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUVDXCJdOiBcImVzLUVDLUFuZHJlYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtRVNcIl06IFwiZXMtRVMtQWx2YXJvTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1HUVwiXTogXCJlcy1HUS1KYXZpZXJOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLUdUXCJdOiBcImVzLUdULUFuZHJlc05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtSE5cIl06IFwiZXMtSE4tQ2FybG9zTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1NWFwiXTogXCJlcy1NWC1EYWxpYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtTklcIl06IFwiZXMtTkktRmVkZXJpY29OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLVBBXCJdOiBcImVzLVBBLU1hcmdhcml0YU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtUEVcIl06IFwiZXMtUEUtQWxleE5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtUFJcIl06IFwiZXMtUFItS2FyaW5hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1QWVwiXTogXCJlcy1QWS1NYXJpb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXMtU1ZcIl06IFwiZXMtU1YtTG9yZW5hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1VU1wiXTogXCJlcy1VUy1BbG9uc29OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImVzLVVZXCJdOiBcImVzLVVZLU1hdGVvTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJlcy1WRVwiXTogXCJlcy1WRS1QYW9sYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZXQtRUVcIl06IFwiZXQtRUUtQW51TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJmYS1JUlwiXTogXCJmYS1JUi1EaWxhcmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImZpLUZJXCJdOiBcImZpLUZJLVNlbG1hTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJmaWwtUEhcIl06IFwiZmlsLVBILUFuZ2Vsb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZnItQkVcIl06IFwiZnItQkUtQ2hhcmxpbmVOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImZyLUNBXCJdOiBcImZyLUNBLVN5bHZpZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZnItQ0hcIl06IFwiZnItQ0gtQXJpYW5lTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJmci1GUlwiXTogXCJmci1GUi1EZW5pc2VOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImdhLUlFXCJdOiBcImdhLUlFLUNvbG1OZXVyYWxcIixcbiAgICAgICAgICAgIFtcImdsLUVTXCJdOiBcImdsLUVTLVJvaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiZ3UtSU5cIl06IFwiZ3UtSU4tRGh3YW5pTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJoZS1JTFwiXTogXCJoZS1JTC1BdnJpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJoaS1JTlwiXTogXCJoaS1JTi1NYWRodXJOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImhyLUhSXCJdOiBcImhyLUhSLUdhYnJpamVsYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiaHUtSFVcIl06IFwiaHUtSFUtTm9lbWlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImlkLUlEXCJdOiBcImlkLUlELUFyZGlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImlzLUlTXCJdOiBcImlzLUlTLUd1ZHJ1bk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiaXQtSVRcIl06IFwiaXQtSVQtSXNhYmVsbGFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImphLUpQXCJdOiBcImphLUpQLU5hbmFtaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wianYtSURcIl06IFwianYtSUQtRGltYXNOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImtrLUtaXCJdOiBcImtrLUtaLUFpZ3VsTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJrbS1LSFwiXTogXCJrbS1LSC1QaXNldGhOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImtuLUlOXCJdOiBcImtuLUlOLUdhZ2FuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJrby1LUlwiXTogXCJrby1LUi1TdW5IaU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibG8tTEFcIl06IFwibG8tTEEtQ2hhbnRoYXZvbmdOZXVyYWxcIixcbiAgICAgICAgICAgIFtcImx0LUxUXCJdOiBcImx0LUxULUxlb25hc05ldXJhbFwiLFxuICAgICAgICAgICAgW1wibHYtTFZcIl06IFwibHYtTFYtRXZlcml0YU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibWstTUtcIl06IFwibWstTUstQWxla3NhbmRhck5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibWwtSU5cIl06IFwibWwtSU4tTWlkaHVuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJtci1JTlwiXTogXCJtci1JTi1BYXJvaGlOZXVyYWxcIixcbiAgICAgICAgICAgIFtcIm1zLU1ZXCJdOiBcIm1zLU1ZLU9zbWFuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJtdC1NVFwiXTogXCJtdC1NVC1HcmFjZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wibXktTU1cIl06IFwibXktTU0tTmlsYXJOZXVyYWxcIixcbiAgICAgICAgICAgIFtcIm5iLU5PXCJdOiBcIm5iLU5PLVBlcm5pbGxlTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJubC1CRVwiXTogXCJubC1CRS1Bcm5hdWROZXVyYWxcIixcbiAgICAgICAgICAgIFtcIm5sLU5MXCJdOiBcIm5sLU5MLUNvbGV0dGVOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInBsLVBMXCJdOiBcInBsLVBMLUFnbmllc3prYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wicHMtQUZcIl06IFwicHMtQUYtR3VsTmF3YXpOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInB0LUJSXCJdOiBcInB0LUJSLUZyYW5jaXNjYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wicHQtUFRcIl06IFwicHQtUFQtRHVhcnRlTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJyby1ST1wiXTogXCJyby1STy1BbGluYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wicnUtUlVcIl06IFwicnUtUlUtU3ZldGxhbmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInNpLUxLXCJdOiBcInNpLUxLLVNhbWVlcmFOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInNrLVNLXCJdOiBcInNrLVNLLUx1a2FzTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzbC1TSVwiXTogXCJzbC1TSS1QZXRyYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1wic28tU09cIl06IFwic28tU08tTXV1c2VOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInNyLVJTXCJdOiBcInNyLVJTLU5pY2hvbGFzTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzdS1JRFwiXTogXCJzdS1JRC1KYWphbmdOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInN2LVNFXCJdOiBcInN2LVNFLVNvZmllTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJzdy1LRVwiXTogXCJzdy1LRS1SYWZpa2lOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInN3LVRaXCJdOiBcInN3LVRaLURhdWRpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ0YS1JTlwiXTogXCJ0YS1JTi1QYWxsYXZpTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ0YS1MS1wiXTogXCJ0YS1MSy1LdW1hck5ldXJhbFwiLFxuICAgICAgICAgICAgW1widGEtU0dcIl06IFwidGEtU0ctQW5idU5ldXJhbFwiLFxuICAgICAgICAgICAgW1widGUtSU5cIl06IFwidGUtSU4tTW9oYW5OZXVyYWxcIixcbiAgICAgICAgICAgIFtcInRoLVRIXCJdOiBcInRoLVRILVByZW13YWRlZU5ldXJhbFwiLFxuICAgICAgICAgICAgW1widHItVFJcIl06IFwidHItVFItQWhtZXROZXVyYWxcIixcbiAgICAgICAgICAgIFtcInVrLVVBXCJdOiBcInVrLVVBLU9zdGFwTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ1ci1JTlwiXTogXCJ1ci1JTi1HdWxOZXVyYWxcIixcbiAgICAgICAgICAgIFtcInVyLVBLXCJdOiBcInVyLVBLLUFzYWROZXVyYWxcIixcbiAgICAgICAgICAgIFtcInV6LVVaXCJdOiBcInV6LVVaLU1hZGluYU5ldXJhbFwiLFxuICAgICAgICAgICAgW1widmktVk5cIl06IFwidmktVk4tSG9haU15TmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ6aC1DTlwiXTogXCJ6aC1DTi1YaWFveGlhb05ldXJhbFwiLFxuICAgICAgICAgICAgW1wiemgtSEtcIl06IFwiemgtSEstSGl1TWFhbk5ldXJhbFwiLFxuICAgICAgICAgICAgW1wiemgtVFdcIl06IFwiemgtVFctSHNpYW9DaGVuTmV1cmFsXCIsXG4gICAgICAgICAgICBbXCJ6dS1aQVwiXTogXCJ6dS1aQS1UaGFuZG9OZXVyYWxcIixcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IGxhbmd1YWdlID0gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhMYW5ndWFnZSwgXCJlbi1VU1wiKTtcbiAgICAgICAgbGV0IHZvaWNlID0gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhWb2ljZSwgXCJcIik7XG4gICAgICAgIGxldCBzc21sID0gU3BlZWNoU3ludGhlc2l6ZXIuWE1MRW5jb2RlKHRleHQpO1xuICAgICAgICBpZiAodGhpcy5hdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIGxhbmd1YWdlID0gXCJlbi1VU1wiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdm9pY2UgPSB2b2ljZSB8fCBsYW5ndWFnZVRvRGVmYXVsdFZvaWNlW2xhbmd1YWdlXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodm9pY2UpIHtcbiAgICAgICAgICAgIHNzbWwgPSBgPHZvaWNlIG5hbWU9JyR7dm9pY2V9Jz4ke3NzbWx9PC92b2ljZT5gO1xuICAgICAgICB9XG4gICAgICAgIHNzbWwgPSBgPHNwZWFrIHZlcnNpb249JzEuMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAvc3ludGhlc2lzJyB4bWxuczptc3R0cz0naHR0cDovL3d3dy53My5vcmcvMjAwMS9tc3R0cycgeG1sbnM6ZW1vPSdodHRwOi8vd3d3LnczLm9yZy8yMDA5LzEwL2Vtb3Rpb25tbCcgeG1sOmxhbmc9JyR7bGFuZ3VhZ2V9Jz4ke3NzbWx9PC9zcGVhaz5gO1xuICAgICAgICByZXR1cm4gc3NtbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXhlY3V0ZXMgc3BlZWNoIHN5bnRoZXNpcyBvbiBwbGFpbiB0ZXh0LlxuICAgICAqIFRoZSB0YXNrIHJldHVybnMgdGhlIHN5bnRoZXNpcyByZXN1bHQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXplci5wcm90b3R5cGUuc3BlYWtUZXh0QXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHRleHQgLSBUZXh0IHRvIGJlIHN5bnRoZXNpemVkLlxuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIHRoYXQgcmVjZWl2ZWQgdGhlIFNwZWVjaFN5bnRoZXNpc1Jlc3VsdC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqIEBwYXJhbSBzdHJlYW0gLSBBdWRpb091dHB1dFN0cmVhbSB0byByZWNlaXZlIHRoZSBzeW50aGVzaXplZCBhdWRpby5cbiAgICAgKi9cbiAgICBzcGVha1RleHRBc3luYyh0ZXh0LCBjYiwgZXJyLCBzdHJlYW0pIHtcbiAgICAgICAgdGhpcy5zcGVha0ltcGwodGV4dCwgZmFsc2UsIGNiLCBlcnIsIHN0cmVhbSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGVzIHNwZWVjaCBzeW50aGVzaXMgb24gU1NNTC5cbiAgICAgKiBUaGUgdGFzayByZXR1cm5zIHRoZSBzeW50aGVzaXMgcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgU3BlZWNoU3ludGhlc2l6ZXIucHJvdG90eXBlLnNwZWFrU3NtbEFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBzc21sIC0gU1NNTCB0byBiZSBzeW50aGVzaXplZC5cbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSBTcGVlY2hTeW50aGVzaXNSZXN1bHQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKiBAcGFyYW0gc3RyZWFtIC0gQXVkaW9PdXRwdXRTdHJlYW0gdG8gcmVjZWl2ZSB0aGUgc3ludGhlc2l6ZWQgYXVkaW8uXG4gICAgICovXG4gICAgc3BlYWtTc21sQXN5bmMoc3NtbCwgY2IsIGVyciwgc3RyZWFtKSB7XG4gICAgICAgIHRoaXMuc3BlYWtJbXBsKHNzbWwsIHRydWUsIGNiLCBlcnIsIHN0cmVhbSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBsaXN0IG9mIHN5bnRoZXNpcyB2b2ljZXMgYXZhaWxhYmxlLlxuICAgICAqIFRoZSB0YXNrIHJldHVybnMgdGhlIHN5bnRoZXNpcyB2b2ljZSByZXN1bHQuXG4gICAgICogQG1lbWJlciBTcGVlY2hTeW50aGVzaXplci5wcm90b3R5cGUuZ2V0Vm9pY2VzQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGxvY2FsZSAtIExvY2FsZSBvZiB2b2ljZXMgaW4gQkNQLTQ3IGZvcm1hdDsgaWYgbGVmdCBlbXB0eSwgZ2V0IGFsbCBhdmFpbGFibGUgdm9pY2VzLlxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8U3ludGhlc2lzVm9pY2VzUmVzdWx0Pn0gLSBQcm9taXNlIG9mIGEgU3ludGhlc2lzVm9pY2VzUmVzdWx0LlxuICAgICAqL1xuICAgIGdldFZvaWNlc0FzeW5jKGxvY2FsZSA9IFwiXCIpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFZvaWNlcyhsb2NhbGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGlzcG9zZSBvZiBhc3NvY2lhdGVkIHJlc291cmNlcy5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpemVyLnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZShjYiwgZXJyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWQpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGlzcG9zZSh0cnVlKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBJbnRlcm5hbFxuICAgICAqIERvIG5vdCB1c2UgZXh0ZXJuYWxseSwgb2JqZWN0IHJldHVybmVkIHdpbGwgY2hhbmdlIHdpdGhvdXQgd2FybmluZyBvciBub3RpY2UuXG4gICAgICovXG4gICAgZ2V0IGludGVybmFsRGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFkYXB0ZXI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHBlcmZvcm1zIGNsZWFudXAgb2YgcmVzb3VyY2VzLlxuICAgICAqIFRoZSBCb29sZWFuIHBhcmFtZXRlciBkaXNwb3NpbmcgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIG1ldGhvZCBpcyBjYWxsZWRcbiAgICAgKiBmcm9tIERpc3Bvc2UgKGlmIGRpc3Bvc2luZyBpcyB0cnVlKSBvciBmcm9tIHRoZSBmaW5hbGl6ZXIgKGlmIGRpc3Bvc2luZyBpcyBmYWxzZSkuXG4gICAgICogRGVyaXZlZCBjbGFzc2VzIHNob3VsZCBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBkaXNwb3NlIHJlc291cmNlIGlmIG5lZWRlZC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFN5bnRoZXNpemVyLnByb3RvdHlwZS5kaXNwb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzcG9zaW5nIC0gRmxhZyB0byByZXF1ZXN0IGRpc3Bvc2FsLlxuICAgICAqL1xuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcml2RGlzcG9zZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlzcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJpdkFkYXB0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2QWRhcHRlci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy9cbiAgICAvLyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXG4gICAgLy8gSU1QTEVNRU5UQVRJT04uXG4gICAgLy8gTW92ZSB0byBpbmRlcGVuZGVudCBjbGFzc1xuICAgIC8vICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcbiAgICAvL1xuICAgIGNyZWF0ZVN5bnRoZXNpemVyQ29uZmlnKHNwZWVjaENvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFN5bnRoZXNpemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcml2UHJvcGVydGllcyk7XG4gICAgfVxuICAgIC8vIENyZWF0ZXMgdGhlIHN5bnRoZXNpcyBhZGFwdGVyXG4gICAgY3JlYXRlU3ludGhlc2lzQWRhcHRlcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvQ29uZmlnLCBzeW50aGVzaXplckNvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFN5bnRoZXNpc0FkYXB0ZXJCYXNlKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgc3ludGhlc2l6ZXJDb25maWcsIHRoaXMsIHRoaXMuYXVkaW9Db25maWcpO1xuICAgIH1cbiAgICBpbXBsQ29tbW9uU3ludGhlc2l6ZVNldHVwKCkge1xuICAgICAgICBsZXQgb3NQbGF0Zm9ybSA9ICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSA/IFwiQnJvd3NlclwiIDogXCJOb2RlXCI7XG4gICAgICAgIGxldCBvc05hbWUgPSBcInVua25vd25cIjtcbiAgICAgICAgbGV0IG9zVmVyc2lvbiA9IFwidW5rbm93blwiO1xuICAgICAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgb3NQbGF0Zm9ybSA9IG9zUGxhdGZvcm0gKyBcIi9cIiArIG5hdmlnYXRvci5wbGF0Zm9ybTtcbiAgICAgICAgICAgIG9zTmFtZSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7XG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBuYXZpZ2F0b3IuYXBwVmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzeW50aGVzaXplckNvbmZpZyA9IHRoaXMuY3JlYXRlU3ludGhlc2l6ZXJDb25maWcobmV3IFNwZWVjaFNlcnZpY2VDb25maWcobmV3IENvbnRleHQobmV3IE9TKG9zUGxhdGZvcm0sIG9zTmFtZSwgb3NWZXJzaW9uKSkpKTtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uS2V5ID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgdW5kZWZpbmVkKTtcbiAgICAgICAgY29uc3QgYXV0aGVudGljYXRpb24gPSAoc3Vic2NyaXB0aW9uS2V5ICYmIHN1YnNjcmlwdGlvbktleSAhPT0gXCJcIikgP1xuICAgICAgICAgICAgbmV3IENvZ25pdGl2ZVN1YnNjcmlwdGlvbktleUF1dGhlbnRpY2F0aW9uKHN1YnNjcmlwdGlvbktleSkgOlxuICAgICAgICAgICAgbmV3IENvZ25pdGl2ZVRva2VuQXV0aGVudGljYXRpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml6YXRpb25Ub2tlbiA9IHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXV0aG9yaXphdGlvblRva2VuID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYXV0aG9yaXphdGlvblRva2VuKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByaXZBZGFwdGVyID0gdGhpcy5jcmVhdGVTeW50aGVzaXNBZGFwdGVyKGF1dGhlbnRpY2F0aW9uLCB0aGlzLnByaXZDb25uZWN0aW9uRmFjdG9yeSwgdGhpcy5hdWRpb0NvbmZpZywgc3ludGhlc2l6ZXJDb25maWcpO1xuICAgICAgICB0aGlzLnByaXZBZGFwdGVyLmF1ZGlvT3V0cHV0Rm9ybWF0ID0gQXVkaW9PdXRwdXRGb3JtYXRJbXBsLmZyb21TcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQoU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W3RoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoT3V0cHV0Rm9ybWF0LCB1bmRlZmluZWQpXSk7XG4gICAgICAgIHRoaXMucHJpdlJlc3RBZGFwdGVyID0gbmV3IFN5bnRoZXNpc1Jlc3RBZGFwdGVyKHN5bnRoZXNpemVyQ29uZmlnLCBhdXRoZW50aWNhdGlvbik7XG4gICAgfVxuICAgIHNwZWFrSW1wbCh0ZXh0LCBJc1NzbWwsIGNiLCBlcnIsIGRhdGFTdHJlYW0pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWQpO1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICAgICAgbGV0IGF1ZGlvRGVzdGluYXRpb247XG4gICAgICAgICAgICBpZiAoZGF0YVN0cmVhbSBpbnN0YW5jZW9mIFB1c2hBdWRpb091dHB1dFN0cmVhbUNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9EZXN0aW5hdGlvbiA9IG5ldyBQdXNoQXVkaW9PdXRwdXRTdHJlYW1JbXBsKGRhdGFTdHJlYW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YVN0cmVhbSBpbnN0YW5jZW9mIFB1bGxBdWRpb091dHB1dFN0cmVhbSkge1xuICAgICAgICAgICAgICAgIGF1ZGlvRGVzdGluYXRpb24gPSBkYXRhU3RyZWFtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YVN0cmVhbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9EZXN0aW5hdGlvbiA9IG5ldyBBdWRpb0ZpbGVXcml0ZXIoZGF0YVN0cmVhbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdWRpb0Rlc3RpbmF0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zeW50aGVzaXNSZXF1ZXN0UXVldWUuZW5xdWV1ZShuZXcgU3ludGhlc2lzUmVxdWVzdChyZXF1ZXN0SWQsIHRleHQsIElzU3NtbCwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXppbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2IoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgICAgIHRoaXMuYWRhcHRlclNwZWFrKCkuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAgICAgICAgIH0sIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBhdWRpb0Rlc3RpbmF0aW9uKSk7XG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eS1mdW5jdGlvbiAqL1xuICAgICAgICAgICAgdGhpcy5hZGFwdGVyU3BlYWsoKS5jYXRjaCgoKSA9PiB7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRGVzdHJveSB0aGUgc3ludGhlc2l6ZXIuXG4gICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1lbXB0eSAqL1xuICAgICAgICAgICAgdGhpcy5kaXNwb3NlKHRydWUpLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0Vm9pY2VzKGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdElkID0gY3JlYXRlTm9EYXNoR3VpZCgpO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCB0aGlzLnByaXZSZXN0QWRhcHRlci5nZXRWb2ljZXNMaXN0KHJlcXVlc3RJZCk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uub2sgJiYgQXJyYXkuaXNBcnJheShyZXNwb25zZS5qc29uKSkge1xuICAgICAgICAgICAgICAgIGxldCBqc29uID0gcmVzcG9uc2UuanNvbjtcbiAgICAgICAgICAgICAgICBpZiAoISFsb2NhbGUgJiYgbG9jYWxlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAganNvbiA9IGpzb24uZmlsdGVyKChpdGVtKSA9PiAhIWl0ZW0uTG9jYWxlICYmIGl0ZW0uTG9jYWxlLnRvTG93ZXJDYXNlKCkgPT09IGxvY2FsZS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTeW50aGVzaXNWb2ljZXNSZXN1bHQocmVxdWVzdElkLCBqc29uLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTeW50aGVzaXNWb2ljZXNSZXN1bHQocmVxdWVzdElkLCB1bmRlZmluZWQsIGBFcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhZGFwdGVyU3BlYWsoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJpdkRpc3Bvc2VkICYmICF0aGlzLnByaXZTeW50aGVzaXppbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTeW50aGVzaXppbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSB5aWVsZCB0aGlzLnN5bnRoZXNpc1JlcXVlc3RRdWV1ZS5kZXF1ZXVlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdkFkYXB0ZXIuU3BlYWsocmVxdWVzdC50ZXh0LCByZXF1ZXN0LmlzU1NNTCwgcmVxdWVzdC5yZXF1ZXN0SWQsIHJlcXVlc3QuY2IsIHJlcXVlc3QuZXJyLCByZXF1ZXN0LmRhdGFTdHJlYW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIFhNTEVuY29kZSh0ZXh0KSB7XG4gICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoLyYvZywgXCImYW1wO1wiKVxuICAgICAgICAgICAgLnJlcGxhY2UoLzwvZywgXCImbHQ7XCIpXG4gICAgICAgICAgICAucmVwbGFjZSgvPi9nLCBcIiZndDtcIilcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cIi9nLCBcIiZxdW90O1wiKVxuICAgICAgICAgICAgLnJlcGxhY2UoLycvZywgXCImYXBvcztcIik7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIFN5bnRoZXNpc1JlcXVlc3Qge1xuICAgIGNvbnN0cnVjdG9yKHJlcXVlc3RJZCwgdGV4dCwgaXNTU01MLCBjYiwgZXJyLCBkYXRhU3RyZWFtKSB7XG4gICAgICAgIHRoaXMucmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgICAgICB0aGlzLmlzU1NNTCA9IGlzU1NNTDtcbiAgICAgICAgdGhpcy5jYiA9IGNiO1xuICAgICAgICB0aGlzLmVyciA9IGVycjtcbiAgICAgICAgdGhpcy5kYXRhU3RyZWFtID0gZGF0YVN0cmVhbTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNwZWVjaFN5bnRoZXNpemVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgRm9yY2VEaWN0YXRpb25Qcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFByb3BlcnR5TmFtZSwgU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IE91dHB1dEZvcm1hdCwgUHJvZmFuaXR5T3B0aW9uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFNwZWVjaENvbmZpZywgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0LCB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogU3BlZWNoIHRyYW5zbGF0aW9uIGNvbmZpZ3VyYXRpb24uXG4gKiBAY2xhc3MgU3BlZWNoVHJhbnNsYXRpb25Db25maWdcbiAqL1xuZXhwb3J0IGNsYXNzIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnIGV4dGVuZHMgU3BlZWNoQ29uZmlnIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHJlY29nbml6ZXIgY29uZmlnLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGF0aWMgaW5zdGFuY2Ugb2YgU3BlZWNoVHJhbnNsYXRpb25Db25maWcgcmV0dXJuZWQgYnkgcGFzc2luZyBhIHN1YnNjcmlwdGlvbiBrZXkgYW5kIHNlcnZpY2UgcmVnaW9uLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWcuZnJvbVN1YnNjcmlwdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3Vic2NyaXB0aW9uS2V5IC0gVGhlIHN1YnNjcmlwdGlvbiBrZXkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlZ2lvbiAtIFRoZSByZWdpb24gbmFtZSAoc2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9ha2EubXMvY3NzcGVlY2gvcmVnaW9uXCI+cmVnaW9uIHBhZ2U8L2E+KS5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoVHJhbnNsYXRpb25Db25maWd9IFRoZSBzcGVlY2ggdHJhbnNsYXRpb24gY29uZmlnLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbktleSwgcmVnaW9uKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShzdWJzY3JpcHRpb25LZXksIFwic3Vic2NyaXB0aW9uS2V5XCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocmVnaW9uLCBcInJlZ2lvblwiKTtcbiAgICAgICAgY29uc3QgcmV0ID0gbmV3IFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbCgpO1xuICAgICAgICByZXQucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleSwgc3Vic2NyaXB0aW9uS2V5KTtcbiAgICAgICAgcmV0LnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXRpYyBpbnN0YW5jZSBvZiBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZyByZXR1cm5lZCBieSBwYXNzaW5nIGF1dGhvcml6YXRpb24gdG9rZW4gYW5kIHNlcnZpY2UgcmVnaW9uLlxuICAgICAqIE5vdGU6IFRoZSBjYWxsZXIgbmVlZHMgdG8gZW5zdXJlIHRoYXQgdGhlIGF1dGhvcml6YXRpb24gdG9rZW4gaXMgdmFsaWQuIEJlZm9yZSB0aGUgYXV0aG9yaXphdGlvbiB0b2tlblxuICAgICAqIGV4cGlyZXMsIHRoZSBjYWxsZXIgbmVlZHMgdG8gcmVmcmVzaCBpdCBieSBzZXR0aW5nIHRoZSBwcm9wZXJ0eSBhdXRob3JpemF0aW9uVG9rZW4gd2l0aCBhIG5ld1xuICAgICAqIHZhbGlkIHRva2VuLiBPdGhlcndpc2UsIGFsbCB0aGUgcmVjb2duaXplcnMgY3JlYXRlZCBieSB0aGlzIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnIGluc3RhbmNlXG4gICAgICogd2lsbCBlbmNvdW50ZXIgZXJyb3JzIGR1cmluZyByZWNvZ25pdGlvbi5cbiAgICAgKiBBcyBjb25maWd1cmF0aW9uIHZhbHVlcyBhcmUgY29waWVkIHdoZW4gY3JlYXRpbmcgYSBuZXcgcmVjb2duaXplciwgdGhlIG5ldyB0b2tlbiB2YWx1ZSB3aWxsIG5vdCBhcHBseVxuICAgICAqIHRvIHJlY29nbml6ZXJzIHRoYXQgaGF2ZSBhbHJlYWR5IGJlZW4gY3JlYXRlZC5cbiAgICAgKiBGb3IgcmVjb2duaXplcnMgdGhhdCBoYXZlIGJlZW4gY3JlYXRlZCBiZWZvcmUsIHlvdSBuZWVkIHRvIHNldCBhdXRob3JpemF0aW9uIHRva2VuIG9mIHRoZSBjb3JyZXNwb25kaW5nIHJlY29nbml6ZXJcbiAgICAgKiB0byByZWZyZXNoIHRoZSB0b2tlbi4gT3RoZXJ3aXNlLCB0aGUgcmVjb2duaXplcnMgd2lsbCBlbmNvdW50ZXIgZXJyb3JzIGR1cmluZyByZWNvZ25pdGlvbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmZyb21BdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGF1dGhvcml6YXRpb25Ub2tlbiAtIFRoZSBhdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWdpb24gLSBUaGUgcmVnaW9uIG5hbWUgKHNlZSB0aGUgPGEgaHJlZj1cImh0dHBzOi8vYWthLm1zL2Nzc3BlZWNoL3JlZ2lvblwiPnJlZ2lvbiBwYWdlPC9hPikuXG4gICAgICogQHJldHVybnMge1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnfSBUaGUgc3BlZWNoIHRyYW5zbGF0aW9uIGNvbmZpZy5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUF1dGhvcml6YXRpb25Ub2tlbihhdXRob3JpemF0aW9uVG9rZW4sIHJlZ2lvbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UoYXV0aG9yaXphdGlvblRva2VuLCBcImF1dGhvcml6YXRpb25Ub2tlblwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHJlZ2lvbiwgXCJyZWdpb25cIik7XG4gICAgICAgIGNvbnN0IHJldCA9IG5ldyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwoKTtcbiAgICAgICAgcmV0LnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgYXV0aG9yaXphdGlvblRva2VuKTtcbiAgICAgICAgcmV0LnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb24sIHJlZ2lvbik7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHNwZWVjaCBjb25maWcgd2l0aCBzcGVjaWZpZWQgaG9zdCBhbmQgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBvbmx5IGZvciB1c2VycyB3aG8gdXNlIGEgbm9uLWRlZmF1bHQgc2VydmljZSBob3N0LiBTdGFuZGFyZCByZXNvdXJjZSBwYXRoIHdpbGwgYmUgYXNzdW1lZC5cbiAgICAgKiBGb3Igc2VydmljZXMgd2l0aCBhIG5vbi1zdGFuZGFyZCByZXNvdXJjZSBwYXRoIG9yIG5vIHBhdGggYXQgYWxsLCB1c2UgZnJvbUVuZHBvaW50IGluc3RlYWQuXG4gICAgICogTm90ZTogUXVlcnkgcGFyYW1ldGVycyBhcmUgbm90IGFsbG93ZWQgaW4gdGhlIGhvc3QgVVJJIGFuZCBtdXN0IGJlIHNldCBieSBvdGhlciBBUElzLlxuICAgICAqIE5vdGU6IFRvIHVzZSBhbiBhdXRob3JpemF0aW9uIHRva2VuIHdpdGggZnJvbUhvc3QsIHVzZSBmcm9tSG9zdChVUkwpLFxuICAgICAqIGFuZCB0aGVuIHNldCB0aGUgQXV0aG9yaXphdGlvblRva2VuIHByb3BlcnR5IG9uIHRoZSBjcmVhdGVkIFNwZWVjaENvbmZpZyBpbnN0YW5jZS5cbiAgICAgKiBOb3RlOiBBZGRlZCBpbiB2ZXJzaW9uIDEuOS4wLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoQ29uZmlnLmZyb21Ib3N0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7VVJMfSBob3N0IC0gVGhlIHNlcnZpY2UgZW5kcG9pbnQgdG8gY29ubmVjdCB0by4gRm9ybWF0IGlzIFwicHJvdG9jb2w6Ly9ob3N0OnBvcnRcIiB3aGVyZSBcIjpwb3J0XCIgaXMgb3B0aW9uYWwuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHN1YnNjcmlwdGlvbktleSAtIFRoZSBzdWJzY3JpcHRpb24ga2V5LiBJZiBhIHN1YnNjcmlwdGlvbiBrZXkgaXMgbm90IHNwZWNpZmllZCwgYW4gYXV0aG9yaXphdGlvbiB0b2tlbiBtdXN0IGJlIHNldC5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoQ29uZmlnfSBBIHNwZWVjaCBmYWN0b3J5IGluc3RhbmNlLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSG9zdChob3N0TmFtZSwgc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChob3N0TmFtZSwgXCJob3N0TmFtZVwiKTtcbiAgICAgICAgY29uc3Qgc3BlZWNoSW1wbCA9IG5ldyBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwoKTtcbiAgICAgICAgc3BlZWNoSW1wbC5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsIGhvc3ROYW1lLnByb3RvY29sICsgXCIvL1wiICsgaG9zdE5hbWUuaG9zdG5hbWUgKyAoaG9zdE5hbWUucG9ydCA9PT0gXCJcIiA/IFwiXCIgOiBcIjpcIiArIGhvc3ROYW1lLnBvcnQpKTtcbiAgICAgICAgaWYgKHVuZGVmaW5lZCAhPT0gc3Vic2NyaXB0aW9uS2V5KSB7XG4gICAgICAgICAgICBzcGVlY2hJbXBsLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5LCBzdWJzY3JpcHRpb25LZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzcGVlY2hJbXBsO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIHRoZSBzcGVlY2ggdHJhbnNsYXRpb24gY29uZmlnIHdpdGggc3BlY2lmaWVkIGVuZHBvaW50IGFuZCBzdWJzY3JpcHRpb24ga2V5LlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGludGVuZGVkIG9ubHkgZm9yIHVzZXJzIHdobyB1c2UgYSBub24tc3RhbmRhcmQgc2VydmljZSBlbmRwb2ludCBvciBwYXJhbXRlcnMuXG4gICAgICogTm90ZTogVGhlIHF1ZXJ5IHByb3BlcnRpZXMgc3BlY2lmaWVkIGluIHRoZSBlbmRwb2ludCBVUkwgYXJlIG5vdCBjaGFuZ2VkLCBldmVuIGlmIHRoZXkgYXJlXG4gICAgICogc2V0IGJ5IGFueSBvdGhlciBBUElzLiBGb3IgZXhhbXBsZSwgaWYgbGFuZ3VhZ2UgaXMgZGVmaW5lZCBpbiB0aGUgdXJpIGFzIHF1ZXJ5IHBhcmFtZXRlclxuICAgICAqIFwibGFuZ3VhZ2U9ZGUtREVcIiwgYW5kIGFsc28gc2V0IGJ5IHRoZSBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlIHByb3BlcnR5LCB0aGUgbGFuZ3VhZ2VcbiAgICAgKiBzZXR0aW5nIGluIHVyaSB0YWtlcyBwcmVjZWRlbmNlLCBhbmQgdGhlIGVmZmVjdGl2ZSBsYW5ndWFnZSBpcyBcImRlLURFXCIuXG4gICAgICogT25seSB0aGUgcHJvcGVydGllcyB0aGF0IGFyZSBub3Qgc3BlY2lmaWVkIGluIHRoZSBlbmRwb2ludCBVUkwgY2FuIGJlIHNldCBieSBvdGhlciBBUElzLlxuICAgICAqIE5vdGU6IFRvIHVzZSBhdXRob3JpemF0aW9uIHRva2VuIHdpdGggZnJvbUVuZHBvaW50LCBwYXNzIGFuIGVtcHR5IHN0cmluZyB0byB0aGUgc3Vic2NyaXB0aW9uS2V5IGluIHRoZVxuICAgICAqIGZyb21FbmRwb2ludCBtZXRob2QsIGFuZCB0aGVuIHNldCBhdXRob3JpemF0aW9uVG9rZW49XCJ0b2tlblwiIG9uIHRoZSBjcmVhdGVkIFNwZWVjaENvbmZpZyBpbnN0YW5jZSB0b1xuICAgICAqIHVzZSB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmZyb21FbmRwb2ludFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge1VSTH0gZW5kcG9pbnQgLSBUaGUgc2VydmljZSBlbmRwb2ludCB0byBjb25uZWN0IHRvLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJzY3JpcHRpb25LZXkgLSBUaGUgc3Vic2NyaXB0aW9uIGtleS5cbiAgICAgKiBAcmV0dXJucyB7U3BlZWNoVHJhbnNsYXRpb25Db25maWd9IEEgc3BlZWNoIGNvbmZpZyBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbUVuZHBvaW50KGVuZHBvaW50LCBzdWJzY3JpcHRpb25LZXkpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGVuZHBvaW50LCBcImVuZHBvaW50XCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoc3Vic2NyaXB0aW9uS2V5LCBcInN1YnNjcmlwdGlvbktleVwiKTtcbiAgICAgICAgY29uc3QgcmV0ID0gbmV3IFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbCgpO1xuICAgICAgICByZXQucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LCBlbmRwb2ludC5ocmVmKTtcbiAgICAgICAgcmV0LnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXksIHN1YnNjcmlwdGlvbktleSk7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxufVxuLyoqXG4gKiBAcHJpdmF0ZVxuICogQGNsYXNzIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbFxuICovXG5leHBvcnQgY2xhc3MgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsIGV4dGVuZHMgU3BlZWNoVHJhbnNsYXRpb25Db25maWcge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLm91dHB1dEZvcm1hdCA9IE91dHB1dEZvcm1hdC5TaW1wbGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKiBJZiB0aGlzIGlzIHNldCwgc3Vic2NyaXB0aW9uIGtleSBpcyBpZ25vcmVkLlxuICAgICAqIFVzZXIgbmVlZHMgdG8gbWFrZSBzdXJlIHRoZSBwcm92aWRlZCBhdXRob3JpemF0aW9uIHRva2VuIGlzIHZhbGlkIGFuZCBub3QgZXhwaXJlZC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSBhdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHZhbHVlLCBcInZhbHVlXCIpO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgc3BlZWNoIHJlY29nbml0aW9uIGxhbmd1YWdlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5zcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSBhdXRob3JpemF0aW9uIHRva2VuLlxuICAgICAqL1xuICAgIHNldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKHZhbHVlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh2YWx1ZSwgXCJ2YWx1ZVwiKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBzcGVlY2ggcmVjb2duaXRpb24gbGFuZ3VhZ2UuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZS5cbiAgICAgKi9cbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZV0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuc3Vic2NyaXB0aW9uS2V5XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGdldCBzdWJzY3JpcHRpb25LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9LZXldKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgb3V0cHV0IGZvcm1hdFxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5vdXRwdXRGb3JtYXRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IG91dHB1dEZvcm1hdCgpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgIHJldHVybiBPdXRwdXRGb3JtYXRbdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIHVuZGVmaW5lZCldO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzL1NldHMgdGhlIG91dHB1dCBmb3JtYXRcbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUub3V0cHV0Rm9ybWF0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHNldCBvdXRwdXRGb3JtYXQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShPdXRwdXRGb3JtYXRQcm9wZXJ0eU5hbWUsIE91dHB1dEZvcm1hdFt2YWx1ZV0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBlbmRwb2ludCBpZC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuZW5kcG9pbnRJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBnZXQgZW5kcG9pbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9FbmRwb2ludElkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBlbmRwb2ludCBpZC5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUuZW5kcG9pbnRJZFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBzZXQgZW5kcG9pbnRJZCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5kcG9pbnRJZCwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgYSAodGV4dCkgdGFyZ2V0IGxhbmd1YWdlIHRvIHRyYW5zbGF0ZSBpbnRvLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5hZGRUYXJnZXRMYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgbGFuZ3VhZ2Ugc3VjaCBhcyBkZS1ERVxuICAgICAqL1xuICAgIGFkZFRhcmdldExhbmd1YWdlKHZhbHVlKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh2YWx1ZSwgXCJ2YWx1ZVwiKTtcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2VzID0gdGhpcy50YXJnZXRMYW5ndWFnZXM7XG4gICAgICAgIGxhbmd1YWdlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMsIGxhbmd1YWdlcy5qb2luKFwiLFwiKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlICh0ZXh0KSB0YXJnZXQgbGFuZ3VhZ2UgdG8gdHJhbnNsYXRlIGludG8uXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLnRhcmdldExhbmd1YWdlc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgbGFuZ3VhZ2Ugc3VjaCBhcyBkZS1ERVxuICAgICAqL1xuICAgIGdldCB0YXJnZXRMYW5ndWFnZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcywgdW5kZWZpbmVkKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMpLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB2b2ljZSBuYW1lLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS52b2ljZU5hbWVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgZ2V0IHZvaWNlTmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVm9pY2VdKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSB2b2ljZSBvZiB0aGUgdHJhbnNsYXRlZCBsYW5ndWFnZSwgZW5hYmxlIHZvaWNlIHN5bnRoZXNpcyBvdXRwdXQuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLnZvaWNlTmFtZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgLSBUaGUgbmFtZSBvZiB0aGUgdm9pY2UuXG4gICAgICovXG4gICAgc2V0IHZvaWNlTmFtZSh2YWx1ZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodmFsdWUsIFwidmFsdWVcIik7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlLCB2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIHRoZSByZWdpb24uXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLnJlZ2lvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgcmVnaW9uLlxuICAgICAqL1xuICAgIGdldCByZWdpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVnaW9uKTtcbiAgICB9XG4gICAgc2V0UHJveHkocHJveHlIb3N0TmFtZSwgcHJveHlQb3J0LCBwcm94eVVzZXJOYW1lLCBwcm94eVBhc3N3b3JkKSB7XG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5SG9zdE5hbWVdLCBwcm94eUhvc3ROYW1lKTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQb3J0XSwgcHJveHlQb3J0KTtcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlVc2VyTmFtZV0sIHByb3h5VXNlck5hbWUpO1xuICAgICAgICB0aGlzLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBhc3N3b3JkXSwgcHJveHlQYXNzd29yZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgYW4gYXJiaXRyYXJ5IHByb3BlcnR5IHZhbHVlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5nZXRQcm9wZXJ0eVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGVmIC0gVGhlIGRlZmF1bHQgdmFsdWUgb2YgdGhlIHByb3BlcnR5IGluIGNhc2UgaXQgaXMgbm90IHNldC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICAgICAqL1xuICAgIGdldFByb3BlcnR5KG5hbWUsIGRlZikge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShuYW1lLCBkZWYpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzL1NldHMgYW4gYXJiaXRyYXJ5IHByb3BlcnR5IHZhbHVlLlxuICAgICAqIEBtZW1iZXIgU3BlZWNoVHJhbnNsYXRpb25Db25maWdJbXBsLnByb3RvdHlwZS5zZXRQcm9wZXJ0eVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZyB8IFByb3BlcnR5SWR9IG5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gc2V0LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gICAgICovXG4gICAgc2V0UHJvcGVydHkobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShuYW1lLCB2YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIGFjY2VzcyB0byBjdXN0b20gcHJvcGVydGllcy5cbiAgICAgKiBAbWVtYmVyIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgcHJvcGVydGllcy5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERpc3Bvc2Ugb2YgYXNzb2NpYXRlZCByZXNvdXJjZXMuXG4gICAgICogQG1lbWJlciBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZ0ltcGwucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHNldFNlcnZpY2VQcm9wZXJ0eShuYW1lLCB2YWx1ZSkge1xuICAgICAgICBjb25zdCBjdXJyZW50UHJvcGVydGllcyA9IEpTT04ucGFyc2UodGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShTZXJ2aWNlUHJvcGVydGllc1Byb3BlcnR5TmFtZSwgXCJ7fVwiKSk7XG4gICAgICAgIGN1cnJlbnRQcm9wZXJ0aWVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRQcm9wZXJ0aWVzKSk7XG4gICAgfVxuICAgIHNldFByb2Zhbml0eShwcm9mYW5pdHkpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qcm9mYW5pdHlPcHRpb24sIFByb2Zhbml0eU9wdGlvbltwcm9mYW5pdHldKTtcbiAgICB9XG4gICAgZW5hYmxlQXVkaW9Mb2dnaW5nKCkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fRW5hYmxlQXVkaW9Mb2dnaW5nLCBcInRydWVcIik7XG4gICAgfVxuICAgIHJlcXVlc3RXb3JkTGV2ZWxUaW1lc3RhbXBzKCkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZVJlc3BvbnNlX1JlcXVlc3RXb3JkTGV2ZWxUaW1lc3RhbXBzLCBcInRydWVcIik7XG4gICAgfVxuICAgIGVuYWJsZURpY3RhdGlvbigpIHtcbiAgICAgICAgdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5zZXRQcm9wZXJ0eShGb3JjZURpY3RhdGlvblByb3BlcnR5TmFtZSwgXCJ0cnVlXCIpO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoU3ludGhlc2lzTGFuZ3VhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhMYW5ndWFnZSk7XG4gICAgfVxuICAgIHNldCBzcGVlY2hTeW50aGVzaXNMYW5ndWFnZShsYW5ndWFnZSkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hQcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fU3ludGhMYW5ndWFnZSwgbGFuZ3VhZ2UpO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoU3ludGhlc2lzVm9pY2VOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoUHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1N5bnRoVm9pY2UpO1xuICAgIH1cbiAgICBzZXQgc3BlZWNoU3ludGhlc2lzVm9pY2VOYW1lKHZvaWNlKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aFZvaWNlLCB2b2ljZSk7XG4gICAgfVxuICAgIGdldCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQoKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICByZXR1cm4gU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W3RoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdCwgdW5kZWZpbmVkKV07XG4gICAgfVxuICAgIHNldCBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQoZm9ybWF0KSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9TeW50aE91dHB1dEZvcm1hdCwgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0W2Zvcm1hdF0pO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3BlZWNoVHJhbnNsYXRpb25Db25maWcuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogQmFzZSBjbGFzcyBmb3Igc3ludGhlc2lzIHJlc3VsdHNcbiAqIEBjbGFzcyBTeW50aGVzaXNSZXN1bHRcbiAqIEFkZGVkIGluIHZlcnNpb24gMS4yMC4wXG4gKi9cbmV4cG9ydCBjbGFzcyBTeW50aGVzaXNSZXN1bHQge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHJlc3VsdElkIC0gVGhlIHJlc3VsdCBpZC5cbiAgICAgKiBAcGFyYW0ge1Jlc3VsdFJlYXNvbn0gcmVhc29uIC0gVGhlIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUNvbGxlY3Rpb259IHByb3BlcnRpZXMgLSBBZGRpdGlvbmFsIHByb3BlcnRpZXMsIGlmIHByb3ZpZGVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlc3VsdElkLCByZWFzb24sIGVycm9yRGV0YWlscywgcHJvcGVydGllcykge1xuICAgICAgICB0aGlzLnByaXZSZXN1bHRJZCA9IHJlc3VsdElkO1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IGVycm9yRGV0YWlscztcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgcmVzdWx0IGlkZW50aWZpZXIuXG4gICAgICogQG1lbWJlciBTeW50aGVzaXNSZXN1bHQucHJvdG90eXBlLnJlc3VsdElkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFNwZWNpZmllcyB0aGUgcmVzdWx0IGlkZW50aWZpZXIuXG4gICAgICovXG4gICAgZ2V0IHJlc3VsdElkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0SWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyBzdGF0dXMgb2YgdGhlIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFN5bnRoZXNpc1Jlc3VsdC5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtSZXN1bHRSZWFzb259IFNwZWNpZmllcyBzdGF0dXMgb2YgdGhlIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCBzeW50aGVzaXMsIHByb3ZpZGVzIGRldGFpbHMgb2YgdGhlIG9jY3VycmVkIGVycm9yLlxuICAgICAqIEBtZW1iZXIgU3ludGhlc2lzUmVzdWx0LnByb3RvdHlwZS5lcnJvckRldGFpbHNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gYSBicmllZiBkZXNjcmlwdGlvbiBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIHByb3BlcnRpZXMgZXhwb3NlZCBpbiB0aGUgcmVzdWx0LlxuICAgICAqIEBtZW1iZXIgU3ludGhlc2lzUmVzdWx0LnByb3RvdHlwZS5wcm9wZXJ0aWVzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtQcm9wZXJ0eUNvbGxlY3Rpb259IFRoZSBzZXQgb2YgcHJvcGVydGllcyBleHBvc2VkIGluIHRoZSByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3ludGhlc2lzUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBQcm9wZXJ0eUNvbGxlY3Rpb24sIFJlc3VsdFJlYXNvbiwgU3ludGhlc2lzUmVzdWx0LCBWb2ljZUluZm8gfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgcmVzdWx0IG9mIHNwZWVjaCBzeW50aGVzaXMuXG4gKiBAY2xhc3MgU3ludGhlc2lzVm9pY2VzUmVzdWx0XG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjAuMFxuICovXG5leHBvcnQgY2xhc3MgU3ludGhlc2lzVm9pY2VzUmVzdWx0IGV4dGVuZHMgU3ludGhlc2lzUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSByZXF1ZXN0SWQgLSByZXN1bHQgaWQgZm9yIHJlcXVlc3QuXG4gICAgICogQHBhcmFtIGpzb24gLSBqc29uIHBheWxvYWQgZnJvbSBlbmRwb2ludC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0SWQsIGpzb24sIGVycm9yRGV0YWlscykge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShqc29uKSkge1xuICAgICAgICAgICAgc3VwZXIocmVxdWVzdElkLCBSZXN1bHRSZWFzb24uVm9pY2VzTGlzdFJldHJpZXZlZCwgdW5kZWZpbmVkLCBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCkpO1xuICAgICAgICAgICAgdGhpcy5wcml2Vm9pY2VzID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YganNvbikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlZvaWNlcy5wdXNoKG5ldyBWb2ljZUluZm8oaXRlbSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3VwZXIocmVxdWVzdElkLCBSZXN1bHRSZWFzb24uQ2FuY2VsZWQsIGVycm9yRGV0YWlscyA/IGVycm9yRGV0YWlscyA6IFwiRXJyb3IgaW5mb3JtYXRpb24gdW5hdmFpbGFibGVcIiwgbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbGlzdCBvZiB2b2ljZXNcbiAgICAgKiBAbWVtYmVyIFN5bnRoZXNpc1ZvaWNlc1Jlc3VsdC5wcm90b3R5cGUudm9pY2VzXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtWb2ljZUluZm9bXX0gTGlzdCBvZiBzeW50aGVzaXplZCB2b2ljZXMuXG4gICAgICovXG4gICAgZ2V0IHZvaWNlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlcztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN5bnRoZXNpc1ZvaWNlc1Jlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcsIENvbnZlcnNhdGlvbk1hbmFnZXIsIENvbnZlcnNhdGlvblJlY29nbml6ZXJGYWN0b3J5LCBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLCBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLCBJbnRlcm5hbFBhcnRpY2lwYW50cyB9IGZyb20gXCIuLi8uLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IENvbnZlcnNhdGlvblBhcnRpY2lwYW50c0NoYW5nZWRFdmVudEFyZ3MsIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uRXZlbnRBcmdzLCBQYXJ0aWNpcGFudCwgUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uLCBQcm9mYW5pdHlPcHRpb24sIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCwgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIHNwZWVjaENvbmZpZ1xuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlQ29udmVyc2F0aW9uQXN5bmMoc3BlZWNoQ29uZmlnLCBhcmcyLCBhcmczLCBhcmc0KSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHNwZWVjaENvbmZpZywgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5yZXN0RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcImNvbmZpZ1wiKSk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHNwZWVjaENvbmZpZy5yZWdpb24sIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcucmVzdEVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJTcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWdpb25cIikpO1xuICAgICAgICBpZiAoIXNwZWVjaENvbmZpZy5zdWJzY3JpcHRpb25LZXkgJiYgIXNwZWVjaENvbmZpZy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW5dKSkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQoc3BlZWNoQ29uZmlnLnN1YnNjcmlwdGlvbktleSwgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5yZXN0RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcIlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleVwiKSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNvbnZlcnNhdGlvbkltcGw7XG4gICAgICAgIGxldCBjYjtcbiAgICAgICAgbGV0IGVycjtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcyID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb252ZXJzYXRpb25JbXBsID0gbmV3IENvbnZlcnNhdGlvbkltcGwoc3BlZWNoQ29uZmlnLCBhcmcyKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb25cbiAgICAgICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MoKCgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsgfSkpKCksIGFyZzMsIGFyZzQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29udmVyc2F0aW9uSW1wbCA9IG5ldyBDb252ZXJzYXRpb25JbXBsKHNwZWVjaENvbmZpZyk7XG4gICAgICAgICAgICBjYiA9IGFyZzI7XG4gICAgICAgICAgICBlcnIgPSBhcmczO1xuICAgICAgICAgICAgY29udmVyc2F0aW9uSW1wbC5jcmVhdGVDb252ZXJzYXRpb25Bc3luYygoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb252ZXJzYXRpb25JbXBsO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25JbXBsIGV4dGVuZHMgQ29udmVyc2F0aW9uIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBjb252ZXJzYXRpb24gaW1wbFxuICAgICAqIEBwYXJhbSBzcGVlY2hDb25maWdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBvcHRpb25hbCBjb252ZXJzYXRpb25JZFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZywgaWQpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5wcml2RXJyb3JzID0gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5yZXN0RXJyb3JzO1xuICAgICAgICAvKiogd2Vic29ja2V0IGNhbGxiYWNrcyAqL1xuICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvdHlwZWRlZiAqL1xuICAgICAgICB0aGlzLm9uQ29ubmVjdGVkID0gKGUpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHRoaXMucHJpdklzQ29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhKChfYSA9IHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXNzaW9uU3RhcnRlZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5zZXNzaW9uU3RhcnRlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25EaXNjb25uZWN0ZWQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAoISEoKF9hID0gdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlc3Npb25TdG9wcGVkKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLnNlc3Npb25TdG9wcGVkKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5jbG9zZShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25DYW5jZWxlZCA9IChyLCBlKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghISgoX2EgPSB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FuY2VsZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IuY2FuY2VsZWQodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uUGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQgPSAociwgZSkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkUGFydGljaXBhbnQgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMuZ2V0UGFydGljaXBhbnQoZS5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKHVwZGF0ZWRQYXJ0aWNpcGFudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5jaGFuZ2VOaWNrbmFtZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGFydGljaXBhbnQuZGlzcGxheU5hbWUgPSBlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldFVzZVRUUzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUGFydGljaXBhbnQuaXNVc2luZ1R0cyA9IGUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0UHJvZmFuaXR5RmlsdGVyaW5nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRQYXJ0aWNpcGFudC5wcm9mYW5pdHkgPSBlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldE11dGU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFBhcnRpY2lwYW50LmlzTXV0ZWQgPSBlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29tbWFuZFR5cGVzLnNldFRyYW5zbGF0ZVRvTGFuZ3VhZ2VzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRQYXJ0aWNpcGFudC50cmFuc2xhdGVUb0xhbmd1YWdlcyA9IGUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzLmFkZE9yVXBkYXRlUGFydGljaXBhbnQodXBkYXRlZFBhcnRpY2lwYW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5wYXJ0aWNpcGFudHNDaGFuZ2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIG5ldyBDb252ZXJzYXRpb25QYXJ0aWNpcGFudHNDaGFuZ2VkRXZlbnRBcmdzKFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbi5VcGRhdGVkLCBbdGhpcy50b1BhcnRpY2lwYW50KHVwZGF0ZWRQYXJ0aWNpcGFudCldLCBlLnNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uTG9ja1Jvb21Db21tYW5kUmVjZWl2ZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBUT0RPXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25NdXRlQWxsQ29tbWFuZFJlY2VpdmVkID0gKHIsIGUpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzLnBhcnRpY2lwYW50cy5mb3JFYWNoKChwKSA9PiBwLmlzTXV0ZWQgPSAocC5pc0hvc3QgPyBmYWxzZSA6IGUuaXNNdXRlZCkpO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5wYXJ0aWNpcGFudHNDaGFuZ2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIG5ldyBDb252ZXJzYXRpb25QYXJ0aWNpcGFudHNDaGFuZ2VkRXZlbnRBcmdzKFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbi5VcGRhdGVkLCB0aGlzLnRvUGFydGljaXBhbnRzKGZhbHNlKSwgZS5zZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25QYXJ0aWNpcGFudEpvaW5Db21tYW5kUmVjZWl2ZWQgPSAociwgZSkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdQYXJ0aWNpcGFudCA9IHRoaXMucHJpdlBhcnRpY2lwYW50cy5hZGRPclVwZGF0ZVBhcnRpY2lwYW50KGUucGFydGljaXBhbnQpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdQYXJ0aWNpcGFudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IucGFydGljaXBhbnRzQ2hhbmdlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBuZXcgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncyhQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24uSm9pbmVkQ29udmVyc2F0aW9uLCBbdGhpcy50b1BhcnRpY2lwYW50KG5ld1BhcnRpY2lwYW50KV0sIGUuc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMub25QYXJ0aWNpcGFudExlYXZlQ29tbWFuZFJlY2VpdmVkID0gKHIsIGUpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZWplY3RlZFBhcnRpY2lwYW50ID0gdGhpcy5wcml2UGFydGljaXBhbnRzLmdldFBhcnRpY2lwYW50KGUucGFydGljaXBhbnQuaWQpO1xuICAgICAgICAgICAgICAgIGlmIChlamVjdGVkUGFydGljaXBhbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhlIHBhcnRpY2lwYW50IGZyb20gdGhlIGludGVybmFsIHBhcnRpY2lwYW50cyBsaXN0XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cy5kZWxldGVQYXJ0aWNpcGFudChlLnBhcnRpY2lwYW50LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm90aWZ5IHN1YnNjcmliZXJzIHRoYXQgdGhlIHBhcnRpY2lwYW50IGhhcyBsZWZ0IHRoZSBjb252ZXJzYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IucGFydGljaXBhbnRzQ2hhbmdlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBuZXcgQ29udmVyc2F0aW9uUGFydGljaXBhbnRzQ2hhbmdlZEV2ZW50QXJncyhQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24uTGVmdENvbnZlcnNhdGlvbiwgW3RoaXMudG9QYXJ0aWNpcGFudChlamVjdGVkUGFydGljaXBhbnQpXSwgZS5zZXNzaW9uSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5vblRyYW5zbGF0aW9uUmVjZWl2ZWQgPSAociwgZSkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUuY29tbWFuZCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMuZmluYWw6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci50cmFuc2NyaWJlZCh0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLCBuZXcgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25FdmVudEFyZ3MoZS5wYXlsb2FkLCB1bmRlZmluZWQsIGUuc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLnBhcnRpYWw6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci50cmFuc2NyaWJpbmcodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uRXZlbnRBcmdzKGUucGF5bG9hZCwgdW5kZWZpbmVkLCBlLnNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5pbnN0YW50TWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLnRleHRNZXNzYWdlUmVjZWl2ZWQodGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvciwgbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uRXZlbnRBcmdzKGUucGF5bG9hZCwgdW5kZWZpbmVkLCBlLnNlc3Npb25JZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uUGFydGljaXBhbnRzTGlzdFJlY2VpdmVkID0gKHIsIGUpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNlc3Npb24gdG9rZW4gbmVlZHMgdG8gYmUgdXBkYXRlZFxuICAgICAgICAgICAgICAgIGlmIChlLnNlc3Npb25Ub2tlbiAhPT0gdW5kZWZpbmVkICYmIGUuc2Vzc2lvblRva2VuICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlJvb20udG9rZW4gPSBlLnNlc3Npb25Ub2tlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gc2F2ZSB0aGUgcGFydGljaXBhbnRzXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzLnBhcnRpY2lwYW50cyA9IFsuLi5lLnBhcnRpY2lwYW50c107XG4gICAgICAgICAgICAgICAgLy8gZW5hYmxlIHRoZSBjb252ZXJzYXRpb25cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2UGFydGljaXBhbnRzLm1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2SXNSZWFkeSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5wYXJ0aWNpcGFudHNDaGFuZ2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIG5ldyBDb252ZXJzYXRpb25QYXJ0aWNpcGFudHNDaGFuZ2VkRXZlbnRBcmdzKFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbi5Kb2luZWRDb252ZXJzYXRpb24sIHRoaXMudG9QYXJ0aWNpcGFudHModHJ1ZSksIGUuc2Vzc2lvbklkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdGhlIGhvc3QsIHVwZGF0ZSB0aGUgbmlja25hbWUgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubWUuaXNIb3N0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5pY2tuYW1lID0gKF9hID0gdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX05hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmlja25hbWUgIT09IHVuZGVmaW5lZCAmJiBuaWNrbmFtZS5sZW5ndGggPiAwICYmIG5pY2tuYW1lICE9PSB0aGlzLm1lLmRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpc3N1ZSBhIGNoYW5nZSBuaWNrbmFtZSByZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZU5pY2tuYW1lQXN5bmMobmlja25hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm9uQ29udmVyc2F0aW9uRXhwaXJhdGlvbiA9IChyLCBlKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvci5jb252ZXJzYXRpb25FeHBpcmF0aW9uKHRoaXMucHJpdkNvbnZlcnNhdGlvblRyYW5zbGF0b3IsIGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wcml2SXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2SXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25JZCA9IFwiXCI7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMucHJpdk1hbmFnZXIgPSBuZXcgQ29udmVyc2F0aW9uTWFuYWdlcigpO1xuICAgICAgICAvLyBjaGVjayB0aGUgc3BlZWNoIGxhbmd1YWdlXG4gICAgICAgIGNvbnN0IGxhbmd1YWdlID0gc3BlZWNoQ29uZmlnLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VdKTtcbiAgICAgICAgaWYgKCFsYW5ndWFnZSkge1xuICAgICAgICAgICAgc3BlZWNoQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VdLCBDb252ZXJzYXRpb25Db25uZWN0aW9uQ29uZmlnLmRlZmF1bHRMYW5ndWFnZUNvZGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJpdkxhbmd1YWdlID0gc3BlZWNoQ29uZmlnLmdldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VdKTtcbiAgICAgICAgaWYgKCFpZCkge1xuICAgICAgICAgICAgLy8gY2hlY2sgdGhlIHRhcmdldCBsYW5ndWFnZShzKVxuICAgICAgICAgICAgaWYgKHNwZWVjaENvbmZpZy50YXJnZXRMYW5ndWFnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgc3BlZWNoQ29uZmlnLmFkZFRhcmdldExhbmd1YWdlKHRoaXMucHJpdkxhbmd1YWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSBwcm9mYW5pdHkgc2V0dGluZzogc3BlZWNoIGFuZCBjb252ZXJzYXRpb25UcmFuc2xhdG9yIHNob3VsZCBiZSBpbiBzeW5jXG4gICAgICAgICAgICBjb25zdCBwcm9mYW5pdHkgPSBzcGVlY2hDb25maWcuZ2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VSZXNwb25zZV9Qcm9mYW5pdHlPcHRpb25dKTtcbiAgICAgICAgICAgIGlmICghcHJvZmFuaXR5KSB7XG4gICAgICAgICAgICAgICAgc3BlZWNoQ29uZmlnLnNldFByb2Zhbml0eShQcm9mYW5pdHlPcHRpb24uTWFza2VkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSBuaWNrbmFtZTogaXQgc2hvdWxkIHBhc3MgdGhpcyByZWdleDogXlxcdysoW1xccy1dW1xcd1xcKFxcKV0rKSokXCJcbiAgICAgICAgICAgIC8vIFRPRE86IHNwZWNpZnkgdGhlIHJlZ2V4IHJlcXVpcmVkLiBOaWNrbmFtZXMgbXVzdCBiZSB1bmlxdWUgb3IgZ2V0IHRoZSBkdXBsaWNhdGUgbmlja25hbWUgZXJyb3JcbiAgICAgICAgICAgIC8vIFRPRE86IGNoZWNrIHdoYXQgdGhlIG1heCBsZW5ndGggaXMgYW5kIGlmIGEgdHJ1bmNhdGlvbiBpcyByZXF1aXJlZCBvciBpZiB0aGUgc2VydmljZSBoYW5kbGVzIGl0IHdpdGhvdXQgYW4gZXJyb3JcbiAgICAgICAgICAgIGxldCBob3N0Tmlja25hbWUgPSBzcGVlY2hDb25maWcuZ2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLkNvbnZlcnNhdGlvblRyYW5zbGF0b3JfTmFtZV0pO1xuICAgICAgICAgICAgaWYgKGhvc3ROaWNrbmFtZSA9PT0gdW5kZWZpbmVkIHx8IGhvc3ROaWNrbmFtZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGhvc3ROaWNrbmFtZSA9IFwiSG9zdFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JUb29Mb25nKGhvc3ROaWNrbmFtZSwgXCJuaWNrbmFtZVwiLCA1MCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclRvb1Nob3J0KGhvc3ROaWNrbmFtZSwgXCJuaWNrbmFtZVwiLCAyKTtcbiAgICAgICAgICAgIHNwZWVjaENvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lXSwgaG9zdE5pY2tuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbklkID0gaWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2F2ZSB0aGUgc3BlZWNoIGNvbmZpZyBmb3IgZnV0dXJlIHVzYWdlXG4gICAgICAgIHRoaXMucHJpdkNvbmZpZyA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgLy8gc2F2ZSB0aGUgY29uZmlnIHByb3BlcnRpZXNcbiAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IHNwZWVjaENvbmZpZztcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsKGNvbmZpZ0ltcGwsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gY29uZmlnSW1wbC5wcm9wZXJ0aWVzLmNsb25lKCk7XG4gICAgICAgIHRoaXMucHJpdklzQ29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50cyA9IG5ldyBJbnRlcm5hbFBhcnRpY2lwYW50cygpO1xuICAgICAgICB0aGlzLnByaXZJc1JlYWR5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdlRleHRNZXNzYWdlTWF4TGVuZ3RoID0gMTAwMDtcbiAgICB9XG4gICAgLy8gZ2V0IHRoZSBpbnRlcm5hbCBkYXRhIGFib3V0IGEgY29udmVyc2F0aW9uXG4gICAgZ2V0IHJvb20oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSb29tO1xuICAgIH1cbiAgICAvLyBnZXQgdGhlIHdyYXBwZXIgZm9yIGNvbm5lY3RpbmcgdG8gdGhlIHdlYnNvY2tldHNcbiAgICBnZXQgY29ubmVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXI7IC8vIHRoaXMucHJpdkNvbm5lY3Rpb247XG4gICAgfVxuICAgIC8vIGdldCB0aGUgY29uZmlnXG4gICAgZ2V0IGNvbmZpZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkNvbmZpZztcbiAgICB9XG4gICAgLy8gZ2V0IHRoZSBjb252ZXJzYXRpb24gSWRcbiAgICBnZXQgY29udmVyc2F0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSb29tID8gdGhpcy5wcml2Um9vbS5yb29tSWQgOiB0aGlzLnByaXZDb252ZXJzYXRpb25JZDtcbiAgICB9XG4gICAgLy8gZ2V0IHRoZSBwcm9wZXJ0aWVzXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvLyBnZXQgdGhlIHNwZWVjaCBsYW5ndWFnZVxuICAgIGdldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TGFuZ3VhZ2U7XG4gICAgfVxuICAgIGdldCBpc011dGVkQnlIb3N0KCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICByZXR1cm4gKChfYSA9IHRoaXMucHJpdlBhcnRpY2lwYW50cy5tZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlzSG9zdCkgPyBmYWxzZSA6IChfYiA9IHRoaXMucHJpdlBhcnRpY2lwYW50cy5tZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmlzTXV0ZWQ7XG4gICAgfVxuICAgIGdldCBpc0Nvbm5lY3RlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzQ29ubmVjdGVkICYmIHRoaXMucHJpdklzUmVhZHk7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRvUGFydGljaXBhbnRzKHRydWUpO1xuICAgIH1cbiAgICBnZXQgbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRvUGFydGljaXBhbnQodGhpcy5wcml2UGFydGljaXBhbnRzLm1lKTtcbiAgICB9XG4gICAgZ2V0IGhvc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRvUGFydGljaXBhbnQodGhpcy5wcml2UGFydGljaXBhbnRzLmhvc3QpO1xuICAgIH1cbiAgICBnZXQgdHJhbnNjcmliZXJSZWNvZ25pemVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyO1xuICAgIH1cbiAgICBnZXQgY29udmVyc2F0aW9uSW5mbygpIHtcbiAgICAgICAgY29uc3QgY29udklkID0gdGhpcy5jb252ZXJzYXRpb25JZDtcbiAgICAgICAgY29uc3QgcCA9IHRoaXMucGFydGljaXBhbnRzLm1hcCgocGFydCkgPT4gKHtcbiAgICAgICAgICAgIGlkOiBwYXJ0LmlkLFxuICAgICAgICAgICAgcHJlZmVycmVkTGFuZ3VhZ2U6IHBhcnQucHJlZmVycmVkTGFuZ3VhZ2UsXG4gICAgICAgICAgICB2b2ljZTogcGFydC52b2ljZVxuICAgICAgICB9KSk7XG4gICAgICAgIGNvbnN0IHByb3BzID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcudHJhbnNjcmlwdGlvbkV2ZW50S2V5cykge1xuICAgICAgICAgICAgY29uc3QgdmFsID0gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KGtleSwgXCJcIik7XG4gICAgICAgICAgICBpZiAodmFsICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgcHJvcHNba2V5XSA9IHZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpbmZvID0geyBpZDogY29udklkLCBwYXJ0aWNpcGFudHM6IHAsIGNvbnZlcnNhdGlvblByb3BlcnRpZXM6IHByb3BzIH07XG4gICAgICAgIHJldHVybiBpbmZvO1xuICAgIH1cbiAgICBnZXQgY2FuU2VuZCgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNDb25uZWN0ZWQgJiYgISgoX2EgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMubWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pc011dGVkKTtcbiAgICB9XG4gICAgZ2V0IGNhblNlbmRBc0hvc3QoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzQ29ubmVjdGVkICYmICgoX2EgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMubWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pc0hvc3QpO1xuICAgIH1cbiAgICAvLyBnZXQgLyBzZXQgdGhlIHNwZWVjaCBhdXRoIHRva2VuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgICBnZXQgYXV0aG9yaXphdGlvblRva2VuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VG9rZW47XG4gICAgfVxuICAgIHNldCBhdXRob3JpemF0aW9uVG9rZW4odmFsdWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHZhbHVlLCBcImF1dGhvcml6YXRpb25Ub2tlblwiKTtcbiAgICAgICAgdGhpcy5wcml2VG9rZW4gPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IGNvbnZlcnNhdGlvblRyYW5zbGF0b3IoY29udmVyc2F0aW9uVHJhbnNsYXRvcikge1xuICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yID0gY29udmVyc2F0aW9uVHJhbnNsYXRvcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IGNvbnZlcnNhdGlvbiBhcyBIb3N0XG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIGNyZWF0ZUNvbnZlcnNhdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFN0YXJ0KSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdk1hbmFnZXIuY3JlYXRlT3JKb2luKHRoaXMucHJpdlByb3BlcnRpZXMsIHVuZGVmaW5lZCwgKChyb29tKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFyb29tKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29ubmVjdCksIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlJvb20gPSByb29tO1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2soY2IsIGVycik7XG4gICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBhIG5ldyBjb252ZXJzYXRpb24gYXMgaG9zdC5cbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgc3RhcnRDb252ZXJzYXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSBpcyBhbHJlYWR5IGEgcmVjb2duaXplclxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU3RhcnQpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgY29udmVyc2F0aW9uIGRhdGEgYXZhaWxhYmxlXG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpO1xuICAgICAgICAgICAgLy8gY29ubmVjdCB0byB0aGUgY29udmVyc2F0aW9uIHdlYnNvY2tldFxuICAgICAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzLm1lSWQgPSB0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyID0gQ29udmVyc2F0aW9uUmVjb2duaXplckZhY3RvcnkuZnJvbUNvbmZpZyh0aGlzLCB0aGlzLnByaXZDb25maWcpO1xuICAgICAgICAgICAgLy8gQmVjYXVzZSBDb252ZXJzYXRpb25UcmFuc2xhdG9yIG1hbnVhbGx5IHNldHMgdXAgYW5kIG1hbmFnZXMgdGhlIGNvbm5lY3Rpb24sIENvbnZlcnNhdGlvblxuICAgICAgICAgICAgLy8gaGFzIHRvIGZvcndhcmQgc2VydmljZVJlY29nbml6ZXIgY29ubmVjdGlvbiBldmVudHMgdGhhdCB1c3VhbGx5IGdldCBwYXNzZWQgYXV0b21hdGljYWxseVxuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5jb25uZWN0ZWQgPSB0aGlzLm9uQ29ubmVjdGVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5kaXNjb25uZWN0ZWQgPSB0aGlzLm9uRGlzY29ubmVjdGVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5jYW5jZWxlZCA9IHRoaXMub25DYW5jZWxlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIucGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQgPSB0aGlzLm9uUGFydGljaXBhbnRVcGRhdGVDb21tYW5kUmVjZWl2ZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmxvY2tSb29tQ29tbWFuZFJlY2VpdmVkID0gdGhpcy5vbkxvY2tSb29tQ29tbWFuZFJlY2VpdmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5tdXRlQWxsQ29tbWFuZFJlY2VpdmVkID0gdGhpcy5vbk11dGVBbGxDb21tYW5kUmVjZWl2ZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnBhcnRpY2lwYW50Sm9pbkNvbW1hbmRSZWNlaXZlZCA9IHRoaXMub25QYXJ0aWNpcGFudEpvaW5Db21tYW5kUmVjZWl2ZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnBhcnRpY2lwYW50TGVhdmVDb21tYW5kUmVjZWl2ZWQgPSB0aGlzLm9uUGFydGljaXBhbnRMZWF2ZUNvbW1hbmRSZWNlaXZlZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIudHJhbnNsYXRpb25SZWNlaXZlZCA9IHRoaXMub25UcmFuc2xhdGlvblJlY2VpdmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5wYXJ0aWNpcGFudHNMaXN0UmVjZWl2ZWQgPSB0aGlzLm9uUGFydGljaXBhbnRzTGlzdFJlY2VpdmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5jb252ZXJzYXRpb25FeHBpcmF0aW9uID0gdGhpcy5vbkNvbnZlcnNhdGlvbkV4cGlyYXRpb247XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmNvbm5lY3QodGhpcy5wcml2Um9vbS50b2tlbiwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBKb2luIGEgY29udmVyc2F0aW9uIGFzIGEgcGFydGljaXBhbnQuXG4gICAgICogQHBhcmFtIHsgSVBhcnRpY2lwYW50IH0gcGFydGljaXBhbnQgLSBwYXJ0aWNpcGFudCB0byBhZGRcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgYWRkUGFydGljaXBhbnRBc3luYyhwYXJ0aWNpcGFudCwgY2IsIGVycikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChwYXJ0aWNpcGFudCwgXCJQYXJ0aWNpcGFudFwiKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLmFkZFBhcnRpY2lwYW50SW1wbEFzeW5jKHBhcnRpY2lwYW50KSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEpvaW4gYSBjb252ZXJzYXRpb24gYXMgYSBwYXJ0aWNpcGFudC5cbiAgICAgKiBAcGFyYW0gY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIG5pY2tuYW1lXG4gICAgICogQHBhcmFtIGxhbmdcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgam9pbkNvbnZlcnNhdGlvbkFzeW5jKGNvbnZlcnNhdGlvbklkLCBuaWNrbmFtZSwgbGFuZywgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVE9ET1xuICAgICAgICAgICAgLy8gaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgLy8gICAgIHRocm93IG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFN0YXJ0KTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShjb252ZXJzYXRpb25JZCwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcImNvbnZlcnNhdGlvbklkXCIpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShuaWNrbmFtZSwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcIm5pY2tuYW1lXCIpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShsYW5nLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwibGFuZ3VhZ2VcIikpO1xuICAgICAgICAgICAgLy8gam9pbiB0aGUgY29udmVyc2F0aW9uXG4gICAgICAgICAgICB0aGlzLnByaXZNYW5hZ2VyLmNyZWF0ZU9ySm9pbih0aGlzLnByaXZQcm9wZXJ0aWVzLCBjb252ZXJzYXRpb25JZCwgKChyb29tKSA9PiB7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQocm9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb25uZWN0KTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZSb29tID0gcm9vbTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb25maWcuYXV0aG9yaXphdGlvblRva2VuID0gcm9vbS5jb2duaXRpdmVTcGVlY2hBdXRoVG9rZW47XG4gICAgICAgICAgICAgICAgLy8gam9pbiBjYWxsYmFja1xuICAgICAgICAgICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNiKHJvb20uY29nbml0aXZlU3BlZWNoQXV0aFRva2VuKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlbGV0ZXMgYSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgZGVsZXRlQ29udmVyc2F0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGVsZXRlQ29udmVyc2F0aW9uSW1wbEFzeW5jKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICBkZWxldGVDb252ZXJzYXRpb25JbXBsQXN5bmMoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZQcm9wZXJ0aWVzLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJpdlJvb20udG9rZW4sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29ubmVjdCk7XG4gICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZNYW5hZ2VyLmxlYXZlKHRoaXMucHJpdlByb3BlcnRpZXMsIHRoaXMucHJpdlJvb20udG9rZW4pO1xuICAgICAgICAgICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIGNsb3NlIHRoZSBjbGllbnQgd2Vic29ja2V0c1xuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBlbmRDb252ZXJzYXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5lbmRDb252ZXJzYXRpb25JbXBsQXN5bmMoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIGVuZENvbnZlcnNhdGlvbkltcGxBc3luYygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvc2UodHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElzc3VlcyBhIHJlcXVlc3QgdG8gbG9jayB0aGUgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIGxvY2tDb252ZXJzYXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmlzRGlzcG9zZWQoKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNhblNlbmRBc0hvc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbnZlcnNhdGlvbi5yZXBsYWNlKFwie2NvbW1hbmR9XCIsIFwibG9ja1wiKSksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldExvY2tDb21tYW5kKHRydWUpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIG11dGUgdGhlIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBtdXRlQWxsUGFydGljaXBhbnRzQXN5bmMoY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplciwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgdXNlcidzIHBlcm1pc3Npb25zXG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZEFzSG9zdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29udmVyc2F0aW9uLnJlcGxhY2UoXCJ7Y29tbWFuZH1cIiwgXCJtdXRlXCIpKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0TXV0ZUFsbENvbW1hbmQodHJ1ZSksICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2soY2IsIGVycik7XG4gICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElzc3VlcyBhIHJlcXVlc3QgdG8gbXV0ZSBhIHBhcnRpY2lwYW50IGluIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gdXNlcklkXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIG11dGVQYXJ0aWNpcGFudEFzeW5jKHVzZXJJZCwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHVzZXJJZCwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcInVzZXJJZFwiKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgLy8gY2hlY2sgdGhlIGNvbm5lY3Rpb24gaXMgb3BlbiAoaG9zdCArIHBhcnRpY2lwYW50IGNhbiBwZXJmb3JtIHRoZSBtdXRlIGNvbW1hbmQpXG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBub3QgaG9zdCwgY2hlY2sgdGhlIHBhcnRpY2lwYW50IGlzIG5vdCBtdXRpbmcgYW5vdGhlciBwYXJ0aWNpcGFudFxuICAgICAgICAgICAgaWYgKCF0aGlzLm1lLmlzSG9zdCAmJiB0aGlzLm1lLmlkICE9PSB1c2VySWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFBhcnRpY2lwYW50LnJlcGxhY2UoXCJ7Y29tbWFuZH1cIiwgXCJtdXRlXCIpKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNoZWNrIHRoZSB1c2VyIGV4aXN0c1xuICAgICAgICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5wcml2UGFydGljaXBhbnRzLmdldFBhcnRpY2lwYW50SW5kZXgodXNlcklkKTtcbiAgICAgICAgICAgIGlmIChleGlzdHMgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLmludmFsaWRQYXJ0aWNpcGFudFJlcXVlc3QpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuc2VuZFJlcXVlc3QodGhpcy5nZXRNdXRlQ29tbWFuZCh1c2VySWQsIHRydWUpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIHJlbW92ZSBhIHBhcnRpY2lwYW50IGZyb20gdGhlIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSB1c2VySWRcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgcmVtb3ZlUGFydGljaXBhbnRBc3luYyh1c2VySWQsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIgJiYgdXNlcklkLmhhc093blByb3BlcnR5KFwiaWRcIikpIHtcbiAgICAgICAgICAgICAgICAvLyBBc3N1bWUgdGhpcyBpcyBhIHRyYW5zY3JpcHRpb24gcGFydGljaXBhbnRcbiAgICAgICAgICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucmVtb3ZlUGFydGljaXBhbnRJbXBsQXN5bmModXNlcklkKSwgY2IsIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSb29tLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5TZW5kQXNIb3N0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkUGFydGljaXBhbnQucmVwbGFjZShcIntjb21tYW5kfVwiLCBcInJlbW92ZVwiKSksIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxldCBwYXJ0aWNpcGFudElkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHVzZXJJZCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBwYXJ0aWNpcGFudElkID0gdXNlcklkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh1c2VySWQuaGFzT3duUHJvcGVydHkoXCJpZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0aWNpcGFudCA9IHVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgcGFydGljaXBhbnRJZCA9IHBhcnRpY2lwYW50LmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh1c2VySWQuaGFzT3duUHJvcGVydHkoXCJ1c2VySWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlciA9IHVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgcGFydGljaXBhbnRJZCA9IHVzZXIudXNlcklkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UocGFydGljaXBhbnRJZCwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcInVzZXJJZFwiKSk7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgdGhlIHBhcnRpY2lwYW50IGV4aXN0c1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wYXJ0aWNpcGFudHMuZmluZEluZGV4KChwKSA9PiBwLmlkID09PSBwYXJ0aWNpcGFudElkKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5pbnZhbGlkUGFydGljaXBhbnRSZXF1ZXN0KSwgZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0RWplY3RDb21tYW5kKHBhcnRpY2lwYW50SWQpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElzc3VlcyBhIHJlcXVlc3QgdG8gdW5sb2NrIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgdW5sb2NrQ29udmVyc2F0aW9uQXN5bmMoY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jYW5TZW5kQXNIb3N0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb252ZXJzYXRpb24ucmVwbGFjZShcIntjb21tYW5kfVwiLCBcInVubG9ja1wiKSksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldExvY2tDb21tYW5kKGZhbHNlKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSXNzdWVzIGEgcmVxdWVzdCB0byB1bm11dGUgYWxsIHBhcnRpY2lwYW50cyBpbiB0aGUgY29udmVyc2F0aW9uXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHVubXV0ZUFsbFBhcnRpY2lwYW50c0FzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZEFzSG9zdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29udmVyc2F0aW9uLnJlcGxhY2UoXCJ7Y29tbWFuZH1cIiwgXCJ1bm11dGUgYWxsXCIpKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0TXV0ZUFsbENvbW1hbmQoZmFsc2UpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJc3N1ZXMgYSByZXF1ZXN0IHRvIHVubXV0ZSBhIHBhcnRpY2lwYW50IGluIHRoZSBjb252ZXJzYXRpb25cbiAgICAgKiBAcGFyYW0gdXNlcklkXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHVubXV0ZVBhcnRpY2lwYW50QXN5bmModXNlcklkLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdklzRGlzcG9zZWQpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLmlzRGlzcG9zZWQoKSk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodXNlcklkLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwidXNlcklkXCIpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgY29ubmVjdGlvbiBpcyBvcGVuIChob3N0ICsgcGFydGljaXBhbnQgY2FuIHBlcmZvcm0gdGhlIG11dGUgY29tbWFuZClcbiAgICAgICAgICAgIGlmICghdGhpcy5jYW5TZW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIG5vdCBob3N0LCBjaGVjayB0aGUgcGFydGljaXBhbnQgaXMgbm90IG11dGluZyBhbm90aGVyIHBhcnRpY2lwYW50XG4gICAgICAgICAgICBpZiAoIXRoaXMubWUuaXNIb3N0ICYmIHRoaXMubWUuaWQgIT09IHVzZXJJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkUGFydGljaXBhbnQucmVwbGFjZShcIntjb21tYW5kfVwiLCBcIm11dGVcIikpLCBlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgdGhlIHVzZXIgZXhpc3RzXG4gICAgICAgICAgICBjb25zdCBleGlzdHMgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMuZ2V0UGFydGljaXBhbnRJbmRleCh1c2VySWQpO1xuICAgICAgICAgICAgaWYgKGV4aXN0cyA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMuaW52YWxpZFBhcnRpY2lwYW50UmVxdWVzdCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldE11dGVDb21tYW5kKHVzZXJJZCwgZmFsc2UpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kIGEgdGV4dCBtZXNzYWdlXG4gICAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgc2VuZFRleHRNZXNzYWdlQXN5bmMobWVzc2FnZSwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG1lc3NhZ2UsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJtZXNzYWdlXCIpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdlJvb20sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FuU2VuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBUT0RPOiBpcyBhIG1heCBsZW5ndGggY2hlY2sgcmVxdWlyZWQ/XG4gICAgICAgICAgICBpZiAobWVzc2FnZS5sZW5ndGggPiB0aGlzLnByaXZUZXh0TWVzc2FnZU1heExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IobmV3IEVycm9yKHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJtZXNzYWdlIGxlbmd0aFwiKSksIGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5zZW5kUmVxdWVzdCh0aGlzLmdldE1lc3NhZ2VDb21tYW5kKG1lc3NhZ2UpLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKGNiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pLCAoKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdHJhbnNsYXRlZCB0byBsYW5ndWFnZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBsYW5ndWFnZXMgLSBsYW5ndWFnZXMgdG8gdHJhbnNsYXRlIHRvXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHNldFRyYW5zbGF0ZWRMYW5ndWFnZXNBc3luYyhsYW5ndWFnZXMsIGNiLCBlcnIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2SXNEaXNwb3NlZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIuaXNEaXNwb3NlZCgpKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmQXJyYXlFbXB0eU9yV2hpdGVzcGFjZShsYW5ndWFnZXMsIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJsYW5ndWFnZXNcIikpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jYW5TZW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0U2V0VHJhbnNsYXRlVG9MYW5ndWFnZXNDb21tYW5kKGxhbmd1YWdlcyksICgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2soY2IsIGVycik7XG4gICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZSBuaWNrbmFtZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuaWNrbmFtZSAtIG5ldyBuaWNrbmFtZSBmb3IgdGhlIHJvb21cbiAgICAgKiBAcGFyYW0gY2JcbiAgICAgKiBAcGFyYW0gZXJyXG4gICAgICovXG4gICAgY2hhbmdlTmlja25hbWVBc3luYyhuaWNrbmFtZSwgY2IsIGVycikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZJc0Rpc3Bvc2VkKTtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplci5pc0Rpc3Bvc2VkKCkpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG5pY2tuYW1lLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwibmlja25hbWVcIikpO1xuICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Um9vbSwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jYW5TZW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKSwgZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25SZWNvZ25pemVyLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0Q2hhbmdlTmlja25hbWVDb21tYW5kKG5pY2tuYW1lKSwgKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYWxsYmFjayhjYiwgZXJyKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGRpc3Bvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKCEhdGhpcy5jb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcml2Q29uZmlnID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByaXZMYW5ndWFnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2Um9vbSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5wcml2VG9rZW4gPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdk1hbmFnZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMucHJpdklzQ29ubmVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzUmVhZHkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25uZWN0VHJhbnNjcmliZXJSZWNvZ25pemVyKHJlY29nbml6ZXIpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplci5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgcmVjb2duaXplci5lbmZvcmNlQXVkaW9HYXRpbmcoKTtcbiAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zY3JpYmVyUmVjb2duaXplciA9IHJlY29nbml6ZXI7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIuY29udmVyc2F0aW9uID0gdGhpcztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldEtlZXBBbGl2ZSgpIHtcbiAgICAgICAgY29uc3Qgbmlja25hbWUgPSAoISF0aGlzLm1lKSA/IHRoaXMubWUuZGlzcGxheU5hbWUgOiBcImRlZmF1bHRfbmlja25hbWVcIjtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGlkOiBcIjBcIixcbiAgICAgICAgICAgIG5pY2tuYW1lLFxuICAgICAgICAgICAgcGFydGljaXBhbnRJZDogdGhpcy5wcml2Um9vbS5wYXJ0aWNpcGFudElkLFxuICAgICAgICAgICAgcm9vbUlkOiB0aGlzLnByaXZSb29tLnJvb21JZCxcbiAgICAgICAgICAgIHR5cGU6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMua2VlcEFsaXZlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKiBlc2xpbnQtZW5hYmxlIEB0eXBlc2NyaXB0LWVzbGludC90eXBlZGVmICovXG4gICAgYWRkUGFydGljaXBhbnRJbXBsQXN5bmMocGFydGljaXBhbnQpIHtcbiAgICAgICAgY29uc3QgbmV3UGFydGljaXBhbnQgPSB0aGlzLnByaXZQYXJ0aWNpcGFudHMuYWRkT3JVcGRhdGVQYXJ0aWNpcGFudChwYXJ0aWNpcGFudCk7XG4gICAgICAgIGlmIChuZXdQYXJ0aWNpcGFudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2NyaWJlclJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb252ZXJzYXRpb25JbmZvID0gdGhpcy5jb252ZXJzYXRpb25JbmZvO1xuICAgICAgICAgICAgICAgIGNvbnZlcnNhdGlvbkluZm8ucGFydGljaXBhbnRzID0gW3BhcnRpY2lwYW50XTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLnB1c2hDb252ZXJzYXRpb25FdmVudChjb252ZXJzYXRpb25JbmZvLCBcImpvaW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVtb3ZlUGFydGljaXBhbnRJbXBsQXN5bmMocGFydGljaXBhbnQpIHtcbiAgICAgICAgdGhpcy5wcml2UGFydGljaXBhbnRzLmRlbGV0ZVBhcnRpY2lwYW50KHBhcnRpY2lwYW50LmlkKTtcbiAgICAgICAgY29uc3QgY29udmVyc2F0aW9uSW5mbyA9IHRoaXMuY29udmVyc2F0aW9uSW5mbztcbiAgICAgICAgY29udmVyc2F0aW9uSW5mby5wYXJ0aWNpcGFudHMgPSBbcGFydGljaXBhbnRdO1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNjcmliZXJSZWNvZ25pemVyLnB1c2hDb252ZXJzYXRpb25FdmVudChjb252ZXJzYXRpb25JbmZvLCBcImxlYXZlXCIpO1xuICAgIH1cbiAgICBjbG9zZShkaXNwb3NlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCAoKF9hID0gdGhpcy5wcml2Q29udmVyc2F0aW9uUmVjb2duaXplcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3NlKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvblJlY29nbml6ZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKCEhdGhpcy5wcml2Q29udmVyc2F0aW9uVHJhbnNsYXRvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb25UcmFuc2xhdG9yLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvclxuICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGlzcG9zZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqIEhlbHBlcnMgKi9cbiAgICBoYW5kbGVDYWxsYmFjayhjYiwgZXJyKSB7XG4gICAgICAgIGlmICghIWNiKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmICghIWVycikge1xuICAgICAgICAgICAgICAgICAgICBlcnIoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2IgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFuZGxlRXJyb3IoZXJyb3IsIGVycikge1xuICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHlwZWRFcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgIGVycih0eXBlZEVycm9yLm5hbWUgKyBcIjogXCIgKyB0eXBlZEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZXJyKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKiogUGFydGljaXBhbnQgSGVscGVycyAqL1xuICAgIHRvUGFydGljaXBhbnRzKGluY2x1ZGVIb3N0KSB7XG4gICAgICAgIGNvbnN0IHBhcnRpY2lwYW50cyA9IHRoaXMucHJpdlBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudHMubWFwKChwKSA9PiAodGhpcy50b1BhcnRpY2lwYW50KHApKSk7XG4gICAgICAgIGlmICghaW5jbHVkZUhvc3QpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJ0aWNpcGFudHMuZmlsdGVyKChwKSA9PiBwLmlzSG9zdCA9PT0gZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnRpY2lwYW50cztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1BhcnRpY2lwYW50KHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJ0aWNpcGFudChwLmlkLCBwLmF2YXRhciwgcC5kaXNwbGF5TmFtZSwgcC5pc0hvc3QsIHAuaXNNdXRlZCwgcC5pc1VzaW5nVHRzLCBwLnByZWZlcnJlZExhbmd1YWdlLCBwLnZvaWNlKTtcbiAgICB9XG4gICAgZ2V0TXV0ZUFsbENvbW1hbmQoaXNNdXRlZCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5yb29tSWQsIFwiY29udmVyc2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbW1hbmQ6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0TXV0ZUFsbCxcbiAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHRoaXMucHJpdlJvb20ucGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIHJvb21pZDogdGhpcy5wcml2Um9vbS5yb29tSWQsXG4gICAgICAgICAgICB0eXBlOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLnBhcnRpY2lwYW50Q29tbWFuZCxcbiAgICAgICAgICAgIHZhbHVlOiBpc011dGVkXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRNdXRlQ29tbWFuZChwYXJ0aWNpcGFudElkLCBpc011dGVkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnJvb21JZCwgXCJjb252ZXJzYXRpb25JZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbW1hbmQ6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0TXV0ZSxcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBvYmplY3Qtc2hvcnRoYW5kXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiBwYXJ0aWNpcGFudElkLFxuICAgICAgICAgICAgcm9vbWlkOiB0aGlzLnByaXZSb29tLnJvb21JZCxcbiAgICAgICAgICAgIHR5cGU6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMucGFydGljaXBhbnRDb21tYW5kLFxuICAgICAgICAgICAgdmFsdWU6IGlzTXV0ZWRcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldExvY2tDb21tYW5kKGlzTG9ja2VkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnJvb21JZCwgXCJjb252ZXJzYXRpb25JZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJpdlJvb20ucGFydGljaXBhbnRJZCwgXCJwYXJ0aWNpcGFudElkXCIpO1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgY29tbWFuZDogQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbW1hbmRUeXBlcy5zZXRMb2NrU3RhdGUsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiB0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICByb29taWQ6IHRoaXMucHJpdlJvb20ucm9vbUlkLFxuICAgICAgICAgICAgdHlwZTogQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5wYXJ0aWNpcGFudENvbW1hbmQsXG4gICAgICAgICAgICB2YWx1ZTogaXNMb2NrZWRcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldEVqZWN0Q29tbWFuZChwYXJ0aWNpcGFudElkKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnJvb21JZCwgXCJjb252ZXJzYXRpb25JZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbW1hbmQ6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuZWplY3RQYXJ0aWNpcGFudCxcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBvYmplY3Qtc2hvcnRoYW5kXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiBwYXJ0aWNpcGFudElkLFxuICAgICAgICAgICAgcm9vbWlkOiB0aGlzLnByaXZSb29tLnJvb21JZCxcbiAgICAgICAgICAgIHR5cGU6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JNZXNzYWdlVHlwZXMucGFydGljaXBhbnRDb21tYW5kLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0U2V0VHJhbnNsYXRlVG9MYW5ndWFnZXNDb21tYW5kKGxhbmd1YWdlcykge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5yb29tSWQsIFwiY29udmVyc2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbW1hbmQ6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuc2V0VHJhbnNsYXRlVG9MYW5ndWFnZXMsXG4gICAgICAgICAgICBwYXJ0aWNpcGFudElkOiB0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsXG4gICAgICAgICAgICByb29taWQ6IHRoaXMucHJpdlJvb20ucm9vbUlkLFxuICAgICAgICAgICAgdHlwZTogQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5wYXJ0aWNpcGFudENvbW1hbmQsXG4gICAgICAgICAgICB2YWx1ZTogbGFuZ3VhZ2VzXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXRDaGFuZ2VOaWNrbmFtZUNvbW1hbmQobmlja25hbWUpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKHRoaXMucHJpdlJvb20ucm9vbUlkLCBcImNvbnZlcnNhdGlvbklkXCIpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2Uobmlja25hbWUsIFwibmlja25hbWVcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGNvbW1hbmQ6IENvbnZlcnNhdGlvblRyYW5zbGF0b3JDb21tYW5kVHlwZXMuY2hhbmdlTmlja25hbWUsXG4gICAgICAgICAgICBuaWNrbmFtZSxcbiAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHRoaXMucHJpdlJvb20ucGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIHJvb21pZDogdGhpcy5wcml2Um9vbS5yb29tSWQsXG4gICAgICAgICAgICB0eXBlOiBDb252ZXJzYXRpb25UcmFuc2xhdG9yTWVzc2FnZVR5cGVzLnBhcnRpY2lwYW50Q29tbWFuZCxcbiAgICAgICAgICAgIHZhbHVlOiBuaWNrbmFtZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0TWVzc2FnZUNvbW1hbmQobWVzc2FnZSkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcml2Um9vbS5yb29tSWQsIFwiY29udmVyc2F0aW9uSWRcIik7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByaXZSb29tLnBhcnRpY2lwYW50SWQsIFwicGFydGljaXBhbnRJZFwiKTtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG1lc3NhZ2UsIFwibWVzc2FnZVwiKTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHBhcnRpY2lwYW50SWQ6IHRoaXMucHJpdlJvb20ucGFydGljaXBhbnRJZCxcbiAgICAgICAgICAgIHJvb21JZDogdGhpcy5wcml2Um9vbS5yb29tSWQsXG4gICAgICAgICAgICB0ZXh0OiBtZXNzYWdlLFxuICAgICAgICAgICAgdHlwZTogQ29udmVyc2F0aW9uVHJhbnNsYXRvck1lc3NhZ2VUeXBlcy5pbnN0YW50TWVzc2FnZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbkNvbW1vbiB7XG4gICAgY29uc3RydWN0b3IoYXVkaW9Db25maWcpIHtcbiAgICAgICAgdGhpcy5wcml2QXVkaW9Db25maWcgPSBhdWRpb0NvbmZpZztcbiAgICB9XG4gICAgaGFuZGxlQ2FsbGJhY2soY2IsIGVycikge1xuICAgICAgICBpZiAoISFjYikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoISFlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNiID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhhbmRsZUVycm9yKGVycm9yLCBlcnIpIHtcbiAgICAgICAgaWYgKCEhZXJyKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHR5cGVkRXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICBlcnIodHlwZWRFcnJvci5uYW1lICsgXCI6IFwiICsgdHlwZWRFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVycihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvbkNvbW1vbi5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbmltcG9ydCB7IFNlc3Npb25FdmVudEFyZ3MgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvbkV4cGlyYXRpb25FdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICBjb25zdHJ1Y3RvcihleHBpcmF0aW9uVGltZSwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdkV4cGlyYXRpb25UaW1lID0gZXhwaXJhdGlvblRpbWU7XG4gICAgfVxuICAgIC8qKiBIb3cgbXVjaCBsb25nZXIgdW50aWwgdGhlIGNvbnZlcnNhdGlvbiBleHBpcmVzIChpbiBtaW51dGVzKS4gKi9cbiAgICBnZXQgZXhwaXJhdGlvblRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFeHBpcmF0aW9uVGltZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvbkV4cGlyYXRpb25FdmVudEFyZ3MuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8vIE11bHRpLWRldmljZSBDb252ZXJzYXRpb24gaXMgYSBQcmV2aWV3IGZlYXR1cmUuXG5pbXBvcnQgeyBTZXNzaW9uRXZlbnRBcmdzIH0gZnJvbSBcIi4uL0V4cG9ydHNcIjtcbmV4cG9ydCBjbGFzcyBDb252ZXJzYXRpb25QYXJ0aWNpcGFudHNDaGFuZ2VkRXZlbnRBcmdzIGV4dGVuZHMgU2Vzc2lvbkV2ZW50QXJncyB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBwYXJ0aWNpcGFudHMsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdlBhcnRpY2lwYW50ID0gcGFydGljaXBhbnRzO1xuICAgIH1cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICBnZXQgcGFydGljaXBhbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UGFydGljaXBhbnQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25QYXJ0aWNpcGFudHNDaGFuZ2VkRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCB7IFRyYW5zY3JpYmVyUmVjb2duaXplciB9IGZyb20gXCIuLi8uLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IENvbm5lY3Rpb24sIFByb3BlcnR5Q29sbGVjdGlvbiwgUHJvcGVydHlJZCB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIge1xuICAgIC8qKlxuICAgICAqIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyIGNvbnN0cnVjdG9yLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXVkaW9Db25maWd9IGF1ZGlvQ29uZmlnIC0gQW4gb3B0aW9uYWwgYXVkaW8gY29uZmlndXJhdGlvbiBhc3NvY2lhdGVkIHdpdGggdGhlIHJlY29nbml6ZXJcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhdWRpb0NvbmZpZykge1xuICAgICAgICB0aGlzLnByaXZBdWRpb0NvbmZpZyA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIgPSBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3Bva2VuIGxhbmd1YWdlIG9mIHJlY29nbml0aW9uLlxuICAgICAqIEBtZW1iZXIgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIucHJvdG90eXBlLnNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHNwb2tlbiBsYW5ndWFnZSBvZiByZWNvZ25pdGlvbi5cbiAgICAgKi9cbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gb2YgcHJvcGVydGllcyBhbmQgdGhlaXIgdmFsdWVzIGRlZmluZWQgZm9yIHRoaXMgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIuXG4gICAgICogQG1lbWJlciBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5cbiAgICAgKi9cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBJbnRlcm5hbFxuICAgICAqIEludGVybmFsIGRhdGEgbWVtYmVyIHRvIHN1cHBvcnQgZnJvbVJlY29nbml6ZXIqIHBhdHRlcm4gbWV0aG9kcyBvbiBvdGhlciBjbGFzc2VzLlxuICAgICAqIERvIG5vdCB1c2UgZXh0ZXJuYWxseSwgb2JqZWN0IHJldHVybmVkIHdpbGwgY2hhbmdlIHdpdGhvdXQgd2FybmluZyBvciBub3RpY2UuXG4gICAgICovXG4gICAgZ2V0IGludGVybmFsRGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlY29nbml6ZXIuaW50ZXJuYWxEYXRhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBARGVwcmVjYXRlZFxuICAgICAqIEBPYnNvbGV0ZVxuICAgICAqIFBsZWFzZSB1c2UgdGhlIENvbm5lY3Rpb24uZnJvbVJlY29nbml6ZXIgcGF0dGVybiB0byBvYnRhaW4gYSBjb25uZWN0aW9uIG9iamVjdFxuICAgICAqL1xuICAgIGdldCBjb25uZWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gQ29ubmVjdGlvbi5mcm9tUmVjb2duaXplcih0aGlzLnByaXZSZWNvZ25pemVyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXV0aG9yaXphdGlvbiB0b2tlbiB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIHNlcnZpY2UuXG4gICAgICogQG1lbWJlciBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLnByb3RvdHlwZS5hdXRob3JpemF0aW9uVG9rZW5cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRva2VuIC0gQXV0aG9yaXphdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBzZXQgYXV0aG9yaXphdGlvblRva2VuKHRva2VuKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0b2tlbiwgXCJ0b2tlblwiKTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnNldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUF1dGhvcml6YXRpb25fVG9rZW4sIHRva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtDb252ZXJzYXRpb259IGNvbnZlcnNhdGlvbiAtIGNvbnZlcnNhdGlvbiB0byBiZSByZWNvZ25pemVkXG4gICAgICovXG4gICAgam9pbkNvbnZlcnNhdGlvbkFzeW5jKGNvbnZlcnNhdGlvbiwgY2IsIGVycikge1xuICAgICAgICBjb25zdCBjb252ZXJzYXRpb25JbXBsID0gY29udmVyc2F0aW9uO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChjb252ZXJzYXRpb25JbXBsLCBcIkNvbnZlcnNhdGlvblwiKTtcbiAgICAgICAgLy8gcmVmIHRoZSBjb252ZXJzYXRpb24gb2JqZWN0XG4gICAgICAgIC8vIGNyZWF0ZSByZWNvZ25pemVyIGFuZCBzdWJzY3JpYmUgdG8gcmVjb2duaXplciBldmVudHNcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplciA9IG5ldyBUcmFuc2NyaWJlclJlY29nbml6ZXIoY29udmVyc2F0aW9uLmNvbmZpZywgdGhpcy5wcml2QXVkaW9Db25maWcpO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZSZWNvZ25pemVyLCBcIlJlY29nbml6ZXJcIik7XG4gICAgICAgIHRoaXMucHJpdlJlY29nbml6ZXIuY29ubmVjdENhbGxiYWNrcyh0aGlzKTtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyhjb252ZXJzYXRpb25JbXBsLmNvbm5lY3RUcmFuc2NyaWJlclJlY29nbml6ZXIodGhpcy5wcml2UmVjb2duaXplciksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgY29udmVyc2F0aW9uIHRyYW5zY3JpcHRpb24sIHVudGlsIHN0b3BUcmFuc2NyaWJpbmdBc3luYygpIGlzIGNhbGxlZC5cbiAgICAgKiBVc2VyIG11c3Qgc3Vic2NyaWJlIHRvIGV2ZW50cyB0byByZWNlaXZlIHRyYW5zY3JpcHRpb24gcmVzdWx0cy5cbiAgICAgKiBAbWVtYmVyIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLnByb3RvdHlwZS5zdGFydFRyYW5zY3JpYmluZ0FzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSBjYiAtIENhbGxiYWNrIGludm9rZWQgb25jZSB0aGUgdHJhbnNjcmlwdGlvbiBoYXMgc3RhcnRlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHN0YXJ0VHJhbnNjcmliaW5nQXN5bmMoY2IsIGVycikge1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmMoY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBjb252ZXJzYXRpb24gdHJhbnNjcmlwdGlvbiwgdW50aWwgc3RvcFRyYW5zY3JpYmluZ0FzeW5jKCkgaXMgY2FsbGVkLlxuICAgICAqIFVzZXIgbXVzdCBzdWJzY3JpYmUgdG8gZXZlbnRzIHRvIHJlY2VpdmUgdHJhbnNjcmlwdGlvbiByZXN1bHRzLlxuICAgICAqIEBtZW1iZXIgQ29udmVyc2F0aW9uVHJhbnNjcmliZXIucHJvdG90eXBlLnN0b3BUcmFuc2NyaWJpbmdBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayBpbnZva2VkIG9uY2UgdGhlIHRyYW5zY3JpcHRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdG9wVHJhbnNjcmliaW5nQXN5bmMoY2IsIGVycikge1xuICAgICAgICB0aGlzLnByaXZSZWNvZ25pemVyLnN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTGVhdmUgdGhlIGN1cnJlbnQgY29udmVyc2F0aW9uLiBBZnRlciB0aGlzIGlzIGNhbGxlZCwgeW91IHdpbGwgbm8gbG9uZ2VyIHJlY2VpdmUgYW55IGV2ZW50cy5cbiAgICAgKi9cbiAgICBsZWF2ZUNvbnZlcnNhdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgdGhpcy5wcml2UmVjb2duaXplci5kaXNjb25uZWN0Q2FsbGJhY2tzKCk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKCgoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7IHJldHVybjsgfSkpKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBjbG9zZXMgYWxsIGV4dGVybmFsIHJlc291cmNlcyBoZWxkIGJ5IGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQG1lbWJlciBDb252ZXJzYXRpb25UcmFuc2NyaWJlci5wcm90b3R5cGUuY2xvc2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgY2xvc2UoY2IsIGVycm9yQ2IpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZEaXNwb3NlZCh0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGlzcG9zZSh0cnVlKSwgY2IsIGVycm9yQ2IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlcyBhbnkgcmVzb3VyY2VzIGhlbGQgYnkgdGhlIG9iamVjdC5cbiAgICAgKiBAbWVtYmVyIENvbnZlcnNhdGlvblRyYW5zY3JpYmVyLnByb3RvdHlwZS5kaXNwb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzcG9zaW5nIC0gdHJ1ZSBpZiBkaXNwb3NpbmcgdGhlIG9iamVjdC5cbiAgICAgKi9cbiAgICBkaXNwb3NlKGRpc3Bvc2luZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkRpc3Bvc2VkUmVjb2duaXplcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnByaXZSZWNvZ25pemVyLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2UmVjb2duaXplciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZEaXNwb3NlZFJlY29nbml6ZXIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblRyYW5zY3JpYmVyLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vLyBNdWx0aS1kZXZpY2UgQ29udmVyc2F0aW9uIGlzIGEgUHJldmlldyBmZWF0dXJlLlxuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXZlbnRBcmdzQmFzZSB9IGZyb20gXCIuLi9DYW5jZWxsYXRpb25FdmVudEFyZ3NCYXNlXCI7XG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25DYW5jZWxlZEV2ZW50QXJncyBleHRlbmRzIENhbmNlbGxhdGlvbkV2ZW50QXJnc0Jhc2Uge1xufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2xhdGlvbkNhbmNlbGVkRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vLyBNdWx0aS1kZXZpY2UgQ29udmVyc2F0aW9uIGlzIGEgUHJldmlldyBmZWF0dXJlLlxuaW1wb3J0IHsgUmVjb2duaXRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uRXZlbnRBcmdzIGV4dGVuZHMgUmVjb2duaXRpb25FdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtDb252ZXJzYXRpb25UcmFuc2xhdGlvblJlc3VsdH0gcmVzdWx0IC0gVGhlIHRyYW5zbGF0aW9uIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2Zmc2V0IC0gVGhlIG9mZnNldC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2Vzc2lvbklkIC0gVGhlIHNlc3Npb24gaWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVzdWx0LCBvZmZzZXQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihvZmZzZXQsIHNlc3Npb25JZCk7XG4gICAgICAgIHRoaXMucHJpdlJlc3VsdCA9IHJlc3VsdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSByZWNvZ25pdGlvbiByZXN1bHQuXG4gICAgICogQHJldHVybnMge0NvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0fSB0aGUgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCByZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN1bHQ7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2xhdGlvbkV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbmltcG9ydCB7IFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi4vVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdFwiO1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0IGV4dGVuZHMgVHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdCB7XG4gICAgY29uc3RydWN0b3IocGFydGljaXBhbnRJZCwgdHJhbnNsYXRpb25zLCBvcmlnaW5hbExhbmd1YWdlLCByZXN1bHRJZCwgcmVhc29uLCB0ZXh0LCBkdXJhdGlvbiwgb2Zmc2V0LCBlcnJvckRldGFpbHMsIGpzb24sIHByb3BlcnRpZXMpIHtcbiAgICAgICAgc3VwZXIodHJhbnNsYXRpb25zLCByZXN1bHRJZCwgcmVhc29uLCB0ZXh0LCBkdXJhdGlvbiwgb2Zmc2V0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBwYXJ0aWNpcGFudElkO1xuICAgICAgICB0aGlzLnByaXZPcmlnTGFuZyA9IG9yaWdpbmFsTGFuZ3VhZ2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHBhcnRpY2lwYW50IHRoaXMgcmVzdWx0IGlzIGZvci5cbiAgICAgKi9cbiAgICBnZXQgcGFydGljaXBhbnRJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgb3JpZ2luYWwgbGFuZ3VhZ2UgdGhpcyByZXN1bHQgd2FzIGluLlxuICAgICAqL1xuICAgIGdldCBvcmlnaW5hbExhbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZPcmlnTGFuZztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vLyBNdWx0aS1kZXZpY2UgQ29udmVyc2F0aW9uIGlzIGEgUHJldmlldyBmZWF0dXJlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZywgU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uVHJhbnNsYXRvckNvbm5lY3Rpb25GYWN0b3J5IH0gZnJvbSBcIi4uLy4uL2NvbW1vbi5zcGVlY2gvVHJhbnNjcmlwdGlvbi9Db252ZXJzYXRpb25UcmFuc2xhdG9yQ29ubmVjdGlvbkZhY3RvcnlcIjtcbmltcG9ydCB7IG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MgfSBmcm9tIFwiLi4vLi4vY29tbW9uL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IEF1ZGlvQ29uZmlnLCBDYW5jZWxsYXRpb25FcnJvckNvZGUsIENhbmNlbGxhdGlvblJlYXNvbiwgUHJvZmFuaXR5T3B0aW9uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFByb3BlcnR5SWQsIFNlcnZpY2VQcm9wZXJ0eUNoYW5uZWwsIFNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLCBUcmFuc2xhdGlvblJlY29nbml6ZXIgfSBmcm9tIFwiLi4vRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uSW1wbCB9IGZyb20gXCIuL0NvbnZlcnNhdGlvblwiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uQ29tbW9uLCBDb252ZXJzYXRpb25UcmFuc2xhdGlvbkNhbmNlbGVkRXZlbnRBcmdzIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuZXhwb3J0IHZhciBTcGVlY2hTdGF0ZTtcbihmdW5jdGlvbiAoU3BlZWNoU3RhdGUpIHtcbiAgICBTcGVlY2hTdGF0ZVtTcGVlY2hTdGF0ZVtcIkluYWN0aXZlXCJdID0gMF0gPSBcIkluYWN0aXZlXCI7XG4gICAgU3BlZWNoU3RhdGVbU3BlZWNoU3RhdGVbXCJDb25uZWN0aW5nXCJdID0gMV0gPSBcIkNvbm5lY3RpbmdcIjtcbiAgICBTcGVlY2hTdGF0ZVtTcGVlY2hTdGF0ZVtcIkNvbm5lY3RlZFwiXSA9IDJdID0gXCJDb25uZWN0ZWRcIjtcbn0pKFNwZWVjaFN0YXRlIHx8IChTcGVlY2hTdGF0ZSA9IHt9KSk7XG4vLyBjaGlsZCBjbGFzcyBvZiBUcmFuc2xhdGlvblJlY29nbml6ZXIgbWVhbnQgb25seSBmb3IgdXNlIHdpdGggQ29udmVyc2F0aW9uVHJhbnNsYXRvclxuY2xhc3MgQ29udmVyc2F0aW9uVHJhbnNsYXRpb25SZWNvZ25pemVyIGV4dGVuZHMgVHJhbnNsYXRpb25SZWNvZ25pemVyIHtcbiAgICBjb25zdHJ1Y3RvcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnLCB0cmFuc2xhdG9yLCBjb252R2V0dGVyKSB7XG4gICAgICAgIHN1cGVyKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcsIG5ldyBDb252ZXJzYXRpb25UcmFuc2xhdG9yQ29ubmVjdGlvbkZhY3RvcnkoY29udkdldHRlcikpO1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IFNwZWVjaFN0YXRlLkluYWN0aXZlO1xuICAgICAgICBpZiAoISF0cmFuc2xhdG9yKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZUcmFuc2xhdG9yID0gdHJhbnNsYXRvcjtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvblN0YXJ0ZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoU3RhdGUgPSBTcGVlY2hTdGF0ZS5Db25uZWN0ZWQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5zZXNzaW9uU3RvcHBlZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IFNwZWVjaFN0YXRlLkluYWN0aXZlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucmVjb2duaXppbmcgPSAodHIsIGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnByaXZUcmFuc2xhdG9yLnJlY29nbml6aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0b3IucmVjb2duaXppbmcodGhpcy5wcml2VHJhbnNsYXRvciwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbWlzdXNlZC1wcm9taXNlc1xuICAgICAgICAgICAgdGhpcy5yZWNvZ25pemVkID0gKHRyLCBlKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGFuIGVycm9yIGNvbm5lY3RpbmcgdG8gdGhlIGNvbnZlcnNhdGlvbiBzZXJ2aWNlIGZyb20gdGhlIHNwZWVjaCBzZXJ2aWNlIHRoZSBlcnJvciB3aWxsIGJlIHJldHVybmVkIGluIHRoZSBFcnJvckRldGFpbHMgZmllbGQuXG4gICAgICAgICAgICAgICAgaWYgKChfYSA9IGUucmVzdWx0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZXJyb3JEZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGZvcm1hdCB0aGUgZXJyb3IgbWVzc2FnZSBjb250YWluZWQgaW4gJ2Vycm9yRGV0YWlscydcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlQ2FuY2VsRXZlbnQoZS5yZXN1bHQuZXJyb3JEZXRhaWxzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0b3IucmVjb2duaXplZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRvci5yZWNvZ25pemVkKHRoaXMucHJpdlRyYW5zbGF0b3IsIGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1taXN1c2VkLXByb21pc2VzXG4gICAgICAgICAgICB0aGlzLmNhbmNlbGVkID0gKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZTcGVlY2hTdGF0ZSAhPT0gU3BlZWNoU3RhdGUuSW5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IFNwZWVjaFN0YXRlLkluYWN0aXZlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHN0YXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U3BlZWNoU3RhdGU7XG4gICAgfVxuICAgIHNldCBzdGF0ZShuZXdTdGF0ZSkge1xuICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IG5ld1N0YXRlO1xuICAgIH1cbiAgICBvbkNvbm5lY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJpdlNwZWVjaFN0YXRlID0gU3BlZWNoU3RhdGUuQ29ubmVjdGVkO1xuICAgIH1cbiAgICBvbkRpc2Nvbm5lY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IFNwZWVjaFN0YXRlLkluYWN0aXZlO1xuICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxTcGVlY2goKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpcmUgYSBjYW5jZWwgZXZlbnRcbiAgICAgKiBAcGFyYW0gZXJyb3JcbiAgICAgKi9cbiAgICBmaXJlQ2FuY2VsRXZlbnQoZXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghIXRoaXMucHJpdlRyYW5zbGF0b3IuY2FuY2VsZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW5jZWxFdmVudCA9IG5ldyBDb252ZXJzYXRpb25UcmFuc2xhdGlvbkNhbmNlbGVkRXZlbnRBcmdzKENhbmNlbGxhdGlvblJlYXNvbi5FcnJvciwgZXJyb3IsIENhbmNlbGxhdGlvbkVycm9yQ29kZS5SdW50aW1lRXJyb3IpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlRyYW5zbGF0b3IuY2FuY2VsZWQodGhpcy5wcml2VHJhbnNsYXRvciwgY2FuY2VsRXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhbmNlbFNwZWVjaCgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYygpO1xuICAgICAgICAgICAgICAgIHlpZWxkICgoX2EgPSB0aGlzLnByaXZSZWNvKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZGlzY29ubmVjdCgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hTdGF0ZSA9IFNwZWVjaFN0YXRlLkluYWN0aXZlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgdGhlIGVycm9yXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbi8qKlxuICogSm9pbiwgbGVhdmUgb3IgY29ubmVjdCB0byBhIGNvbnZlcnNhdGlvbi5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbnZlcnNhdGlvblRyYW5zbGF0b3IgZXh0ZW5kcyBDb252ZXJzYXRpb25Db21tb24ge1xuICAgIGNvbnN0cnVjdG9yKGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIHN1cGVyKGF1ZGlvQ29uZmlnKTtcbiAgICAgICAgdGhpcy5wcml2RXJyb3JzID0gQ29udmVyc2F0aW9uQ29ubmVjdGlvbkNvbmZpZy5yZXN0RXJyb3JzO1xuICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucHJpdklzU3BlYWtpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wcml2UGxhY2Vob2xkZXJLZXkgPSBcImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1XCI7XG4gICAgICAgIHRoaXMucHJpdlBsYWNlaG9sZGVyUmVnaW9uID0gXCJ3ZXN0dXNcIjtcbiAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IG5ldyBQcm9wZXJ0eUNvbGxlY3Rpb24oKTtcbiAgICB9XG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBnZXQgc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlNwZWVjaFJlY29nbml0aW9uTGFuZ3VhZ2U7XG4gICAgfVxuICAgIGdldCBwYXJ0aWNpcGFudHMoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHRoaXMucHJpdkNvbnZlcnNhdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBhcnRpY2lwYW50cztcbiAgICB9XG4gICAgZ2V0IGNhblNwZWFrKCkge1xuICAgICAgICAvLyBpcyB0aGVyZSBhIENvbnZlcnNhdGlvbiB3ZWJzb2NrZXQgYXZhaWxhYmxlIGFuZCBoYXMgdGhlIFJlY29nbml6ZXIgYmVlbiBzZXQgdXBcbiAgICAgICAgaWYgKCF0aGlzLnByaXZDb252ZXJzYXRpb24uaXNDb25uZWN0ZWQgfHwgIXRoaXMucHJpdkNUUmVjb2duaXplcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlzIHRoZSB1c2VyIGFscmVhZHkgc3BlYWtpbmdcbiAgICAgICAgaWYgKHRoaXMucHJpdklzU3BlYWtpbmcgfHwgdGhpcy5wcml2Q1RSZWNvZ25pemVyLnN0YXRlID09PSBTcGVlY2hTdGF0ZS5Db25uZWN0ZWQgfHwgdGhpcy5wcml2Q1RSZWNvZ25pemVyLnN0YXRlID09PSBTcGVlY2hTdGF0ZS5Db25uZWN0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaXMgdGhlIHVzZXIgbXV0ZWRcbiAgICAgICAgaWYgKHRoaXMucHJpdkNvbnZlcnNhdGlvbi5pc011dGVkQnlIb3N0KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHNldFNlcnZpY2VQcm9wZXJ0eShuYW1lLCB2YWx1ZSkge1xuICAgICAgICBjb25zdCBjdXJyZW50UHJvcGVydGllcyA9IEpTT04ucGFyc2UodGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShTZXJ2aWNlUHJvcGVydGllc1Byb3BlcnR5TmFtZSwgXCJ7fVwiKSk7XG4gICAgICAgIGN1cnJlbnRQcm9wZXJ0aWVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRQcm9wZXJ0aWVzKSk7XG4gICAgfVxuICAgIGpvaW5Db252ZXJzYXRpb25Bc3luYyhjb252ZXJzYXRpb24sIG5pY2tuYW1lLCBwYXJhbTEsIHBhcmFtMiwgcGFyYW0zKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnZlcnNhdGlvbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKGNvbnZlcnNhdGlvbiwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcImNvbnZlcnNhdGlvbiBpZFwiKSk7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JXaGl0ZXNwYWNlKG5pY2tuYW1lLCB0aGlzLnByaXZFcnJvcnMuaW52YWxpZEFyZ3MucmVwbGFjZShcInthcmd9XCIsIFwibmlja25hbWVcIikpO1xuICAgICAgICAgICAgICAgIGlmICghIXRoaXMucHJpdkNvbnZlcnNhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFN0YXJ0KSwgcGFyYW0zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IGxhbmcgPSBwYXJhbTE7XG4gICAgICAgICAgICAgICAgaWYgKGxhbmcgPT09IHVuZGVmaW5lZCB8fCBsYW5nID09PSBudWxsIHx8IGxhbmcgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgbGFuZyA9IENvbnZlcnNhdGlvbkNvbm5lY3Rpb25Db25maWcuZGVmYXVsdExhbmd1YWdlQ29kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIGEgcGxhY2Vob2xkZXIgY29uZmlnXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcgPSBTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5mcm9tU3Vic2NyaXB0aW9uKHRoaXMucHJpdlBsYWNlaG9sZGVyS2V5LCB0aGlzLnByaXZQbGFjZWhvbGRlclJlZ2lvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcuc2V0UHJvZmFuaXR5KFByb2Zhbml0eU9wdGlvbi5NYXNrZWQpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmFkZFRhcmdldExhbmd1YWdlKGxhbmcpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLnNldFByb3BlcnR5KFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2VdLCBsYW5nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9OYW1lXSwgbmlja25hbWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5SWRzVG9Db3B5ID0gW1xuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0hvc3QsXG4gICAgICAgICAgICAgICAgICAgIFByb3BlcnR5SWQuQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9Ib3N0LFxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0VuZHBvaW50LFxuICAgICAgICAgICAgICAgICAgICBQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1Byb3h5SG9zdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9Qcm94eVBvcnQsXG4gICAgICAgICAgICAgICAgICAgIFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUHJveHlVc2VyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgXCJDb252ZXJzYXRpb25UcmFuc2xhdG9yX011bHRpQ2hhbm5lbEF1ZGlvXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiQ29udmVyc2F0aW9uVHJhbnNsYXRvcl9SZWdpb25cIlxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBwcm9wIG9mIHByb3BlcnR5SWRzVG9Db3B5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5wcml2UHJvcGVydGllcy5nZXRQcm9wZXJ0eShwcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSB0eXBlb2YgcHJvcCA9PT0gXCJzdHJpbmdcIiA/IHByb3AgOiBQcm9wZXJ0eUlkW3Byb3BdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcuc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFByb3BlcnRpZXMgPSBKU09OLnBhcnNlKHRoaXMucHJpdlByb3BlcnRpZXMuZ2V0UHJvcGVydHkoU2VydmljZVByb3BlcnRpZXNQcm9wZXJ0eU5hbWUsIFwie31cIikpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcHJvcCBvZiBPYmplY3Qua2V5cyhjdXJyZW50UHJvcGVydGllcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcuc2V0U2VydmljZVByb3BlcnR5KHByb3AsIGN1cnJlbnRQcm9wZXJ0aWVzW3Byb3BdLCBTZXJ2aWNlUHJvcGVydHlDaGFubmVsLlVyaVF1ZXJ5UGFyYW1ldGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gam9pbiB0aGUgY29udmVyc2F0aW9uXG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uID0gbmV3IENvbnZlcnNhdGlvbkltcGwodGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5jb252ZXJzYXRpb25UcmFuc2xhdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24uam9pbkNvbnZlcnNhdGlvbkFzeW5jKGNvbnZlcnNhdGlvbiwgbmlja25hbWUsIGxhbmcsICgocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZENvbm5lY3QpLCBwYXJhbTMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmF1dGhvcml6YXRpb25Ub2tlbiA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uLnJvb20uaXNIb3N0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbm5lY3QgdG8gdGhlIHdzXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5zdGFydENvbnZlcnNhdGlvbkFzeW5jKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhbGxiYWNrKHBhcmFtMiwgcGFyYW0zKTtcbiAgICAgICAgICAgICAgICAgICAgfSksICgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsIHBhcmFtMyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9KSwgKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBwYXJhbTMpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBjb252ZXJzYXRpb24gPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChjb252ZXJzYXRpb24sIHRoaXMucHJpdkVycm9ycy5pbnZhbGlkQXJncy5yZXBsYWNlKFwie2FyZ31cIiwgXCJjb252ZXJzYXRpb24gaWRcIikpO1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZShuaWNrbmFtZSwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcIm5pY2tuYW1lXCIpKTtcbiAgICAgICAgICAgICAgICAvLyBzYXZlIHRoZSBuaWNrbmFtZVxuICAgICAgICAgICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5Db252ZXJzYXRpb25UcmFuc2xhdG9yX05hbWUsIG5pY2tuYW1lKTtcbiAgICAgICAgICAgICAgICAvLyByZWYgdGhlIGNvbnZlcnNhdGlvbiBvYmplY3RcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24gPSBjb252ZXJzYXRpb247XG4gICAgICAgICAgICAgICAgLy8gcmVmIHRoZSBjb252ZXJzYXRpb24gdHJhbnNsYXRvciBvYmplY3RcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24uY29udmVyc2F0aW9uVHJhbnNsYXRvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uLnJvb20uaXNIb3N0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZDb252ZXJzYXRpb24sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29ubmVjdCk7XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q29udmVyc2F0aW9uLnJvb20udG9rZW4sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkQ29ubmVjdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcgPSBjb252ZXJzYXRpb24uY29uZmlnO1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FsbGJhY2socGFyYW0xLCBwYXJhbTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IodGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBcImludmFsaWQgY29udmVyc2F0aW9uIHR5cGVcIikpLCBwYXJhbTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgdHlwZW9mIHBhcmFtMSA9PT0gXCJzdHJpbmdcIiA/IHBhcmFtMyA6IHBhcmFtMik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogTGVhdmUgdGhlIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBsZWF2ZUNvbnZlcnNhdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcygoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgLy8gc3RvcCB0aGUgc3BlZWNoIHdlYnNvY2tldFxuICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxTcGVlY2goKTtcbiAgICAgICAgICAgIC8vIHN0b3AgdGhlIHdlYnNvY2tldFxuICAgICAgICAgICAgeWllbGQgdGhpcy5wcml2Q29udmVyc2F0aW9uLmVuZENvbnZlcnNhdGlvbkltcGxBc3luYygpO1xuICAgICAgICAgICAgLy8gaHR0cHMgZGVsZXRlIHJlcXVlc3RcbiAgICAgICAgICAgIHlpZWxkIHRoaXMucHJpdkNvbnZlcnNhdGlvbi5kZWxldGVDb252ZXJzYXRpb25JbXBsQXN5bmMoKTtcbiAgICAgICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgICB9KSkoKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmQgYSB0ZXh0IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSBjYlxuICAgICAqIEBwYXJhbSBlcnJcbiAgICAgKi9cbiAgICBzZW5kVGV4dE1lc3NhZ2VBc3luYyhtZXNzYWdlLCBjYiwgZXJyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZDb252ZXJzYXRpb24sIHRoaXMucHJpdkVycm9ycy5wZXJtaXNzaW9uRGVuaWVkU2VuZCk7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UobWVzc2FnZSwgdGhpcy5wcml2RXJyb3JzLmludmFsaWRBcmdzLnJlcGxhY2UoXCJ7YXJnfVwiLCBtZXNzYWdlKSk7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24uc2VuZFRleHRNZXNzYWdlQXN5bmMobWVzc2FnZSwgY2IsIGVycik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCBlcnIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHNwZWFraW5nXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHN0YXJ0VHJhbnNjcmliaW5nQXN5bmMoY2IsIGVycikge1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKCgoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHRoaXMucHJpdkNvbnZlcnNhdGlvbiwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRTZW5kKTtcbiAgICAgICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZCh0aGlzLnByaXZDb252ZXJzYXRpb24ucm9vbS50b2tlbiwgdGhpcy5wcml2RXJyb3JzLnBlcm1pc3Npb25EZW5pZWRDb25uZWN0KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2Q1RSZWNvZ25pemVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jb25uZWN0VHJhbnNsYXRvclJlY29nbml6ZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQodGhpcy5wcml2Q1RSZWNvZ25pemVyLCB0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5TcGVhaykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcih0aGlzLnByaXZFcnJvcnMucGVybWlzc2lvbkRlbmllZFNlbmQpLCBlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2SXNTcGVha2luZyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaXZJc1NwZWFraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxTcGVlY2goKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdG9wIHNwZWFraW5nXG4gICAgICogQHBhcmFtIGNiXG4gICAgICogQHBhcmFtIGVyclxuICAgICAqL1xuICAgIHN0b3BUcmFuc2NyaWJpbmdBc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3MoKCgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZJc1NwZWFraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHN0b3Agc3BlZWNoXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gc3RvcCB0aGUgcmVjb2duaXRpb24gYnV0IGxlYXZlIHRoZSB3ZWJzb2NrZXQgb3BlblxuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzU3BlYWtpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJpdkNUUmVjb2duaXplci5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmMocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSgpLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgaXNEaXNwb3NlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzRGlzcG9zZWQ7XG4gICAgfVxuICAgIGRpc3Bvc2UocmVhc29uLCBzdWNjZXNzLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcygoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCAmJiAhdGhpcy5wcml2SXNTcGVha2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHlpZWxkIHRoaXMuY2FuY2VsU3BlZWNoKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZJc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucHJpdlNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2UHJvcGVydGllcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMucHJpdkF1ZGlvQ29uZmlnID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnByaXZDb252ZXJzYXRpb24uZGlzcG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5wcml2Q29udmVyc2F0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICB9KSkoKSwgc3VjY2VzcywgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuY2VsIHRoZSBzcGVlY2ggd2Vic29ja2V0XG4gICAgICovXG4gICAgY2FuY2VsU3BlZWNoKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdklzU3BlYWtpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB5aWVsZCAoKF9hID0gdGhpcy5wcml2Q1RSZWNvZ25pemVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eub25EaXNjb25uZWN0aW9uKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkNUUmVjb2duaXplciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gaWdub3JlIHRoZSBlcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29ubmVjdCB0byB0aGUgc3BlZWNoIHRyYW5zbGF0aW9uIHJlY29nbml6ZXIuXG4gICAgICogQ3VycmVudGx5IHRoZXJlIGlzIG5vIGxhbmd1YWdlIHZhbGlkYXRpb24gcGVyZm9ybWVkIGJlZm9yZSBzZW5kaW5nIHRoZSBTcGVlY2hMYW5ndWFnZSBjb2RlIHRvIHRoZSBzZXJ2aWNlLlxuICAgICAqIElmIGl0J3MgYW4gaW52YWxpZCBsYW5ndWFnZSB0aGUgcmF3IGVycm9yIHdpbGwgYmU6ICdFcnJvciBkdXJpbmcgV2ViU29ja2V0IGhhbmRzaGFrZTogVW5leHBlY3RlZCByZXNwb25zZSBjb2RlOiA0MDAnXG4gICAgICogZS5nLiBwYXNzIGluICdmcicgaW5zdGVhZCBvZiAnZnItRlInLCBvciBhIHRleHQtb25seSBsYW5ndWFnZSAnY3knXG4gICAgICovXG4gICAgY29ubmVjdFRyYW5zbGF0b3JSZWNvZ25pemVyKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2QXVkaW9Db25maWcgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZBdWRpb0NvbmZpZyA9IEF1ZGlvQ29uZmlnLmZyb21EZWZhdWx0TWljcm9waG9uZUlucHV0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGNsZWFyIHRoZSB0ZW1wIHN1YnNjcmlwdGlvbiBrZXkgaWYgaXQncyBhIHBhcnRpY2lwYW50IGpvaW5pbmdcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcml2U3BlZWNoVHJhbnNsYXRpb25Db25maWcuZ2V0UHJvcGVydHkoUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX0tleV0pXG4gICAgICAgICAgICAgICAgICAgID09PSB0aGlzLnByaXZQbGFjZWhvbGRlcktleSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fS2V5XSwgXCJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnZHZXR0ZXIgPSAoKSA9PiB0aGlzLnByaXZDb252ZXJzYXRpb247XG4gICAgICAgICAgICAgICAgdGhpcy5wcml2Q1RSZWNvZ25pemVyID0gbmV3IENvbnZlcnNhdGlvblRyYW5zbGF0aW9uUmVjb2duaXplcih0aGlzLnByaXZTcGVlY2hUcmFuc2xhdGlvbkNvbmZpZywgdGhpcy5wcml2QXVkaW9Db25maWcsIHRoaXMsIGNvbnZHZXR0ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgdGhpcy5jYW5jZWxTcGVlY2goKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgc3RhcnQgc3BlYWtpbmcgcmVxdWVzdFxuICAgICAqL1xuICAgIHN0YXJ0Q29udGludW91c1JlY29nbml0aW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcml2Q1RSZWNvZ25pemVyLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmMocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Db252ZXJzYXRpb25UcmFuc2xhdG9yLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vLyBNdWx0aS1kZXZpY2UgQ29udmVyc2F0aW9uIGlzIGEgUHJldmlldyBmZWF0dXJlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IFByb3BlcnR5Q29sbGVjdGlvbiB9IGZyb20gXCIuLi9FeHBvcnRzXCI7XG5leHBvcnQgY2xhc3MgVXNlciB7XG4gICAgY29uc3RydWN0b3IodXNlcklkKSB7XG4gICAgICAgIHRoaXMucHJpdlVzZXJJZCA9IHVzZXJJZDtcbiAgICB9XG4gICAgZ2V0IHVzZXJJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlVzZXJJZDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgUGFydGljaXBhbnQge1xuICAgIGNvbnN0cnVjdG9yKGlkLCBhdmF0YXIsIGRpc3BsYXlOYW1lLCBpc0hvc3QsIGlzTXV0ZWQsIGlzVXNpbmdUdHMsIHByZWZlcnJlZExhbmd1YWdlLCB2b2ljZSkge1xuICAgICAgICB0aGlzLnByaXZJZCA9IGlkO1xuICAgICAgICB0aGlzLnByaXZBdmF0YXIgPSBhdmF0YXI7XG4gICAgICAgIHRoaXMucHJpdkRpc3BsYXlOYW1lID0gZGlzcGxheU5hbWU7XG4gICAgICAgIHRoaXMucHJpdklzSG9zdCA9IGlzSG9zdDtcbiAgICAgICAgdGhpcy5wcml2SXNNdXRlZCA9IGlzTXV0ZWQ7XG4gICAgICAgIHRoaXMucHJpdklzVXNpbmdUdHMgPSBpc1VzaW5nVHRzO1xuICAgICAgICB0aGlzLnByaXZQcmVmZXJyZWRMYW5ndWFnZSA9IHByZWZlcnJlZExhbmd1YWdlO1xuICAgICAgICB0aGlzLnByaXZWb2ljZSA9IHZvaWNlO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgIH1cbiAgICBnZXQgYXZhdGFyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2QXZhdGFyO1xuICAgIH1cbiAgICBnZXQgZGlzcGxheU5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEaXNwbGF5TmFtZTtcbiAgICB9XG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SWQ7XG4gICAgfVxuICAgIGdldCBwcmVmZXJyZWRMYW5ndWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByZWZlcnJlZExhbmd1YWdlO1xuICAgIH1cbiAgICBnZXQgaXNIb3N0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNIb3N0O1xuICAgIH1cbiAgICBnZXQgaXNNdXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklzTXV0ZWQ7XG4gICAgfVxuICAgIGdldCBpc1VzaW5nVHRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2SXNVc2luZ1R0cztcbiAgICB9XG4gICAgZ2V0IHZvaWNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Vm9pY2U7XG4gICAgfVxuICAgIGdldCBwcm9wZXJ0aWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvcGVydGllcztcbiAgICB9XG4gICAgc3RhdGljIEZyb20oaWQsIGxhbmd1YWdlLCB2b2ljZSkge1xuICAgICAgICByZXR1cm4gbmV3IFBhcnRpY2lwYW50KGlkLCBcIlwiLCBpZCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgbGFuZ3VhZ2UsIHZvaWNlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUlQYXJ0aWNpcGFudC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLy8gTXVsdGktZGV2aWNlIENvbnZlcnNhdGlvbiBpcyBhIFByZXZpZXcgZmVhdHVyZS5cbmV4cG9ydCB2YXIgUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uO1xuKGZ1bmN0aW9uIChQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24pIHtcbiAgICAvKiogUGFydGljaXBhbnQgaGFzIGpvaW5lZCB0aGUgY29udmVyc2F0aW9uLiAqL1xuICAgIFBhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbltQYXJ0aWNpcGFudENoYW5nZWRSZWFzb25bXCJKb2luZWRDb252ZXJzYXRpb25cIl0gPSAwXSA9IFwiSm9pbmVkQ29udmVyc2F0aW9uXCI7XG4gICAgLyoqIFBhcnRpY2lwYW50IGhhcyBsZWZ0IHRoZSBjb252ZXJzYXRpb24uIFRoaXMgY291bGQgYmUgdm9sdW50YXJ5LCBvciBpbnZvbHVudGFyeVxuICAgICAqIChlLmcuIHRoZXkgYXJlIGV4cGVyaWVuY2luZyBuZXR3b3JraW5nIGlzc3VlcykuXG4gICAgICovXG4gICAgUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uW1BhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbltcIkxlZnRDb252ZXJzYXRpb25cIl0gPSAxXSA9IFwiTGVmdENvbnZlcnNhdGlvblwiO1xuICAgIC8qKiBUaGUgcGFydGljaXBhbnRzJyBzdGF0ZSBoYXMgY2hhbmdlZCAoZS5nLiB0aGV5IGJlY2FtZSBtdXRlZCwgY2hhbmdlZCB0aGVpciBuaWNrbmFtZSkuICovXG4gICAgUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uW1BhcnRpY2lwYW50Q2hhbmdlZFJlYXNvbltcIlVwZGF0ZWRcIl0gPSAyXSA9IFwiVXBkYXRlZFwiO1xufSkoUGFydGljaXBhbnRDaGFuZ2VkUmVhc29uIHx8IChQYXJ0aWNpcGFudENoYW5nZWRSZWFzb24gPSB7fSkpO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1QYXJ0aWNpcGFudENoYW5nZWRSZWFzb24uanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbi8qKlxuICogRGVmaW5lIHBheWxvYWQgb2Ygc3BlZWNoIHJlY29nbml0aW9uIGNhbmNlbGVkIHJlc3VsdCBldmVudHMuXG4gKiBAY2xhc3MgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzXG4gKi9cbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25pZCAtIFRoZSBzZXNzaW9uIGlkLlxuICAgICAqIEBwYXJhbSB7Q2FuY2VsbGF0aW9uUmVhc29ufSBjYW5jZWxsYXRpb25SZWFzb24gLSBUaGUgY2FuY2VsbGF0aW9uIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXJyb3JEZXRhaWxzIC0gRXJyb3IgZGV0YWlscywgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0fSByZXN1bHQgLSBUaGUgcmVzdWx0LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlc3Npb25pZCwgY2FuY2VsbGF0aW9uUmVhc29uLCBlcnJvckRldGFpbHMsIGVycm9yQ29kZSwgcmVzdWx0KSB7XG4gICAgICAgIHRoaXMucHJpdkNhbmNlbFJlYXNvbiA9IGNhbmNlbGxhdGlvblJlYXNvbjtcbiAgICAgICAgdGhpcy5wcml2RXJyb3JEZXRhaWxzID0gZXJyb3JEZXRhaWxzO1xuICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgICAgIHRoaXMucHJpdlNlc3Npb25JZCA9IHNlc3Npb25pZDtcbiAgICAgICAgdGhpcy5wcml2RXJyb3JDb2RlID0gZXJyb3JDb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5wcm90b3R5cGUucmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0fSB0aGUgcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqL1xuICAgIGdldCByZXN1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgc2Vzc2lvbiBpZGVudGlmaWVyLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pdGlvbkNhbmNlbGVkRXZlbnRBcmdzLnByb3RvdHlwZS5zZXNzaW9uSWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge3N0cmluZ30gdGhlIHNlc3Npb24gaWRlbnRpZmllci5cbiAgICAgKi9cbiAgICBnZXQgc2Vzc2lvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2U2Vzc2lvbklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgcmVhc29uIHRoZSByZWNvZ25pdGlvbiB3YXMgY2FuY2VsZWQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MucHJvdG90eXBlLnJlYXNvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7Q2FuY2VsbGF0aW9uUmVhc29ufSBTcGVjaWZpZXMgdGhlIHJlYXNvbiBjYW5jZWxlZC5cbiAgICAgKi9cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2Q2FuY2VsUmVhc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZXJyb3IgY29kZSBpbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCByZWNvZ25pdGlvbi5cbiAgICAgKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMS4wLlxuICAgICAqIEByZXR1cm4gQW4gZXJyb3IgY29kZSB0aGF0IHJlcHJlc2VudHMgdGhlIGVycm9yIHJlYXNvbi5cbiAgICAgKi9cbiAgICBnZXQgZXJyb3JDb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JDb2RlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbiBjYXNlIG9mIGFuIHVuc3VjY2Vzc2Z1bCByZWNvZ25pdGlvbiwgcHJvdmlkZXMgZGV0YWlscyBvZiB0aGUgb2NjdXJyZWQgZXJyb3IuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml0aW9uQ2FuY2VsZWRFdmVudEFyZ3MucHJvdG90eXBlLmVycm9yRGV0YWlsc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBIFN0cmluZyB0aGF0IHJlcHJlc2VudHMgdGhlIGVycm9yIGRldGFpbHMuXG4gICAgICovXG4gICAgZ2V0IGVycm9yRGV0YWlscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkVycm9yRGV0YWlscztcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uUmVjb2duaXRpb25DYW5jZWxlZEV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUmVjb2duaXRpb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFRyYW5zbGF0aW9uIHRleHQgcmVzdWx0IGV2ZW50IGFyZ3VtZW50cy5cbiAqIEBjbGFzcyBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzXG4gKi9cbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblJlY29nbml0aW9uRXZlbnRBcmdzIGV4dGVuZHMgUmVjb2duaXRpb25FdmVudEFyZ3Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIGluaXRpYWxpemVzIGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtUcmFuc2xhdGlvblJlY29nbml0aW9uUmVzdWx0fSByZXN1bHQgLSBUaGUgdHJhbnNsYXRpb24gcmVjb2duaXRpb24gcmVzdWx0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvZmZzZXQgLSBUaGUgb2Zmc2V0LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHQsIG9mZnNldCwgc2Vzc2lvbklkKSB7XG4gICAgICAgIHN1cGVyKG9mZnNldCwgc2Vzc2lvbklkKTtcbiAgICAgICAgdGhpcy5wcml2UmVzdWx0ID0gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXRpb25FdmVudEFyZ3MucHJvdG90eXBlLnJlc3VsdFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7VHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdH0gdGhlIHJlY29nbml0aW9uIHJlc3VsdC5cbiAgICAgKi9cbiAgICBnZXQgcmVzdWx0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVzdWx0O1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25SZWNvZ25pdGlvbkV2ZW50QXJncy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgU3BlZWNoUmVjb2duaXRpb25SZXN1bHQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFRyYW5zbGF0aW9uIHRleHQgcmVzdWx0LlxuICogQGNsYXNzIFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHRcbiAqL1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQgZXh0ZW5kcyBTcGVlY2hSZWNvZ25pdGlvblJlc3VsdCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1RyYW5zbGF0aW9uc30gdHJhbnNsYXRpb25zIC0gVGhlIHRyYW5zbGF0aW9ucy5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVzdWx0SWQgLSBUaGUgcmVzdWx0IGlkLlxuICAgICAqIEBwYXJhbSB7UmVzdWx0UmVhc29ufSByZWFzb24gLSBUaGUgcmVhc29uLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gVGhlIHJlY29nbml6ZWQgdGV4dC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb24gLSBUaGUgZHVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQgaW50byB0aGUgc3RyZWFtLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZSAtIFByaW1hcnkgTGFuZ3VhZ2UgZGV0ZWN0ZWQsIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UgLSBQcmltYXJ5IExhbmd1YWdlIGNvbmZpZGVuY2UgKFwiVW5rbm93bixcIiBcIkxvdyxcIiBcIk1lZGl1bSxcIiBcIkhpZ2hcIi4uLiksIGlmIHByb3ZpZGVkLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBlcnJvckRldGFpbHMgLSBFcnJvciBkZXRhaWxzLCBpZiBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ganNvbiAtIEFkZGl0aW9uYWwgSnNvbiwgaWYgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtQcm9wZXJ0eUNvbGxlY3Rpb259IHByb3BlcnRpZXMgLSBBZGRpdGlvbmFsIHByb3BlcnRpZXMsIGlmIHByb3ZpZGVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHRyYW5zbGF0aW9ucywgcmVzdWx0SWQsIHJlYXNvbiwgdGV4dCwgZHVyYXRpb24sIG9mZnNldCwgbGFuZ3VhZ2UsIGxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHN1cGVyKHJlc3VsdElkLCByZWFzb24sIHRleHQsIGR1cmF0aW9uLCBvZmZzZXQsIGxhbmd1YWdlLCBsYW5ndWFnZURldGVjdGlvbkNvbmZpZGVuY2UsIHVuZGVmaW5lZCwgZXJyb3JEZXRhaWxzLCBqc29uLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgdGhpcy5wcml2VHJhbnNsYXRpb25zID0gdHJhbnNsYXRpb25zO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVNwZWVjaFJlY29nbml0aW9uUmVzdWx0KHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQodW5kZWZpbmVkLCByZXN1bHQucmVzdWx0SWQsIHJlc3VsdC5yZWFzb24sIHJlc3VsdC50ZXh0LCByZXN1bHQuZHVyYXRpb24sIHJlc3VsdC5vZmZzZXQsIHJlc3VsdC5sYW5ndWFnZSwgcmVzdWx0Lmxhbmd1YWdlRGV0ZWN0aW9uQ29uZmlkZW5jZSwgcmVzdWx0LmVycm9yRGV0YWlscywgcmVzdWx0Lmpzb24sIHJlc3VsdC5wcm9wZXJ0aWVzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJlc2VudHMgdGhlIHRyYW5zbGF0aW9uIHJlc3VsdHMuIEVhY2ggaXRlbSBpbiB0aGUgZGljdGlvbmFyeSByZXByZXNlbnRzXG4gICAgICogYSB0cmFuc2xhdGlvbiByZXN1bHQgaW4gb25lIG9mIHRhcmdldCBsYW5ndWFnZXMsIHdoZXJlIHRoZSBrZXkgaXMgdGhlIG5hbWVcbiAgICAgKiBvZiB0aGUgdGFyZ2V0IGxhbmd1YWdlLCBpbiBCQ1AtNDcgZm9ybWF0LCBhbmQgdGhlIHZhbHVlIGlzIHRoZSB0cmFuc2xhdGlvblxuICAgICAqIHRleHQgaW4gdGhlIHNwZWNpZmllZCBsYW5ndWFnZS5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXRpb25SZXN1bHQucHJvdG90eXBlLnRyYW5zbGF0aW9uc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7VHJhbnNsYXRpb25zfSB0aGUgY3VycmVudCB0cmFuc2xhdGlvbiBtYXAgdGhhdCBob2xkcyBhbGwgdHJhbnNsYXRpb25zIHJlcXVlc3RlZC5cbiAgICAgKi9cbiAgICBnZXQgdHJhbnNsYXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHJhbnNsYXRpb25zO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNsYXRpb25SZWNvZ25pdGlvblJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgeyBSZWNvZ25pdGlvbk1vZGUsIFJlY29nbml6ZXJDb25maWcsIFRyYW5zbGF0aW9uQ29ubmVjdGlvbkZhY3RvcnksIFRyYW5zbGF0aW9uU2VydmljZVJlY29nbml6ZXIgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzIH0gZnJvbSBcIi4uL2NvbW1vbi9FeHBvcnRzXCI7XG5pbXBvcnQgeyBDb25uZWN0aW9uIH0gZnJvbSBcIi4vQ29ubmVjdGlvblwiO1xuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBQcm9wZXJ0eUlkLCBSZWNvZ25pemVyIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBUcmFuc2xhdGlvbiByZWNvZ25pemVyXG4gKiBAY2xhc3MgVHJhbnNsYXRpb25SZWNvZ25pemVyXG4gKi9cbmV4cG9ydCBjbGFzcyBUcmFuc2xhdGlvblJlY29nbml6ZXIgZXh0ZW5kcyBSZWNvZ25pemVyIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGUgVHJhbnNsYXRpb25SZWNvZ25pemVyLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7U3BlZWNoVHJhbnNsYXRpb25Db25maWd9IHNwZWVjaENvbmZpZyAtIFNldCBvZiBwcm9wZXJ0aWVzIHRvIGNvbmZpZ3VyZSB0aGlzIHJlY29nbml6ZXIuXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBjb25maWcgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICogQHBhcmFtIHtJQ29ubmVjdGlvbkZhY3Rvcnl9IGNvbm5lY3Rpb25GYWN0b3J5IC0gQW4gb3B0aW9uYWwgY29ubmVjdGlvbiBmYWN0b3J5IHRvIHVzZSB0byBnZW5lcmF0ZSB0aGUgZW5kcG9pbnQgVVJJcywgaGVhZGVycyB0byBzZXQsIGV0Yy4uLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZywgYXVkaW9Db25maWcsIGNvbm5lY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZ0ltcGwgPSBzcGVlY2hDb25maWc7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbChjb25maWdJbXBsLCBcInNwZWVjaENvbmZpZ1wiKTtcbiAgICAgICAgc3VwZXIoYXVkaW9Db25maWcsIGNvbmZpZ0ltcGwucHJvcGVydGllcywgY29ubmVjdGlvbkZhY3RvcnkgfHwgbmV3IFRyYW5zbGF0aW9uQ29ubmVjdGlvbkZhY3RvcnkoKSk7XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlLCB1bmRlZmluZWQpICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblZvaWNlKSwgUHJvcGVydHlJZFtQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVm9pY2VdKTtcbiAgICAgICAgfVxuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcyksIFByb3BlcnR5SWRbUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzXSk7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yV2hpdGVzcGFjZSh0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9SZWNvTGFuZ3VhZ2UpLCBQcm9wZXJ0eUlkW1Byb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fUmVjb0xhbmd1YWdlXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRyYW5zbGF0aW9uUmVjb2duaXplciBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaFRyYW5zbGF0aW9uQ29uZmlnfSBzcGVlY2hUcmFuc2xhdGlvbkNvbmZpZyAtIGFuIHNldCBvZiBpbml0aWFsIHByb3BlcnRpZXMgZm9yIHRoaXMgcmVjb2duaXplclxuICAgICAqIEBwYXJhbSB7QXV0b0RldGVjdFNvdXJjZUxhbmd1YWdlQ29uZmlnfSBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcgLSBBbiBzb3VyY2UgbGFuZ3VhZ2UgZGV0ZWN0aW9uIGNvbmZpZ3VyYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSByZWNvZ25pemVyXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgLSBBbiBvcHRpb25hbCBhdWRpbyBjb25maWd1cmF0aW9uIGFzc29jaWF0ZWQgd2l0aCB0aGUgcmVjb2duaXplclxuICAgICAqL1xuICAgIHN0YXRpYyBGcm9tQ29uZmlnKHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnLCBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIGNvbnN0IHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbCA9IHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnO1xuICAgICAgICBhdXRvRGV0ZWN0U291cmNlTGFuZ3VhZ2VDb25maWcucHJvcGVydGllcy5tZXJnZVRvKHNwZWVjaFRyYW5zbGF0aW9uQ29uZmlnSW1wbC5wcm9wZXJ0aWVzKTtcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2xhdGlvblJlY29nbml6ZXIoc3BlZWNoVHJhbnNsYXRpb25Db25maWcsIGF1ZGlvQ29uZmlnKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbGFuZ3VhZ2UgbmFtZSB0aGF0IHdhcyBzZXQgd2hlbiB0aGUgcmVjb2duaXplciB3YXMgY3JlYXRlZC5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUuc3BlZWNoUmVjb2duaXRpb25MYW5ndWFnZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBHZXRzIHRoZSBsYW5ndWFnZSBuYW1lIHRoYXQgd2FzIHNldCB3aGVuIHRoZSByZWNvZ25pemVyIHdhcyBjcmVhdGVkLlxuICAgICAqL1xuICAgIGdldCBzcGVlY2hSZWNvZ25pdGlvbkxhbmd1YWdlKCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1JlY29MYW5ndWFnZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGFyZ2V0IGxhbmd1YWdlcyBmb3IgdHJhbnNsYXRpb24gdGhhdCB3ZXJlIHNldCB3aGVuIHRoZSByZWNvZ25pemVyIHdhcyBjcmVhdGVkLlxuICAgICAqIFRoZSBsYW5ndWFnZSBpcyBzcGVjaWZpZWQgaW4gQkNQLTQ3IGZvcm1hdC4gVGhlIHRyYW5zbGF0aW9uIHdpbGwgcHJvdmlkZSB0cmFuc2xhdGVkIHRleHQgZm9yIGVhY2ggb2YgbGFuZ3VhZ2UuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnRhcmdldExhbmd1YWdlc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IEdldHMgdGFyZ2V0IGxhbmd1YWdlcyBmb3IgdHJhbnNsYXRpb24gdGhhdCB3ZXJlIHNldCB3aGVuIHRoZSByZWNvZ25pemVyIHdhcyBjcmVhdGVkLlxuICAgICAqL1xuICAgIGdldCB0YXJnZXRMYW5ndWFnZXMoKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRUcmFuc2xhdGlvblJlY29nbml6ZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcykuc3BsaXQoXCIsXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBuYW1lIG9mIG91dHB1dCB2b2ljZS5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUudm9pY2VOYW1lXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHRoZSBuYW1lIG9mIG91dHB1dCB2b2ljZS5cbiAgICAgKi9cbiAgICBnZXQgdm9pY2VOYW1lKCkge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZkRpc3Bvc2VkKHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVm9pY2UsIHVuZGVmaW5lZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFRyYW5zbGF0aW9uUmVjb2duaXplci5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBUcmFuc2xhdGlvblJlY29nbml6ZXIuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih2YWx1ZSkge1xuICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQXV0aG9yaXphdGlvbl9Ub2tlbiwgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgcmVjb2duaXRpb24gYW5kIHRyYW5zbGF0aW9uLCBhbmQgc3RvcHMgYWZ0ZXIgdGhlIGZpcnN0IHV0dGVyYW5jZSBpcyByZWNvZ25pemVkLlxuICAgICAqIFRoZSB0YXNrIHJldHVybnMgdGhlIHRyYW5zbGF0aW9uIHRleHQgYXMgcmVzdWx0LlxuICAgICAqIE5vdGU6IHJlY29nbml6ZU9uY2VBc3luYyByZXR1cm5zIHdoZW4gdGhlIGZpcnN0IHV0dGVyYW5jZSBoYXMgYmVlbiByZWNvZ25pemVkLCBzbyBpdCBpcyBzdWl0YWJsZSBvbmx5XG4gICAgICogZm9yIHNpbmdsZSBzaG90IHJlY29nbml0aW9uIGxpa2UgY29tbWFuZCBvciBxdWVyeS4gRm9yIGxvbmctcnVubmluZyByZWNvZ25pdGlvbixcbiAgICAgKiB1c2Ugc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luYygpIGluc3RlYWQuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnJlY29nbml6ZU9uY2VBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSByZXN1bHQgd2hlbiB0aGUgdHJhbnNsYXRpb24gaGFzIGNvbXBsZXRlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHJlY29nbml6ZU9uY2VBc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRUcmFuc2xhdGlvblJlY29nbml6ZXIpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMucmVjb2duaXplT25jZUFzeW5jSW1wbChSZWNvZ25pdGlvbk1vZGUuQ29udmVyc2F0aW9uKSwgY2IsIGVycik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyByZWNvZ25pdGlvbiBhbmQgdHJhbnNsYXRpb24sIHVudGlsIHN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYygpIGlzIGNhbGxlZC5cbiAgICAgKiBVc2VyIG11c3Qgc3Vic2NyaWJlIHRvIGV2ZW50cyB0byByZWNlaXZlIHRyYW5zbGF0aW9uIHJlc3VsdHMuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHBhcmFtIGNiIC0gQ2FsbGJhY2sgdGhhdCByZWNlaXZlZCB0aGUgdHJhbnNsYXRpb24gaGFzIHN0YXJ0ZWQuXG4gICAgICogQHBhcmFtIGVyciAtIENhbGxiYWNrIGludm9rZWQgaW4gY2FzZSBvZiBhbiBlcnJvci5cbiAgICAgKi9cbiAgICBzdGFydENvbnRpbnVvdXNSZWNvZ25pdGlvbkFzeW5jKGNiLCBlcnIpIHtcbiAgICAgICAgbWFyc2hhbFByb21pc2VUb0NhbGxiYWNrcyh0aGlzLnN0YXJ0Q29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKFJlY29nbml0aW9uTW9kZS5Db252ZXJzYXRpb24pLCBjYiwgZXJyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcHMgY29udGludW91cyByZWNvZ25pdGlvbiBhbmQgdHJhbnNsYXRpb24uXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0gY2IgLSBDYWxsYmFjayB0aGF0IHJlY2VpdmVkIHRoZSB0cmFuc2xhdGlvbiBoYXMgc3RvcHBlZC5cbiAgICAgKiBAcGFyYW0gZXJyIC0gQ2FsbGJhY2sgaW52b2tlZCBpbiBjYXNlIG9mIGFuIGVycm9yLlxuICAgICAqL1xuICAgIHN0b3BDb250aW51b3VzUmVjb2duaXRpb25Bc3luYyhjYiwgZXJyKSB7XG4gICAgICAgIG1hcnNoYWxQcm9taXNlVG9DYWxsYmFja3ModGhpcy5zdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmNJbXBsKCksIGNiLCBlcnIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBkeW5hbWljYWxseSByZW1vdmUgYSBsYW5ndWFnZSBmcm9tIGxpc3Qgb2YgdGFyZ2V0IGxhbmd1YWdlXG4gICAgICogKGNhbiBiZSB1c2VkIHdoaWxlIHJlY29nbml0aW9uIGlzIG9uZ29pbmcpXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLnJlbW92ZVRhcmdldExhbmd1YWdlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIGxhbmcgLSBsYW5ndWFnZSB0byBiZSByZW1vdmVkXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIHJlbW92ZVRhcmdldExhbmd1YWdlKGxhbmcpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQobGFuZywgXCJsYW5ndWFnZSB0byBiZSByZW1vdmVkXCIpO1xuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcywgdW5kZWZpbmVkKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBsYW5ndWFnZXMgPSB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzKS5zcGxpdChcIixcIik7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGxhbmd1YWdlcy5pbmRleE9mKGxhbmcpO1xuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICBsYW5ndWFnZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzLCBsYW5ndWFnZXMuam9pbihcIixcIikpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTGFuZ3VhZ2VzKGxhbmd1YWdlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogZHluYW1pY2FsbHkgYWRkIGEgbGFuZ3VhZ2UgdG8gbGlzdCBvZiB0YXJnZXQgbGFuZ3VhZ2VcbiAgICAgKiAoY2FuIGJlIHVzZWQgd2hpbGUgcmVjb2duaXRpb24gaXMgb25nb2luZylcbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uUmVjb2duaXplci5wcm90b3R5cGUuYWRkVGFyZ2V0TGFuZ3VhZ2VcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0gbGFuZyAtIGxhbmd1YWdlIHRvIGJlIGFkZGVkXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGFkZFRhcmdldExhbmd1YWdlKGxhbmcpIHtcbiAgICAgICAgQ29udHJhY3RzLnRocm93SWZOdWxsT3JVbmRlZmluZWQobGFuZywgXCJsYW5ndWFnZSB0byBiZSBhZGRlZFwiKTtcbiAgICAgICAgbGV0IGxhbmd1YWdlcyA9IFtdO1xuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KFByb3BlcnR5SWQuU3BlZWNoU2VydmljZUNvbm5lY3Rpb25fVHJhbnNsYXRpb25Ub0xhbmd1YWdlcywgdW5kZWZpbmVkKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBsYW5ndWFnZXMgPSB0aGlzLnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzKS5zcGxpdChcIixcIik7XG4gICAgICAgICAgICBpZiAoIWxhbmd1YWdlcy5pbmNsdWRlcyhsYW5nKSkge1xuICAgICAgICAgICAgICAgIGxhbmd1YWdlcy5wdXNoKGxhbmcpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VDb25uZWN0aW9uX1RyYW5zbGF0aW9uVG9MYW5ndWFnZXMsIGxhbmd1YWdlcy5qb2luKFwiLFwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByb3BlcnRpZXMuc2V0UHJvcGVydHkoUHJvcGVydHlJZC5TcGVlY2hTZXJ2aWNlQ29ubmVjdGlvbl9UcmFuc2xhdGlvblRvTGFuZ3VhZ2VzLCBsYW5nKTtcbiAgICAgICAgICAgIGxhbmd1YWdlcyA9IFtsYW5nXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUxhbmd1YWdlcyhsYW5ndWFnZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBjbG9zZXMgYWxsIGV4dGVybmFsIHJlc291cmNlcyBoZWxkIGJ5IGFuIGluc3RhbmNlIG9mIHRoaXMgY2xhc3MuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLmNsb3NlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlKGNiLCBlcnJvckNiKSB7XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmRGlzcG9zZWQodGhpcy5wcml2RGlzcG9zZWRUcmFuc2xhdGlvblJlY29nbml6ZXIpO1xuICAgICAgICBtYXJzaGFsUHJvbWlzZVRvQ2FsbGJhY2tzKHRoaXMuZGlzcG9zZSh0cnVlKSwgY2IsIGVycm9yQ2IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBoYW5kbGVzIENvbm5lY3Rpb25Fc3RhYmxpc2hlZEV2ZW50IGZvciBjb252ZXJzYXRpb24gdHJhbnNsYXRpb24gc2NlbmFyaW9zLlxuICAgICAqIEBtZW1iZXIgVHJhbnNsYXRpb25SZWNvZ25pemVyLnByb3RvdHlwZS5vbkNvbm5lY3Rpb25cbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIG9uQ29ubmVjdGlvbigpIHsgfVxuICAgIC8qKlxuICAgICAqIGhhbmRsZXMgZGlzY29ubmVjdGlvbiBldmVudHMgZm9yIGNvbnZlcnNhdGlvbiB0cmFuc2xhdGlvbiBzY2VuYXJpb3MuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblJlY29nbml6ZXIucHJvdG90eXBlLm9uRGlzY29ubmVjdGlvblxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uXG4gICAgb25EaXNjb25uZWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgeyB9KTtcbiAgICB9XG4gICAgZGlzcG9zZShkaXNwb3NpbmcpIHtcbiAgICAgICAgY29uc3QgX3N1cGVyID0gT2JqZWN0LmNyZWF0ZShudWxsLCB7XG4gICAgICAgICAgICBkaXNwb3NlOiB7IGdldDogKCkgPT4gc3VwZXIuZGlzcG9zZSB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJpdkRpc3Bvc2VkVHJhbnNsYXRpb25SZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcml2RGlzcG9zZWRUcmFuc2xhdGlvblJlY29nbml6ZXIgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGRpc3Bvc2luZykge1xuICAgICAgICAgICAgICAgIHlpZWxkIHRoaXMuaW1wbFJlY29nbml6ZXJTdG9wKCk7XG4gICAgICAgICAgICAgICAgeWllbGQgX3N1cGVyLmRpc3Bvc2UuY2FsbCh0aGlzLCBkaXNwb3NpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlUmVjb2duaXplckNvbmZpZyhzcGVlY2hDb25maWcpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZywgdGhpcy5wcml2UHJvcGVydGllcyk7XG4gICAgfVxuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgY29uZmlnSW1wbCA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW9uU2VydmljZVJlY29nbml6ZXIoYXV0aGVudGljYXRpb24sIGNvbm5lY3Rpb25GYWN0b3J5LCBjb25maWdJbXBsLCByZWNvZ25pemVyQ29uZmlnLCB0aGlzKTtcbiAgICB9XG4gICAgdXBkYXRlTGFuZ3VhZ2VzKGxhbmd1YWdlcykge1xuICAgICAgICBjb25zdCBjb25uID0gQ29ubmVjdGlvbi5mcm9tUmVjb2duaXplcih0aGlzKTtcbiAgICAgICAgaWYgKCEhY29ubikge1xuICAgICAgICAgICAgY29ubi5zZXRNZXNzYWdlUHJvcGVydHkoXCJzcGVlY2guY29udGV4dFwiLCBcInRyYW5zbGF0aW9uY29udGV4dFwiLCB7IHRvOiBsYW5ndWFnZXMgfSk7XG4gICAgICAgICAgICBjb25uLnNlbmRNZXNzYWdlQXN5bmMoXCJldmVudFwiLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgaWQ6IFwidHJhbnNsYXRpb25cIixcbiAgICAgICAgICAgICAgICBuYW1lOiBcInVwZGF0ZUxhbmd1YWdlXCIsXG4gICAgICAgICAgICAgICAgdG86IGxhbmd1YWdlc1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblJlY29nbml6ZXIuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbmltcG9ydCB7IFNlc3Npb25FdmVudEFyZ3MgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIFRyYW5zbGF0aW9uIFN5bnRoZXNpcyBldmVudCBhcmd1bWVudHNcbiAqIEBjbGFzcyBUcmFuc2xhdGlvblN5bnRoZXNpc0V2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25TeW50aGVzaXNFdmVudEFyZ3MgZXh0ZW5kcyBTZXNzaW9uRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7VHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHR9IHJlc3VsdCAtIFRoZSB0cmFuc2xhdGlvbiBzeW50aGVzaXMgcmVzdWx0LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXNzaW9uSWQgLSBUaGUgc2Vzc2lvbiBpZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihyZXN1bHQsIHNlc3Npb25JZCkge1xuICAgICAgICBzdXBlcihzZXNzaW9uSWQpO1xuICAgICAgICB0aGlzLnByaXZSZXN1bHQgPSByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNwZWNpZmllcyB0aGUgdHJhbnNsYXRpb24gc3ludGhlc2lzIHJlc3VsdC5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uU3ludGhlc2lzRXZlbnRBcmdzLnByb3RvdHlwZS5yZXN1bHRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1RyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0fSBTcGVjaWZpZXMgdGhlIHRyYW5zbGF0aW9uIHN5bnRoZXNpcyByZXN1bHQuXG4gICAgICovXG4gICAgZ2V0IHJlc3VsdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlJlc3VsdDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9uU3ludGhlc2lzRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgdHJhbnNsYXRpb24gc3ludGhlc2lzIHJlc3VsdCwgaS5lLiB0aGUgdm9pY2Ugb3V0cHV0IG9mIHRoZSB0cmFuc2xhdGVkXG4gKiB0ZXh0IGluIHRoZSB0YXJnZXQgbGFuZ3VhZ2UuXG4gKiBAY2xhc3MgVHJhbnNsYXRpb25TeW50aGVzaXNSZXN1bHRcbiAqL1xuZXhwb3J0IGNsYXNzIFRyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7UmVzdWx0UmVhc29ufSByZWFzb24gLSBUaGUgc3ludGhlc2lzIHJlYXNvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBhdWRpbyAtIFRoZSBhdWRpbyBkYXRhLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwgYXVkaW8pIHtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZBdWRpbyA9IGF1ZGlvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmFuc2xhdGVkIHRleHQgaW4gdGhlIHRhcmdldCBsYW5ndWFnZS5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9uU3ludGhlc2lzUmVzdWx0LnByb3RvdHlwZS5hdWRpb1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7QXJyYXlCdWZmZXJ9IFRyYW5zbGF0ZWQgYXVkaW8gaW4gdGhlIHRhcmdldCBsYW5ndWFnZS5cbiAgICAgKi9cbiAgICBnZXQgYXVkaW8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZBdWRpbztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHN5bnRoZXNpcyBzdGF0dXMuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdC5wcm90b3R5cGUucmVhc29uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtSZXN1bHRSZWFzb259IFRoZSBzeW50aGVzaXMgc3RhdHVzLlxuICAgICAqL1xuICAgIGdldCByZWFzb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZSZWFzb247XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcmFuc2xhdGlvblN5bnRoZXNpc1Jlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgUHJvcGVydHlDb2xsZWN0aW9uIH0gZnJvbSBcIi4vRXhwb3J0c1wiO1xuLyoqXG4gKiBSZXByZXNlbnRzIGNvbGxlY3Rpb24gb2YgcGFyYW1ldGVycyBhbmQgdGhlaXIgdmFsdWVzLlxuICogQGNsYXNzIFRyYW5zbGF0aW9uc1xuICovXG5leHBvcnQgY2xhc3MgVHJhbnNsYXRpb25zIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gVXNlIGFuIFByb3BlcnR5Q29sbGVjdGlvbiBpbnRlcm5hbGx5LCBqdXN0IHdyYXBwaW5nIGl0IHRvIGhpZGUgdGhlIHwgZW51bSBzeW50YXggaXQgaGFzLlxuICAgICAgICB0aGlzLnByaXZNYXAgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbGFuZ3VhZ2VzIGluIHRoZSBvYmplY3QgaW4gYSBTdHJpbmcgYXJyYXkuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvbnMucHJvdG90eXBlLmxhbmd1YWdlc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IGxhbmd1YWdlcyBpbiB0cmFuc2xhdGlvbnMgb2JqZWN0LlxuICAgICAqL1xuICAgIGdldCBsYW5ndWFnZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZNYXAua2V5cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcGFyYW1ldGVyIHZhbHVlIGluIHR5cGUgU3RyaW5nLiBUaGUgcGFyYW1ldGVyIG11c3QgaGF2ZSB0aGUgc2FtZSB0eXBlIGFzIFN0cmluZy5cbiAgICAgKiBDdXJyZW50bHkgb25seSBTdHJpbmcsIGludCBhbmQgYm9vbCBhcmUgYWxsb3dlZC5cbiAgICAgKiBJZiB0aGUgbmFtZSBpcyBub3QgYXZhaWxhYmxlLCB0aGUgc3BlY2lmaWVkIGRlZmF1bHRWYWx1ZSBpcyByZXR1cm5lZC5cbiAgICAgKiBAbWVtYmVyIFRyYW5zbGF0aW9ucy5wcm90b3R5cGUuZ2V0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBUaGUgcGFyYW1ldGVyIG5hbWUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRlZiAtIFRoZSBkZWZhdWx0IHZhbHVlIHdoaWNoIGlzIHJldHVybmVkIGlmIHRoZSBwYXJhbWV0ZXIgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGUgY29sbGVjdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB2YWx1ZSBvZiB0aGUgcGFyYW1ldGVyLlxuICAgICAqL1xuICAgIGdldChrZXksIGRlZikge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TWFwLmdldFByb3BlcnR5KGtleSwgZGVmKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgU3RyaW5nIHZhbHVlIG9mIHRoZSBwYXJhbWV0ZXIgc3BlY2lmaWVkIGJ5IG5hbWUuXG4gICAgICogQG1lbWJlciBUcmFuc2xhdGlvbnMucHJvdG90eXBlLnNldFxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gVGhlIHBhcmFtZXRlciBuYW1lLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSAtIFRoZSB2YWx1ZSBvZiB0aGUgcGFyYW1ldGVyLlxuICAgICAqL1xuICAgIHNldChrZXksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMucHJpdk1hcC5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVRyYW5zbGF0aW9ucy5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgVHVyblN0YXR1c1Jlc3BvbnNlUGF5bG9hZCB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL1NlcnZpY2VNZXNzYWdlcy9UdXJuU3RhdHVzUGF5bG9hZFwiO1xuLyoqXG4gKiBEZWZpbmVzIGNvbnRlbnRzIG9mIHJlY2VpdmVkIG1lc3NhZ2UvZXZlbnRzLlxuICogQGNsYXNzIFR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJnc1xuICovXG5leHBvcnQgY2xhc3MgVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0dXJuU3RhdHVzIC0gVGhlIEpTT04tZW5jb2RlZCB0dXJuIHN0YXR1cyBtZXNzYWdlLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHR1cm5TdGF0dXMpIHtcbiAgICAgICAgdGhpcy5wcml2VHVyblN0YXR1cyA9IFR1cm5TdGF0dXNSZXNwb25zZVBheWxvYWQuZnJvbUpTT04odHVyblN0YXR1cyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGludGVyYWN0aW9uIGlkZW50aWZpZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgdHVybiBzdGF0dXMgZXZlbnQuXG4gICAgICogQG1lbWJlciBUdXJuU3RhdHVzUmVjZWl2ZWRFdmVudEFyZ3MucHJvdG90eXBlLmludGVyYWN0aW9uSWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2FueX0gdGhlIHJlY2VpdmVkIGludGVyYWN0aW9uIGlkLlxuICAgICAqL1xuICAgIGdldCBpbnRlcmFjdGlvbklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHVyblN0YXR1cy5pbnRlcmFjdGlvbklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjb252ZXJzYXRpb24gaWRlbnRpZmllciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0dXJuIHN0YXR1cyBldmVudC5cbiAgICAgKiBAbWVtYmVyIFR1cm5TdGF0dXNSZWNlaXZlZEV2ZW50QXJncy5wcm90b3R5cGUuY29udmVyc2F0aW9uSWRcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge2FueX0gdGhlIHJlY2VpdmVkIGNvbnZlcnNhdGlvbiBpZC5cbiAgICAgKi9cbiAgICBnZXQgY29udmVyc2F0aW9uSWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZUdXJuU3RhdHVzLmNvbnZlcnNhdGlvbklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSByZWNlaXZlZCB0dXJuIHN0YXR1cyBjb2RlLlxuICAgICAqIEBtZW1iZXIgVHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzLnByb3RvdHlwZS5zdGF0dXNDb2RlXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IHRoZSByZWNlaXZlZCB0dXJuIHN0YXR1cy5cbiAgICAgKi9cbiAgICBnZXQgc3RhdHVzQ29kZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlR1cm5TdGF0dXMuc3RhdHVzQ29kZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLXJldHVyblxuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHVyblN0YXR1c1JlY2VpdmVkRXZlbnRBcmdzLmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIERlZmluZXMgdGhlIGdlbmRlciBvZiBzeW50aGVzaXMgdm9pY2VzLlxuICogQWRkZWQgaW4gdmVyc2lvbiAxLjIwLjAuXG4gKi9cbmV4cG9ydCB2YXIgU3ludGhlc2lzVm9pY2VHZW5kZXI7XG4oZnVuY3Rpb24gKFN5bnRoZXNpc1ZvaWNlR2VuZGVyKSB7XG4gICAgLyoqIEdlbmRlciB1bmtub3duICovXG4gICAgU3ludGhlc2lzVm9pY2VHZW5kZXJbU3ludGhlc2lzVm9pY2VHZW5kZXJbXCJVbmtub3duXCJdID0gMF0gPSBcIlVua25vd25cIjtcbiAgICAvKiogRmVtYWxlIHZvaWNlICovXG4gICAgU3ludGhlc2lzVm9pY2VHZW5kZXJbU3ludGhlc2lzVm9pY2VHZW5kZXJbXCJGZW1hbGVcIl0gPSAxXSA9IFwiRmVtYWxlXCI7XG4gICAgLyoqIE1hbGUgdm9pY2UgKi9cbiAgICBTeW50aGVzaXNWb2ljZUdlbmRlcltTeW50aGVzaXNWb2ljZUdlbmRlcltcIk1hbGVcIl0gPSAyXSA9IFwiTWFsZVwiO1xufSkoU3ludGhlc2lzVm9pY2VHZW5kZXIgfHwgKFN5bnRoZXNpc1ZvaWNlR2VuZGVyID0ge30pKTtcbmV4cG9ydCB2YXIgU3ludGhlc2lzVm9pY2VUeXBlO1xuKGZ1bmN0aW9uIChTeW50aGVzaXNWb2ljZVR5cGUpIHtcbiAgICBTeW50aGVzaXNWb2ljZVR5cGVbU3ludGhlc2lzVm9pY2VUeXBlW1wiT25saW5lTmV1cmFsXCJdID0gMV0gPSBcIk9ubGluZU5ldXJhbFwiO1xuICAgIFN5bnRoZXNpc1ZvaWNlVHlwZVtTeW50aGVzaXNWb2ljZVR5cGVbXCJPbmxpbmVTdGFuZGFyZFwiXSA9IDJdID0gXCJPbmxpbmVTdGFuZGFyZFwiO1xuICAgIFN5bnRoZXNpc1ZvaWNlVHlwZVtTeW50aGVzaXNWb2ljZVR5cGVbXCJPZmZsaW5lTmV1cmFsXCJdID0gM10gPSBcIk9mZmxpbmVOZXVyYWxcIjtcbiAgICBTeW50aGVzaXNWb2ljZVR5cGVbU3ludGhlc2lzVm9pY2VUeXBlW1wiT2ZmbGluZVN0YW5kYXJkXCJdID0gNF0gPSBcIk9mZmxpbmVTdGFuZGFyZFwiO1xufSkoU3ludGhlc2lzVm9pY2VUeXBlIHx8IChTeW50aGVzaXNWb2ljZVR5cGUgPSB7fSkpO1xuLyoqXG4gKiBJbmZvcm1hdGlvbiBhYm91dCBTcGVlY2ggU3ludGhlc2lzIHZvaWNlXG4gKiBBZGRlZCBpbiB2ZXJzaW9uIDEuMjAuMC5cbiAqIEBjbGFzcyBWb2ljZUluZm9cbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlSW5mbyB7XG4gICAgY29uc3RydWN0b3IoanNvbikge1xuICAgICAgICB0aGlzLnByaXZTdHlsZUxpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5wcml2Vm9pY2VQYXRoID0gXCJcIjtcbiAgICAgICAgaWYgKCEhanNvbikge1xuICAgICAgICAgICAgdGhpcy5wcml2TmFtZSA9IGpzb24uTmFtZTtcbiAgICAgICAgICAgIHRoaXMucHJpdkxvY2FsZSA9IGpzb24uTG9jYWxlO1xuICAgICAgICAgICAgdGhpcy5wcml2U2hvcnROYW1lID0ganNvbi5TaG9ydE5hbWU7XG4gICAgICAgICAgICB0aGlzLnByaXZMb2NhbGVOYW1lID0ganNvbi5Mb2NhbGVOYW1lO1xuICAgICAgICAgICAgdGhpcy5wcml2TG9jYWxOYW1lID0ganNvbi5Mb2NhbE5hbWU7XG4gICAgICAgICAgICB0aGlzLnByaXZWb2ljZVR5cGUgPSBqc29uLlZvaWNlVHlwZS5lbmRzV2l0aChcIlN0YW5kYXJkXCIpID8gU3ludGhlc2lzVm9pY2VUeXBlLk9ubGluZVN0YW5kYXJkIDogU3ludGhlc2lzVm9pY2VUeXBlLk9ubGluZU5ldXJhbDtcbiAgICAgICAgICAgIHRoaXMucHJpdkdlbmRlciA9IGpzb24uR2VuZGVyID09PSBcIk1hbGVcIiA/IFN5bnRoZXNpc1ZvaWNlR2VuZGVyLk1hbGUgOiBqc29uLkdlbmRlciA9PT0gXCJGZW1hbGVcIiA/IFN5bnRoZXNpc1ZvaWNlR2VuZGVyLkZlbWFsZSA6IFN5bnRoZXNpc1ZvaWNlR2VuZGVyLlVua25vd247XG4gICAgICAgICAgICBpZiAoISFqc29uLlN0eWxlTGlzdCAmJiBBcnJheS5pc0FycmF5KGpzb24uU3R5bGVMaXN0KSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3R5bGUgb2YganNvbi5TdHlsZUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcml2U3R5bGVMaXN0LnB1c2goc3R5bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbmFtZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdk5hbWU7XG4gICAgfVxuICAgIGdldCBsb2NhbGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMb2NhbGU7XG4gICAgfVxuICAgIGdldCBzaG9ydE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZTaG9ydE5hbWU7XG4gICAgfVxuICAgIGdldCBsb2NhbE5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZMb2NhbE5hbWU7XG4gICAgfVxuICAgIGdldCBsb2NhbGVOYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2TG9jYWxlTmFtZTtcbiAgICB9XG4gICAgZ2V0IGdlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkdlbmRlcjtcbiAgICB9XG4gICAgZ2V0IHZvaWNlVHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlVHlwZTtcbiAgICB9XG4gICAgZ2V0IHN0eWxlTGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlN0eWxlTGlzdDtcbiAgICB9XG4gICAgZ2V0IHZvaWNlUGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlUGF0aDtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlSW5mby5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyoqXG4gKiBEZWZpbmVzIFZvaWNlIFByb2ZpbGUgY2xhc3MgZm9yIFNwZWFrZXIgUmVjb2duaXRpb25cbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVcbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvZmlsZUlkIC0gcHJvZmlsZUlkIG9mIHRoaXMgVm9pY2UgUHJvZmlsZS5cbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZVR5cGV9IHByb2ZpbGVUeXBlIC0gcHJvZmlsZVR5cGUgb2YgdGhpcyBWb2ljZSBQcm9maWxlLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHByb2ZpbGVJZCwgcHJvZmlsZVR5cGUpIHtcbiAgICAgICAgdGhpcy5wcml2SWQgPSBwcm9maWxlSWQ7XG4gICAgICAgIHRoaXMucHJpdlByb2ZpbGVUeXBlID0gcHJvZmlsZVR5cGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIHByb2ZpbGVJZCBvZiB0aGlzIFZvaWNlIFByb2ZpbGUgaW5zdGFuY2VcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZS5wcm90b3R5cGUucHJvZmlsZUlkXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHByb2ZpbGVJZCBvZiB0aGlzIFZvaWNlIFByb2ZpbGUgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZ2V0IHByb2ZpbGVJZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdklkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBwcm9maWxlVHlwZSBvZiB0aGlzIFZvaWNlIFByb2ZpbGUgaW5zdGFuY2VcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZS5wcm90b3R5cGUucHJvZmlsZVR5cGVcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQHJldHVybnMge1ZvaWNlUHJvZmlsZVR5cGV9IHByb2ZpbGUgdHlwZSBvZiB0aGlzIFZvaWNlIFByb2ZpbGUgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZ2V0IHByb2ZpbGVUeXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UHJvZmlsZVR5cGU7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Wb2ljZVByb2ZpbGUuanMubWFwXG4iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHsgUmVjb2duaXplckNvbmZpZywgVm9pY2VQcm9maWxlQ29ubmVjdGlvbkZhY3RvcnksIFZvaWNlU2VydmljZVJlY29nbml6ZXIgfSBmcm9tIFwiLi4vY29tbW9uLnNwZWVjaC9FeHBvcnRzXCI7XG5pbXBvcnQgeyBBdWRpb0NvbmZpZyB9IGZyb20gXCIuL0F1ZGlvL0F1ZGlvQ29uZmlnXCI7XG5pbXBvcnQgeyBDb250cmFjdHMgfSBmcm9tIFwiLi9Db250cmFjdHNcIjtcbmltcG9ydCB7IEF1ZGlvSW5wdXRTdHJlYW0sIFByb3BlcnR5SWQsIFJlY29nbml6ZXIsIFJlc3VsdFJlYXNvbiwgVm9pY2VQcm9maWxlLCBWb2ljZVByb2ZpbGVSZXN1bHQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIERlZmluZXMgVm9pY2VQcm9maWxlQ2xpZW50IGNsYXNzIGZvciBTcGVha2VyIFJlY29nbml0aW9uXG4gKiBIYW5kbGVzIG9wZXJhdGlvbnMgZnJvbSB1c2VyIGZvciBWb2ljZSBQcm9maWxlIG9wZXJhdGlvbnMgKGUuZy4gY3JlYXRlUHJvZmlsZSwgZGVsZXRlUHJvZmlsZSlcbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVDbGllbnRcbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZUNsaWVudCBleHRlbmRzIFJlY29nbml6ZXIge1xuICAgIC8qKlxuICAgICAqIFZvaWNlUHJvZmlsZUNsaWVudCBjb25zdHJ1Y3Rvci5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge1NwZWVjaENvbmZpZ30gc3BlZWNoQ29uZmlnIC0gQW4gc2V0IG9mIGluaXRpYWwgcHJvcGVydGllcyBmb3IgdGhpcyBzeW50aGVzaXplciAoYXV0aGVudGljYXRpb24ga2V5LCByZWdpb24sICZjKVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNwZWVjaENvbmZpZykge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChzcGVlY2hDb25maWcsIFwic3BlZWNoQ29uZmlnXCIpO1xuICAgICAgICBjb25zdCBzcGVlY2hDb25maWdJbXBsID0gc3BlZWNoQ29uZmlnO1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGwoc3BlZWNoQ29uZmlnSW1wbCwgXCJzcGVlY2hDb25maWdcIik7XG4gICAgICAgIHN1cGVyKEF1ZGlvQ29uZmlnLmZyb21TdHJlYW1JbnB1dChBdWRpb0lucHV0U3RyZWFtLmNyZWF0ZVB1c2hTdHJlYW0oKSksIHNwZWVjaENvbmZpZ0ltcGwucHJvcGVydGllcywgbmV3IFZvaWNlUHJvZmlsZUNvbm5lY3Rpb25GYWN0b3J5KCkpO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gc3BlZWNoQ29uZmlnSW1wbC5wcm9wZXJ0aWVzLmNsb25lKCk7XG4gICAgICAgIHRoaXMucHJpdlZvaWNlQWRhcHRlciA9IHRoaXMucHJpdlJlY287XG4gICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkVm9pY2VBZGFwdGVyID0gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIG9mIHByb3BlcnRpZXMgYW5kIHRoZWlyIHZhbHVlcyBkZWZpbmVkIGZvciB0aGlzIFZvaWNlUHJvZmlsZUNsaWVudC5cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUucHJvcGVydGllc1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAcmV0dXJucyB7UHJvcGVydHlDb2xsZWN0aW9ufSBUaGUgY29sbGVjdGlvbiBvZiBwcm9wZXJ0aWVzIGFuZCB0aGVpciB2YWx1ZXMgZGVmaW5lZCBmb3IgdGhpcyBWb2ljZVByb2ZpbGVDbGllbnQuXG4gICAgICovXG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgZ2V0IGF1dGhvcml6YXRpb25Ub2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5nZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBhdXRob3JpemF0aW9uIHRva2VuIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgc2VydmljZS5cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuYXV0aG9yaXphdGlvblRva2VuXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0b2tlbiAtIEF1dGhvcml6YXRpb24gdG9rZW4uXG4gICAgICovXG4gICAgc2V0IGF1dGhvcml6YXRpb25Ub2tlbih0b2tlbikge1xuICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPcldoaXRlc3BhY2UodG9rZW4sIFwidG9rZW5cIik7XG4gICAgICAgIHRoaXMucHJvcGVydGllcy5zZXRQcm9wZXJ0eShQcm9wZXJ0eUlkLlNwZWVjaFNlcnZpY2VBdXRob3JpemF0aW9uX1Rva2VuLCB0b2tlbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHNwZWFrZXIgcmVjb2duaXRpb24gdm9pY2UgcHJvZmlsZVxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2xpZW50LnByb3RvdHlwZS5jcmVhdGVQcm9maWxlQXN5bmNcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAcHVibGljXG4gICAgICogQGFzeW5jXG4gICAgICogQHBhcmFtIHtWb2ljZVByb2ZpbGVUeXBlfSBwcm9maWxlVHlwZSBUeXBlIG9mIFZvaWNlIFByb2ZpbGUgdG8gYmUgY3JlYXRlZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5nIExhbmd1YWdlIHN0cmluZyAobG9jYWxlKSBmb3IgVm9pY2UgUHJvZmlsZVxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Vm9pY2VQcm9maWxlPn0gLSBQcm9taXNlIG9mIGEgVm9pY2VQcm9maWxlLlxuICAgICAqL1xuICAgIGNyZWF0ZVByb2ZpbGVBc3luYyhwcm9maWxlVHlwZSwgbGFuZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgcHJvZmlsZUlkcyA9IHlpZWxkIHRoaXMucHJpdlZvaWNlQWRhcHRlci5jcmVhdGVQcm9maWxlKHByb2ZpbGVUeXBlLCBsYW5nKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVm9pY2VQcm9maWxlKHByb2ZpbGVJZHNbMF0sIHByb2ZpbGVUeXBlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IGluZm9ybWF0aW9uIG9mIGEgdm9pY2UgcHJvZmlsZVxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2xpZW50LnByb3RvdHlwZS5yZXRyaWV2ZUVucm9sbG1lbnRSZXN1bHRBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZX0gcHJvZmlsZSBWb2ljZSBQcm9maWxlIHRvIHJldHJpZXZlIGluZm8gZm9yXG4gICAgICogQHJldHVybiB7UHJvbWlzZTxWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0Pn0gLSBQcm9taXNlIG9mIGEgVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdC5cbiAgICAgKi9cbiAgICByZXRyaWV2ZUVucm9sbG1lbnRSZXN1bHRBc3luYyhwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Vm9pY2VBZGFwdGVyLnJldHJpZXZlRW5yb2xsbWVudFJlc3VsdChwcm9maWxlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgdm9pY2UgcHJvZmlsZXMgb24gYWNjb3VudCB3aXRoIGdpdmVuIHZvaWNlIHByb2ZpbGUgdHlwZVxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2xpZW50LnByb3RvdHlwZS5nZXRBbGxQcm9maWxlc0FzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlVHlwZX0gcHJvZmlsZVR5cGUgcHJvZmlsZSB0eXBlIChpZGVudGlmaWNhdGlvbi92ZXJpZmljYXRpb24pIGZvciB3aGljaCB0byBsaXN0IHByb2ZpbGVzXG4gICAgICogQHJldHVybiB7UHJvbWlzZTxWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0W10+fSAtIFByb21pc2Ugb2YgYW4gYXJyYXkgb2YgVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdHMuXG4gICAgICovXG4gICAgZ2V0QWxsUHJvZmlsZXNBc3luYyhwcm9maWxlVHlwZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlQWRhcHRlci5nZXRBbGxQcm9maWxlcyhwcm9maWxlVHlwZSk7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgY29uc3QgcmVzdWx0OiB7IGpzb246IHsgdmFsdWU6IEVucm9sbG1lbnRSZXN1bHRKU09OW10gfSB9ID0gYXdhaXQgdGhpcy5wcml2QWRhcHRlci5nZXRQcm9maWxlcyhwcm9maWxlVHlwZSk7XG4gICAgICAgICAgICBpZiAocHJvZmlsZVR5cGUgPT09IFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50SWRlbnRpZmljYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdC5Gcm9tSWRlbnRpZmljYXRpb25Qcm9maWxlTGlzdChyZXN1bHQuanNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdC5Gcm9tVmVyaWZpY2F0aW9uUHJvZmlsZUxpc3QocmVzdWx0Lmpzb24pO1xuICAgICAgICAgICAgKi9cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB2YWxpZCBhdXRob3JpemF0aW9uIHBocmFzZXMgZm9yIHZvaWNlIHByb2ZpbGUgZW5yb2xsbWVudFxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2xpZW50LnByb3RvdHlwZS5nZXRBY3RpdmF0aW9uUGhyYXNlc0FzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlVHlwZX0gcHJvZmlsZVR5cGUgUHJvZmlsZSBUeXBlIHRvIGdldCBhY3RpdmF0aW9uIHBocmFzZXMgZm9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxhbmcgTGFuZ3VhZ2Ugc3RyaW5nIChsb2NhbGUpIGZvciBWb2ljZSBQcm9maWxlXG4gICAgICovXG4gICAgZ2V0QWN0aXZhdGlvblBocmFzZXNBc3luYyhwcm9maWxlVHlwZSwgbGFuZykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlQWRhcHRlci5nZXRBY3RpdmF0aW9uUGhyYXNlcyhwcm9maWxlVHlwZSwgbGFuZyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzcGVha2VyIHJlY29nbml0aW9uIHZvaWNlIHByb2ZpbGVcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuZW5yb2xsUHJvZmlsZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlfSBwcm9maWxlIFZvaWNlIFByb2ZpbGUgdG8gY3JlYXRlIGVucm9sbG1lbnQgZm9yXG4gICAgICogQHBhcmFtIHtBdWRpb0NvbmZpZ30gYXVkaW9Db25maWcgc291cmNlIGluZm8gZnJvbSB3aGljaCB0byBjcmVhdGUgZW5yb2xsbWVudFxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Vm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdD59IC0gUHJvbWlzZSBvZiBhIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQuXG4gICAgICovXG4gICAgZW5yb2xsUHJvZmlsZUFzeW5jKHByb2ZpbGUsIGF1ZGlvQ29uZmlnKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICBjb25zdCBjb25maWdJbXBsID0gYXVkaW9Db25maWc7XG4gICAgICAgICAgICBDb250cmFjdHMudGhyb3dJZk51bGxPclVuZGVmaW5lZChjb25maWdJbXBsLCBcImF1ZGlvQ29uZmlnXCIpO1xuICAgICAgICAgICAgdGhpcy5hdWRpb0NvbmZpZyA9IGF1ZGlvQ29uZmlnO1xuICAgICAgICAgICAgdGhpcy5wcml2Vm9pY2VBZGFwdGVyLlNwZWFrZXJBdWRpb1NvdXJjZSA9IGNvbmZpZ0ltcGw7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Vm9pY2VBZGFwdGVyLmVucm9sbFByb2ZpbGUocHJvZmlsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgYSBzcGVha2VyIHJlY29nbml0aW9uIHZvaWNlIHByb2ZpbGVcbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZUNsaWVudC5wcm90b3R5cGUuZGVsZXRlUHJvZmlsZUFzeW5jXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBhc3luY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlfSBwcm9maWxlIFZvaWNlIFByb2ZpbGUgdG8gYmUgZGVsZXRlZFxuICAgICAqIEByZXR1cm4ge1Byb21pc2U8Vm9pY2VQcm9maWxlUmVzdWx0Pn0gLSBQcm9taXNlIG9mIGEgVm9pY2VQcm9maWxlUmVzdWx0LlxuICAgICAqL1xuICAgIGRlbGV0ZVByb2ZpbGVBc3luYyhwcm9maWxlKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcml2Vm9pY2VBZGFwdGVyLmRlbGV0ZVByb2ZpbGUocHJvZmlsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYWxsIGVucm9sbG1lbnRzIGZvciBhIHNwZWFrZXIgcmVjb2duaXRpb24gdm9pY2UgcHJvZmlsZVxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2xpZW50LnByb3RvdHlwZS5yZXNldFByb2ZpbGVBc3luY1xuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAYXN5bmNcbiAgICAgKiBAcGFyYW0ge1ZvaWNlUHJvZmlsZX0gcHJvZmlsZSBWb2ljZSBQcm9maWxlIHRvIGJlIHJlc2V0XG4gICAgICogQHJldHVybiB7UHJvbWlzZTxWb2ljZVByb2ZpbGVSZXN1bHQ+fSAtIFByb21pc2Ugb2YgYSBWb2ljZVByb2ZpbGVSZXN1bHQuXG4gICAgICovXG4gICAgcmVzZXRQcm9maWxlQXN5bmMocHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJpdlZvaWNlQWRhcHRlci5yZXNldFByb2ZpbGUocHJvZmlsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBvYmplY3QgYW5kIGNsb3NlIHVuZGVybHlpbmcgY29ubmVjdGlvblxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2xpZW50LnByb3RvdHlwZS5jbG9zZVxuICAgICAqIEBmdW5jdGlvblxuICAgICAqIEBhc3luY1xuICAgICAqIEBwdWJsaWNcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIHlpZWxkIHRoaXMuZGlzcG9zZSh0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNyZWF0ZVNlcnZpY2VSZWNvZ25pemVyKGF1dGhlbnRpY2F0aW9uLCBjb25uZWN0aW9uRmFjdG9yeSwgYXVkaW9Db25maWcsIHJlY29nbml6ZXJDb25maWcpIHtcbiAgICAgICAgY29uc3QgYXVkaW9JbXBsID0gYXVkaW9Db25maWc7XG4gICAgICAgIHJldHVybiBuZXcgVm9pY2VTZXJ2aWNlUmVjb2duaXplcihhdXRoZW50aWNhdGlvbiwgY29ubmVjdGlvbkZhY3RvcnksIGF1ZGlvSW1wbCwgcmVjb2duaXplckNvbmZpZywgdGhpcyk7XG4gICAgfVxuICAgIGRpc3Bvc2UoZGlzcG9zaW5nKSB7XG4gICAgICAgIGNvbnN0IF9zdXBlciA9IE9iamVjdC5jcmVhdGUobnVsbCwge1xuICAgICAgICAgICAgZGlzcG9zZTogeyBnZXQ6ICgpID0+IHN1cGVyLmRpc3Bvc2UgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByaXZEaXNwb3NlZFZvaWNlQWRhcHRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucHJpdkRpc3Bvc2VkVm9pY2VBZGFwdGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkaXNwb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB5aWVsZCBfc3VwZXIuZGlzcG9zZS5jYWxsKHRoaXMsIGRpc3Bvc2luZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjcmVhdGVSZWNvZ25pemVyQ29uZmlnKHNwZWVjaENvbmZpZykge1xuICAgICAgICByZXR1cm4gbmV3IFJlY29nbml6ZXJDb25maWcoc3BlZWNoQ29uZmlnLCB0aGlzLnByb3BlcnRpZXMpO1xuICAgIH1cbiAgICBnZXRSZXN1bHQocmVzdWx0LCBzdWNjZXNzUmVhc29uKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gbmV3IFZvaWNlUHJvZmlsZVJlc3VsdChyZXN1bHQub2sgPyBzdWNjZXNzUmVhc29uIDogUmVzdWx0UmVhc29uLkNhbmNlbGVkLCByZXN1bHQuc3RhdHVzVGV4dCk7XG4gICAgICAgIHJldHVybiAocmVzcG9uc2UpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vm9pY2VQcm9maWxlQ2xpZW50LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtY2xhc3Nlcy1wZXItZmlsZSAqL1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi5zcGVlY2gvRXhwb3J0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UsIENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFJlc3VsdFJlYXNvbiB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogT3V0cHV0IGZvcm1hdFxuICogQGNsYXNzIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHRcbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQge1xuICAgIGNvbnN0cnVjdG9yKHJlYXNvbiwganNvbiwgc3RhdHVzVGV4dCkge1xuICAgICAgICB0aGlzLnByaXZSZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucHJpdlByb3BlcnRpZXMgPSBuZXcgUHJvcGVydHlDb2xsZWN0aW9uKCk7XG4gICAgICAgIGlmICh0aGlzLnByaXZSZWFzb24gIT09IFJlc3VsdFJlYXNvbi5DYW5jZWxlZCkge1xuICAgICAgICAgICAgaWYgKCEhanNvbikge1xuICAgICAgICAgICAgICAgIHRoaXMucHJpdkRldGFpbHMgPSBKU09OLnBhcnNlKGpzb24pO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByaXZEZXRhaWxzLmVucm9sbG1lbnRTdGF0dXMudG9Mb3dlckNhc2UoKSA9PT0gXCJlbnJvbGxpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByaXZSZWFzb24gPSBSZXN1bHRSZWFzb24uRW5yb2xsaW5nVm9pY2VQcm9maWxlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IHN0YXR1c1RleHQ7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZS5TZXJ2aWNlRXJyb3JdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICBnZXQgZW5yb2xsbWVudHNDb3VudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdkRldGFpbHMuZW5yb2xsbWVudHNDb3VudDtcbiAgICB9XG4gICAgZ2V0IGVucm9sbG1lbnRzTGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RGV0YWlscy5lbnJvbGxtZW50c0xlbmd0aDtcbiAgICB9XG4gICAgZ2V0IHByb3BlcnRpZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZQcm9wZXJ0aWVzO1xuICAgIH1cbiAgICBnZXQgZW5yb2xsbWVudFJlc3VsdERldGFpbHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZEZXRhaWxzO1xuICAgIH1cbiAgICBnZXQgZXJyb3JEZXRhaWxzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2RXJyb3JEZXRhaWxzO1xuICAgIH1cbiAgICBzdGF0aWMgRnJvbUlkZW50aWZpY2F0aW9uUHJvZmlsZUxpc3QoanNvbikge1xuICAgICAgICBjb25zdCByZXN1bHRzID0gW107XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBqc29uLnZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSBpdGVtLmVucm9sbG1lbnRTdGF0dXMudG9Mb3dlckNhc2UoKSA9PT0gXCJlbnJvbGxpbmdcIiA/XG4gICAgICAgICAgICAgICAgUmVzdWx0UmVhc29uLkVucm9sbGluZ1ZvaWNlUHJvZmlsZSA6IGl0ZW0uZW5yb2xsbWVudFN0YXR1cy50b0xvd2VyQ2FzZSgpID09PSBcImVucm9sbGVkXCIgP1xuICAgICAgICAgICAgICAgIFJlc3VsdFJlYXNvbi5FbnJvbGxlZFZvaWNlUHJvZmlsZSA6IFJlc3VsdFJlYXNvbi5DYW5jZWxlZDtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50UmVzdWx0KHJlYXNvbiwgbnVsbCwgbnVsbCk7XG4gICAgICAgICAgICByZXN1bHQucHJpdkRldGFpbHMgPSB0aGlzLmdldElkZW50aWZpY2F0aW9uRGV0YWlscyhpdGVtKTtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cbiAgICBzdGF0aWMgRnJvbVZlcmlmaWNhdGlvblByb2ZpbGVMaXN0KGpzb24pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YganNvbi52YWx1ZSkge1xuICAgICAgICAgICAgY29uc3QgcmVhc29uID0gaXRlbS5lbnJvbGxtZW50U3RhdHVzLnRvTG93ZXJDYXNlKCkgPT09IFwiZW5yb2xsaW5nXCIgP1xuICAgICAgICAgICAgICAgIFJlc3VsdFJlYXNvbi5FbnJvbGxpbmdWb2ljZVByb2ZpbGUgOiBpdGVtLmVucm9sbG1lbnRTdGF0dXMudG9Mb3dlckNhc2UoKSA9PT0gXCJlbnJvbGxlZFwiID9cbiAgICAgICAgICAgICAgICBSZXN1bHRSZWFzb24uRW5yb2xsZWRWb2ljZVByb2ZpbGUgOiBSZXN1bHRSZWFzb24uQ2FuY2VsZWQ7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBuZXcgVm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdChyZWFzb24sIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgcmVzdWx0LnByaXZEZXRhaWxzID0gdGhpcy5nZXRWZXJpZmljYXRpb25EZXRhaWxzKGl0ZW0pO1xuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuICAgIHN0YXRpYyBnZXRJZGVudGlmaWNhdGlvbkRldGFpbHMoanNvbikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXVkaW9MZW5ndGg6IGpzb24uYXVkaW9MZW5ndGggPyBwYXJzZUZsb2F0KGpzb24uYXVkaW9MZW5ndGgpIDogMCxcbiAgICAgICAgICAgIGF1ZGlvU3BlZWNoTGVuZ3RoOiBqc29uLmF1ZGlvU3BlZWNoTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLmF1ZGlvU3BlZWNoTGVuZ3RoKSA6IDAsXG4gICAgICAgICAgICBlbnJvbGxtZW50U3RhdHVzOiBqc29uLmVucm9sbG1lbnRTdGF0dXMsXG4gICAgICAgICAgICBlbnJvbGxtZW50c0NvdW50OiBqc29uLmVucm9sbG1lbnRzQ291bnQgfHwgMCxcbiAgICAgICAgICAgIGVucm9sbG1lbnRzTGVuZ3RoOiBqc29uLmVucm9sbG1lbnRzTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLmVucm9sbG1lbnRzTGVuZ3RoKSA6IDAsXG4gICAgICAgICAgICBlbnJvbGxtZW50c1NwZWVjaExlbmd0aDoganNvbi5lbnJvbGxtZW50c1NwZWVjaExlbmd0aCA/IHBhcnNlRmxvYXQoanNvbi5lbnJvbGxtZW50c1NwZWVjaExlbmd0aCkgOiAwLFxuICAgICAgICAgICAgcHJvZmlsZUlkOiBqc29uLnByb2ZpbGVJZCB8fCBqc29uLmlkZW50aWZpY2F0aW9uUHJvZmlsZUlkLFxuICAgICAgICAgICAgcmVtYWluaW5nRW5yb2xsbWVudHNTcGVlY2hMZW5ndGg6IGpzb24ucmVtYWluaW5nRW5yb2xsbWVudHNTcGVlY2hMZW5ndGggPyBwYXJzZUZsb2F0KGpzb24ucmVtYWluaW5nRW5yb2xsbWVudHNTcGVlY2hMZW5ndGgpIDogMFxuICAgICAgICB9O1xuICAgIH1cbiAgICBzdGF0aWMgZ2V0VmVyaWZpY2F0aW9uRGV0YWlscyhqc29uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhdWRpb0xlbmd0aDoganNvbi5hdWRpb0xlbmd0aCA/IHBhcnNlRmxvYXQoanNvbi5hdWRpb0xlbmd0aCkgOiAwLFxuICAgICAgICAgICAgYXVkaW9TcGVlY2hMZW5ndGg6IGpzb24uYXVkaW9TcGVlY2hMZW5ndGggPyBwYXJzZUZsb2F0KGpzb24uYXVkaW9TcGVlY2hMZW5ndGgpIDogMCxcbiAgICAgICAgICAgIGVucm9sbG1lbnRTdGF0dXM6IGpzb24uZW5yb2xsbWVudFN0YXR1cyxcbiAgICAgICAgICAgIGVucm9sbG1lbnRzQ291bnQ6IGpzb24uZW5yb2xsbWVudHNDb3VudCxcbiAgICAgICAgICAgIGVucm9sbG1lbnRzTGVuZ3RoOiBqc29uLmVucm9sbG1lbnRzTGVuZ3RoID8gcGFyc2VGbG9hdChqc29uLmVucm9sbG1lbnRzTGVuZ3RoKSA6IDAsXG4gICAgICAgICAgICBlbnJvbGxtZW50c1NwZWVjaExlbmd0aDoganNvbi5lbnJvbGxtZW50c1NwZWVjaExlbmd0aCA/IHBhcnNlRmxvYXQoanNvbi5lbnJvbGxtZW50c1NwZWVjaExlbmd0aCkgOiAwLFxuICAgICAgICAgICAgcHJvZmlsZUlkOiBqc29uLnByb2ZpbGVJZCB8fCBqc29uLnZlcmlmaWNhdGlvblByb2ZpbGVJZCxcbiAgICAgICAgICAgIHJlbWFpbmluZ0Vucm9sbG1lbnRzQ291bnQ6IGpzb24ucmVtYWluaW5nRW5yb2xsbWVudHMgfHwganNvbi5yZW1haW5pbmdFbnJvbGxtZW50c0NvdW50LFxuICAgICAgICAgICAgcmVtYWluaW5nRW5yb2xsbWVudHNTcGVlY2hMZW5ndGg6IGpzb24ucmVtYWluaW5nRW5yb2xsbWVudHNTcGVlY2hMZW5ndGggPyBwYXJzZUZsb2F0KGpzb24ucmVtYWluaW5nRW5yb2xsbWVudHNTcGVlY2hMZW5ndGgpIDogMFxuICAgICAgICB9O1xuICAgIH1cbn1cbi8qKlxuICogQGNsYXNzIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRDYW5jZWxsYXRpb25EZXRhaWxzXG4gKi9cbmV4cG9ydCBjbGFzcyBWb2ljZVByb2ZpbGVFbnJvbGxtZW50Q2FuY2VsbGF0aW9uRGV0YWlscyBleHRlbmRzIENhbmNlbGxhdGlvbkRldGFpbHNCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKSB7XG4gICAgICAgIHN1cGVyKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRDYW5jZWxsYXRpb25EZXRhaWxzIG9iamVjdCBmb3IgdGhlIGNhbmNlbGVkIFZvaWNlUHJvZmlsZUVucm9sbG1lbnRSZXN1bHQuXG4gICAgICogQG1lbWJlciBWb2ljZVByb2ZpbGVFbnJvbGxtZW50Q2FuY2VsbGF0aW9uRGV0YWlscy5mcm9tUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdH0gcmVzdWx0IC0gVGhlIHJlc3VsdCB0aGF0IHdhcyBjYW5jZWxlZC5cbiAgICAgKiBAcmV0dXJucyB7Vm9pY2VQcm9maWxlRW5yb2xsbWVudENhbmNlbGxhdGlvbkRldGFpbHN9IFRoZSBjYW5jZWxsYXRpb24gZGV0YWlscyBvYmplY3QgYmVpbmcgY3JlYXRlZC5cbiAgICAgKi9cbiAgICBzdGF0aWMgZnJvbVJlc3VsdChyZXN1bHQpIHtcbiAgICAgICAgY29uc3QgcmVhc29uID0gQ2FuY2VsbGF0aW9uUmVhc29uLkVycm9yO1xuICAgICAgICBsZXQgZXJyb3JDb2RlID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3I7XG4gICAgICAgIGlmICghIXJlc3VsdC5wcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBlcnJvckNvZGUgPSBDYW5jZWxsYXRpb25FcnJvckNvZGVbcmVzdWx0LnByb3BlcnRpZXMuZ2V0UHJvcGVydHkoQ2FuY2VsbGF0aW9uRXJyb3JDb2RlUHJvcGVydHlOYW1lLCBDYW5jZWxsYXRpb25FcnJvckNvZGVbQ2FuY2VsbGF0aW9uRXJyb3JDb2RlLk5vRXJyb3JdKV07IC8vZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgVm9pY2VQcm9maWxlRW5yb2xsbWVudENhbmNlbGxhdGlvbkRldGFpbHMocmVhc29uLCByZXN1bHQuZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vm9pY2VQcm9maWxlRW5yb2xsbWVudFJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuaW1wb3J0IHsgQ29udHJhY3RzIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XG5pbXBvcnQgeyBWb2ljZVByb2ZpbGVSZXN1bHQgfSBmcm9tIFwiLi9FeHBvcnRzXCI7XG4vKipcbiAqIE91dHB1dCBmb3JtYXRcbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVQaHJhc2VSZXN1bHRcbiAqL1xuZXhwb3J0IGNsYXNzIFZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdCBleHRlbmRzIFZvaWNlUHJvZmlsZVJlc3VsdCB7XG4gICAgY29uc3RydWN0b3IocmVhc29uLCBzdGF0dXNUZXh0LCB0eXBlLCBwaHJhc2VBcnJheSkge1xuICAgICAgICBzdXBlcihyZWFzb24sIHN0YXR1c1RleHQpO1xuICAgICAgICB0aGlzLnByaXZQaHJhc2VzID0gW107XG4gICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHBocmFzZUFycmF5LCBcInBocmFzZSBhcnJheVwiKTtcbiAgICAgICAgdGhpcy5wcml2VHlwZSA9IHR5cGU7XG4gICAgICAgIGlmICghIXBocmFzZUFycmF5ICYmICEhcGhyYXNlQXJyYXlbMF0pIHtcbiAgICAgICAgICAgIHRoaXMucHJpdlBocmFzZXMgPSBwaHJhc2VBcnJheTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgcGhyYXNlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlBocmFzZXM7XG4gICAgfVxuICAgIGdldCB0eXBlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2VHlwZTtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlUHJvZmlsZVBocmFzZVJlc3VsdC5qcy5tYXBcbiIsIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuLyogZXNsaW50LWRpc2FibGUgbWF4LWNsYXNzZXMtcGVyLWZpbGUgKi9cbmltcG9ydCB7IENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSB9IGZyb20gXCIuLi9jb21tb24uc3BlZWNoL0V4cG9ydHNcIjtcbmltcG9ydCB7IENvbnRyYWN0cyB9IGZyb20gXCIuL0NvbnRyYWN0c1wiO1xuaW1wb3J0IHsgQ2FuY2VsbGF0aW9uRGV0YWlsc0Jhc2UsIENhbmNlbGxhdGlvbkVycm9yQ29kZSwgQ2FuY2VsbGF0aW9uUmVhc29uLCBQcm9wZXJ0eUNvbGxlY3Rpb24sIFJlc3VsdFJlYXNvbiB9IGZyb20gXCIuL0V4cG9ydHNcIjtcbi8qKlxuICogT3V0cHV0IGZvcm1hdFxuICogQGNsYXNzIFZvaWNlUHJvZmlsZVJlc3VsdFxuICovXG5leHBvcnQgY2xhc3MgVm9pY2VQcm9maWxlUmVzdWx0IHtcbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIHN0YXR1c1RleHQpIHtcbiAgICAgICAgdGhpcy5wcml2UmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzID0gbmV3IFByb3BlcnR5Q29sbGVjdGlvbigpO1xuICAgICAgICBpZiAocmVhc29uID09PSBSZXN1bHRSZWFzb24uQ2FuY2VsZWQpIHtcbiAgICAgICAgICAgIENvbnRyYWN0cy50aHJvd0lmTnVsbE9yVW5kZWZpbmVkKHN0YXR1c1RleHQsIFwic3RhdHVzVGV4dFwiKTtcbiAgICAgICAgICAgIHRoaXMucHJpdkVycm9yRGV0YWlscyA9IHN0YXR1c1RleHQ7XG4gICAgICAgICAgICB0aGlzLnByaXZQcm9wZXJ0aWVzLnNldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZS5TZXJ2aWNlRXJyb3JdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgcmVhc29uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcml2UmVhc29uO1xuICAgIH1cbiAgICBnZXQgcHJvcGVydGllcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpdlByb3BlcnRpZXM7XG4gICAgfVxuICAgIGdldCBlcnJvckRldGFpbHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaXZFcnJvckRldGFpbHM7XG4gICAgfVxufVxuLyoqXG4gKiBAY2xhc3MgVm9pY2VQcm9maWxlQ2FuY2VsbGF0aW9uRGV0YWlsc1xuICovXG5leHBvcnQgY2xhc3MgVm9pY2VQcm9maWxlQ2FuY2VsbGF0aW9uRGV0YWlscyBleHRlbmRzIENhbmNlbGxhdGlvbkRldGFpbHNCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihyZWFzb24sIGVycm9yRGV0YWlscywgZXJyb3JDb2RlKSB7XG4gICAgICAgIHN1cGVyKHJlYXNvbiwgZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIFZvaWNlUHJvZmlsZUNhbmNlbGxhdGlvbkRldGFpbHMgb2JqZWN0IGZvciB0aGUgY2FuY2VsZWQgVm9pY2VQcm9maWxlUmVzdWx0LlxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlQ2FuY2VsbGF0aW9uRGV0YWlscy5mcm9tUmVzdWx0XG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHB1YmxpY1xuICAgICAqIEBwYXJhbSB7Vm9pY2VQcm9maWxlUmVzdWx0fSByZXN1bHQgLSBUaGUgcmVzdWx0IHRoYXQgd2FzIGNhbmNlbGVkLlxuICAgICAqIEByZXR1cm5zIHtWb2ljZVByb2ZpbGVDYW5jZWxsYXRpb25EZXRhaWxzfSBUaGUgY2FuY2VsbGF0aW9uIGRldGFpbHMgb2JqZWN0IGJlaW5nIGNyZWF0ZWQuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21SZXN1bHQocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IHJlYXNvbiA9IENhbmNlbGxhdGlvblJlYXNvbi5FcnJvcjtcbiAgICAgICAgbGV0IGVycm9yQ29kZSA9IENhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yO1xuICAgICAgICBpZiAoISFyZXN1bHQucHJvcGVydGllcykge1xuICAgICAgICAgICAgZXJyb3JDb2RlID0gQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW3Jlc3VsdC5wcm9wZXJ0aWVzLmdldFByb3BlcnR5KENhbmNlbGxhdGlvbkVycm9yQ29kZVByb3BlcnR5TmFtZSwgQ2FuY2VsbGF0aW9uRXJyb3JDb2RlW0NhbmNlbGxhdGlvbkVycm9yQ29kZS5Ob0Vycm9yXSldOyAvL2VzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFZvaWNlUHJvZmlsZUNhbmNlbGxhdGlvbkRldGFpbHMocmVhc29uLCByZXN1bHQuZXJyb3JEZXRhaWxzLCBlcnJvckNvZGUpO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Vm9pY2VQcm9maWxlUmVzdWx0LmpzLm1hcFxuIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UuXG4vKipcbiAqIE91dHB1dCBmb3JtYXRcbiAqIEBjbGFzcyBWb2ljZVByb2ZpbGVUeXBlXG4gKi9cbmV4cG9ydCB2YXIgVm9pY2VQcm9maWxlVHlwZTtcbihmdW5jdGlvbiAoVm9pY2VQcm9maWxlVHlwZSkge1xuICAgIC8qKlxuICAgICAqIFRleHQgaW5kZXBlbmRlbnQgc3BlYWtlciBpZGVudGlmaWNhdGlvblxuICAgICAqIEBtZW1iZXIgVm9pY2VQcm9maWxlVHlwZS5UZXh0SW5kZXBlbmRlbnRJZGVudGlmaWNhdGlvblxuICAgICAqL1xuICAgIFZvaWNlUHJvZmlsZVR5cGVbVm9pY2VQcm9maWxlVHlwZVtcIlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uXCJdID0gMF0gPSBcIlRleHRJbmRlcGVuZGVudElkZW50aWZpY2F0aW9uXCI7XG4gICAgLyoqXG4gICAgICogVGV4dCBkZXBlbmRlbnQgc3BlYWtlciB2ZXJpZmljYXRpb25cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZVR5cGUuVGV4dERlcGVuZGVudFZlcmlmaWNhdGlvblxuICAgICAqL1xuICAgIFZvaWNlUHJvZmlsZVR5cGVbVm9pY2VQcm9maWxlVHlwZVtcIlRleHREZXBlbmRlbnRWZXJpZmljYXRpb25cIl0gPSAxXSA9IFwiVGV4dERlcGVuZGVudFZlcmlmaWNhdGlvblwiO1xuICAgIC8qKlxuICAgICAqIFRleHQgaW5kZXBlbmRlbnQgc3BlYWtlciB2ZXJpZmljYXRpb25cbiAgICAgKiBAbWVtYmVyIFZvaWNlUHJvZmlsZVR5cGUuVGV4dEluZGVwZW5kZW50VmVyaWZpY2F0aW9uXG4gICAgICovXG4gICAgVm9pY2VQcm9maWxlVHlwZVtWb2ljZVByb2ZpbGVUeXBlW1wiVGV4dEluZGVwZW5kZW50VmVyaWZpY2F0aW9uXCJdID0gMl0gPSBcIlRleHRJbmRlcGVuZGVudFZlcmlmaWNhdGlvblwiO1xufSkoVm9pY2VQcm9maWxlVHlwZSB8fCAoVm9pY2VQcm9maWxlVHlwZSA9IHt9KSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZvaWNlUHJvZmlsZVR5cGUuanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMubW9kZWxzID0gdm9pZCAwO1xuZXhwb3J0cy5tb2RlbHMgPSBbXG4gICAge1xuICAgICAgICAnbmFtZSc6ICdncHQtMy41LXR1cmJvJyxcbiAgICAgICAgJ2lkJzogJ29wZW5haS9ncHQtMy41LXR1cmJvJ1xuICAgIH0sXG4gICAge1xuICAgICAgICAnbmFtZSc6ICdncHQtMy41LXR1cmJvLTE2aycsXG4gICAgICAgICdpZCc6ICdvcGVuYWkvZ3B0LTMuNS10dXJiby0xNmsnXG4gICAgfSxcbiAgICB7XG4gICAgICAgICduYW1lJzogJ2dwdC00JyxcbiAgICAgICAgJ2lkJzogJ29wZW5haS9ncHQtNCdcbiAgICB9LFxuICAgIHtcbiAgICAgICAgJ25hbWUnOiAnZ3B0LTQtMzJrJyxcbiAgICAgICAgJ2lkJzogJ29wZW5haS9ncHQtNC0zMmsnXG4gICAgfSxcbiAgICB7XG4gICAgICAgICduYW1lJzogJ2NsYXVkZS0yJyxcbiAgICAgICAgJ2lkJzogJ2FudGhyb3BpYy9jbGF1ZGUtMidcbiAgICB9LFxuICAgIHtcbiAgICAgICAgJ25hbWUnOiAnY2xhdWRlLWluc3RhbnQtdjEnLFxuICAgICAgICAnaWQnOiAnYW50aHJvcGljL2NsYXVkZS1pbnN0YW50LXYxJ1xuICAgIH0sXG4gICAge1xuICAgICAgICAnbmFtZSc6ICdQYUxNIDIgQmlzb24nLFxuICAgICAgICAnaWQnOiAnZ29vZ2xlL3BhbG0tMi1jaGF0LWJpc29uJ1xuICAgIH0sXG4gICAge1xuICAgICAgICAnbmFtZSc6ICdMbGFtYSB2MiAxM0IgQ2hhdCAoYmV0YSknLFxuICAgICAgICAnaWQnOiAnbWV0YS1sbGFtYS9sbGFtYS0yLTEzYi1jaGF0J1xuICAgIH1cbl07XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5nZXRTZXR0aW5ncyA9IHZvaWQgMDtcbmNvbnN0IHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xID0gX19pbXBvcnREZWZhdWx0KHJlcXVpcmUoXCJ3ZWJleHRlbnNpb24tcG9seWZpbGxcIikpO1xuY29uc3QgbW9kZWxzXzEgPSByZXF1aXJlKFwiLi9tb2RlbHNcIik7XG5mdW5jdGlvbiBnZXRTZXR0aW5ncygpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBsZXQgaXRlbXMgPSB5aWVsZCB3ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LnN0b3JhZ2Uuc3luYy5nZXQoe1xuICAgICAgICAgICAgXCJvcGVuQXBpS2V5XCI6ICcnLFxuICAgICAgICAgICAgXCJvcGVuQXBpRW5kcG9pbnRcIjogJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20nLFxuICAgICAgICAgICAgXCJ1bnNwbGFzaEFwaUtleVwiOiAnJyxcbiAgICAgICAgICAgIFwiY3VycmVudExhbmd1YWdlXCI6ICcnLFxuICAgICAgICAgICAgXCJ0YXJnZXRMYW5ndWFnZVwiOiAnJyxcbiAgICAgICAgICAgIFwiYW5raURlY2tOYW1lXCI6ICcnLFxuICAgICAgICAgICAgXCJsaWNlbnNlS2V5XCI6ICcnLFxuICAgICAgICAgICAgXCJtb2RlbFwiOiBtb2RlbHNfMS5tb2RlbHNbMF1bJ2lkJ10sIFwiYXBpS2V5U2VsZWN0aW9uXCI6ICdsaWNlbnNlS2V5J1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRTZXR0aW5ncyA9IGdldFNldHRpbmdzO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0KSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xufSkgOiBmdW5jdGlvbihvLCB2KSB7XG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xufSk7XG52YXIgX19pbXBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3Qgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIndlYmV4dGVuc2lvbi1wb2x5ZmlsbFwiKSk7XG5jb25zdCBhbXBsaXR1ZGUgPSBfX2ltcG9ydFN0YXIocmVxdWlyZShcIkBhbXBsaXR1ZGUvYW5hbHl0aWNzLWJyb3dzZXJcIikpO1xuY29uc3QgZXZlbnRzb3VyY2VfcGFyc2VyXzEgPSByZXF1aXJlKFwiZXZlbnRzb3VyY2UtcGFyc2VyXCIpO1xuY29uc3QgdXRpbF8xID0gcmVxdWlyZShcIi4vdXRpbFwiKTtcbmNvbnN0IHVuc3BsYXNoX2pzXzEgPSByZXF1aXJlKFwidW5zcGxhc2gtanNcIik7XG5jb25zdCB1dGlsXzIgPSByZXF1aXJlKFwiLi9PcHRpb25zL3V0aWxcIik7XG5jb25zdCB1dGlsXzMgPSByZXF1aXJlKFwiLi91dGlsXCIpO1xuLy8gY29udGVudCBzY3JpcHQg5YWz6Zet56qX5Y+j5pe277yM5bCG5q2k5YC86K6+5Li6IGZhbHNlIOS7peS4reaWreaVsOaNrua4suafk1xuLy8gbGV0IGlzQ29udGludWUgPSB0cnVlXG4oMCwgdXRpbF8zLmdldFVzZXJJZCkoKS50aGVuKCh1c2VySWQpID0+IHtcbiAgICAvLyDmlbDmja7ln4vngrlcbiAgICBhbXBsaXR1ZGUuaW5pdChwcm9jZXNzLmVudi5BTVBMSVRVREVfS0VZLCB1c2VySWQsIHtcbiAgICAgICAgZGVmYXVsdFRyYWNraW5nOiB7XG4gICAgICAgICAgICBwYWdlVmlld3M6IGZhbHNlLFxuICAgICAgICAgICAgc2Vzc2lvbnM6IGZhbHNlLFxuICAgICAgICB9LFxuICAgIH0pO1xufSk7XG5sZXQgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbmNvbnN0IGRlZmF1bHRPcGVuQXBpRW5kcG9pbnQgPSAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbSc7XG5jb25zb2xlLmxvZygnSSBhbSBiYWNrZ3JvdW5kJyk7XG53ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LnJ1bnRpbWUub25JbnN0YWxsZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUubG9nKFwi5o+S5Lu25bey6KKr5a6J6KOFXCIpO1xuICAgIGFtcGxpdHVkZS50cmFjayhcImluc3RhbGxcIik7XG59KTtcbi8vIOWNuOi9veaPkuS7tuWQjuW8leWvvOWhq+WGmeWNuOi9veWOn+WboO+8jOW4ruWKqeS6p+WTgeS8mOWMllxud2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5ydW50aW1lLnNldFVuaW5zdGFsbFVSTChcImh0dHBzOi8vZG9jcy5nb29nbGUuY29tL2Zvcm1zL2QvZS8xRkFJcFFMU2RvYkdRTjNPMENrNGZWcmdmdlJaTW1lM2RlLTJPYUVwMXBGdGliWmtVMGtvYzM3dy92aWV3Zm9ybT91c3A9c2ZfbGlua1wiKTtcbi8vIOWIm+W7uuWPs+mUruiPnOWNlVxud2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5jb250ZXh0TWVudXMuY3JlYXRlKHtcbiAgICBpZDogXCIyXCIsXG4gICAgdGl0bGU6IFwiUnVuIGxhc3QgcHJvbXB0XCIsXG4gICAgY29udGV4dHM6IFtcInNlbGVjdGlvblwiXSxcbn0sICgpID0+IHtcbiAgICB3ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LnJ1bnRpbWUubGFzdEVycm9yO1xufSk7XG53ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LmNvbnRleHRNZW51cy5jcmVhdGUoe1xuICAgIGlkOiBcIjFcIixcbiAgICB0aXRsZTogXCJPcGVuXCIsXG4gICAgY29udGV4dHM6IFtcInNlbGVjdGlvblwiXSxcbn0sICgpID0+IHtcbiAgICB3ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LnJ1bnRpbWUubGFzdEVycm9yO1xufSk7XG4vLyDlj7PplK7oj5zljZXngrnlh7vkuovku7ZcbndlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQuY29udGV4dE1lbnVzLm9uQ2xpY2tlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbiAoaW5mbywgX3RhYikge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGNvbnN0IHJ1blByb21wdCA9IGluZm8ubWVudUl0ZW1JZCA9PT0gJzInID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICBzZW5kTWVzc2FnZVRvQ29udGVudChydW5Qcm9tcHQpO1xuICAgIH0pO1xufSk7XG4vLyDnm5HlkKzlv6vmjbfplK5cbndlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQuY29tbWFuZHMub25Db21tYW5kLmFkZExpc3RlbmVyKGZ1bmN0aW9uIChjb21tYW5kKSB7XG4gICAgY29uc29sZS5sb2coJ2hlbGxvJyk7XG4gICAgaWYgKGNvbW1hbmQgPT09ICdSdW5MYXN0UHJvbXB0Jykge1xuICAgICAgICAvLyDmiafooYznm7jlhbPku6PnoIFcbiAgICAgICAgc2VuZE1lc3NhZ2VUb0NvbnRlbnQoKTtcbiAgICB9XG59KTtcbmxldCBwb3B1cFBvcnQ7XG4vLyDplb/ov57mjqXvvIzlpITnkIYgR1BUIOaVsOaNrlxud2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5ydW50aW1lLm9uQ29ubmVjdC5hZGRMaXN0ZW5lcihwb3J0ID0+IHtcbiAgICAvLyDmlLbliLAgY29udGVudCBzY3JpcHQg5raI5oGvXG4gICAgLy8gY29uc29sZS5sb2coJ+i/nuaOpeS4rS0tLS0tLS0tLS0tLScpXG4gICAgaWYgKHBvcnQubmFtZSA9PT0gJ2Zyb21Qb3B1cENhcmQnKSB7XG4gICAgICAgIHBvcHVwUG9ydCA9IHBvcnQ7XG4gICAgfVxuICAgIC8vIGFtcGxpdHVkZS5pbml0KHByb2Nlc3MuZW52LkFNUExJVFVERV9LRVkgYXMgc3RyaW5nKTtcbiAgICAvLyBhbXBsaXR1ZGUudHJhY2soJ2V4ZWN1dGl2ZVByb21wdCcpO1xuICAgIC8vIOaOpeaUtiBjb250ZW50IHNjcmlwdCDnmoTmtojmga9cbiAgICBwb3J0Lm9uTWVzc2FnZS5hZGRMaXN0ZW5lcigobXNnKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+aOpeaUtua2iOaBr++8micsIG1zZyk7XG4gICAgICAgIC8vIOiOt+WPliBBUEkgS2V5IOetieWtmOWCqOeahOaVsOaNrlxuICAgICAgICBsZXQgb3BlbkFwaUtleSwgYXBpS2V5U2VsZWN0aW9uLCBtb2RlbCwgbGljZW5zZUtleSwgY3VycmVudExhbmd1YWdlLCBvcGVuQXBpRW5kcG9pbnQsIHRhcmdldExhbmd1YWdlID0gJyc7XG4gICAgICAgICgwLCB1dGlsXzIuZ2V0U2V0dGluZ3MpKCkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBhcGlLZXlTZWxlY3Rpb24gPSByZXN1bHQuYXBpS2V5U2VsZWN0aW9uO1xuICAgICAgICAgICAgbGljZW5zZUtleSA9IHJlc3VsdC5saWNlbnNlS2V5O1xuICAgICAgICAgICAgb3BlbkFwaUtleSA9IHJlc3VsdC5vcGVuQXBpS2V5O1xuICAgICAgICAgICAgb3BlbkFwaUVuZHBvaW50ID0gcmVzdWx0Lm9wZW5BcGlFbmRwb2ludDtcbiAgICAgICAgICAgIGN1cnJlbnRMYW5ndWFnZSA9IHJlc3VsdC5jdXJyZW50TGFuZ3VhZ2U7XG4gICAgICAgICAgICB0YXJnZXRMYW5ndWFnZSA9IHJlc3VsdC50YXJnZXRMYW5ndWFnZTtcbiAgICAgICAgICAgIG1vZGVsID0gcmVzdWx0Lm1vZGVsO1xuICAgICAgICAgICAgLy8g6K+35rGCICBHUFQg5pWw5o2uXG4gICAgICAgICAgICBpZiAobXNnLnR5cGUgPT09ICdnZXRHUFRNc2cnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dldEdQVE1zZycpO1xuICAgICAgICAgICAgICAgIC8vIGlzQ29udGludWUgPSB0cnVlIOaXtuaJjeS8mua4suafk+aVsOaNrlxuICAgICAgICAgICAgICAgIC8vIGlzQ29udGludWUgPSB0cnVlXG4gICAgICAgICAgICAgICAgLy8gY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2VzID0gbXNnLm1lc3NhZ2VzO1xuICAgICAgICAgICAgICAgIGlmIChvcGVuQXBpS2V5Lmxlbmd0aCA8IDUgJiYgbGljZW5zZUtleS5sZW5ndGggPCA1KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvcnQucG9zdE1lc3NhZ2UoeyAndHlwZSc6ICdzZW5kR1BURGF0YScsICdzdGF0dXMnOiAnZXJybycsICdjb2RlJzogJ2ludmFsaWRfYXBpX2tleScsICdjb250ZW50JzogJ/CfpbIgQVBJIEtleSBlcnJvci4gUGxlYXNlIG1vZGlmeSBhbmQgdHJ5IGFnYWluLi4nIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvcGVuQXBpRW5kcG9pbnQubGVuZ3RoIDwgNSkge1xuICAgICAgICAgICAgICAgICAgICBvcGVuQXBpRW5kcG9pbnQgPSBkZWZhdWx0T3BlbkFwaUVuZHBvaW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgICAgIGxldCBib2R5O1xuICAgICAgICAgICAgICAgIC8vIOS8mOWFiOS9v+eUqOiHquW3seeahCBLZXlcbiAgICAgICAgICAgICAgICBpZiAoYXBpS2V5U2VsZWN0aW9uID09PSAnbGljZW5zZUtleScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8g5L2/55So6K645Y+v6K+BXG4gICAgICAgICAgICAgICAgICAgIG9wZW5BcGlFbmRwb2ludCA9ICdodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxL2NoYXQvY29tcGxldGlvbnMnO1xuICAgICAgICAgICAgICAgICAgICBvcGVuQXBpS2V5ID0gbGljZW5zZUtleTtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgb3BlbkFwaUtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnSFRUUC1SZWZlcmVyJzogJ2h0dHBzOi8vbm90ZXMuZGFiaW5nLm9uZS8nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ1gtVGl0bGUnOiAnU2NvdXRlcidcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kZWxcIjogbW9kZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VzXCI6IG1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0ZW1wZXJhdHVyZVwiOiAwLjcsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heF90b2tlbnNcIjogNDIwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b3BfcFwiOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lfcGVuYWx0eVwiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmVzZW5jZV9wZW5hbHR5XCI6IDIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0cmVhbVwiOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8g5L2/55So55So5oi36Ieq5bex55qEIEtleVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BlbkFwaUVuZHBvaW50LmluZGV4T2YoJ2F6dXJlLmNvbScpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEF6dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzID0geyAnYXBpLWtleSc6IG9wZW5BcGlLZXksICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibW9kZWxcIjogXCJncHQtMzUtdHVyYm9cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VzXCI6IG1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGVtcGVyYXR1cmVcIjogMC43LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWF4X3Rva2Vuc1wiOiA0MjAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0b3BfcFwiOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJlcXVlbmN5X3BlbmFsdHlcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByZXNlbmNlX3BlbmFsdHlcIjogMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0cmVhbVwiOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZW5BSVxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA9IHsgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyBvcGVuQXBpS2V5LCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLCB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Y676Zmk56uv54K55pyr5bC+55qEIFxcIOespuWPt1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wZW5BcGlFbmRwb2ludC5zbGljZSgtMSkgPT09IFwiL1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkFwaUVuZHBvaW50ID0gb3BlbkFwaUVuZHBvaW50LnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5BcGlFbmRwb2ludCArPSAnL3YxL2NoYXQvY29tcGxldGlvbnMnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1vZGVsXCI6IFwiZ3B0LTMuNS10dXJib1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZXNcIjogbWVzc2FnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0ZW1wZXJhdHVyZVwiOiAwLjcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXhfdG9rZW5zXCI6IDQyMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvcF9wXCI6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmVxdWVuY3lfcGVuYWx0eVwiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJlc2VuY2VfcGVuYWx0eVwiOiAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RyZWFtXCI6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZldGNoKG9wZW5BcGlFbmRwb2ludCwge1xuICAgICAgICAgICAgICAgICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBib2R5LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXG4gICAgICAgICAgICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgIHBvcnQucG9zdE1lc3NhZ2UoeyAndHlwZSc6ICdzZW5kR1BURGF0YScsICdzdGF0dXMnOiAnYmVnaW4nLCAnY29udGVudCc6ICcnIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFQSSBLRVkgRXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdlcnJvJywgJ2NvbnRlbnQnOiAn8J+lsiAnICsgZGF0YS5lcnJvci5tZXNzYWdlLCAnY29kZSc6IGRhdGEuZXJyb3IuY29kZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyDlpITnkIYgc2VydmVyLXNlbnQgZXZlbnRzXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlciA9ICgwLCBldmVudHNvdXJjZV9wYXJzZXJfMS5jcmVhdGVQYXJzZXIpKChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdldmVudCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnY3JlYXRlUGFyc2VyOicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5kYXRhICE9PSAnW0RPTkVdJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld19tc2cgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpWydjaG9pY2VzJ11bMF1bJ2RlbHRhJ11bJ2NvbnRlbnQnXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdfbXNnICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlsIbmlbDmja7lj5HpgIHnu5kgVUkg5Lul5riy5p+T5YaF5a65XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdwcm9jZXNzJywgJ2NvbnRlbnQnOiBKU09OLnBhcnNlKGV2ZW50LmRhdGEpWydjaG9pY2VzJ11bMF1bJ2RlbHRhJ11bJ2NvbnRlbnQnXSwgJ2NoYXRJZCc6IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkuaWQgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCcgY3JlYXRlUGFyc2VyIEpTT04ucGFyc2UgZXJyb3cnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSAoX2EgPSByZXNwb25zZS5ib2R5KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0UmVhZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWFkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBkb25lLCB2YWx1ZSB9ID0geWllbGQgcmVhZGVyLnJlYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgeyBkb25lOmJvb2xlYW4sIHZhbHVlOnVpbnQ4QXJyYXkgfSA9IGF3YWl0IFByb21pc2UucmFjZShbcmVhZGVyLnJlYWQoKSwgY2FuY2VsUHJvbWlzZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5pWw5o2u5Lyg6L6T57uT5p2fXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRG9uZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdlbmQnLCAnY29udGVudCc6ICcnIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKCFpc0NvbnRpbnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2coJ+WBnOatoua4suafk+aVsOaNricpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHIgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZXIuZmVlZChzdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWxlYXNlTG9jaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VyLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluZGV4T2YoJ2Fib3J0ZWQnKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlvIDlkK/mlrDnmoTor7fmsYLvvIzkuK3mlq3ml6for7fmsYJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpcHMgPSBlcnJvci5tZXNzYWdlLmluZGV4T2YoJ0ZhaWxlZCB0byBmZXRjaCcpID49IDAgPyAn8J+lskFuIGVycm9yIG9jY3VycmVkLiBJdCBtaWdodCBiZSBhbiAqKkFQSSBlbmRwb2ludCBlcnJvcioqJyArICcoJyArIG9wZW5BcGlFbmRwb2ludCArICcpJyArICcuIFBsZWFzZSBtb2RpZnkgYW5kIHRyeSBhZ2Fpbi4nIDogJ/CfpbJBbiBlcnJvciBvY2N1cnJlZC4nO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRHUFREYXRhJywgJ3N0YXR1cyc6ICdlcnJvJywgJ2NvbnRlbnQnOiB0aXBzICsgJygnICsgZXJyb3IubWVzc2FnZSArICcpJywgJ2NvZGUnOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHBvcnQucG9zdE1lc3NhZ2UoeyAndHlwZSc6ICdzZW5kR1BURGF0YScsICdzdGF0dXMnOiAnZXJybycsICdjb250ZW50JzogXCLwn6WyIEVuY291bnRlcmVkIHNvbWUgaXNzdWVzLCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiIH0pXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDlgZzmraLmuLLmn5PmlbDmja5cbiAgICAgICAgICAgIGlmIChtc2cudHlwZSA9PT0gJ1N0b3BUaGVDb252ZXJzYXRpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gaXNDb250aW51ZSA9IGZhbHNlXG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KSk7XG59KTtcbndlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoaGFuZGxlTWVzc2FnZSk7XG5mdW5jdGlvbiBoYW5kbGVNZXNzYWdlKHJlcXVlc3QsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSB7XG4gICAgY29uc29sZS5sb2coXCJNZXNzYWdlIGZyb20gdGhlIGNvbnRlbnQgc2NyaXB0OiBcIiArXG4gICAgICAgIHJlcXVlc3QudHlwZSk7XG4gICAgLy8gRGVmaW5lIHNlbmRSZXNwb25zZSBhcyBhbiBhc3luYyBmdW5jdGlvblxuICAgIGNvbnN0IGFzeW5jU2VuZFJlc3BvbnNlID0gKHJlc3BvbnNlKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB5aWVsZCBzZW5kUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAocmVxdWVzdC50eXBlID09PSAnZ2V0VW5zcGxhc2hJbWFnZXMnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdiYWNrZ3JvdW5kIGdldFVuc3BsYXNoSW1hZ2VzOicpO1xuICAgICAgICAvLyDojrflj5blm77niYdcbiAgICAgICAgaWYgKHJlcXVlc3Qua2V5V29yZCkge1xuICAgICAgICAgICAgLy8gcG9ydC5wb3N0TWVzc2FnZSh7ICd0eXBlJzogJ3NlbmRJbWdEYXRhJywgJ3N0YXR1cyc6ICdlbmQnLCAnaW1ncyc6IGltZ3MgfSlcbiAgICAgICAgICAgICgwLCB1dGlsXzEudW5zcGxhc2hTZWFyY2hQaG90b3MpKHByb2Nlc3MuZW52LlVOU1BMQVNIX0FQSV9LRVksIHJlcXVlc3Qua2V5V29yZCkudGhlbigoaW1ncykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGltZ3MpO1xuICAgICAgICAgICAgICAgIC8vIHBvcnQucG9zdE1lc3NhZ2UoeyAndHlwZSc6ICdzZW5kSW1nRGF0YScsICdzdGF0dXMnOiAnZW5kJywgJ2ltZ3MnOiBpbWdzIH0pXG4gICAgICAgICAgICAgICAgYXN5bmNTZW5kUmVzcG9uc2UoeyB0eXBlOiAnc2VuZEltZ0RhdGEnLCBzdGF0dXM6ICdlbmQnLCAnaW1ncyc6IGltZ3MgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHJlcXVlc3QudHlwZSA9PT0gJ2FkZE5vdGUnKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdhZGROb3RlJyk7XG4gICAgICAgIC8vIFVuc3BsYXNoXG4gICAgICAgIGNvbnN0IHVuc3BsYXNoID0gKDAsIHVuc3BsYXNoX2pzXzEuY3JlYXRlQXBpKSh7XG4gICAgICAgICAgICBhY2Nlc3NLZXk6IHByb2Nlc3MuZW52LlVOU1BMQVNIX0FQSV9LRVlcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCd1bnNwbGFzaC5waG90b3MudHJhY2tEb3dubG9hZCcpO1xuICAgICAgICBpZiAocmVxdWVzdC5tZXNzYWdlcy51bnNwbGFzaF9kb3dubG9hZF9sb2NhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB1bnNwbGFzaC5waG90b3MudHJhY2tEb3dubG9hZCh7IGRvd25sb2FkTG9jYXRpb246IHJlcXVlc3QubWVzc2FnZXMudW5zcGxhc2hfZG93bmxvYWRfbG9jYXRpb24sIH0pLnRoZW4oKHJlc3VsdCkgPT4gY29uc29sZS5sb2cocmVzdWx0KSk7XG4gICAgICAgIH1cbiAgICAgICAgKDAsIHV0aWxfMS5hbmtpQWN0aW9uKShyZXF1ZXN0Lm1lc3NhZ2VzLmFua2lfYWN0aW9uX3R5cGUsIDYsIHJlcXVlc3QubWVzc2FnZXMuYW5raV9hcmd1bWVudHMpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYGdvdCBsaXN0IG9mIGRlY2tzOiAke3Jlc3VsdH1gKTtcbiAgICAgICAgICAgIC8vIOWPjemmiOWkhOeQhue7k+aenFxuICAgICAgICAgICAgYXN5bmNTZW5kUmVzcG9uc2UoeyB0eXBlOiAnYWRkVG9BbmtpJywgcmVzdWx0OiAnc3VjY2VzcycsIGRhdGE6IHJlc3VsdC5yZXN1bHQsIGVycm9yOiByZXN1bHQuZXJyb3IgfSk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKHsgdHlwZTogJ2FkZFRvQW5raScsIHJlc3VsdDogJ2ZhaWx1cmUnLCBlcnJvcjogZXJyb3IuZXJyb3IgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZXR1cm4gdHJ1ZSB0byBpbmZvcm0gc2VuZFJlc3BvbnNlIHRoYXQgeW91IHdpbGwgYmUgY2FsbGluZyBpdCBhc3luY2hyb25vdXNseVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy8g6I635Y+W55So5oi36K6+572u55qE54mM57uE5ZKM5qih5p2/XG4gICAgaWYgKHJlcXVlc3QudHlwZSA9PT0gJ3NldE1vZGVsJykge1xuICAgICAgICBjb25zdCBpc0Fua2lTcGFjZSA9IHJlcXVlc3QubWVzc2FnZXMuaXNBbmtpU3BhY2U7XG4gICAgICAgIC8vIOiOt+WPliBEZWNrTmFtZVxuICAgICAgICAoMCwgdXRpbF8xLmdldERlZmF1bHREZWNrTmFtZSkoKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGxldCBkZWZhdWx0RGVja05hbWUgPSByZXN1bHQuZGVmYXVsdERlY2tOYW1lO1xuICAgICAgICAgICAgaWYgKGRlZmF1bHREZWNrTmFtZSA9PT0gJycgfHwgZGVmYXVsdERlY2tOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBkZWZhdWx0RGVja05hbWUgPSAnRGVmYXVsdCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDojrflj5bmiYDmnIkgTW9kZWxcbiAgICAgICAgICAgICgwLCB1dGlsXzEuYW5raUFjdGlvbikoJ21vZGVsTmFtZXMnLCA2KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQucmVzdWx0KTtcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdC5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGVmYXVsdE1vZGVsTmFtZSA9ICdTY291dGVyJztcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNhcmRUZW1wbGF0ZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25hbWUnOiAnQ2FyZDEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdGcm9udCc6ICd7e0Zyb250fX0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdCYWNrJzogYHt7RnJvbnR9fVxuICAgICAgICAgICAgICA8aHIgaWQ9YW5zd2VyPlxuICAgICAgICAgICAgICB7e0JhY2t9fWBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGluT3JkZXJGaWVsZHMgPSBbXCJGcm9udFwiLCBcIkJhY2tcIl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0Fua2lTcGFjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQW5raSDlrozlvaLloavnqbpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRNb2RlbE5hbWUgPSAnU2NvdXRlciBDbG96ZSBUZXh0JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmRUZW1wbGF0ZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbmFtZSc6ICdDYXJkMicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdGcm9udCc6ICd7e2Nsb3plOlRleHR9fScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdCYWNrJzogYHt7Y2xvemU6VGV4dH19XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnI+e3tNb3JlfX1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluT3JkZXJGaWVsZHMgPSBbXCJUZXh0XCIsIFwiTW9yZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnJlc3VsdC5pbmNsdWRlcyhkZWZhdWx0TW9kZWxOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5pyJIFNjb3V0ZXIgTW9kZWwg5YiZ6I635Y+WIE1vZGVsIOeahOWtl+autVxuICAgICAgICAgICAgICAgICAgICAgICAgKDAsIHV0aWxfMS5hbmtpQWN0aW9uKSgnbW9kZWxGaWVsZE5hbWVzJywgNiwgeyAnbW9kZWxOYW1lJzogZGVmYXVsdE1vZGVsTmFtZSB9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnJlc3VsdC5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWtl+auteWwkeS6jiAyIOS4quaXtuaXoOazlea3u+WKoOeslOiusO+8jOW8leWvvOeUqOaIt+S/ruaUuVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7IHR5cGU6ICdzZXRNb2RlbCcsIHJlc3VsdDogJ2ZhaWx1cmUnLCBkYXRhOiB7fSwgZXJyb3I6ICdUaGUgU2NvdXRlciBtb2RlbCBpbiBBbmtpIG5lZWRzIHRvIGluY2x1ZGUgYXQgbGVhc3QgMiBmaWVsZHMuIFBsZWFzZSBtb2RpZnkgYW5kIHRyeSBhZ2Fpbi4nIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Y+N6aaI5aSE55CG57uT5p6cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKHsgdHlwZTogJ3NldE1vZGVsJywgcmVzdWx0OiAnc3VjY2VzcycsIGRhdGE6IHsgJ2RlZmF1bHREZWNrTmFtZSc6IGRlZmF1bHREZWNrTmFtZSwgJ21vZGVsTmFtZSc6IGRlZmF1bHRNb2RlbE5hbWUsICdmaWVsZDEnOiByZXN1bHQucmVzdWx0WzBdLCAnZmllbGQyJzogcmVzdWx0LnJlc3VsdFsxXSB9LCBlcnJvcjogcmVzdWx0LmVycm9yIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5rKh5pyJIFNjb3V0ZXIg6buY6K6k55qEIE1vZGVs77yM5YiZ5Yib5bu6XG4gICAgICAgICAgICAgICAgICAgICAgICAoMCwgdXRpbF8xLmFua2lBY3Rpb24pKCdjcmVhdGVNb2RlbCcsIDYsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbW9kZWxOYW1lJzogZGVmYXVsdE1vZGVsTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaW5PcmRlckZpZWxkcyc6IGluT3JkZXJGaWVsZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NhcmRUZW1wbGF0ZXMnOiBjYXJkVGVtcGxhdGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpc0Nsb3plJzogaXNBbmtpU3BhY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPjemmiOWkhOeQhue7k+aenFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2V0TW9kZWwnLCByZXN1bHQ6ICdzdWNjZXNzJywgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkZWZhdWx0RGVja05hbWUnOiBkZWZhdWx0RGVja05hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21vZGVsTmFtZSc6IGRlZmF1bHRNb2RlbE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZpZWxkMSc6IHJlc3VsdC5yZXN1bHQuZmxkc1swXS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmaWVsZDInOiByZXN1bHQucmVzdWx0LmZsZHNbMV0ubmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZXJyb3I6IHJlc3VsdC5lcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKHsgdHlwZTogJ3NldE1vZGVsJywgcmVzdWx0OiAnZmFpbHVyZScsIGVycm9yOiBlcnJvci5lcnJvciB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsXzEuZGVmYXVsdC5zdG9yYWdlLnN5bmMuZ2V0KHsgJ2Fua2lEZWNrTmFtZSc6ICdEZWZhdWx0JyB9KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAocmVxdWVzdC50eXBlID09PSAnZ3VpRWRpdE5vdGUnKSB7XG4gICAgICAgICgwLCB1dGlsXzEuYW5raUFjdGlvbikocmVxdWVzdC5tZXNzYWdlcy5hbmtpX2FjdGlvbl90eXBlLCA2LCByZXF1ZXN0Lm1lc3NhZ2VzLmFua2lfYXJndW1lbnRzKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBnb3QgbGlzdCBvZiBkZWNrczogJHtyZXN1bHR9YCk7XG4gICAgICAgICAgICAvLyDlj43ppojlpITnkIbnu5PmnpxcbiAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKHsgdHlwZTogJ2d1aUVkaXROb3RlJywgcmVzdWx0OiAnc3VjY2VzcycsIGRhdGE6IHJlc3VsdC5yZXN1bHQsIGVycm9yOiByZXN1bHQuZXJyb3IgfSk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKHsgdHlwZTogJ2d1aUVkaXROb3RlJywgcmVzdWx0OiAnZmFpbHVyZScsIGVycm9yOiBlcnJvci5lcnJvciB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJldHVybiB0cnVlIHRvIGluZm9ybSBzZW5kUmVzcG9uc2UgdGhhdCB5b3Ugd2lsbCBiZSBjYWxsaW5nIGl0IGFzeW5jaHJvbm91c2x5XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAocmVxdWVzdC50eXBlID09PSAnYW5raUFjdGlvbicpIHtcbiAgICAgICAgKDAsIHV0aWxfMS5hbmtpQWN0aW9uKShyZXF1ZXN0Lm1lc3NhZ2VzLmFua2lfYWN0aW9uX3R5cGUsIDYsIHJlcXVlc3QubWVzc2FnZXMuYW5raV9hcmd1bWVudHMpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgLy8g5Y+N6aaI5aSE55CG57uT5p6cXG4gICAgICAgICAgICBhc3luY1NlbmRSZXNwb25zZShyZXN1bHQpO1xuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGFzeW5jU2VuZFJlc3BvbnNlKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZiAocmVxdWVzdC50eXBlID09PSAnYW1wbGl0dWRlVHJhY2snKSB7XG4gICAgICAgIGFtcGxpdHVkZS50cmFjayhyZXF1ZXN0Lm5hbWUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHJlcXVlc3QudHlwZSA9PT0gJ1VQREFURV9QT1BVUF9DQVJEJykge1xuICAgICAgICBwb3B1cFBvcnQucG9zdE1lc3NhZ2UocmVxdWVzdCk7XG4gICAgfVxufVxuY29uc3Qgc2VuZE1lc3NhZ2VUb0NvbnRlbnQgPSAocnVuUHJvbXB0KSA9PiB7XG4gICAgY29uc29sZS5sb2coJ3NlbmRNZXNzYWdlVG9Db250ZW50OicpO1xuICAgIGxldCBuZWVkVG9SdW5Qcm9tcHQgPSBydW5Qcm9tcHQ7XG4gICAgaWYgKG5lZWRUb1J1blByb21wdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5lZWRUb1J1blByb21wdCA9IHRydWU7XG4gICAgfVxuICAgIHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQudGFicy5xdWVyeSh7IGFjdGl2ZTogdHJ1ZSwgY3VycmVudFdpbmRvdzogdHJ1ZSB9KS50aGVuKCh0YWJzKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc29sZS5sb2codGFicyk7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVRhYiA9IHRhYnNbMF07XG4gICAgICAgIGxldCB0SUQgPSAoX2EgPSBhY3RpdmVUYWIuaWQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IC0xO1xuICAgICAgICBpZiAoYWN0aXZlVGFiICYmIGFjdGl2ZVRhYi5pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBsZXQgYiA9IHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF8xLmRlZmF1bHQudGFicy5zZW5kTWVzc2FnZSh0SUQsIHsgdHlwZTogJ29wZW4tc2NvdXRlcicsIHJ1blByb21wdDogbmVlZFRvUnVuUHJvbXB0IH0pO1xuICAgICAgICAgICAgLy8g5bey55+l5oOF5Ya177ya5Yia5a6J6KOF5o+S5Lu25pe255u05o6l5L2/55So5Lya5oql6ZSZ77yI5Yi35paw6aG16Z2i5ZCO5L2/55So5YiZ5q2j5bi477yJ77yM5q2k5pe26ZyA6KaB6L295YWlIGNvbnRlbnRfc2NyaXB0LmpzIOaJjeihjFxuICAgICAgICAgICAgLy8gYi5jYXRjaChlID0+IHtcbiAgICAgICAgICAgIC8vICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKCdjYXRjaCcpO1xuICAgICAgICAgICAgLy8gICBicm93c2VyLnNjcmlwdGluZy5leGVjdXRlU2NyaXB0KHtcbiAgICAgICAgICAgIC8vICAgICB0YXJnZXQ6IHsgdGFiSWQ6IHRJRCB9LFxuICAgICAgICAgICAgLy8gICAgIGZpbGVzOiBbXCJqcy92ZW5kb3IuanNcIiwgXCJqcy9jb250ZW50X3NjcmlwdC5qc1wiXSxcbiAgICAgICAgICAgIC8vICAgfSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ2Nocm9tZS5zY3JpcHRpbmcuZXhlY3V0ZVNjcmlwdCcpO1xuICAgICAgICAgICAgLy8gICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIC8vICAgICBicm93c2VyLnRhYnMuc2VuZE1lc3NhZ2UodElELCB7IHR5cGU6ICdvcGVuLXNjb3V0ZXInIH0pXG4gICAgICAgICAgICAvLyAgIH0pXG4gICAgICAgICAgICAvLyB9KVxuICAgICAgICB9XG4gICAgfSk7XG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcbiAgICAgIGRlc2MgPSB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19zZXRNb2R1bGVEZWZhdWx0KSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xufSkgOiBmdW5jdGlvbihvLCB2KSB7XG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xufSk7XG52YXIgX19pbXBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydFN0YXIpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBcImRlZmF1bHRcIjogbW9kIH07XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5nZXRVc2VySWQgPSBleHBvcnRzLmdldEJhbGFuY2UgPSBleHBvcnRzLnBsYXlUZXh0VG9TcGVlY2ggPSBleHBvcnRzLmdldERlZmF1bHREZWNrTmFtZSA9IGV4cG9ydHMudW5zcGxhc2hTZWFyY2hQaG90b3MgPSBleHBvcnRzLmFua2lBY3Rpb24gPSB2b2lkIDA7XG5jb25zdCB3ZWJleHRlbnNpb25fcG9seWZpbGxfMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsXCIpKTtcbmNvbnN0IHVuc3BsYXNoX2pzXzEgPSByZXF1aXJlKFwidW5zcGxhc2gtanNcIik7XG5jb25zdCBzZGsgPSBfX2ltcG9ydFN0YXIocmVxdWlyZShcIm1pY3Jvc29mdC1jb2duaXRpdmVzZXJ2aWNlcy1zcGVlY2gtc2RrXCIpKTtcbmNvbnN0IHV1aWRfMSA9IHJlcXVpcmUoXCJ1dWlkXCIpO1xuLy8g5bCG5L+h5oGv5re75Yqg5YiwIEFua2lcbmZ1bmN0aW9uIGFua2lBY3Rpb24oYWN0aW9uLCB2ZXJzaW9uLCBwYXJhbXMgPSB7fSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGZldGNoKCdodHRwOi8vMTI3LjAuMC4xOjg3NjUnLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBcImFjdGlvblwiOiBhY3Rpb24sIFwidmVyc2lvblwiOiB2ZXJzaW9uLCBcInBhcmFtc1wiOiBwYXJhbXMgfSlcbiAgICAgICAgfSkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICByZWplY3QoeyAncmVzdWx0JzogW10sICdlcnJvcic6ICdQbGVhc2Ugb3BlbiB0aGUgQW5raSBjbGllbnQgYW5kIGluc3RhbGwgdGhlIEFua2ktQ29ubmVjdCBwbHVnaW4gYmVmb3JlIHRyeWluZyBhZ2Fpbi4nIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuYW5raUFjdGlvbiA9IGFua2lBY3Rpb247XG4vLyDlnKggdW5zcGxhc2gg5Lit5pCc57Si54Wn54mHXG5mdW5jdGlvbiB1bnNwbGFzaFNlYXJjaFBob3RvcyhBUElfS0VZLCBxdWVyeSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHVuc3BsYXNoID0gKDAsIHVuc3BsYXNoX2pzXzEuY3JlYXRlQXBpKSh7XG4gICAgICAgICAgICBhY2Nlc3NLZXk6IEFQSV9LRVksXG4gICAgICAgIH0pO1xuICAgICAgICB1bnNwbGFzaC5zZWFyY2guZ2V0UGhvdG9zKHtcbiAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeSxcbiAgICAgICAgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgaWYgKCgoX2EgPSBkYXRhLnJlc3BvbnNlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVzdWx0cy5sZW5ndGgpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKChfYiA9IGRhdGEucmVzcG9uc2UpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5yZXN1bHRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMudW5zcGxhc2hTZWFyY2hQaG90b3MgPSB1bnNwbGFzaFNlYXJjaFBob3Rvcztcbi8vIOiOt+WPliBBbmtpIOeahCBEZWNrIOWQjeensO+8jOa3u+WKoOWIsOWNoeeJh+S8muWtmOaUvuWIsOi/memHjFxuZnVuY3Rpb24gZ2V0RGVmYXVsdERlY2tOYW1lKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGxldCBkZWZhdWx0RGVja05hbWUgPSAnJztcbiAgICAgICAgLy8g6I635Y+W55So5oi36K6+572u55qEIERlY2sgTmFtZVxuICAgICAgICB3ZWJleHRlbnNpb25fcG9seWZpbGxfMS5kZWZhdWx0LnN0b3JhZ2Uuc3luYy5nZXQoW1wiYW5raURlY2tOYW1lXCJdKS50aGVuKChyZXN1bHQpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyZXN1bHQ6Jyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5hbmtpRGVja05hbWUpIHtcbiAgICAgICAgICAgICAgICAvLyDnlKjmiLfmnInorr7nva5cbiAgICAgICAgICAgICAgICBkZWZhdWx0RGVja05hbWUgPSByZXN1bHQuYW5raURlY2tOYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8g55So5oi35pyq6K6+572uXG4gICAgICAgICAgICAgICAgLy8g6I635Y+WIEFua2kg55qE54mM57uE5YiX6KGoXG4gICAgICAgICAgICAgICAgZGVmYXVsdERlY2tOYW1lID0geWllbGQgYW5raUFjdGlvbignZGVja05hbWVzJywgNikudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIOWwhuesrOS4gOS4queJjOe7hOS9nOS4uum7mOiupOeJjOe7hFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LnJlc3VsdFswXTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXNvbHZlKHsgJ2RlZmF1bHREZWNrTmFtZSc6IGRlZmF1bHREZWNrTmFtZSB9KTtcbiAgICAgICAgfSkpO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXREZWZhdWx0RGVja05hbWUgPSBnZXREZWZhdWx0RGVja05hbWU7XG5jb25zdCBwbGF5VGV4dFRvU3BlZWNoID0gKHRleHQsIHZvaWNlKSA9PiB7XG4gICAgY29uc3QgYXVkaW9Db25maWcgPSBzZGsuQXVkaW9Db25maWcuZnJvbURlZmF1bHRTcGVha2VyT3V0cHV0KCk7XG4gICAgY29uc3Qgc3BlZWNoQ29uZmlnID0gc2RrLlNwZWVjaENvbmZpZy5mcm9tU3Vic2NyaXB0aW9uKHByb2Nlc3MuZW52LkFaVVJFX1RUU19BUElfS0VZLCBwcm9jZXNzLmVudi5BWlVSRV9UVFNfU1BFRUNIX1JFR0lPTik7XG4gICAgc3BlZWNoQ29uZmlnLnNwZWVjaFN5bnRoZXNpc1ZvaWNlTmFtZSA9IHZvaWNlO1xuICAgIGNvbnN0IHN5bnRoZXNpemVyID0gbmV3IHNkay5TcGVlY2hTeW50aGVzaXplcihzcGVlY2hDb25maWcsIGF1ZGlvQ29uZmlnKTtcbiAgICBzeW50aGVzaXplci5zcGVha1RleHRBc3luYyh0ZXh0LCBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIGlmIChyZXN1bHQucmVhc29uID09PSBzZGsuUmVzdWx0UmVhc29uLlN5bnRoZXNpemluZ0F1ZGlvQ29tcGxldGVkKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc3ludGhlc2lzIGZpbmlzaGVkLicpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignU3BlZWNoIHN5bnRoZXNpcyBjYW5jZWxlZCwgJyArIHJlc3VsdC5lcnJvckRldGFpbHMgKyAnXFxuRGlkIHlvdSBzZXQgdGhlIHNwZWVjaCByZXNvdXJjZSBrZXkgYW5kIHJlZ2lvbiB2YWx1ZXM/Jyk7XG4gICAgICAgIH1cbiAgICAgICAgc3ludGhlc2l6ZXIuY2xvc2UoKTtcbiAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIC8vIGNvbnNvbGUudHJhY2UoJ2VyciAtICcgKyBlcnIpO1xuICAgICAgICBzeW50aGVzaXplci5jbG9zZSgpO1xuICAgIH0pO1xuICAgIC8vIGNvbnNvbGUubG9nKCdOb3cgc3ludGhlc2l6aW5nLi4uJyk7XG59O1xuZXhwb3J0cy5wbGF5VGV4dFRvU3BlZWNoID0gcGxheVRleHRUb1NwZWVjaDtcbmNvbnN0IGdldEJhbGFuY2UgPSAoYXBpS2V5KSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjEvYXV0aC9rZXknO1xuICAgICAgICBjb25zdCBoZWFkZXJzID0geyAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIGFwaUtleSwgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywgfTtcbiAgICAgICAgZmV0Y2godXJsLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXG4gICAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICByZXNwb25zZS5qc29uKCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuZXhwb3J0cy5nZXRCYWxhbmNlID0gZ2V0QmFsYW5jZTtcbmNvbnN0IGdldFVzZXJJZCA9ICgpID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLmdldCgndXNlcklkJywgKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlamVjdChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdC51c2VySWQpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC51c2VySWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IHVuaXF1ZUlkID0gKDAsIHV1aWRfMS52NCkoKTtcbiAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldCh7IHVzZXJJZDogdW5pcXVlSWQgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hyb21lLnJ1bnRpbWUubGFzdEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoY2hyb21lLnJ1bnRpbWUubGFzdEVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodW5pcXVlSWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcbmV4cG9ydHMuZ2V0VXNlcklkID0gZ2V0VXNlcklkO1xuIiwiaW1wb3J0IHsgcGFyc2UgfSBmcm9tICdjb250ZW50LXR5cGUnO1xuXG5mdW5jdGlvbiBfZXh0ZW5kcygpIHtcbiAgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcblxuICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9O1xuXG4gIHJldHVybiBfZXh0ZW5kcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShzb3VyY2UsIGV4Y2x1ZGVkKSB7XG4gIGlmIChzb3VyY2UgPT0gbnVsbCkgcmV0dXJuIHt9O1xuICB2YXIgdGFyZ2V0ID0ge307XG4gIHZhciBzb3VyY2VLZXlzID0gT2JqZWN0LmtleXMoc291cmNlKTtcbiAgdmFyIGtleSwgaTtcblxuICBmb3IgKGkgPSAwOyBpIDwgc291cmNlS2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGtleSA9IHNvdXJjZUtleXNbaV07XG4gICAgaWYgKGV4Y2x1ZGVkLmluZGV4T2Yoa2V5KSA+PSAwKSBjb250aW51ZTtcbiAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxudmFyIGNoZWNrSXNTdHJpbmcgPSAvKiNfX1BVUkVfXyovZ2V0UmVmaW5lbWVudChmdW5jdGlvbiAodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZSA6IG51bGw7XG59KTtcbnZhciBpc0RlZmluZWQgPSBmdW5jdGlvbiBpc0RlZmluZWQoeCkge1xuICByZXR1cm4geCAhPT0gbnVsbCAmJiB4ICE9PSB1bmRlZmluZWQ7XG59O1xuZnVuY3Rpb24gZ2V0UmVmaW5lbWVudChnZXRCKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgIHJldHVybiBpc0RlZmluZWQoZ2V0QihhKSk7XG4gIH07XG59XG52YXIgY2hlY2tJc05vbkVtcHR5QXJyYXkgPSBmdW5jdGlvbiBjaGVja0lzTm9uRW1wdHlBcnJheShhKSB7XG4gIHJldHVybiBhLmxlbmd0aCA+IDA7XG59O1xuXG4vKiogVGFrZXMgYSBkaWN0aW9uYXJ5IGNvbnRhaW5pbmcgbnVsbGlzaCB2YWx1ZXMgYW5kIHJldHVybnMgYSBkaWN0aW9uYXJ5IG9mIGFsbCB0aGUgZGVmaW5lZFxyXG4gKiAobm9uLW51bGxpc2gpIHZhbHVlcy5cclxuICovXG5cbnZhciBjb21wYWN0RGVmaW5lZCA9IGZ1bmN0aW9uIGNvbXBhY3REZWZpbmVkKG9iaikge1xuICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywga2V5KSB7XG4gICAgdmFyIF9yZWY7XG5cbiAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTtcbiAgICByZXR1cm4gX2V4dGVuZHMoe30sIGFjYywgaXNEZWZpbmVkKHZhbHVlKSA/IChfcmVmID0ge30sIF9yZWZba2V5XSA9IHZhbHVlLCBfcmVmKSA6IHt9KTtcbiAgfSwge30pO1xufTtcbmZ1bmN0aW9uIGZsb3coKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBmbnMgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgZm5zW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICB9XG5cbiAgdmFyIGxlbiA9IGZucy5sZW5ndGggLSAxO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgeCA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgICAgeFtfa2V5Ml0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgIH1cblxuICAgIHZhciB5ID0gZm5zWzBdLmFwcGx5KHRoaXMsIHgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gbGVuOyBpKyspIHtcbiAgICAgIHkgPSBmbnNbaV0uY2FsbCh0aGlzLCB5KTtcbiAgICB9XG5cbiAgICByZXR1cm4geTtcbiAgfTtcbn1cblxudmFyIGNoZWNrSXNPYmplY3QgPSAvKiNfX1BVUkVfXyovZ2V0UmVmaW5lbWVudChmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgcmV0dXJuIGlzRGVmaW5lZChyZXNwb25zZSkgJiYgdHlwZW9mIHJlc3BvbnNlID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShyZXNwb25zZSkgPyByZXNwb25zZSA6IG51bGw7XG59KTtcbnZhciBjaGVja0lzRXJyb3JzID0gLyojX19QVVJFX18qL2dldFJlZmluZW1lbnQoZnVuY3Rpb24gKGVycm9ycykge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheShlcnJvcnMpICYmIGVycm9ycy5ldmVyeShjaGVja0lzU3RyaW5nKSAmJiBjaGVja0lzTm9uRW1wdHlBcnJheShlcnJvcnMpID8gZXJyb3JzIDogbnVsbDtcbn0pO1xudmFyIGNoZWNrSXNBcGlFcnJvciA9IC8qI19fUFVSRV9fKi9nZXRSZWZpbmVtZW50KGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICByZXR1cm4gY2hlY2tJc09iamVjdChyZXNwb25zZSkgJiYgJ2Vycm9ycycgaW4gcmVzcG9uc2UgJiYgY2hlY2tJc0Vycm9ycyhyZXNwb25zZS5lcnJvcnMpID8ge1xuICAgIGVycm9yczogcmVzcG9uc2UuZXJyb3JzXG4gIH0gOiBudWxsO1xufSk7XG52YXIgZ2V0RXJyb3JGb3JCYWRTdGF0dXNDb2RlID0gZnVuY3Rpb24gZ2V0RXJyb3JGb3JCYWRTdGF0dXNDb2RlKGpzb25SZXNwb25zZSkge1xuICBpZiAoY2hlY2tJc0FwaUVycm9yKGpzb25SZXNwb25zZSkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3JzOiBqc29uUmVzcG9uc2UuZXJyb3JzLFxuICAgICAgc291cmNlOiAnYXBpJ1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yczogWydSZXNwb25kZWQgd2l0aCBhIHN0YXR1cyBjb2RlIG91dHNpZGUgdGhlIDJ4eCByYW5nZSwgYW5kIHRoZSByZXNwb25zZSBib2R5IGlzIG5vdCByZWNvZ25pc2FibGUuJ10sXG4gICAgICBzb3VyY2U6ICdkZWNvZGluZydcbiAgICB9O1xuICB9XG59O1xudmFyIERlY29kaW5nRXJyb3IgPSBmdW5jdGlvbiBEZWNvZGluZ0Vycm9yKG1lc3NhZ2UpIHtcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbn07XG5cbnZhciBDT05URU5UX1RZUEVfUkVTUE9OU0VfSEVBREVSID0gJ2NvbnRlbnQtdHlwZSc7XG52YXIgQ09OVEVOVF9UWVBFX0pTT04gPSAnYXBwbGljYXRpb24vanNvbic7XG5cbnZhciBjaGVja0lzSnNvblJlc3BvbnNlID0gZnVuY3Rpb24gY2hlY2tJc0pzb25SZXNwb25zZShyZXNwb25zZSkge1xuICB2YXIgY29udGVudFR5cGVIZWFkZXIgPSByZXNwb25zZS5oZWFkZXJzLmdldChDT05URU5UX1RZUEVfUkVTUE9OU0VfSEVBREVSKTtcbiAgcmV0dXJuIGlzRGVmaW5lZChjb250ZW50VHlwZUhlYWRlcikgJiYgcGFyc2UoY29udGVudFR5cGVIZWFkZXIpLnR5cGUgPT09IENPTlRFTlRfVFlQRV9KU09OO1xufTtcbi8qKlxyXG4gKiBOb3RlOiByZXN0cmljdCB0aGUgdHlwZSBvZiBKU09OIHRvIGBBbnlKc29uYCBzbyB0aGF0IGBhbnlgIGRvZXNuJ3QgbGVhayBkb3duc3RyZWFtLlxyXG4gKi9cblxuXG52YXIgZ2V0SnNvblJlc3BvbnNlID0gZnVuY3Rpb24gZ2V0SnNvblJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gIGlmIChjaGVja0lzSnNvblJlc3BvbnNlKHJlc3BvbnNlKSkge1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKClbXCJjYXRjaFwiXShmdW5jdGlvbiAoX2Vycikge1xuICAgICAgdGhyb3cgbmV3IERlY29kaW5nRXJyb3IoJ3VuYWJsZSB0byBwYXJzZSBKU09OIHJlc3BvbnNlLicpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBEZWNvZGluZ0Vycm9yKCdleHBlY3RlZCBKU09OIHJlc3BvbnNlIGZyb20gc2VydmVyLicpO1xuICB9XG59O1xuXG52YXIgaGFuZGxlRmV0Y2hSZXNwb25zZSA9IGZ1bmN0aW9uIGhhbmRsZUZldGNoUmVzcG9uc2UoaGFuZGxlUmVzcG9uc2UpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIHJldHVybiAocmVzcG9uc2Uub2sgPyBoYW5kbGVSZXNwb25zZSh7XG4gICAgICByZXNwb25zZTogcmVzcG9uc2VcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChoYW5kbGVkUmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcbiAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgIHJlc3BvbnNlOiBoYW5kbGVkUmVzcG9uc2UsXG4gICAgICAgIG9yaWdpbmFsUmVzcG9uc2U6IHJlc3BvbnNlXG4gICAgICB9O1xuICAgIH0pIDogZ2V0SnNvblJlc3BvbnNlKHJlc3BvbnNlKS50aGVuKGZ1bmN0aW9uIChqc29uUmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzXG4gICAgICB9LCBnZXRFcnJvckZvckJhZFN0YXR1c0NvZGUoanNvblJlc3BvbnNlKSwge1xuICAgICAgICBvcmlnaW5hbFJlc3BvbnNlOiByZXNwb25zZVxuICAgICAgfSk7XG4gICAgfSkpW1wiY2F0Y2hcIl0oZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAvKipcclxuICAgICAgICogV2Ugd2FudCB0byBzZXBhcmF0ZSBleHBlY3RlZCBkZWNvZGluZyBlcnJvcnMgZnJvbSB1bmtub3duIG9uZXMuIFdlIGRvIHNvIGJ5IHRocm93aW5nIGEgY3VzdG9tXHJcbiAgICAgICAqIGBEZWNvZGluZ0Vycm9yYCB3aGVuZXZlciB3ZSBlbmNvdW50ZXIgb25lIHdpdGhpbiBgaGFuZGxlRmV0Y2hSZXNwb25zZWAgYW5kIGNhdGNoIHRoZW0gYWxsXHJcbiAgICAgICAqIGhlcmUuIFRoaXMgYWxsb3dzIHVzIHRvIGVhc2lseSBoYW5kbGUgYWxsIG9mIHRoZXNlIGVycm9ycyBhdCBvbmNlLiBVbmV4cGVjdGVkIGVycm9ycyBhcmUgbm90XHJcbiAgICAgICAqIGNhdWdodCwgc28gdGhhdCB0aGV5IGJ1YmJsZSB1cCBhbmQgZmFpbCBsb3VkbHkuXHJcbiAgICAgICAqXHJcbiAgICAgICAqIE5vdGU6IElkZWFsbHkgd2UnZCB1c2UgYW4gRWl0aGVyIHR5cGUsIGJ1dCB0aGlzIGRvZXMgdGhlIGpvYiB3aXRob3V0IGludHJvZHVjaW5nIGRlcGVuZGVuY2llc1xyXG4gICAgICAgKiBsaWtlIGBmcC10c2AuXHJcbiAgICAgICAqL1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRGVjb2RpbmdFcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgICAgc291cmNlOiAnZGVjb2RpbmcnLFxuICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIG9yaWdpbmFsUmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICAgIGVycm9yczogW2Vycm9yLm1lc3NhZ2VdXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn07XG52YXIgY2FzdFJlc3BvbnNlID0gZnVuY3Rpb24gY2FzdFJlc3BvbnNlKCkge1xuICByZXR1cm4gZnVuY3Rpb24gKF9yZWYpIHtcbiAgICB2YXIgcmVzcG9uc2UgPSBfcmVmLnJlc3BvbnNlO1xuICAgIHJldHVybiBnZXRKc29uUmVzcG9uc2UocmVzcG9uc2UpO1xuICB9O1xufTtcblxudmFyIGFkZFF1ZXJ5VG9VcmwgPSBmdW5jdGlvbiBhZGRRdWVyeVRvVXJsKHF1ZXJ5KSB7XG4gIHJldHVybiBmdW5jdGlvbiAodXJsKSB7XG4gICAgT2JqZWN0LmtleXMocXVlcnkpLmZvckVhY2goZnVuY3Rpb24gKHF1ZXJ5S2V5KSB7XG4gICAgICByZXR1cm4gdXJsLnNlYXJjaFBhcmFtcy5zZXQocXVlcnlLZXksIHF1ZXJ5W3F1ZXJ5S2V5XS50b1N0cmluZygpKTtcbiAgICB9KTtcbiAgfTtcbn07XG5cbnZhciBhZGRQYXRobmFtZVRvVXJsID0gZnVuY3Rpb24gYWRkUGF0aG5hbWVUb1VybChwYXRobmFtZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHVybCkge1xuICAgIC8vIFdoZW4gdGhlcmUgaXMgbm8gZXhpc3RpbmcgcGF0aG5hbWUsIHRoZSB2YWx1ZSBpcyBgL2AuIEFwcGVuZGluZyB3b3VsZCBnaXZlIHVzIGEgVVJMIHdpdGggdHdvXG4gICAgLy8gZm9yd2FyZCBzbGFzaGVzLiBUaGlzIGlzIHdoeSB3ZSByZXBsYWNlIHRoZSB2YWx1ZSBpbiB0aGF0IHNjZW5hcmlvLlxuICAgIGlmICh1cmwucGF0aG5hbWUgPT09ICcvJykge1xuICAgICAgdXJsLnBhdGhuYW1lID0gcGF0aG5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVybC5wYXRobmFtZSArPSBwYXRobmFtZTtcbiAgICB9XG4gIH07XG59O1xuXG52YXIgYnVpbGRVcmwgPSBmdW5jdGlvbiBidWlsZFVybChfcmVmKSB7XG4gIHZhciBwYXRobmFtZSA9IF9yZWYucGF0aG5hbWUsXG4gICAgICBxdWVyeSA9IF9yZWYucXVlcnk7XG4gIHJldHVybiBmdW5jdGlvbiAoYXBpVXJsKSB7XG4gICAgdmFyIHVybCA9IG5ldyBVUkwoYXBpVXJsKTtcbiAgICBhZGRQYXRobmFtZVRvVXJsKHBhdGhuYW1lKSh1cmwpO1xuICAgIGFkZFF1ZXJ5VG9VcmwocXVlcnkpKHVybCk7XG4gICAgcmV0dXJuIHVybC50b1N0cmluZygpO1xuICB9O1xufTtcblxudmFyIGdldFF1ZXJ5RnJvbVNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uIGdldFF1ZXJ5RnJvbVNlYXJjaFBhcmFtcyhzZWFyY2hQYXJhbXMpIHtcbiAgdmFyIHF1ZXJ5ID0ge307XG4gIHNlYXJjaFBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgcXVlcnlba2V5XSA9IHZhbHVlO1xuICB9KTtcbiAgcmV0dXJuIHF1ZXJ5O1xufTtcblxudmFyIHBhcnNlUXVlcnlBbmRQYXRobmFtZSA9IGZ1bmN0aW9uIHBhcnNlUXVlcnlBbmRQYXRobmFtZSh1cmwpIHtcbiAgdmFyIF9VUkwgPSBuZXcgVVJMKHVybCksXG4gICAgICBwYXRobmFtZSA9IF9VUkwucGF0aG5hbWUsXG4gICAgICBzZWFyY2hQYXJhbXMgPSBfVVJMLnNlYXJjaFBhcmFtcztcblxuICB2YXIgcXVlcnkgPSBnZXRRdWVyeUZyb21TZWFyY2hQYXJhbXMoc2VhcmNoUGFyYW1zKTtcbiAgcmV0dXJuIHtcbiAgICBxdWVyeTogcXVlcnksXG4gICAgcGF0aG5hbWU6IHBhdGhuYW1lID09PSAnLycgPyB1bmRlZmluZWQgOiBwYXRobmFtZVxuICB9O1xufTtcblxuLyoqXHJcbiAqIGhlbHBlciB1c2VkIHRvIHR5cGUtY2hlY2sgdGhlIGFyZ3VtZW50cywgYW5kIGFkZCBkZWZhdWx0IHBhcmFtcyBmb3IgYWxsIHJlcXVlc3RzXHJcbiAqL1xuXG52YXIgY3JlYXRlUmVxdWVzdEhhbmRsZXIgPSBmdW5jdGlvbiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmbikge1xuICByZXR1cm4gZnVuY3Rpb24gKGEsIGFkZGl0aW9uYWxGZXRjaE9wdGlvbnMpIHtcbiAgICBpZiAoYWRkaXRpb25hbEZldGNoT3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgICBhZGRpdGlvbmFsRmV0Y2hPcHRpb25zID0ge307XG4gICAgfVxuXG4gICAgdmFyIF9mbiA9IGZuKGEpLFxuICAgICAgICBoZWFkZXJzID0gX2ZuLmhlYWRlcnMsXG4gICAgICAgIHF1ZXJ5ID0gX2ZuLnF1ZXJ5LFxuICAgICAgICBiYXNlUmVxUGFyYW1zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX2ZuLCBbXCJoZWFkZXJzXCIsIFwicXVlcnlcIl0pO1xuXG4gICAgcmV0dXJuIF9leHRlbmRzKHt9LCBiYXNlUmVxUGFyYW1zLCBhZGRpdGlvbmFsRmV0Y2hPcHRpb25zLCB7XG4gICAgICBxdWVyeTogcXVlcnksXG4gICAgICBoZWFkZXJzOiBfZXh0ZW5kcyh7fSwgaGVhZGVycywgYWRkaXRpb25hbEZldGNoT3B0aW9ucy5oZWFkZXJzKVxuICAgIH0pO1xuICB9O1xufTtcbnZhciBtYWtlRW5kcG9pbnQgPSBmdW5jdGlvbiBtYWtlRW5kcG9pbnQoZW5kcG9pbnQpIHtcbiAgcmV0dXJuIGVuZHBvaW50O1xufTtcbnZhciBpbml0TWFrZVJlcXVlc3QgPSBmdW5jdGlvbiBpbml0TWFrZVJlcXVlc3QoX3JlZikge1xuICB2YXIgYWNjZXNzS2V5ID0gX3JlZi5hY2Nlc3NLZXksXG4gICAgICBfcmVmJGFwaVZlcnNpb24gPSBfcmVmLmFwaVZlcnNpb24sXG4gICAgICBhcGlWZXJzaW9uID0gX3JlZiRhcGlWZXJzaW9uID09PSB2b2lkIDAgPyAndjEnIDogX3JlZiRhcGlWZXJzaW9uLFxuICAgICAgX3JlZiRhcGlVcmwgPSBfcmVmLmFwaVVybCxcbiAgICAgIGFwaVVybCA9IF9yZWYkYXBpVXJsID09PSB2b2lkIDAgPyAnaHR0cHM6Ly9hcGkudW5zcGxhc2guY29tJyA6IF9yZWYkYXBpVXJsLFxuICAgICAgZ2VuZXJhbEhlYWRlcnMgPSBfcmVmLmhlYWRlcnMsXG4gICAgICBwcm92aWRlZEZldGNoID0gX3JlZi5mZXRjaCxcbiAgICAgIGdlbmVyYWxGZXRjaE9wdGlvbnMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmLCBbXCJhY2Nlc3NLZXlcIiwgXCJhcGlWZXJzaW9uXCIsIFwiYXBpVXJsXCIsIFwiaGVhZGVyc1wiLCBcImZldGNoXCJdKTtcblxuICByZXR1cm4gZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgdmFyIGhhbmRsZVJlc3BvbnNlID0gX3JlZjIuaGFuZGxlUmVzcG9uc2UsXG4gICAgICAgIGhhbmRsZVJlcXVlc3QgPSBfcmVmMi5oYW5kbGVSZXF1ZXN0O1xuICAgIHJldHVybiBmbG93KGhhbmRsZVJlcXVlc3QsIGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgdmFyIHBhdGhuYW1lID0gX3JlZjMucGF0aG5hbWUsXG4gICAgICAgICAgcXVlcnkgPSBfcmVmMy5xdWVyeSxcbiAgICAgICAgICBfcmVmMyRtZXRob2QgPSBfcmVmMy5tZXRob2QsXG4gICAgICAgICAgbWV0aG9kID0gX3JlZjMkbWV0aG9kID09PSB2b2lkIDAgPyAnR0VUJyA6IF9yZWYzJG1ldGhvZCxcbiAgICAgICAgICBlbmRwb2ludEhlYWRlcnMgPSBfcmVmMy5oZWFkZXJzLFxuICAgICAgICAgIGJvZHkgPSBfcmVmMy5ib2R5LFxuICAgICAgICAgIHNpZ25hbCA9IF9yZWYzLnNpZ25hbDtcbiAgICAgIHZhciB1cmwgPSBidWlsZFVybCh7XG4gICAgICAgIHBhdGhuYW1lOiBwYXRobmFtZSxcbiAgICAgICAgcXVlcnk6IHF1ZXJ5XG4gICAgICB9KShhcGlVcmwpO1xuXG4gICAgICB2YXIgZmV0Y2hPcHRpb25zID0gX2V4dGVuZHMoe1xuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgICAgaGVhZGVyczogX2V4dGVuZHMoe30sIGdlbmVyYWxIZWFkZXJzLCBlbmRwb2ludEhlYWRlcnMsIHtcbiAgICAgICAgICAnQWNjZXB0LVZlcnNpb24nOiBhcGlWZXJzaW9uXG4gICAgICAgIH0sIGlzRGVmaW5lZChhY2Nlc3NLZXkpID8ge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IFwiQ2xpZW50LUlEIFwiICsgYWNjZXNzS2V5XG4gICAgICAgIH0gOiB7fSksXG4gICAgICAgIGJvZHk6IGJvZHksXG4gICAgICAgIHNpZ25hbDogc2lnbmFsXG4gICAgICB9LCBnZW5lcmFsRmV0Y2hPcHRpb25zKTtcblxuICAgICAgdmFyIGZldGNoVG9Vc2UgPSBwcm92aWRlZEZldGNoICE9IG51bGwgPyBwcm92aWRlZEZldGNoIDogZmV0Y2g7XG4gICAgICByZXR1cm4gZmV0Y2hUb1VzZSh1cmwsIGZldGNoT3B0aW9ucykudGhlbihoYW5kbGVGZXRjaFJlc3BvbnNlKGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgfSk7XG4gIH07XG59O1xuXG52YXIgVE9UQUxfUkVTUE9OU0VfSEVBREVSID0gJ3gtdG90YWwnO1xuXG52YXIgZ2V0VG90YWxGcm9tQXBpRmVlZFJlc3BvbnNlID0gZnVuY3Rpb24gZ2V0VG90YWxGcm9tQXBpRmVlZFJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gIHZhciB0b3RhbHNTdHIgPSByZXNwb25zZS5oZWFkZXJzLmdldChUT1RBTF9SRVNQT05TRV9IRUFERVIpO1xuXG4gIGlmIChpc0RlZmluZWQodG90YWxzU3RyKSkge1xuICAgIHZhciB0b3RhbCA9IHBhcnNlSW50KHRvdGFsc1N0cik7XG5cbiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih0b3RhbCkpIHtcbiAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IERlY29kaW5nRXJyb3IoXCJleHBlY3RlZCBcIiArIFRPVEFMX1JFU1BPTlNFX0hFQURFUiArIFwiIGhlYWRlciB0byBiZSB2YWxpZCBpbnRlZ2VyLlwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IERlY29kaW5nRXJyb3IoXCJleHBlY3RlZCBcIiArIFRPVEFMX1JFU1BPTlNFX0hFQURFUiArIFwiIGhlYWRlciB0byBleGlzdC5cIik7XG4gIH1cbn07XG5cbnZhciBoYW5kbGVGZWVkUmVzcG9uc2UgPSBmdW5jdGlvbiBoYW5kbGVGZWVkUmVzcG9uc2UoKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoX3JlZikge1xuICAgIHZhciByZXNwb25zZSA9IF9yZWYucmVzcG9uc2U7XG4gICAgcmV0dXJuIGNhc3RSZXNwb25zZSgpKHtcbiAgICAgIHJlc3BvbnNlOiByZXNwb25zZVxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdHM6IHJlc3VsdHMsXG4gICAgICAgIHRvdGFsOiBnZXRUb3RhbEZyb21BcGlGZWVkUmVzcG9uc2UocmVzcG9uc2UpXG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xufTtcblxudmFyIGdldENvbGxlY3Rpb25zID0gZnVuY3Rpb24gZ2V0Q29sbGVjdGlvbnMoY29sbGVjdGlvbklkcykge1xuICByZXR1cm4gaXNEZWZpbmVkKGNvbGxlY3Rpb25JZHMpID8ge1xuICAgIGNvbGxlY3Rpb25zOiBjb2xsZWN0aW9uSWRzLmpvaW4oKVxuICB9IDoge307XG59O1xudmFyIGdldFRvcGljcyA9IGZ1bmN0aW9uIGdldFRvcGljcyh0b3BpY0lkcykge1xuICByZXR1cm4gaXNEZWZpbmVkKHRvcGljSWRzKSA/IHtcbiAgICB0b3BpY3M6IHRvcGljSWRzLmpvaW4oKVxuICB9IDoge307XG59O1xudmFyIGdldEZlZWRQYXJhbXMgPSBmdW5jdGlvbiBnZXRGZWVkUGFyYW1zKF9yZWYpIHtcbiAgdmFyIHBhZ2UgPSBfcmVmLnBhZ2UsXG4gICAgICBwZXJQYWdlID0gX3JlZi5wZXJQYWdlLFxuICAgICAgb3JkZXJCeSA9IF9yZWYub3JkZXJCeTtcbiAgcmV0dXJuIGNvbXBhY3REZWZpbmVkKHtcbiAgICBwZXJfcGFnZTogcGVyUGFnZSxcbiAgICBvcmRlcl9ieTogb3JkZXJCeSxcbiAgICBwYWdlOiBwYWdlXG4gIH0pO1xufTtcblxudmFyIENPTExFQ1RJT05TX1BBVEhfUFJFRklYID0gJy9jb2xsZWN0aW9ucyc7XG52YXIgZ2V0UGhvdG9zID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZikge1xuICAgIHZhciBjb2xsZWN0aW9uSWQgPSBfcmVmLmNvbGxlY3Rpb25JZDtcbiAgICByZXR1cm4gQ09MTEVDVElPTlNfUEFUSF9QUkVGSVggKyBcIi9cIiArIGNvbGxlY3Rpb25JZCArIFwiL3Bob3Rvc1wiO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIGdldFBhdGhuYW1lOiBnZXRQYXRobmFtZSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICAgIHZhciBjb2xsZWN0aW9uSWQgPSBfcmVmMi5jb2xsZWN0aW9uSWQsXG4gICAgICAgICAgb3JpZW50YXRpb24gPSBfcmVmMi5vcmllbnRhdGlvbixcbiAgICAgICAgICBwYWdpbmF0aW9uUGFyYW1zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjIsIFtcImNvbGxlY3Rpb25JZFwiLCBcIm9yaWVudGF0aW9uXCJdKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKHtcbiAgICAgICAgICBjb2xsZWN0aW9uSWQ6IGNvbGxlY3Rpb25JZFxuICAgICAgICB9KSxcbiAgICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKF9leHRlbmRzKHt9LCBnZXRGZWVkUGFyYW1zKHBhZ2luYXRpb25QYXJhbXMpLCB7XG4gICAgICAgICAgb3JpZW50YXRpb246IG9yaWVudGF0aW9uXG4gICAgICAgIH0pKVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogaGFuZGxlRmVlZFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgZ2V0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZjMpIHtcbiAgICB2YXIgY29sbGVjdGlvbklkID0gX3JlZjMuY29sbGVjdGlvbklkO1xuICAgIHJldHVybiBDT0xMRUNUSU9OU19QQVRIX1BSRUZJWCArIFwiL1wiICsgY29sbGVjdGlvbklkO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIGdldFBhdGhuYW1lOiBnZXRQYXRobmFtZSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjQpIHtcbiAgICAgIHZhciBjb2xsZWN0aW9uSWQgPSBfcmVmNC5jb2xsZWN0aW9uSWQ7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIGNvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeToge31cbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGNhc3RSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGxpc3QgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZSgpIHtcbiAgICByZXR1cm4gQ09MTEVDVElPTlNfUEFUSF9QUkVGSVg7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChwYWdpbmF0aW9uUGFyYW1zKSB7XG4gICAgICBpZiAocGFnaW5hdGlvblBhcmFtcyA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHBhZ2luYXRpb25QYXJhbXMgPSB7fTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKCksXG4gICAgICAgIHF1ZXJ5OiBnZXRGZWVkUGFyYW1zKHBhZ2luYXRpb25QYXJhbXMpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBoYW5kbGVGZWVkUmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRSZWxhdGVkID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZjUpIHtcbiAgICB2YXIgY29sbGVjdGlvbklkID0gX3JlZjUuY29sbGVjdGlvbklkO1xuICAgIHJldHVybiBDT0xMRUNUSU9OU19QQVRIX1BSRUZJWCArIFwiL1wiICsgY29sbGVjdGlvbklkICsgXCIvcmVsYXRlZFwiO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIGdldFBhdGhuYW1lOiBnZXRQYXRobmFtZSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjYpIHtcbiAgICAgIHZhciBjb2xsZWN0aW9uSWQgPSBfcmVmNi5jb2xsZWN0aW9uSWQ7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIGNvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeToge31cbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGNhc3RSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xuXG52YXIgaW5kZXggPSB7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgZ2V0UGhvdG9zOiBnZXRQaG90b3MsXG4gIGdldDogZ2V0LFxuICBsaXN0OiBsaXN0LFxuICBnZXRSZWxhdGVkOiBnZXRSZWxhdGVkXG59O1xuXG52YXIgUEhPVE9TX1BBVEhfUFJFRklYID0gJy9waG90b3MnO1xudmFyIGxpc3QkMSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBfZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZSgpIHtcbiAgICByZXR1cm4gUEhPVE9TX1BBVEhfUFJFRklYO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIC8vIFdyYXBwZXIgdXNlcyB0eXBlIHRyaWNrIHRvIGFsbG93IDAgYXJnc1xuICAgIGdldFBhdGhuYW1lOiBmdW5jdGlvbiBnZXRQYXRobmFtZShfcGFyYW1zKSB7XG4gICAgICByZXR1cm4gX2dldFBhdGhuYW1lKCk7XG4gICAgfSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoZmVlZFBhcmFtcykge1xuICAgICAgaWYgKGZlZWRQYXJhbXMgPT09IHZvaWQgMCkge1xuICAgICAgICBmZWVkUGFyYW1zID0ge307XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBQSE9UT1NfUEFUSF9QUkVGSVgsXG4gICAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChnZXRGZWVkUGFyYW1zKGZlZWRQYXJhbXMpKVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogaGFuZGxlRmVlZFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgZ2V0JDEgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmKSB7XG4gICAgdmFyIHBob3RvSWQgPSBfcmVmLnBob3RvSWQ7XG4gICAgcmV0dXJuIFBIT1RPU19QQVRIX1BSRUZJWCArIFwiL1wiICsgcGhvdG9JZDtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICB2YXIgcGhvdG9JZCA9IF9yZWYyLnBob3RvSWQ7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIHBob3RvSWQ6IHBob3RvSWRcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiB7fVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogY2FzdFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgZ2V0U3RhdHMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZShfcmVmMykge1xuICAgIHZhciBwaG90b0lkID0gX3JlZjMucGhvdG9JZDtcbiAgICByZXR1cm4gUEhPVE9TX1BBVEhfUFJFRklYICsgXCIvXCIgKyBwaG90b0lkICsgXCIvc3RhdGlzdGljc1wiO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIGdldFBhdGhuYW1lOiBnZXRQYXRobmFtZSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjQpIHtcbiAgICAgIHZhciBwaG90b0lkID0gX3JlZjQucGhvdG9JZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgcGhvdG9JZDogcGhvdG9JZFxuICAgICAgICB9KSxcbiAgICAgICAgcXVlcnk6IHt9XG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBjYXN0UmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRSYW5kb20gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgZ2V0UGF0aG5hbWUgPSBmdW5jdGlvbiBnZXRQYXRobmFtZSgpIHtcbiAgICByZXR1cm4gUEhPVE9TX1BBVEhfUFJFRklYICsgXCIvcmFuZG9tXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfdGVtcCkge1xuICAgICAgdmFyIF9yZWY1ID0gX3RlbXAgPT09IHZvaWQgMCA/IHt9IDogX3RlbXAsXG4gICAgICAgICAgY29sbGVjdGlvbklkcyA9IF9yZWY1LmNvbGxlY3Rpb25JZHMsXG4gICAgICAgICAgY29udGVudEZpbHRlciA9IF9yZWY1LmNvbnRlbnRGaWx0ZXIsXG4gICAgICAgICAgdG9waWNJZHMgPSBfcmVmNS50b3BpY0lkcyxcbiAgICAgICAgICBxdWVyeVBhcmFtcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY1LCBbXCJjb2xsZWN0aW9uSWRzXCIsIFwiY29udGVudEZpbHRlclwiLCBcInRvcGljSWRzXCJdKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKCksXG4gICAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChfZXh0ZW5kcyh7fSwgcXVlcnlQYXJhbXMsIHtcbiAgICAgICAgICBjb250ZW50X2ZpbHRlcjogY29udGVudEZpbHRlclxuICAgICAgICB9LCBnZXRDb2xsZWN0aW9ucyhjb2xsZWN0aW9uSWRzKSwgZ2V0VG9waWNzKHRvcGljSWRzKSkpLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgKiBBdm9pZCByZXNwb25zZSBjYWNoaW5nXHJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICAnY2FjaGUtY29udHJvbCc6ICduby1jYWNoZSdcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogY2FzdFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgdHJhY2tEb3dubG9hZCA9IHtcbiAgaGFuZGxlUmVxdWVzdDogLyojX19QVVJFX18qL2NyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmNikge1xuICAgIHZhciBkb3dubG9hZExvY2F0aW9uID0gX3JlZjYuZG93bmxvYWRMb2NhdGlvbjtcblxuICAgIHZhciBfcGFyc2VRdWVyeUFuZFBhdGhuYW0gPSBwYXJzZVF1ZXJ5QW5kUGF0aG5hbWUoZG93bmxvYWRMb2NhdGlvbiksXG4gICAgICAgIHBhdGhuYW1lID0gX3BhcnNlUXVlcnlBbmRQYXRobmFtLnBhdGhuYW1lLFxuICAgICAgICBxdWVyeSA9IF9wYXJzZVF1ZXJ5QW5kUGF0aG5hbS5xdWVyeTtcblxuICAgIGlmICghaXNEZWZpbmVkKHBhdGhuYW1lKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UgcGF0aG5hbWUgZnJvbSB1cmwuJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBhdGhuYW1lOiBwYXRobmFtZSxcbiAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChxdWVyeSlcbiAgICB9O1xuICB9KSxcbiAgaGFuZGxlUmVzcG9uc2U6IC8qI19fUFVSRV9fKi9jYXN0UmVzcG9uc2UoKVxufTtcblxudmFyIGluZGV4JDEgPSB7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgbGlzdDogbGlzdCQxLFxuICBnZXQ6IGdldCQxLFxuICBnZXRTdGF0czogZ2V0U3RhdHMsXG4gIGdldFJhbmRvbTogZ2V0UmFuZG9tLFxuICB0cmFja0Rvd25sb2FkOiB0cmFja0Rvd25sb2FkXG59O1xuXG52YXIgU0VBUkNIX1BBVEhfUFJFRklYID0gXCIvc2VhcmNoXCI7XG52YXIgZ2V0UGhvdG9zJDEgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICB2YXIgX2dldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoKSB7XG4gICAgcmV0dXJuIFNFQVJDSF9QQVRIX1BSRUZJWCArIFwiL3Bob3Rvc1wiO1xuICB9O1xuXG4gIHJldHVybiBtYWtlRW5kcG9pbnQoe1xuICAgIC8vIFdyYXBwZXIgdXNlcyB0eXBlIHRyaWNrIHRvIGFsbG93IDAgYXJnc1xuICAgIGdldFBhdGhuYW1lOiBmdW5jdGlvbiBnZXRQYXRobmFtZShfcGFyYW1zKSB7XG4gICAgICByZXR1cm4gX2dldFBhdGhuYW1lKCk7XG4gICAgfSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZikge1xuICAgICAgdmFyIHF1ZXJ5ID0gX3JlZi5xdWVyeSxcbiAgICAgICAgICBwYWdlID0gX3JlZi5wYWdlLFxuICAgICAgICAgIHBlclBhZ2UgPSBfcmVmLnBlclBhZ2UsXG4gICAgICAgICAgb3JkZXJCeSA9IF9yZWYub3JkZXJCeSxcbiAgICAgICAgICBjb2xsZWN0aW9uSWRzID0gX3JlZi5jb2xsZWN0aW9uSWRzLFxuICAgICAgICAgIGxhbmcgPSBfcmVmLmxhbmcsXG4gICAgICAgICAgY29udGVudEZpbHRlciA9IF9yZWYuY29udGVudEZpbHRlcixcbiAgICAgICAgICBmaWx0ZXJzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZiwgW1wicXVlcnlcIiwgXCJwYWdlXCIsIFwicGVyUGFnZVwiLCBcIm9yZGVyQnlcIiwgXCJjb2xsZWN0aW9uSWRzXCIsIFwibGFuZ1wiLCBcImNvbnRlbnRGaWx0ZXJcIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogX2dldFBhdGhuYW1lKCksXG4gICAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChfZXh0ZW5kcyh7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5LFxuICAgICAgICAgIGNvbnRlbnRfZmlsdGVyOiBjb250ZW50RmlsdGVyLFxuICAgICAgICAgIGxhbmc6IGxhbmcsXG4gICAgICAgICAgb3JkZXJfYnk6IG9yZGVyQnlcbiAgICAgICAgfSwgZ2V0RmVlZFBhcmFtcyh7XG4gICAgICAgICAgcGFnZTogcGFnZSxcbiAgICAgICAgICBwZXJQYWdlOiBwZXJQYWdlXG4gICAgICAgIH0pLCBnZXRDb2xsZWN0aW9ucyhjb2xsZWN0aW9uSWRzKSwgZmlsdGVycykpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBjYXN0UmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRDb2xsZWN0aW9ucyQxID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIF9nZXRQYXRobmFtZTIgPSBmdW5jdGlvbiBnZXRQYXRobmFtZSgpIHtcbiAgICByZXR1cm4gU0VBUkNIX1BBVEhfUFJFRklYICsgXCIvY29sbGVjdGlvbnNcIjtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICAvLyBXcmFwcGVyIHVzZXMgdHlwZSB0cmljayB0byBhbGxvdyAwIGFyZ3NcbiAgICBnZXRQYXRobmFtZTogZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3BhcmFtcykge1xuICAgICAgcmV0dXJuIF9nZXRQYXRobmFtZTIoKTtcbiAgICB9LFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgdmFyIHF1ZXJ5ID0gX3JlZjIucXVlcnksXG4gICAgICAgICAgcGFnaW5hdGlvblBhcmFtcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWYyLCBbXCJxdWVyeVwiXSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBfZ2V0UGF0aG5hbWUyKCksXG4gICAgICAgIHF1ZXJ5OiBfZXh0ZW5kcyh7XG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5XG4gICAgICAgIH0sIGdldEZlZWRQYXJhbXMocGFnaW5hdGlvblBhcmFtcykpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBjYXN0UmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRVc2VycyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBfZ2V0UGF0aG5hbWUzID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoKSB7XG4gICAgcmV0dXJuIFNFQVJDSF9QQVRIX1BSRUZJWCArIFwiL3VzZXJzXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgLy8gV3JhcHBlciB1c2VzIHR5cGUgdHJpY2sgdG8gYWxsb3cgMCBhcmdzXG4gICAgZ2V0UGF0aG5hbWU6IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9wYXJhbXMpIHtcbiAgICAgIHJldHVybiBfZ2V0UGF0aG5hbWUzKCk7XG4gICAgfSxcbiAgICBoYW5kbGVSZXF1ZXN0OiBjcmVhdGVSZXF1ZXN0SGFuZGxlcihmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgIHZhciBxdWVyeSA9IF9yZWYzLnF1ZXJ5LFxuICAgICAgICAgIHBhZ2luYXRpb25QYXJhbXMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmMywgW1wicXVlcnlcIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogX2dldFBhdGhuYW1lMygpLFxuICAgICAgICBxdWVyeTogX2V4dGVuZHMoe1xuICAgICAgICAgIHF1ZXJ5OiBxdWVyeVxuICAgICAgICB9LCBnZXRGZWVkUGFyYW1zKHBhZ2luYXRpb25QYXJhbXMpKVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogY2FzdFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG5cbnZhciBpbmRleCQyID0ge1xuICBfX3Byb3RvX186IG51bGwsXG4gIGdldFBob3RvczogZ2V0UGhvdG9zJDEsXG4gIGdldENvbGxlY3Rpb25zOiBnZXRDb2xsZWN0aW9ucyQxLFxuICBnZXRVc2VyczogZ2V0VXNlcnNcbn07XG5cbnZhciBVU0VSU19QQVRIX1BSRUZJWCA9ICcvdXNlcnMnO1xudmFyIGdldCQyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZikge1xuICAgIHZhciB1c2VybmFtZSA9IF9yZWYudXNlcm5hbWU7XG4gICAgcmV0dXJuIFVTRVJTX1BBVEhfUFJFRklYICsgXCIvXCIgKyB1c2VybmFtZTtcbiAgfTtcblxuICByZXR1cm4gbWFrZUVuZHBvaW50KHtcbiAgICBnZXRQYXRobmFtZTogZ2V0UGF0aG5hbWUsXG4gICAgaGFuZGxlUmVxdWVzdDogY3JlYXRlUmVxdWVzdEhhbmRsZXIoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICB2YXIgdXNlcm5hbWUgPSBfcmVmMi51c2VybmFtZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeToge31cbiAgICAgIH07XG4gICAgfSksXG4gICAgaGFuZGxlUmVzcG9uc2U6IGNhc3RSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xudmFyIGdldFBob3RvcyQyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gZnVuY3Rpb24gZ2V0UGF0aG5hbWUoX3JlZjMpIHtcbiAgICB2YXIgdXNlcm5hbWUgPSBfcmVmMy51c2VybmFtZTtcbiAgICByZXR1cm4gVVNFUlNfUEFUSF9QUkVGSVggKyBcIi9cIiArIHVzZXJuYW1lICsgXCIvcGhvdG9zXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmNCkge1xuICAgICAgdmFyIHVzZXJuYW1lID0gX3JlZjQudXNlcm5hbWUsXG4gICAgICAgICAgc3RhdHMgPSBfcmVmNC5zdGF0cyxcbiAgICAgICAgICBvcmllbnRhdGlvbiA9IF9yZWY0Lm9yaWVudGF0aW9uLFxuICAgICAgICAgIHBhZ2luYXRpb25QYXJhbXMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNCwgW1widXNlcm5hbWVcIiwgXCJzdGF0c1wiLCBcIm9yaWVudGF0aW9uXCJdKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKHtcbiAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWVcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiBjb21wYWN0RGVmaW5lZChfZXh0ZW5kcyh7fSwgZ2V0RmVlZFBhcmFtcyhwYWdpbmF0aW9uUGFyYW1zKSwge1xuICAgICAgICAgIG9yaWVudGF0aW9uOiBvcmllbnRhdGlvbixcbiAgICAgICAgICBzdGF0czogc3RhdHNcbiAgICAgICAgfSkpXG4gICAgICB9O1xuICAgIH0pLFxuICAgIGhhbmRsZVJlc3BvbnNlOiBoYW5kbGVGZWVkUmVzcG9uc2UoKVxuICB9KTtcbn0oKTtcbnZhciBnZXRMaWtlcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBnZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9yZWY1KSB7XG4gICAgdmFyIHVzZXJuYW1lID0gX3JlZjUudXNlcm5hbWU7XG4gICAgcmV0dXJuIFVTRVJTX1BBVEhfUFJFRklYICsgXCIvXCIgKyB1c2VybmFtZSArIFwiL2xpa2VzXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmNikge1xuICAgICAgdmFyIHVzZXJuYW1lID0gX3JlZjYudXNlcm5hbWUsXG4gICAgICAgICAgb3JpZW50YXRpb24gPSBfcmVmNi5vcmllbnRhdGlvbixcbiAgICAgICAgICBwYWdpbmF0aW9uUGFyYW1zID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzTG9vc2UoX3JlZjYsIFtcInVzZXJuYW1lXCIsIFwib3JpZW50YXRpb25cIl0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRobmFtZTogZ2V0UGF0aG5hbWUoe1xuICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgICB9KSxcbiAgICAgICAgcXVlcnk6IGNvbXBhY3REZWZpbmVkKF9leHRlbmRzKHt9LCBnZXRGZWVkUGFyYW1zKHBhZ2luYXRpb25QYXJhbXMpLCB7XG4gICAgICAgICAgb3JpZW50YXRpb246IG9yaWVudGF0aW9uXG4gICAgICAgIH0pKVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogaGFuZGxlRmVlZFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG52YXIgZ2V0Q29sbGVjdGlvbnMkMiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIHZhciBnZXRQYXRobmFtZSA9IGZ1bmN0aW9uIGdldFBhdGhuYW1lKF9yZWY3KSB7XG4gICAgdmFyIHVzZXJuYW1lID0gX3JlZjcudXNlcm5hbWU7XG4gICAgcmV0dXJuIFVTRVJTX1BBVEhfUFJFRklYICsgXCIvXCIgKyB1c2VybmFtZSArIFwiL2NvbGxlY3Rpb25zXCI7XG4gIH07XG5cbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGNyZWF0ZVJlcXVlc3RIYW5kbGVyKGZ1bmN0aW9uIChfcmVmOCkge1xuICAgICAgdmFyIHVzZXJuYW1lID0gX3JlZjgudXNlcm5hbWUsXG4gICAgICAgICAgcGFnaW5hdGlvblBhcmFtcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlKF9yZWY4LCBbXCJ1c2VybmFtZVwiXSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGhuYW1lOiBnZXRQYXRobmFtZSh7XG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeTogZ2V0RmVlZFBhcmFtcyhwYWdpbmF0aW9uUGFyYW1zKVxuICAgICAgfTtcbiAgICB9KSxcbiAgICBoYW5kbGVSZXNwb25zZTogaGFuZGxlRmVlZFJlc3BvbnNlKClcbiAgfSk7XG59KCk7XG5cbnZhciBpbmRleCQzID0ge1xuICBfX3Byb3RvX186IG51bGwsXG4gIGdldDogZ2V0JDIsXG4gIGdldFBob3RvczogZ2V0UGhvdG9zJDIsXG4gIGdldExpa2VzOiBnZXRMaWtlcyxcbiAgZ2V0Q29sbGVjdGlvbnM6IGdldENvbGxlY3Rpb25zJDJcbn07XG5cbnZhciBCQVNFX1RPUElDX1BBVEggPSAnL3RvcGljcyc7XG5cbnZhciBnZXRUb3BpY1BhdGggPSBmdW5jdGlvbiBnZXRUb3BpY1BhdGgoX3JlZikge1xuICB2YXIgdG9waWNJZE9yU2x1ZyA9IF9yZWYudG9waWNJZE9yU2x1ZztcbiAgcmV0dXJuIEJBU0VfVE9QSUNfUEFUSCArIFwiL1wiICsgdG9waWNJZE9yU2x1Zztcbn07XG5cbnZhciBsaXN0JDIgPSAvKiNfX1BVUkVfXyovbWFrZUVuZHBvaW50KHtcbiAgZ2V0UGF0aG5hbWU6IGdldFRvcGljUGF0aCxcbiAgaGFuZGxlUmVxdWVzdDogZnVuY3Rpb24gaGFuZGxlUmVxdWVzdChfcmVmMikge1xuICAgIHZhciBwYWdlID0gX3JlZjIucGFnZSxcbiAgICAgICAgcGVyUGFnZSA9IF9yZWYyLnBlclBhZ2UsXG4gICAgICAgIG9yZGVyQnkgPSBfcmVmMi5vcmRlckJ5LFxuICAgICAgICB0b3BpY0lkc09yU2x1Z3MgPSBfcmVmMi50b3BpY0lkc09yU2x1Z3M7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhdGhuYW1lOiBCQVNFX1RPUElDX1BBVEgsXG4gICAgICBxdWVyeTogY29tcGFjdERlZmluZWQoX2V4dGVuZHMoe30sIGdldEZlZWRQYXJhbXMoe1xuICAgICAgICBwYWdlOiBwYWdlLFxuICAgICAgICBwZXJQYWdlOiBwZXJQYWdlXG4gICAgICB9KSwge1xuICAgICAgICBpZHM6IHRvcGljSWRzT3JTbHVncyA9PSBudWxsID8gdm9pZCAwIDogdG9waWNJZHNPclNsdWdzLmpvaW4oJywnKSxcbiAgICAgICAgb3JkZXJfYnk6IG9yZGVyQnlcbiAgICAgIH0pKVxuICAgIH07XG4gIH0sXG4gIGhhbmRsZVJlc3BvbnNlOiAvKiNfX1BVUkVfXyovaGFuZGxlRmVlZFJlc3BvbnNlKClcbn0pO1xudmFyIGdldCQzID0gLyojX19QVVJFX18qL21ha2VFbmRwb2ludCh7XG4gIGdldFBhdGhuYW1lOiBnZXRUb3BpY1BhdGgsXG4gIGhhbmRsZVJlcXVlc3Q6IGZ1bmN0aW9uIGhhbmRsZVJlcXVlc3QoX3JlZjMpIHtcbiAgICB2YXIgdG9waWNJZE9yU2x1ZyA9IF9yZWYzLnRvcGljSWRPclNsdWc7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhdGhuYW1lOiBnZXRUb3BpY1BhdGgoe1xuICAgICAgICB0b3BpY0lkT3JTbHVnOiB0b3BpY0lkT3JTbHVnXG4gICAgICB9KSxcbiAgICAgIHF1ZXJ5OiB7fVxuICAgIH07XG4gIH0sXG4gIGhhbmRsZVJlc3BvbnNlOiAvKiNfX1BVUkVfXyovY2FzdFJlc3BvbnNlKClcbn0pO1xudmFyIGdldFBob3RvcyQzID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgdmFyIGdldFBhdGhuYW1lID0gLyojX19QVVJFX18qL2Zsb3coZ2V0VG9waWNQYXRoLCBmdW5jdGlvbiAodG9waWNQYXRoKSB7XG4gICAgcmV0dXJuIHRvcGljUGF0aCArIFwiL3Bob3Rvc1wiO1xuICB9KTtcbiAgcmV0dXJuIG1ha2VFbmRwb2ludCh7XG4gICAgZ2V0UGF0aG5hbWU6IGdldFBhdGhuYW1lLFxuICAgIGhhbmRsZVJlcXVlc3Q6IGZ1bmN0aW9uIGhhbmRsZVJlcXVlc3QoX3JlZjQpIHtcbiAgICAgIHZhciB0b3BpY0lkT3JTbHVnID0gX3JlZjQudG9waWNJZE9yU2x1ZyxcbiAgICAgICAgICBvcmllbnRhdGlvbiA9IF9yZWY0Lm9yaWVudGF0aW9uLFxuICAgICAgICAgIGZlZWRQYXJhbXMgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZShfcmVmNCwgW1widG9waWNJZE9yU2x1Z1wiLCBcIm9yaWVudGF0aW9uXCJdKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcGF0aG5hbWU6IGdldFBhdGhuYW1lKHtcbiAgICAgICAgICB0b3BpY0lkT3JTbHVnOiB0b3BpY0lkT3JTbHVnXG4gICAgICAgIH0pLFxuICAgICAgICBxdWVyeTogY29tcGFjdERlZmluZWQoX2V4dGVuZHMoe30sIGdldEZlZWRQYXJhbXMoZmVlZFBhcmFtcyksIHtcbiAgICAgICAgICBvcmllbnRhdGlvbjogb3JpZW50YXRpb25cbiAgICAgICAgfSkpXG4gICAgICB9O1xuICAgIH0sXG4gICAgaGFuZGxlUmVzcG9uc2U6IGhhbmRsZUZlZWRSZXNwb25zZSgpXG4gIH0pO1xufSgpO1xuXG52YXIgaW5kZXgkNCA9IHtcbiAgX19wcm90b19fOiBudWxsLFxuICBsaXN0OiBsaXN0JDIsXG4gIGdldDogZ2V0JDMsXG4gIGdldFBob3RvczogZ2V0UGhvdG9zJDNcbn07XG5cbnZhciB0cmFja05vbkhvdExpbmtlZFBob3RvVmlldyA9IGZ1bmN0aW9uIHRyYWNrTm9uSG90TGlua2VkUGhvdG9WaWV3KF9yZWYpIHtcbiAgdmFyIGFwcElkID0gX3JlZi5hcHBJZDtcbiAgcmV0dXJuIGZ1bmN0aW9uIChfcmVmMikge1xuICAgIHZhciBwaG90b0lkID0gX3JlZjIucGhvdG9JZDtcbiAgICB2YXIgaWRzID0gIUFycmF5LmlzQXJyYXkocGhvdG9JZCkgPyBbcGhvdG9JZF0gOiBwaG90b0lkO1xuXG4gICAgaWYgKGlkcy5sZW5ndGggPiAyMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgY2Fubm90IHRyYWNrIG1vcmUgdGhhbiAyMCBwaG90b3MgYXQgb25jZS4gUGxlYXNlIHRyeSBhZ2FpbiB3aXRoIGZld2VyIHBob3Rvcy4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmV0Y2goXCJ2aWV3cy51bnNwbGFzaC5jb20vdj9waG90b19pZD1cIiArIGlkcy5qb2luKCkgKyBcIiZhcHBfaWQ9XCIgKyBhcHBJZCk7XG4gIH07XG59O1xuXG5cblxudmFyIGludGVybmFscyA9IHtcbiAgX19wcm90b19fOiBudWxsLFxuICBjb2xsZWN0aW9uczogaW5kZXgsXG4gIHBob3RvczogaW5kZXgkMSxcbiAgc2VhcmNoOiBpbmRleCQyLFxuICB1c2VyczogaW5kZXgkMyxcbiAgdG9waWNzOiBpbmRleCQ0LFxuICB0cmFja05vbkhvdExpbmtlZFBob3RvVmlldzogdHJhY2tOb25Ib3RMaW5rZWRQaG90b1ZpZXdcbn07XG5cbnZhciBMYW5ndWFnZTtcblxuKGZ1bmN0aW9uIChMYW5ndWFnZSkge1xuICBMYW5ndWFnZVtcIkFmcmlrYWFuc1wiXSA9IFwiYWZcIjtcbiAgTGFuZ3VhZ2VbXCJBbWhhcmljXCJdID0gXCJhbVwiO1xuICBMYW5ndWFnZVtcIkFyYWJpY1wiXSA9IFwiYXJcIjtcbiAgTGFuZ3VhZ2VbXCJBemVyYmFpamFuaVwiXSA9IFwiYXpcIjtcbiAgTGFuZ3VhZ2VbXCJCZWxhcnVzaWFuXCJdID0gXCJiZVwiO1xuICBMYW5ndWFnZVtcIkJ1bGdhcmlhblwiXSA9IFwiYmdcIjtcbiAgTGFuZ3VhZ2VbXCJCZW5nYWxpXCJdID0gXCJiblwiO1xuICBMYW5ndWFnZVtcIkJvc25pYW5cIl0gPSBcImJzXCI7XG4gIExhbmd1YWdlW1wiQ2F0YWxhblwiXSA9IFwiY2FcIjtcbiAgTGFuZ3VhZ2VbXCJDZWJ1YW5vXCJdID0gXCJjZWJcIjtcbiAgTGFuZ3VhZ2VbXCJDb3JzaWNhblwiXSA9IFwiY29cIjtcbiAgTGFuZ3VhZ2VbXCJDemVjaFwiXSA9IFwiY3NcIjtcbiAgTGFuZ3VhZ2VbXCJXZWxzaFwiXSA9IFwiY3lcIjtcbiAgTGFuZ3VhZ2VbXCJEYW5pc2hcIl0gPSBcImRhXCI7XG4gIExhbmd1YWdlW1wiR2VybWFuXCJdID0gXCJkZVwiO1xuICBMYW5ndWFnZVtcIkdyZWVrXCJdID0gXCJlbFwiO1xuICBMYW5ndWFnZVtcIkVuZ2xpc2hcIl0gPSBcImVuXCI7XG4gIExhbmd1YWdlW1wiRXNwZXJhbnRvXCJdID0gXCJlb1wiO1xuICBMYW5ndWFnZVtcIlNwYW5pc2hcIl0gPSBcImVzXCI7XG4gIExhbmd1YWdlW1wiRXN0b25pYW5cIl0gPSBcImV0XCI7XG4gIExhbmd1YWdlW1wiQmFzcXVlXCJdID0gXCJldVwiO1xuICBMYW5ndWFnZVtcIlBlcnNpYW5cIl0gPSBcImZhXCI7XG4gIExhbmd1YWdlW1wiRmlubmlzaFwiXSA9IFwiZmlcIjtcbiAgTGFuZ3VhZ2VbXCJGcmVuY2hcIl0gPSBcImZyXCI7XG4gIExhbmd1YWdlW1wiRnJpc2lhblwiXSA9IFwiZnlcIjtcbiAgTGFuZ3VhZ2VbXCJJcmlzaFwiXSA9IFwiZ2FcIjtcbiAgTGFuZ3VhZ2VbXCJTY290c0dhZWxpY1wiXSA9IFwiZ2RcIjtcbiAgTGFuZ3VhZ2VbXCJHYWxpY2lhblwiXSA9IFwiZ2xcIjtcbiAgTGFuZ3VhZ2VbXCJHdWphcmF0aVwiXSA9IFwiZ3VcIjtcbiAgTGFuZ3VhZ2VbXCJIYXVzYVwiXSA9IFwiaGFcIjtcbiAgTGFuZ3VhZ2VbXCJIYXdhaWlhblwiXSA9IFwiaGF3XCI7XG4gIExhbmd1YWdlW1wiSGluZGlcIl0gPSBcImhpXCI7XG4gIExhbmd1YWdlW1wiSG1vbmdcIl0gPSBcImhtblwiO1xuICBMYW5ndWFnZVtcIkNyb2F0aWFuXCJdID0gXCJoclwiO1xuICBMYW5ndWFnZVtcIkhhaXRpYW5DcmVvbGVcIl0gPSBcImh0XCI7XG4gIExhbmd1YWdlW1wiSHVuZ2FyaWFuXCJdID0gXCJodVwiO1xuICBMYW5ndWFnZVtcIkFybWVuaWFuXCJdID0gXCJoeVwiO1xuICBMYW5ndWFnZVtcIkluZG9uZXNpYW5cIl0gPSBcImlkXCI7XG4gIExhbmd1YWdlW1wiSWdib1wiXSA9IFwiaWdcIjtcbiAgTGFuZ3VhZ2VbXCJJY2VsYW5kaWNcIl0gPSBcImlzXCI7XG4gIExhbmd1YWdlW1wiSXRhbGlhblwiXSA9IFwiaXRcIjtcbiAgTGFuZ3VhZ2VbXCJIZWJyZXdcIl0gPSBcIml3XCI7XG4gIExhbmd1YWdlW1wiSmFwYW5lc2VcIl0gPSBcImphXCI7XG4gIExhbmd1YWdlW1wiSmF2YW5lc2VcIl0gPSBcImp3XCI7XG4gIExhbmd1YWdlW1wiR2VvcmdpYW5cIl0gPSBcImthXCI7XG4gIExhbmd1YWdlW1wiS2F6YWtoXCJdID0gXCJra1wiO1xuICBMYW5ndWFnZVtcIktobWVyXCJdID0gXCJrbVwiO1xuICBMYW5ndWFnZVtcIkthbm5hZGFcIl0gPSBcImtuXCI7XG4gIExhbmd1YWdlW1wiS29yZWFuXCJdID0gXCJrb1wiO1xuICBMYW5ndWFnZVtcIkt1cmRpc2hcIl0gPSBcImt1XCI7XG4gIExhbmd1YWdlW1wiS3lyZ3l6XCJdID0gXCJreVwiO1xuICBMYW5ndWFnZVtcIkxhdGluXCJdID0gXCJsYVwiO1xuICBMYW5ndWFnZVtcIkx1eGVtYm91cmdpc2hcIl0gPSBcImxiXCI7XG4gIExhbmd1YWdlW1wiTGFvXCJdID0gXCJsb1wiO1xuICBMYW5ndWFnZVtcIkxpdGh1YW5pYW5cIl0gPSBcImx0XCI7XG4gIExhbmd1YWdlW1wiTGF0dmlhblwiXSA9IFwibHZcIjtcbiAgTGFuZ3VhZ2VbXCJNYWxhZ2FzeVwiXSA9IFwibWdcIjtcbiAgTGFuZ3VhZ2VbXCJNYW9yaVwiXSA9IFwibWlcIjtcbiAgTGFuZ3VhZ2VbXCJNYWNlZG9uaWFuXCJdID0gXCJta1wiO1xuICBMYW5ndWFnZVtcIk1hbGF5YWxhbVwiXSA9IFwibWxcIjtcbiAgTGFuZ3VhZ2VbXCJNb25nb2xpYW5cIl0gPSBcIm1uXCI7XG4gIExhbmd1YWdlW1wiTWFyYXRoaVwiXSA9IFwibXJcIjtcbiAgTGFuZ3VhZ2VbXCJNYWxheVwiXSA9IFwibXNcIjtcbiAgTGFuZ3VhZ2VbXCJNYWx0ZXNlXCJdID0gXCJtdFwiO1xuICBMYW5ndWFnZVtcIk15YW5tYXJcIl0gPSBcIm15XCI7XG4gIExhbmd1YWdlW1wiTmVwYWxpXCJdID0gXCJuZVwiO1xuICBMYW5ndWFnZVtcIkR1dGNoXCJdID0gXCJubFwiO1xuICBMYW5ndWFnZVtcIk5vcndlZ2lhblwiXSA9IFwibm9cIjtcbiAgTGFuZ3VhZ2VbXCJOeWFuamFcIl0gPSBcIm55XCI7XG4gIExhbmd1YWdlW1wiT3JpeWFcIl0gPSBcIm9yXCI7XG4gIExhbmd1YWdlW1wiUHVuamFiaVwiXSA9IFwicGFcIjtcbiAgTGFuZ3VhZ2VbXCJQb2xpc2hcIl0gPSBcInBsXCI7XG4gIExhbmd1YWdlW1wiUGFzaHRvXCJdID0gXCJwc1wiO1xuICBMYW5ndWFnZVtcIlBvcnR1Z3Vlc2VcIl0gPSBcInB0XCI7XG4gIExhbmd1YWdlW1wiUm9tYW5pYW5cIl0gPSBcInJvXCI7XG4gIExhbmd1YWdlW1wiUnVzc2lhblwiXSA9IFwicnVcIjtcbiAgTGFuZ3VhZ2VbXCJLaW55YXJ3YW5kYVwiXSA9IFwicndcIjtcbiAgTGFuZ3VhZ2VbXCJTaW5kaGlcIl0gPSBcInNkXCI7XG4gIExhbmd1YWdlW1wiU2luaGFsYVwiXSA9IFwic2lcIjtcbiAgTGFuZ3VhZ2VbXCJTbG92YWtcIl0gPSBcInNrXCI7XG4gIExhbmd1YWdlW1wiU2xvdmVuaWFuXCJdID0gXCJzbFwiO1xuICBMYW5ndWFnZVtcIlNhbW9hblwiXSA9IFwic21cIjtcbiAgTGFuZ3VhZ2VbXCJTaG9uYVwiXSA9IFwic25cIjtcbiAgTGFuZ3VhZ2VbXCJTb21hbGlcIl0gPSBcInNvXCI7XG4gIExhbmd1YWdlW1wiQWxiYW5pYW5cIl0gPSBcInNxXCI7XG4gIExhbmd1YWdlW1wiU2VyYmlhblwiXSA9IFwic3JcIjtcbiAgTGFuZ3VhZ2VbXCJTZXNvdGhvXCJdID0gXCJzdFwiO1xuICBMYW5ndWFnZVtcIlN1bmRhbmVzZVwiXSA9IFwic3VcIjtcbiAgTGFuZ3VhZ2VbXCJTd2VkaXNoXCJdID0gXCJzdlwiO1xuICBMYW5ndWFnZVtcIlN3YWhpbGlcIl0gPSBcInN3XCI7XG4gIExhbmd1YWdlW1wiVGFtaWxcIl0gPSBcInRhXCI7XG4gIExhbmd1YWdlW1wiVGVsdWd1XCJdID0gXCJ0ZVwiO1xuICBMYW5ndWFnZVtcIlRhamlrXCJdID0gXCJ0Z1wiO1xuICBMYW5ndWFnZVtcIlRoYWlcIl0gPSBcInRoXCI7XG4gIExhbmd1YWdlW1wiVHVya21lblwiXSA9IFwidGtcIjtcbiAgTGFuZ3VhZ2VbXCJGaWxpcGlub1wiXSA9IFwidGxcIjtcbiAgTGFuZ3VhZ2VbXCJUdXJraXNoXCJdID0gXCJ0clwiO1xuICBMYW5ndWFnZVtcIlRhdGFyXCJdID0gXCJ0dFwiO1xuICBMYW5ndWFnZVtcIlVpZ2h1clwiXSA9IFwidWdcIjtcbiAgTGFuZ3VhZ2VbXCJVa3JhaW5pYW5cIl0gPSBcInVrXCI7XG4gIExhbmd1YWdlW1wiVXJkdVwiXSA9IFwidXJcIjtcbiAgTGFuZ3VhZ2VbXCJVemJla1wiXSA9IFwidXpcIjtcbiAgTGFuZ3VhZ2VbXCJWaWV0bmFtZXNlXCJdID0gXCJ2aVwiO1xuICBMYW5ndWFnZVtcIlhob3NhXCJdID0gXCJ4aFwiO1xuICBMYW5ndWFnZVtcIllpZGRpc2hcIl0gPSBcInlpXCI7XG4gIExhbmd1YWdlW1wiWW9ydWJhXCJdID0gXCJ5b1wiO1xuICBMYW5ndWFnZVtcIkNoaW5lc2VTaW1wbGlmaWVkXCJdID0gXCJ6aFwiO1xuICBMYW5ndWFnZVtcIkNoaW5lc2VUcmFkaXRpb25hbFwiXSA9IFwiemgtVFdcIjtcbiAgTGFuZ3VhZ2VbXCJadWx1XCJdID0gXCJ6dVwiO1xufSkoTGFuZ3VhZ2UgfHwgKExhbmd1YWdlID0ge30pKTtcblxudmFyIE9yZGVyQnk7XG5cbihmdW5jdGlvbiAoT3JkZXJCeSkge1xuICBPcmRlckJ5W1wiTEFURVNUXCJdID0gXCJsYXRlc3RcIjtcbiAgT3JkZXJCeVtcIlBPUFVMQVJcIl0gPSBcInBvcHVsYXJcIjtcbiAgT3JkZXJCeVtcIlZJRVdTXCJdID0gXCJ2aWV3c1wiO1xuICBPcmRlckJ5W1wiRE9XTkxPQURTXCJdID0gXCJkb3dubG9hZHNcIjtcbiAgT3JkZXJCeVtcIk9MREVTVFwiXSA9IFwib2xkZXN0XCI7XG59KShPcmRlckJ5IHx8IChPcmRlckJ5ID0ge30pKTtcblxudmFyIGNyZWF0ZUFwaSA9IC8qI19fUFVSRV9fKi9mbG93KGluaXRNYWtlUmVxdWVzdCwgZnVuY3Rpb24gKG1ha2VSZXF1ZXN0KSB7XG4gIHJldHVybiB7XG4gICAgcGhvdG9zOiB7XG4gICAgICBnZXQ6IG1ha2VSZXF1ZXN0KGdldCQxKSxcbiAgICAgIGxpc3Q6IG1ha2VSZXF1ZXN0KGxpc3QkMSksXG4gICAgICBnZXRTdGF0czogbWFrZVJlcXVlc3QoZ2V0U3RhdHMpLFxuICAgICAgZ2V0UmFuZG9tOiBtYWtlUmVxdWVzdChnZXRSYW5kb20pLFxuICAgICAgdHJhY2tEb3dubG9hZDogbWFrZVJlcXVlc3QodHJhY2tEb3dubG9hZClcbiAgICB9LFxuICAgIHVzZXJzOiB7XG4gICAgICBnZXRQaG90b3M6IG1ha2VSZXF1ZXN0KGdldFBob3RvcyQyKSxcbiAgICAgIGdldENvbGxlY3Rpb25zOiBtYWtlUmVxdWVzdChnZXRDb2xsZWN0aW9ucyQyKSxcbiAgICAgIGdldExpa2VzOiBtYWtlUmVxdWVzdChnZXRMaWtlcyksXG4gICAgICBnZXQ6IG1ha2VSZXF1ZXN0KGdldCQyKVxuICAgIH0sXG4gICAgc2VhcmNoOiB7XG4gICAgICBnZXRDb2xsZWN0aW9uczogbWFrZVJlcXVlc3QoZ2V0Q29sbGVjdGlvbnMkMSksXG4gICAgICBnZXRQaG90b3M6IG1ha2VSZXF1ZXN0KGdldFBob3RvcyQxKSxcbiAgICAgIGdldFVzZXJzOiBtYWtlUmVxdWVzdChnZXRVc2VycylcbiAgICB9LFxuICAgIGNvbGxlY3Rpb25zOiB7XG4gICAgICBnZXRQaG90b3M6IG1ha2VSZXF1ZXN0KGdldFBob3RvcyksXG4gICAgICBnZXQ6IG1ha2VSZXF1ZXN0KGdldCksXG4gICAgICBsaXN0OiBtYWtlUmVxdWVzdChsaXN0KSxcbiAgICAgIGdldFJlbGF0ZWQ6IG1ha2VSZXF1ZXN0KGdldFJlbGF0ZWQpXG4gICAgfSxcbiAgICB0b3BpY3M6IHtcbiAgICAgIGxpc3Q6IG1ha2VSZXF1ZXN0KGxpc3QkMiksXG4gICAgICBnZXQ6IG1ha2VSZXF1ZXN0KGdldCQzKSxcbiAgICAgIGdldFBob3RvczogbWFrZVJlcXVlc3QoZ2V0UGhvdG9zJDMpXG4gICAgfVxuICB9O1xufSk7XG5cbmV4cG9ydCB7IExhbmd1YWdlLCBPcmRlckJ5LCBpbnRlcm5hbHMgYXMgX2ludGVybmFscywgY3JlYXRlQXBpIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD11bnNwbGFzaC1qcy5lc20uanMubWFwXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIk5JTFwiLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgIHJldHVybiBfbmlsLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwicGFyc2VcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3BhcnNlLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwic3RyaW5naWZ5XCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9zdHJpbmdpZnkuZGVmYXVsdDtcbiAgfVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJ2MVwiLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgIHJldHVybiBfdi5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInYzXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF92Mi5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInY0XCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF92My5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInY1XCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF92NC5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInZhbGlkYXRlXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF92YWxpZGF0ZS5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInZlcnNpb25cIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3ZlcnNpb24uZGVmYXVsdDtcbiAgfVxufSk7XG5cbnZhciBfdiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdjEuanNcIikpO1xuXG52YXIgX3YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92My5qc1wiKSk7XG5cbnZhciBfdjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3Y0LmpzXCIpKTtcblxudmFyIF92NCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdjUuanNcIikpO1xuXG52YXIgX25pbCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vbmlsLmpzXCIpKTtcblxudmFyIF92ZXJzaW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92ZXJzaW9uLmpzXCIpKTtcblxudmFyIF92YWxpZGF0ZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdmFsaWRhdGUuanNcIikpO1xuXG52YXIgX3N0cmluZ2lmeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vc3RyaW5naWZ5LmpzXCIpKTtcblxudmFyIF9wYXJzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcGFyc2UuanNcIikpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfSIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG4vKlxuICogQnJvd3Nlci1jb21wYXRpYmxlIEphdmFTY3JpcHQgTUQ1XG4gKlxuICogTW9kaWZpY2F0aW9uIG9mIEphdmFTY3JpcHQgTUQ1XG4gKiBodHRwczovL2dpdGh1Yi5jb20vYmx1ZWltcC9KYXZhU2NyaXB0LU1ENVxuICpcbiAqIENvcHlyaWdodCAyMDExLCBTZWJhc3RpYW4gVHNjaGFuXG4gKiBodHRwczovL2JsdWVpbXAubmV0XG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlOlxuICogaHR0cHM6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcbiAqXG4gKiBCYXNlZCBvblxuICogQSBKYXZhU2NyaXB0IGltcGxlbWVudGF0aW9uIG9mIHRoZSBSU0EgRGF0YSBTZWN1cml0eSwgSW5jLiBNRDUgTWVzc2FnZVxuICogRGlnZXN0IEFsZ29yaXRobSwgYXMgZGVmaW5lZCBpbiBSRkMgMTMyMS5cbiAqIFZlcnNpb24gMi4yIENvcHlyaWdodCAoQykgUGF1bCBKb2huc3RvbiAxOTk5IC0gMjAwOVxuICogT3RoZXIgY29udHJpYnV0b3JzOiBHcmVnIEhvbHQsIEFuZHJldyBLZXBlcnQsIFlkbmFyLCBMb3N0aW5ldFxuICogRGlzdHJpYnV0ZWQgdW5kZXIgdGhlIEJTRCBMaWNlbnNlXG4gKiBTZWUgaHR0cDovL3BhamhvbWUub3JnLnVrL2NyeXB0L21kNSBmb3IgbW9yZSBpbmZvLlxuICovXG5mdW5jdGlvbiBtZDUoYnl0ZXMpIHtcbiAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCBtc2cgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoYnl0ZXMpKTsgLy8gVVRGOCBlc2NhcGVcblxuICAgIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkobXNnLmxlbmd0aCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1zZy5sZW5ndGg7ICsraSkge1xuICAgICAgYnl0ZXNbaV0gPSBtc2cuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWQ1VG9IZXhFbmNvZGVkQXJyYXkod29yZHNUb01kNShieXRlc1RvV29yZHMoYnl0ZXMpLCBieXRlcy5sZW5ndGggKiA4KSk7XG59XG4vKlxuICogQ29udmVydCBhbiBhcnJheSBvZiBsaXR0bGUtZW5kaWFuIHdvcmRzIHRvIGFuIGFycmF5IG9mIGJ5dGVzXG4gKi9cblxuXG5mdW5jdGlvbiBtZDVUb0hleEVuY29kZWRBcnJheShpbnB1dCkge1xuICBjb25zdCBvdXRwdXQgPSBbXTtcbiAgY29uc3QgbGVuZ3RoMzIgPSBpbnB1dC5sZW5ndGggKiAzMjtcbiAgY29uc3QgaGV4VGFiID0gJzAxMjM0NTY3ODlhYmNkZWYnO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoMzI7IGkgKz0gOCkge1xuICAgIGNvbnN0IHggPSBpbnB1dFtpID4+IDVdID4+PiBpICUgMzIgJiAweGZmO1xuICAgIGNvbnN0IGhleCA9IHBhcnNlSW50KGhleFRhYi5jaGFyQXQoeCA+Pj4gNCAmIDB4MGYpICsgaGV4VGFiLmNoYXJBdCh4ICYgMHgwZiksIDE2KTtcbiAgICBvdXRwdXQucHVzaChoZXgpO1xuICB9XG5cbiAgcmV0dXJuIG91dHB1dDtcbn1cbi8qKlxuICogQ2FsY3VsYXRlIG91dHB1dCBsZW5ndGggd2l0aCBwYWRkaW5nIGFuZCBiaXQgbGVuZ3RoXG4gKi9cblxuXG5mdW5jdGlvbiBnZXRPdXRwdXRMZW5ndGgoaW5wdXRMZW5ndGg4KSB7XG4gIHJldHVybiAoaW5wdXRMZW5ndGg4ICsgNjQgPj4+IDkgPDwgNCkgKyAxNCArIDE7XG59XG4vKlxuICogQ2FsY3VsYXRlIHRoZSBNRDUgb2YgYW4gYXJyYXkgb2YgbGl0dGxlLWVuZGlhbiB3b3JkcywgYW5kIGEgYml0IGxlbmd0aC5cbiAqL1xuXG5cbmZ1bmN0aW9uIHdvcmRzVG9NZDUoeCwgbGVuKSB7XG4gIC8qIGFwcGVuZCBwYWRkaW5nICovXG4gIHhbbGVuID4+IDVdIHw9IDB4ODAgPDwgbGVuICUgMzI7XG4gIHhbZ2V0T3V0cHV0TGVuZ3RoKGxlbikgLSAxXSA9IGxlbjtcbiAgbGV0IGEgPSAxNzMyNTg0MTkzO1xuICBsZXQgYiA9IC0yNzE3MzM4Nzk7XG4gIGxldCBjID0gLTE3MzI1ODQxOTQ7XG4gIGxldCBkID0gMjcxNzMzODc4O1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgeC5sZW5ndGg7IGkgKz0gMTYpIHtcbiAgICBjb25zdCBvbGRhID0gYTtcbiAgICBjb25zdCBvbGRiID0gYjtcbiAgICBjb25zdCBvbGRjID0gYztcbiAgICBjb25zdCBvbGRkID0gZDtcbiAgICBhID0gbWQ1ZmYoYSwgYiwgYywgZCwgeFtpXSwgNywgLTY4MDg3NjkzNik7XG4gICAgZCA9IG1kNWZmKGQsIGEsIGIsIGMsIHhbaSArIDFdLCAxMiwgLTM4OTU2NDU4Nik7XG4gICAgYyA9IG1kNWZmKGMsIGQsIGEsIGIsIHhbaSArIDJdLCAxNywgNjA2MTA1ODE5KTtcbiAgICBiID0gbWQ1ZmYoYiwgYywgZCwgYSwgeFtpICsgM10sIDIyLCAtMTA0NDUyNTMzMCk7XG4gICAgYSA9IG1kNWZmKGEsIGIsIGMsIGQsIHhbaSArIDRdLCA3LCAtMTc2NDE4ODk3KTtcbiAgICBkID0gbWQ1ZmYoZCwgYSwgYiwgYywgeFtpICsgNV0sIDEyLCAxMjAwMDgwNDI2KTtcbiAgICBjID0gbWQ1ZmYoYywgZCwgYSwgYiwgeFtpICsgNl0sIDE3LCAtMTQ3MzIzMTM0MSk7XG4gICAgYiA9IG1kNWZmKGIsIGMsIGQsIGEsIHhbaSArIDddLCAyMiwgLTQ1NzA1OTgzKTtcbiAgICBhID0gbWQ1ZmYoYSwgYiwgYywgZCwgeFtpICsgOF0sIDcsIDE3NzAwMzU0MTYpO1xuICAgIGQgPSBtZDVmZihkLCBhLCBiLCBjLCB4W2kgKyA5XSwgMTIsIC0xOTU4NDE0NDE3KTtcbiAgICBjID0gbWQ1ZmYoYywgZCwgYSwgYiwgeFtpICsgMTBdLCAxNywgLTQyMDYzKTtcbiAgICBiID0gbWQ1ZmYoYiwgYywgZCwgYSwgeFtpICsgMTFdLCAyMiwgLTE5OTA0MDQxNjIpO1xuICAgIGEgPSBtZDVmZihhLCBiLCBjLCBkLCB4W2kgKyAxMl0sIDcsIDE4MDQ2MDM2ODIpO1xuICAgIGQgPSBtZDVmZihkLCBhLCBiLCBjLCB4W2kgKyAxM10sIDEyLCAtNDAzNDExMDEpO1xuICAgIGMgPSBtZDVmZihjLCBkLCBhLCBiLCB4W2kgKyAxNF0sIDE3LCAtMTUwMjAwMjI5MCk7XG4gICAgYiA9IG1kNWZmKGIsIGMsIGQsIGEsIHhbaSArIDE1XSwgMjIsIDEyMzY1MzUzMjkpO1xuICAgIGEgPSBtZDVnZyhhLCBiLCBjLCBkLCB4W2kgKyAxXSwgNSwgLTE2NTc5NjUxMCk7XG4gICAgZCA9IG1kNWdnKGQsIGEsIGIsIGMsIHhbaSArIDZdLCA5LCAtMTA2OTUwMTYzMik7XG4gICAgYyA9IG1kNWdnKGMsIGQsIGEsIGIsIHhbaSArIDExXSwgMTQsIDY0MzcxNzcxMyk7XG4gICAgYiA9IG1kNWdnKGIsIGMsIGQsIGEsIHhbaV0sIDIwLCAtMzczODk3MzAyKTtcbiAgICBhID0gbWQ1Z2coYSwgYiwgYywgZCwgeFtpICsgNV0sIDUsIC03MDE1NTg2OTEpO1xuICAgIGQgPSBtZDVnZyhkLCBhLCBiLCBjLCB4W2kgKyAxMF0sIDksIDM4MDE2MDgzKTtcbiAgICBjID0gbWQ1Z2coYywgZCwgYSwgYiwgeFtpICsgMTVdLCAxNCwgLTY2MDQ3ODMzNSk7XG4gICAgYiA9IG1kNWdnKGIsIGMsIGQsIGEsIHhbaSArIDRdLCAyMCwgLTQwNTUzNzg0OCk7XG4gICAgYSA9IG1kNWdnKGEsIGIsIGMsIGQsIHhbaSArIDldLCA1LCA1Njg0NDY0MzgpO1xuICAgIGQgPSBtZDVnZyhkLCBhLCBiLCBjLCB4W2kgKyAxNF0sIDksIC0xMDE5ODAzNjkwKTtcbiAgICBjID0gbWQ1Z2coYywgZCwgYSwgYiwgeFtpICsgM10sIDE0LCAtMTg3MzYzOTYxKTtcbiAgICBiID0gbWQ1Z2coYiwgYywgZCwgYSwgeFtpICsgOF0sIDIwLCAxMTYzNTMxNTAxKTtcbiAgICBhID0gbWQ1Z2coYSwgYiwgYywgZCwgeFtpICsgMTNdLCA1LCAtMTQ0NDY4MTQ2Nyk7XG4gICAgZCA9IG1kNWdnKGQsIGEsIGIsIGMsIHhbaSArIDJdLCA5LCAtNTE0MDM3ODQpO1xuICAgIGMgPSBtZDVnZyhjLCBkLCBhLCBiLCB4W2kgKyA3XSwgMTQsIDE3MzUzMjg0NzMpO1xuICAgIGIgPSBtZDVnZyhiLCBjLCBkLCBhLCB4W2kgKyAxMl0sIDIwLCAtMTkyNjYwNzczNCk7XG4gICAgYSA9IG1kNWhoKGEsIGIsIGMsIGQsIHhbaSArIDVdLCA0LCAtMzc4NTU4KTtcbiAgICBkID0gbWQ1aGgoZCwgYSwgYiwgYywgeFtpICsgOF0sIDExLCAtMjAyMjU3NDQ2Myk7XG4gICAgYyA9IG1kNWhoKGMsIGQsIGEsIGIsIHhbaSArIDExXSwgMTYsIDE4MzkwMzA1NjIpO1xuICAgIGIgPSBtZDVoaChiLCBjLCBkLCBhLCB4W2kgKyAxNF0sIDIzLCAtMzUzMDk1NTYpO1xuICAgIGEgPSBtZDVoaChhLCBiLCBjLCBkLCB4W2kgKyAxXSwgNCwgLTE1MzA5OTIwNjApO1xuICAgIGQgPSBtZDVoaChkLCBhLCBiLCBjLCB4W2kgKyA0XSwgMTEsIDEyNzI4OTMzNTMpO1xuICAgIGMgPSBtZDVoaChjLCBkLCBhLCBiLCB4W2kgKyA3XSwgMTYsIC0xNTU0OTc2MzIpO1xuICAgIGIgPSBtZDVoaChiLCBjLCBkLCBhLCB4W2kgKyAxMF0sIDIzLCAtMTA5NDczMDY0MCk7XG4gICAgYSA9IG1kNWhoKGEsIGIsIGMsIGQsIHhbaSArIDEzXSwgNCwgNjgxMjc5MTc0KTtcbiAgICBkID0gbWQ1aGgoZCwgYSwgYiwgYywgeFtpXSwgMTEsIC0zNTg1MzcyMjIpO1xuICAgIGMgPSBtZDVoaChjLCBkLCBhLCBiLCB4W2kgKyAzXSwgMTYsIC03MjI1MjE5NzkpO1xuICAgIGIgPSBtZDVoaChiLCBjLCBkLCBhLCB4W2kgKyA2XSwgMjMsIDc2MDI5MTg5KTtcbiAgICBhID0gbWQ1aGgoYSwgYiwgYywgZCwgeFtpICsgOV0sIDQsIC02NDAzNjQ0ODcpO1xuICAgIGQgPSBtZDVoaChkLCBhLCBiLCBjLCB4W2kgKyAxMl0sIDExLCAtNDIxODE1ODM1KTtcbiAgICBjID0gbWQ1aGgoYywgZCwgYSwgYiwgeFtpICsgMTVdLCAxNiwgNTMwNzQyNTIwKTtcbiAgICBiID0gbWQ1aGgoYiwgYywgZCwgYSwgeFtpICsgMl0sIDIzLCAtOTk1MzM4NjUxKTtcbiAgICBhID0gbWQ1aWkoYSwgYiwgYywgZCwgeFtpXSwgNiwgLTE5ODYzMDg0NCk7XG4gICAgZCA9IG1kNWlpKGQsIGEsIGIsIGMsIHhbaSArIDddLCAxMCwgMTEyNjg5MTQxNSk7XG4gICAgYyA9IG1kNWlpKGMsIGQsIGEsIGIsIHhbaSArIDE0XSwgMTUsIC0xNDE2MzU0OTA1KTtcbiAgICBiID0gbWQ1aWkoYiwgYywgZCwgYSwgeFtpICsgNV0sIDIxLCAtNTc0MzQwNTUpO1xuICAgIGEgPSBtZDVpaShhLCBiLCBjLCBkLCB4W2kgKyAxMl0sIDYsIDE3MDA0ODU1NzEpO1xuICAgIGQgPSBtZDVpaShkLCBhLCBiLCBjLCB4W2kgKyAzXSwgMTAsIC0xODk0OTg2NjA2KTtcbiAgICBjID0gbWQ1aWkoYywgZCwgYSwgYiwgeFtpICsgMTBdLCAxNSwgLTEwNTE1MjMpO1xuICAgIGIgPSBtZDVpaShiLCBjLCBkLCBhLCB4W2kgKyAxXSwgMjEsIC0yMDU0OTIyNzk5KTtcbiAgICBhID0gbWQ1aWkoYSwgYiwgYywgZCwgeFtpICsgOF0sIDYsIDE4NzMzMTMzNTkpO1xuICAgIGQgPSBtZDVpaShkLCBhLCBiLCBjLCB4W2kgKyAxNV0sIDEwLCAtMzA2MTE3NDQpO1xuICAgIGMgPSBtZDVpaShjLCBkLCBhLCBiLCB4W2kgKyA2XSwgMTUsIC0xNTYwMTk4MzgwKTtcbiAgICBiID0gbWQ1aWkoYiwgYywgZCwgYSwgeFtpICsgMTNdLCAyMSwgMTMwOTE1MTY0OSk7XG4gICAgYSA9IG1kNWlpKGEsIGIsIGMsIGQsIHhbaSArIDRdLCA2LCAtMTQ1NTIzMDcwKTtcbiAgICBkID0gbWQ1aWkoZCwgYSwgYiwgYywgeFtpICsgMTFdLCAxMCwgLTExMjAyMTAzNzkpO1xuICAgIGMgPSBtZDVpaShjLCBkLCBhLCBiLCB4W2kgKyAyXSwgMTUsIDcxODc4NzI1OSk7XG4gICAgYiA9IG1kNWlpKGIsIGMsIGQsIGEsIHhbaSArIDldLCAyMSwgLTM0MzQ4NTU1MSk7XG4gICAgYSA9IHNhZmVBZGQoYSwgb2xkYSk7XG4gICAgYiA9IHNhZmVBZGQoYiwgb2xkYik7XG4gICAgYyA9IHNhZmVBZGQoYywgb2xkYyk7XG4gICAgZCA9IHNhZmVBZGQoZCwgb2xkZCk7XG4gIH1cblxuICByZXR1cm4gW2EsIGIsIGMsIGRdO1xufVxuLypcbiAqIENvbnZlcnQgYW4gYXJyYXkgYnl0ZXMgdG8gYW4gYXJyYXkgb2YgbGl0dGxlLWVuZGlhbiB3b3Jkc1xuICogQ2hhcmFjdGVycyA+MjU1IGhhdmUgdGhlaXIgaGlnaC1ieXRlIHNpbGVudGx5IGlnbm9yZWQuXG4gKi9cblxuXG5mdW5jdGlvbiBieXRlc1RvV29yZHMoaW5wdXQpIHtcbiAgaWYgKGlucHV0Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIGNvbnN0IGxlbmd0aDggPSBpbnB1dC5sZW5ndGggKiA4O1xuICBjb25zdCBvdXRwdXQgPSBuZXcgVWludDMyQXJyYXkoZ2V0T3V0cHV0TGVuZ3RoKGxlbmd0aDgpKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDg7IGkgKz0gOCkge1xuICAgIG91dHB1dFtpID4+IDVdIHw9IChpbnB1dFtpIC8gOF0gJiAweGZmKSA8PCBpICUgMzI7XG4gIH1cblxuICByZXR1cm4gb3V0cHV0O1xufVxuLypcbiAqIEFkZCBpbnRlZ2Vycywgd3JhcHBpbmcgYXQgMl4zMi4gVGhpcyB1c2VzIDE2LWJpdCBvcGVyYXRpb25zIGludGVybmFsbHlcbiAqIHRvIHdvcmsgYXJvdW5kIGJ1Z3MgaW4gc29tZSBKUyBpbnRlcnByZXRlcnMuXG4gKi9cblxuXG5mdW5jdGlvbiBzYWZlQWRkKHgsIHkpIHtcbiAgY29uc3QgbHN3ID0gKHggJiAweGZmZmYpICsgKHkgJiAweGZmZmYpO1xuICBjb25zdCBtc3cgPSAoeCA+PiAxNikgKyAoeSA+PiAxNikgKyAobHN3ID4+IDE2KTtcbiAgcmV0dXJuIG1zdyA8PCAxNiB8IGxzdyAmIDB4ZmZmZjtcbn1cbi8qXG4gKiBCaXR3aXNlIHJvdGF0ZSBhIDMyLWJpdCBudW1iZXIgdG8gdGhlIGxlZnQuXG4gKi9cblxuXG5mdW5jdGlvbiBiaXRSb3RhdGVMZWZ0KG51bSwgY250KSB7XG4gIHJldHVybiBudW0gPDwgY250IHwgbnVtID4+PiAzMiAtIGNudDtcbn1cbi8qXG4gKiBUaGVzZSBmdW5jdGlvbnMgaW1wbGVtZW50IHRoZSBmb3VyIGJhc2ljIG9wZXJhdGlvbnMgdGhlIGFsZ29yaXRobSB1c2VzLlxuICovXG5cblxuZnVuY3Rpb24gbWQ1Y21uKHEsIGEsIGIsIHgsIHMsIHQpIHtcbiAgcmV0dXJuIHNhZmVBZGQoYml0Um90YXRlTGVmdChzYWZlQWRkKHNhZmVBZGQoYSwgcSksIHNhZmVBZGQoeCwgdCkpLCBzKSwgYik7XG59XG5cbmZ1bmN0aW9uIG1kNWZmKGEsIGIsIGMsIGQsIHgsIHMsIHQpIHtcbiAgcmV0dXJuIG1kNWNtbihiICYgYyB8IH5iICYgZCwgYSwgYiwgeCwgcywgdCk7XG59XG5cbmZ1bmN0aW9uIG1kNWdnKGEsIGIsIGMsIGQsIHgsIHMsIHQpIHtcbiAgcmV0dXJuIG1kNWNtbihiICYgZCB8IGMgJiB+ZCwgYSwgYiwgeCwgcywgdCk7XG59XG5cbmZ1bmN0aW9uIG1kNWhoKGEsIGIsIGMsIGQsIHgsIHMsIHQpIHtcbiAgcmV0dXJuIG1kNWNtbihiIF4gYyBeIGQsIGEsIGIsIHgsIHMsIHQpO1xufVxuXG5mdW5jdGlvbiBtZDVpaShhLCBiLCBjLCBkLCB4LCBzLCB0KSB7XG4gIHJldHVybiBtZDVjbW4oYyBeIChiIHwgfmQpLCBhLCBiLCB4LCBzLCB0KTtcbn1cblxudmFyIF9kZWZhdWx0ID0gbWQ1O1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5jb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xudmFyIF9kZWZhdWx0ID0ge1xuICByYW5kb21VVUlEXG59O1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG52YXIgX2RlZmF1bHQgPSAnMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwJztcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX3ZhbGlkYXRlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92YWxpZGF0ZS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIHBhcnNlKHV1aWQpIHtcbiAgaWYgKCEoMCwgX3ZhbGlkYXRlLmRlZmF1bHQpKHV1aWQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKCdJbnZhbGlkIFVVSUQnKTtcbiAgfVxuXG4gIGxldCB2O1xuICBjb25zdCBhcnIgPSBuZXcgVWludDhBcnJheSgxNik7IC8vIFBhcnNlICMjIyMjIyMjLS4uLi4tLi4uLi0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFyclswXSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgwLCA4KSwgMTYpKSA+Pj4gMjQ7XG4gIGFyclsxXSA9IHYgPj4+IDE2ICYgMHhmZjtcbiAgYXJyWzJdID0gdiA+Pj4gOCAmIDB4ZmY7XG4gIGFyclszXSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0jIyMjLS4uLi4tLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbNF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoOSwgMTMpLCAxNikpID4+PiA4O1xuICBhcnJbNV0gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0jIyMjLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzZdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDE0LCAxOCksIDE2KSkgPj4+IDg7XG4gIGFycls3XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLS4uLi4tIyMjIy0uLi4uLi4uLi4uLi5cblxuICBhcnJbOF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMTksIDIzKSwgMTYpKSA+Pj4gODtcbiAgYXJyWzldID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tLi4uLi0uLi4uLSMjIyMjIyMjIyMjI1xuICAvLyAoVXNlIFwiL1wiIHRvIGF2b2lkIDMyLWJpdCB0cnVuY2F0aW9uIHdoZW4gYml0LXNoaWZ0aW5nIGhpZ2gtb3JkZXIgYnl0ZXMpXG5cbiAgYXJyWzEwXSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgyNCwgMzYpLCAxNikpIC8gMHgxMDAwMDAwMDAwMCAmIDB4ZmY7XG4gIGFyclsxMV0gPSB2IC8gMHgxMDAwMDAwMDAgJiAweGZmO1xuICBhcnJbMTJdID0gdiA+Pj4gMjQgJiAweGZmO1xuICBhcnJbMTNdID0gdiA+Pj4gMTYgJiAweGZmO1xuICBhcnJbMTRdID0gdiA+Pj4gOCAmIDB4ZmY7XG4gIGFyclsxNV0gPSB2ICYgMHhmZjtcbiAgcmV0dXJuIGFycjtcbn1cblxudmFyIF9kZWZhdWx0ID0gcGFyc2U7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbnZhciBfZGVmYXVsdCA9IC9eKD86WzAtOWEtZl17OH0tWzAtOWEtZl17NH0tWzEtNV1bMC05YS1mXXszfS1bODlhYl1bMC05YS1mXXszfS1bMC05YS1mXXsxMn18MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwKSQvaTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gcm5nO1xuLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5cbmZ1bmN0aW9uIHJuZygpIHtcbiAgLy8gbGF6eSBsb2FkIHNvIHRoYXQgZW52aXJvbm1lbnRzIHRoYXQgbmVlZCB0byBwb2x5ZmlsbCBoYXZlIGEgY2hhbmNlIHRvIGRvIHNvXG4gIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgLy8gZ2V0UmFuZG9tVmFsdWVzIG5lZWRzIHRvIGJlIGludm9rZWQgaW4gYSBjb250ZXh0IHdoZXJlIFwidGhpc1wiIGlzIGEgQ3J5cHRvIGltcGxlbWVudGF0aW9uLlxuICAgIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0byk7XG5cbiAgICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKCkgbm90IHN1cHBvcnRlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCNnZXRyYW5kb212YWx1ZXMtbm90LXN1cHBvcnRlZCcpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG4vLyBBZGFwdGVkIGZyb20gQ2hyaXMgVmVuZXNzJyBTSEExIGNvZGUgYXRcbi8vIGh0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvc2hhMS5odG1sXG5mdW5jdGlvbiBmKHMsIHgsIHksIHopIHtcbiAgc3dpdGNoIChzKSB7XG4gICAgY2FzZSAwOlxuICAgICAgcmV0dXJuIHggJiB5IF4gfnggJiB6O1xuXG4gICAgY2FzZSAxOlxuICAgICAgcmV0dXJuIHggXiB5IF4gejtcblxuICAgIGNhc2UgMjpcbiAgICAgIHJldHVybiB4ICYgeSBeIHggJiB6IF4geSAmIHo7XG5cbiAgICBjYXNlIDM6XG4gICAgICByZXR1cm4geCBeIHkgXiB6O1xuICB9XG59XG5cbmZ1bmN0aW9uIFJPVEwoeCwgbikge1xuICByZXR1cm4geCA8PCBuIHwgeCA+Pj4gMzIgLSBuO1xufVxuXG5mdW5jdGlvbiBzaGExKGJ5dGVzKSB7XG4gIGNvbnN0IEsgPSBbMHg1YTgyNzk5OSwgMHg2ZWQ5ZWJhMSwgMHg4ZjFiYmNkYywgMHhjYTYyYzFkNl07XG4gIGNvbnN0IEggPSBbMHg2NzQ1MjMwMSwgMHhlZmNkYWI4OSwgMHg5OGJhZGNmZSwgMHgxMDMyNTQ3NiwgMHhjM2QyZTFmMF07XG5cbiAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCBtc2cgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoYnl0ZXMpKTsgLy8gVVRGOCBlc2NhcGVcblxuICAgIGJ5dGVzID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1zZy5sZW5ndGg7ICsraSkge1xuICAgICAgYnl0ZXMucHVzaChtc2cuY2hhckNvZGVBdChpKSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKCFBcnJheS5pc0FycmF5KGJ5dGVzKSkge1xuICAgIC8vIENvbnZlcnQgQXJyYXktbGlrZSB0byBBcnJheVxuICAgIGJ5dGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYnl0ZXMpO1xuICB9XG5cbiAgYnl0ZXMucHVzaCgweDgwKTtcbiAgY29uc3QgbCA9IGJ5dGVzLmxlbmd0aCAvIDQgKyAyO1xuICBjb25zdCBOID0gTWF0aC5jZWlsKGwgLyAxNik7XG4gIGNvbnN0IE0gPSBuZXcgQXJyYXkoTik7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBOOyArK2kpIHtcbiAgICBjb25zdCBhcnIgPSBuZXcgVWludDMyQXJyYXkoMTYpO1xuXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCAxNjsgKytqKSB7XG4gICAgICBhcnJbal0gPSBieXRlc1tpICogNjQgKyBqICogNF0gPDwgMjQgfCBieXRlc1tpICogNjQgKyBqICogNCArIDFdIDw8IDE2IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAyXSA8PCA4IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAzXTtcbiAgICB9XG5cbiAgICBNW2ldID0gYXJyO1xuICB9XG5cbiAgTVtOIC0gMV1bMTRdID0gKGJ5dGVzLmxlbmd0aCAtIDEpICogOCAvIE1hdGgucG93KDIsIDMyKTtcbiAgTVtOIC0gMV1bMTRdID0gTWF0aC5mbG9vcihNW04gLSAxXVsxNF0pO1xuICBNW04gLSAxXVsxNV0gPSAoYnl0ZXMubGVuZ3RoIC0gMSkgKiA4ICYgMHhmZmZmZmZmZjtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IE47ICsraSkge1xuICAgIGNvbnN0IFcgPSBuZXcgVWludDMyQXJyYXkoODApO1xuXG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCAxNjsgKyt0KSB7XG4gICAgICBXW3RdID0gTVtpXVt0XTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCB0ID0gMTY7IHQgPCA4MDsgKyt0KSB7XG4gICAgICBXW3RdID0gUk9UTChXW3QgLSAzXSBeIFdbdCAtIDhdIF4gV1t0IC0gMTRdIF4gV1t0IC0gMTZdLCAxKTtcbiAgICB9XG5cbiAgICBsZXQgYSA9IEhbMF07XG4gICAgbGV0IGIgPSBIWzFdO1xuICAgIGxldCBjID0gSFsyXTtcbiAgICBsZXQgZCA9IEhbM107XG4gICAgbGV0IGUgPSBIWzRdO1xuXG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCA4MDsgKyt0KSB7XG4gICAgICBjb25zdCBzID0gTWF0aC5mbG9vcih0IC8gMjApO1xuICAgICAgY29uc3QgVCA9IFJPVEwoYSwgNSkgKyBmKHMsIGIsIGMsIGQpICsgZSArIEtbc10gKyBXW3RdID4+PiAwO1xuICAgICAgZSA9IGQ7XG4gICAgICBkID0gYztcbiAgICAgIGMgPSBST1RMKGIsIDMwKSA+Pj4gMDtcbiAgICAgIGIgPSBhO1xuICAgICAgYSA9IFQ7XG4gICAgfVxuXG4gICAgSFswXSA9IEhbMF0gKyBhID4+PiAwO1xuICAgIEhbMV0gPSBIWzFdICsgYiA+Pj4gMDtcbiAgICBIWzJdID0gSFsyXSArIGMgPj4+IDA7XG4gICAgSFszXSA9IEhbM10gKyBkID4+PiAwO1xuICAgIEhbNF0gPSBIWzRdICsgZSA+Pj4gMDtcbiAgfVxuXG4gIHJldHVybiBbSFswXSA+PiAyNCAmIDB4ZmYsIEhbMF0gPj4gMTYgJiAweGZmLCBIWzBdID4+IDggJiAweGZmLCBIWzBdICYgMHhmZiwgSFsxXSA+PiAyNCAmIDB4ZmYsIEhbMV0gPj4gMTYgJiAweGZmLCBIWzFdID4+IDggJiAweGZmLCBIWzFdICYgMHhmZiwgSFsyXSA+PiAyNCAmIDB4ZmYsIEhbMl0gPj4gMTYgJiAweGZmLCBIWzJdID4+IDggJiAweGZmLCBIWzJdICYgMHhmZiwgSFszXSA+PiAyNCAmIDB4ZmYsIEhbM10gPj4gMTYgJiAweGZmLCBIWzNdID4+IDggJiAweGZmLCBIWzNdICYgMHhmZiwgSFs0XSA+PiAyNCAmIDB4ZmYsIEhbNF0gPj4gMTYgJiAweGZmLCBIWzRdID4+IDggJiAweGZmLCBIWzRdICYgMHhmZl07XG59XG5cbnZhciBfZGVmYXVsdCA9IHNoYTE7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcbmV4cG9ydHMudW5zYWZlU3RyaW5naWZ5ID0gdW5zYWZlU3RyaW5naWZ5O1xuXG52YXIgX3ZhbGlkYXRlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92YWxpZGF0ZS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbn1cblxuZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghKDAsIF92YWxpZGF0ZS5kZWZhdWx0KSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxudmFyIF9kZWZhdWx0ID0gc3RyaW5naWZ5O1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfcm5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9ybmcuanNcIikpO1xuXG52YXIgX3N0cmluZ2lmeSA9IHJlcXVpcmUoXCIuL3N0cmluZ2lmeS5qc1wiKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLy8gKipgdjEoKWAgLSBHZW5lcmF0ZSB0aW1lLWJhc2VkIFVVSUQqKlxuLy9cbi8vIEluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9MaW9zSy9VVUlELmpzXG4vLyBhbmQgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L3V1aWQuaHRtbFxubGV0IF9ub2RlSWQ7XG5cbmxldCBfY2xvY2tzZXE7IC8vIFByZXZpb3VzIHV1aWQgY3JlYXRpb24gdGltZVxuXG5cbmxldCBfbGFzdE1TZWNzID0gMDtcbmxldCBfbGFzdE5TZWNzID0gMDsgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCBmb3IgQVBJIGRldGFpbHNcblxuZnVuY3Rpb24gdjEob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgbGV0IGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG4gIGNvbnN0IGIgPSBidWYgfHwgbmV3IEFycmF5KDE2KTtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGxldCBub2RlID0gb3B0aW9ucy5ub2RlIHx8IF9ub2RlSWQ7XG4gIGxldCBjbG9ja3NlcSA9IG9wdGlvbnMuY2xvY2tzZXEgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuY2xvY2tzZXEgOiBfY2xvY2tzZXE7IC8vIG5vZGUgYW5kIGNsb2Nrc2VxIG5lZWQgdG8gYmUgaW5pdGlhbGl6ZWQgdG8gcmFuZG9tIHZhbHVlcyBpZiB0aGV5J3JlIG5vdFxuICAvLyBzcGVjaWZpZWQuICBXZSBkbyB0aGlzIGxhemlseSB0byBtaW5pbWl6ZSBpc3N1ZXMgcmVsYXRlZCB0byBpbnN1ZmZpY2llbnRcbiAgLy8gc3lzdGVtIGVudHJvcHkuICBTZWUgIzE4OVxuXG4gIGlmIChub2RlID09IG51bGwgfHwgY2xvY2tzZXEgPT0gbnVsbCkge1xuICAgIGNvbnN0IHNlZWRCeXRlcyA9IG9wdGlvbnMucmFuZG9tIHx8IChvcHRpb25zLnJuZyB8fCBfcm5nLmRlZmF1bHQpKCk7XG5cbiAgICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgICAvLyBQZXIgNC41LCBjcmVhdGUgYW5kIDQ4LWJpdCBub2RlIGlkLCAoNDcgcmFuZG9tIGJpdHMgKyBtdWx0aWNhc3QgYml0ID0gMSlcbiAgICAgIG5vZGUgPSBfbm9kZUlkID0gW3NlZWRCeXRlc1swXSB8IDB4MDEsIHNlZWRCeXRlc1sxXSwgc2VlZEJ5dGVzWzJdLCBzZWVkQnl0ZXNbM10sIHNlZWRCeXRlc1s0XSwgc2VlZEJ5dGVzWzVdXTtcbiAgICB9XG5cbiAgICBpZiAoY2xvY2tzZXEgPT0gbnVsbCkge1xuICAgICAgLy8gUGVyIDQuMi4yLCByYW5kb21pemUgKDE0IGJpdCkgY2xvY2tzZXFcbiAgICAgIGNsb2Nrc2VxID0gX2Nsb2Nrc2VxID0gKHNlZWRCeXRlc1s2XSA8PCA4IHwgc2VlZEJ5dGVzWzddKSAmIDB4M2ZmZjtcbiAgICB9XG4gIH0gLy8gVVVJRCB0aW1lc3RhbXBzIGFyZSAxMDAgbmFuby1zZWNvbmQgdW5pdHMgc2luY2UgdGhlIEdyZWdvcmlhbiBlcG9jaCxcbiAgLy8gKDE1ODItMTAtMTUgMDA6MDApLiAgSlNOdW1iZXJzIGFyZW4ndCBwcmVjaXNlIGVub3VnaCBmb3IgdGhpcywgc29cbiAgLy8gdGltZSBpcyBoYW5kbGVkIGludGVybmFsbHkgYXMgJ21zZWNzJyAoaW50ZWdlciBtaWxsaXNlY29uZHMpIGFuZCAnbnNlY3MnXG4gIC8vICgxMDAtbmFub3NlY29uZHMgb2Zmc2V0IGZyb20gbXNlY3MpIHNpbmNlIHVuaXggZXBvY2gsIDE5NzAtMDEtMDEgMDA6MDAuXG5cblxuICBsZXQgbXNlY3MgPSBvcHRpb25zLm1zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1zZWNzIDogRGF0ZS5ub3coKTsgLy8gUGVyIDQuMi4xLjIsIHVzZSBjb3VudCBvZiB1dWlkJ3MgZ2VuZXJhdGVkIGR1cmluZyB0aGUgY3VycmVudCBjbG9ja1xuICAvLyBjeWNsZSB0byBzaW11bGF0ZSBoaWdoZXIgcmVzb2x1dGlvbiBjbG9ja1xuXG4gIGxldCBuc2VjcyA9IG9wdGlvbnMubnNlY3MgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMubnNlY3MgOiBfbGFzdE5TZWNzICsgMTsgLy8gVGltZSBzaW5jZSBsYXN0IHV1aWQgY3JlYXRpb24gKGluIG1zZWNzKVxuXG4gIGNvbnN0IGR0ID0gbXNlY3MgLSBfbGFzdE1TZWNzICsgKG5zZWNzIC0gX2xhc3ROU2VjcykgLyAxMDAwMDsgLy8gUGVyIDQuMi4xLjIsIEJ1bXAgY2xvY2tzZXEgb24gY2xvY2sgcmVncmVzc2lvblxuXG4gIGlmIChkdCA8IDAgJiYgb3B0aW9ucy5jbG9ja3NlcSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgY2xvY2tzZXEgPSBjbG9ja3NlcSArIDEgJiAweDNmZmY7XG4gIH0gLy8gUmVzZXQgbnNlY3MgaWYgY2xvY2sgcmVncmVzc2VzIChuZXcgY2xvY2tzZXEpIG9yIHdlJ3ZlIG1vdmVkIG9udG8gYSBuZXdcbiAgLy8gdGltZSBpbnRlcnZhbFxuXG5cbiAgaWYgKChkdCA8IDAgfHwgbXNlY3MgPiBfbGFzdE1TZWNzKSAmJiBvcHRpb25zLm5zZWNzID09PSB1bmRlZmluZWQpIHtcbiAgICBuc2VjcyA9IDA7XG4gIH0gLy8gUGVyIDQuMi4xLjIgVGhyb3cgZXJyb3IgaWYgdG9vIG1hbnkgdXVpZHMgYXJlIHJlcXVlc3RlZFxuXG5cbiAgaWYgKG5zZWNzID49IDEwMDAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwidXVpZC52MSgpOiBDYW4ndCBjcmVhdGUgbW9yZSB0aGFuIDEwTSB1dWlkcy9zZWNcIik7XG4gIH1cblxuICBfbGFzdE1TZWNzID0gbXNlY3M7XG4gIF9sYXN0TlNlY3MgPSBuc2VjcztcbiAgX2Nsb2Nrc2VxID0gY2xvY2tzZXE7IC8vIFBlciA0LjEuNCAtIENvbnZlcnQgZnJvbSB1bml4IGVwb2NoIHRvIEdyZWdvcmlhbiBlcG9jaFxuXG4gIG1zZWNzICs9IDEyMjE5MjkyODAwMDAwOyAvLyBgdGltZV9sb3dgXG5cbiAgY29uc3QgdGwgPSAoKG1zZWNzICYgMHhmZmZmZmZmKSAqIDEwMDAwICsgbnNlY3MpICUgMHgxMDAwMDAwMDA7XG4gIGJbaSsrXSA9IHRsID4+PiAyNCAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRsID4+PiAxNiAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRsID4+PiA4ICYgMHhmZjtcbiAgYltpKytdID0gdGwgJiAweGZmOyAvLyBgdGltZV9taWRgXG5cbiAgY29uc3QgdG1oID0gbXNlY3MgLyAweDEwMDAwMDAwMCAqIDEwMDAwICYgMHhmZmZmZmZmO1xuICBiW2krK10gPSB0bWggPj4+IDggJiAweGZmO1xuICBiW2krK10gPSB0bWggJiAweGZmOyAvLyBgdGltZV9oaWdoX2FuZF92ZXJzaW9uYFxuXG4gIGJbaSsrXSA9IHRtaCA+Pj4gMjQgJiAweGYgfCAweDEwOyAvLyBpbmNsdWRlIHZlcnNpb25cblxuICBiW2krK10gPSB0bWggPj4+IDE2ICYgMHhmZjsgLy8gYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgIChQZXIgNC4yLjIgLSBpbmNsdWRlIHZhcmlhbnQpXG5cbiAgYltpKytdID0gY2xvY2tzZXEgPj4+IDggfCAweDgwOyAvLyBgY2xvY2tfc2VxX2xvd2BcblxuICBiW2krK10gPSBjbG9ja3NlcSAmIDB4ZmY7IC8vIGBub2RlYFxuXG4gIGZvciAobGV0IG4gPSAwOyBuIDwgNjsgKytuKSB7XG4gICAgYltpICsgbl0gPSBub2RlW25dO1xuICB9XG5cbiAgcmV0dXJuIGJ1ZiB8fCAoMCwgX3N0cmluZ2lmeS51bnNhZmVTdHJpbmdpZnkpKGIpO1xufVxuXG52YXIgX2RlZmF1bHQgPSB2MTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX3YgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3YzNS5qc1wiKSk7XG5cbnZhciBfbWQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL21kNS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmNvbnN0IHYzID0gKDAsIF92LmRlZmF1bHQpKCd2MycsIDB4MzAsIF9tZC5kZWZhdWx0KTtcbnZhciBfZGVmYXVsdCA9IHYzO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLlVSTCA9IGV4cG9ydHMuRE5TID0gdm9pZCAwO1xuZXhwb3J0cy5kZWZhdWx0ID0gdjM1O1xuXG52YXIgX3N0cmluZ2lmeSA9IHJlcXVpcmUoXCIuL3N0cmluZ2lmeS5qc1wiKTtcblxudmFyIF9wYXJzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcGFyc2UuanNcIikpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBzdHJpbmdUb0J5dGVzKHN0cikge1xuICBzdHIgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSk7IC8vIFVURjggZXNjYXBlXG5cbiAgY29uc3QgYnl0ZXMgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgIGJ5dGVzLnB1c2goc3RyLmNoYXJDb2RlQXQoaSkpO1xuICB9XG5cbiAgcmV0dXJuIGJ5dGVzO1xufVxuXG5jb25zdCBETlMgPSAnNmJhN2I4MTAtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydHMuRE5TID0gRE5TO1xuY29uc3QgVVJMID0gJzZiYTdiODExLTlkYWQtMTFkMS04MGI0LTAwYzA0ZmQ0MzBjOCc7XG5leHBvcnRzLlVSTCA9IFVSTDtcblxuZnVuY3Rpb24gdjM1KG5hbWUsIHZlcnNpb24sIGhhc2hmdW5jKSB7XG4gIGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCh2YWx1ZSwgbmFtZXNwYWNlLCBidWYsIG9mZnNldCkge1xuICAgIHZhciBfbmFtZXNwYWNlO1xuXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHZhbHVlID0gc3RyaW5nVG9CeXRlcyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lc3BhY2UgPSAoMCwgX3BhcnNlLmRlZmF1bHQpKG5hbWVzcGFjZSk7XG4gICAgfVxuXG4gICAgaWYgKCgoX25hbWVzcGFjZSA9IG5hbWVzcGFjZSkgPT09IG51bGwgfHwgX25hbWVzcGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25hbWVzcGFjZS5sZW5ndGgpICE9PSAxNikge1xuICAgICAgdGhyb3cgVHlwZUVycm9yKCdOYW1lc3BhY2UgbXVzdCBiZSBhcnJheS1saWtlICgxNiBpdGVyYWJsZSBpbnRlZ2VyIHZhbHVlcywgMC0yNTUpJyk7XG4gICAgfSAvLyBDb21wdXRlIGhhc2ggb2YgbmFtZXNwYWNlIGFuZCB2YWx1ZSwgUGVyIDQuM1xuICAgIC8vIEZ1dHVyZTogVXNlIHNwcmVhZCBzeW50YXggd2hlbiBzdXBwb3J0ZWQgb24gYWxsIHBsYXRmb3JtcywgZS5nLiBgYnl0ZXMgPVxuICAgIC8vIGhhc2hmdW5jKFsuLi5uYW1lc3BhY2UsIC4uLiB2YWx1ZV0pYFxuXG5cbiAgICBsZXQgYnl0ZXMgPSBuZXcgVWludDhBcnJheSgxNiArIHZhbHVlLmxlbmd0aCk7XG4gICAgYnl0ZXMuc2V0KG5hbWVzcGFjZSk7XG4gICAgYnl0ZXMuc2V0KHZhbHVlLCBuYW1lc3BhY2UubGVuZ3RoKTtcbiAgICBieXRlcyA9IGhhc2hmdW5jKGJ5dGVzKTtcbiAgICBieXRlc1s2XSA9IGJ5dGVzWzZdICYgMHgwZiB8IHZlcnNpb247XG4gICAgYnl0ZXNbOF0gPSBieXRlc1s4XSAmIDB4M2YgfCAweDgwO1xuXG4gICAgaWYgKGJ1Zikge1xuICAgICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgICBidWZbb2Zmc2V0ICsgaV0gPSBieXRlc1tpXTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGJ1ZjtcbiAgICB9XG5cbiAgICByZXR1cm4gKDAsIF9zdHJpbmdpZnkudW5zYWZlU3RyaW5naWZ5KShieXRlcyk7XG4gIH0gLy8gRnVuY3Rpb24jbmFtZSBpcyBub3Qgc2V0dGFibGUgb24gc29tZSBwbGF0Zm9ybXMgKCMyNzApXG5cblxuICB0cnkge1xuICAgIGdlbmVyYXRlVVVJRC5uYW1lID0gbmFtZTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5XG4gIH0gY2F0Y2ggKGVycikge30gLy8gRm9yIENvbW1vbkpTIGRlZmF1bHQgZXhwb3J0IHN1cHBvcnRcblxuXG4gIGdlbmVyYXRlVVVJRC5ETlMgPSBETlM7XG4gIGdlbmVyYXRlVVVJRC5VUkwgPSBVUkw7XG4gIHJldHVybiBnZW5lcmF0ZVVVSUQ7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfbmF0aXZlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9uYXRpdmUuanNcIikpO1xuXG52YXIgX3JuZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcm5nLmpzXCIpKTtcblxudmFyIF9zdHJpbmdpZnkgPSByZXF1aXJlKFwiLi9zdHJpbmdpZnkuanNcIik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIHY0KG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KSB7XG4gIGlmIChfbmF0aXZlLmRlZmF1bHQucmFuZG9tVVVJRCAmJiAhYnVmICYmICFvcHRpb25zKSB7XG4gICAgcmV0dXJuIF9uYXRpdmUuZGVmYXVsdC5yYW5kb21VVUlEKCk7XG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IF9ybmcuZGVmYXVsdCkoKTsgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gKDAsIF9zdHJpbmdpZnkudW5zYWZlU3RyaW5naWZ5KShybmRzKTtcbn1cblxudmFyIF9kZWZhdWx0ID0gdjQ7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF92ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92MzUuanNcIikpO1xuXG52YXIgX3NoYSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vc2hhMS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmNvbnN0IHY1ID0gKDAsIF92LmRlZmF1bHQpKCd2NScsIDB4NTAsIF9zaGEuZGVmYXVsdCk7XG52YXIgX2RlZmF1bHQgPSB2NTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX3JlZ2V4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9yZWdleC5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIHZhbGlkYXRlKHV1aWQpIHtcbiAgcmV0dXJuIHR5cGVvZiB1dWlkID09PSAnc3RyaW5nJyAmJiBfcmVnZXguZGVmYXVsdC50ZXN0KHV1aWQpO1xufVxuXG52YXIgX2RlZmF1bHQgPSB2YWxpZGF0ZTtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX3ZhbGlkYXRlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92YWxpZGF0ZS5qc1wiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIHZlcnNpb24odXVpZCkge1xuICBpZiAoISgwLCBfdmFsaWRhdGUuZGVmYXVsdCkodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ0ludmFsaWQgVVVJRCcpO1xuICB9XG5cbiAgcmV0dXJuIHBhcnNlSW50KHV1aWQuc2xpY2UoMTQsIDE1KSwgMTYpO1xufVxuXG52YXIgX2RlZmF1bHQgPSB2ZXJzaW9uO1xuZXhwb3J0cy5kZWZhdWx0ID0gX2RlZmF1bHQ7IiwiY29uc3QgcmFuZG9tVVVJRCA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5yYW5kb21VVUlEICYmIGNyeXB0by5yYW5kb21VVUlELmJpbmQoY3J5cHRvKTtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgcmFuZG9tVVVJRFxufTsiLCJleHBvcnQgZGVmYXVsdCAvXig/OlswLTlhLWZdezh9LVswLTlhLWZdezR9LVsxLTVdWzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9fDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCkkL2k7IiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi5cbiAgICBnZXRSYW5kb21WYWx1ZXMgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuXG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG4vKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cblxuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgLy8gTm90ZTogQmUgY2FyZWZ1bCBlZGl0aW5nIHRoaXMgY29kZSEgIEl0J3MgYmVlbiB0dW5lZCBmb3IgcGVyZm9ybWFuY2VcbiAgLy8gYW5kIHdvcmtzIGluIHdheXMgeW91IG1heSBub3QgZXhwZWN0LiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkL3B1bGwvNDM0XG4gIHJldHVybiAoYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAwXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAzXV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA2XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDddXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA5XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEwXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDExXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEzXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDE0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDE1XV0pLnRvTG93ZXJDYXNlKCk7XG59XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgY29uc3QgdXVpZCA9IHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCk7IC8vIENvbnNpc3RlbmN5IGNoZWNrIGZvciB2YWxpZCBVVUlELiAgSWYgdGhpcyB0aHJvd3MsIGl0J3MgbGlrZWx5IGR1ZSB0byBvbmVcbiAgLy8gb2YgdGhlIGZvbGxvd2luZzpcbiAgLy8gLSBPbmUgb3IgbW9yZSBpbnB1dCBhcnJheSB2YWx1ZXMgZG9uJ3QgbWFwIHRvIGEgaGV4IG9jdGV0IChsZWFkaW5nIHRvXG4gIC8vIFwidW5kZWZpbmVkXCIgaW4gdGhlIHV1aWQpXG4gIC8vIC0gSW52YWxpZCBpbnB1dCB2YWx1ZXMgZm9yIHRoZSBSRkMgYHZlcnNpb25gIG9yIGB2YXJpYW50YCBmaWVsZHNcblxuICBpZiAoIXZhbGlkYXRlKHV1aWQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmdpZmllZCBVVUlEIGlzIGludmFsaWQnKTtcbiAgfVxuXG4gIHJldHVybiB1dWlkO1xufVxuXG5leHBvcnQgZGVmYXVsdCBzdHJpbmdpZnk7IiwiaW1wb3J0IG5hdGl2ZSBmcm9tICcuL25hdGl2ZS5qcyc7XG5pbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgaWYgKG5hdGl2ZS5yYW5kb21VVUlEICYmICFidWYgJiYgIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmF0aXZlLnJhbmRvbVVVSUQoKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IHJuZykoKTsgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuXG4gIHJuZHNbNl0gPSBybmRzWzZdICYgMHgwZiB8IDB4NDA7XG4gIHJuZHNbOF0gPSBybmRzWzhdICYgMHgzZiB8IDB4ODA7IC8vIENvcHkgYnl0ZXMgdG8gYnVmZmVyLCBpZiBwcm92aWRlZFxuXG4gIGlmIChidWYpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgYnVmW29mZnNldCArIGldID0gcm5kc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmO1xuICB9XG5cbiAgcmV0dXJuIHVuc2FmZVN0cmluZ2lmeShybmRzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdjQ7IiwiaW1wb3J0IFJFR0VYIGZyb20gJy4vcmVnZXguanMnO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZSh1dWlkKSB7XG4gIHJldHVybiB0eXBlb2YgdXVpZCA9PT0gJ3N0cmluZycgJiYgUkVHRVgudGVzdCh1dWlkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGU7IiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsXCIsIFtcIm1vZHVsZVwiXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBmYWN0b3J5KG1vZHVsZSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIG1vZCA9IHtcbiAgICAgIGV4cG9ydHM6IHt9XG4gICAgfTtcbiAgICBmYWN0b3J5KG1vZCk7XG4gICAgZ2xvYmFsLmJyb3dzZXIgPSBtb2QuZXhwb3J0cztcbiAgfVxufSkodHlwZW9mIGdsb2JhbFRoaXMgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWxUaGlzIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24gKG1vZHVsZSkge1xuICAvKiB3ZWJleHRlbnNpb24tcG9seWZpbGwgLSB2MC4xMC4wIC0gRnJpIEF1ZyAxMiAyMDIyIDE5OjQyOjQ0ICovXG5cbiAgLyogLSotIE1vZGU6IGluZGVudC10YWJzLW1vZGU6IG5pbDsganMtaW5kZW50LWxldmVsOiAyIC0qLSAqL1xuXG4gIC8qIHZpbTogc2V0IHN0cz0yIHN3PTIgZXQgdHc9ODA6ICovXG5cbiAgLyogVGhpcyBTb3VyY2UgQ29kZSBGb3JtIGlzIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mIHRoZSBNb3ppbGxhIFB1YmxpY1xuICAgKiBMaWNlbnNlLCB2LiAyLjAuIElmIGEgY29weSBvZiB0aGUgTVBMIHdhcyBub3QgZGlzdHJpYnV0ZWQgd2l0aCB0aGlzXG4gICAqIGZpbGUsIFlvdSBjYW4gb2J0YWluIG9uZSBhdCBodHRwOi8vbW96aWxsYS5vcmcvTVBMLzIuMC8uICovXG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIGlmICghZ2xvYmFsVGhpcy5jaHJvbWU/LnJ1bnRpbWU/LmlkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBzY3JpcHQgc2hvdWxkIG9ubHkgYmUgbG9hZGVkIGluIGEgYnJvd3NlciBleHRlbnNpb24uXCIpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBnbG9iYWxUaGlzLmJyb3dzZXIgPT09IFwidW5kZWZpbmVkXCIgfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKGdsb2JhbFRoaXMuYnJvd3NlcikgIT09IE9iamVjdC5wcm90b3R5cGUpIHtcbiAgICBjb25zdCBDSFJPTUVfU0VORF9NRVNTQUdFX0NBTExCQUNLX05PX1JFU1BPTlNFX01FU1NBR0UgPSBcIlRoZSBtZXNzYWdlIHBvcnQgY2xvc2VkIGJlZm9yZSBhIHJlc3BvbnNlIHdhcyByZWNlaXZlZC5cIjsgLy8gV3JhcHBpbmcgdGhlIGJ1bGsgb2YgdGhpcyBwb2x5ZmlsbCBpbiBhIG9uZS10aW1lLXVzZSBmdW5jdGlvbiBpcyBhIG1pbm9yXG4gICAgLy8gb3B0aW1pemF0aW9uIGZvciBGaXJlZm94LiBTaW5jZSBTcGlkZXJtb25rZXkgZG9lcyBub3QgZnVsbHkgcGFyc2UgdGhlXG4gICAgLy8gY29udGVudHMgb2YgYSBmdW5jdGlvbiB1bnRpbCB0aGUgZmlyc3QgdGltZSBpdCdzIGNhbGxlZCwgYW5kIHNpbmNlIGl0IHdpbGxcbiAgICAvLyBuZXZlciBhY3R1YWxseSBuZWVkIHRvIGJlIGNhbGxlZCwgdGhpcyBhbGxvd3MgdGhlIHBvbHlmaWxsIHRvIGJlIGluY2x1ZGVkXG4gICAgLy8gaW4gRmlyZWZveCBuZWFybHkgZm9yIGZyZWUuXG5cbiAgICBjb25zdCB3cmFwQVBJcyA9IGV4dGVuc2lvbkFQSXMgPT4ge1xuICAgICAgLy8gTk9URTogYXBpTWV0YWRhdGEgaXMgYXNzb2NpYXRlZCB0byB0aGUgY29udGVudCBvZiB0aGUgYXBpLW1ldGFkYXRhLmpzb24gZmlsZVxuICAgICAgLy8gYXQgYnVpbGQgdGltZSBieSByZXBsYWNpbmcgdGhlIGZvbGxvd2luZyBcImluY2x1ZGVcIiB3aXRoIHRoZSBjb250ZW50IG9mIHRoZVxuICAgICAgLy8gSlNPTiBmaWxlLlxuICAgICAgY29uc3QgYXBpTWV0YWRhdGEgPSB7XG4gICAgICAgIFwiYWxhcm1zXCI6IHtcbiAgICAgICAgICBcImNsZWFyXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY2xlYXJBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJib29rbWFya3NcIjoge1xuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Q2hpbGRyZW5cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRSZWNlbnRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRTdWJUcmVlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0VHJlZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIm1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVUcmVlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VhcmNoXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiYnJvd3NlckFjdGlvblwiOiB7XG4gICAgICAgICAgXCJkaXNhYmxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZW5hYmxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3JcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRCYWRnZVRleHRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwib3BlblBvcHVwXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3JcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRCYWRnZVRleHRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRJY29uXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0UG9wdXBcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRUaXRsZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImJyb3dzaW5nRGF0YVwiOiB7XG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMlxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVDYWNoZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUNvb2tpZXNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVEb3dubG9hZHNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVGb3JtRGF0YVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUhpc3RvcnlcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVMb2NhbFN0b3JhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVQYXNzd29yZHNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVQbHVnaW5EYXRhXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0dGluZ3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJjb21tYW5kc1wiOiB7XG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJjb250ZXh0TWVudXNcIjoge1xuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlQWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiY29va2llc1wiOiB7XG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxDb29raWVTdG9yZXNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJkZXZ0b29sc1wiOiB7XG4gICAgICAgICAgXCJpbnNwZWN0ZWRXaW5kb3dcIjoge1xuICAgICAgICAgICAgXCJldmFsXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyLFxuICAgICAgICAgICAgICBcInNpbmdsZUNhbGxiYWNrQXJnXCI6IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInBhbmVsc1wiOiB7XG4gICAgICAgICAgICBcImNyZWF0ZVwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAzLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMyxcbiAgICAgICAgICAgICAgXCJzaW5nbGVDYWxsYmFja0FyZ1wiOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJlbGVtZW50c1wiOiB7XG4gICAgICAgICAgICAgIFwiY3JlYXRlU2lkZWJhclBhbmVcIjoge1xuICAgICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiZG93bmxvYWRzXCI6IHtcbiAgICAgICAgICBcImNhbmNlbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRvd25sb2FkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZXJhc2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRGaWxlSWNvblwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIm9wZW5cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwiZmFsbGJhY2tUb05vQ2FsbGJhY2tcIjogdHJ1ZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJwYXVzZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInJlbW92ZUZpbGVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZXN1bWVcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZWFyY2hcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzaG93XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiZXh0ZW5zaW9uXCI6IHtcbiAgICAgICAgICBcImlzQWxsb3dlZEZpbGVTY2hlbWVBY2Nlc3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJpc0FsbG93ZWRJbmNvZ25pdG9BY2Nlc3NcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJoaXN0b3J5XCI6IHtcbiAgICAgICAgICBcImFkZFVybFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRlbGV0ZUFsbFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImRlbGV0ZVJhbmdlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZGVsZXRlVXJsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0VmlzaXRzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VhcmNoXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiaTE4blwiOiB7XG4gICAgICAgICAgXCJkZXRlY3RMYW5ndWFnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEFjY2VwdExhbmd1YWdlc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcImlkZW50aXR5XCI6IHtcbiAgICAgICAgICBcImxhdW5jaFdlYkF1dGhGbG93XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwiaWRsZVwiOiB7XG4gICAgICAgICAgXCJxdWVyeVN0YXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwibWFuYWdlbWVudFwiOiB7XG4gICAgICAgICAgXCJnZXRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRBbGxcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRTZWxmXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0RW5hYmxlZFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInVuaW5zdGFsbFNlbGZcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJub3RpZmljYXRpb25zXCI6IHtcbiAgICAgICAgICBcImNsZWFyXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0UGVybWlzc2lvbkxldmVsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwicGFnZUFjdGlvblwiOiB7XG4gICAgICAgICAgXCJnZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiaGlkZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldEljb25cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRQb3B1cFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNldFRpdGxlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDEsXG4gICAgICAgICAgICBcImZhbGxiYWNrVG9Ob0NhbGxiYWNrXCI6IHRydWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2hvd1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJmYWxsYmFja1RvTm9DYWxsYmFja1wiOiB0cnVlXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInBlcm1pc3Npb25zXCI6IHtcbiAgICAgICAgICBcImNvbnRhaW5zXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVxdWVzdFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInJ1bnRpbWVcIjoge1xuICAgICAgICAgIFwiZ2V0QmFja2dyb3VuZFBhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRQbGF0Zm9ybUluZm9cIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJvcGVuT3B0aW9uc1BhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJyZXF1ZXN0VXBkYXRlQ2hlY2tcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZW5kTWVzc2FnZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAzXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInNlbmROYXRpdmVNZXNzYWdlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0VW5pbnN0YWxsVVJMXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwic2Vzc2lvbnNcIjoge1xuICAgICAgICAgIFwiZ2V0RGV2aWNlc1wiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFJlY2VudGx5Q2xvc2VkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVzdG9yZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcInN0b3JhZ2VcIjoge1xuICAgICAgICAgIFwibG9jYWxcIjoge1xuICAgICAgICAgICAgXCJjbGVhclwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRCeXRlc0luVXNlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInNldFwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJtYW5hZ2VkXCI6IHtcbiAgICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRCeXRlc0luVXNlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInN5bmNcIjoge1xuICAgICAgICAgICAgXCJjbGVhclwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJnZXRCeXRlc0luVXNlXCI6IHtcbiAgICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJyZW1vdmVcIjoge1xuICAgICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInNldFwiOiB7XG4gICAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgXCJ0YWJzXCI6IHtcbiAgICAgICAgICBcImNhcHR1cmVWaXNpYmxlVGFiXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZGV0ZWN0TGFuZ3VhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJkaXNjYXJkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZHVwbGljYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZXhlY3V0ZVNjcmlwdFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldEN1cnJlbnRcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDAsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRab29tXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Wm9vbVNldHRpbmdzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ29CYWNrXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ29Gb3J3YXJkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiaGlnaGxpZ2h0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiaW5zZXJ0Q1NTXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwibW92ZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMixcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcInF1ZXJ5XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVsb2FkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlQ1NTXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2VuZE1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDIsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogM1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJzZXRab29tXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwic2V0Wm9vbVNldHRpbmdzXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwidG9wU2l0ZXNcIjoge1xuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDBcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIFwid2ViTmF2aWdhdGlvblwiOiB7XG4gICAgICAgICAgXCJnZXRBbGxGcmFtZXNcIjoge1xuICAgICAgICAgICAgXCJtaW5BcmdzXCI6IDEsXG4gICAgICAgICAgICBcIm1heEFyZ3NcIjogMVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJnZXRGcmFtZVwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMSxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcIndlYlJlcXVlc3RcIjoge1xuICAgICAgICAgIFwiaGFuZGxlckJlaGF2aW9yQ2hhbmdlZFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAwXG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBcIndpbmRvd3NcIjoge1xuICAgICAgICAgIFwiY3JlYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0XCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0QWxsXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiZ2V0Q3VycmVudFwiOiB7XG4gICAgICAgICAgICBcIm1pbkFyZ3NcIjogMCxcbiAgICAgICAgICAgIFwibWF4QXJnc1wiOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcImdldExhc3RGb2N1c2VkXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAwLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwicmVtb3ZlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAxLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDFcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwidXBkYXRlXCI6IHtcbiAgICAgICAgICAgIFwibWluQXJnc1wiOiAyLFxuICAgICAgICAgICAgXCJtYXhBcmdzXCI6IDJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGlmIChPYmplY3Qua2V5cyhhcGlNZXRhZGF0YSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImFwaS1tZXRhZGF0YS5qc29uIGhhcyBub3QgYmVlbiBpbmNsdWRlZCBpbiBicm93c2VyLXBvbHlmaWxsXCIpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBBIFdlYWtNYXAgc3ViY2xhc3Mgd2hpY2ggY3JlYXRlcyBhbmQgc3RvcmVzIGEgdmFsdWUgZm9yIGFueSBrZXkgd2hpY2ggZG9lc1xuICAgICAgICogbm90IGV4aXN0IHdoZW4gYWNjZXNzZWQsIGJ1dCBiZWhhdmVzIGV4YWN0bHkgYXMgYW4gb3JkaW5hcnkgV2Vha01hcFxuICAgICAgICogb3RoZXJ3aXNlLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNyZWF0ZUl0ZW1cbiAgICAgICAqICAgICAgICBBIGZ1bmN0aW9uIHdoaWNoIHdpbGwgYmUgY2FsbGVkIGluIG9yZGVyIHRvIGNyZWF0ZSB0aGUgdmFsdWUgZm9yIGFueVxuICAgICAgICogICAgICAgIGtleSB3aGljaCBkb2VzIG5vdCBleGlzdCwgdGhlIGZpcnN0IHRpbWUgaXQgaXMgYWNjZXNzZWQuIFRoZVxuICAgICAgICogICAgICAgIGZ1bmN0aW9uIHJlY2VpdmVzLCBhcyBpdHMgb25seSBhcmd1bWVudCwgdGhlIGtleSBiZWluZyBjcmVhdGVkLlxuICAgICAgICovXG5cblxuICAgICAgY2xhc3MgRGVmYXVsdFdlYWtNYXAgZXh0ZW5kcyBXZWFrTWFwIHtcbiAgICAgICAgY29uc3RydWN0b3IoY3JlYXRlSXRlbSwgaXRlbXMgPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBzdXBlcihpdGVtcyk7XG4gICAgICAgICAgdGhpcy5jcmVhdGVJdGVtID0gY3JlYXRlSXRlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdldChrZXkpIHtcbiAgICAgICAgICBpZiAoIXRoaXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0KGtleSwgdGhpcy5jcmVhdGVJdGVtKGtleSkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBzdXBlci5nZXQoa2V5KTtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGFuIG9iamVjdCB3aXRoIGEgYHRoZW5gIG1ldGhvZCwgYW5kIGNhblxuICAgICAgICogdGhlcmVmb3JlIGJlIGFzc3VtZWQgdG8gYmVoYXZlIGFzIGEgUHJvbWlzZS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB0ZXN0LlxuICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHZhbHVlIGlzIHRoZW5hYmxlLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3QgaXNUaGVuYWJsZSA9IHZhbHVlID0+IHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gXCJmdW5jdGlvblwiO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIGZ1bmN0aW9uIHdoaWNoLCB3aGVuIGNhbGxlZCwgd2lsbCByZXNvbHZlIG9yIHJlamVjdFxuICAgICAgICogdGhlIGdpdmVuIHByb21pc2UgYmFzZWQgb24gaG93IGl0IGlzIGNhbGxlZDpcbiAgICAgICAqXG4gICAgICAgKiAtIElmLCB3aGVuIGNhbGxlZCwgYGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcmAgY29udGFpbnMgYSBub24tbnVsbCBvYmplY3QsXG4gICAgICAgKiAgIHRoZSBwcm9taXNlIGlzIHJlamVjdGVkIHdpdGggdGhhdCB2YWx1ZS5cbiAgICAgICAqIC0gSWYgdGhlIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aXRoIGV4YWN0bHkgb25lIGFyZ3VtZW50LCB0aGUgcHJvbWlzZSBpc1xuICAgICAgICogICByZXNvbHZlZCB0byB0aGF0IHZhbHVlLlxuICAgICAgICogLSBPdGhlcndpc2UsIHRoZSBwcm9taXNlIGlzIHJlc29sdmVkIHRvIGFuIGFycmF5IGNvbnRhaW5pbmcgYWxsIG9mIHRoZVxuICAgICAgICogICBmdW5jdGlvbidzIGFyZ3VtZW50cy5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gcHJvbWlzZVxuICAgICAgICogICAgICAgIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSByZXNvbHV0aW9uIGFuZCByZWplY3Rpb24gZnVuY3Rpb25zIG9mIGFcbiAgICAgICAqICAgICAgICBwcm9taXNlLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcHJvbWlzZS5yZXNvbHZlXG4gICAgICAgKiAgICAgICAgVGhlIHByb21pc2UncyByZXNvbHV0aW9uIGZ1bmN0aW9uLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcHJvbWlzZS5yZWplY3RcbiAgICAgICAqICAgICAgICBUaGUgcHJvbWlzZSdzIHJlamVjdGlvbiBmdW5jdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBtZXRhZGF0YVxuICAgICAgICogICAgICAgIE1ldGFkYXRhIGFib3V0IHRoZSB3cmFwcGVkIG1ldGhvZCB3aGljaCBoYXMgY3JlYXRlZCB0aGUgY2FsbGJhY2suXG4gICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG1ldGFkYXRhLnNpbmdsZUNhbGxiYWNrQXJnXG4gICAgICAgKiAgICAgICAgV2hldGhlciBvciBub3QgdGhlIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCBvbmx5IHRoZSBmaXJzdFxuICAgICAgICogICAgICAgIGFyZ3VtZW50IG9mIHRoZSBjYWxsYmFjaywgYWx0ZXJuYXRpdmVseSBhbiBhcnJheSBvZiBhbGwgdGhlXG4gICAgICAgKiAgICAgICAgY2FsbGJhY2sgYXJndW1lbnRzIGlzIHJlc29sdmVkLiBCeSBkZWZhdWx0LCBpZiB0aGUgY2FsbGJhY2tcbiAgICAgICAqICAgICAgICBmdW5jdGlvbiBpcyBpbnZva2VkIHdpdGggb25seSBhIHNpbmdsZSBhcmd1bWVudCwgdGhhdCB3aWxsIGJlXG4gICAgICAgKiAgICAgICAgcmVzb2x2ZWQgdG8gdGhlIHByb21pc2UsIHdoaWxlIGFsbCBhcmd1bWVudHMgd2lsbCBiZSByZXNvbHZlZCBhc1xuICAgICAgICogICAgICAgIGFuIGFycmF5IGlmIG11bHRpcGxlIGFyZSBnaXZlbi5cbiAgICAgICAqXG4gICAgICAgKiBAcmV0dXJucyB7ZnVuY3Rpb259XG4gICAgICAgKiAgICAgICAgVGhlIGdlbmVyYXRlZCBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICAgICAqL1xuXG5cbiAgICAgIGNvbnN0IG1ha2VDYWxsYmFjayA9IChwcm9taXNlLCBtZXRhZGF0YSkgPT4ge1xuICAgICAgICByZXR1cm4gKC4uLmNhbGxiYWNrQXJncykgPT4ge1xuICAgICAgICAgIGlmIChleHRlbnNpb25BUElzLnJ1bnRpbWUubGFzdEVycm9yKSB7XG4gICAgICAgICAgICBwcm9taXNlLnJlamVjdChuZXcgRXJyb3IoZXh0ZW5zaW9uQVBJcy5ydW50aW1lLmxhc3RFcnJvci5tZXNzYWdlKSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRhZGF0YS5zaW5nbGVDYWxsYmFja0FyZyB8fCBjYWxsYmFja0FyZ3MubGVuZ3RoIDw9IDEgJiYgbWV0YWRhdGEuc2luZ2xlQ2FsbGJhY2tBcmcgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICBwcm9taXNlLnJlc29sdmUoY2FsbGJhY2tBcmdzWzBdKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJvbWlzZS5yZXNvbHZlKGNhbGxiYWNrQXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgY29uc3QgcGx1cmFsaXplQXJndW1lbnRzID0gbnVtQXJncyA9PiBudW1BcmdzID09IDEgPyBcImFyZ3VtZW50XCIgOiBcImFyZ3VtZW50c1wiO1xuICAgICAgLyoqXG4gICAgICAgKiBDcmVhdGVzIGEgd3JhcHBlciBmdW5jdGlvbiBmb3IgYSBtZXRob2Qgd2l0aCB0aGUgZ2l2ZW4gbmFtZSBhbmQgbWV0YWRhdGEuXG4gICAgICAgKlxuICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVcbiAgICAgICAqICAgICAgICBUaGUgbmFtZSBvZiB0aGUgbWV0aG9kIHdoaWNoIGlzIGJlaW5nIHdyYXBwZWQuXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gbWV0YWRhdGFcbiAgICAgICAqICAgICAgICBNZXRhZGF0YSBhYm91dCB0aGUgbWV0aG9kIGJlaW5nIHdyYXBwZWQuXG4gICAgICAgKiBAcGFyYW0ge2ludGVnZXJ9IG1ldGFkYXRhLm1pbkFyZ3NcbiAgICAgICAqICAgICAgICBUaGUgbWluaW11bSBudW1iZXIgb2YgYXJndW1lbnRzIHdoaWNoIG11c3QgYmUgcGFzc2VkIHRvIHRoZVxuICAgICAgICogICAgICAgIGZ1bmN0aW9uLiBJZiBjYWxsZWQgd2l0aCBmZXdlciB0aGFuIHRoaXMgbnVtYmVyIG9mIGFyZ3VtZW50cywgdGhlXG4gICAgICAgKiAgICAgICAgd3JhcHBlciB3aWxsIHJhaXNlIGFuIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7aW50ZWdlcn0gbWV0YWRhdGEubWF4QXJnc1xuICAgICAgICogICAgICAgIFRoZSBtYXhpbXVtIG51bWJlciBvZiBhcmd1bWVudHMgd2hpY2ggbWF5IGJlIHBhc3NlZCB0byB0aGVcbiAgICAgICAqICAgICAgICBmdW5jdGlvbi4gSWYgY2FsbGVkIHdpdGggbW9yZSB0aGFuIHRoaXMgbnVtYmVyIG9mIGFyZ3VtZW50cywgdGhlXG4gICAgICAgKiAgICAgICAgd3JhcHBlciB3aWxsIHJhaXNlIGFuIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbWV0YWRhdGEuc2luZ2xlQ2FsbGJhY2tBcmdcbiAgICAgICAqICAgICAgICBXaGV0aGVyIG9yIG5vdCB0aGUgcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIG9ubHkgdGhlIGZpcnN0XG4gICAgICAgKiAgICAgICAgYXJndW1lbnQgb2YgdGhlIGNhbGxiYWNrLCBhbHRlcm5hdGl2ZWx5IGFuIGFycmF5IG9mIGFsbCB0aGVcbiAgICAgICAqICAgICAgICBjYWxsYmFjayBhcmd1bWVudHMgaXMgcmVzb2x2ZWQuIEJ5IGRlZmF1bHQsIGlmIHRoZSBjYWxsYmFja1xuICAgICAgICogICAgICAgIGZ1bmN0aW9uIGlzIGludm9rZWQgd2l0aCBvbmx5IGEgc2luZ2xlIGFyZ3VtZW50LCB0aGF0IHdpbGwgYmVcbiAgICAgICAqICAgICAgICByZXNvbHZlZCB0byB0aGUgcHJvbWlzZSwgd2hpbGUgYWxsIGFyZ3VtZW50cyB3aWxsIGJlIHJlc29sdmVkIGFzXG4gICAgICAgKiAgICAgICAgYW4gYXJyYXkgaWYgbXVsdGlwbGUgYXJlIGdpdmVuLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtmdW5jdGlvbihvYmplY3QsIC4uLiopfVxuICAgICAgICogICAgICAgVGhlIGdlbmVyYXRlZCB3cmFwcGVyIGZ1bmN0aW9uLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3Qgd3JhcEFzeW5jRnVuY3Rpb24gPSAobmFtZSwgbWV0YWRhdGEpID0+IHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGFzeW5jRnVuY3Rpb25XcmFwcGVyKHRhcmdldCwgLi4uYXJncykge1xuICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IG1ldGFkYXRhLm1pbkFyZ3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgYXQgbGVhc3QgJHttZXRhZGF0YS5taW5BcmdzfSAke3BsdXJhbGl6ZUFyZ3VtZW50cyhtZXRhZGF0YS5taW5BcmdzKX0gZm9yICR7bmFtZX0oKSwgZ290ICR7YXJncy5sZW5ndGh9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gbWV0YWRhdGEubWF4QXJncykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBhdCBtb3N0ICR7bWV0YWRhdGEubWF4QXJnc30gJHtwbHVyYWxpemVBcmd1bWVudHMobWV0YWRhdGEubWF4QXJncyl9IGZvciAke25hbWV9KCksIGdvdCAke2FyZ3MubGVuZ3RofWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBpZiAobWV0YWRhdGEuZmFsbGJhY2tUb05vQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgLy8gVGhpcyBBUEkgbWV0aG9kIGhhcyBjdXJyZW50bHkgbm8gY2FsbGJhY2sgb24gQ2hyb21lLCBidXQgaXQgcmV0dXJuIGEgcHJvbWlzZSBvbiBGaXJlZm94LFxuICAgICAgICAgICAgICAvLyBhbmQgc28gdGhlIHBvbHlmaWxsIHdpbGwgdHJ5IHRvIGNhbGwgaXQgd2l0aCBhIGNhbGxiYWNrIGZpcnN0LCBhbmQgaXQgd2lsbCBmYWxsYmFja1xuICAgICAgICAgICAgICAvLyB0byBub3QgcGFzc2luZyB0aGUgY2FsbGJhY2sgaWYgdGhlIGZpcnN0IGNhbGwgZmFpbHMuXG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKC4uLmFyZ3MsIG1ha2VDYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgICByZXNvbHZlLFxuICAgICAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICAgICAgfSwgbWV0YWRhdGEpKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoY2JFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgJHtuYW1lfSBBUEkgbWV0aG9kIGRvZXNuJ3Qgc2VlbSB0byBzdXBwb3J0IHRoZSBjYWxsYmFjayBwYXJhbWV0ZXIsIGAgKyBcImZhbGxpbmcgYmFjayB0byBjYWxsIGl0IHdpdGhvdXQgYSBjYWxsYmFjazogXCIsIGNiRXJyb3IpO1xuICAgICAgICAgICAgICAgIHRhcmdldFtuYW1lXSguLi5hcmdzKTsgLy8gVXBkYXRlIHRoZSBBUEkgbWV0aG9kIG1ldGFkYXRhLCBzbyB0aGF0IHRoZSBuZXh0IEFQSSBjYWxscyB3aWxsIG5vdCB0cnkgdG9cbiAgICAgICAgICAgICAgICAvLyB1c2UgdGhlIHVuc3VwcG9ydGVkIGNhbGxiYWNrIGFueW1vcmUuXG5cbiAgICAgICAgICAgICAgICBtZXRhZGF0YS5mYWxsYmFja1RvTm9DYWxsYmFjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhLm5vQ2FsbGJhY2sgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChtZXRhZGF0YS5ub0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgIHRhcmdldFtuYW1lXSguLi5hcmdzKTtcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKC4uLmFyZ3MsIG1ha2VDYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICByZWplY3RcbiAgICAgICAgICAgICAgfSwgbWV0YWRhdGEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICAvKipcbiAgICAgICAqIFdyYXBzIGFuIGV4aXN0aW5nIG1ldGhvZCBvZiB0aGUgdGFyZ2V0IG9iamVjdCwgc28gdGhhdCBjYWxscyB0byBpdCBhcmVcbiAgICAgICAqIGludGVyY2VwdGVkIGJ5IHRoZSBnaXZlbiB3cmFwcGVyIGZ1bmN0aW9uLiBUaGUgd3JhcHBlciBmdW5jdGlvbiByZWNlaXZlcyxcbiAgICAgICAqIGFzIGl0cyBmaXJzdCBhcmd1bWVudCwgdGhlIG9yaWdpbmFsIGB0YXJnZXRgIG9iamVjdCwgZm9sbG93ZWQgYnkgZWFjaCBvZlxuICAgICAgICogdGhlIGFyZ3VtZW50cyBwYXNzZWQgdG8gdGhlIG9yaWdpbmFsIG1ldGhvZC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gdGFyZ2V0XG4gICAgICAgKiAgICAgICAgVGhlIG9yaWdpbmFsIHRhcmdldCBvYmplY3QgdGhhdCB0aGUgd3JhcHBlZCBtZXRob2QgYmVsb25ncyB0by5cbiAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1ldGhvZFxuICAgICAgICogICAgICAgIFRoZSBtZXRob2QgYmVpbmcgd3JhcHBlZC4gVGhpcyBpcyB1c2VkIGFzIHRoZSB0YXJnZXQgb2YgdGhlIFByb3h5XG4gICAgICAgKiAgICAgICAgb2JqZWN0IHdoaWNoIGlzIGNyZWF0ZWQgdG8gd3JhcCB0aGUgbWV0aG9kLlxuICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gd3JhcHBlclxuICAgICAgICogICAgICAgIFRoZSB3cmFwcGVyIGZ1bmN0aW9uIHdoaWNoIGlzIGNhbGxlZCBpbiBwbGFjZSBvZiBhIGRpcmVjdCBpbnZvY2F0aW9uXG4gICAgICAgKiAgICAgICAgb2YgdGhlIHdyYXBwZWQgbWV0aG9kLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtQcm94eTxmdW5jdGlvbj59XG4gICAgICAgKiAgICAgICAgQSBQcm94eSBvYmplY3QgZm9yIHRoZSBnaXZlbiBtZXRob2QsIHdoaWNoIGludm9rZXMgdGhlIGdpdmVuIHdyYXBwZXJcbiAgICAgICAqICAgICAgICBtZXRob2QgaW4gaXRzIHBsYWNlLlxuICAgICAgICovXG5cblxuICAgICAgY29uc3Qgd3JhcE1ldGhvZCA9ICh0YXJnZXQsIG1ldGhvZCwgd3JhcHBlcikgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb3h5KG1ldGhvZCwge1xuICAgICAgICAgIGFwcGx5KHRhcmdldE1ldGhvZCwgdGhpc09iaiwgYXJncykge1xuICAgICAgICAgICAgcmV0dXJuIHdyYXBwZXIuY2FsbCh0aGlzT2JqLCB0YXJnZXQsIC4uLmFyZ3MpO1xuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGxldCBoYXNPd25Qcm9wZXJ0eSA9IEZ1bmN0aW9uLmNhbGwuYmluZChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5KTtcbiAgICAgIC8qKlxuICAgICAgICogV3JhcHMgYW4gb2JqZWN0IGluIGEgUHJveHkgd2hpY2ggaW50ZXJjZXB0cyBhbmQgd3JhcHMgY2VydGFpbiBtZXRob2RzXG4gICAgICAgKiBiYXNlZCBvbiB0aGUgZ2l2ZW4gYHdyYXBwZXJzYCBhbmQgYG1ldGFkYXRhYCBvYmplY3RzLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSB0YXJnZXRcbiAgICAgICAqICAgICAgICBUaGUgdGFyZ2V0IG9iamVjdCB0byB3cmFwLlxuICAgICAgICpcbiAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbd3JhcHBlcnMgPSB7fV1cbiAgICAgICAqICAgICAgICBBbiBvYmplY3QgdHJlZSBjb250YWluaW5nIHdyYXBwZXIgZnVuY3Rpb25zIGZvciBzcGVjaWFsIGNhc2VzLiBBbnlcbiAgICAgICAqICAgICAgICBmdW5jdGlvbiBwcmVzZW50IGluIHRoaXMgb2JqZWN0IHRyZWUgaXMgY2FsbGVkIGluIHBsYWNlIG9mIHRoZVxuICAgICAgICogICAgICAgIG1ldGhvZCBpbiB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgYHRhcmdldGAgb2JqZWN0IHRyZWUuIFRoZXNlXG4gICAgICAgKiAgICAgICAgd3JhcHBlciBtZXRob2RzIGFyZSBpbnZva2VkIGFzIGRlc2NyaWJlZCBpbiB7QHNlZSB3cmFwTWV0aG9kfS5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge29iamVjdH0gW21ldGFkYXRhID0ge31dXG4gICAgICAgKiAgICAgICAgQW4gb2JqZWN0IHRyZWUgY29udGFpbmluZyBtZXRhZGF0YSB1c2VkIHRvIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVcbiAgICAgICAqICAgICAgICBQcm9taXNlLWJhc2VkIHdyYXBwZXIgZnVuY3Rpb25zIGZvciBhc3luY2hyb25vdXMuIEFueSBmdW5jdGlvbiBpblxuICAgICAgICogICAgICAgIHRoZSBgdGFyZ2V0YCBvYmplY3QgdHJlZSB3aGljaCBoYXMgYSBjb3JyZXNwb25kaW5nIG1ldGFkYXRhIG9iamVjdFxuICAgICAgICogICAgICAgIGluIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBgbWV0YWRhdGFgIHRyZWUgaXMgcmVwbGFjZWQgd2l0aCBhblxuICAgICAgICogICAgICAgIGF1dG9tYXRpY2FsbHktZ2VuZXJhdGVkIHdyYXBwZXIgZnVuY3Rpb24sIGFzIGRlc2NyaWJlZCBpblxuICAgICAgICogICAgICAgIHtAc2VlIHdyYXBBc3luY0Z1bmN0aW9ufVxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtQcm94eTxvYmplY3Q+fVxuICAgICAgICovXG5cbiAgICAgIGNvbnN0IHdyYXBPYmplY3QgPSAodGFyZ2V0LCB3cmFwcGVycyA9IHt9LCBtZXRhZGF0YSA9IHt9KSA9PiB7XG4gICAgICAgIGxldCBjYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIGxldCBoYW5kbGVycyA9IHtcbiAgICAgICAgICBoYXMocHJveHlUYXJnZXQsIHByb3ApIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wIGluIHRhcmdldCB8fCBwcm9wIGluIGNhY2hlO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBnZXQocHJveHlUYXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7XG4gICAgICAgICAgICBpZiAocHJvcCBpbiBjYWNoZSkge1xuICAgICAgICAgICAgICByZXR1cm4gY2FjaGVbcHJvcF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghKHByb3AgaW4gdGFyZ2V0KSkge1xuICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgdmFsdWUgPSB0YXJnZXRbcHJvcF07XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgbWV0aG9kIG9uIHRoZSB1bmRlcmx5aW5nIG9iamVjdC4gQ2hlY2sgaWYgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgICAvLyBhbnkgd3JhcHBpbmcuXG4gICAgICAgICAgICAgIGlmICh0eXBlb2Ygd3JhcHBlcnNbcHJvcF0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBzcGVjaWFsLWNhc2Ugd3JhcHBlciBmb3IgdGhpcyBtZXRob2QuXG4gICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwTWV0aG9kKHRhcmdldCwgdGFyZ2V0W3Byb3BdLCB3cmFwcGVyc1twcm9wXSk7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzT3duUHJvcGVydHkobWV0YWRhdGEsIHByb3ApKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhbiBhc3luYyBtZXRob2QgdGhhdCB3ZSBoYXZlIG1ldGFkYXRhIGZvci4gQ3JlYXRlIGFcbiAgICAgICAgICAgICAgICAvLyBQcm9taXNlIHdyYXBwZXIgZm9yIGl0LlxuICAgICAgICAgICAgICAgIGxldCB3cmFwcGVyID0gd3JhcEFzeW5jRnVuY3Rpb24ocHJvcCwgbWV0YWRhdGFbcHJvcF0pO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gd3JhcE1ldGhvZCh0YXJnZXQsIHRhcmdldFtwcm9wXSwgd3JhcHBlcik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIG1ldGhvZCB0aGF0IHdlIGRvbid0IGtub3cgb3IgY2FyZSBhYm91dC4gUmV0dXJuIHRoZVxuICAgICAgICAgICAgICAgIC8vIG9yaWdpbmFsIG1ldGhvZCwgYm91bmQgdG8gdGhlIHVuZGVybHlpbmcgb2JqZWN0LlxuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuYmluZCh0YXJnZXQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAoaGFzT3duUHJvcGVydHkod3JhcHBlcnMsIHByb3ApIHx8IGhhc093blByb3BlcnR5KG1ldGFkYXRhLCBwcm9wKSkpIHtcbiAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhbiBvYmplY3QgdGhhdCB3ZSBuZWVkIHRvIGRvIHNvbWUgd3JhcHBpbmcgZm9yIHRoZSBjaGlsZHJlblxuICAgICAgICAgICAgICAvLyBvZi4gQ3JlYXRlIGEgc3ViLW9iamVjdCB3cmFwcGVyIGZvciBpdCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBjaGlsZFxuICAgICAgICAgICAgICAvLyBtZXRhZGF0YS5cbiAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwT2JqZWN0KHZhbHVlLCB3cmFwcGVyc1twcm9wXSwgbWV0YWRhdGFbcHJvcF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNPd25Qcm9wZXJ0eShtZXRhZGF0YSwgXCIqXCIpKSB7XG4gICAgICAgICAgICAgIC8vIFdyYXAgYWxsIHByb3BlcnRpZXMgaW4gKiBuYW1lc3BhY2UuXG4gICAgICAgICAgICAgIHZhbHVlID0gd3JhcE9iamVjdCh2YWx1ZSwgd3JhcHBlcnNbcHJvcF0sIG1ldGFkYXRhW1wiKlwiXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGRvIGFueSB3cmFwcGluZyBmb3IgdGhpcyBwcm9wZXJ0eSxcbiAgICAgICAgICAgICAgLy8gc28ganVzdCBmb3J3YXJkIGFsbCBhY2Nlc3MgdG8gdGhlIHVuZGVybHlpbmcgb2JqZWN0LlxuICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2FjaGUsIHByb3AsIHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcblxuICAgICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbcHJvcF07XG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhY2hlW3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIHNldChwcm94eVRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKSB7XG4gICAgICAgICAgICBpZiAocHJvcCBpbiBjYWNoZSkge1xuICAgICAgICAgICAgICBjYWNoZVtwcm9wXSA9IHZhbHVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBkZWZpbmVQcm9wZXJ0eShwcm94eVRhcmdldCwgcHJvcCwgZGVzYykge1xuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoY2FjaGUsIHByb3AsIGRlc2MpO1xuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBkZWxldGVQcm9wZXJ0eShwcm94eVRhcmdldCwgcHJvcCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3QuZGVsZXRlUHJvcGVydHkoY2FjaGUsIHByb3ApO1xuICAgICAgICAgIH1cblxuICAgICAgICB9OyAvLyBQZXIgY29udHJhY3Qgb2YgdGhlIFByb3h5IEFQSSwgdGhlIFwiZ2V0XCIgcHJveHkgaGFuZGxlciBtdXN0IHJldHVybiB0aGVcbiAgICAgICAgLy8gb3JpZ2luYWwgdmFsdWUgb2YgdGhlIHRhcmdldCBpZiB0aGF0IHZhbHVlIGlzIGRlY2xhcmVkIHJlYWQtb25seSBhbmRcbiAgICAgICAgLy8gbm9uLWNvbmZpZ3VyYWJsZS4gRm9yIHRoaXMgcmVhc29uLCB3ZSBjcmVhdGUgYW4gb2JqZWN0IHdpdGggdGhlXG4gICAgICAgIC8vIHByb3RvdHlwZSBzZXQgdG8gYHRhcmdldGAgaW5zdGVhZCBvZiB1c2luZyBgdGFyZ2V0YCBkaXJlY3RseS5cbiAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIGNhbm5vdCByZXR1cm4gYSBjdXN0b20gb2JqZWN0IGZvciBBUElzIHRoYXRcbiAgICAgICAgLy8gYXJlIGRlY2xhcmVkIHJlYWQtb25seSBhbmQgbm9uLWNvbmZpZ3VyYWJsZSwgc3VjaCBhcyBgY2hyb21lLmRldnRvb2xzYC5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gVGhlIHByb3h5IGhhbmRsZXJzIHRoZW1zZWx2ZXMgd2lsbCBzdGlsbCB1c2UgdGhlIG9yaWdpbmFsIGB0YXJnZXRgXG4gICAgICAgIC8vIGluc3RlYWQgb2YgdGhlIGBwcm94eVRhcmdldGAsIHNvIHRoYXQgdGhlIG1ldGhvZHMgYW5kIHByb3BlcnRpZXMgYXJlXG4gICAgICAgIC8vIGRlcmVmZXJlbmNlZCB2aWEgdGhlIG9yaWdpbmFsIHRhcmdldHMuXG5cbiAgICAgICAgbGV0IHByb3h5VGFyZ2V0ID0gT2JqZWN0LmNyZWF0ZSh0YXJnZXQpO1xuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHByb3h5VGFyZ2V0LCBoYW5kbGVycyk7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBDcmVhdGVzIGEgc2V0IG9mIHdyYXBwZXIgZnVuY3Rpb25zIGZvciBhbiBldmVudCBvYmplY3QsIHdoaWNoIGhhbmRsZXNcbiAgICAgICAqIHdyYXBwaW5nIG9mIGxpc3RlbmVyIGZ1bmN0aW9ucyB0aGF0IHRob3NlIG1lc3NhZ2VzIGFyZSBwYXNzZWQuXG4gICAgICAgKlxuICAgICAgICogQSBzaW5nbGUgd3JhcHBlciBpcyBjcmVhdGVkIGZvciBlYWNoIGxpc3RlbmVyIGZ1bmN0aW9uLCBhbmQgc3RvcmVkIGluIGFcbiAgICAgICAqIG1hcC4gU3Vic2VxdWVudCBjYWxscyB0byBgYWRkTGlzdGVuZXJgLCBgaGFzTGlzdGVuZXJgLCBvciBgcmVtb3ZlTGlzdGVuZXJgXG4gICAgICAgKiByZXRyaWV2ZSB0aGUgb3JpZ2luYWwgd3JhcHBlciwgc28gdGhhdCAgYXR0ZW1wdHMgdG8gcmVtb3ZlIGFcbiAgICAgICAqIHByZXZpb3VzbHktYWRkZWQgbGlzdGVuZXIgd29yayBhcyBleHBlY3RlZC5cbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0ge0RlZmF1bHRXZWFrTWFwPGZ1bmN0aW9uLCBmdW5jdGlvbj59IHdyYXBwZXJNYXBcbiAgICAgICAqICAgICAgICBBIERlZmF1bHRXZWFrTWFwIG9iamVjdCB3aGljaCB3aWxsIGNyZWF0ZSB0aGUgYXBwcm9wcmlhdGUgd3JhcHBlclxuICAgICAgICogICAgICAgIGZvciBhIGdpdmVuIGxpc3RlbmVyIGZ1bmN0aW9uIHdoZW4gb25lIGRvZXMgbm90IGV4aXN0LCBhbmQgcmV0cmlldmVcbiAgICAgICAqICAgICAgICBhbiBleGlzdGluZyBvbmUgd2hlbiBpdCBkb2VzLlxuICAgICAgICpcbiAgICAgICAqIEByZXR1cm5zIHtvYmplY3R9XG4gICAgICAgKi9cblxuXG4gICAgICBjb25zdCB3cmFwRXZlbnQgPSB3cmFwcGVyTWFwID0+ICh7XG4gICAgICAgIGFkZExpc3RlbmVyKHRhcmdldCwgbGlzdGVuZXIsIC4uLmFyZ3MpIHtcbiAgICAgICAgICB0YXJnZXQuYWRkTGlzdGVuZXIod3JhcHBlck1hcC5nZXQobGlzdGVuZXIpLCAuLi5hcmdzKTtcbiAgICAgICAgfSxcblxuICAgICAgICBoYXNMaXN0ZW5lcih0YXJnZXQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgcmV0dXJuIHRhcmdldC5oYXNMaXN0ZW5lcih3cmFwcGVyTWFwLmdldChsaXN0ZW5lcikpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKHRhcmdldCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICB0YXJnZXQucmVtb3ZlTGlzdGVuZXIod3JhcHBlck1hcC5nZXQobGlzdGVuZXIpKTtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgb25SZXF1ZXN0RmluaXNoZWRXcmFwcGVycyA9IG5ldyBEZWZhdWx0V2Vha01hcChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogV3JhcHMgYW4gb25SZXF1ZXN0RmluaXNoZWQgbGlzdGVuZXIgZnVuY3Rpb24gc28gdGhhdCBpdCB3aWxsIHJldHVybiBhXG4gICAgICAgICAqIGBnZXRDb250ZW50KClgIHByb3BlcnR5IHdoaWNoIHJldHVybnMgYSBgUHJvbWlzZWAgcmF0aGVyIHRoYW4gdXNpbmcgYVxuICAgICAgICAgKiBjYWxsYmFjayBBUEkuXG4gICAgICAgICAqXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSByZXFcbiAgICAgICAgICogICAgICAgIFRoZSBIQVIgZW50cnkgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgbmV0d29yayByZXF1ZXN0LlxuICAgICAgICAgKi9cblxuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBvblJlcXVlc3RGaW5pc2hlZChyZXEpIHtcbiAgICAgICAgICBjb25zdCB3cmFwcGVkUmVxID0gd3JhcE9iamVjdChyZXEsIHt9XG4gICAgICAgICAgLyogd3JhcHBlcnMgKi9cbiAgICAgICAgICAsIHtcbiAgICAgICAgICAgIGdldENvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgbWluQXJnczogMCxcbiAgICAgICAgICAgICAgbWF4QXJnczogMFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGxpc3RlbmVyKHdyYXBwZWRSZXEpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBjb25zdCBvbk1lc3NhZ2VXcmFwcGVycyA9IG5ldyBEZWZhdWx0V2Vha01hcChsaXN0ZW5lciA9PiB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogV3JhcHMgYSBtZXNzYWdlIGxpc3RlbmVyIGZ1bmN0aW9uIHNvIHRoYXQgaXQgbWF5IHNlbmQgcmVzcG9uc2VzIGJhc2VkIG9uXG4gICAgICAgICAqIGl0cyByZXR1cm4gdmFsdWUsIHJhdGhlciB0aGFuIGJ5IHJldHVybmluZyBhIHNlbnRpbmVsIHZhbHVlIGFuZCBjYWxsaW5nIGFcbiAgICAgICAgICogY2FsbGJhY2suIElmIHRoZSBsaXN0ZW5lciBmdW5jdGlvbiByZXR1cm5zIGEgUHJvbWlzZSwgdGhlIHJlc3BvbnNlIGlzXG4gICAgICAgICAqIHNlbnQgd2hlbiB0aGUgcHJvbWlzZSBlaXRoZXIgcmVzb2x2ZXMgb3IgcmVqZWN0cy5cbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHsqfSBtZXNzYWdlXG4gICAgICAgICAqICAgICAgICBUaGUgbWVzc2FnZSBzZW50IGJ5IHRoZSBvdGhlciBlbmQgb2YgdGhlIGNoYW5uZWwuXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBzZW5kZXJcbiAgICAgICAgICogICAgICAgIERldGFpbHMgYWJvdXQgdGhlIHNlbmRlciBvZiB0aGUgbWVzc2FnZS5cbiAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbigqKX0gc2VuZFJlc3BvbnNlXG4gICAgICAgICAqICAgICAgICBBIGNhbGxiYWNrIHdoaWNoLCB3aGVuIGNhbGxlZCB3aXRoIGFuIGFyYml0cmFyeSBhcmd1bWVudCwgc2VuZHNcbiAgICAgICAgICogICAgICAgIHRoYXQgdmFsdWUgYXMgYSByZXNwb25zZS5cbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqICAgICAgICBUcnVlIGlmIHRoZSB3cmFwcGVkIGxpc3RlbmVyIHJldHVybmVkIGEgUHJvbWlzZSwgd2hpY2ggd2lsbCBsYXRlclxuICAgICAgICAgKiAgICAgICAgeWllbGQgYSByZXNwb25zZS4gRmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAgICAgKi9cblxuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBvbk1lc3NhZ2UobWVzc2FnZSwgc2VuZGVyLCBzZW5kUmVzcG9uc2UpIHtcbiAgICAgICAgICBsZXQgZGlkQ2FsbFNlbmRSZXNwb25zZSA9IGZhbHNlO1xuICAgICAgICAgIGxldCB3cmFwcGVkU2VuZFJlc3BvbnNlO1xuICAgICAgICAgIGxldCBzZW5kUmVzcG9uc2VQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICB3cmFwcGVkU2VuZFJlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIGRpZENhbGxTZW5kUmVzcG9uc2UgPSB0cnVlO1xuICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgbGV0IHJlc3VsdDtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXN1bHQgPSBsaXN0ZW5lcihtZXNzYWdlLCBzZW5kZXIsIHdyYXBwZWRTZW5kUmVzcG9uc2UpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVzdWx0ID0gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBpc1Jlc3VsdFRoZW5hYmxlID0gcmVzdWx0ICE9PSB0cnVlICYmIGlzVGhlbmFibGUocmVzdWx0KTsgLy8gSWYgdGhlIGxpc3RlbmVyIGRpZG4ndCByZXR1cm5lZCB0cnVlIG9yIGEgUHJvbWlzZSwgb3IgY2FsbGVkXG4gICAgICAgICAgLy8gd3JhcHBlZFNlbmRSZXNwb25zZSBzeW5jaHJvbm91c2x5LCB3ZSBjYW4gZXhpdCBlYXJsaWVyXG4gICAgICAgICAgLy8gYmVjYXVzZSB0aGVyZSB3aWxsIGJlIG5vIHJlc3BvbnNlIHNlbnQgZnJvbSB0aGlzIGxpc3RlbmVyLlxuXG4gICAgICAgICAgaWYgKHJlc3VsdCAhPT0gdHJ1ZSAmJiAhaXNSZXN1bHRUaGVuYWJsZSAmJiAhZGlkQ2FsbFNlbmRSZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0gLy8gQSBzbWFsbCBoZWxwZXIgdG8gc2VuZCB0aGUgbWVzc2FnZSBpZiB0aGUgcHJvbWlzZSByZXNvbHZlc1xuICAgICAgICAgIC8vIGFuZCBhbiBlcnJvciBpZiB0aGUgcHJvbWlzZSByZWplY3RzIChhIHdyYXBwZWQgc2VuZE1lc3NhZ2UgaGFzXG4gICAgICAgICAgLy8gdG8gdHJhbnNsYXRlIHRoZSBtZXNzYWdlIGludG8gYSByZXNvbHZlZCBwcm9taXNlIG9yIGEgcmVqZWN0ZWRcbiAgICAgICAgICAvLyBwcm9taXNlKS5cblxuXG4gICAgICAgICAgY29uc3Qgc2VuZFByb21pc2VkUmVzdWx0ID0gcHJvbWlzZSA9PiB7XG4gICAgICAgICAgICBwcm9taXNlLnRoZW4obXNnID0+IHtcbiAgICAgICAgICAgICAgLy8gc2VuZCB0aGUgbWVzc2FnZSB2YWx1ZS5cbiAgICAgICAgICAgICAgc2VuZFJlc3BvbnNlKG1zZyk7XG4gICAgICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgICAgIC8vIFNlbmQgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBlcnJvciBpZiB0aGUgcmVqZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgLy8gaXMgYW4gaW5zdGFuY2Ugb2YgZXJyb3IsIG9yIHRoZSBvYmplY3QgaXRzZWxmIG90aGVyd2lzZS5cbiAgICAgICAgICAgICAgbGV0IG1lc3NhZ2U7XG5cbiAgICAgICAgICAgICAgaWYgKGVycm9yICYmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yIHx8IHR5cGVvZiBlcnJvci5tZXNzYWdlID09PSBcInN0cmluZ1wiKSkge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBcIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWRcIjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7XG4gICAgICAgICAgICAgICAgX19tb3pXZWJFeHRlbnNpb25Qb2x5ZmlsbFJlamVjdF9fOiB0cnVlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgICAgICAvLyBQcmludCBhbiBlcnJvciBvbiB0aGUgY29uc29sZSBpZiB1bmFibGUgdG8gc2VuZCB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc2VuZCBvbk1lc3NhZ2UgcmVqZWN0ZWQgcmVwbHlcIiwgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07IC8vIElmIHRoZSBsaXN0ZW5lciByZXR1cm5lZCBhIFByb21pc2UsIHNlbmQgdGhlIHJlc29sdmVkIHZhbHVlIGFzIGFcbiAgICAgICAgICAvLyByZXN1bHQsIG90aGVyd2lzZSB3YWl0IHRoZSBwcm9taXNlIHJlbGF0ZWQgdG8gdGhlIHdyYXBwZWRTZW5kUmVzcG9uc2VcbiAgICAgICAgICAvLyBjYWxsYmFjayB0byByZXNvbHZlIGFuZCBzZW5kIGl0IGFzIGEgcmVzcG9uc2UuXG5cblxuICAgICAgICAgIGlmIChpc1Jlc3VsdFRoZW5hYmxlKSB7XG4gICAgICAgICAgICBzZW5kUHJvbWlzZWRSZXN1bHQocmVzdWx0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VuZFByb21pc2VkUmVzdWx0KHNlbmRSZXNwb25zZVByb21pc2UpO1xuICAgICAgICAgIH0gLy8gTGV0IENocm9tZSBrbm93IHRoYXQgdGhlIGxpc3RlbmVyIGlzIHJlcGx5aW5nLlxuXG5cbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB3cmFwcGVkU2VuZE1lc3NhZ2VDYWxsYmFjayA9ICh7XG4gICAgICAgIHJlamVjdCxcbiAgICAgICAgcmVzb2x2ZVxuICAgICAgfSwgcmVwbHkpID0+IHtcbiAgICAgICAgaWYgKGV4dGVuc2lvbkFQSXMucnVudGltZS5sYXN0RXJyb3IpIHtcbiAgICAgICAgICAvLyBEZXRlY3Qgd2hlbiBub25lIG9mIHRoZSBsaXN0ZW5lcnMgcmVwbGllZCB0byB0aGUgc2VuZE1lc3NhZ2UgY2FsbCBhbmQgcmVzb2x2ZVxuICAgICAgICAgIC8vIHRoZSBwcm9taXNlIHRvIHVuZGVmaW5lZCBhcyBpbiBGaXJlZm94LlxuICAgICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbW96aWxsYS93ZWJleHRlbnNpb24tcG9seWZpbGwvaXNzdWVzLzEzMFxuICAgICAgICAgIGlmIChleHRlbnNpb25BUElzLnJ1bnRpbWUubGFzdEVycm9yLm1lc3NhZ2UgPT09IENIUk9NRV9TRU5EX01FU1NBR0VfQ0FMTEJBQ0tfTk9fUkVTUE9OU0VfTUVTU0FHRSkge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGV4dGVuc2lvbkFQSXMucnVudGltZS5sYXN0RXJyb3IubWVzc2FnZSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChyZXBseSAmJiByZXBseS5fX21veldlYkV4dGVuc2lvblBvbHlmaWxsUmVqZWN0X18pIHtcbiAgICAgICAgICAvLyBDb252ZXJ0IGJhY2sgdGhlIEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhlIGVycm9yIGludG9cbiAgICAgICAgICAvLyBhbiBFcnJvciBpbnN0YW5jZS5cbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKHJlcGx5Lm1lc3NhZ2UpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKHJlcGx5KTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3Qgd3JhcHBlZFNlbmRNZXNzYWdlID0gKG5hbWUsIG1ldGFkYXRhLCBhcGlOYW1lc3BhY2VPYmosIC4uLmFyZ3MpID0+IHtcbiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoIDwgbWV0YWRhdGEubWluQXJncykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgYXQgbGVhc3QgJHttZXRhZGF0YS5taW5BcmdzfSAke3BsdXJhbGl6ZUFyZ3VtZW50cyhtZXRhZGF0YS5taW5BcmdzKX0gZm9yICR7bmFtZX0oKSwgZ290ICR7YXJncy5sZW5ndGh9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiBtZXRhZGF0YS5tYXhBcmdzKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3RlZCBhdCBtb3N0ICR7bWV0YWRhdGEubWF4QXJnc30gJHtwbHVyYWxpemVBcmd1bWVudHMobWV0YWRhdGEubWF4QXJncyl9IGZvciAke25hbWV9KCksIGdvdCAke2FyZ3MubGVuZ3RofWApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICBjb25zdCB3cmFwcGVkQ2IgPSB3cmFwcGVkU2VuZE1lc3NhZ2VDYWxsYmFjay5iaW5kKG51bGwsIHtcbiAgICAgICAgICAgIHJlc29sdmUsXG4gICAgICAgICAgICByZWplY3RcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhcmdzLnB1c2god3JhcHBlZENiKTtcbiAgICAgICAgICBhcGlOYW1lc3BhY2VPYmouc2VuZE1lc3NhZ2UoLi4uYXJncyk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgY29uc3Qgc3RhdGljV3JhcHBlcnMgPSB7XG4gICAgICAgIGRldnRvb2xzOiB7XG4gICAgICAgICAgbmV0d29yazoge1xuICAgICAgICAgICAgb25SZXF1ZXN0RmluaXNoZWQ6IHdyYXBFdmVudChvblJlcXVlc3RGaW5pc2hlZFdyYXBwZXJzKVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcnVudGltZToge1xuICAgICAgICAgIG9uTWVzc2FnZTogd3JhcEV2ZW50KG9uTWVzc2FnZVdyYXBwZXJzKSxcbiAgICAgICAgICBvbk1lc3NhZ2VFeHRlcm5hbDogd3JhcEV2ZW50KG9uTWVzc2FnZVdyYXBwZXJzKSxcbiAgICAgICAgICBzZW5kTWVzc2FnZTogd3JhcHBlZFNlbmRNZXNzYWdlLmJpbmQobnVsbCwgXCJzZW5kTWVzc2FnZVwiLCB7XG4gICAgICAgICAgICBtaW5BcmdzOiAxLFxuICAgICAgICAgICAgbWF4QXJnczogM1xuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHRhYnM6IHtcbiAgICAgICAgICBzZW5kTWVzc2FnZTogd3JhcHBlZFNlbmRNZXNzYWdlLmJpbmQobnVsbCwgXCJzZW5kTWVzc2FnZVwiLCB7XG4gICAgICAgICAgICBtaW5BcmdzOiAyLFxuICAgICAgICAgICAgbWF4QXJnczogM1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCBzZXR0aW5nTWV0YWRhdGEgPSB7XG4gICAgICAgIGNsZWFyOiB7XG4gICAgICAgICAgbWluQXJnczogMSxcbiAgICAgICAgICBtYXhBcmdzOiAxXG4gICAgICAgIH0sXG4gICAgICAgIGdldDoge1xuICAgICAgICAgIG1pbkFyZ3M6IDEsXG4gICAgICAgICAgbWF4QXJnczogMVxuICAgICAgICB9LFxuICAgICAgICBzZXQ6IHtcbiAgICAgICAgICBtaW5BcmdzOiAxLFxuICAgICAgICAgIG1heEFyZ3M6IDFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGFwaU1ldGFkYXRhLnByaXZhY3kgPSB7XG4gICAgICAgIG5ldHdvcms6IHtcbiAgICAgICAgICBcIipcIjogc2V0dGluZ01ldGFkYXRhXG4gICAgICAgIH0sXG4gICAgICAgIHNlcnZpY2VzOiB7XG4gICAgICAgICAgXCIqXCI6IHNldHRpbmdNZXRhZGF0YVxuICAgICAgICB9LFxuICAgICAgICB3ZWJzaXRlczoge1xuICAgICAgICAgIFwiKlwiOiBzZXR0aW5nTWV0YWRhdGFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHJldHVybiB3cmFwT2JqZWN0KGV4dGVuc2lvbkFQSXMsIHN0YXRpY1dyYXBwZXJzLCBhcGlNZXRhZGF0YSk7XG4gICAgfTsgLy8gVGhlIGJ1aWxkIHByb2Nlc3MgYWRkcyBhIFVNRCB3cmFwcGVyIGFyb3VuZCB0aGlzIGZpbGUsIHdoaWNoIG1ha2VzIHRoZVxuICAgIC8vIGBtb2R1bGVgIHZhcmlhYmxlIGF2YWlsYWJsZS5cblxuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSB3cmFwQVBJcyhjaHJvbWUpO1xuICB9IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZ2xvYmFsVGhpcy5icm93c2VyO1xuICB9XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJyb3dzZXItcG9seWZpbGwuanMubWFwXG4iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cblxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXG5cblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSwgU3VwcHJlc3NlZEVycm9yLCBTeW1ib2wgKi9cblxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XG4gIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XG4gIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59XG5cbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcbiAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcbiAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0O1xuICB9XG4gIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcbiAgdmFyIHQgPSB7fTtcbiAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXG4gICAgICB0W3BdID0gc1twXTtcbiAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxuICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcbiAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XG4gICAgICB9XG4gIHJldHVybiB0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2VzRGVjb3JhdGUoY3RvciwgZGVzY3JpcHRvckluLCBkZWNvcmF0b3JzLCBjb250ZXh0SW4sIGluaXRpYWxpemVycywgZXh0cmFJbml0aWFsaXplcnMpIHtcbiAgZnVuY3Rpb24gYWNjZXB0KGYpIHsgaWYgKGYgIT09IHZvaWQgMCAmJiB0eXBlb2YgZiAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRnVuY3Rpb24gZXhwZWN0ZWRcIik7IHJldHVybiBmOyB9XG4gIHZhciBraW5kID0gY29udGV4dEluLmtpbmQsIGtleSA9IGtpbmQgPT09IFwiZ2V0dGVyXCIgPyBcImdldFwiIDoga2luZCA9PT0gXCJzZXR0ZXJcIiA/IFwic2V0XCIgOiBcInZhbHVlXCI7XG4gIHZhciB0YXJnZXQgPSAhZGVzY3JpcHRvckluICYmIGN0b3IgPyBjb250ZXh0SW5bXCJzdGF0aWNcIl0gPyBjdG9yIDogY3Rvci5wcm90b3R5cGUgOiBudWxsO1xuICB2YXIgZGVzY3JpcHRvciA9IGRlc2NyaXB0b3JJbiB8fCAodGFyZ2V0ID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGNvbnRleHRJbi5uYW1lKSA6IHt9KTtcbiAgdmFyIF8sIGRvbmUgPSBmYWxzZTtcbiAgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHZhciBjb250ZXh0ID0ge307XG4gICAgICBmb3IgKHZhciBwIGluIGNvbnRleHRJbikgY29udGV4dFtwXSA9IHAgPT09IFwiYWNjZXNzXCIgPyB7fSA6IGNvbnRleHRJbltwXTtcbiAgICAgIGZvciAodmFyIHAgaW4gY29udGV4dEluLmFjY2VzcykgY29udGV4dC5hY2Nlc3NbcF0gPSBjb250ZXh0SW4uYWNjZXNzW3BdO1xuICAgICAgY29udGV4dC5hZGRJbml0aWFsaXplciA9IGZ1bmN0aW9uIChmKSB7IGlmIChkb25lKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGFkZCBpbml0aWFsaXplcnMgYWZ0ZXIgZGVjb3JhdGlvbiBoYXMgY29tcGxldGVkXCIpOyBleHRyYUluaXRpYWxpemVycy5wdXNoKGFjY2VwdChmIHx8IG51bGwpKTsgfTtcbiAgICAgIHZhciByZXN1bHQgPSAoMCwgZGVjb3JhdG9yc1tpXSkoa2luZCA9PT0gXCJhY2Nlc3NvclwiID8geyBnZXQ6IGRlc2NyaXB0b3IuZ2V0LCBzZXQ6IGRlc2NyaXB0b3Iuc2V0IH0gOiBkZXNjcmlwdG9yW2tleV0sIGNvbnRleHQpO1xuICAgICAgaWYgKGtpbmQgPT09IFwiYWNjZXNzb3JcIikge1xuICAgICAgICAgIGlmIChyZXN1bHQgPT09IHZvaWQgMCkgY29udGludWU7XG4gICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCB8fCB0eXBlb2YgcmVzdWx0ICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JqZWN0IGV4cGVjdGVkXCIpO1xuICAgICAgICAgIGlmIChfID0gYWNjZXB0KHJlc3VsdC5nZXQpKSBkZXNjcmlwdG9yLmdldCA9IF87XG4gICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LnNldCkpIGRlc2NyaXB0b3Iuc2V0ID0gXztcbiAgICAgICAgICBpZiAoXyA9IGFjY2VwdChyZXN1bHQuaW5pdCkpIGluaXRpYWxpemVycy51bnNoaWZ0KF8pO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoXyA9IGFjY2VwdChyZXN1bHQpKSB7XG4gICAgICAgICAgaWYgKGtpbmQgPT09IFwiZmllbGRcIikgaW5pdGlhbGl6ZXJzLnVuc2hpZnQoXyk7XG4gICAgICAgICAgZWxzZSBkZXNjcmlwdG9yW2tleV0gPSBfO1xuICAgICAgfVxuICB9XG4gIGlmICh0YXJnZXQpIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGNvbnRleHRJbi5uYW1lLCBkZXNjcmlwdG9yKTtcbiAgZG9uZSA9IHRydWU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19ydW5Jbml0aWFsaXplcnModGhpc0FyZywgaW5pdGlhbGl6ZXJzLCB2YWx1ZSkge1xuICB2YXIgdXNlVmFsdWUgPSBhcmd1bWVudHMubGVuZ3RoID4gMjtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbml0aWFsaXplcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhbHVlID0gdXNlVmFsdWUgPyBpbml0aWFsaXplcnNbaV0uY2FsbCh0aGlzQXJnLCB2YWx1ZSkgOiBpbml0aWFsaXplcnNbaV0uY2FsbCh0aGlzQXJnKTtcbiAgfVxuICByZXR1cm4gdXNlVmFsdWUgPyB2YWx1ZSA6IHZvaWQgMDtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3Byb3BLZXkoeCkge1xuICByZXR1cm4gdHlwZW9mIHggPT09IFwic3ltYm9sXCIgPyB4IDogXCJcIi5jb25jYXQoeCk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19zZXRGdW5jdGlvbk5hbWUoZiwgbmFtZSwgcHJlZml4KSB7XG4gIGlmICh0eXBlb2YgbmFtZSA9PT0gXCJzeW1ib2xcIikgbmFtZSA9IG5hbWUuZGVzY3JpcHRpb24gPyBcIltcIi5jb25jYXQobmFtZS5kZXNjcmlwdGlvbiwgXCJdXCIpIDogXCJcIjtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmLCBcIm5hbWVcIiwgeyBjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiBwcmVmaXggPyBcIlwiLmNvbmNhdChwcmVmaXgsIFwiIFwiLCBuYW1lKSA6IG5hbWUgfSk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xuICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xuICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xuICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gIGZ1bmN0aW9uIHN0ZXAob3ApIHtcbiAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgIHdoaWxlIChnICYmIChnID0gMCwgb3BbMF0gJiYgKF8gPSAwKSksIF8pIHRyeSB7XG4gICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcbiAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xuICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XG4gICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgfVxufVxuXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xuICBpZiAoIWRlc2MgfHwgKFwiZ2V0XCIgaW4gZGVzYyA/ICFtLl9fZXNNb2R1bGUgOiBkZXNjLndyaXRhYmxlIHx8IGRlc2MuY29uZmlndXJhYmxlKSkge1xuICAgICAgZGVzYyA9IHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfTtcbiAgfVxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIGRlc2MpO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgb1trMl0gPSBtW2tdO1xufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xuICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSBfX2NyZWF0ZUJpbmRpbmcobywgbSwgcCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XG4gIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7XG4gIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xuICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XG4gICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcbiAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XG4gICAgICB9XG4gIH07XG4gIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XG4gIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcbiAgaWYgKCFtKSByZXR1cm4gbztcbiAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XG4gIHRyeSB7XG4gICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcbiAgfVxuICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cbiAgZmluYWxseSB7XG4gICAgICB0cnkge1xuICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xuICAgICAgfVxuICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XG4gIH1cbiAgcmV0dXJuIGFyO1xufVxuXG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcbiAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXG4gICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XG4gIHJldHVybiBhcjtcbn1cblxuLyoqIEBkZXByZWNhdGVkICovXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XG4gIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xuICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXG4gICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcbiAgICAgICAgICByW2tdID0gYVtqXTtcbiAgcmV0dXJuIHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tLCBwYWNrKSB7XG4gIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICB9XG4gIH1cbiAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcbiAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xuICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xuICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xuICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XG4gIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxuICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XG4gIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxuICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XG4gIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cbiAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XG4gIHZhciBpLCBwO1xuICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xuICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBmYWxzZSB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XG4gIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG4gIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XG4gIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcbiAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxuICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xuICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxuICByZXR1cm4gY29va2VkO1xufTtcblxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgb1tcImRlZmF1bHRcIl0gPSB2O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcbiAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcbiAgdmFyIHJlc3VsdCA9IHt9O1xuICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XG4gIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XG4gIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xuICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBnZXR0ZXJcIik7XG4gIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xuICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZFNldChyZWNlaXZlciwgc3RhdGUsIHZhbHVlLCBraW5kLCBmKSB7XG4gIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcbiAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xuICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB3cml0ZSBwcml2YXRlIG1lbWJlciB0byBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xuICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRJbihzdGF0ZSwgcmVjZWl2ZXIpIHtcbiAgaWYgKHJlY2VpdmVyID09PSBudWxsIHx8ICh0eXBlb2YgcmVjZWl2ZXIgIT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHJlY2VpdmVyICE9PSBcImZ1bmN0aW9uXCIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHVzZSAnaW4nIG9wZXJhdG9yIG9uIG5vbi1vYmplY3RcIik7XG4gIHJldHVybiB0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyID09PSBzdGF0ZSA6IHN0YXRlLmhhcyhyZWNlaXZlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2FkZERpc3Bvc2FibGVSZXNvdXJjZShlbnYsIHZhbHVlLCBhc3luYykge1xuICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHZvaWQgMCkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJPYmplY3QgZXhwZWN0ZWQuXCIpO1xuICAgIHZhciBkaXNwb3NlO1xuICAgIGlmIChhc3luYykge1xuICAgICAgICBpZiAoIVN5bWJvbC5hc3luY0Rpc3Bvc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNEaXNwb3NlIGlzIG5vdCBkZWZpbmVkLlwiKTtcbiAgICAgICAgZGlzcG9zZSA9IHZhbHVlW1N5bWJvbC5hc3luY0Rpc3Bvc2VdO1xuICAgIH1cbiAgICBpZiAoZGlzcG9zZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGlmICghU3ltYm9sLmRpc3Bvc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuZGlzcG9zZSBpcyBub3QgZGVmaW5lZC5cIik7XG4gICAgICAgIGRpc3Bvc2UgPSB2YWx1ZVtTeW1ib2wuZGlzcG9zZV07XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZGlzcG9zZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JqZWN0IG5vdCBkaXNwb3NhYmxlLlwiKTtcbiAgICBlbnYuc3RhY2sucHVzaCh7IHZhbHVlOiB2YWx1ZSwgZGlzcG9zZTogZGlzcG9zZSwgYXN5bmM6IGFzeW5jIH0pO1xuICB9XG4gIGVsc2UgaWYgKGFzeW5jKSB7XG4gICAgZW52LnN0YWNrLnB1c2goeyBhc3luYzogdHJ1ZSB9KTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbnZhciBfU3VwcHJlc3NlZEVycm9yID0gdHlwZW9mIFN1cHByZXNzZWRFcnJvciA9PT0gXCJmdW5jdGlvblwiID8gU3VwcHJlc3NlZEVycm9yIDogZnVuY3Rpb24gKGVycm9yLCBzdXBwcmVzc2VkLCBtZXNzYWdlKSB7XG4gIHZhciBlID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICByZXR1cm4gZS5uYW1lID0gXCJTdXBwcmVzc2VkRXJyb3JcIiwgZS5lcnJvciA9IGVycm9yLCBlLnN1cHByZXNzZWQgPSBzdXBwcmVzc2VkLCBlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZGlzcG9zZVJlc291cmNlcyhlbnYpIHtcbiAgZnVuY3Rpb24gZmFpbChlKSB7XG4gICAgZW52LmVycm9yID0gZW52Lmhhc0Vycm9yID8gbmV3IF9TdXBwcmVzc2VkRXJyb3IoZSwgZW52LmVycm9yLCBcIkFuIGVycm9yIHdhcyBzdXBwcmVzc2VkIGR1cmluZyBkaXNwb3NhbC5cIikgOiBlO1xuICAgIGVudi5oYXNFcnJvciA9IHRydWU7XG4gIH1cbiAgZnVuY3Rpb24gbmV4dCgpIHtcbiAgICB3aGlsZSAoZW52LnN0YWNrLmxlbmd0aCkge1xuICAgICAgdmFyIHJlYyA9IGVudi5zdGFjay5wb3AoKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhciByZXN1bHQgPSByZWMuZGlzcG9zZSAmJiByZWMuZGlzcG9zZS5jYWxsKHJlYy52YWx1ZSk7XG4gICAgICAgIGlmIChyZWMuYXN5bmMpIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0KS50aGVuKG5leHQsIGZ1bmN0aW9uKGUpIHsgZmFpbChlKTsgcmV0dXJuIG5leHQoKTsgfSk7XG4gICAgICB9XG4gICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgIGZhaWwoZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChlbnYuaGFzRXJyb3IpIHRocm93IGVudi5lcnJvcjtcbiAgfVxuICByZXR1cm4gbmV4dCgpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIF9fZXh0ZW5kcyxcbiAgX19hc3NpZ24sXG4gIF9fcmVzdCxcbiAgX19kZWNvcmF0ZSxcbiAgX19wYXJhbSxcbiAgX19tZXRhZGF0YSxcbiAgX19hd2FpdGVyLFxuICBfX2dlbmVyYXRvcixcbiAgX19jcmVhdGVCaW5kaW5nLFxuICBfX2V4cG9ydFN0YXIsXG4gIF9fdmFsdWVzLFxuICBfX3JlYWQsXG4gIF9fc3ByZWFkLFxuICBfX3NwcmVhZEFycmF5cyxcbiAgX19zcHJlYWRBcnJheSxcbiAgX19hd2FpdCxcbiAgX19hc3luY0dlbmVyYXRvcixcbiAgX19hc3luY0RlbGVnYXRvcixcbiAgX19hc3luY1ZhbHVlcyxcbiAgX19tYWtlVGVtcGxhdGVPYmplY3QsXG4gIF9faW1wb3J0U3RhcixcbiAgX19pbXBvcnREZWZhdWx0LFxuICBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0LFxuICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0LFxuICBfX2NsYXNzUHJpdmF0ZUZpZWxkSW4sXG4gIF9fYWRkRGlzcG9zYWJsZVJlc291cmNlLFxuICBfX2Rpc3Bvc2VSZXNvdXJjZXMsXG59O1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKFwiLi9zcmMvYmFja2dyb3VuZC50c1wiKTtcbiIsIiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==